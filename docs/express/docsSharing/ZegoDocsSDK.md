# ZegoDocs Web SDK API 文档

## 1 系统接口

### 1.1 初始化

> new ZegoDocs(config)

> config 对象结构如下：

| 参数   | 含义                           | 类型   | 是否必填 |
| ------ | ------------------------------ | ------ | -------- |
| appID  | appID                          | 数值   | 必填     |
| userID | 用户 ID，最大 128 字节的字符串 | 字符串 | 必填     |
| token  | 验证 token                     | 字符串 | 必填     |

### 1.2 设置环境

> zegoDocs.setTestEnv(env)

> SDK 默认是正式环境，env 为 true 则切换为测试环境，env 为 false 则切换为正式环境

### 1.3 加载文档内容

> zegoDocs.load(option):Promise<LoadResult>

> option 对象结构如下：

| 参数   | 含义              | 类型   | 是否必填 |
| ------ | ----------------- | ------ | -------- |
| fileID | 文档转换后唯一 ID | 字符串 | 必填     |

> LoadResult 对象结构如下：

| 参数      | 含义                                                   | 类型   |
| --------- | ------------------------------------------------------ | ------ |
| pageCount | 文档总页数                                             | 数值   |
| fileUrls  | 转换完成图片地址列表                                   | 数组   |
| notes     | 备注列表，与图片列表对应，空''表示当前图片对应备注为空 | 数组   |
| fileSize  | 源文档大小                                             | 数值   |
| fileHash  | 源文档 hash                                            | 字符串 |

### 1.4 上传文档

> zegoDocs.upload(option):Promise<UploadResult>

> option 对象结构如下：

| 参数       | 含义                                                         | 类型              | 是否必填 |
| ---------- | ------------------------------------------------------------ | ----------------- | -------- |
| file       | File 对象(web)或者文档路径(小程序)                           | File 对象或字符串 | 必填     |
| renderType | 渲染模式 1:Vector 向量模式 2:IMG 图片模式 3:VectorAndIMG 向量和图片模式 6:DynamicPPTH5 动态PPT模式 | 数值              | 必填     |
| onProgress | 上传进度监听函数                                             | Function          | 选填     |

> 渲染模式详细解释：

| 渲染模式                    | 描述                                                         |
| --------------------------- | ------------------------------------------------------------ |
| Vector 向量模式             | 适用于文件共享 SDK PC 端、移动端做的文档智能转换， 能够更换地支持文档浏览以及更清晰的缩放。 |
| IMG 图片模式                | 适用于文件共享 SDK Web 端、小程序使用的文档转换，按文件样式每一页都生成图片样式。 |
| VectorAndIMG 向量和图片模式 | 适用于当存在 Web 端、小程序、移动端、PC 端，多端的并存情况，在 web 端、小程序将使用 IMG 图片模式， 而 PC 端、移动端将使用 Vector 向量模式 |
| DynamicPPTH5 动态PPT模式    | 适用于文件共享SDK PC端、移动端、Web端、小程序使用的PPT文件转码格式， 会将PPT文件转成动态PPT的H5文件 |

> onProgress(data)，data 返回如下：

> 若文档未上传、上传成功未转换，则返回：

| 参数     | 含义        | 类型   |
| -------- | ----------- | ------ |
| fileHash | 源文档 hash | 字符串 |
| status   | 文档状态    | 数值   |

> 若文档排队转换中、转换中，则返回：

| 参数   | 含义            | 类型   |
| ------ | --------------- | ------ |
| taskID | 文档转换任务 ID | 字符串 |
| status | 文档状态        | 数值   |

> 若文档转换成功，则返回：

| 参数   | 含义              | 类型   |
| ------ | ----------------- | ------ |
| status | 文档转换后状态    | 数值   |
| fileID | 文档转换后唯一 ID | 字符串 |

> UploadResult 对象结构如下：

| 参数   | 含义              | 类型   |
| ------ | ----------------- | ------ |
| status | 文档转换后状态    | 数值   |
| fileID | 文档转换后唯一 ID | 字符串 |

> status 取值如下：

| 值  | 含义                 |
| --- | -------------------- |
| 1   | 文档未上传           |
| 2   | 文档已上传，但未转换 |
| 4   | 文档排队转换中       |
| 8   | 文档转换中           |
| 16  | 文档转换成功         |

## 2 常见错误码

| code    | message              |
| ------- | -------------------- |
| 30001   | 请求过于频繁         |
| 60002   | 文档不存在           |
| 60011   | token 无效           |
| 60012   | token 已过期         |
| 60013   | 文档转换请求已处理   |
| 60014   | 不存在的任务 ID      |
| 60015   | 不支持的文档类型     |
| 2000002 | 参数错误             |
| 2010003 | 不支持渲染模式       |
| 2020001 | 文档已加密           |
| 2020002 | 文档内容过大         |
| 2020003 | Excel 文档标签数过多 |
| 2020004 | 文档转换失败         |
| 2020005 | 转换任务已取消       |
