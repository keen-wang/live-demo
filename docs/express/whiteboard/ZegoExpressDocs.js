/*! For license information please see ZegoExpressDocs.js.LICENSE.txt */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}("undefined"!=typeof self?self:this,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=23)}([function(e,t,r){"use strict";var n=r(11),i=Object.prototype.toString;function o(e){return"[object Array]"===i.call(e)}function s(e){return void 0===e}function a(e){return null!==e&&"object"==typeof e}function c(e){return"[object Function]"===i.call(e)}function u(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),o(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:o,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:function(e){return null!==e&&!s(e)&&null!==e.constructor&&!s(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isUndefined:s,isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:c,isStream:function(e){return a(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:u,merge:function e(){var t={};function r(r,n){"object"==typeof t[n]&&"object"==typeof r?t[n]=e(t[n],r):t[n]=r}for(var n=0,i=arguments.length;n<i;n++)u(arguments[n],r);return t},deepMerge:function e(){var t={};function r(r,n){"object"==typeof t[n]&&"object"==typeof r?t[n]=e(t[n],r):t[n]="object"==typeof r?e({},r):r}for(var n=0,i=arguments.length;n<i;n++)u(arguments[n],r);return t},extend:function(e,t,r){return u(t,(function(t,i){e[i]=r&&"function"==typeof t?n(t,r):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t,r){var n;e.exports=(n=n||function(e,t){var r=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),n={},i=n.lib={},o=i.Base={extend:function(e){var t=r(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=i.WordArray=o.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,i=e.sigBytes;if(this.clamp(),n%4)for(var o=0;o<i;o++){var s=r[o>>>2]>>>24-o%4*8&255;t[n+o>>>2]|=s<<24-(n+o)%4*8}else for(o=0;o<i;o+=4)t[n+o>>>2]=r[o>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var r,n=[],i=function(t){t=t;var r=987654321,n=4294967295;return function(){var i=((r=36969*(65535&r)+(r>>16)&n)<<16)+(t=18e3*(65535&t)+(t>>16)&n)&n;return i/=4294967296,(i+=.5)*(e.random()>.5?1:-1)}},o=0;o<t;o+=4){var a=i(4294967296*(r||e.random()));r=987654071*a(),n.push(4294967296*a()|0)}return new s.init(n,t)}}),a=n.enc={},c=a.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new s.init(r,t/2)}},u=a.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(o))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new s.init(r,t)}},f=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},l=i.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r=this._data,n=r.words,i=r.sigBytes,o=this.blockSize,a=i/(4*o),c=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*o,u=e.min(4*c,i);if(c){for(var f=0;f<c;f+=o)this._doProcessBlock(n,f);var l=n.splice(0,c);r.sigBytes-=u}return new s.init(l,u)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),p=(i.Hasher=l.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new p.HMAC.init(e,r).finalize(t)}}}),n.algo={});return n}(Math),n)},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RenderTypeEnum=t.ExpectFileTypeEnum=t.FileTypeEnum=t.PPTSuffixEnum=t.WORDSuffixEnum=t.EXCELSuffixEnum=t.PDFSuffixEnum=t.IMGSuffixEnum=t.TXTSuffixEnum=t.UploadStatus=void 0,function(e){e[e.UPLOADING=1]="UPLOADING",e[e.UPLOADED=2]="UPLOADED",e[e.WAITING=4]="WAITING",e[e.CONVERTING=8]="CONVERTING",e[e.CONVERTED=16]="CONVERTED",e[e.CONVERTFAIL=32]="CONVERTFAIL"}(t.UploadStatus||(t.UploadStatus={})),function(e){e[e.TXT=0]="TXT",e[e.MD=1]="MD",e[e.C=2]="C",e[e.CPP=3]="CPP",e[e.H=4]="H",e[e.HPP=5]="HPP",e[e.PY=6]="PY",e[e.JS=7]="JS",e[e.XML=8]="XML"}(t.TXTSuffixEnum||(t.TXTSuffixEnum={})),function(e){e[e.PNG=0]="PNG",e[e.JPEG=1]="JPEG",e[e.JPG=2]="JPG",e[e.BMP=3]="BMP"}(t.IMGSuffixEnum||(t.IMGSuffixEnum={})),function(e){e[e.PDF=0]="PDF"}(t.PDFSuffixEnum||(t.PDFSuffixEnum={})),function(e){e[e.XLSX=0]="XLSX",e[e.XLS=1]="XLS"}(t.EXCELSuffixEnum||(t.EXCELSuffixEnum={})),function(e){e[e.DOC=0]="DOC",e[e.DOCX=1]="DOCX"}(t.WORDSuffixEnum||(t.WORDSuffixEnum={})),function(e){e[e.PPT=0]="PPT",e[e.PPTX=1]="PPTX"}(t.PPTSuffixEnum||(t.PPTSuffixEnum={})),function(e){e[e.FileTypeUnknown=0]="FileTypeUnknown",e[e.FileTypePPT=1]="FileTypePPT",e[e.FileTypeDOC=2]="FileTypeDOC",e[e.FileTypeELS=4]="FileTypeELS",e[e.FileTypePDF=8]="FileTypePDF",e[e.FileTypeIMG=16]="FileTypeIMG",e[e.FileTypeTXT=32]="FileTypeTXT"}(t.FileTypeEnum||(t.FileTypeEnum={})),function(e){e[e.FileTypePPT=1]="FileTypePPT",e[e.FileTypeDOC=2]="FileTypeDOC",e[e.FileTypeELS=4]="FileTypeELS",e[e.FileTypePDF=8]="FileTypePDF",e[e.FileTypeIMG=16]="FileTypeIMG",e[e.FileTypeTXT=32]="FileTypeTXT",e[e.FileTypeH5=64]="FileTypeH5",e[e.FileTypeH5PDF=128]="FileTypeH5PDF",e[e.FileTypeIMGAndPDF=256]="FileTypeIMGAndPDF",e[e.FileTypeDynamicPPTH5=512]="FileTypeDynamicPPTH5"}(t.ExpectFileTypeEnum||(t.ExpectFileTypeEnum={})),function(e){e[e.RenderTypeVector=1]="RenderTypeVector",e[e.RenderTypeIMG=2]="RenderTypeIMG",e[e.RenderTypeVectorAndIMG=3]="RenderTypeVectorAndIMG",e[e.RenderTypeDynamicPPTH5=6]="RenderTypeDynamicPPTH5"}(t.RenderTypeEnum||(t.RenderTypeEnum={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorCodeMap=t.ErrorCodeData=void 0,t.ErrorCodeData={4:"参数错误",32:"文档转换失败",64:"转换任务已取消",128:"文档已加密",256:"文档内容过大",512:"Excel文件标签数过多",30001:"请求过于频繁",60002:"文件不存在",60011:"token无效",60012:"token已过期",60013:"文档转换请求已处理",60014:"不存在的任务ID",60015:"不支持的文件类型",2000002:"参数错误",2010003:"不支持渲染模式",2030008:"空域名"},t.ErrorCodeMap={4:2000002,32:2020004,64:2020005,128:2020001,256:2020002,512:2020003,30001:30001,60002:60002,60011:60011,60012:60012,60013:60013,60014:60014,60015:60015,2000002:2000002,2010003:2010003,2030008:2030008}},function(e,t,r){var n,i,o;e.exports=(o=r(1),i=(n=o).lib.WordArray,n.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp();for(var i=[],o=0;o<r;o+=3)for(var s=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;a<4&&o+.75*a<r;a++)i.push(n.charAt(s>>>6*(3-a)&63));var c=n.charAt(64);if(c)for(;i.length%4;)i.push(c);return i.join("")},parse:function(e){var t=e.length,r=this._map,n=this._reverseMap;if(!n){n=this._reverseMap=[];for(var o=0;o<r.length;o++)n[r.charCodeAt(o)]=o}var s=r.charAt(64);if(s){var a=e.indexOf(s);-1!==a&&(t=a)}return function(e,t,r){for(var n=[],o=0,s=0;s<t;s++)if(s%4){var a=r[e.charCodeAt(s-1)]<<s%4*2,c=r[e.charCodeAt(s)]>>>6-s%4*2;n[o>>>2]|=(a|c)<<24-o%4*8,o++}return i.create(n,o)}(e,t,n)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},o.enc.Base64)},function(e,t,r){var n;e.exports=(n=r(1),function(e){var t=n,r=t.lib,i=r.WordArray,o=r.Hasher,s=t.algo,a=[];!function(){for(var t=0;t<64;t++)a[t]=4294967296*e.abs(e.sin(t+1))|0}();var c=s.MD5=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var r=0;r<16;r++){var n=t+r,i=e[n];e[n]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var o=this._hash.words,s=e[t+0],c=e[t+1],h=e[t+2],d=e[t+3],g=e[t+4],v=e[t+5],y=e[t+6],m=e[t+7],w=e[t+8],_=e[t+9],P=e[t+10],I=e[t+11],T=e[t+12],x=e[t+13],D=e[t+14],E=e[t+15],S=o[0],b=o[1],C=o[2],F=o[3];S=u(S,b,C,F,s,7,a[0]),F=u(F,S,b,C,c,12,a[1]),C=u(C,F,S,b,h,17,a[2]),b=u(b,C,F,S,d,22,a[3]),S=u(S,b,C,F,g,7,a[4]),F=u(F,S,b,C,v,12,a[5]),C=u(C,F,S,b,y,17,a[6]),b=u(b,C,F,S,m,22,a[7]),S=u(S,b,C,F,w,7,a[8]),F=u(F,S,b,C,_,12,a[9]),C=u(C,F,S,b,P,17,a[10]),b=u(b,C,F,S,I,22,a[11]),S=u(S,b,C,F,T,7,a[12]),F=u(F,S,b,C,x,12,a[13]),C=u(C,F,S,b,D,17,a[14]),S=f(S,b=u(b,C,F,S,E,22,a[15]),C,F,c,5,a[16]),F=f(F,S,b,C,y,9,a[17]),C=f(C,F,S,b,I,14,a[18]),b=f(b,C,F,S,s,20,a[19]),S=f(S,b,C,F,v,5,a[20]),F=f(F,S,b,C,P,9,a[21]),C=f(C,F,S,b,E,14,a[22]),b=f(b,C,F,S,g,20,a[23]),S=f(S,b,C,F,_,5,a[24]),F=f(F,S,b,C,D,9,a[25]),C=f(C,F,S,b,d,14,a[26]),b=f(b,C,F,S,w,20,a[27]),S=f(S,b,C,F,x,5,a[28]),F=f(F,S,b,C,h,9,a[29]),C=f(C,F,S,b,m,14,a[30]),S=l(S,b=f(b,C,F,S,T,20,a[31]),C,F,v,4,a[32]),F=l(F,S,b,C,w,11,a[33]),C=l(C,F,S,b,I,16,a[34]),b=l(b,C,F,S,D,23,a[35]),S=l(S,b,C,F,c,4,a[36]),F=l(F,S,b,C,g,11,a[37]),C=l(C,F,S,b,m,16,a[38]),b=l(b,C,F,S,P,23,a[39]),S=l(S,b,C,F,x,4,a[40]),F=l(F,S,b,C,s,11,a[41]),C=l(C,F,S,b,d,16,a[42]),b=l(b,C,F,S,y,23,a[43]),S=l(S,b,C,F,_,4,a[44]),F=l(F,S,b,C,T,11,a[45]),C=l(C,F,S,b,E,16,a[46]),S=p(S,b=l(b,C,F,S,h,23,a[47]),C,F,s,6,a[48]),F=p(F,S,b,C,m,10,a[49]),C=p(C,F,S,b,D,15,a[50]),b=p(b,C,F,S,v,21,a[51]),S=p(S,b,C,F,T,6,a[52]),F=p(F,S,b,C,d,10,a[53]),C=p(C,F,S,b,P,15,a[54]),b=p(b,C,F,S,c,21,a[55]),S=p(S,b,C,F,w,6,a[56]),F=p(F,S,b,C,E,10,a[57]),C=p(C,F,S,b,y,15,a[58]),b=p(b,C,F,S,x,21,a[59]),S=p(S,b,C,F,g,6,a[60]),F=p(F,S,b,C,I,10,a[61]),C=p(C,F,S,b,h,15,a[62]),b=p(b,C,F,S,_,21,a[63]),o[0]=o[0]+S|0,o[1]=o[1]+b|0,o[2]=o[2]+C|0,o[3]=o[3]+F|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;r[i>>>5]|=128<<24-i%32;var o=e.floor(n/4294967296),s=n;r[15+(i+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),r[14+(i+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),t.sigBytes=4*(r.length+1),this._process();for(var a=this._hash,c=a.words,u=0;u<4;u++){var f=c[u];c[u]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8)}return a},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});function u(e,t,r,n,i,o,s){var a=e+(t&r|~t&n)+i+s;return(a<<o|a>>>32-o)+t}function f(e,t,r,n,i,o,s){var a=e+(t&n|r&~n)+i+s;return(a<<o|a>>>32-o)+t}function l(e,t,r,n,i,o,s){var a=e+(t^r^n)+i+s;return(a<<o|a>>>32-o)+t}function p(e,t,r,n,i,o,s){var a=e+(r^(t|~n))+i+s;return(a<<o|a>>>32-o)+t}t.MD5=o._createHelper(c),t.HmacMD5=o._createHmacHelper(c)}(Math),n.MD5)},function(e,t,r){var n,i,o,s,a,c,u,f;e.exports=(f=r(1),r(8),r(9),i=(n=f).lib,o=i.Base,s=i.WordArray,a=n.algo,c=a.MD5,u=a.EvpKDF=o.extend({cfg:o.extend({keySize:4,hasher:c,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var r=this.cfg,n=r.hasher.create(),i=s.create(),o=i.words,a=r.keySize,c=r.iterations;o.length<a;){u&&n.update(u);var u=n.update(e).finalize(t);n.reset();for(var f=1;f<c;f++)u=n.finalize(u),n.reset();i.concat(u)}return i.sigBytes=4*a,i}}),n.EvpKDF=function(e,t,r){return u.create(r).compute(e,t)},f.EvpKDF)},function(e,t,r){var n,i,o,s,a,c,u,f;e.exports=(f=r(1),i=(n=f).lib,o=i.WordArray,s=i.Hasher,a=n.algo,c=[],u=a.SHA1=s.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],i=r[1],o=r[2],s=r[3],a=r[4],u=0;u<80;u++){if(u<16)c[u]=0|e[t+u];else{var f=c[u-3]^c[u-8]^c[u-14]^c[u-16];c[u]=f<<1|f>>>31}var l=(n<<5|n>>>27)+a+c[u];l+=u<20?1518500249+(i&o|~i&s):u<40?1859775393+(i^o^s):u<60?(i&o|i&s|o&s)-1894007588:(i^o^s)-899497514,a=s,s=o,o=i<<30|i>>>2,i=n,n=l}r[0]=r[0]+n|0,r[1]=r[1]+i|0,r[2]=r[2]+o|0,r[3]=r[3]+s|0,r[4]=r[4]+a|0},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=Math.floor(r/4294967296),t[15+(n+64>>>9<<4)]=r,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}}),n.SHA1=s._createHelper(u),n.HmacSHA1=s._createHmacHelper(u),f.SHA1)},function(e,t,r){var n,i,o,s;e.exports=(n=r(1),o=(i=n).lib.Base,s=i.enc.Utf8,void(i.algo.HMAC=o.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=s.parse(t));var r=e.blockSize,n=4*r;t.sigBytes>n&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),o=this._iKey=t.clone(),a=i.words,c=o.words,u=0;u<r;u++)a[u]^=1549556828,c[u]^=909522486;i.sigBytes=o.sigBytes=n,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,r=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(r))}})))},function(e,t,r){var n;e.exports=(n=r(1),r(7),void(n.lib.Cipher||function(e){var t=n,r=t.lib,i=r.Base,o=r.WordArray,s=r.BufferedBlockAlgorithm,a=t.enc,c=(a.Utf8,a.Base64),u=t.algo.EvpKDF,f=r.Cipher=s.extend({cfg:i.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,r){this.cfg=this.cfg.extend(r),this._xformMode=e,this._key=t,this.reset()},reset:function(){s.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?w:y}return function(t){return{encrypt:function(r,n,i){return e(n).encrypt(t,r,n,i)},decrypt:function(r,n,i){return e(n).decrypt(t,r,n,i)}}}}()}),l=(r.StreamCipher=f.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),t.mode={}),p=r.BlockCipherMode=i.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),h=l.CBC=function(){var e=p.extend();function t(e,t,r){var n=this._iv;if(n){var i=n;this._iv=void 0}else i=this._prevBlock;for(var o=0;o<r;o++)e[t+o]^=i[o]}return e.Encryptor=e.extend({processBlock:function(e,r){var n=this._cipher,i=n.blockSize;t.call(this,e,r,i),n.encryptBlock(e,r),this._prevBlock=e.slice(r,r+i)}}),e.Decryptor=e.extend({processBlock:function(e,r){var n=this._cipher,i=n.blockSize,o=e.slice(r,r+i);n.decryptBlock(e,r),t.call(this,e,r,i),this._prevBlock=o}}),e}(),d=(t.pad={}).Pkcs7={pad:function(e,t){for(var r=4*t,n=r-e.sigBytes%r,i=n<<24|n<<16|n<<8|n,s=[],a=0;a<n;a+=4)s.push(i);var c=o.create(s,n);e.concat(c)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},g=(r.BlockCipher=f.extend({cfg:f.cfg.extend({mode:h,padding:d}),reset:function(){f.reset.call(this);var e=this.cfg,t=e.iv,r=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=r.createEncryptor;else n=r.createDecryptor,this._minBufferSize=1;this._mode&&this._mode.__creator==n?this._mode.init(this,t&&t.words):(this._mode=n.call(r,this,t&&t.words),this._mode.__creator=n)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4}),r.CipherParams=i.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}})),v=(t.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,r=e.salt;if(r)var n=o.create([1398893684,1701076831]).concat(r).concat(t);else n=t;return n.toString(c)},parse:function(e){var t=c.parse(e),r=t.words;if(1398893684==r[0]&&1701076831==r[1]){var n=o.create(r.slice(2,4));r.splice(0,4),t.sigBytes-=16}return g.create({ciphertext:t,salt:n})}},y=r.SerializableCipher=i.extend({cfg:i.extend({format:v}),encrypt:function(e,t,r,n){n=this.cfg.extend(n);var i=e.createEncryptor(r,n),o=i.finalize(t),s=i.cfg;return g.create({ciphertext:o,key:r,iv:s.iv,algorithm:e,mode:s.mode,padding:s.padding,blockSize:e.blockSize,formatter:n.format})},decrypt:function(e,t,r,n){return n=this.cfg.extend(n),t=this._parse(t,n.format),e.createDecryptor(r,n).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),m=(t.kdf={}).OpenSSL={execute:function(e,t,r,n){n||(n=o.random(8));var i=u.create({keySize:t+r}).compute(e,n),s=o.create(i.words.slice(t),4*r);return i.sigBytes=4*t,g.create({key:i,iv:s,salt:n})}},w=r.PasswordBasedCipher=y.extend({cfg:y.cfg.extend({kdf:m}),encrypt:function(e,t,r,n){var i=(n=this.cfg.extend(n)).kdf.execute(r,e.keySize,e.ivSize);n.iv=i.iv;var o=y.encrypt.call(this,e,t,i.key,n);return o.mixIn(i),o},decrypt:function(e,t,r,n){n=this.cfg.extend(n),t=this._parse(t,n.format);var i=n.kdf.execute(r,e.keySize,e.ivSize,t.salt);return n.iv=i.iv,y.decrypt.call(this,e,t,i.key,n)}})}()))},function(e,t,r){"use strict";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}}},function(e,t,r){"use strict";var n=r(0);function i(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var o;if(r)o=r(t);else if(n.isURLSearchParams(t))o=t.toString();else{var s=[];n.forEach(t,(function(e,t){null!=e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,(function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),s.push(i(t)+"="+i(e))})))})),o=s.join("&")}if(o){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}},function(e,t,r){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,r){"use strict";(function(t){var n=r(0),i=r(42),o={"Content-Type":"application/x-www-form-urlencoded"};function s(e,t){!n.isUndefined(e)&&n.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var a,c={adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==t&&"[object process]"===Object.prototype.toString.call(t))&&(a=r(15)),a),transformRequest:[function(e,t){return i(t,"Accept"),i(t,"Content-Type"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(s(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):n.isObject(e)?(s(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};c.headers={common:{Accept:"application/json, text/plain, */*"}},n.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),n.forEach(["post","put","patch"],(function(e){c.headers[e]=n.merge(o)})),e.exports=c}).call(this,r(41))},function(e,t,r){"use strict";var n=r(0),i=r(43),o=r(12),s=r(45),a=r(48),c=r(49),u=r(16);e.exports=function(e){return new Promise((function(t,f){var l=e.data,p=e.headers;n.isFormData(l)&&delete p["Content-Type"];var h=new XMLHttpRequest;if(e.auth){var d=e.auth.username||"",g=e.auth.password||"";p.Authorization="Basic "+btoa(d+":"+g)}var v=s(e.baseURL,e.url);if(h.open(e.method.toUpperCase(),o(v,e.params,e.paramsSerializer),!0),h.timeout=e.timeout,h.onreadystatechange=function(){if(h&&4===h.readyState&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in h?a(h.getAllResponseHeaders()):null,n={data:e.responseType&&"text"!==e.responseType?h.response:h.responseText,status:h.status,statusText:h.statusText,headers:r,config:e,request:h};i(t,f,n),h=null}},h.onabort=function(){h&&(f(u("Request aborted",e,"ECONNABORTED",h)),h=null)},h.onerror=function(){f(u("Network Error",e,null,h)),h=null},h.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),f(u(t,e,"ECONNABORTED",h)),h=null},n.isStandardBrowserEnv()){var y=r(50),m=(e.withCredentials||c(v))&&e.xsrfCookieName?y.read(e.xsrfCookieName):void 0;m&&(p[e.xsrfHeaderName]=m)}if("setRequestHeader"in h&&n.forEach(p,(function(e,t){void 0===l&&"content-type"===t.toLowerCase()?delete p[t]:h.setRequestHeader(t,e)})),n.isUndefined(e.withCredentials)||(h.withCredentials=!!e.withCredentials),e.responseType)try{h.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&h.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&h.upload&&h.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){h&&(h.abort(),f(e),h=null)})),void 0===l&&(l=null),h.send(l)}))}},function(e,t,r){"use strict";var n=r(44);e.exports=function(e,t,r,i,o){var s=new Error(e);return n(s,t,r,i,o)}},function(e,t,r){"use strict";var n=r(0);e.exports=function(e,t){t=t||{};var r={},i=["url","method","params","data"],o=["headers","auth","proxy"],s=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];n.forEach(i,(function(e){void 0!==t[e]&&(r[e]=t[e])})),n.forEach(o,(function(i){n.isObject(t[i])?r[i]=n.deepMerge(e[i],t[i]):void 0!==t[i]?r[i]=t[i]:n.isObject(e[i])?r[i]=n.deepMerge(e[i]):void 0!==e[i]&&(r[i]=e[i])})),n.forEach(s,(function(n){void 0!==t[n]?r[n]=t[n]:void 0!==e[n]&&(r[n]=e[n])}));var a=i.concat(o).concat(s),c=Object.keys(t).filter((function(e){return-1===a.indexOf(e)}));return n.forEach(c,(function(n){void 0!==t[n]?r[n]=t[n]:void 0!==e[n]&&(r[n]=e[n])})),r}},function(e,t,r){"use strict";function n(e){this.message=e}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,e.exports=n},function(e,t){var r={utf8:{stringToBytes:function(e){return r.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(r.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],r=0;r<e.length;r++)t.push(255&e.charCodeAt(r));return t},bytesToString:function(e){for(var t=[],r=0;r<e.length;r++)t.push(String.fromCharCode(e[r]));return t.join("")}}};e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transError=t.RenderMode=t.FileType=void 0,function(e){e[e.PPT=1]="PPT",e[e.DOC=2]="DOC",e[e.ELS=4]="ELS",e[e.PDF=8]="PDF",e[e.IMG=16]="IMG",e[e.TXT=32]="TXT",e[e.PPTH5=512]="PPTH5"}(t.FileType||(t.FileType={})),function(e){e[e.PDF=0]="PDF",e[e.PPT=1]="PPT",e[e.PPTH5=2]="PPTH5"}(t.RenderMode||(t.RenderMode={}));var n={0:0,32:2020004,64:2020005,128:2020001,512:2020003,"-102":2000003,"-105":2010001,"-109":2010002,"-110":2030002,"-115":2030005,"-116":2030003,"-117":2020002,"-118":2030006,"-119":2030007,"-120":2010003,"-999998":2030004,"-999999":2000002};t.transError=function(e){return n[e]||e}},,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoExpressDocs=void 0,r(24);var n=r(25),i=r(53),o=r(57),s=function(){function e(e){this.docsviews={};var t={appID:e.appID,userID:e.userID,token:e.token,isTestEnv:!!e.isTestEnv};this.serviceHandle=new o.ZegoDocsViewService(new n.ZegoDocs(t))}return e.prototype.createView=function(e,t,r){t=(t||Date.now()+Math.floor(1e3*Math.random()))+"",r=r||"";var n=this.docsviews[t];if(n)return n.setSheetName(r),n;var o=document.getElementById("zego-whiteboard"+t);return(o=o&&o.parentElement)&&(n=this.docsviews[o.id.replace("zego-docsview-con","")])?(n.setSheetName(r),this.docsviews[t]=n,n):((n=new i.ZegoDocsView(this.serviceHandle,e,t)).setSheetName(r),this.docsviews[t]=n,n)},e.prototype.uploadFile=function(e,t){return this.serviceHandle.upload({file:e,renderType:t})},e.prototype.on=function(e,t){return this.serviceHandle.addEventListener(e,t)},e.prototype.off=function(e,t){return this.serviceHandle.removeEventListener(e,t)},e.prototype.setTestEnv=function(e){this.serviceHandle.setTestEnv(e)},e.prototype.setConfig=function(e,t){return this.serviceHandle.setConfig(e,t)},e.prototype.getConfig=function(e){return this.serviceHandle.getConfig(e)},e}();t.ZegoExpressDocs=s},function(e,t){!function(){if(-1!==window.navigator.userAgent.indexOf("Trident")){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var r=document.createEvent("CustomEvent");return r.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),r}e.prototype=window.Event.prototype,window.CustomEvent=e,document.body.scrollTo||(Element.prototype.scrollTo=function(e,t){this.scrollLeft=e,this.scrollTop=t}),document.body.scrollBy||(Element.prototype.scrollBy=function(e,t){this.scrollLeft+=e,this.scrollTop+=t}),FileReader.prototype.readAsBinaryString||(FileReader.prototype.readAsBinaryString=function(e){var t=this,r=new FileReader;r.onload=function(e){for(var n="",i=new Uint8Array(r.result),o=i.byteLength,s=0;s<o;s++)n+=String.fromCharCode(i[s]);t.content=n,t.result=n,t.onload()},r.readAsArrayBuffer(e)})}}()},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoDocs=void 0;var a=r(3),c=r(26),u=r(4),f=r(34),l=s(r(35)),p=function(){function e(e){this.axiosInstance=l.default.create({timeout:1e4}),this.stateCenter={appID:0,platform:32,webToken:"",userID:""},this.init(e)}return e.prototype.init=function(e){var t=e.token,r=e.appID,n=e.userID,i=e.isTestEnv;this.stateCenter.appID=r,this.stateCenter.webToken=t,this.stateCenter.userID=n,this.config={testDomain:"https://docservice-test.zego.im",domain:c.isPrivateServer?"":"https://docservice"+r+".zego.im",testEnv:!1},this.setTestEnv(!!i)},e.prototype.setTestEnv=function(e){var t=e?this.config.testDomain:this.config.domain;this.config.testEnv=!!e,this.requestUrls={queryStatusUrl:t+"/doc/query_status",createCvtUrl:t+"/doc/cvt_doc",cancelCvtUrl:t+"/doc/cancel_cvt",queryUrl:t+"/doc/access"}},e.prototype.setConfig=function(e,t){return!(!e||!t&&0!==t)&&(this.config[e]=t,!0)},e.prototype.getConfig=function(e){return this.config[e]},e.prototype.upload=function(e){return this.config.testEnv||this.config.domain||!c.isPrivateServer?e.file&&e.renderType?this.uploadProgress(e):Promise.reject({code:c.codeMapHandle(2000002),message:u.ErrorCodeData[2000002]}):Promise.reject({code:c.codeMapHandle(2030008),message:u.ErrorCodeData[2030008]})},e.prototype.load=function(e){var t=this;if(!this.config.testEnv&&!this.config.domain&&c.isPrivateServer)return Promise.reject({code:c.codeMapHandle(2030008),message:u.ErrorCodeData[2030008]});if(!e.fileID)return Promise.reject({code:c.codeMapHandle(2000002),message:u.ErrorCodeData[2000002]});var r={platform:this.stateCenter.platform,app_id:this.stateCenter.appID,web_token:this.stateCenter.webToken,id_name:this.stateCenter.userID,file_id:e.fileID};return new Promise((function(n,s){return i(t,void 0,void 0,(function(){var t,i,a,f,l;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.requestHandle({url:this.requestUrls.queryUrl,method:"post",timeout:e.timeout||1e4,data:r})];case 1:return t=o.sent(),i=t.data,0===i.ret.code?(i.file_urls=i.file_urls||[],a={pageCount:i.page_count||i.file_urls.length||1,notes:i.notes||[""],fileUrls:i.file_urls,fileSize:i.file_size,fileHash:i.file_hash},c.handleFileOfView(r.file_id,i,a),16===i.file_type?this.decryptImages(i.file_urls).then((function(e){a.fileUrls=e,n(a)})).catch((function(e){return s(e)})):n(a)):(f={code:c.codeMapHandle(i.ret.code),message:u.ErrorCodeData[i.ret.code]||i.ret.message},s(f)),[3,3];case 2:return l=o.sent(),s(l),[3,3];case 3:return[2]}}))}))}))},e.prototype.cancelUpload=function(e){var t=this,r=e.timeout,n=e.taskID,s={app_id:this.stateCenter.appID,platform:this.stateCenter.platform,web_token:this.stateCenter.webToken,id_name:this.stateCenter.userID,task_id:n};return new Promise((function(e,a){return i(t,void 0,void 0,(function(){var t,i,f,l;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.requestHandle({url:this.requestUrls.cancelCvtUrl,method:"post",timeout:r||1e4,data:s})];case 1:return t=o.sent(),0===(i=t.data).ret.code?e({taskID:n}):(f={code:c.codeMapHandle(i.ret.code),message:u.ErrorCodeData[i.ret.code]||i.ret.message},a(f)),[3,3];case 2:return l=o.sent(),a(l),[3,3];case 3:return[2]}}))}))}))},e.prototype.uploadSucceedAfter=function(e){var t=e.uploadResult,r=e.onProgress,n=e.originReslove,i=e.resolve;r&&r(t),n?n(t):i(t)},e.prototype.uploadProgressInit=function(e){return i(this,void 0,void 0,(function(){var t,r,n,i,s,c,u,f;return o(this,(function(o){switch(o.label){case 0:return t=e.statusInitSub,r=e.file,n=e.onProgress,s=(i=t).oss,c=i.fileServerProvider,u=i.fileHash,f=i.sfs,n&&n({status:a.UploadStatus.UPLOADING,fileHash:u}),[4,this.uploadDoc({file:r,fileServerProvider:c,oss:s,sfs:f,fileHash:u,onProgress:n})];case 1:return o.sent(),n&&n({status:a.UploadStatus.UPLOADED,fileHash:u}),[4,this.uploadProgressCvt(e)];case 2:return o.sent(),[2,!0]}}))}))},e.prototype.uploadProgressCvt=function(e){return i(this,void 0,void 0,(function(){var t,r,n,i,s,a,u,f,l,p,h,d,g;return o(this,(function(o){switch(o.label){case 0:return t=e.file,r=e.onProgress,n=e.fileType,i=e.fileHash,s=e.originReslove,a=e.resolve,u=e.expectFileType,f=e.originReject,l=e.reject,h=this.createCvtDoc,d={},[4,c.getFileSize(t)];case 1:return[4,h.apply(this,[(d.fileSize=o.sent().fileSize,d.fileName=c.getFileName(t),d.fileType=n,d.fileHash=i,d.expectFileType=u,d)])];case 2:return p=o.sent(),g={taskID:p.taskID,onProgress:r},[4,this.uploadProgress(g,s||a,f||l)];case 3:return o.sent(),[2,!0]}}))}))},e.prototype.uploadProgress=function(e,t,r){var n=this;return new Promise((function(s,f){return i(n,void 0,void 0,(function(){var n,l,p,h,d,g,v,y,m,w,_=this;return o(this,(function(P){switch(P.label){case 0:return P.trys.push([0,6,,7]),l=(n=e).file,p=n.renderType,h=void 0,d=a.FileTypeEnum.FileTypeUnknown,g=void 0,v=a.ExpectFileTypeEnum.FileTypePDF,l?(d=c.getFileType(l),a.RenderTypeEnum[p]?(v=c.getExpectFileType(p,d),[4,c.getMd5(l)]):(f({code:c.codeMapHandle(2010003),message:u.ErrorCodeData[2010003]}),[2])):[3,3];case 1:return h=P.sent().fileHash,0===d?(f({code:c.codeMapHandle(60015),message:u.ErrorCodeData[60015]}),[2]):[4,this.queryStatus({fileHash:h,fileType:d,expectFileType:v})];case 2:return g=P.sent(),[3,5];case 3:return[4,this.queryStatus({taskID:e.taskID})];case 4:g=P.sent(),P.label=5;case 5:switch(y=g.status){case a.UploadStatus.UPLOADING:this.uploadProgressInit({file:l,expectFileType:v,fileType:d,fileHash:h,statusInitSub:g,onProgress:e.onProgress,originReslove:t,resolve:s,originReject:r,reject:f});break;case a.UploadStatus.UPLOADED:this.uploadProgressCvt({file:l,expectFileType:v,fileType:d,fileHash:h,onProgress:e.onProgress,originReslove:t,resolve:s,originReject:r,reject:f});break;case a.UploadStatus.WAITING:case a.UploadStatus.CONVERTING:m=g.taskID,e.onProgress&&e.onProgress({status:y,taskID:m}),setTimeout((function(){return i(_,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,this.uploadProgress({taskID:m,onProgress:e.onProgress},t||s,r||f)];case 1:return n.sent(),[2]}}))}))}),2e3);break;case a.UploadStatus.CONVERTED:this.uploadSucceedAfter({uploadResult:{fileID:g.fileID,status:g.status},onProgress:e.onProgress,originReslove:t,resolve:s});break;default:r?r({code:c.codeMapHandle(32),message:u.ErrorCodeData[32]}):f({code:c.codeMapHandle(32),message:u.ErrorCodeData[32]})}return[3,7];case 6:return w=P.sent(),r?r(w):f(w),[3,7];case 7:return[2]}}))}))}))},e.prototype.requestHandle=function(e){var t=this;return"wx"===c.getEnv()?new Promise((function(r,s){return i(t,void 0,void 0,(function(){return o(this,(function(t){return wx.request(n(n({},e),{success:function(e){r(e)},fail:function(e){s(e)}})),[2]}))}))})):this.axiosInstance(e)},e.prototype.queryStatus=function(e){var t=this,r={app_id:this.stateCenter.appID,platform:this.stateCenter.platform,web_token:this.stateCenter.webToken,id_name:this.stateCenter.userID};if(e.taskID)r.task_id=e.taskID;else{var n=e,s=n.fileHash,a=n.fileType,f=n.expectFileType;r.file_hash=s,r.file_type=a,r.expect_file_type=f}return new Promise((function(n,s){return i(t,void 0,void 0,(function(){var t,i,a,f,l,p,h,d,g,v,y,m,w,_;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.requestHandle({url:this.requestUrls.queryStatusUrl,method:"post",timeout:e.timeout||1e4,data:r})];case 1:if(t=o.sent(),i=t.data,a=i.ret,f=i.file_type,l=i.status,p=i.file_hash,h=i.file_server_provider,d=i.oss,g=i.sfs,v=i.task_id,y=i.query_interval,m=i.file_id,0===a.code)switch(l){case 32:case 64:case 128:case 256:case 512:s({code:c.codeMapHandle(l),message:u.ErrorCodeData[l]});break;case 1:n({fileType:f,status:l,fileHash:p,fileServerProvider:h,oss:d,sfs:g});break;case 2:n({fileType:f,status:l,fileHash:p});break;case 4:n({fileType:f,status:l,taskID:v,queryInterval:y||1e3});break;case 8:n({fileType:f,status:l,taskID:v});break;case 16:n({fileID:m,status:l});break;default:s({code:c.codeMapHandle(32),message:u.ErrorCodeData[32]})}else w={code:c.codeMapHandle(i.ret.code),message:u.ErrorCodeData[i.ret.code]||i.ret.message},s(w);return[3,3];case 2:return _=o.sent(),s(_),[3,3];case 3:return[2]}}))}))}))},e.prototype.uploadDocToOssByWx=function(e){var t=e.oss,r=e.file,n=e.onProgress,i=c.getUploadOssInfo(t);return new Promise((function(e,t){try{wx.uploadFile({url:i.url,filePath:r,name:"file",formData:{key:i.objectName,policy:i.policy,OSSAccessKeyId:i.OSSAccessKeyId,success_action_status:i.successActionStatus,signature:i.signature,"x-oss-security-token":i.securityToken},timeout:6e5,success:function(t){e()},fail:function(e){t(e)}}).onProgressUpdate((function(e){var t=e.progress,r=e.totalBytesSent,i=e.totalBytesExpectedToSend;n&&n({status:a.UploadStatus.UPLOADING,uploadPercent:t,loaded:r,total:i})}))}catch(e){t(e)}}))},e.prototype.uploadDocToOssByWeb=function(e){var t=e.oss,r=e.file,n=e.onProgress,i=c.getUploadOssInfo(t),o=new FormData;return o.append("OSSAccessKeyId",i.OSSAccessKeyId),o.append("x-oss-security-token",i.securityToken),o.append("signature",i.signature),o.append("policy",i.policy),o.append("successActionStatus",i.successActionStatus),o.append("key",i.objectName),o.append("file",r),o.append("name",r.name),this.axiosInstance({method:"post",url:i.url,data:o,timeout:6e5,onUploadProgress:function(e){var t=e.total,r=e.loaded;n&&n({status:a.UploadStatus.UPLOADING,uploadPercent:Math.floor(r/t*100),total:t,loaded:r})}})},e.prototype.uploadDoc=function(e){var t=e.fileServerProvider;if("oss"===t)return"wx"===c.getEnv()?this.uploadDocToOssByWx(e):this.uploadDocToOssByWeb(e);if("sfs"===t)return"wx"===c.getEnv()?f.uploadDocToSfsByWx(this,e):f.uploadDocToSfsByWeb(this,e);var r={code:c.codeMapHandle(4),message:"参数错误"};return Promise.reject(r)},e.prototype.createCvtDoc=function(e){var t=this,r=e.timeout,n=e.srcFileUrl,s=e.fileName,a=e.fileHash,f=e.fileSize,l=e.fileType,p=e.expectFileType,h={platform:this.stateCenter.platform,app_id:this.stateCenter.appID,web_token:this.stateCenter.webToken,id_name:this.stateCenter.userID,file_name:s,file_hash:a,file_size:f,file_type:l,expect_file_type:p};return n&&(h.src_file_url=n),new Promise((function(e,n){return i(t,void 0,void 0,(function(){var t,i,s,a;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.requestHandle({url:this.requestUrls.createCvtUrl,method:"post",timeout:r||1e4,data:h})];case 1:return t=o.sent(),i=t.data,0===i.ret.code?e({status:i.status,taskID:i.task_id}):(s={code:c.codeMapHandle(i.ret.code),message:u.ErrorCodeData[i.ret.code]||i.ret.message},n(s)),[3,3];case 2:return a=o.sent(),n(a),[3,3];case 3:return[2]}}))}))}))},e.prototype.decryptImages=function(e){var t=this,r=e.map((function(e){return t.requestHandle({url:e,method:"get",timeout:1e4,responseType:"arraybuffer"}).then((function(e){var t=new Uint8Array(e.data),r=c.decryptU8arry(t.slice(0,1024));if("wx"===c.getEnv()){for(var n=[],i=r.byteLength,o=0;o<i;o++)n[o]=r[o];var s=t.slice(1024);for(o=0;o<s.byteLength;o++)n[o+i]=s[o];return"data:image/png;base64,"+wx.arrayBufferToBase64(n)}return URL.createObjectURL(new Blob([r,t.slice(1024)],{type:"image/png"}))}))}));return Promise.all(r)},e}();t.ZegoDocs=p},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleFileOfView=t.codeMapHandle=t.decryptU8arry=t.refreshCDNHandle=t.getUploadOssInfo=t.getExpectFileType=t.getFileName=t.getFileSize=t.getFileType=t.getMd5=t.getEnv=t.isPrivateServer=void 0;var i=r(4),o=r(3),s=n(r(27)),a=n(r(29)),c=n(r(6)),u=n(r(30)),f=n(r(31)),l=n(r(32)),p=n(r(5)),h=n(r(33)),d=n(r(1)),g=l.default.parse("89c78c018ed563571a3024342073c002"),v=l.default.parse("0d9d89c53bd0a086834b411fe8387946");t.isPrivateServer=!1;var y="";t.getEnv=function(){return y||(y="undefined"!=typeof wx&&"function"==typeof wx.canIUse?"wx":"web"),y},t.getMd5=function(e){return new Promise((function(t,r){try{if("string"==typeof e)wx.getFileInfo({filePath:e,digestAlgorithm:"md5",success:function(e){var r=e.digest;t({fileHash:r})},fail:function(e){r(e)}});else{var n=new FileReader;n.onload=function(){var e=n.result||n.content;t({fileHash:c.default(f.default.parse(e)).toString(l.default)})},n.readAsBinaryString(e)}}catch(e){r(e)}}))},t.getFileType=function(e){var t,r=("string"==typeof e?e:e.name).split(".").pop();switch(r?r.toUpperCase():r){case"XLSX":case"XLS":t=4;break;case"DOC":case"DOCX":t=2;break;case"PPT":case"PPTX":t=1;break;case"TXT":case"MD":case"C":case"CPP":case"H":case"HPP":case"PY":case"JS":case"XML":t=32;break;case"PDF":t=8;break;case"PNG":case"JPEG":case"JPG":case"BMP":t=16;break;default:t=0}return t},t.getFileSize=function(e){return new Promise((function(t,r){try{"string"==typeof e?wx.getFileInfo({filePath:e,digestAlgorithm:"md5",success:function(e){var r=e.size;t({fileSize:r})},fail:function(e){r(e)}}):t({fileSize:e.size})}catch(e){r(e)}}))},t.getFileName=function(e){return"string"==typeof e?e.split("wxfile://")[1]||e.split("http://")[1]||e.split("https://")[1]:e.name},t.getExpectFileType=function(e,t){var r;switch(e){case o.RenderTypeEnum.RenderTypeVector:r=o.ExpectFileTypeEnum.FileTypePDF;break;case o.RenderTypeEnum.RenderTypeIMG:r=o.ExpectFileTypeEnum.FileTypeIMG;break;case o.RenderTypeEnum.RenderTypeVectorAndIMG:r=t===o.FileTypeEnum.FileTypeIMG?o.ExpectFileTypeEnum.FileTypeIMG:o.ExpectFileTypeEnum.FileTypeIMGAndPDF;break;case o.RenderTypeEnum.RenderTypeDynamicPPTH5:r=o.ExpectFileTypeEnum.FileTypeDynamicPPTH5;break;default:r=o.ExpectFileTypeEnum.FileTypeIMGAndPDF}return r};var m=function(e,t){return p.default.stringify(u.default(t,e))};t.getUploadOssInfo=function(e){var t=e.access_key_id,r=e.access_key_secret,n=e.bucket_name,i=e.security_token,o=e.endpoint,a=e.object_name,c=e.timeout,u=void 0===c?1:c,f=e.maxSize,l=function(e,t){var r=new Date;r.setHours(r.getHours()+e);var n={expiration:r.toISOString(),conditions:[["content-length-range",0,1024*t*1024]]};return s.default.Base64.encode(JSON.stringify(n))}(u,void 0===f?150:f);return{url:"https://"+n+"."+o,signature:m(r,l),securityToken:i,policy:l,key:a,OSSAccessKeyId:t,successActionStatus:"200",objectName:a}},t.refreshCDNHandle=function(e){};t.decryptU8arry=function(e){var t=function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e[n])<<24-n%4*8;return d.default.lib.WordArray.create(r,t)}(e).toString(p.default);return function(e){for(var t=e.words,r=e.sigBytes,n=new Uint8Array(r),i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n[i]=o}return n}(a.default.decrypt(t,g,{iv:v,mode:d.default.mode.CBC,padding:h.default}))},t.codeMapHandle=function(e){return i.ErrorCodeMap[e]||e},t.handleFileOfView=function(e,t,r){if(Object.assign(r,{fileID:e,fileName:t.file_name,fileType:t.expect_file_type===o.ExpectFileTypeEnum.FileTypeDynamicPPTH5?o.ExpectFileTypeEnum.FileTypeDynamicPPTH5:t.file_type,width:t.width,height:t.height}),t.file_type===o.ExpectFileTypeEnum.FileTypeELS&&t.split_file_list){var n=[];r.file_list=t.split_file_list.map((function(e){var r=0|e.width,i=0|e.height;return{name:t.file_name,file_name:e.file_name,page_list:e.file_urls.map((function(e,t){return n.push(e),{width:r,height:i,src:e,virtual_page_list:[{width:r,height:i,virtual_page_number:t+1}]}}))}})),r.fileUrls=n,r.pageCount=n.length}}},function(e,t,r){(function(r){var n;!function(r,i){e.exports=function(r){"use strict";var i,o=(r=r||{}).Base64,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=function(e){for(var t={},r=0,n=e.length;r<n;r++)t[e.charAt(r)]=r;return t}(s),c=String.fromCharCode,u=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?c(192|t>>>6)+c(128|63&t):c(224|t>>>12&15)+c(128|t>>>6&63)+c(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return c(240|t>>>18&7)+c(128|t>>>12&63)+c(128|t>>>6&63)+c(128|63&t)},f=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,l=function(e){return e.replace(f,u)},p=function(e){var t=[0,2,1][e.length%3],r=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0);return[s.charAt(r>>>18),s.charAt(r>>>12&63),t>=2?"=":s.charAt(r>>>6&63),t>=1?"=":s.charAt(63&r)].join("")},h=r.btoa&&"function"==typeof r.btoa?function(e){return r.btoa(e)}:function(e){if(e.match(/[^\x00-\xFF]/))throw new RangeError("The string contains invalid characters.");return e.replace(/[\s\S]{1,3}/g,p)},d=function(e){return h(l(String(e)))},g=function(e){return e.replace(/[+\/]/g,(function(e){return"+"==e?"-":"_"})).replace(/=/g,"")},v=function(e,t){return t?g(d(e)):d(e)};r.Uint8Array&&(i=function(e,t){for(var r="",n=0,i=e.length;n<i;n+=3){var o=e[n],a=e[n+1],c=e[n+2],u=o<<16|a<<8|c;r+=s.charAt(u>>>18)+s.charAt(u>>>12&63)+(void 0!==a?s.charAt(u>>>6&63):"=")+(void 0!==c?s.charAt(63&u):"=")}return t?g(r):r});var y,m=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,w=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return c(55296+(t>>>10))+c(56320+(1023&t));case 3:return c((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return c((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},_=function(e){return e.replace(m,w)},P=function(e){var t=e.length,r=t%4,n=(t>0?a[e.charAt(0)]<<18:0)|(t>1?a[e.charAt(1)]<<12:0)|(t>2?a[e.charAt(2)]<<6:0)|(t>3?a[e.charAt(3)]:0),i=[c(n>>>16),c(n>>>8&255),c(255&n)];return i.length-=[0,0,2,1][r],i.join("")},I=r.atob&&"function"==typeof r.atob?function(e){return r.atob(e)}:function(e){return e.replace(/\S{1,4}/g,P)},T=function(e){return I(String(e).replace(/[^A-Za-z0-9\+\/]/g,""))},x=function(e){return function(e){return _(I(e))}(String(e).replace(/[-_]/g,(function(e){return"-"==e?"+":"/"})).replace(/[^A-Za-z0-9\+\/]/g,""))};r.Uint8Array&&(y=function(e){return Uint8Array.from(T(e),(function(e){return e.charCodeAt(0)}))});var D=function(){var e=r.Base64;return r.Base64=o,e};if(r.Base64={VERSION:"2.6.2",atob:T,btoa:h,fromBase64:x,toBase64:v,utob:l,encode:v,encodeURI:function(e){return v(e,!0)},btou:_,decode:x,noConflict:D,fromUint8Array:i,toUint8Array:y},"function"==typeof Object.defineProperty){var E=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};r.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",E((function(){return x(this)}))),Object.defineProperty(String.prototype,"toBase64",E((function(e){return v(this,e)}))),Object.defineProperty(String.prototype,"toBase64URI",E((function(){return v(this,!0)})))}}r.Meteor&&(Base64=r.Base64);e.exports?e.exports.Base64=r.Base64:void 0===(n=function(){return r.Base64}.apply(t,[]))||(e.exports=n);return{Base64:r.Base64}}(r)}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==r?r:this)}).call(this,r(28))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){var n;e.exports=(n=r(1),r(5),r(6),r(7),r(10),function(){var e=n,t=e.lib.BlockCipher,r=e.algo,i=[],o=[],s=[],a=[],c=[],u=[],f=[],l=[],p=[],h=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var r=0,n=0;for(t=0;t<256;t++){var d=n^n<<1^n<<2^n<<3^n<<4;d=d>>>8^255&d^99,i[r]=d,o[d]=r;var g=e[r],v=e[g],y=e[v],m=257*e[d]^16843008*d;s[r]=m<<24|m>>>8,a[r]=m<<16|m>>>16,c[r]=m<<8|m>>>24,u[r]=m,m=16843009*y^65537*v^257*g^16843008*r,f[d]=m<<24|m>>>8,l[d]=m<<16|m>>>16,p[d]=m<<8|m>>>24,h[d]=m,r?(r=g^e[e[e[y^g]]],n^=e[e[n]]):r=n=1}}();var d=[0,1,2,4,8,16,32,64,128,27,54],g=r.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,r=e.sigBytes/4,n=4*((this._nRounds=r+6)+1),o=this._keySchedule=[],s=0;s<n;s++)if(s<r)o[s]=t[s];else{var a=o[s-1];s%r?r>6&&s%r==4&&(a=i[a>>>24]<<24|i[a>>>16&255]<<16|i[a>>>8&255]<<8|i[255&a]):(a=i[(a=a<<8|a>>>24)>>>24]<<24|i[a>>>16&255]<<16|i[a>>>8&255]<<8|i[255&a],a^=d[s/r|0]<<24),o[s]=o[s-r]^a}for(var c=this._invKeySchedule=[],u=0;u<n;u++)s=n-u,a=u%4?o[s]:o[s-4],c[u]=u<4||s<=4?a:f[i[a>>>24]]^l[i[a>>>16&255]]^p[i[a>>>8&255]]^h[i[255&a]]}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,s,a,c,u,i)},decryptBlock:function(e,t){var r=e[t+1];e[t+1]=e[t+3],e[t+3]=r,this._doCryptBlock(e,t,this._invKeySchedule,f,l,p,h,o),r=e[t+1],e[t+1]=e[t+3],e[t+3]=r},_doCryptBlock:function(e,t,r,n,i,o,s,a){for(var c=this._nRounds,u=e[t]^r[0],f=e[t+1]^r[1],l=e[t+2]^r[2],p=e[t+3]^r[3],h=4,d=1;d<c;d++){var g=n[u>>>24]^i[f>>>16&255]^o[l>>>8&255]^s[255&p]^r[h++],v=n[f>>>24]^i[l>>>16&255]^o[p>>>8&255]^s[255&u]^r[h++],y=n[l>>>24]^i[p>>>16&255]^o[u>>>8&255]^s[255&f]^r[h++],m=n[p>>>24]^i[u>>>16&255]^o[f>>>8&255]^s[255&l]^r[h++];u=g,f=v,l=y,p=m}g=(a[u>>>24]<<24|a[f>>>16&255]<<16|a[l>>>8&255]<<8|a[255&p])^r[h++],v=(a[f>>>24]<<24|a[l>>>16&255]<<16|a[p>>>8&255]<<8|a[255&u])^r[h++],y=(a[l>>>24]<<24|a[p>>>16&255]<<16|a[u>>>8&255]<<8|a[255&f])^r[h++],m=(a[p>>>24]<<24|a[u>>>16&255]<<16|a[f>>>8&255]<<8|a[255&l])^r[h++],e[t]=g,e[t+1]=v,e[t+2]=y,e[t+3]=m},keySize:8});e.AES=t._createHelper(g)}(),n.AES)},function(e,t,r){var n;e.exports=(n=r(1),r(8),r(9),n.HmacSHA1)},function(e,t,r){var n;e.exports=(n=r(1),n.enc.Latin1)},function(e,t,r){var n;e.exports=(n=r(1),n.enc.Hex)},function(e,t,r){var n;e.exports=(n=r(1),r(10),n.pad.NoPadding={pad:function(){},unpad:function(){}},n.pad.NoPadding)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uploadDocToSfsByWeb=t.uploadDocToSfsByWx=void 0;var n=r(3);t.uploadDocToSfsByWx=function(e,t){var r=t.sfs,i=t.fileHash,o=t.file,s=t.onProgress,a=r,c=a.token,u=a.expired_timestamp,f=a.api,l=a.object_name,p={app_id:e.stateCenter.appID,platform:e.stateCenter.platform,user_id:e.stateCenter.userID,expired_timestamp:u,sfs_token:c,file_name:l,file_hash:i},h=new FormData;return h.append("req",new Blob([JSON.stringify(p)],{type:"application/json"})),h.append("document",o),new Promise((function(e,t){try{wx.uploadFile({url:f,filePath:o,name:"file",formData:h,timeout:6e5,success:function(t){e()},fail:function(e){t(e)}}).onProgressUpdate((function(e){var t=e.progress,r=e.totalBytesSent,i=e.totalBytesExpectedToSend;s&&s({status:n.UploadStatus.UPLOADING,uploadPercent:t,loaded:r,total:i})}))}catch(e){t(e)}}))},t.uploadDocToSfsByWeb=function(e,t){var r=t.sfs,i=t.fileHash,o=t.file,s=t.onProgress,a=r,c=a.token,u=a.expired_timestamp,f=a.api,l=a.object_name,p={app_id:e.stateCenter.appID,platform:e.stateCenter.platform,user_id:e.stateCenter.userID,expired_timestamp:u,sfs_token:c,file_name:l,file_hash:i},h=new FormData;return h.append("req",new Blob([JSON.stringify(p)],{type:"application/json"})),h.append("document",o),e.axiosInstance({method:"post",url:f,data:h,timeout:6e5,onUploadProgress:function(e){var t=e.total,r=e.loaded;s&&s({status:n.UploadStatus.UPLOADING,uploadPercent:Math.floor(r/t*100),total:t,loaded:r})}})}},function(e,t,r){e.exports=r(36)},function(e,t,r){"use strict";var n=r(0),i=r(11),o=r(37),s=r(17);function a(e){var t=new o(e),r=i(o.prototype.request,t);return n.extend(r,o.prototype,t),n.extend(r,t),r}var c=a(r(14));c.Axios=o,c.create=function(e){return a(s(c.defaults,e))},c.Cancel=r(18),c.CancelToken=r(51),c.isCancel=r(13),c.all=function(e){return Promise.all(e)},c.spread=r(52),e.exports=c,e.exports.default=c},function(e,t,r){"use strict";var n=r(0),i=r(12),o=r(38),s=r(39),a=r(17);function c(e){this.defaults=e,this.interceptors={request:new o,response:new o}}c.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[s,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)r=r.then(t.shift(),t.shift());return r},c.prototype.getUri=function(e){return e=a(this.defaults,e),i(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},n.forEach(["delete","get","head","options"],(function(e){c.prototype[e]=function(t,r){return this.request(n.merge(r||{},{method:e,url:t}))}})),n.forEach(["post","put","patch"],(function(e){c.prototype[e]=function(t,r,i){return this.request(n.merge(i||{},{method:e,url:t,data:r}))}})),e.exports=c},function(e,t,r){"use strict";var n=r(0);function i(){this.handlers=[]}i.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){n.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},function(e,t,r){"use strict";var n=r(0),i=r(40),o=r(13),s=r(14);function a(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return a(e),e.headers=e.headers||{},e.data=i(e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),n.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||s.adapter)(e).then((function(t){return a(e),t.data=i(t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(a(e),t&&t.response&&(t.response.data=i(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},function(e,t,r){"use strict";var n=r(0);e.exports=function(e,t,r){return n.forEach(r,(function(r){e=r(e,t)})),e}},function(e,t){var r,n,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var c,u=[],f=!1,l=-1;function p(){f&&c&&(f=!1,c.length?u=c.concat(u):l=-1,u.length&&h())}function h(){if(!f){var e=a(p);f=!0;for(var t=u.length;t;){for(c=u,u=[];++l<t;)c&&c[l].run();l=-1,t=u.length}c=null,f=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new d(e,t)),1!==u.length||f||a(h)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,r){"use strict";var n=r(0);e.exports=function(e,t){n.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))}},function(e,t,r){"use strict";var n=r(16);e.exports=function(e,t,r){var i=r.config.validateStatus;!i||i(r.status)?e(r):t(n("Request failed with status code "+r.status,r.config,null,r.request,r))}},function(e,t,r){"use strict";e.exports=function(e,t,r,n,i){return e.config=t,r&&(e.code=r),e.request=n,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},function(e,t,r){"use strict";var n=r(46),i=r(47);e.exports=function(e,t){return e&&!n(t)?i(e,t):t}},function(e,t,r){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,r){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,r){"use strict";var n=r(0),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,o,s={};return e?(n.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=n.trim(e.substr(0,o)).toLowerCase(),r=n.trim(e.substr(o+1)),t){if(s[t]&&i.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([r]):s[t]?s[t]+", "+r:r}})),s):s}},function(e,t,r){"use strict";var n=r(0);e.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function i(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=i(window.location.href),function(t){var r=n.isString(t)?i(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},function(e,t,r){"use strict";var n=r(0);e.exports=n.isStandardBrowserEnv()?{write:function(e,t,r,i,o,s){var a=[];a.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),n.isString(i)&&a.push("path="+i),n.isString(o)&&a.push("domain="+o),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,r){"use strict";var n=r(18);function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;e((function(e){r.reason||(r.reason=new n(e),t(r.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},function(e,t,r){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoDocsView=void 0;var i=n(r(54)),o=r(20),s=function(){function e(e,t,r){this.parent="",this.id="",this.drawMode=o.RenderMode.PDF,this.viewInfo={ticking:!1,percent:0,page:1,total:1,sheet:0,sheetName:"",parentWidth:0,parentHeight:0,width:0,height:0,viewWidth:0,viewHeight:0,rate:1,loaded:!1},this.fileInfo={},this.virtualPageCache={},this.virtualPageAspecCache={},this.dividingLineMap={},this.serviceHandle=e,this.init(t,r)}return e.prototype.setParentWidthHeight=function(e){var t=document.getElementById(e),r=t.clientWidth,n=t.clientHeight;this.viewInfo.parentWidth=r,this.viewInfo.parentHeight=n},e.prototype.drawDividingLine=function(e,t,r,n,s){if(n>0&&this.drawMode===o.RenderMode.PDF){var a=i.default(t);this.dividingLineMap[a]||(e.lineWidth=2,e.beginPath(),e.moveTo(r,n),e.lineTo(r+s,n),e.stroke(),this.dividingLineMap[a]=!0)}},e.prototype.drawImg=function(e,t,r,n,i,o,s,a){var c=this;return new Promise((function(e,t){var u=/https?:\/\//.test(s),f=a.getContext("2d"),l=new Image;l.onload=function(){f.drawImage(l,r,n,i,o),c.drawDividingLine(f,s,r,n,i),e()},l.onerror=t,l.src=u?s:"data:image/png;base64,"+s}))},e.prototype.getDocsViewDomId=function(){return"zego-docsview"+this.id},e.prototype.getIFrameId=function(){return"zego-docsview-iframe"+this.id},e.prototype.getCanvasId=function(){return"zego-docsview-canvas"+this.id},e.prototype.createDocsViewParentIfNeeded=function(e){var t=this;if(!document.getElementById(this.getDocsViewDomId())){var r=document.createElement("div");r.id=this.getDocsViewDomId(),r.style.position="absolute",r.addEventListener("pagechange_wb",(function(e){if(e&&e.detail){var r=t.getPageByScrollTop(e.detail.y);t.handlePageChange(r,e.detail)}}));var n=document.getElementById(this.parent);n.style.position="relative",n.appendChild(r),e&&r.addEventListener("scroll",(function(e){t.viewInfo.ticking||(requestAnimationFrame((function(){var n=e.target.scrollTop+2,i=t.getPageByScrollTop(n),o=t.fileInfo.file_list[t.viewInfo.sheet];t.execScrollFileAndDraw(n,t.viewInfo.parentHeight),t.viewInfo.percent=Number((n/t.viewInfo.height).toFixed(2)),t.serviceHandle.triggerEventListener("onScroll",{fileID:t.fileInfo.fileID,fileType:t.getFileType(),fileName:o.file_name,name:o.name||"",percent:t.viewInfo.percent,page:i,y:n}),t.viewInfo.page!==i&&(t.viewInfo.page=i,r.dispatchEvent(new CustomEvent("pagechange_docs",{detail:{page:i,pageCount:t.viewInfo.total,y:n,scroll:!0}}))),t.viewInfo.ticking=!1})),t.viewInfo.ticking=!0)}))}},e.prototype.updateDocsViewParentLayout=function(e,t,r,n){r|=0,n|=0;var i=document.getElementById(this.getDocsViewDomId());i&&(i.style.width=r+"px",i.style.height=n+"px",i.style.left=(0|e)+"px",i.style.top=(0|t)+"px"),this.viewInfo.width=r,this.viewInfo.viewWidth=r,this.viewInfo.viewHeight=n},e.prototype.hideOtherDocsViewParent=function(){var e=document.getElementById(this.parent);if(e){var t=this.getDocsViewDomId();Array.from(e.children).forEach((function(e){e.style.display=e.id==t?"block":"none"}))}},e.prototype.drawImgByPath=function(e,t,r){var n=this;return new Promise((function(i,s){var a=t.getContext("2d"),c=new Image;c.onload=function(){var e={},s=c.width,u=c.height;if(s<640&&u<400){var f=640/s,l=400/u,p=s*(m=Math.min(f,l))|0,h=u*m|0,d=(t.width-p)/2,g=(t.height-h)/2;t.width=p,t.height=h,a.drawImage(c,0,0,s,u,0,0,p,h),e={x:d,y:g,w:p,h:h}}else if(s>1440){n.drawMode=o.RenderMode.PDF;var v=s*n.viewInfo.rate|0,y=u*n.viewInfo.rate|0;t.height=y,a.drawImage(c,0,r,s,u,0,0,v,y),e={x:0,y:0,w:n.viewInfo.parentWidth,h:n.viewInfo.parentHeight}}else if(u/s<=2.2){var m;f=n.viewInfo.parentWidth/s,l=n.viewInfo.parentHeight/u,p=s*(m=Math.min(f,l))|0,h=u*m|0,d=(n.viewInfo.parentWidth-p)/2,g=(n.viewInfo.parentHeight-h)/2;t.width=p,t.height=h,a.drawImage(c,0,0,s,u,0,0,p,h),e={x:d,y:g,w:p,h:h}}else{p=s*n.viewInfo.rate|0,h=u*n.viewInfo.rate|0;t.width=p,t.height=h,a.drawImage(c,0,r,s,u,0,0,p,h),e={x:0,y:r,w:p,h:h}}n.updateDocsViewParentLayout(e.x,e.y,e.w,e.h);var w=n.fileInfo.file_list[n.viewInfo.sheet];w.rate=Number((n.viewInfo.parentWidth/t.width).toFixed(2)),w.max_width=t.width,w.total_height=t.height,n.viewInfo.height=t.height,n.viewInfo.rate=w.rate,i()},c.onerror=s,c.src=e.image_path}))},e.prototype.drawImgByVPageList=function(e,t,r,n){var i=this;this.drawMode===o.RenderMode.PPT&&(t=0);var s=t;this.createDocsViewParentIfNeeded(this.drawMode!==o.RenderMode.PPT&&!r[0].image_path),this.hideOtherDocsViewParent();var a=this.getCanvasId(),c=document.getElementById(a),u=!c;if(!c){(c=document.createElement("canvas")).id=a,c.width=this.viewInfo.parentWidth;var f=this.getFileType();if(f===o.FileType.PPT){var l=this.virtualPageAspecCache[this.viewInfo.sheet][1];c.width=l.w,c.height=l.h,c.setAttribute("data-page",this.viewInfo.total+""),this.updateDocsViewParentLayout(l.x,l.y,l.w,l.h)}else f===o.FileType.IMG?(this.viewInfo.height=this.viewInfo.parentHeight,c.height=this.viewInfo.parentHeight):(c.height=this.viewInfo.height,this.updateDocsViewParentLayout(0,0,this.viewInfo.parentWidth,this.viewInfo.parentHeight))}r.map((function(e){return e.virtual_page_number})).join();if(this.drawMode===o.RenderMode.PPT){var p=r.find((function(e){return e.virtual_page_number===i.viewInfo.page}));r=p?[p]:[]}for(var h=[],d=0;d<r.length;++d){var g=r[d],v=g.width,y=g.height,m=g.image_data,w=g.image_path;if(m)if(this.drawMode===o.RenderMode.PPT){l=this.virtualPageAspecCache[this.viewInfo.sheet][1];var _=this.drawImg(v,y,0,s,l.w,l.h,m,c);h.push(_)}else{_=this.drawImg(v,y,0,s,v,y,m,c);s+=y,h.push(_)}else if(w){_=this.drawImgByPath(r[0],c,t);h.push(_)}}Promise.all(h).then((function(){var e=document.getElementById(i.getDocsViewDomId());if(e&&u){e.appendChild(c);var t=Number(e.style.height.replace("px",""))+20;e.style.overflowX="hidden",e.style.overflowY=c.height>t?" auto":"hidden"}n&&n()}))},e.prototype.drawHtmlByVPageList=function(e,t){var r=this;this.createDocsViewParentIfNeeded(!1),this.hideOtherDocsViewParent();var n=this.virtualPageAspecCache[this.viewInfo.sheet][1],i=n.x,o=n.y,s=n.w,a=n.h,c=this.getIFrameId(),u=document.getElementById(c),f=!u;if(!u){(u=document.createElement("iframe")).id=c,u.width=s,u.height=a;var l="pointer-events:none;";s>1280&&(l+="transform:scale("+(s/1280).toFixed(2)+");"),u.style.cssText=l,u.setAttribute("data-page",this.viewInfo.total+"")}u.src=e;window.addEventListener("message",(function(e){var t=e.data;t&&"zegodocsview"===t.source&&("currentPage"===t.action?r.viewInfo.page=t.res+1:t.action||r.viewInfo.loaded||(r.viewInfo.loaded=!0,r.postMessage2iframe("gotoPage",[r.viewInfo.page-1])))})),this.updateDocsViewParentLayout(i,o,s,a);var p=document.getElementById(this.getDocsViewDomId());p&&f&&(p.appendChild(u),p.style.overflow="hidden"),t&&t()},e.prototype.getAllVirtualInPageRange=function(e,t,r){for(var n=[],i=0;i<e.length;++i)if(i>=t&&i<r)for(var o=0;o<e[i].virtual_page_list.length;++o)n.push(e[i].virtual_page_list[o].virtual_page_number);return n},e.prototype.startGetImageByVirtualPageList=function(e,t,r,n){for(var i=[],o=0;o<t.length;){var s=this.virtualPageCache[this.viewInfo.sheet]&&this.virtualPageCache[this.viewInfo.sheet][t[o]];s?(i.push(s),t.splice(o,1)):o++}this.getImageByVirtualPageList(i,e,t,r,n)},e.prototype.sortVirtualPageListRule=function(e,t){return e.virtual_page_number-t.virtual_page_number},e.prototype.getImageByVirtualPageList=function(e,t,r,n,i){var o=this;if(r.length<=0)return e.sort(this.sortVirtualPageListRule),void i(e);this.serviceHandle.registerEventHandler(this.id,"onDocsGetPDFPageImage",(function(s){for(var a=0;a<r.length;++a)if(r[a]==s.virtual_page_number){r.splice(a,1);break}o.virtualPageCache[o.viewInfo.sheet]=o.virtualPageCache[o.viewInfo.sheet]||{},o.virtualPageCache[o.viewInfo.sheet][s.virtual_page_number]=s;var c=!1;for(a=0;a<e.length;++a)e[a].virtual_page_number==s.virtual_page_number&&(e[a]=s,c=!0);c||e.push(s),o.getImageByVirtualPageList(e,t,r,n,i)})),this.serviceHandle.getPageImage(this.id,{sheet:this.viewInfo.sheet,file_id:t,virtual_page_number:r[0],rate:n,rotation:0,res:this.fileInfo})},e.prototype.getPageNumberByYPos=function(e,t){for(var r=0,n=0,i=0;i<e.length;++i)for(var o=0;o<e[i].virtual_page_list.length;++o){if((e[i].virtual_page_list[o].height+r)*this.viewInfo.rate>=t)return i;r+=e[i].virtual_page_list[o].height,n=i}return n},e.prototype.getHeightByPage=function(e,t){for(var r=0,n=0;n<e.length&&!(n>=t);++n)for(var i=0;i<e[n].virtual_page_list.length;++i)r+=e[n].virtual_page_list[i].height;return r},e.prototype.execScrollFileAndDraw=function(e,t,r){var n=this,i=this.fileInfo.file_list[this.viewInfo.sheet].page_list,s=Math.min(this.getPageNumberByYPos(i,e),this.viewInfo.page-1),a=Math.max(this.getPageNumberByYPos(i,e+t)+3,this.viewInfo.page),c=this.getAllVirtualInPageRange(i,s,a),u=this.getHeightByPage(i,s)*this.viewInfo.rate;this.startGetImageByVirtualPageList(this.fileInfo.fileID,c,this.viewInfo.rate,(function(e){n.drawMode===o.RenderMode.PPTH5?n.drawHtmlByVPageList(e[0].image_data,r):n.drawImgByVPageList(0,u,e,r)}))},e.prototype.loadCurrentSheet=function(){var e=this,t=this.fileInfo.file_list[this.viewInfo.sheet];if(t){var r=this.getFileType();if(this.viewInfo.width=t.max_width,this.viewInfo.height=t.total_height,this.viewInfo.total=t.page_count,this.viewInfo.rate=t.rate,r===o.FileType.PPT?this.drawMode=o.RenderMode.PPT:r===o.FileType.PPTH5?this.drawMode=o.RenderMode.PPTH5:this.drawMode=o.RenderMode.PDF,r===o.FileType.ELS){var n=document.getElementById(this.getCanvasId());n&&(n.width=this.viewInfo.width,n.height=this.viewInfo.height)}this.execScrollFileAndDraw(0,this.viewInfo.parentHeight,(function(){var n,i={fileID:e.fileInfo.user_data,fileName:t.file_name,fileType:r,pageCount:t.page_count,width:e.viewInfo.width,height:e.viewInfo.height,viewID:e.getDocsViewDomId()},s=((n={fileID:i.fileID})[i.fileName]={width:e.viewInfo.width,height:e.viewInfo.height,pageCount:i.pageCount},n);r===o.FileType.ELS&&(i.name=t.name,i.sheets=e.fileInfo.file_list.map((function(e){return s[e.file_name]={width:e.max_width,height:e.total_height,pageCount:e.page_count},e.file_name}))),document.body.dispatchEvent(new CustomEvent("loadfile",{detail:s})),e.serviceHandle.triggerEventListener("onLoadFile",i)}))}},e.prototype.init=function(e,t){var r=this;this.parent=e,this.id=t,this.serviceHandle.registerEventHandler(t,"onDocsUploading",(function(e){0==e.error_code?r.serviceHandle.triggerEventListener("onUpload",{uploadPercent:100*e.rate}):r.serviceHandle.triggerEventListener("onUpload",{fileID:e.file_id,uploadPercent:100})})),this.serviceHandle.registerEventHandler(t,"onDocsConvertStatus",(function(e){16==e.convert_status&&r.serviceHandle.triggerEventListener("onUpload",{fileID:e.file_id,uploadPercent:100})})),this.serviceHandle.registerEventHandler(t,"onDocsLoadPdf",(function(e){r.setParentWidthHeight(r.parent);for(var t=e.document_type,n=0;n<e.file_list.length;++n){r.virtualPageAspecCache[n]={};var i=e.file_list[n];if(t===o.FileType.ELS?(i.page_count=i.page_list.length,i.file_name=i.file_name.replace(/\.[a-zA-Z]+$/,""),i.file_name===r.viewInfo.sheetName&&(r.viewInfo.sheet=n)):i.page_count=e.page_count||i.page_list.length,t===o.FileType.PPTH5&&i.file_url){var s=i.page_list[0],a=s.width,c=s.height;i.page_list=[{width:a,height:c,virtual_page_list:[{width:a,height:c,virtual_page_number:1}]}],i.max_width=a}else{for(var u=0,f=0;f<i.page_list.length;++f){(a=i.page_list[f].width)>u&&(u=a)}i.max_width=u}if(i.rate=Number((r.viewInfo.parentWidth/i.max_width).toFixed(2)),t===o.FileType.PPTH5||t===o.FileType.PPT||t===o.FileType.IMG){var l=r.viewInfo.parentWidth,p=i.page_list[0].height*l/i.max_width|0;p>r.viewInfo.parentHeight&&(l=r.viewInfo.parentHeight*r.viewInfo.parentWidth/p|0,p=r.viewInfo.parentHeight);var h={x:(r.viewInfo.parentWidth-l)/2,y:(r.viewInfo.parentHeight-p)/2,w:l,h:p};for(f=0;f<i.page_count;++f)r.virtualPageAspecCache[n][f+1]=h;i.max_width=l,i.total_height=p*i.page_count}else{var d=0;for(f=0;f<i.page_list.length;++f){var g=i.page_list[f].height*r.viewInfo.parentWidth/i.max_width|0;d+=g,r.virtualPageAspecCache[n][f+1]={x:0,y:0,w:r.viewInfo.parentWidth,h:g}}i.max_width=r.viewInfo.parentWidth,i.total_height=d}}Object.assign(r.fileInfo,e),r.loadCurrentSheet()}))},e.prototype.handleScroll=function(e,t){var r=this,n=document.getElementById(this.getDocsViewDomId()),i=this.drawMode===o.RenderMode.PDF;n&&(this.drawMode===o.RenderMode.PPT?this.execScrollFileAndDraw(e,this.viewInfo.viewHeight):i&&!this.viewInfo.ticking&&(this.viewInfo.ticking=!0,n.scrollTo(0,e),setTimeout((function(){r.viewInfo.ticking=!1}),34)),n.dispatchEvent(new CustomEvent("pagechange_docs",{detail:{page:this.viewInfo.page,pageCount:this.viewInfo.total,y:e,scroll:i,notify:t}})))},e.prototype.getScrollTopByPage=function(){var e=0;if(this.drawMode===o.RenderMode.PPT||this.drawMode===o.RenderMode.PPTH5)e=(this.viewInfo.page-1)*this.viewInfo.viewHeight;else for(var t=this.virtualPageAspecCache[this.viewInfo.sheet],r=1;r<this.viewInfo.page;r++)e+=t[r].h;return e+2},e.prototype.getPageByScrollTop=function(e){var t=this.getFileType(),r=this.viewInfo.viewHeight/2;if(t===o.FileType.IMG||e<=r)return 1;if(t===o.FileType.PPT||t===o.FileType.PPTH5)return Math.round(e/this.viewInfo.viewHeight)+1;for(var n=this.virtualPageAspecCache[this.viewInfo.sheet],i=-r,s=1;i<=e&&n[s];)i+=n[s].h,s++;return s-1},e.prototype.postMessage2iframe=function(e,t){var r=document.getElementById(this.getIFrameId());r&&r.contentWindow&&r.contentWindow.postMessage({source:"zegodocsview",action:e,args:t||[]},"*")},e.prototype.handlePageChange=function(e,t){e!==this.viewInfo.page?(this.viewInfo.page=e-1,this.viewInfo.total>1&&this.viewInfo.page<this.viewInfo.total&&(this.viewInfo.page+=1,this.drawMode===o.RenderMode.PPTH5&&this.postMessage2iframe("gotoPage",[this.viewInfo.page-1]),this.handleScroll(t.y,!t.push))):this.handleScroll(t.y,!t.push)},e.prototype.setSheetName=function(e){this.viewInfo.sheetName=e},e.prototype.loadFile=function(e,t){return this.virtualPageCache={},this.virtualPageAspecCache={},this.fileInfo.fileID=e,this.fileInfo.authKey=t,this.viewInfo.ticking=!1,this.serviceHandle.load(this.id,{fileID:e,authKey:t})},e.prototype.getContentSize=function(){return{width:this.viewInfo.width,height:this.viewInfo.height}},e.prototype.getVisibleSize=function(){return{width:this.viewInfo.viewWidth,height:this.viewInfo.viewHeight}},e.prototype.getFileID=function(){return this.fileInfo.fileID},e.prototype.getFileType=function(){return this.fileInfo.document_type},e.prototype.getCurrentPage=function(){return this.viewInfo.page},e.prototype.getPageCount=function(){return this.viewInfo.total},e.prototype.getVerticalPercent=function(){return this.viewInfo.percent},e.prototype.scrollTo=function(e){var t=Math.ceil(e*this.viewInfo.height),r=this.getPageByScrollTop(t);r!==this.viewInfo.page&&(this.viewInfo.page=r-1,this.nextPage())},e.prototype.flipPage=function(e){var t=this.getPageCount();e<1?e=1:e>t?e=t:e|=0,e!==this.viewInfo.page&&(this.viewInfo.page=e-1,this.nextPage())},e.prototype.previousStep=function(){this.postMessage2iframe("previousStep"),this.postMessage2iframe("currentPage")},e.prototype.nextStep=function(){this.postMessage2iframe("nextStep"),this.postMessage2iframe("currentPage")},e.prototype.loadSheet=function(e){this.getFileType()===o.FileType.ELS&&e>=0&&e<this.fileInfo.file_list.length&&(this.viewInfo.sheet=e,this.loadCurrentSheet())},e.prototype.previousPage=function(){this.viewInfo.total>1&&this.viewInfo.page>1&&(this.viewInfo.page-=1,this.drawMode===o.RenderMode.PPTH5&&this.postMessage2iframe("gotoPage",[this.viewInfo.page-1]),this.handleScroll(this.getScrollTopByPage(),!0))},e.prototype.nextPage=function(){this.viewInfo.total>1&&this.viewInfo.page<this.viewInfo.total&&(this.viewInfo.page+=1,this.drawMode===o.RenderMode.PPTH5&&this.postMessage2iframe("gotoPage",[this.viewInfo.page-1]),this.handleScroll(this.getScrollTopByPage(),!0))},e}();t.ZegoDocsView=s},function(e,t,r){var n,i,o,s,a;n=r(55),i=r(19).utf8,o=r(56),s=r(19).bin,(a=function(e,t){e.constructor==String?e=t&&"binary"===t.encoding?s.stringToBytes(e):i.stringToBytes(e):o(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||(e=e.toString());for(var r=n.bytesToWords(e),c=8*e.length,u=1732584193,f=-271733879,l=-1732584194,p=271733878,h=0;h<r.length;h++)r[h]=16711935&(r[h]<<8|r[h]>>>24)|4278255360&(r[h]<<24|r[h]>>>8);r[c>>>5]|=128<<c%32,r[14+(c+64>>>9<<4)]=c;var d=a._ff,g=a._gg,v=a._hh,y=a._ii;for(h=0;h<r.length;h+=16){var m=u,w=f,_=l,P=p;u=d(u,f,l,p,r[h+0],7,-680876936),p=d(p,u,f,l,r[h+1],12,-389564586),l=d(l,p,u,f,r[h+2],17,606105819),f=d(f,l,p,u,r[h+3],22,-1044525330),u=d(u,f,l,p,r[h+4],7,-176418897),p=d(p,u,f,l,r[h+5],12,1200080426),l=d(l,p,u,f,r[h+6],17,-1473231341),f=d(f,l,p,u,r[h+7],22,-45705983),u=d(u,f,l,p,r[h+8],7,1770035416),p=d(p,u,f,l,r[h+9],12,-1958414417),l=d(l,p,u,f,r[h+10],17,-42063),f=d(f,l,p,u,r[h+11],22,-1990404162),u=d(u,f,l,p,r[h+12],7,1804603682),p=d(p,u,f,l,r[h+13],12,-40341101),l=d(l,p,u,f,r[h+14],17,-1502002290),u=g(u,f=d(f,l,p,u,r[h+15],22,1236535329),l,p,r[h+1],5,-165796510),p=g(p,u,f,l,r[h+6],9,-1069501632),l=g(l,p,u,f,r[h+11],14,643717713),f=g(f,l,p,u,r[h+0],20,-373897302),u=g(u,f,l,p,r[h+5],5,-701558691),p=g(p,u,f,l,r[h+10],9,38016083),l=g(l,p,u,f,r[h+15],14,-660478335),f=g(f,l,p,u,r[h+4],20,-405537848),u=g(u,f,l,p,r[h+9],5,568446438),p=g(p,u,f,l,r[h+14],9,-1019803690),l=g(l,p,u,f,r[h+3],14,-187363961),f=g(f,l,p,u,r[h+8],20,1163531501),u=g(u,f,l,p,r[h+13],5,-1444681467),p=g(p,u,f,l,r[h+2],9,-51403784),l=g(l,p,u,f,r[h+7],14,1735328473),u=v(u,f=g(f,l,p,u,r[h+12],20,-1926607734),l,p,r[h+5],4,-378558),p=v(p,u,f,l,r[h+8],11,-2022574463),l=v(l,p,u,f,r[h+11],16,1839030562),f=v(f,l,p,u,r[h+14],23,-35309556),u=v(u,f,l,p,r[h+1],4,-1530992060),p=v(p,u,f,l,r[h+4],11,1272893353),l=v(l,p,u,f,r[h+7],16,-155497632),f=v(f,l,p,u,r[h+10],23,-1094730640),u=v(u,f,l,p,r[h+13],4,681279174),p=v(p,u,f,l,r[h+0],11,-358537222),l=v(l,p,u,f,r[h+3],16,-722521979),f=v(f,l,p,u,r[h+6],23,76029189),u=v(u,f,l,p,r[h+9],4,-640364487),p=v(p,u,f,l,r[h+12],11,-421815835),l=v(l,p,u,f,r[h+15],16,530742520),u=y(u,f=v(f,l,p,u,r[h+2],23,-995338651),l,p,r[h+0],6,-198630844),p=y(p,u,f,l,r[h+7],10,1126891415),l=y(l,p,u,f,r[h+14],15,-1416354905),f=y(f,l,p,u,r[h+5],21,-57434055),u=y(u,f,l,p,r[h+12],6,1700485571),p=y(p,u,f,l,r[h+3],10,-1894986606),l=y(l,p,u,f,r[h+10],15,-1051523),f=y(f,l,p,u,r[h+1],21,-2054922799),u=y(u,f,l,p,r[h+8],6,1873313359),p=y(p,u,f,l,r[h+15],10,-30611744),l=y(l,p,u,f,r[h+6],15,-1560198380),f=y(f,l,p,u,r[h+13],21,1309151649),u=y(u,f,l,p,r[h+4],6,-145523070),p=y(p,u,f,l,r[h+11],10,-1120210379),l=y(l,p,u,f,r[h+2],15,718787259),f=y(f,l,p,u,r[h+9],21,-343485551),u=u+m>>>0,f=f+w>>>0,l=l+_>>>0,p=p+P>>>0}return n.endian([u,f,l,p])})._ff=function(e,t,r,n,i,o,s){var a=e+(t&r|~t&n)+(i>>>0)+s;return(a<<o|a>>>32-o)+t},a._gg=function(e,t,r,n,i,o,s){var a=e+(t&n|r&~n)+(i>>>0)+s;return(a<<o|a>>>32-o)+t},a._hh=function(e,t,r,n,i,o,s){var a=e+(t^r^n)+(i>>>0)+s;return(a<<o|a>>>32-o)+t},a._ii=function(e,t,r,n,i,o,s){var a=e+(r^(t|~n))+(i>>>0)+s;return(a<<o|a>>>32-o)+t},a._blocksize=16,a._digestsize=16,e.exports=function(e,t){if(null==e)throw new Error("Illegal argument "+e);var r=n.wordsToBytes(a(e,t));return t&&t.asBytes?r:t&&t.asString?s.bytesToString(r):n.bytesToHex(r)}},function(e,t){var r,n;r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&n.rotl(e,8)|4278255360&n.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=n.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],r=0,n=0;r<e.length;r++,n+=8)t[n>>>5]|=e[r]<<24-n%32;return t},wordsToBytes:function(e){for(var t=[],r=0;r<32*e.length;r+=8)t.push(e[r>>>5]>>>24-r%32&255);return t},bytesToHex:function(e){for(var t=[],r=0;r<e.length;r++)t.push((e[r]>>>4).toString(16)),t.push((15&e[r]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(parseInt(e.substr(r,2),16));return t},bytesToBase64:function(e){for(var t=[],n=0;n<e.length;n+=3)for(var i=e[n]<<16|e[n+1]<<8|e[n+2],o=0;o<4;o++)8*n+6*o<=8*e.length?t.push(r.charAt(i>>>6*(3-o)&63)):t.push("=");return t.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var t=[],n=0,i=0;n<e.length;i=++n%4)0!=i&&t.push((r.indexOf(e.charAt(n-1))&Math.pow(2,-2*i+8)-1)<<2*i|r.indexOf(e.charAt(n))>>>6-2*i);return t}},e.exports=n},function(e,t){function r(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(r(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&r(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoDocsViewService=void 0;var o=r(58),s=r(20),a=function(e){function t(t){var r=e.call(this)||this;return r.listeners={},r.zegoDocs=t,r}return i(t,e),t.prototype.setTestEnv=function(e){this.zegoDocs.setTestEnv(e)},t.prototype.setConfig=function(e,t){return this.zegoDocs.setConfig(e,t)},t.prototype.getConfig=function(e){return this.zegoDocs.getConfig(e)},t.prototype.registerEventHandler=function(e,t,r){this.listeners[t]=this.listeners[t]||{},this.listeners[t][e]=r},t.prototype.load=function(e,t){var r=this;return this.zegoDocs.load(t).then((function(t){var n=r.transLoadFile(t),i=r.listeners.onDocsLoadPdf[e];return i&&setTimeout((function(){return i(n)})),t}))},t.prototype.upload=function(e){var t=this;return e.onProgress=function(e){t.triggerEventListener("onUpload",e)},this.zegoDocs.upload(e)},t.prototype.init=function(e){},t.prototype.setLogFolder=function(e){},t.prototype.setCacheDirectory=function(e){},t.prototype.getPageImage=function(e,t){var r=this.listeners.onDocsGetPDFPageImage[e];r&&r(this.transImage(t))},t.prototype.transLoadFile=function(e){var t=e.width,r=e.height,n=e.fileType===s.FileType.ELS,i=n?e.file_list:[{file_name:e.fileName,page_list:e.fileUrls.map((function(e,n){return{width:t,height:r,src:e,virtual_page_list:[{width:t,height:r,virtual_page_number:n+1}]}}))}];return n&&i.forEach((function(e){e.file_name=e.file_name.replace(/\.[a-zA-Z]+$/,"")})),{user_data:e.fileID,document_type:e.fileType,page_count:e.pageCount,file_list:i}},t.prototype.transImage=function(e){var t=e.file_id,r=e.virtual_page_number,n=e.rate,i=e.res,o=e.sheet,a=i.document_type===s.FileType.IMG,c=i.file_list[o].page_list[r-1],u=c.width,f=c.height,l=c.src;return{error_code:0,file_id:t,width:u*n|0,height:f*n|0,image_data:a?"":l,image_path:a?l:"",virtual_page_number:r}},t}(o.ZegoDocsViewServiceBase);t.ZegoDocsViewService=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoDocsViewServiceBase=void 0;var n=function(){function e(){this.customListeners={onLoadFile:[],onUpload:[],onScroll:[]}}return e.prototype.addEventListener=function(e,t){return!!this.customListeners[e]&&("function"==typeof t&&(-1==this.customListeners[e].indexOf(t)&&this.customListeners[e].push(t),!0))},e.prototype.removeEventListener=function(e,t){if(!this.customListeners[e])return!1;var r=this.customListeners[e];return t?r.splice(r.indexOf(t),1):this.customListeners[e]=[],!0},e.prototype.triggerEventListener=function(e,t){this.customListeners[e].forEach((function(e){return e(t)}))},e}();t.ZegoDocsViewServiceBase=n}])}));