(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-vendors"],{"00b4":function(e,t,r){"use strict";r("ac1f");var i=r("23e7"),n=r("da84"),o=r("c65b"),s=r("e330"),a=r("1626"),c=r("861d"),l=function(){var e=!1,t=/[ac]/;return t.exec=function(){return e=!0,/./.exec.apply(this,arguments)},!0===t.test("abc")&&e}(),u=n.Error,d=s(/./.test);i({target:"RegExp",proto:!0,forced:!l},{test:function(e){var t=this.exec;if(!a(t))return d(this,e);var r=o(t,this,e);if(null!==r&&!c(r))throw new u("RegExp exec method returned something other than an Object or null");return!!r}})},"00ee":function(e,t,r){var i=r("b622"),n=i("toStringTag"),o={};o[n]="z",e.exports="[object z]"===String(o)},"01b4":function(e,t){var r=function(){this.head=null,this.tail=null};r.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}},e.exports=r},"0366":function(e,t,r){var i=r("e330"),n=r("59ed"),o=r("40d5"),s=i(i.bind);e.exports=function(e,t){return n(e),void 0===t?e:o?s(e,t):function(){return e.apply(t,arguments)}}},"03d6":function(e,t,r){var i=r("9c0e"),n=r("6ca1"),o=r("39ad")(!1),s=r("5a94")("IE_PROTO");e.exports=function(e,t){var r,a=n(e),c=0,l=[];for(r in a)r!=s&&i(a,r)&&l.push(r);while(t.length>c)i(a,r=t[c++])&&(~o(l,r)||l.push(r));return l}},"04d1":function(e,t,r){var i=r("342f"),n=i.match(/firefox\/(\d+)/i);e.exports=!!n&&+n[1]},"051b":function(e,t,r){var i=r("1a14"),n=r("10db");e.exports=r("0bad")?function(e,t,r){return i.f(e,t,n(1,r))}:function(e,t,r){return e[t]=r,e}},"0538":function(e,t,r){"use strict";var i=r("da84"),n=r("e330"),o=r("59ed"),s=r("861d"),a=r("1a2d"),c=r("f36a"),l=r("40d5"),u=i.Function,d=n([].concat),h=n([].join),p={},f=function(e,t,r){if(!a(p,t)){for(var i=[],n=0;n<t;n++)i[n]="a["+n+"]";p[t]=u("C,a","return new C("+h(i,",")+")")}return p[t](e,r)};e.exports=l?u.bind:function(e){var t=o(this),r=t.prototype,i=c(arguments,1),n=function(){var r=d(i,c(arguments));return this instanceof n?f(t,r.length,r):t.apply(e,r)};return s(r)&&(n.prototype=r),n}},"057f":function(e,t,r){var i=r("c6b6"),n=r("fc6a"),o=r("241c").f,s=r("4dae"),a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(e){try{return o(e)}catch(t){return s(a)}};e.exports.f=function(e){return a&&"Window"==i(e)?c(e):o(n(e))}},"05f5":function(e,t,r){var i=r("7a41"),n=r("ef08").document,o=i(n)&&i(n.createElement);e.exports=function(e){return o?n.createElement(e):{}}},"06cf":function(e,t,r){var i=r("83ab"),n=r("c65b"),o=r("d1e7"),s=r("5c6c"),a=r("fc6a"),c=r("a04b"),l=r("1a2d"),u=r("0cfb"),d=Object.getOwnPropertyDescriptor;t.f=i?d:function(e,t){if(e=a(e),t=c(t),u)try{return d(e,t)}catch(r){}if(l(e,t))return s(!n(o.f,e,t),e[t])}},"072d":function(e,t,r){"use strict";var i=r("0bad"),n=r("9876"),o=r("fed5"),s=r("1917"),a=r("0983"),c=r("9fbb"),l=Object.assign;e.exports=!l||r("4b8b")((function(){var e={},t={},r=Symbol(),i="abcdefghijklmnopqrst";return e[r]=7,i.split("").forEach((function(e){t[e]=e})),7!=l({},e)[r]||Object.keys(l({},t)).join("")!=i}))?function(e,t){var r=a(e),l=arguments.length,u=1,d=o.f,h=s.f;while(l>u){var p,f=c(arguments[u++]),g=d?n(f).concat(d(f)):n(f),m=g.length,_=0;while(m>_)p=g[_++],i&&!h.call(f,p)||(r[p]=f[p])}return r}:l},"07ac":function(e,t,r){var i=r("23e7"),n=r("6f53").values;i({target:"Object",stat:!0},{values:function(e){return n(e)}})},"07fa":function(e,t,r){var i=r("50c4");e.exports=function(e){return i(e.length)}},"0983":function(e,t,r){var i=r("c901");e.exports=function(e){return Object(i(e))}},"0a06":function(e,t,r){"use strict";var i=r("c532"),n=r("30b5"),o=r("f6b4"),s=r("5270"),a=r("4a7b"),c=r("848b"),l=c.validators;function u(e){this.defaults=e,this.interceptors={request:new o,response:new o}}u.prototype.request=function(e){"string"===typeof e?(e=arguments[1]||{},e.url=arguments[0]):e=e||{},e=a(this.defaults,e),e.method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&c.assertOptions(t,{silentJSONParsing:l.transitional(l.boolean),forcedJSONParsing:l.transitional(l.boolean),clarifyTimeoutError:l.transitional(l.boolean)},!1);var r=[],i=!0;this.interceptors.request.forEach((function(t){"function"===typeof t.runWhen&&!1===t.runWhen(e)||(i=i&&t.synchronous,r.unshift(t.fulfilled,t.rejected))}));var n,o=[];if(this.interceptors.response.forEach((function(e){o.push(e.fulfilled,e.rejected)})),!i){var u=[s,void 0];Array.prototype.unshift.apply(u,r),u=u.concat(o),n=Promise.resolve(e);while(u.length)n=n.then(u.shift(),u.shift());return n}var d=e;while(r.length){var h=r.shift(),p=r.shift();try{d=h(d)}catch(f){p(f);break}}try{n=s(d)}catch(f){return Promise.reject(f)}while(o.length)n=n.then(o.shift(),o.shift());return n},u.prototype.getUri=function(e){return e=a(this.defaults,e),n(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},i.forEach(["delete","get","head","options"],(function(e){u.prototype[e]=function(t,r){return this.request(a(r||{},{method:e,url:t,data:(r||{}).data}))}})),i.forEach(["post","put","patch"],(function(e){u.prototype[e]=function(t,r,i){return this.request(a(i||{},{method:e,url:t,data:r}))}})),e.exports=u},"0ae2":function(e,t,r){var i=r("9876"),n=r("fed5"),o=r("1917");e.exports=function(e){var t=i(e),r=n.f;if(r){var s,a=r(e),c=o.f,l=0;while(a.length>l)c.call(e,s=a[l++])&&t.push(s)}return t}},"0b25":function(e,t,r){var i=r("da84"),n=r("5926"),o=r("50c4"),s=i.RangeError;e.exports=function(e){if(void 0===e)return 0;var t=n(e),r=o(t);if(t!==r)throw s("Wrong length or index");return r}},"0b42":function(e,t,r){var i=r("da84"),n=r("e8b5"),o=r("68ee"),s=r("861d"),a=r("b622"),c=a("species"),l=i.Array;e.exports=function(e){var t;return n(e)&&(t=e.constructor,o(t)&&(t===l||n(t.prototype))?t=void 0:s(t)&&(t=t[c],null===t&&(t=void 0))),void 0===t?l:t}},"0b99":function(e,t,r){"use strict";var i=r("19fa")(!0);r("393a")(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=i(t,r),this._i+=e.length,{value:e,done:!1})}))},"0bad":function(e,t,r){e.exports=!r("4b8b")((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},"0cb2":function(e,t,r){var i=r("e330"),n=r("7b0b"),o=Math.floor,s=i("".charAt),a=i("".replace),c=i("".slice),l=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,r,i,d,h){var p=r+e.length,f=i.length,g=u;return void 0!==d&&(d=n(d),g=l),a(h,g,(function(n,a){var l;switch(s(a,0)){case"$":return"$";case"&":return e;case"`":return c(t,0,r);case"'":return c(t,p);case"<":l=d[c(a,1,-1)];break;default:var u=+a;if(0===u)return n;if(u>f){var h=o(u/10);return 0===h?n:h<=f?void 0===i[h-1]?s(a,1):i[h-1]+s(a,1):n}l=i[u-1]}return void 0===l?"":l}))}},"0cfb":function(e,t,r){var i=r("83ab"),n=r("d039"),o=r("cc12");e.exports=!i&&!n((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},"0d3b":function(e,t,r){var i=r("d039"),n=r("b622"),o=r("c430"),s=n("iterator");e.exports=!i((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r="";return e.pathname="c%20d",t.forEach((function(e,i){t["delete"]("b"),r+=i+e})),o&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[s]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==r||"x"!==new URL("http://x",void 0).host}))},"0d51":function(e,t,r){var i=r("da84"),n=i.String;e.exports=function(e){try{return n(e)}catch(t){return"Object"}}},"0df6":function(e,t,r){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},"0e15":function(e,t,r){var i=r("597f");e.exports=function(e,t,r){return void 0===r?i(e,t,!1):i(e,r,!1!==t)}},"0fae":function(e,t,r){},"107c":function(e,t,r){var i=r("d039"),n=r("da84"),o=n.RegExp;e.exports=i((function(){var e=o("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},1098:function(e,t,r){"use strict";t.__esModule=!0;var i=r("17ed"),n=c(i),o=r("f893"),s=c(o),a="function"===typeof s.default&&"symbol"===typeof n.default?function(e){return typeof e}:function(e){return e&&"function"===typeof s.default&&e.constructor===s.default&&e!==s.default.prototype?"symbol":typeof e};function c(e){return e&&e.__esModule?e:{default:e}}t.default="function"===typeof s.default&&"symbol"===a(n.default)?function(e){return"undefined"===typeof e?"undefined":a(e)}:function(e){return e&&"function"===typeof s.default&&e.constructor===s.default&&e!==s.default.prototype?"symbol":"undefined"===typeof e?"undefined":a(e)}},"10db":function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},1276:function(e,t,r){"use strict";var i=r("2ba4"),n=r("c65b"),o=r("e330"),s=r("d784"),a=r("44e7"),c=r("825a"),l=r("1d80"),u=r("4840"),d=r("8aa5"),h=r("50c4"),p=r("577e"),f=r("dc4a"),g=r("4dae"),m=r("14c3"),_=r("9263"),v=r("9f7f"),E=r("d039"),A=v.UNSUPPORTED_Y,y=4294967295,S=Math.min,C=[].push,T=o(/./.exec),b=o(C),I=o("".slice),R=!E((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2!==r.length||"a"!==r[0]||"b"!==r[1]}));s("split",(function(e,t,r){var o;return o="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var o=p(l(this)),s=void 0===r?y:r>>>0;if(0===s)return[];if(void 0===e)return[o];if(!a(e))return n(t,o,e,s);var c,u,d,h=[],f=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),m=0,v=new RegExp(e.source,f+"g");while(c=n(_,v,o)){if(u=v.lastIndex,u>m&&(b(h,I(o,m,c.index)),c.length>1&&c.index<o.length&&i(C,h,g(c,1)),d=c[0].length,m=u,h.length>=s))break;v.lastIndex===c.index&&v.lastIndex++}return m===o.length?!d&&T(v,"")||b(h,""):b(h,I(o,m)),h.length>s?g(h,0,s):h}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:n(t,this,e,r)}:t,[function(t,r){var i=l(this),s=void 0==t?void 0:f(t,e);return s?n(s,t,i,r):n(o,p(i),t,r)},function(e,i){var n=c(this),s=p(e),a=r(o,n,s,i,o!==t);if(a.done)return a.value;var l=u(n,RegExp),f=n.unicode,g=(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.unicode?"u":"")+(A?"g":"y"),_=new l(A?"^(?:"+n.source+")":n,g),v=void 0===i?y:i>>>0;if(0===v)return[];if(0===s.length)return null===m(_,s)?[s]:[];var E=0,C=0,T=[];while(C<s.length){_.lastIndex=A?0:C;var R,w=m(_,A?I(s,C):s);if(null===w||(R=S(h(_.lastIndex+(A?C:0)),s.length))===E)C=d(s,C,f);else{if(b(T,I(s,E,C)),T.length===v)return T;for(var k=1;k<=w.length-1;k++)if(b(T,w[k]),T.length===v)return T;C=E=R}}return b(T,I(s,E)),T}]}),!R,A)},"12f2":function(e,t,r){"use strict";t.__esModule=!0,t.default=function(e){return{methods:{focus:function(){this.$refs[e].focus()}}}}},"143c":function(e,t,r){var i=r("74e8");i("Int32",(function(e){return function(t,r,i){return e(this,t,r,i)}}))},1448:function(e,t,r){var i=r("dfb9"),n=r("b6b7");e.exports=function(e,t){return i(n(e),t)}},"145e":function(e,t,r){"use strict";var i=r("7b0b"),n=r("23cb"),o=r("07fa"),s=Math.min;e.exports=[].copyWithin||function(e,t){var r=i(this),a=o(r),c=n(e,a),l=n(t,a),u=arguments.length>2?arguments[2]:void 0,d=s((void 0===u?a:n(u,a))-l,a-c),h=1;l<c&&c<l+d&&(h=-1,l+=d-1,c+=d-1);while(d-- >0)l in r?r[c]=r[l]:delete r[c],c+=h,l+=h;return r}},"14c3":function(e,t,r){var i=r("da84"),n=r("c65b"),o=r("825a"),s=r("1626"),a=r("c6b6"),c=r("9263"),l=i.TypeError;e.exports=function(e,t){var r=e.exec;if(s(r)){var i=n(r,e,t);return null!==i&&o(i),i}if("RegExp"===a(e))return n(c,e,t);throw l("RegExp#exec called on incompatible receiver")}},"14e9":function(e,t,r){e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=132)}({132:function(e,t,r){"use strict";r.r(t);var i=r(16),n=r(38),o=r.n(n),s=r(3),a=r(2),c={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}};function l(e){var t=e.move,r=e.size,i=e.bar,n={},o="translate"+i.axis+"("+t+"%)";return n[i.size]=r,n.transform=o,n.msTransform=o,n.webkitTransform=o,n}var u={name:"Bar",props:{vertical:Boolean,size:String,move:Number},computed:{bar:function(){return c[this.vertical?"vertical":"horizontal"]},wrap:function(){return this.$parent.wrap}},render:function(e){var t=this.size,r=this.move,i=this.bar;return e("div",{class:["el-scrollbar__bar","is-"+i.key],on:{mousedown:this.clickTrackHandler}},[e("div",{ref:"thumb",class:"el-scrollbar__thumb",on:{mousedown:this.clickThumbHandler},style:l({size:t,move:r,bar:i})})])},methods:{clickThumbHandler:function(e){e.ctrlKey||2===e.button||(this.startDrag(e),this[this.bar.axis]=e.currentTarget[this.bar.offset]-(e[this.bar.client]-e.currentTarget.getBoundingClientRect()[this.bar.direction]))},clickTrackHandler:function(e){var t=Math.abs(e.target.getBoundingClientRect()[this.bar.direction]-e[this.bar.client]),r=this.$refs.thumb[this.bar.offset]/2,i=100*(t-r)/this.$el[this.bar.offset];this.wrap[this.bar.scroll]=i*this.wrap[this.bar.scrollSize]/100},startDrag:function(e){e.stopImmediatePropagation(),this.cursorDown=!0,Object(a["on"])(document,"mousemove",this.mouseMoveDocumentHandler),Object(a["on"])(document,"mouseup",this.mouseUpDocumentHandler),document.onselectstart=function(){return!1}},mouseMoveDocumentHandler:function(e){if(!1!==this.cursorDown){var t=this[this.bar.axis];if(t){var r=-1*(this.$el.getBoundingClientRect()[this.bar.direction]-e[this.bar.client]),i=this.$refs.thumb[this.bar.offset]-t,n=100*(r-i)/this.$el[this.bar.offset];this.wrap[this.bar.scroll]=n*this.wrap[this.bar.scrollSize]/100}}},mouseUpDocumentHandler:function(e){this.cursorDown=!1,this[this.bar.axis]=0,Object(a["off"])(document,"mousemove",this.mouseMoveDocumentHandler),document.onselectstart=null}},destroyed:function(){Object(a["off"])(document,"mouseup",this.mouseUpDocumentHandler)}},d={name:"ElScrollbar",components:{Bar:u},props:{native:Boolean,wrapStyle:{},wrapClass:{},viewClass:{},viewStyle:{},noresize:Boolean,tag:{type:String,default:"div"}},data:function(){return{sizeWidth:"0",sizeHeight:"0",moveX:0,moveY:0}},computed:{wrap:function(){return this.$refs.wrap}},render:function(e){var t=o()(),r=this.wrapStyle;if(t){var i="-"+t+"px",n="margin-bottom: "+i+"; margin-right: "+i+";";Array.isArray(this.wrapStyle)?(r=Object(s["toObject"])(this.wrapStyle),r.marginRight=r.marginBottom=i):"string"===typeof this.wrapStyle?r+=n:r=n}var a=e(this.tag,{class:["el-scrollbar__view",this.viewClass],style:this.viewStyle,ref:"resize"},this.$slots.default),c=e("div",{ref:"wrap",style:r,on:{scroll:this.handleScroll},class:[this.wrapClass,"el-scrollbar__wrap",t?"":"el-scrollbar__wrap--hidden-default"]},[[a]]),l=void 0;return l=this.native?[e("div",{ref:"wrap",class:[this.wrapClass,"el-scrollbar__wrap"],style:r},[[a]])]:[c,e(u,{attrs:{move:this.moveX,size:this.sizeWidth}}),e(u,{attrs:{vertical:!0,move:this.moveY,size:this.sizeHeight}})],e("div",{class:"el-scrollbar"},l)},methods:{handleScroll:function(){var e=this.wrap;this.moveY=100*e.scrollTop/e.clientHeight,this.moveX=100*e.scrollLeft/e.clientWidth},update:function(){var e=void 0,t=void 0,r=this.wrap;r&&(e=100*r.clientHeight/r.scrollHeight,t=100*r.clientWidth/r.scrollWidth,this.sizeHeight=e<100?e+"%":"",this.sizeWidth=t<100?t+"%":"")}},mounted:function(){this.native||(this.$nextTick(this.update),!this.noresize&&Object(i["addResizeListener"])(this.$refs.resize,this.update))},beforeDestroy:function(){this.native||!this.noresize&&Object(i["removeResizeListener"])(this.$refs.resize,this.update)},install:function(e){e.component(d.name,d)}};t["default"]=d},16:function(e,t){e.exports=r("4010")},2:function(e,t){e.exports=r("5924")},3:function(e,t){e.exports=r("8122")},38:function(e,t){e.exports=r("e62d")}})},"159b":function(e,t,r){var i=r("da84"),n=r("fdbc"),o=r("785a"),s=r("17c2"),a=r("9112"),c=function(e){if(e&&e.forEach!==s)try{a(e,"forEach",s)}catch(t){e.forEach=s}};for(var l in n)n[l]&&c(i[l]&&i[l].prototype);c(o)},1609:function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},1626:function(e,t){e.exports=function(e){return"function"==typeof e}},"170b":function(e,t,r){"use strict";var i=r("ebb5"),n=r("50c4"),o=r("23cb"),s=r("b6b7"),a=i.aTypedArray,c=i.exportTypedArrayMethod;c("subarray",(function(e,t){var r=a(this),i=r.length,c=o(e,i),l=s(r);return new l(r.buffer,r.byteOffset+c*r.BYTES_PER_ELEMENT,n((void 0===t?i:o(t,i))-c))}))},"17c2":function(e,t,r){"use strict";var i=r("b727").forEach,n=r("a640"),o=n("forEach");e.exports=o?[].forEach:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}},"17ed":function(e,t,r){e.exports={default:r("511f"),__esModule:!0}},"182d":function(e,t,r){var i=r("da84"),n=r("f8cd"),o=i.RangeError;e.exports=function(e,t){var r=n(e);if(r%t)throw o("Wrong offset");return r}},1836:function(e,t,r){var i=r("6ca1"),n=r("6438").f,o={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],a=function(e){try{return n(e)}catch(t){return s.slice()}};e.exports.f=function(e){return s&&"[object Window]"==o.call(e)?a(e):n(i(e))}},1917:function(e,t){t.f={}.propertyIsEnumerable},"19aa":function(e,t,r){var i=r("da84"),n=r("3a9b"),o=i.TypeError;e.exports=function(e,t){if(n(t,e))return e;throw o("Incorrect invocation")}},"19fa":function(e,t,r){var i=r("fc5e"),n=r("c901");e.exports=function(e){return function(t,r){var o,s,a=String(n(t)),c=i(r),l=a.length;return c<0||c>=l?e?"":void 0:(o=a.charCodeAt(c),o<55296||o>56319||c+1===l||(s=a.charCodeAt(c+1))<56320||s>57343?e?a.charAt(c):o:e?a.slice(c,c+2):s-56320+(o-55296<<10)+65536)}}},"1a14":function(e,t,r){var i=r("77e9"),n=r("faf5"),o=r("3397"),s=Object.defineProperty;t.f=r("0bad")?Object.defineProperty:function(e,t,r){if(i(e),t=o(t,!0),i(r),n)try{return s(e,t,r)}catch(a){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},"1a2d":function(e,t,r){var i=r("e330"),n=r("7b0b"),o=i({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(n(e),t)}},"1b40":function(e,t,r){"use strict";r.d(t,"a",(function(){return C})),r.d(t,"d",(function(){return i["default"]})),r.d(t,"b",(function(){return I})),r.d(t,"c",(function(){return R})),r.d(t,"e",(function(){return w}));var i=r("2b0e");
/**
  * vue-class-component v7.2.6
  * (c) 2015-present Evan You
  * @license MIT
  */function n(e){return n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e){return a(e)||c(e)||l()}function a(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function c(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function u(){return"undefined"!==typeof Reflect&&Reflect.defineMetadata&&Reflect.getOwnMetadataKeys}function d(e,t){h(e,t),Object.getOwnPropertyNames(t.prototype).forEach((function(r){h(e.prototype,t.prototype,r)})),Object.getOwnPropertyNames(t).forEach((function(r){h(e,t,r)}))}function h(e,t,r){var i=r?Reflect.getOwnMetadataKeys(t,r):Reflect.getOwnMetadataKeys(t);i.forEach((function(i){var n=r?Reflect.getOwnMetadata(i,t,r):Reflect.getOwnMetadata(i,t);r?Reflect.defineMetadata(i,n,e,r):Reflect.defineMetadata(i,n,e)}))}var p={__proto__:[]},f=p instanceof Array;function g(e){return function(t,r,i){var n="function"===typeof t?t:t.constructor;n.__decorators__||(n.__decorators__=[]),"number"!==typeof i&&(i=void 0),n.__decorators__.push((function(t){return e(t,r,i)}))}}function m(e){var t=n(e);return null==e||"object"!==t&&"function"!==t}function _(e,t){var r=t.prototype._init;t.prototype._init=function(){var t=this,r=Object.getOwnPropertyNames(e);if(e.$options.props)for(var i in e.$options.props)e.hasOwnProperty(i)||r.push(i);r.forEach((function(r){Object.defineProperty(t,r,{get:function(){return e[r]},set:function(t){e[r]=t},configurable:!0})}))};var i=new t;t.prototype._init=r;var n={};return Object.keys(i).forEach((function(e){void 0!==i[e]&&(n[e]=i[e])})),n}var v=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured","serverPrefetch"];function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.name=t.name||e._componentTag||e.name;var r=e.prototype;Object.getOwnPropertyNames(r).forEach((function(e){if("constructor"!==e)if(v.indexOf(e)>-1)t[e]=r[e];else{var i=Object.getOwnPropertyDescriptor(r,e);void 0!==i.value?"function"===typeof i.value?(t.methods||(t.methods={}))[e]=i.value:(t.mixins||(t.mixins=[])).push({data:function(){return o({},e,i.value)}}):(i.get||i.set)&&((t.computed||(t.computed={}))[e]={get:i.get,set:i.set})}})),(t.mixins||(t.mixins=[])).push({data:function(){return _(this,e)}});var n=e.__decorators__;n&&(n.forEach((function(e){return e(t)})),delete e.__decorators__);var s=Object.getPrototypeOf(e.prototype),a=s instanceof i["default"]?s.constructor:i["default"],c=a.extend(t);return y(c,e,a),u()&&d(c,e),c}var A={prototype:!0,arguments:!0,callee:!0,caller:!0};function y(e,t,r){Object.getOwnPropertyNames(t).forEach((function(i){if(!A[i]){var n=Object.getOwnPropertyDescriptor(e,i);if(!n||n.configurable){var o=Object.getOwnPropertyDescriptor(t,i);if(!f){if("cid"===i)return;var s=Object.getOwnPropertyDescriptor(r,i);if(!m(o.value)&&s&&s.value===o.value)return}0,Object.defineProperty(e,i,o)}}}))}function S(e){return"function"===typeof e?E(e):function(t){return E(t,e)}}S.registerHooks=function(e){v.push.apply(v,s(e))};var C=S;var T="undefined"!==typeof Reflect&&"undefined"!==typeof Reflect.getMetadata;function b(e,t,r){if(T&&!Array.isArray(e)&&"function"!==typeof e&&!e.hasOwnProperty("type")&&"undefined"===typeof e.type){var i=Reflect.getMetadata("design:type",t,r);i!==Object&&(e.type=i)}}function I(e){return void 0===e&&(e={}),function(t,r){b(e,t,r),g((function(t,r){(t.props||(t.props={}))[r]=e}))(t,r)}}function R(e){return g((function(t,r){t.computed=t.computed||{},t.computed[r]={cache:!1,get:function(){return this.$refs[e||r]}}}))}function w(e,t){void 0===t&&(t={});var r=t.deep,i=void 0!==r&&r,n=t.immediate,o=void 0!==n&&n;return g((function(t,r){"object"!==typeof t.watch&&(t.watch=Object.create(null));var n=t.watch;"object"!==typeof n[e]||Array.isArray(n[e])?"undefined"===typeof n[e]&&(n[e]=[]):n[e]=[n[e]],n[e].push({handler:r,deep:i,immediate:o})}))}},"1be4":function(e,t,r){var i=r("d066");e.exports=i("document","documentElement")},"1bf2":function(e,t,r){var i=r("23e7"),n=r("56ef");i({target:"Reflect",stat:!0},{ownKeys:n})},"1c7e":function(e,t,r){var i=r("b622"),n=i("iterator"),o=!1;try{var s=0,a={next:function(){return{done:!!s++}},return:function(){o=!0}};a[n]=function(){return this},Array.from(a,(function(){throw 2}))}catch(c){}e.exports=function(e,t){if(!t&&!o)return!1;var r=!1;try{var i={};i[n]=function(){return{next:function(){return{done:r=!0}}}},e(i)}catch(c){}return r}},"1cdc":function(e,t,r){var i=r("342f");e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(i)},"1d2b":function(e,t,r){"use strict";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),i=0;i<r.length;i++)r[i]=arguments[i];return e.apply(t,r)}}},"1d80":function(e,t,r){var i=r("da84"),n=i.TypeError;e.exports=function(e){if(void 0==e)throw n("Can't call method on "+e);return e}},"1da1":function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));r("d3b7");function i(e,t,r,i,n,o,s){try{var a=e[o](s),c=a.value}catch(l){return void r(l)}a.done?t(c):Promise.resolve(c).then(i,n)}function n(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var s=e.apply(t,r);function a(e){i(s,n,o,a,c,"next",e)}function c(e){i(s,n,o,a,c,"throw",e)}a(void 0)}))}}},"1dde":function(e,t,r){var i=r("d039"),n=r("b622"),o=r("2d00"),s=n("species");e.exports=function(e){return o>=51||!i((function(){var t=[],r=t.constructor={};return r[s]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},"219c":function(e,t,r){"use strict";var i=r("da84"),n=r("e330"),o=r("d039"),s=r("59ed"),a=r("addb"),c=r("ebb5"),l=r("04d1"),u=r("d998"),d=r("2d00"),h=r("512ce"),p=i.Array,f=c.aTypedArray,g=c.exportTypedArrayMethod,m=i.Uint16Array,_=m&&n(m.prototype.sort),v=!!_&&!(o((function(){_(new m(2),null)}))&&o((function(){_(new m(2),{})}))),E=!!_&&!o((function(){if(d)return d<74;if(l)return l<67;if(u)return!0;if(h)return h<602;var e,t,r=new m(516),i=p(516);for(e=0;e<516;e++)t=e%4,r[e]=515-e,i[e]=e-2*t+3;for(_(r,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(r[e]!==i[e])return!0})),A=function(e){return function(t,r){return void 0!==e?+e(t,r)||0:r!==r?-1:t!==t?1:0===t&&0===r?1/t>0&&1/r<0?1:-1:t>r}};g("sort",(function(e){return void 0!==e&&s(e),E?_(this,e):a(f(this),A(e))}),!E||v)},2266:function(e,t,r){var i=r("da84"),n=r("0366"),o=r("c65b"),s=r("825a"),a=r("0d51"),c=r("e95a"),l=r("07fa"),u=r("3a9b"),d=r("9a1f"),h=r("35a1"),p=r("2a62"),f=i.TypeError,g=function(e,t){this.stopped=e,this.result=t},m=g.prototype;e.exports=function(e,t,r){var i,_,v,E,A,y,S,C=r&&r.that,T=!(!r||!r.AS_ENTRIES),b=!(!r||!r.IS_ITERATOR),I=!(!r||!r.INTERRUPTED),R=n(t,C),w=function(e){return i&&p(i,"normal",e),new g(!0,e)},k=function(e){return T?(s(e),I?R(e[0],e[1],w):R(e[0],e[1])):I?R(e,w):R(e)};if(b)i=e;else{if(_=h(e),!_)throw f(a(e)+" is not iterable");if(c(_)){for(v=0,E=l(e);E>v;v++)if(A=k(e[v]),A&&u(m,A))return A;return new g(!1)}i=d(e,_)}y=i.next;while(!(S=o(y,i)).done){try{A=k(S.value)}catch(O){p(i,"throw",O)}if("object"==typeof A&&A&&u(m,A))return A}return new g(!1)}},"23cb":function(e,t,r){var i=r("5926"),n=Math.max,o=Math.min;e.exports=function(e,t){var r=i(e);return r<0?n(r+t,0):o(r,t)}},"23e7":function(e,t,r){var i=r("da84"),n=r("06cf").f,o=r("9112"),s=r("6eeb"),a=r("ce4e"),c=r("e893"),l=r("94ca");e.exports=function(e,t){var r,u,d,h,p,f,g=e.target,m=e.global,_=e.stat;if(u=m?i:_?i[g]||a(g,{}):(i[g]||{}).prototype,u)for(d in t){if(p=t[d],e.noTargetGet?(f=n(u,d),h=f&&f.value):h=u[d],r=l(m?d:g+(_?".":"#")+d,e.forced),!r&&void 0!==h){if(typeof p==typeof h)continue;c(p,h)}(e.sham||h&&h.sham)&&o(p,"sham",!0),s(u,d,p,e)}}},"241c":function(e,t,r){var i=r("ca84"),n=r("7839"),o=n.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,o)}},2444:function(e,t,r){"use strict";(function(t){var i=r("c532"),n=r("c8af"),o=r("387f"),s={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function c(){var e;return("undefined"!==typeof XMLHttpRequest||"undefined"!==typeof t&&"[object process]"===Object.prototype.toString.call(t))&&(e=r("b50d")),e}function l(e,t,r){if(i.isString(e))try{return(t||JSON.parse)(e),i.trim(e)}catch(n){if("SyntaxError"!==n.name)throw n}return(r||JSON.stringify)(e)}var u={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:c(),transformRequest:[function(e,t){return n(t,"Accept"),n(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)||t&&"application/json"===t["Content-Type"]?(a(t,"application/json"),l(e)):e}],transformResponse:[function(e){var t=this.transitional||u.transitional,r=t&&t.silentJSONParsing,n=t&&t.forcedJSONParsing,s=!r&&"json"===this.responseType;if(s||n&&i.isString(e)&&e.length)try{return JSON.parse(e)}catch(a){if(s){if("SyntaxError"===a.name)throw o(a,this,"E_JSON_PARSE");throw a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};i.forEach(["delete","get","head"],(function(e){u.headers[e]={}})),i.forEach(["post","put","patch"],(function(e){u.headers[e]=i.merge(s)})),e.exports=u}).call(this,r("4362"))},2532:function(e,t,r){"use strict";var i=r("23e7"),n=r("e330"),o=r("5a34"),s=r("1d80"),a=r("577e"),c=r("ab13"),l=n("".indexOf);i({target:"String",proto:!0,forced:!c("includes")},{includes:function(e){return!!~l(a(s(this)),a(o(e)),arguments.length>1?arguments[1]:void 0)}})},"25a1":function(e,t,r){"use strict";var i=r("ebb5"),n=r("d58f").right,o=i.aTypedArray,s=i.exportTypedArrayMethod;s("reduceRight",(function(e){var t=arguments.length;return n(o(this),e,t,t>1?arguments[1]:void 0)}))},"25f0":function(e,t,r){"use strict";var i=r("e330"),n=r("5e77").PROPER,o=r("6eeb"),s=r("825a"),a=r("3a9b"),c=r("577e"),l=r("d039"),u=r("ad6d"),d="toString",h=RegExp.prototype,p=h[d],f=i(u),g=l((function(){return"/a/b"!=p.call({source:"a",flags:"b"})})),m=n&&p.name!=d;(g||m)&&o(RegExp.prototype,d,(function(){var e=s(this),t=c(e.source),r=e.flags,i=c(void 0===r&&a(h,e)&&!("flags"in h)?f(e):r);return"/"+t+"/"+i}),{unsafe:!0})},2626:function(e,t,r){"use strict";var i=r("d066"),n=r("9bf2"),o=r("b622"),s=r("83ab"),a=o("species");e.exports=function(e){var t=i(e),r=n.f;s&&t&&!t[a]&&r(t,a,{configurable:!0,get:function(){return this}})}},"262e":function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));r("d9e2");function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}function n(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}},"26dd":function(e,t,r){"use strict";var i=r("6f4f"),n=r("10db"),o=r("92f0"),s={};r("051b")(s,r("cc15")("iterator"),(function(){return this})),e.exports=function(e,t,r){e.prototype=i(s,{next:n(1,r)}),o(e,t+" Iterator")}},2877:function(e,t,r){"use strict";function i(e,t,r,i,n,o,s,a){var c,l="function"===typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=r,l._compiled=!0),i&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),s?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},l._ssrRegister=c):n&&(c=a?function(){n.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:n),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(e,t){return c.call(t),u(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,c):[c]}return{exports:e,options:l}}r.d(t,"a",(function(){return i}))},2954:function(e,t,r){"use strict";var i=r("ebb5"),n=r("b6b7"),o=r("d039"),s=r("f36a"),a=i.aTypedArray,c=i.exportTypedArrayMethod,l=o((function(){new Int8Array(1).slice()}));c("slice",(function(e,t){var r=s(a(this),e,t),i=n(this),o=0,c=r.length,l=new i(c);while(c>o)l[o]=r[o++];return l}),l)},"299c":function(e,t,r){e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=140)}({140:function(e,t,r){"use strict";r.r(t);var i=r(5),n=r.n(i),o=r(18),s=r.n(o),a=r(2),c=r(3),l=r(7),u=r.n(l),d={name:"ElTooltip",mixins:[n.a],props:{openDelay:{type:Number,default:0},disabled:Boolean,manual:Boolean,effect:{type:String,default:"dark"},arrowOffset:{type:Number,default:0},popperClass:String,content:String,visibleArrow:{default:!0},transition:{type:String,default:"el-fade-in-linear"},popperOptions:{default:function(){return{boundariesPadding:10,gpuAcceleration:!1}}},enterable:{type:Boolean,default:!0},hideAfter:{type:Number,default:0},tabindex:{type:Number,default:0}},data:function(){return{tooltipId:"el-tooltip-"+Object(c["generateId"])(),timeoutPending:null,focusing:!1}},beforeCreate:function(){var e=this;this.$isServer||(this.popperVM=new u.a({data:{node:""},render:function(e){return this.node}}).$mount(),this.debounceClose=s()(200,(function(){return e.handleClosePopper()})))},render:function(e){var t=this;this.popperVM&&(this.popperVM.node=e("transition",{attrs:{name:this.transition},on:{afterLeave:this.doDestroy}},[e("div",{on:{mouseleave:function(){t.setExpectedState(!1),t.debounceClose()},mouseenter:function(){t.setExpectedState(!0)}},ref:"popper",attrs:{role:"tooltip",id:this.tooltipId,"aria-hidden":this.disabled||!this.showPopper?"true":"false"},directives:[{name:"show",value:!this.disabled&&this.showPopper}],class:["el-tooltip__popper","is-"+this.effect,this.popperClass]},[this.$slots.content||this.content])]));var r=this.getFirstElement();if(!r)return null;var i=r.data=r.data||{};return i.staticClass=this.addTooltipClass(i.staticClass),r},mounted:function(){var e=this;this.referenceElm=this.$el,1===this.$el.nodeType&&(this.$el.setAttribute("aria-describedby",this.tooltipId),this.$el.setAttribute("tabindex",this.tabindex),Object(a["on"])(this.referenceElm,"mouseenter",this.show),Object(a["on"])(this.referenceElm,"mouseleave",this.hide),Object(a["on"])(this.referenceElm,"focus",(function(){if(e.$slots.default&&e.$slots.default.length){var t=e.$slots.default[0].componentInstance;t&&t.focus?t.focus():e.handleFocus()}else e.handleFocus()})),Object(a["on"])(this.referenceElm,"blur",this.handleBlur),Object(a["on"])(this.referenceElm,"click",this.removeFocusing)),this.value&&this.popperVM&&this.popperVM.$nextTick((function(){e.value&&e.updatePopper()}))},watch:{focusing:function(e){e?Object(a["addClass"])(this.referenceElm,"focusing"):Object(a["removeClass"])(this.referenceElm,"focusing")}},methods:{show:function(){this.setExpectedState(!0),this.handleShowPopper()},hide:function(){this.setExpectedState(!1),this.debounceClose()},handleFocus:function(){this.focusing=!0,this.show()},handleBlur:function(){this.focusing=!1,this.hide()},removeFocusing:function(){this.focusing=!1},addTooltipClass:function(e){return e?"el-tooltip "+e.replace("el-tooltip",""):"el-tooltip"},handleShowPopper:function(){var e=this;this.expectedState&&!this.manual&&(clearTimeout(this.timeout),this.timeout=setTimeout((function(){e.showPopper=!0}),this.openDelay),this.hideAfter>0&&(this.timeoutPending=setTimeout((function(){e.showPopper=!1}),this.hideAfter)))},handleClosePopper:function(){this.enterable&&this.expectedState||this.manual||(clearTimeout(this.timeout),this.timeoutPending&&clearTimeout(this.timeoutPending),this.showPopper=!1,this.disabled&&this.doDestroy())},setExpectedState:function(e){!1===e&&clearTimeout(this.timeoutPending),this.expectedState=e},getFirstElement:function(){var e=this.$slots.default;if(!Array.isArray(e))return null;for(var t=null,r=0;r<e.length;r++)e[r]&&e[r].tag&&(t=e[r]);return t}},beforeDestroy:function(){this.popperVM&&this.popperVM.$destroy()},destroyed:function(){var e=this.referenceElm;1===e.nodeType&&(Object(a["off"])(e,"mouseenter",this.show),Object(a["off"])(e,"mouseleave",this.hide),Object(a["off"])(e,"focus",this.handleFocus),Object(a["off"])(e,"blur",this.handleBlur),Object(a["off"])(e,"click",this.removeFocusing))},install:function(e){e.component(d.name,d)}};t["default"]=d},18:function(e,t){e.exports=r("0e15")},2:function(e,t){e.exports=r("5924")},3:function(e,t){e.exports=r("8122")},5:function(e,t){e.exports=r("e974")},7:function(e,t){e.exports=r("2b0e")}})},"2a5e":function(e,t,r){"use strict";t.__esModule=!0,t.default=s;var i=r("2b0e"),n=o(i);function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!n.default.prototype.$isServer)if(t){var r=[],i=t.offsetParent;while(i&&e!==i&&e.contains(i))r.push(i),i=i.offsetParent;var o=t.offsetTop+r.reduce((function(e,t){return e+t.offsetTop}),0),s=o+t.offsetHeight,a=e.scrollTop,c=a+e.clientHeight;o<a?e.scrollTop=o:s>c&&(e.scrollTop=s-e.clientHeight)}else e.scrollTop=0}},"2a62":function(e,t,r){var i=r("c65b"),n=r("825a"),o=r("dc4a");e.exports=function(e,t,r){var s,a;n(e);try{if(s=o(e,"return"),!s){if("throw"===t)throw r;return r}s=i(s,e)}catch(c){a=!0,s=c}if("throw"===t)throw r;if(a)throw s;return n(s),r}},"2b0e":function(e,t,r){"use strict";r.r(t),function(e){
/*!
 * Vue.js v2.6.14
 * (c) 2014-2021 Evan You
 * Released under the MIT License.
 */
var r=Object.freeze({});function i(e){return void 0===e||null===e}function n(e){return void 0!==e&&null!==e}function o(e){return!0===e}function s(e){return!1===e}function a(e){return"string"===typeof e||"number"===typeof e||"symbol"===typeof e||"boolean"===typeof e}function c(e){return null!==e&&"object"===typeof e}var l=Object.prototype.toString;function u(e){return"[object Object]"===l.call(e)}function d(e){return"[object RegExp]"===l.call(e)}function h(e){var t=parseFloat(String(e));return t>=0&&Math.floor(t)===t&&isFinite(e)}function p(e){return n(e)&&"function"===typeof e.then&&"function"===typeof e.catch}function f(e){return null==e?"":Array.isArray(e)||u(e)&&e.toString===l?JSON.stringify(e,null,2):String(e)}function g(e){var t=parseFloat(e);return isNaN(t)?e:t}function m(e,t){for(var r=Object.create(null),i=e.split(","),n=0;n<i.length;n++)r[i[n]]=!0;return t?function(e){return r[e.toLowerCase()]}:function(e){return r[e]}}m("slot,component",!0);var _=m("key,ref,slot,slot-scope,is");function v(e,t){if(e.length){var r=e.indexOf(t);if(r>-1)return e.splice(r,1)}}var E=Object.prototype.hasOwnProperty;function A(e,t){return E.call(e,t)}function y(e){var t=Object.create(null);return function(r){var i=t[r];return i||(t[r]=e(r))}}var S=/-(\w)/g,C=y((function(e){return e.replace(S,(function(e,t){return t?t.toUpperCase():""}))})),T=y((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})),b=/\B([A-Z])/g,I=y((function(e){return e.replace(b,"-$1").toLowerCase()}));function R(e,t){function r(r){var i=arguments.length;return i?i>1?e.apply(t,arguments):e.call(t,r):e.call(t)}return r._length=e.length,r}function w(e,t){return e.bind(t)}var k=Function.prototype.bind?w:R;function O(e,t){t=t||0;var r=e.length-t,i=new Array(r);while(r--)i[r]=e[r+t];return i}function N(e,t){for(var r in t)e[r]=t[r];return e}function L(e){for(var t={},r=0;r<e.length;r++)e[r]&&N(t,e[r]);return t}function P(e,t,r){}var D=function(e,t,r){return!1},M=function(e){return e};function x(e,t){if(e===t)return!0;var r=c(e),i=c(t);if(!r||!i)return!r&&!i&&String(e)===String(t);try{var n=Array.isArray(e),o=Array.isArray(t);if(n&&o)return e.length===t.length&&e.every((function(e,r){return x(e,t[r])}));if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if(n||o)return!1;var s=Object.keys(e),a=Object.keys(t);return s.length===a.length&&s.every((function(r){return x(e[r],t[r])}))}catch(l){return!1}}function B(e,t){for(var r=0;r<e.length;r++)if(x(e[r],t))return r;return-1}function U(e){var t=!1;return function(){t||(t=!0,e.apply(this,arguments))}}var F="data-server-rendered",V=["component","directive","filter"],j=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch"],G={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:D,isReservedAttr:D,isUnknownElement:D,getTagNamespace:P,parsePlatformTagName:M,mustUseProp:D,async:!0,_lifecycleHooks:j},H=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function Q(e){var t=(e+"").charCodeAt(0);return 36===t||95===t}function W(e,t,r,i){Object.defineProperty(e,t,{value:r,enumerable:!!i,writable:!0,configurable:!0})}var q=new RegExp("[^"+H.source+".$_\\d]");function z(e){if(!q.test(e)){var t=e.split(".");return function(e){for(var r=0;r<t.length;r++){if(!e)return;e=e[t[r]]}return e}}}var Z,Y="__proto__"in{},K="undefined"!==typeof window,$="undefined"!==typeof WXEnvironment&&!!WXEnvironment.platform,J=$&&WXEnvironment.platform.toLowerCase(),X=K&&window.navigator.userAgent.toLowerCase(),ee=X&&/msie|trident/.test(X),te=X&&X.indexOf("msie 9.0")>0,re=X&&X.indexOf("edge/")>0,ie=(X&&X.indexOf("android"),X&&/iphone|ipad|ipod|ios/.test(X)||"ios"===J),ne=(X&&/chrome\/\d+/.test(X),X&&/phantomjs/.test(X),X&&X.match(/firefox\/(\d+)/)),oe={}.watch,se=!1;if(K)try{var ae={};Object.defineProperty(ae,"passive",{get:function(){se=!0}}),window.addEventListener("test-passive",null,ae)}catch(Ts){}var ce=function(){return void 0===Z&&(Z=!K&&!$&&"undefined"!==typeof e&&(e["process"]&&"server"===e["process"].env.VUE_ENV)),Z},le=K&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function ue(e){return"function"===typeof e&&/native code/.test(e.toString())}var de,he="undefined"!==typeof Symbol&&ue(Symbol)&&"undefined"!==typeof Reflect&&ue(Reflect.ownKeys);de="undefined"!==typeof Set&&ue(Set)?Set:function(){function e(){this.set=Object.create(null)}return e.prototype.has=function(e){return!0===this.set[e]},e.prototype.add=function(e){this.set[e]=!0},e.prototype.clear=function(){this.set=Object.create(null)},e}();var pe=P,fe=0,ge=function(){this.id=fe++,this.subs=[]};ge.prototype.addSub=function(e){this.subs.push(e)},ge.prototype.removeSub=function(e){v(this.subs,e)},ge.prototype.depend=function(){ge.target&&ge.target.addDep(this)},ge.prototype.notify=function(){var e=this.subs.slice();for(var t=0,r=e.length;t<r;t++)e[t].update()},ge.target=null;var me=[];function _e(e){me.push(e),ge.target=e}function ve(){me.pop(),ge.target=me[me.length-1]}var Ee=function(e,t,r,i,n,o,s,a){this.tag=e,this.data=t,this.children=r,this.text=i,this.elm=n,this.ns=void 0,this.context=o,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=t&&t.key,this.componentOptions=s,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=a,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1},Ae={child:{configurable:!0}};Ae.child.get=function(){return this.componentInstance},Object.defineProperties(Ee.prototype,Ae);var ye=function(e){void 0===e&&(e="");var t=new Ee;return t.text=e,t.isComment=!0,t};function Se(e){return new Ee(void 0,void 0,void 0,String(e))}function Ce(e){var t=new Ee(e.tag,e.data,e.children&&e.children.slice(),e.text,e.elm,e.context,e.componentOptions,e.asyncFactory);return t.ns=e.ns,t.isStatic=e.isStatic,t.key=e.key,t.isComment=e.isComment,t.fnContext=e.fnContext,t.fnOptions=e.fnOptions,t.fnScopeId=e.fnScopeId,t.asyncMeta=e.asyncMeta,t.isCloned=!0,t}var Te=Array.prototype,be=Object.create(Te),Ie=["push","pop","shift","unshift","splice","sort","reverse"];Ie.forEach((function(e){var t=Te[e];W(be,e,(function(){var r=[],i=arguments.length;while(i--)r[i]=arguments[i];var n,o=t.apply(this,r),s=this.__ob__;switch(e){case"push":case"unshift":n=r;break;case"splice":n=r.slice(2);break}return n&&s.observeArray(n),s.dep.notify(),o}))}));var Re=Object.getOwnPropertyNames(be),we=!0;function ke(e){we=e}var Oe=function(e){this.value=e,this.dep=new ge,this.vmCount=0,W(e,"__ob__",this),Array.isArray(e)?(Y?Ne(e,be):Le(e,be,Re),this.observeArray(e)):this.walk(e)};function Ne(e,t){e.__proto__=t}function Le(e,t,r){for(var i=0,n=r.length;i<n;i++){var o=r[i];W(e,o,t[o])}}function Pe(e,t){var r;if(c(e)&&!(e instanceof Ee))return A(e,"__ob__")&&e.__ob__ instanceof Oe?r=e.__ob__:we&&!ce()&&(Array.isArray(e)||u(e))&&Object.isExtensible(e)&&!e._isVue&&(r=new Oe(e)),t&&r&&r.vmCount++,r}function De(e,t,r,i,n){var o=new ge,s=Object.getOwnPropertyDescriptor(e,t);if(!s||!1!==s.configurable){var a=s&&s.get,c=s&&s.set;a&&!c||2!==arguments.length||(r=e[t]);var l=!n&&Pe(r);Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:function(){var t=a?a.call(e):r;return ge.target&&(o.depend(),l&&(l.dep.depend(),Array.isArray(t)&&Be(t))),t},set:function(t){var i=a?a.call(e):r;t===i||t!==t&&i!==i||a&&!c||(c?c.call(e,t):r=t,l=!n&&Pe(t),o.notify())}})}}function Me(e,t,r){if(Array.isArray(e)&&h(t))return e.length=Math.max(e.length,t),e.splice(t,1,r),r;if(t in e&&!(t in Object.prototype))return e[t]=r,r;var i=e.__ob__;return e._isVue||i&&i.vmCount?r:i?(De(i.value,t,r),i.dep.notify(),r):(e[t]=r,r)}function xe(e,t){if(Array.isArray(e)&&h(t))e.splice(t,1);else{var r=e.__ob__;e._isVue||r&&r.vmCount||A(e,t)&&(delete e[t],r&&r.dep.notify())}}function Be(e){for(var t=void 0,r=0,i=e.length;r<i;r++)t=e[r],t&&t.__ob__&&t.__ob__.dep.depend(),Array.isArray(t)&&Be(t)}Oe.prototype.walk=function(e){for(var t=Object.keys(e),r=0;r<t.length;r++)De(e,t[r])},Oe.prototype.observeArray=function(e){for(var t=0,r=e.length;t<r;t++)Pe(e[t])};var Ue=G.optionMergeStrategies;function Fe(e,t){if(!t)return e;for(var r,i,n,o=he?Reflect.ownKeys(t):Object.keys(t),s=0;s<o.length;s++)r=o[s],"__ob__"!==r&&(i=e[r],n=t[r],A(e,r)?i!==n&&u(i)&&u(n)&&Fe(i,n):Me(e,r,n));return e}function Ve(e,t,r){return r?function(){var i="function"===typeof t?t.call(r,r):t,n="function"===typeof e?e.call(r,r):e;return i?Fe(i,n):n}:t?e?function(){return Fe("function"===typeof t?t.call(this,this):t,"function"===typeof e?e.call(this,this):e)}:t:e}function je(e,t){var r=t?e?e.concat(t):Array.isArray(t)?t:[t]:e;return r?Ge(r):r}function Ge(e){for(var t=[],r=0;r<e.length;r++)-1===t.indexOf(e[r])&&t.push(e[r]);return t}function He(e,t,r,i){var n=Object.create(e||null);return t?N(n,t):n}Ue.data=function(e,t,r){return r?Ve(e,t,r):t&&"function"!==typeof t?e:Ve(e,t)},j.forEach((function(e){Ue[e]=je})),V.forEach((function(e){Ue[e+"s"]=He})),Ue.watch=function(e,t,r,i){if(e===oe&&(e=void 0),t===oe&&(t=void 0),!t)return Object.create(e||null);if(!e)return t;var n={};for(var o in N(n,e),t){var s=n[o],a=t[o];s&&!Array.isArray(s)&&(s=[s]),n[o]=s?s.concat(a):Array.isArray(a)?a:[a]}return n},Ue.props=Ue.methods=Ue.inject=Ue.computed=function(e,t,r,i){if(!e)return t;var n=Object.create(null);return N(n,e),t&&N(n,t),n},Ue.provide=Ve;var Qe=function(e,t){return void 0===t?e:t};function We(e,t){var r=e.props;if(r){var i,n,o,s={};if(Array.isArray(r)){i=r.length;while(i--)n=r[i],"string"===typeof n&&(o=C(n),s[o]={type:null})}else if(u(r))for(var a in r)n=r[a],o=C(a),s[o]=u(n)?n:{type:n};else 0;e.props=s}}function qe(e,t){var r=e.inject;if(r){var i=e.inject={};if(Array.isArray(r))for(var n=0;n<r.length;n++)i[r[n]]={from:r[n]};else if(u(r))for(var o in r){var s=r[o];i[o]=u(s)?N({from:o},s):{from:s}}else 0}}function ze(e){var t=e.directives;if(t)for(var r in t){var i=t[r];"function"===typeof i&&(t[r]={bind:i,update:i})}}function Ze(e,t,r){if("function"===typeof t&&(t=t.options),We(t,r),qe(t,r),ze(t),!t._base&&(t.extends&&(e=Ze(e,t.extends,r)),t.mixins))for(var i=0,n=t.mixins.length;i<n;i++)e=Ze(e,t.mixins[i],r);var o,s={};for(o in e)a(o);for(o in t)A(e,o)||a(o);function a(i){var n=Ue[i]||Qe;s[i]=n(e[i],t[i],r,i)}return s}function Ye(e,t,r,i){if("string"===typeof r){var n=e[t];if(A(n,r))return n[r];var o=C(r);if(A(n,o))return n[o];var s=T(o);if(A(n,s))return n[s];var a=n[r]||n[o]||n[s];return a}}function Ke(e,t,r,i){var n=t[e],o=!A(r,e),s=r[e],a=tt(Boolean,n.type);if(a>-1)if(o&&!A(n,"default"))s=!1;else if(""===s||s===I(e)){var c=tt(String,n.type);(c<0||a<c)&&(s=!0)}if(void 0===s){s=$e(i,n,e);var l=we;ke(!0),Pe(s),ke(l)}return s}function $e(e,t,r){if(A(t,"default")){var i=t.default;return e&&e.$options.propsData&&void 0===e.$options.propsData[r]&&void 0!==e._props[r]?e._props[r]:"function"===typeof i&&"Function"!==Xe(t.type)?i.call(e):i}}var Je=/^\s*function (\w+)/;function Xe(e){var t=e&&e.toString().match(Je);return t?t[1]:""}function et(e,t){return Xe(e)===Xe(t)}function tt(e,t){if(!Array.isArray(t))return et(t,e)?0:-1;for(var r=0,i=t.length;r<i;r++)if(et(t[r],e))return r;return-1}function rt(e,t,r){_e();try{if(t){var i=t;while(i=i.$parent){var n=i.$options.errorCaptured;if(n)for(var o=0;o<n.length;o++)try{var s=!1===n[o].call(i,e,t,r);if(s)return}catch(Ts){nt(Ts,i,"errorCaptured hook")}}}nt(e,t,r)}finally{ve()}}function it(e,t,r,i,n){var o;try{o=r?e.apply(t,r):e.call(t),o&&!o._isVue&&p(o)&&!o._handled&&(o.catch((function(e){return rt(e,i,n+" (Promise/async)")})),o._handled=!0)}catch(Ts){rt(Ts,i,n)}return o}function nt(e,t,r){if(G.errorHandler)try{return G.errorHandler.call(null,e,t,r)}catch(Ts){Ts!==e&&ot(Ts,null,"config.errorHandler")}ot(e,t,r)}function ot(e,t,r){if(!K&&!$||"undefined"===typeof console)throw e;console.error(e)}var st,at=!1,ct=[],lt=!1;function ut(){lt=!1;var e=ct.slice(0);ct.length=0;for(var t=0;t<e.length;t++)e[t]()}if("undefined"!==typeof Promise&&ue(Promise)){var dt=Promise.resolve();st=function(){dt.then(ut),ie&&setTimeout(P)},at=!0}else if(ee||"undefined"===typeof MutationObserver||!ue(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())st="undefined"!==typeof setImmediate&&ue(setImmediate)?function(){setImmediate(ut)}:function(){setTimeout(ut,0)};else{var ht=1,pt=new MutationObserver(ut),ft=document.createTextNode(String(ht));pt.observe(ft,{characterData:!0}),st=function(){ht=(ht+1)%2,ft.data=String(ht)},at=!0}function gt(e,t){var r;if(ct.push((function(){if(e)try{e.call(t)}catch(Ts){rt(Ts,t,"nextTick")}else r&&r(t)})),lt||(lt=!0,st()),!e&&"undefined"!==typeof Promise)return new Promise((function(e){r=e}))}var mt=new de;function _t(e){vt(e,mt),mt.clear()}function vt(e,t){var r,i,n=Array.isArray(e);if(!(!n&&!c(e)||Object.isFrozen(e)||e instanceof Ee)){if(e.__ob__){var o=e.__ob__.dep.id;if(t.has(o))return;t.add(o)}if(n){r=e.length;while(r--)vt(e[r],t)}else{i=Object.keys(e),r=i.length;while(r--)vt(e[i[r]],t)}}}var Et=y((function(e){var t="&"===e.charAt(0);e=t?e.slice(1):e;var r="~"===e.charAt(0);e=r?e.slice(1):e;var i="!"===e.charAt(0);return e=i?e.slice(1):e,{name:e,once:r,capture:i,passive:t}}));function At(e,t){function r(){var e=arguments,i=r.fns;if(!Array.isArray(i))return it(i,null,arguments,t,"v-on handler");for(var n=i.slice(),o=0;o<n.length;o++)it(n[o],null,e,t,"v-on handler")}return r.fns=e,r}function yt(e,t,r,n,s,a){var c,l,u,d;for(c in e)l=e[c],u=t[c],d=Et(c),i(l)||(i(u)?(i(l.fns)&&(l=e[c]=At(l,a)),o(d.once)&&(l=e[c]=s(d.name,l,d.capture)),r(d.name,l,d.capture,d.passive,d.params)):l!==u&&(u.fns=l,e[c]=u));for(c in t)i(e[c])&&(d=Et(c),n(d.name,t[c],d.capture))}function St(e,t,r){var s;e instanceof Ee&&(e=e.data.hook||(e.data.hook={}));var a=e[t];function c(){r.apply(this,arguments),v(s.fns,c)}i(a)?s=At([c]):n(a.fns)&&o(a.merged)?(s=a,s.fns.push(c)):s=At([a,c]),s.merged=!0,e[t]=s}function Ct(e,t,r){var o=t.options.props;if(!i(o)){var s={},a=e.attrs,c=e.props;if(n(a)||n(c))for(var l in o){var u=I(l);Tt(s,c,l,u,!0)||Tt(s,a,l,u,!1)}return s}}function Tt(e,t,r,i,o){if(n(t)){if(A(t,r))return e[r]=t[r],o||delete t[r],!0;if(A(t,i))return e[r]=t[i],o||delete t[i],!0}return!1}function bt(e){for(var t=0;t<e.length;t++)if(Array.isArray(e[t]))return Array.prototype.concat.apply([],e);return e}function It(e){return a(e)?[Se(e)]:Array.isArray(e)?wt(e):void 0}function Rt(e){return n(e)&&n(e.text)&&s(e.isComment)}function wt(e,t){var r,s,c,l,u=[];for(r=0;r<e.length;r++)s=e[r],i(s)||"boolean"===typeof s||(c=u.length-1,l=u[c],Array.isArray(s)?s.length>0&&(s=wt(s,(t||"")+"_"+r),Rt(s[0])&&Rt(l)&&(u[c]=Se(l.text+s[0].text),s.shift()),u.push.apply(u,s)):a(s)?Rt(l)?u[c]=Se(l.text+s):""!==s&&u.push(Se(s)):Rt(s)&&Rt(l)?u[c]=Se(l.text+s.text):(o(e._isVList)&&n(s.tag)&&i(s.key)&&n(t)&&(s.key="__vlist"+t+"_"+r+"__"),u.push(s)));return u}function kt(e){var t=e.$options.provide;t&&(e._provided="function"===typeof t?t.call(e):t)}function Ot(e){var t=Nt(e.$options.inject,e);t&&(ke(!1),Object.keys(t).forEach((function(r){De(e,r,t[r])})),ke(!0))}function Nt(e,t){if(e){for(var r=Object.create(null),i=he?Reflect.ownKeys(e):Object.keys(e),n=0;n<i.length;n++){var o=i[n];if("__ob__"!==o){var s=e[o].from,a=t;while(a){if(a._provided&&A(a._provided,s)){r[o]=a._provided[s];break}a=a.$parent}if(!a)if("default"in e[o]){var c=e[o].default;r[o]="function"===typeof c?c.call(t):c}else 0}}return r}}function Lt(e,t){if(!e||!e.length)return{};for(var r={},i=0,n=e.length;i<n;i++){var o=e[i],s=o.data;if(s&&s.attrs&&s.attrs.slot&&delete s.attrs.slot,o.context!==t&&o.fnContext!==t||!s||null==s.slot)(r.default||(r.default=[])).push(o);else{var a=s.slot,c=r[a]||(r[a]=[]);"template"===o.tag?c.push.apply(c,o.children||[]):c.push(o)}}for(var l in r)r[l].every(Pt)&&delete r[l];return r}function Pt(e){return e.isComment&&!e.asyncFactory||" "===e.text}function Dt(e){return e.isComment&&e.asyncFactory}function Mt(e,t,i){var n,o=Object.keys(t).length>0,s=e?!!e.$stable:!o,a=e&&e.$key;if(e){if(e._normalized)return e._normalized;if(s&&i&&i!==r&&a===i.$key&&!o&&!i.$hasNormal)return i;for(var c in n={},e)e[c]&&"$"!==c[0]&&(n[c]=xt(t,c,e[c]))}else n={};for(var l in t)l in n||(n[l]=Bt(t,l));return e&&Object.isExtensible(e)&&(e._normalized=n),W(n,"$stable",s),W(n,"$key",a),W(n,"$hasNormal",o),n}function xt(e,t,r){var i=function(){var e=arguments.length?r.apply(null,arguments):r({});e=e&&"object"===typeof e&&!Array.isArray(e)?[e]:It(e);var t=e&&e[0];return e&&(!t||1===e.length&&t.isComment&&!Dt(t))?void 0:e};return r.proxy&&Object.defineProperty(e,t,{get:i,enumerable:!0,configurable:!0}),i}function Bt(e,t){return function(){return e[t]}}function Ut(e,t){var r,i,o,s,a;if(Array.isArray(e)||"string"===typeof e)for(r=new Array(e.length),i=0,o=e.length;i<o;i++)r[i]=t(e[i],i);else if("number"===typeof e)for(r=new Array(e),i=0;i<e;i++)r[i]=t(i+1,i);else if(c(e))if(he&&e[Symbol.iterator]){r=[];var l=e[Symbol.iterator](),u=l.next();while(!u.done)r.push(t(u.value,r.length)),u=l.next()}else for(s=Object.keys(e),r=new Array(s.length),i=0,o=s.length;i<o;i++)a=s[i],r[i]=t(e[a],a,i);return n(r)||(r=[]),r._isVList=!0,r}function Ft(e,t,r,i){var n,o=this.$scopedSlots[e];o?(r=r||{},i&&(r=N(N({},i),r)),n=o(r)||("function"===typeof t?t():t)):n=this.$slots[e]||("function"===typeof t?t():t);var s=r&&r.slot;return s?this.$createElement("template",{slot:s},n):n}function Vt(e){return Ye(this.$options,"filters",e,!0)||M}function jt(e,t){return Array.isArray(e)?-1===e.indexOf(t):e!==t}function Gt(e,t,r,i,n){var o=G.keyCodes[t]||r;return n&&i&&!G.keyCodes[t]?jt(n,i):o?jt(o,e):i?I(i)!==t:void 0===e}function Ht(e,t,r,i,n){if(r)if(c(r)){var o;Array.isArray(r)&&(r=L(r));var s=function(s){if("class"===s||"style"===s||_(s))o=e;else{var a=e.attrs&&e.attrs.type;o=i||G.mustUseProp(t,a,s)?e.domProps||(e.domProps={}):e.attrs||(e.attrs={})}var c=C(s),l=I(s);if(!(c in o)&&!(l in o)&&(o[s]=r[s],n)){var u=e.on||(e.on={});u["update:"+s]=function(e){r[s]=e}}};for(var a in r)s(a)}else;return e}function Qt(e,t){var r=this._staticTrees||(this._staticTrees=[]),i=r[e];return i&&!t||(i=r[e]=this.$options.staticRenderFns[e].call(this._renderProxy,null,this),qt(i,"__static__"+e,!1)),i}function Wt(e,t,r){return qt(e,"__once__"+t+(r?"_"+r:""),!0),e}function qt(e,t,r){if(Array.isArray(e))for(var i=0;i<e.length;i++)e[i]&&"string"!==typeof e[i]&&zt(e[i],t+"_"+i,r);else zt(e,t,r)}function zt(e,t,r){e.isStatic=!0,e.key=t,e.isOnce=r}function Zt(e,t){if(t)if(u(t)){var r=e.on=e.on?N({},e.on):{};for(var i in t){var n=r[i],o=t[i];r[i]=n?[].concat(n,o):o}}else;return e}function Yt(e,t,r,i){t=t||{$stable:!r};for(var n=0;n<e.length;n++){var o=e[n];Array.isArray(o)?Yt(o,t,r):o&&(o.proxy&&(o.fn.proxy=!0),t[o.key]=o.fn)}return i&&(t.$key=i),t}function Kt(e,t){for(var r=0;r<t.length;r+=2){var i=t[r];"string"===typeof i&&i&&(e[t[r]]=t[r+1])}return e}function $t(e,t){return"string"===typeof e?t+e:e}function Jt(e){e._o=Wt,e._n=g,e._s=f,e._l=Ut,e._t=Ft,e._q=x,e._i=B,e._m=Qt,e._f=Vt,e._k=Gt,e._b=Ht,e._v=Se,e._e=ye,e._u=Yt,e._g=Zt,e._d=Kt,e._p=$t}function Xt(e,t,i,n,s){var a,c=this,l=s.options;A(n,"_uid")?(a=Object.create(n),a._original=n):(a=n,n=n._original);var u=o(l._compiled),d=!u;this.data=e,this.props=t,this.children=i,this.parent=n,this.listeners=e.on||r,this.injections=Nt(l.inject,n),this.slots=function(){return c.$slots||Mt(e.scopedSlots,c.$slots=Lt(i,n)),c.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return Mt(e.scopedSlots,this.slots())}}),u&&(this.$options=l,this.$slots=this.slots(),this.$scopedSlots=Mt(e.scopedSlots,this.$slots)),l._scopeId?this._c=function(e,t,r,i){var o=hr(a,e,t,r,i,d);return o&&!Array.isArray(o)&&(o.fnScopeId=l._scopeId,o.fnContext=n),o}:this._c=function(e,t,r,i){return hr(a,e,t,r,i,d)}}function er(e,t,i,o,s){var a=e.options,c={},l=a.props;if(n(l))for(var u in l)c[u]=Ke(u,l,t||r);else n(i.attrs)&&rr(c,i.attrs),n(i.props)&&rr(c,i.props);var d=new Xt(i,c,s,o,e),h=a.render.call(null,d._c,d);if(h instanceof Ee)return tr(h,i,d.parent,a,d);if(Array.isArray(h)){for(var p=It(h)||[],f=new Array(p.length),g=0;g<p.length;g++)f[g]=tr(p[g],i,d.parent,a,d);return f}}function tr(e,t,r,i,n){var o=Ce(e);return o.fnContext=r,o.fnOptions=i,t.slot&&((o.data||(o.data={})).slot=t.slot),o}function rr(e,t){for(var r in t)e[C(r)]=t[r]}Jt(Xt.prototype);var ir={init:function(e,t){if(e.componentInstance&&!e.componentInstance._isDestroyed&&e.data.keepAlive){var r=e;ir.prepatch(r,r)}else{var i=e.componentInstance=sr(e,Or);i.$mount(t?e.elm:void 0,t)}},prepatch:function(e,t){var r=t.componentOptions,i=t.componentInstance=e.componentInstance;Mr(i,r.propsData,r.listeners,t,r.children)},insert:function(e){var t=e.context,r=e.componentInstance;r._isMounted||(r._isMounted=!0,Fr(r,"mounted")),e.data.keepAlive&&(t._isMounted?Jr(r):Br(r,!0))},destroy:function(e){var t=e.componentInstance;t._isDestroyed||(e.data.keepAlive?Ur(t,!0):t.$destroy())}},nr=Object.keys(ir);function or(e,t,r,s,a){if(!i(e)){var l=r.$options._base;if(c(e)&&(e=l.extend(e)),"function"===typeof e){var u;if(i(e.cid)&&(u=e,e=Sr(u,l),void 0===e))return yr(u,t,r,s,a);t=t||{},yi(e),n(t.model)&&lr(e.options,t);var d=Ct(t,e,a);if(o(e.options.functional))return er(e,d,t,r,s);var h=t.on;if(t.on=t.nativeOn,o(e.options.abstract)){var p=t.slot;t={},p&&(t.slot=p)}ar(t);var f=e.options.name||a,g=new Ee("vue-component-"+e.cid+(f?"-"+f:""),t,void 0,void 0,void 0,r,{Ctor:e,propsData:d,listeners:h,tag:a,children:s},u);return g}}}function sr(e,t){var r={_isComponent:!0,_parentVnode:e,parent:t},i=e.data.inlineTemplate;return n(i)&&(r.render=i.render,r.staticRenderFns=i.staticRenderFns),new e.componentOptions.Ctor(r)}function ar(e){for(var t=e.hook||(e.hook={}),r=0;r<nr.length;r++){var i=nr[r],n=t[i],o=ir[i];n===o||n&&n._merged||(t[i]=n?cr(o,n):o)}}function cr(e,t){var r=function(r,i){e(r,i),t(r,i)};return r._merged=!0,r}function lr(e,t){var r=e.model&&e.model.prop||"value",i=e.model&&e.model.event||"input";(t.attrs||(t.attrs={}))[r]=t.model.value;var o=t.on||(t.on={}),s=o[i],a=t.model.callback;n(s)?(Array.isArray(s)?-1===s.indexOf(a):s!==a)&&(o[i]=[a].concat(s)):o[i]=a}var ur=1,dr=2;function hr(e,t,r,i,n,s){return(Array.isArray(r)||a(r))&&(n=i,i=r,r=void 0),o(s)&&(n=dr),pr(e,t,r,i,n)}function pr(e,t,r,i,o){if(n(r)&&n(r.__ob__))return ye();if(n(r)&&n(r.is)&&(t=r.is),!t)return ye();var s,a,c;(Array.isArray(i)&&"function"===typeof i[0]&&(r=r||{},r.scopedSlots={default:i[0]},i.length=0),o===dr?i=It(i):o===ur&&(i=bt(i)),"string"===typeof t)?(a=e.$vnode&&e.$vnode.ns||G.getTagNamespace(t),s=G.isReservedTag(t)?new Ee(G.parsePlatformTagName(t),r,i,void 0,void 0,e):r&&r.pre||!n(c=Ye(e.$options,"components",t))?new Ee(t,r,i,void 0,void 0,e):or(c,r,e,i,t)):s=or(t,r,e,i);return Array.isArray(s)?s:n(s)?(n(a)&&fr(s,a),n(r)&&gr(r),s):ye()}function fr(e,t,r){if(e.ns=t,"foreignObject"===e.tag&&(t=void 0,r=!0),n(e.children))for(var s=0,a=e.children.length;s<a;s++){var c=e.children[s];n(c.tag)&&(i(c.ns)||o(r)&&"svg"!==c.tag)&&fr(c,t,r)}}function gr(e){c(e.style)&&_t(e.style),c(e.class)&&_t(e.class)}function mr(e){e._vnode=null,e._staticTrees=null;var t=e.$options,i=e.$vnode=t._parentVnode,n=i&&i.context;e.$slots=Lt(t._renderChildren,n),e.$scopedSlots=r,e._c=function(t,r,i,n){return hr(e,t,r,i,n,!1)},e.$createElement=function(t,r,i,n){return hr(e,t,r,i,n,!0)};var o=i&&i.data;De(e,"$attrs",o&&o.attrs||r,null,!0),De(e,"$listeners",t._parentListeners||r,null,!0)}var _r,vr=null;function Er(e){Jt(e.prototype),e.prototype.$nextTick=function(e){return gt(e,this)},e.prototype._render=function(){var e,t=this,r=t.$options,i=r.render,n=r._parentVnode;n&&(t.$scopedSlots=Mt(n.data.scopedSlots,t.$slots,t.$scopedSlots)),t.$vnode=n;try{vr=t,e=i.call(t._renderProxy,t.$createElement)}catch(Ts){rt(Ts,t,"render"),e=t._vnode}finally{vr=null}return Array.isArray(e)&&1===e.length&&(e=e[0]),e instanceof Ee||(e=ye()),e.parent=n,e}}function Ar(e,t){return(e.__esModule||he&&"Module"===e[Symbol.toStringTag])&&(e=e.default),c(e)?t.extend(e):e}function yr(e,t,r,i,n){var o=ye();return o.asyncFactory=e,o.asyncMeta={data:t,context:r,children:i,tag:n},o}function Sr(e,t){if(o(e.error)&&n(e.errorComp))return e.errorComp;if(n(e.resolved))return e.resolved;var r=vr;if(r&&n(e.owners)&&-1===e.owners.indexOf(r)&&e.owners.push(r),o(e.loading)&&n(e.loadingComp))return e.loadingComp;if(r&&!n(e.owners)){var s=e.owners=[r],a=!0,l=null,u=null;r.$on("hook:destroyed",(function(){return v(s,r)}));var d=function(e){for(var t=0,r=s.length;t<r;t++)s[t].$forceUpdate();e&&(s.length=0,null!==l&&(clearTimeout(l),l=null),null!==u&&(clearTimeout(u),u=null))},h=U((function(r){e.resolved=Ar(r,t),a?s.length=0:d(!0)})),f=U((function(t){n(e.errorComp)&&(e.error=!0,d(!0))})),g=e(h,f);return c(g)&&(p(g)?i(e.resolved)&&g.then(h,f):p(g.component)&&(g.component.then(h,f),n(g.error)&&(e.errorComp=Ar(g.error,t)),n(g.loading)&&(e.loadingComp=Ar(g.loading,t),0===g.delay?e.loading=!0:l=setTimeout((function(){l=null,i(e.resolved)&&i(e.error)&&(e.loading=!0,d(!1))}),g.delay||200)),n(g.timeout)&&(u=setTimeout((function(){u=null,i(e.resolved)&&f(null)}),g.timeout)))),a=!1,e.loading?e.loadingComp:e.resolved}}function Cr(e){if(Array.isArray(e))for(var t=0;t<e.length;t++){var r=e[t];if(n(r)&&(n(r.componentOptions)||Dt(r)))return r}}function Tr(e){e._events=Object.create(null),e._hasHookEvent=!1;var t=e.$options._parentListeners;t&&wr(e,t)}function br(e,t){_r.$on(e,t)}function Ir(e,t){_r.$off(e,t)}function Rr(e,t){var r=_r;return function i(){var n=t.apply(null,arguments);null!==n&&r.$off(e,i)}}function wr(e,t,r){_r=e,yt(t,r||{},br,Ir,Rr,e),_r=void 0}function kr(e){var t=/^hook:/;e.prototype.$on=function(e,r){var i=this;if(Array.isArray(e))for(var n=0,o=e.length;n<o;n++)i.$on(e[n],r);else(i._events[e]||(i._events[e]=[])).push(r),t.test(e)&&(i._hasHookEvent=!0);return i},e.prototype.$once=function(e,t){var r=this;function i(){r.$off(e,i),t.apply(r,arguments)}return i.fn=t,r.$on(e,i),r},e.prototype.$off=function(e,t){var r=this;if(!arguments.length)return r._events=Object.create(null),r;if(Array.isArray(e)){for(var i=0,n=e.length;i<n;i++)r.$off(e[i],t);return r}var o,s=r._events[e];if(!s)return r;if(!t)return r._events[e]=null,r;var a=s.length;while(a--)if(o=s[a],o===t||o.fn===t){s.splice(a,1);break}return r},e.prototype.$emit=function(e){var t=this,r=t._events[e];if(r){r=r.length>1?O(r):r;for(var i=O(arguments,1),n='event handler for "'+e+'"',o=0,s=r.length;o<s;o++)it(r[o],t,i,t,n)}return t}}var Or=null;function Nr(e){var t=Or;return Or=e,function(){Or=t}}function Lr(e){var t=e.$options,r=t.parent;if(r&&!t.abstract){while(r.$options.abstract&&r.$parent)r=r.$parent;r.$children.push(e)}e.$parent=r,e.$root=r?r.$root:e,e.$children=[],e.$refs={},e._watcher=null,e._inactive=null,e._directInactive=!1,e._isMounted=!1,e._isDestroyed=!1,e._isBeingDestroyed=!1}function Pr(e){e.prototype._update=function(e,t){var r=this,i=r.$el,n=r._vnode,o=Nr(r);r._vnode=e,r.$el=n?r.__patch__(n,e):r.__patch__(r.$el,e,t,!1),o(),i&&(i.__vue__=null),r.$el&&(r.$el.__vue__=r),r.$vnode&&r.$parent&&r.$vnode===r.$parent._vnode&&(r.$parent.$el=r.$el)},e.prototype.$forceUpdate=function(){var e=this;e._watcher&&e._watcher.update()},e.prototype.$destroy=function(){var e=this;if(!e._isBeingDestroyed){Fr(e,"beforeDestroy"),e._isBeingDestroyed=!0;var t=e.$parent;!t||t._isBeingDestroyed||e.$options.abstract||v(t.$children,e),e._watcher&&e._watcher.teardown();var r=e._watchers.length;while(r--)e._watchers[r].teardown();e._data.__ob__&&e._data.__ob__.vmCount--,e._isDestroyed=!0,e.__patch__(e._vnode,null),Fr(e,"destroyed"),e.$off(),e.$el&&(e.$el.__vue__=null),e.$vnode&&(e.$vnode.parent=null)}}}function Dr(e,t,r){var i;return e.$el=t,e.$options.render||(e.$options.render=ye),Fr(e,"beforeMount"),i=function(){e._update(e._render(),r)},new ri(e,i,P,{before:function(){e._isMounted&&!e._isDestroyed&&Fr(e,"beforeUpdate")}},!0),r=!1,null==e.$vnode&&(e._isMounted=!0,Fr(e,"mounted")),e}function Mr(e,t,i,n,o){var s=n.data.scopedSlots,a=e.$scopedSlots,c=!!(s&&!s.$stable||a!==r&&!a.$stable||s&&e.$scopedSlots.$key!==s.$key||!s&&e.$scopedSlots.$key),l=!!(o||e.$options._renderChildren||c);if(e.$options._parentVnode=n,e.$vnode=n,e._vnode&&(e._vnode.parent=n),e.$options._renderChildren=o,e.$attrs=n.data.attrs||r,e.$listeners=i||r,t&&e.$options.props){ke(!1);for(var u=e._props,d=e.$options._propKeys||[],h=0;h<d.length;h++){var p=d[h],f=e.$options.props;u[p]=Ke(p,f,t,e)}ke(!0),e.$options.propsData=t}i=i||r;var g=e.$options._parentListeners;e.$options._parentListeners=i,wr(e,i,g),l&&(e.$slots=Lt(o,n.context),e.$forceUpdate())}function xr(e){while(e&&(e=e.$parent))if(e._inactive)return!0;return!1}function Br(e,t){if(t){if(e._directInactive=!1,xr(e))return}else if(e._directInactive)return;if(e._inactive||null===e._inactive){e._inactive=!1;for(var r=0;r<e.$children.length;r++)Br(e.$children[r]);Fr(e,"activated")}}function Ur(e,t){if((!t||(e._directInactive=!0,!xr(e)))&&!e._inactive){e._inactive=!0;for(var r=0;r<e.$children.length;r++)Ur(e.$children[r]);Fr(e,"deactivated")}}function Fr(e,t){_e();var r=e.$options[t],i=t+" hook";if(r)for(var n=0,o=r.length;n<o;n++)it(r[n],e,null,e,i);e._hasHookEvent&&e.$emit("hook:"+t),ve()}var Vr=[],jr=[],Gr={},Hr=!1,Qr=!1,Wr=0;function qr(){Wr=Vr.length=jr.length=0,Gr={},Hr=Qr=!1}var zr=0,Zr=Date.now;if(K&&!ee){var Yr=window.performance;Yr&&"function"===typeof Yr.now&&Zr()>document.createEvent("Event").timeStamp&&(Zr=function(){return Yr.now()})}function Kr(){var e,t;for(zr=Zr(),Qr=!0,Vr.sort((function(e,t){return e.id-t.id})),Wr=0;Wr<Vr.length;Wr++)e=Vr[Wr],e.before&&e.before(),t=e.id,Gr[t]=null,e.run();var r=jr.slice(),i=Vr.slice();qr(),Xr(r),$r(i),le&&G.devtools&&le.emit("flush")}function $r(e){var t=e.length;while(t--){var r=e[t],i=r.vm;i._watcher===r&&i._isMounted&&!i._isDestroyed&&Fr(i,"updated")}}function Jr(e){e._inactive=!1,jr.push(e)}function Xr(e){for(var t=0;t<e.length;t++)e[t]._inactive=!0,Br(e[t],!0)}function ei(e){var t=e.id;if(null==Gr[t]){if(Gr[t]=!0,Qr){var r=Vr.length-1;while(r>Wr&&Vr[r].id>e.id)r--;Vr.splice(r+1,0,e)}else Vr.push(e);Hr||(Hr=!0,gt(Kr))}}var ti=0,ri=function(e,t,r,i,n){this.vm=e,n&&(e._watcher=this),e._watchers.push(this),i?(this.deep=!!i.deep,this.user=!!i.user,this.lazy=!!i.lazy,this.sync=!!i.sync,this.before=i.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=r,this.id=++ti,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new de,this.newDepIds=new de,this.expression="","function"===typeof t?this.getter=t:(this.getter=z(t),this.getter||(this.getter=P)),this.value=this.lazy?void 0:this.get()};ri.prototype.get=function(){var e;_e(this);var t=this.vm;try{e=this.getter.call(t,t)}catch(Ts){if(!this.user)throw Ts;rt(Ts,t,'getter for watcher "'+this.expression+'"')}finally{this.deep&&_t(e),ve(),this.cleanupDeps()}return e},ri.prototype.addDep=function(e){var t=e.id;this.newDepIds.has(t)||(this.newDepIds.add(t),this.newDeps.push(e),this.depIds.has(t)||e.addSub(this))},ri.prototype.cleanupDeps=function(){var e=this.deps.length;while(e--){var t=this.deps[e];this.newDepIds.has(t.id)||t.removeSub(this)}var r=this.depIds;this.depIds=this.newDepIds,this.newDepIds=r,this.newDepIds.clear(),r=this.deps,this.deps=this.newDeps,this.newDeps=r,this.newDeps.length=0},ri.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():ei(this)},ri.prototype.run=function(){if(this.active){var e=this.get();if(e!==this.value||c(e)||this.deep){var t=this.value;if(this.value=e,this.user){var r='callback for watcher "'+this.expression+'"';it(this.cb,this.vm,[e,t],this.vm,r)}else this.cb.call(this.vm,e,t)}}},ri.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},ri.prototype.depend=function(){var e=this.deps.length;while(e--)this.deps[e].depend()},ri.prototype.teardown=function(){if(this.active){this.vm._isBeingDestroyed||v(this.vm._watchers,this);var e=this.deps.length;while(e--)this.deps[e].removeSub(this);this.active=!1}};var ii={enumerable:!0,configurable:!0,get:P,set:P};function ni(e,t,r){ii.get=function(){return this[t][r]},ii.set=function(e){this[t][r]=e},Object.defineProperty(e,r,ii)}function oi(e){e._watchers=[];var t=e.$options;t.props&&si(e,t.props),t.methods&&fi(e,t.methods),t.data?ai(e):Pe(e._data={},!0),t.computed&&ui(e,t.computed),t.watch&&t.watch!==oe&&gi(e,t.watch)}function si(e,t){var r=e.$options.propsData||{},i=e._props={},n=e.$options._propKeys=[],o=!e.$parent;o||ke(!1);var s=function(o){n.push(o);var s=Ke(o,t,r,e);De(i,o,s),o in e||ni(e,"_props",o)};for(var a in t)s(a);ke(!0)}function ai(e){var t=e.$options.data;t=e._data="function"===typeof t?ci(t,e):t||{},u(t)||(t={});var r=Object.keys(t),i=e.$options.props,n=(e.$options.methods,r.length);while(n--){var o=r[n];0,i&&A(i,o)||Q(o)||ni(e,"_data",o)}Pe(t,!0)}function ci(e,t){_e();try{return e.call(t,t)}catch(Ts){return rt(Ts,t,"data()"),{}}finally{ve()}}var li={lazy:!0};function ui(e,t){var r=e._computedWatchers=Object.create(null),i=ce();for(var n in t){var o=t[n],s="function"===typeof o?o:o.get;0,i||(r[n]=new ri(e,s||P,P,li)),n in e||di(e,n,o)}}function di(e,t,r){var i=!ce();"function"===typeof r?(ii.get=i?hi(t):pi(r),ii.set=P):(ii.get=r.get?i&&!1!==r.cache?hi(t):pi(r.get):P,ii.set=r.set||P),Object.defineProperty(e,t,ii)}function hi(e){return function(){var t=this._computedWatchers&&this._computedWatchers[e];if(t)return t.dirty&&t.evaluate(),ge.target&&t.depend(),t.value}}function pi(e){return function(){return e.call(this,this)}}function fi(e,t){e.$options.props;for(var r in t)e[r]="function"!==typeof t[r]?P:k(t[r],e)}function gi(e,t){for(var r in t){var i=t[r];if(Array.isArray(i))for(var n=0;n<i.length;n++)mi(e,r,i[n]);else mi(e,r,i)}}function mi(e,t,r,i){return u(r)&&(i=r,r=r.handler),"string"===typeof r&&(r=e[r]),e.$watch(t,r,i)}function _i(e){var t={get:function(){return this._data}},r={get:function(){return this._props}};Object.defineProperty(e.prototype,"$data",t),Object.defineProperty(e.prototype,"$props",r),e.prototype.$set=Me,e.prototype.$delete=xe,e.prototype.$watch=function(e,t,r){var i=this;if(u(t))return mi(i,e,t,r);r=r||{},r.user=!0;var n=new ri(i,e,t,r);if(r.immediate){var o='callback for immediate watcher "'+n.expression+'"';_e(),it(t,i,[n.value],i,o),ve()}return function(){n.teardown()}}}var vi=0;function Ei(e){e.prototype._init=function(e){var t=this;t._uid=vi++,t._isVue=!0,e&&e._isComponent?Ai(t,e):t.$options=Ze(yi(t.constructor),e||{},t),t._renderProxy=t,t._self=t,Lr(t),Tr(t),mr(t),Fr(t,"beforeCreate"),Ot(t),oi(t),kt(t),Fr(t,"created"),t.$options.el&&t.$mount(t.$options.el)}}function Ai(e,t){var r=e.$options=Object.create(e.constructor.options),i=t._parentVnode;r.parent=t.parent,r._parentVnode=i;var n=i.componentOptions;r.propsData=n.propsData,r._parentListeners=n.listeners,r._renderChildren=n.children,r._componentTag=n.tag,t.render&&(r.render=t.render,r.staticRenderFns=t.staticRenderFns)}function yi(e){var t=e.options;if(e.super){var r=yi(e.super),i=e.superOptions;if(r!==i){e.superOptions=r;var n=Si(e);n&&N(e.extendOptions,n),t=e.options=Ze(r,e.extendOptions),t.name&&(t.components[t.name]=e)}}return t}function Si(e){var t,r=e.options,i=e.sealedOptions;for(var n in r)r[n]!==i[n]&&(t||(t={}),t[n]=r[n]);return t}function Ci(e){this._init(e)}function Ti(e){e.use=function(e){var t=this._installedPlugins||(this._installedPlugins=[]);if(t.indexOf(e)>-1)return this;var r=O(arguments,1);return r.unshift(this),"function"===typeof e.install?e.install.apply(e,r):"function"===typeof e&&e.apply(null,r),t.push(e),this}}function bi(e){e.mixin=function(e){return this.options=Ze(this.options,e),this}}function Ii(e){e.cid=0;var t=1;e.extend=function(e){e=e||{};var r=this,i=r.cid,n=e._Ctor||(e._Ctor={});if(n[i])return n[i];var o=e.name||r.options.name;var s=function(e){this._init(e)};return s.prototype=Object.create(r.prototype),s.prototype.constructor=s,s.cid=t++,s.options=Ze(r.options,e),s["super"]=r,s.options.props&&Ri(s),s.options.computed&&wi(s),s.extend=r.extend,s.mixin=r.mixin,s.use=r.use,V.forEach((function(e){s[e]=r[e]})),o&&(s.options.components[o]=s),s.superOptions=r.options,s.extendOptions=e,s.sealedOptions=N({},s.options),n[i]=s,s}}function Ri(e){var t=e.options.props;for(var r in t)ni(e.prototype,"_props",r)}function wi(e){var t=e.options.computed;for(var r in t)di(e.prototype,r,t[r])}function ki(e){V.forEach((function(t){e[t]=function(e,r){return r?("component"===t&&u(r)&&(r.name=r.name||e,r=this.options._base.extend(r)),"directive"===t&&"function"===typeof r&&(r={bind:r,update:r}),this.options[t+"s"][e]=r,r):this.options[t+"s"][e]}}))}function Oi(e){return e&&(e.Ctor.options.name||e.tag)}function Ni(e,t){return Array.isArray(e)?e.indexOf(t)>-1:"string"===typeof e?e.split(",").indexOf(t)>-1:!!d(e)&&e.test(t)}function Li(e,t){var r=e.cache,i=e.keys,n=e._vnode;for(var o in r){var s=r[o];if(s){var a=s.name;a&&!t(a)&&Pi(r,o,i,n)}}}function Pi(e,t,r,i){var n=e[t];!n||i&&n.tag===i.tag||n.componentInstance.$destroy(),e[t]=null,v(r,t)}Ei(Ci),_i(Ci),kr(Ci),Pr(Ci),Er(Ci);var Di=[String,RegExp,Array],Mi={name:"keep-alive",abstract:!0,props:{include:Di,exclude:Di,max:[String,Number]},methods:{cacheVNode:function(){var e=this,t=e.cache,r=e.keys,i=e.vnodeToCache,n=e.keyToCache;if(i){var o=i.tag,s=i.componentInstance,a=i.componentOptions;t[n]={name:Oi(a),tag:o,componentInstance:s},r.push(n),this.max&&r.length>parseInt(this.max)&&Pi(t,r[0],r,this._vnode),this.vnodeToCache=null}}},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var e in this.cache)Pi(this.cache,e,this.keys)},mounted:function(){var e=this;this.cacheVNode(),this.$watch("include",(function(t){Li(e,(function(e){return Ni(t,e)}))})),this.$watch("exclude",(function(t){Li(e,(function(e){return!Ni(t,e)}))}))},updated:function(){this.cacheVNode()},render:function(){var e=this.$slots.default,t=Cr(e),r=t&&t.componentOptions;if(r){var i=Oi(r),n=this,o=n.include,s=n.exclude;if(o&&(!i||!Ni(o,i))||s&&i&&Ni(s,i))return t;var a=this,c=a.cache,l=a.keys,u=null==t.key?r.Ctor.cid+(r.tag?"::"+r.tag:""):t.key;c[u]?(t.componentInstance=c[u].componentInstance,v(l,u),l.push(u)):(this.vnodeToCache=t,this.keyToCache=u),t.data.keepAlive=!0}return t||e&&e[0]}},xi={KeepAlive:Mi};function Bi(e){var t={get:function(){return G}};Object.defineProperty(e,"config",t),e.util={warn:pe,extend:N,mergeOptions:Ze,defineReactive:De},e.set=Me,e.delete=xe,e.nextTick=gt,e.observable=function(e){return Pe(e),e},e.options=Object.create(null),V.forEach((function(t){e.options[t+"s"]=Object.create(null)})),e.options._base=e,N(e.options.components,xi),Ti(e),bi(e),Ii(e),ki(e)}Bi(Ci),Object.defineProperty(Ci.prototype,"$isServer",{get:ce}),Object.defineProperty(Ci.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(Ci,"FunctionalRenderContext",{value:Xt}),Ci.version="2.6.14";var Ui=m("style,class"),Fi=m("input,textarea,option,select,progress"),Vi=function(e,t,r){return"value"===r&&Fi(e)&&"button"!==t||"selected"===r&&"option"===e||"checked"===r&&"input"===e||"muted"===r&&"video"===e},ji=m("contenteditable,draggable,spellcheck"),Gi=m("events,caret,typing,plaintext-only"),Hi=function(e,t){return Zi(t)||"false"===t?"false":"contenteditable"===e&&Gi(t)?t:"true"},Qi=m("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,truespeed,typemustmatch,visible"),Wi="http://www.w3.org/1999/xlink",qi=function(e){return":"===e.charAt(5)&&"xlink"===e.slice(0,5)},zi=function(e){return qi(e)?e.slice(6,e.length):""},Zi=function(e){return null==e||!1===e};function Yi(e){var t=e.data,r=e,i=e;while(n(i.componentInstance))i=i.componentInstance._vnode,i&&i.data&&(t=Ki(i.data,t));while(n(r=r.parent))r&&r.data&&(t=Ki(t,r.data));return $i(t.staticClass,t.class)}function Ki(e,t){return{staticClass:Ji(e.staticClass,t.staticClass),class:n(e.class)?[e.class,t.class]:t.class}}function $i(e,t){return n(e)||n(t)?Ji(e,Xi(t)):""}function Ji(e,t){return e?t?e+" "+t:e:t||""}function Xi(e){return Array.isArray(e)?en(e):c(e)?tn(e):"string"===typeof e?e:""}function en(e){for(var t,r="",i=0,o=e.length;i<o;i++)n(t=Xi(e[i]))&&""!==t&&(r&&(r+=" "),r+=t);return r}function tn(e){var t="";for(var r in e)e[r]&&(t&&(t+=" "),t+=r);return t}var rn={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},nn=m("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),on=m("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignobject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),sn=function(e){return nn(e)||on(e)};function an(e){return on(e)?"svg":"math"===e?"math":void 0}var cn=Object.create(null);function ln(e){if(!K)return!0;if(sn(e))return!1;if(e=e.toLowerCase(),null!=cn[e])return cn[e];var t=document.createElement(e);return e.indexOf("-")>-1?cn[e]=t.constructor===window.HTMLUnknownElement||t.constructor===window.HTMLElement:cn[e]=/HTMLUnknownElement/.test(t.toString())}var un=m("text,number,password,search,email,tel,url");function dn(e){if("string"===typeof e){var t=document.querySelector(e);return t||document.createElement("div")}return e}function hn(e,t){var r=document.createElement(e);return"select"!==e||t.data&&t.data.attrs&&void 0!==t.data.attrs.multiple&&r.setAttribute("multiple","multiple"),r}function pn(e,t){return document.createElementNS(rn[e],t)}function fn(e){return document.createTextNode(e)}function gn(e){return document.createComment(e)}function mn(e,t,r){e.insertBefore(t,r)}function _n(e,t){e.removeChild(t)}function vn(e,t){e.appendChild(t)}function En(e){return e.parentNode}function An(e){return e.nextSibling}function yn(e){return e.tagName}function Sn(e,t){e.textContent=t}function Cn(e,t){e.setAttribute(t,"")}var Tn=Object.freeze({createElement:hn,createElementNS:pn,createTextNode:fn,createComment:gn,insertBefore:mn,removeChild:_n,appendChild:vn,parentNode:En,nextSibling:An,tagName:yn,setTextContent:Sn,setStyleScope:Cn}),bn={create:function(e,t){In(t)},update:function(e,t){e.data.ref!==t.data.ref&&(In(e,!0),In(t))},destroy:function(e){In(e,!0)}};function In(e,t){var r=e.data.ref;if(n(r)){var i=e.context,o=e.componentInstance||e.elm,s=i.$refs;t?Array.isArray(s[r])?v(s[r],o):s[r]===o&&(s[r]=void 0):e.data.refInFor?Array.isArray(s[r])?s[r].indexOf(o)<0&&s[r].push(o):s[r]=[o]:s[r]=o}}var Rn=new Ee("",{},[]),wn=["create","activate","update","remove","destroy"];function kn(e,t){return e.key===t.key&&e.asyncFactory===t.asyncFactory&&(e.tag===t.tag&&e.isComment===t.isComment&&n(e.data)===n(t.data)&&On(e,t)||o(e.isAsyncPlaceholder)&&i(t.asyncFactory.error))}function On(e,t){if("input"!==e.tag)return!0;var r,i=n(r=e.data)&&n(r=r.attrs)&&r.type,o=n(r=t.data)&&n(r=r.attrs)&&r.type;return i===o||un(i)&&un(o)}function Nn(e,t,r){var i,o,s={};for(i=t;i<=r;++i)o=e[i].key,n(o)&&(s[o]=i);return s}function Ln(e){var t,r,s={},c=e.modules,l=e.nodeOps;for(t=0;t<wn.length;++t)for(s[wn[t]]=[],r=0;r<c.length;++r)n(c[r][wn[t]])&&s[wn[t]].push(c[r][wn[t]]);function u(e){return new Ee(l.tagName(e).toLowerCase(),{},[],void 0,e)}function d(e,t){function r(){0===--r.listeners&&h(e)}return r.listeners=t,r}function h(e){var t=l.parentNode(e);n(t)&&l.removeChild(t,e)}function p(e,t,r,i,s,a,c){if(n(e.elm)&&n(a)&&(e=a[c]=Ce(e)),e.isRootInsert=!s,!f(e,t,r,i)){var u=e.data,d=e.children,h=e.tag;n(h)?(e.elm=e.ns?l.createElementNS(e.ns,h):l.createElement(h,e),S(e),E(e,d,t),n(u)&&y(e,t),v(r,e.elm,i)):o(e.isComment)?(e.elm=l.createComment(e.text),v(r,e.elm,i)):(e.elm=l.createTextNode(e.text),v(r,e.elm,i))}}function f(e,t,r,i){var s=e.data;if(n(s)){var a=n(e.componentInstance)&&s.keepAlive;if(n(s=s.hook)&&n(s=s.init)&&s(e,!1),n(e.componentInstance))return g(e,t),v(r,e.elm,i),o(a)&&_(e,t,r,i),!0}}function g(e,t){n(e.data.pendingInsert)&&(t.push.apply(t,e.data.pendingInsert),e.data.pendingInsert=null),e.elm=e.componentInstance.$el,A(e)?(y(e,t),S(e)):(In(e),t.push(e))}function _(e,t,r,i){var o,a=e;while(a.componentInstance)if(a=a.componentInstance._vnode,n(o=a.data)&&n(o=o.transition)){for(o=0;o<s.activate.length;++o)s.activate[o](Rn,a);t.push(a);break}v(r,e.elm,i)}function v(e,t,r){n(e)&&(n(r)?l.parentNode(r)===e&&l.insertBefore(e,t,r):l.appendChild(e,t))}function E(e,t,r){if(Array.isArray(t)){0;for(var i=0;i<t.length;++i)p(t[i],r,e.elm,null,!0,t,i)}else a(e.text)&&l.appendChild(e.elm,l.createTextNode(String(e.text)))}function A(e){while(e.componentInstance)e=e.componentInstance._vnode;return n(e.tag)}function y(e,r){for(var i=0;i<s.create.length;++i)s.create[i](Rn,e);t=e.data.hook,n(t)&&(n(t.create)&&t.create(Rn,e),n(t.insert)&&r.push(e))}function S(e){var t;if(n(t=e.fnScopeId))l.setStyleScope(e.elm,t);else{var r=e;while(r)n(t=r.context)&&n(t=t.$options._scopeId)&&l.setStyleScope(e.elm,t),r=r.parent}n(t=Or)&&t!==e.context&&t!==e.fnContext&&n(t=t.$options._scopeId)&&l.setStyleScope(e.elm,t)}function C(e,t,r,i,n,o){for(;i<=n;++i)p(r[i],o,e,t,!1,r,i)}function T(e){var t,r,i=e.data;if(n(i))for(n(t=i.hook)&&n(t=t.destroy)&&t(e),t=0;t<s.destroy.length;++t)s.destroy[t](e);if(n(t=e.children))for(r=0;r<e.children.length;++r)T(e.children[r])}function b(e,t,r){for(;t<=r;++t){var i=e[t];n(i)&&(n(i.tag)?(I(i),T(i)):h(i.elm))}}function I(e,t){if(n(t)||n(e.data)){var r,i=s.remove.length+1;for(n(t)?t.listeners+=i:t=d(e.elm,i),n(r=e.componentInstance)&&n(r=r._vnode)&&n(r.data)&&I(r,t),r=0;r<s.remove.length;++r)s.remove[r](e,t);n(r=e.data.hook)&&n(r=r.remove)?r(e,t):t()}else h(e.elm)}function R(e,t,r,o,s){var a,c,u,d,h=0,f=0,g=t.length-1,m=t[0],_=t[g],v=r.length-1,E=r[0],A=r[v],y=!s;while(h<=g&&f<=v)i(m)?m=t[++h]:i(_)?_=t[--g]:kn(m,E)?(k(m,E,o,r,f),m=t[++h],E=r[++f]):kn(_,A)?(k(_,A,o,r,v),_=t[--g],A=r[--v]):kn(m,A)?(k(m,A,o,r,v),y&&l.insertBefore(e,m.elm,l.nextSibling(_.elm)),m=t[++h],A=r[--v]):kn(_,E)?(k(_,E,o,r,f),y&&l.insertBefore(e,_.elm,m.elm),_=t[--g],E=r[++f]):(i(a)&&(a=Nn(t,h,g)),c=n(E.key)?a[E.key]:w(E,t,h,g),i(c)?p(E,o,e,m.elm,!1,r,f):(u=t[c],kn(u,E)?(k(u,E,o,r,f),t[c]=void 0,y&&l.insertBefore(e,u.elm,m.elm)):p(E,o,e,m.elm,!1,r,f)),E=r[++f]);h>g?(d=i(r[v+1])?null:r[v+1].elm,C(e,d,r,f,v,o)):f>v&&b(t,h,g)}function w(e,t,r,i){for(var o=r;o<i;o++){var s=t[o];if(n(s)&&kn(e,s))return o}}function k(e,t,r,a,c,u){if(e!==t){n(t.elm)&&n(a)&&(t=a[c]=Ce(t));var d=t.elm=e.elm;if(o(e.isAsyncPlaceholder))n(t.asyncFactory.resolved)?L(e.elm,t,r):t.isAsyncPlaceholder=!0;else if(o(t.isStatic)&&o(e.isStatic)&&t.key===e.key&&(o(t.isCloned)||o(t.isOnce)))t.componentInstance=e.componentInstance;else{var h,p=t.data;n(p)&&n(h=p.hook)&&n(h=h.prepatch)&&h(e,t);var f=e.children,g=t.children;if(n(p)&&A(t)){for(h=0;h<s.update.length;++h)s.update[h](e,t);n(h=p.hook)&&n(h=h.update)&&h(e,t)}i(t.text)?n(f)&&n(g)?f!==g&&R(d,f,g,r,u):n(g)?(n(e.text)&&l.setTextContent(d,""),C(d,null,g,0,g.length-1,r)):n(f)?b(f,0,f.length-1):n(e.text)&&l.setTextContent(d,""):e.text!==t.text&&l.setTextContent(d,t.text),n(p)&&n(h=p.hook)&&n(h=h.postpatch)&&h(e,t)}}}function O(e,t,r){if(o(r)&&n(e.parent))e.parent.data.pendingInsert=t;else for(var i=0;i<t.length;++i)t[i].data.hook.insert(t[i])}var N=m("attrs,class,staticClass,staticStyle,key");function L(e,t,r,i){var s,a=t.tag,c=t.data,l=t.children;if(i=i||c&&c.pre,t.elm=e,o(t.isComment)&&n(t.asyncFactory))return t.isAsyncPlaceholder=!0,!0;if(n(c)&&(n(s=c.hook)&&n(s=s.init)&&s(t,!0),n(s=t.componentInstance)))return g(t,r),!0;if(n(a)){if(n(l))if(e.hasChildNodes())if(n(s=c)&&n(s=s.domProps)&&n(s=s.innerHTML)){if(s!==e.innerHTML)return!1}else{for(var u=!0,d=e.firstChild,h=0;h<l.length;h++){if(!d||!L(d,l[h],r,i)){u=!1;break}d=d.nextSibling}if(!u||d)return!1}else E(t,l,r);if(n(c)){var p=!1;for(var f in c)if(!N(f)){p=!0,y(t,r);break}!p&&c["class"]&&_t(c["class"])}}else e.data!==t.text&&(e.data=t.text);return!0}return function(e,t,r,a){if(!i(t)){var c=!1,d=[];if(i(e))c=!0,p(t,d);else{var h=n(e.nodeType);if(!h&&kn(e,t))k(e,t,d,null,null,a);else{if(h){if(1===e.nodeType&&e.hasAttribute(F)&&(e.removeAttribute(F),r=!0),o(r)&&L(e,t,d))return O(t,d,!0),e;e=u(e)}var f=e.elm,g=l.parentNode(f);if(p(t,d,f._leaveCb?null:g,l.nextSibling(f)),n(t.parent)){var m=t.parent,_=A(t);while(m){for(var v=0;v<s.destroy.length;++v)s.destroy[v](m);if(m.elm=t.elm,_){for(var E=0;E<s.create.length;++E)s.create[E](Rn,m);var y=m.data.hook.insert;if(y.merged)for(var S=1;S<y.fns.length;S++)y.fns[S]()}else In(m);m=m.parent}}n(g)?b([e],0,0):n(e.tag)&&T(e)}}return O(t,d,c),t.elm}n(e)&&T(e)}}var Pn={create:Dn,update:Dn,destroy:function(e){Dn(e,Rn)}};function Dn(e,t){(e.data.directives||t.data.directives)&&Mn(e,t)}function Mn(e,t){var r,i,n,o=e===Rn,s=t===Rn,a=Bn(e.data.directives,e.context),c=Bn(t.data.directives,t.context),l=[],u=[];for(r in c)i=a[r],n=c[r],i?(n.oldValue=i.value,n.oldArg=i.arg,Fn(n,"update",t,e),n.def&&n.def.componentUpdated&&u.push(n)):(Fn(n,"bind",t,e),n.def&&n.def.inserted&&l.push(n));if(l.length){var d=function(){for(var r=0;r<l.length;r++)Fn(l[r],"inserted",t,e)};o?St(t,"insert",d):d()}if(u.length&&St(t,"postpatch",(function(){for(var r=0;r<u.length;r++)Fn(u[r],"componentUpdated",t,e)})),!o)for(r in a)c[r]||Fn(a[r],"unbind",e,e,s)}var xn=Object.create(null);function Bn(e,t){var r,i,n=Object.create(null);if(!e)return n;for(r=0;r<e.length;r++)i=e[r],i.modifiers||(i.modifiers=xn),n[Un(i)]=i,i.def=Ye(t.$options,"directives",i.name,!0);return n}function Un(e){return e.rawName||e.name+"."+Object.keys(e.modifiers||{}).join(".")}function Fn(e,t,r,i,n){var o=e.def&&e.def[t];if(o)try{o(r.elm,e,r,i,n)}catch(Ts){rt(Ts,r.context,"directive "+e.name+" "+t+" hook")}}var Vn=[bn,Pn];function jn(e,t){var r=t.componentOptions;if((!n(r)||!1!==r.Ctor.options.inheritAttrs)&&(!i(e.data.attrs)||!i(t.data.attrs))){var o,s,a,c=t.elm,l=e.data.attrs||{},u=t.data.attrs||{};for(o in n(u.__ob__)&&(u=t.data.attrs=N({},u)),u)s=u[o],a=l[o],a!==s&&Gn(c,o,s,t.data.pre);for(o in(ee||re)&&u.value!==l.value&&Gn(c,"value",u.value),l)i(u[o])&&(qi(o)?c.removeAttributeNS(Wi,zi(o)):ji(o)||c.removeAttribute(o))}}function Gn(e,t,r,i){i||e.tagName.indexOf("-")>-1?Hn(e,t,r):Qi(t)?Zi(r)?e.removeAttribute(t):(r="allowfullscreen"===t&&"EMBED"===e.tagName?"true":t,e.setAttribute(t,r)):ji(t)?e.setAttribute(t,Hi(t,r)):qi(t)?Zi(r)?e.removeAttributeNS(Wi,zi(t)):e.setAttributeNS(Wi,t,r):Hn(e,t,r)}function Hn(e,t,r){if(Zi(r))e.removeAttribute(t);else{if(ee&&!te&&"TEXTAREA"===e.tagName&&"placeholder"===t&&""!==r&&!e.__ieph){var i=function(t){t.stopImmediatePropagation(),e.removeEventListener("input",i)};e.addEventListener("input",i),e.__ieph=!0}e.setAttribute(t,r)}}var Qn={create:jn,update:jn};function Wn(e,t){var r=t.elm,o=t.data,s=e.data;if(!(i(o.staticClass)&&i(o.class)&&(i(s)||i(s.staticClass)&&i(s.class)))){var a=Yi(t),c=r._transitionClasses;n(c)&&(a=Ji(a,Xi(c))),a!==r._prevClass&&(r.setAttribute("class",a),r._prevClass=a)}}var qn,zn={create:Wn,update:Wn},Zn="__r",Yn="__c";function Kn(e){if(n(e[Zn])){var t=ee?"change":"input";e[t]=[].concat(e[Zn],e[t]||[]),delete e[Zn]}n(e[Yn])&&(e.change=[].concat(e[Yn],e.change||[]),delete e[Yn])}function $n(e,t,r){var i=qn;return function n(){var o=t.apply(null,arguments);null!==o&&eo(e,n,r,i)}}var Jn=at&&!(ne&&Number(ne[1])<=53);function Xn(e,t,r,i){if(Jn){var n=zr,o=t;t=o._wrapper=function(e){if(e.target===e.currentTarget||e.timeStamp>=n||e.timeStamp<=0||e.target.ownerDocument!==document)return o.apply(this,arguments)}}qn.addEventListener(e,t,se?{capture:r,passive:i}:r)}function eo(e,t,r,i){(i||qn).removeEventListener(e,t._wrapper||t,r)}function to(e,t){if(!i(e.data.on)||!i(t.data.on)){var r=t.data.on||{},n=e.data.on||{};qn=t.elm,Kn(r),yt(r,n,Xn,eo,$n,t.context),qn=void 0}}var ro,io={create:to,update:to};function no(e,t){if(!i(e.data.domProps)||!i(t.data.domProps)){var r,o,s=t.elm,a=e.data.domProps||{},c=t.data.domProps||{};for(r in n(c.__ob__)&&(c=t.data.domProps=N({},c)),a)r in c||(s[r]="");for(r in c){if(o=c[r],"textContent"===r||"innerHTML"===r){if(t.children&&(t.children.length=0),o===a[r])continue;1===s.childNodes.length&&s.removeChild(s.childNodes[0])}if("value"===r&&"PROGRESS"!==s.tagName){s._value=o;var l=i(o)?"":String(o);oo(s,l)&&(s.value=l)}else if("innerHTML"===r&&on(s.tagName)&&i(s.innerHTML)){ro=ro||document.createElement("div"),ro.innerHTML="<svg>"+o+"</svg>";var u=ro.firstChild;while(s.firstChild)s.removeChild(s.firstChild);while(u.firstChild)s.appendChild(u.firstChild)}else if(o!==a[r])try{s[r]=o}catch(Ts){}}}}function oo(e,t){return!e.composing&&("OPTION"===e.tagName||so(e,t)||ao(e,t))}function so(e,t){var r=!0;try{r=document.activeElement!==e}catch(Ts){}return r&&e.value!==t}function ao(e,t){var r=e.value,i=e._vModifiers;if(n(i)){if(i.number)return g(r)!==g(t);if(i.trim)return r.trim()!==t.trim()}return r!==t}var co={create:no,update:no},lo=y((function(e){var t={},r=/;(?![^(]*\))/g,i=/:(.+)/;return e.split(r).forEach((function(e){if(e){var r=e.split(i);r.length>1&&(t[r[0].trim()]=r[1].trim())}})),t}));function uo(e){var t=ho(e.style);return e.staticStyle?N(e.staticStyle,t):t}function ho(e){return Array.isArray(e)?L(e):"string"===typeof e?lo(e):e}function po(e,t){var r,i={};if(t){var n=e;while(n.componentInstance)n=n.componentInstance._vnode,n&&n.data&&(r=uo(n.data))&&N(i,r)}(r=uo(e.data))&&N(i,r);var o=e;while(o=o.parent)o.data&&(r=uo(o.data))&&N(i,r);return i}var fo,go=/^--/,mo=/\s*!important$/,_o=function(e,t,r){if(go.test(t))e.style.setProperty(t,r);else if(mo.test(r))e.style.setProperty(I(t),r.replace(mo,""),"important");else{var i=Eo(t);if(Array.isArray(r))for(var n=0,o=r.length;n<o;n++)e.style[i]=r[n];else e.style[i]=r}},vo=["Webkit","Moz","ms"],Eo=y((function(e){if(fo=fo||document.createElement("div").style,e=C(e),"filter"!==e&&e in fo)return e;for(var t=e.charAt(0).toUpperCase()+e.slice(1),r=0;r<vo.length;r++){var i=vo[r]+t;if(i in fo)return i}}));function Ao(e,t){var r=t.data,o=e.data;if(!(i(r.staticStyle)&&i(r.style)&&i(o.staticStyle)&&i(o.style))){var s,a,c=t.elm,l=o.staticStyle,u=o.normalizedStyle||o.style||{},d=l||u,h=ho(t.data.style)||{};t.data.normalizedStyle=n(h.__ob__)?N({},h):h;var p=po(t,!0);for(a in d)i(p[a])&&_o(c,a,"");for(a in p)s=p[a],s!==d[a]&&_o(c,a,null==s?"":s)}}var yo={create:Ao,update:Ao},So=/\s+/;function Co(e,t){if(t&&(t=t.trim()))if(e.classList)t.indexOf(" ")>-1?t.split(So).forEach((function(t){return e.classList.add(t)})):e.classList.add(t);else{var r=" "+(e.getAttribute("class")||"")+" ";r.indexOf(" "+t+" ")<0&&e.setAttribute("class",(r+t).trim())}}function To(e,t){if(t&&(t=t.trim()))if(e.classList)t.indexOf(" ")>-1?t.split(So).forEach((function(t){return e.classList.remove(t)})):e.classList.remove(t),e.classList.length||e.removeAttribute("class");else{var r=" "+(e.getAttribute("class")||"")+" ",i=" "+t+" ";while(r.indexOf(i)>=0)r=r.replace(i," ");r=r.trim(),r?e.setAttribute("class",r):e.removeAttribute("class")}}function bo(e){if(e){if("object"===typeof e){var t={};return!1!==e.css&&N(t,Io(e.name||"v")),N(t,e),t}return"string"===typeof e?Io(e):void 0}}var Io=y((function(e){return{enterClass:e+"-enter",enterToClass:e+"-enter-to",enterActiveClass:e+"-enter-active",leaveClass:e+"-leave",leaveToClass:e+"-leave-to",leaveActiveClass:e+"-leave-active"}})),Ro=K&&!te,wo="transition",ko="animation",Oo="transition",No="transitionend",Lo="animation",Po="animationend";Ro&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(Oo="WebkitTransition",No="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(Lo="WebkitAnimation",Po="webkitAnimationEnd"));var Do=K?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(e){return e()};function Mo(e){Do((function(){Do(e)}))}function xo(e,t){var r=e._transitionClasses||(e._transitionClasses=[]);r.indexOf(t)<0&&(r.push(t),Co(e,t))}function Bo(e,t){e._transitionClasses&&v(e._transitionClasses,t),To(e,t)}function Uo(e,t,r){var i=Vo(e,t),n=i.type,o=i.timeout,s=i.propCount;if(!n)return r();var a=n===wo?No:Po,c=0,l=function(){e.removeEventListener(a,u),r()},u=function(t){t.target===e&&++c>=s&&l()};setTimeout((function(){c<s&&l()}),o+1),e.addEventListener(a,u)}var Fo=/\b(transform|all)(,|$)/;function Vo(e,t){var r,i=window.getComputedStyle(e),n=(i[Oo+"Delay"]||"").split(", "),o=(i[Oo+"Duration"]||"").split(", "),s=jo(n,o),a=(i[Lo+"Delay"]||"").split(", "),c=(i[Lo+"Duration"]||"").split(", "),l=jo(a,c),u=0,d=0;t===wo?s>0&&(r=wo,u=s,d=o.length):t===ko?l>0&&(r=ko,u=l,d=c.length):(u=Math.max(s,l),r=u>0?s>l?wo:ko:null,d=r?r===wo?o.length:c.length:0);var h=r===wo&&Fo.test(i[Oo+"Property"]);return{type:r,timeout:u,propCount:d,hasTransform:h}}function jo(e,t){while(e.length<t.length)e=e.concat(e);return Math.max.apply(null,t.map((function(t,r){return Go(t)+Go(e[r])})))}function Go(e){return 1e3*Number(e.slice(0,-1).replace(",","."))}function Ho(e,t){var r=e.elm;n(r._leaveCb)&&(r._leaveCb.cancelled=!0,r._leaveCb());var o=bo(e.data.transition);if(!i(o)&&!n(r._enterCb)&&1===r.nodeType){var s=o.css,a=o.type,l=o.enterClass,u=o.enterToClass,d=o.enterActiveClass,h=o.appearClass,p=o.appearToClass,f=o.appearActiveClass,m=o.beforeEnter,_=o.enter,v=o.afterEnter,E=o.enterCancelled,A=o.beforeAppear,y=o.appear,S=o.afterAppear,C=o.appearCancelled,T=o.duration,b=Or,I=Or.$vnode;while(I&&I.parent)b=I.context,I=I.parent;var R=!b._isMounted||!e.isRootInsert;if(!R||y||""===y){var w=R&&h?h:l,k=R&&f?f:d,O=R&&p?p:u,N=R&&A||m,L=R&&"function"===typeof y?y:_,P=R&&S||v,D=R&&C||E,M=g(c(T)?T.enter:T);0;var x=!1!==s&&!te,B=qo(L),F=r._enterCb=U((function(){x&&(Bo(r,O),Bo(r,k)),F.cancelled?(x&&Bo(r,w),D&&D(r)):P&&P(r),r._enterCb=null}));e.data.show||St(e,"insert",(function(){var t=r.parentNode,i=t&&t._pending&&t._pending[e.key];i&&i.tag===e.tag&&i.elm._leaveCb&&i.elm._leaveCb(),L&&L(r,F)})),N&&N(r),x&&(xo(r,w),xo(r,k),Mo((function(){Bo(r,w),F.cancelled||(xo(r,O),B||(Wo(M)?setTimeout(F,M):Uo(r,a,F)))}))),e.data.show&&(t&&t(),L&&L(r,F)),x||B||F()}}}function Qo(e,t){var r=e.elm;n(r._enterCb)&&(r._enterCb.cancelled=!0,r._enterCb());var o=bo(e.data.transition);if(i(o)||1!==r.nodeType)return t();if(!n(r._leaveCb)){var s=o.css,a=o.type,l=o.leaveClass,u=o.leaveToClass,d=o.leaveActiveClass,h=o.beforeLeave,p=o.leave,f=o.afterLeave,m=o.leaveCancelled,_=o.delayLeave,v=o.duration,E=!1!==s&&!te,A=qo(p),y=g(c(v)?v.leave:v);0;var S=r._leaveCb=U((function(){r.parentNode&&r.parentNode._pending&&(r.parentNode._pending[e.key]=null),E&&(Bo(r,u),Bo(r,d)),S.cancelled?(E&&Bo(r,l),m&&m(r)):(t(),f&&f(r)),r._leaveCb=null}));_?_(C):C()}function C(){S.cancelled||(!e.data.show&&r.parentNode&&((r.parentNode._pending||(r.parentNode._pending={}))[e.key]=e),h&&h(r),E&&(xo(r,l),xo(r,d),Mo((function(){Bo(r,l),S.cancelled||(xo(r,u),A||(Wo(y)?setTimeout(S,y):Uo(r,a,S)))}))),p&&p(r,S),E||A||S())}}function Wo(e){return"number"===typeof e&&!isNaN(e)}function qo(e){if(i(e))return!1;var t=e.fns;return n(t)?qo(Array.isArray(t)?t[0]:t):(e._length||e.length)>1}function zo(e,t){!0!==t.data.show&&Ho(t)}var Zo=K?{create:zo,activate:zo,remove:function(e,t){!0!==e.data.show?Qo(e,t):t()}}:{},Yo=[Qn,zn,io,co,yo,Zo],Ko=Yo.concat(Vn),$o=Ln({nodeOps:Tn,modules:Ko});te&&document.addEventListener("selectionchange",(function(){var e=document.activeElement;e&&e.vmodel&&os(e,"input")}));var Jo={inserted:function(e,t,r,i){"select"===r.tag?(i.elm&&!i.elm._vOptions?St(r,"postpatch",(function(){Jo.componentUpdated(e,t,r)})):Xo(e,t,r.context),e._vOptions=[].map.call(e.options,rs)):("textarea"===r.tag||un(e.type))&&(e._vModifiers=t.modifiers,t.modifiers.lazy||(e.addEventListener("compositionstart",is),e.addEventListener("compositionend",ns),e.addEventListener("change",ns),te&&(e.vmodel=!0)))},componentUpdated:function(e,t,r){if("select"===r.tag){Xo(e,t,r.context);var i=e._vOptions,n=e._vOptions=[].map.call(e.options,rs);if(n.some((function(e,t){return!x(e,i[t])}))){var o=e.multiple?t.value.some((function(e){return ts(e,n)})):t.value!==t.oldValue&&ts(t.value,n);o&&os(e,"change")}}}};function Xo(e,t,r){es(e,t,r),(ee||re)&&setTimeout((function(){es(e,t,r)}),0)}function es(e,t,r){var i=t.value,n=e.multiple;if(!n||Array.isArray(i)){for(var o,s,a=0,c=e.options.length;a<c;a++)if(s=e.options[a],n)o=B(i,rs(s))>-1,s.selected!==o&&(s.selected=o);else if(x(rs(s),i))return void(e.selectedIndex!==a&&(e.selectedIndex=a));n||(e.selectedIndex=-1)}}function ts(e,t){return t.every((function(t){return!x(t,e)}))}function rs(e){return"_value"in e?e._value:e.value}function is(e){e.target.composing=!0}function ns(e){e.target.composing&&(e.target.composing=!1,os(e.target,"input"))}function os(e,t){var r=document.createEvent("HTMLEvents");r.initEvent(t,!0,!0),e.dispatchEvent(r)}function ss(e){return!e.componentInstance||e.data&&e.data.transition?e:ss(e.componentInstance._vnode)}var as={bind:function(e,t,r){var i=t.value;r=ss(r);var n=r.data&&r.data.transition,o=e.__vOriginalDisplay="none"===e.style.display?"":e.style.display;i&&n?(r.data.show=!0,Ho(r,(function(){e.style.display=o}))):e.style.display=i?o:"none"},update:function(e,t,r){var i=t.value,n=t.oldValue;if(!i!==!n){r=ss(r);var o=r.data&&r.data.transition;o?(r.data.show=!0,i?Ho(r,(function(){e.style.display=e.__vOriginalDisplay})):Qo(r,(function(){e.style.display="none"}))):e.style.display=i?e.__vOriginalDisplay:"none"}},unbind:function(e,t,r,i,n){n||(e.style.display=e.__vOriginalDisplay)}},cs={model:Jo,show:as},ls={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function us(e){var t=e&&e.componentOptions;return t&&t.Ctor.options.abstract?us(Cr(t.children)):e}function ds(e){var t={},r=e.$options;for(var i in r.propsData)t[i]=e[i];var n=r._parentListeners;for(var o in n)t[C(o)]=n[o];return t}function hs(e,t){if(/\d-keep-alive$/.test(t.tag))return e("keep-alive",{props:t.componentOptions.propsData})}function ps(e){while(e=e.parent)if(e.data.transition)return!0}function fs(e,t){return t.key===e.key&&t.tag===e.tag}var gs=function(e){return e.tag||Dt(e)},ms=function(e){return"show"===e.name},_s={name:"transition",props:ls,abstract:!0,render:function(e){var t=this,r=this.$slots.default;if(r&&(r=r.filter(gs),r.length)){0;var i=this.mode;0;var n=r[0];if(ps(this.$vnode))return n;var o=us(n);if(!o)return n;if(this._leaving)return hs(e,n);var s="__transition-"+this._uid+"-";o.key=null==o.key?o.isComment?s+"comment":s+o.tag:a(o.key)?0===String(o.key).indexOf(s)?o.key:s+o.key:o.key;var c=(o.data||(o.data={})).transition=ds(this),l=this._vnode,u=us(l);if(o.data.directives&&o.data.directives.some(ms)&&(o.data.show=!0),u&&u.data&&!fs(o,u)&&!Dt(u)&&(!u.componentInstance||!u.componentInstance._vnode.isComment)){var d=u.data.transition=N({},c);if("out-in"===i)return this._leaving=!0,St(d,"afterLeave",(function(){t._leaving=!1,t.$forceUpdate()})),hs(e,n);if("in-out"===i){if(Dt(o))return l;var h,p=function(){h()};St(c,"afterEnter",p),St(c,"enterCancelled",p),St(d,"delayLeave",(function(e){h=e}))}}return n}}},vs=N({tag:String,moveClass:String},ls);delete vs.mode;var Es={props:vs,beforeMount:function(){var e=this,t=this._update;this._update=function(r,i){var n=Nr(e);e.__patch__(e._vnode,e.kept,!1,!0),e._vnode=e.kept,n(),t.call(e,r,i)}},render:function(e){for(var t=this.tag||this.$vnode.data.tag||"span",r=Object.create(null),i=this.prevChildren=this.children,n=this.$slots.default||[],o=this.children=[],s=ds(this),a=0;a<n.length;a++){var c=n[a];if(c.tag)if(null!=c.key&&0!==String(c.key).indexOf("__vlist"))o.push(c),r[c.key]=c,(c.data||(c.data={})).transition=s;else;}if(i){for(var l=[],u=[],d=0;d<i.length;d++){var h=i[d];h.data.transition=s,h.data.pos=h.elm.getBoundingClientRect(),r[h.key]?l.push(h):u.push(h)}this.kept=e(t,null,l),this.removed=u}return e(t,null,o)},updated:function(){var e=this.prevChildren,t=this.moveClass||(this.name||"v")+"-move";e.length&&this.hasMove(e[0].elm,t)&&(e.forEach(As),e.forEach(ys),e.forEach(Ss),this._reflow=document.body.offsetHeight,e.forEach((function(e){if(e.data.moved){var r=e.elm,i=r.style;xo(r,t),i.transform=i.WebkitTransform=i.transitionDuration="",r.addEventListener(No,r._moveCb=function e(i){i&&i.target!==r||i&&!/transform$/.test(i.propertyName)||(r.removeEventListener(No,e),r._moveCb=null,Bo(r,t))})}})))},methods:{hasMove:function(e,t){if(!Ro)return!1;if(this._hasMove)return this._hasMove;var r=e.cloneNode();e._transitionClasses&&e._transitionClasses.forEach((function(e){To(r,e)})),Co(r,t),r.style.display="none",this.$el.appendChild(r);var i=Vo(r);return this.$el.removeChild(r),this._hasMove=i.hasTransform}}};function As(e){e.elm._moveCb&&e.elm._moveCb(),e.elm._enterCb&&e.elm._enterCb()}function ys(e){e.data.newPos=e.elm.getBoundingClientRect()}function Ss(e){var t=e.data.pos,r=e.data.newPos,i=t.left-r.left,n=t.top-r.top;if(i||n){e.data.moved=!0;var o=e.elm.style;o.transform=o.WebkitTransform="translate("+i+"px,"+n+"px)",o.transitionDuration="0s"}}var Cs={Transition:_s,TransitionGroup:Es};Ci.config.mustUseProp=Vi,Ci.config.isReservedTag=sn,Ci.config.isReservedAttr=Ui,Ci.config.getTagNamespace=an,Ci.config.isUnknownElement=ln,N(Ci.options.directives,cs),N(Ci.options.components,Cs),Ci.prototype.__patch__=K?$o:P,Ci.prototype.$mount=function(e,t){return e=e&&K?dn(e):void 0,Dr(this,e,t)},K&&setTimeout((function(){G.devtools&&le&&le.emit("init",Ci)}),0),t["default"]=Ci}.call(this,r("c8ba"))},"2b3d":function(e,t,r){"use strict";r("3ca3");var i,n=r("23e7"),o=r("83ab"),s=r("0d3b"),a=r("da84"),c=r("0366"),l=r("e330"),u=r("37e8").f,d=r("6eeb"),h=r("19aa"),p=r("1a2d"),f=r("60da"),g=r("4df4"),m=r("4dae"),_=r("6547").codeAt,v=r("5fb2"),E=r("577e"),A=r("d44e"),y=r("9861"),S=r("69f3"),C=S.set,T=S.getterFor("URL"),b=y.URLSearchParams,I=y.getState,R=a.URL,w=a.TypeError,k=a.parseInt,O=Math.floor,N=Math.pow,L=l("".charAt),P=l(/./.exec),D=l([].join),M=l(1..toString),x=l([].pop),B=l([].push),U=l("".replace),F=l([].shift),V=l("".split),j=l("".slice),G=l("".toLowerCase),H=l([].unshift),Q="Invalid authority",W="Invalid scheme",q="Invalid host",z="Invalid port",Z=/[a-z]/i,Y=/[\d+-.a-z]/i,K=/\d/,$=/^0x/i,J=/^[0-7]+$/,X=/^\d+$/,ee=/^[\da-f]+$/i,te=/[\0\t\n\r #%/:<>?@[\\\]^|]/,re=/[\0\t\n\r #/:<>?@[\\\]^|]/,ie=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,ne=/[\t\n\r]/g,oe=function(e){var t,r,i,n,o,s,a,c=V(e,".");if(c.length&&""==c[c.length-1]&&c.length--,t=c.length,t>4)return e;for(r=[],i=0;i<t;i++){if(n=c[i],""==n)return e;if(o=10,n.length>1&&"0"==L(n,0)&&(o=P($,n)?16:8,n=j(n,8==o?1:2)),""===n)s=0;else{if(!P(10==o?X:8==o?J:ee,n))return e;s=k(n,o)}B(r,s)}for(i=0;i<t;i++)if(s=r[i],i==t-1){if(s>=N(256,5-t))return null}else if(s>255)return null;for(a=x(r),i=0;i<r.length;i++)a+=r[i]*N(256,3-i);return a},se=function(e){var t,r,i,n,o,s,a,c=[0,0,0,0,0,0,0,0],l=0,u=null,d=0,h=function(){return L(e,d)};if(":"==h()){if(":"!=L(e,1))return;d+=2,l++,u=l}while(h()){if(8==l)return;if(":"!=h()){t=r=0;while(r<4&&P(ee,h()))t=16*t+k(h(),16),d++,r++;if("."==h()){if(0==r)return;if(d-=r,l>6)return;i=0;while(h()){if(n=null,i>0){if(!("."==h()&&i<4))return;d++}if(!P(K,h()))return;while(P(K,h())){if(o=k(h(),10),null===n)n=o;else{if(0==n)return;n=10*n+o}if(n>255)return;d++}c[l]=256*c[l]+n,i++,2!=i&&4!=i||l++}if(4!=i)return;break}if(":"==h()){if(d++,!h())return}else if(h())return;c[l++]=t}else{if(null!==u)return;d++,l++,u=l}}if(null!==u){s=l-u,l=7;while(0!=l&&s>0)a=c[l],c[l--]=c[u+s-1],c[u+--s]=a}else if(8!=l)return;return c},ae=function(e){for(var t=null,r=1,i=null,n=0,o=0;o<8;o++)0!==e[o]?(n>r&&(t=i,r=n),i=null,n=0):(null===i&&(i=o),++n);return n>r&&(t=i,r=n),t},ce=function(e){var t,r,i,n;if("number"==typeof e){for(t=[],r=0;r<4;r++)H(t,e%256),e=O(e/256);return D(t,".")}if("object"==typeof e){for(t="",i=ae(e),r=0;r<8;r++)n&&0===e[r]||(n&&(n=!1),i===r?(t+=r?":":"::",n=!0):(t+=M(e[r],16),r<7&&(t+=":")));return"["+t+"]"}return e},le={},ue=f({},le,{" ":1,'"':1,"<":1,">":1,"`":1}),de=f({},ue,{"#":1,"?":1,"{":1,"}":1}),he=f({},de,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),pe=function(e,t){var r=_(e,0);return r>32&&r<127&&!p(t,e)?e:encodeURIComponent(e)},fe={ftp:21,file:null,http:80,https:443,ws:80,wss:443},ge=function(e,t){var r;return 2==e.length&&P(Z,L(e,0))&&(":"==(r=L(e,1))||!t&&"|"==r)},me=function(e){var t;return e.length>1&&ge(j(e,0,2))&&(2==e.length||"/"===(t=L(e,2))||"\\"===t||"?"===t||"#"===t)},_e=function(e){return"."===e||"%2e"===G(e)},ve=function(e){return e=G(e),".."===e||"%2e."===e||".%2e"===e||"%2e%2e"===e},Ee={},Ae={},ye={},Se={},Ce={},Te={},be={},Ie={},Re={},we={},ke={},Oe={},Ne={},Le={},Pe={},De={},Me={},xe={},Be={},Ue={},Fe={},Ve=function(e,t,r){var i,n,o,s=E(e);if(t){if(n=this.parse(s),n)throw w(n);this.searchParams=null}else{if(void 0!==r&&(i=new Ve(r,!0)),n=this.parse(s,null,i),n)throw w(n);o=I(new b),o.bindURL(this),this.searchParams=o}};Ve.prototype={type:"URL",parse:function(e,t,r){var n,o,s,a,c=this,l=t||Ee,u=0,d="",h=!1,f=!1,_=!1;e=E(e),t||(c.scheme="",c.username="",c.password="",c.host=null,c.port=null,c.path=[],c.query=null,c.fragment=null,c.cannotBeABaseURL=!1,e=U(e,ie,"")),e=U(e,ne,""),n=g(e);while(u<=n.length){switch(o=n[u],l){case Ee:if(!o||!P(Z,o)){if(t)return W;l=ye;continue}d+=G(o),l=Ae;break;case Ae:if(o&&(P(Y,o)||"+"==o||"-"==o||"."==o))d+=G(o);else{if(":"!=o){if(t)return W;d="",l=ye,u=0;continue}if(t&&(c.isSpecial()!=p(fe,d)||"file"==d&&(c.includesCredentials()||null!==c.port)||"file"==c.scheme&&!c.host))return;if(c.scheme=d,t)return void(c.isSpecial()&&fe[c.scheme]==c.port&&(c.port=null));d="","file"==c.scheme?l=Le:c.isSpecial()&&r&&r.scheme==c.scheme?l=Se:c.isSpecial()?l=Ie:"/"==n[u+1]?(l=Ce,u++):(c.cannotBeABaseURL=!0,B(c.path,""),l=Be)}break;case ye:if(!r||r.cannotBeABaseURL&&"#"!=o)return W;if(r.cannotBeABaseURL&&"#"==o){c.scheme=r.scheme,c.path=m(r.path),c.query=r.query,c.fragment="",c.cannotBeABaseURL=!0,l=Fe;break}l="file"==r.scheme?Le:Te;continue;case Se:if("/"!=o||"/"!=n[u+1]){l=Te;continue}l=Re,u++;break;case Ce:if("/"==o){l=we;break}l=xe;continue;case Te:if(c.scheme=r.scheme,o==i)c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,c.path=m(r.path),c.query=r.query;else if("/"==o||"\\"==o&&c.isSpecial())l=be;else if("?"==o)c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,c.path=m(r.path),c.query="",l=Ue;else{if("#"!=o){c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,c.path=m(r.path),c.path.length--,l=xe;continue}c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,c.path=m(r.path),c.query=r.query,c.fragment="",l=Fe}break;case be:if(!c.isSpecial()||"/"!=o&&"\\"!=o){if("/"!=o){c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,l=xe;continue}l=we}else l=Re;break;case Ie:if(l=Re,"/"!=o||"/"!=L(d,u+1))continue;u++;break;case Re:if("/"!=o&&"\\"!=o){l=we;continue}break;case we:if("@"==o){h&&(d="%40"+d),h=!0,s=g(d);for(var v=0;v<s.length;v++){var A=s[v];if(":"!=A||_){var y=pe(A,he);_?c.password+=y:c.username+=y}else _=!0}d=""}else if(o==i||"/"==o||"?"==o||"#"==o||"\\"==o&&c.isSpecial()){if(h&&""==d)return Q;u-=g(d).length+1,d="",l=ke}else d+=o;break;case ke:case Oe:if(t&&"file"==c.scheme){l=De;continue}if(":"!=o||f){if(o==i||"/"==o||"?"==o||"#"==o||"\\"==o&&c.isSpecial()){if(c.isSpecial()&&""==d)return q;if(t&&""==d&&(c.includesCredentials()||null!==c.port))return;if(a=c.parseHost(d),a)return a;if(d="",l=Me,t)return;continue}"["==o?f=!0:"]"==o&&(f=!1),d+=o}else{if(""==d)return q;if(a=c.parseHost(d),a)return a;if(d="",l=Ne,t==Oe)return}break;case Ne:if(!P(K,o)){if(o==i||"/"==o||"?"==o||"#"==o||"\\"==o&&c.isSpecial()||t){if(""!=d){var S=k(d,10);if(S>65535)return z;c.port=c.isSpecial()&&S===fe[c.scheme]?null:S,d=""}if(t)return;l=Me;continue}return z}d+=o;break;case Le:if(c.scheme="file","/"==o||"\\"==o)l=Pe;else{if(!r||"file"!=r.scheme){l=xe;continue}if(o==i)c.host=r.host,c.path=m(r.path),c.query=r.query;else if("?"==o)c.host=r.host,c.path=m(r.path),c.query="",l=Ue;else{if("#"!=o){me(D(m(n,u),""))||(c.host=r.host,c.path=m(r.path),c.shortenPath()),l=xe;continue}c.host=r.host,c.path=m(r.path),c.query=r.query,c.fragment="",l=Fe}}break;case Pe:if("/"==o||"\\"==o){l=De;break}r&&"file"==r.scheme&&!me(D(m(n,u),""))&&(ge(r.path[0],!0)?B(c.path,r.path[0]):c.host=r.host),l=xe;continue;case De:if(o==i||"/"==o||"\\"==o||"?"==o||"#"==o){if(!t&&ge(d))l=xe;else if(""==d){if(c.host="",t)return;l=Me}else{if(a=c.parseHost(d),a)return a;if("localhost"==c.host&&(c.host=""),t)return;d="",l=Me}continue}d+=o;break;case Me:if(c.isSpecial()){if(l=xe,"/"!=o&&"\\"!=o)continue}else if(t||"?"!=o)if(t||"#"!=o){if(o!=i&&(l=xe,"/"!=o))continue}else c.fragment="",l=Fe;else c.query="",l=Ue;break;case xe:if(o==i||"/"==o||"\\"==o&&c.isSpecial()||!t&&("?"==o||"#"==o)){if(ve(d)?(c.shortenPath(),"/"==o||"\\"==o&&c.isSpecial()||B(c.path,"")):_e(d)?"/"==o||"\\"==o&&c.isSpecial()||B(c.path,""):("file"==c.scheme&&!c.path.length&&ge(d)&&(c.host&&(c.host=""),d=L(d,0)+":"),B(c.path,d)),d="","file"==c.scheme&&(o==i||"?"==o||"#"==o))while(c.path.length>1&&""===c.path[0])F(c.path);"?"==o?(c.query="",l=Ue):"#"==o&&(c.fragment="",l=Fe)}else d+=pe(o,de);break;case Be:"?"==o?(c.query="",l=Ue):"#"==o?(c.fragment="",l=Fe):o!=i&&(c.path[0]+=pe(o,le));break;case Ue:t||"#"!=o?o!=i&&("'"==o&&c.isSpecial()?c.query+="%27":c.query+="#"==o?"%23":pe(o,le)):(c.fragment="",l=Fe);break;case Fe:o!=i&&(c.fragment+=pe(o,ue));break}u++}},parseHost:function(e){var t,r,i;if("["==L(e,0)){if("]"!=L(e,e.length-1))return q;if(t=se(j(e,1,-1)),!t)return q;this.host=t}else if(this.isSpecial()){if(e=v(e),P(te,e))return q;if(t=oe(e),null===t)return q;this.host=t}else{if(P(re,e))return q;for(t="",r=g(e),i=0;i<r.length;i++)t+=pe(r[i],le);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return p(fe,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"==this.scheme&&1==t&&ge(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,r=e.username,i=e.password,n=e.host,o=e.port,s=e.path,a=e.query,c=e.fragment,l=t+":";return null!==n?(l+="//",e.includesCredentials()&&(l+=r+(i?":"+i:"")+"@"),l+=ce(n),null!==o&&(l+=":"+o)):"file"==t&&(l+="//"),l+=e.cannotBeABaseURL?s[0]:s.length?"/"+D(s,"/"):"",null!==a&&(l+="?"+a),null!==c&&(l+="#"+c),l},setHref:function(e){var t=this.parse(e);if(t)throw w(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new je(e.path[0]).origin}catch(r){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+ce(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(E(e)+":",Ee)},getUsername:function(){return this.username},setUsername:function(e){var t=g(E(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<t.length;r++)this.username+=pe(t[r],he)}},getPassword:function(){return this.password},setPassword:function(e){var t=g(E(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<t.length;r++)this.password+=pe(t[r],he)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?ce(e):ce(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,ke)},getHostname:function(){var e=this.host;return null===e?"":ce(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,Oe)},getPort:function(){var e=this.port;return null===e?"":E(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(e=E(e),""==e?this.port=null:this.parse(e,Ne))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+D(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Me))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){e=E(e),""==e?this.query=null:("?"==L(e,0)&&(e=j(e,1)),this.query="",this.parse(e,Ue)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){e=E(e),""!=e?("#"==L(e,0)&&(e=j(e,1)),this.fragment="",this.parse(e,Fe)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var je=function(e){var t=h(this,Ge),r=arguments.length>1?arguments[1]:void 0,i=C(t,new Ve(e,!1,r));o||(t.href=i.serialize(),t.origin=i.getOrigin(),t.protocol=i.getProtocol(),t.username=i.getUsername(),t.password=i.getPassword(),t.host=i.getHost(),t.hostname=i.getHostname(),t.port=i.getPort(),t.pathname=i.getPathname(),t.search=i.getSearch(),t.searchParams=i.getSearchParams(),t.hash=i.getHash())},Ge=je.prototype,He=function(e,t){return{get:function(){return T(this)[e]()},set:t&&function(e){return T(this)[t](e)},configurable:!0,enumerable:!0}};if(o&&u(Ge,{href:He("serialize","setHref"),origin:He("getOrigin"),protocol:He("getProtocol","setProtocol"),username:He("getUsername","setUsername"),password:He("getPassword","setPassword"),host:He("getHost","setHost"),hostname:He("getHostname","setHostname"),port:He("getPort","setPort"),pathname:He("getPathname","setPathname"),search:He("getSearch","setSearch"),searchParams:He("getSearchParams"),hash:He("getHash","setHash")}),d(Ge,"toJSON",(function(){return T(this).serialize()}),{enumerable:!0}),d(Ge,"toString",(function(){return T(this).serialize()}),{enumerable:!0}),R){var Qe=R.createObjectURL,We=R.revokeObjectURL;Qe&&d(je,"createObjectURL",c(Qe,R)),We&&d(je,"revokeObjectURL",c(We,R))}A(je,"URL"),n({global:!0,forced:!s,sham:!o},{URL:je})},"2ba4":function(e,t,r){var i=r("40d5"),n=Function.prototype,o=n.apply,s=n.call;e.exports="object"==typeof Reflect&&Reflect.apply||(i?s.bind(o):function(){return s.apply(o,arguments)})},"2bb5":function(e,t,r){"use strict";t.__esModule=!0;r("8122");t.default={mounted:function(){},methods:{getMigratingConfig:function(){return{props:{},events:{}}}}}},"2c3e":function(e,t,r){var i=r("da84"),n=r("83ab"),o=r("9f7f").MISSED_STICKY,s=r("c6b6"),a=r("9bf2").f,c=r("69f3").get,l=RegExp.prototype,u=i.TypeError;n&&o&&a(l,"sticky",{configurable:!0,get:function(){if(this!==l){if("RegExp"===s(this))return!!c(this).sticky;throw u("Incompatible receiver, RegExp required")}}})},"2caf":function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));r("4ae1"),r("d3b7"),r("f8c9"),r("3410");function i(e){return i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},i(e)}function n(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}r("d9e2"),r("a4d3"),r("e01a"),r("d28b"),r("3ca3"),r("ddb0");function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e,t){if(t&&("object"===o(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return s(e)}function c(e){var t=n();return function(){var r,n=i(e);if(t){var o=i(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return a(this,r)}}},"2cf4":function(e,t,r){var i,n,o,s,a=r("da84"),c=r("2ba4"),l=r("0366"),u=r("1626"),d=r("1a2d"),h=r("d039"),p=r("1be4"),f=r("f36a"),g=r("cc12"),m=r("1cdc"),_=r("605d"),v=a.setImmediate,E=a.clearImmediate,A=a.process,y=a.Dispatch,S=a.Function,C=a.MessageChannel,T=a.String,b=0,I={},R="onreadystatechange";try{i=a.location}catch(L){}var w=function(e){if(d(I,e)){var t=I[e];delete I[e],t()}},k=function(e){return function(){w(e)}},O=function(e){w(e.data)},N=function(e){a.postMessage(T(e),i.protocol+"//"+i.host)};v&&E||(v=function(e){var t=f(arguments,1);return I[++b]=function(){c(u(e)?e:S(e),void 0,t)},n(b),b},E=function(e){delete I[e]},_?n=function(e){A.nextTick(k(e))}:y&&y.now?n=function(e){y.now(k(e))}:C&&!m?(o=new C,s=o.port2,o.port1.onmessage=O,n=l(s.postMessage,s)):a.addEventListener&&u(a.postMessage)&&!a.importScripts&&i&&"file:"!==i.protocol&&!h(N)?(n=N,a.addEventListener("message",O,!1)):n=R in g("script")?function(e){p.appendChild(g("script"))[R]=function(){p.removeChild(this),w(e)}}:function(e){setTimeout(k(e),0)}),e.exports={set:v,clear:E}},"2d00":function(e,t,r){var i,n,o=r("da84"),s=r("342f"),a=o.process,c=o.Deno,l=a&&a.versions||c&&c.version,u=l&&l.v8;u&&(i=u.split("."),n=i[0]>0&&i[0]<4?1:+(i[0]+i[1])),!n&&s&&(i=s.match(/Edge\/(\d+)/),(!i||i[1]>=74)&&(i=s.match(/Chrome\/(\d+)/),i&&(n=+i[1]))),e.exports=n},"2d83":function(e,t,r){"use strict";var i=r("387f");e.exports=function(e,t,r,n,o){var s=new Error(e);return i(s,t,r,n,o)}},"2e67":function(e,t,r){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},"2f62":function(e,t,r){"use strict";(function(e){
/*!
 * vuex v3.6.2
 * (c) 2021 Evan You
 * @license MIT
 */
function r(e){var t=Number(e.version.split(".")[0]);if(t>=2)e.mixin({beforeCreate:i});else{var r=e.prototype._init;e.prototype._init=function(e){void 0===e&&(e={}),e.init=e.init?[i].concat(e.init):i,r.call(this,e)}}function i(){var e=this.$options;e.store?this.$store="function"===typeof e.store?e.store():e.store:e.parent&&e.parent.$store&&(this.$store=e.parent.$store)}}var i="undefined"!==typeof window?window:"undefined"!==typeof e?e:{},n=i.__VUE_DEVTOOLS_GLOBAL_HOOK__;function o(e){n&&(e._devtoolHook=n,n.emit("vuex:init",e),n.on("vuex:travel-to-state",(function(t){e.replaceState(t)})),e.subscribe((function(e,t){n.emit("vuex:mutation",e,t)}),{prepend:!0}),e.subscribeAction((function(e,t){n.emit("vuex:action",e,t)}),{prepend:!0}))}function s(e,t){return e.filter(t)[0]}function a(e,t){if(void 0===t&&(t=[]),null===e||"object"!==typeof e)return e;var r=s(t,(function(t){return t.original===e}));if(r)return r.copy;var i=Array.isArray(e)?[]:{};return t.push({original:e,copy:i}),Object.keys(e).forEach((function(r){i[r]=a(e[r],t)})),i}function c(e,t){Object.keys(e).forEach((function(r){return t(e[r],r)}))}function l(e){return null!==e&&"object"===typeof e}function u(e){return e&&"function"===typeof e.then}function d(e,t){return function(){return e(t)}}var h=function(e,t){this.runtime=t,this._children=Object.create(null),this._rawModule=e;var r=e.state;this.state=("function"===typeof r?r():r)||{}},p={namespaced:{configurable:!0}};p.namespaced.get=function(){return!!this._rawModule.namespaced},h.prototype.addChild=function(e,t){this._children[e]=t},h.prototype.removeChild=function(e){delete this._children[e]},h.prototype.getChild=function(e){return this._children[e]},h.prototype.hasChild=function(e){return e in this._children},h.prototype.update=function(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)},h.prototype.forEachChild=function(e){c(this._children,e)},h.prototype.forEachGetter=function(e){this._rawModule.getters&&c(this._rawModule.getters,e)},h.prototype.forEachAction=function(e){this._rawModule.actions&&c(this._rawModule.actions,e)},h.prototype.forEachMutation=function(e){this._rawModule.mutations&&c(this._rawModule.mutations,e)},Object.defineProperties(h.prototype,p);var f=function(e){this.register([],e,!1)};function g(e,t,r){if(t.update(r),r.modules)for(var i in r.modules){if(!t.getChild(i))return void 0;g(e.concat(i),t.getChild(i),r.modules[i])}}f.prototype.get=function(e){return e.reduce((function(e,t){return e.getChild(t)}),this.root)},f.prototype.getNamespace=function(e){var t=this.root;return e.reduce((function(e,r){return t=t.getChild(r),e+(t.namespaced?r+"/":"")}),"")},f.prototype.update=function(e){g([],this.root,e)},f.prototype.register=function(e,t,r){var i=this;void 0===r&&(r=!0);var n=new h(t,r);if(0===e.length)this.root=n;else{var o=this.get(e.slice(0,-1));o.addChild(e[e.length-1],n)}t.modules&&c(t.modules,(function(t,n){i.register(e.concat(n),t,r)}))},f.prototype.unregister=function(e){var t=this.get(e.slice(0,-1)),r=e[e.length-1],i=t.getChild(r);i&&i.runtime&&t.removeChild(r)},f.prototype.isRegistered=function(e){var t=this.get(e.slice(0,-1)),r=e[e.length-1];return!!t&&t.hasChild(r)};var m;var _=function(e){var t=this;void 0===e&&(e={}),!m&&"undefined"!==typeof window&&window.Vue&&N(window.Vue);var r=e.plugins;void 0===r&&(r=[]);var i=e.strict;void 0===i&&(i=!1),this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new f(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._watcherVM=new m,this._makeLocalGettersCache=Object.create(null);var n=this,s=this,a=s.dispatch,c=s.commit;this.dispatch=function(e,t){return a.call(n,e,t)},this.commit=function(e,t,r){return c.call(n,e,t,r)},this.strict=i;var l=this._modules.root.state;S(this,l,[],this._modules.root),y(this,l),r.forEach((function(e){return e(t)}));var u=void 0!==e.devtools?e.devtools:m.config.devtools;u&&o(this)},v={state:{configurable:!0}};function E(e,t,r){return t.indexOf(e)<0&&(r&&r.prepend?t.unshift(e):t.push(e)),function(){var r=t.indexOf(e);r>-1&&t.splice(r,1)}}function A(e,t){e._actions=Object.create(null),e._mutations=Object.create(null),e._wrappedGetters=Object.create(null),e._modulesNamespaceMap=Object.create(null);var r=e.state;S(e,r,[],e._modules.root,!0),y(e,r,t)}function y(e,t,r){var i=e._vm;e.getters={},e._makeLocalGettersCache=Object.create(null);var n=e._wrappedGetters,o={};c(n,(function(t,r){o[r]=d(t,e),Object.defineProperty(e.getters,r,{get:function(){return e._vm[r]},enumerable:!0})}));var s=m.config.silent;m.config.silent=!0,e._vm=new m({data:{$$state:t},computed:o}),m.config.silent=s,e.strict&&w(e),i&&(r&&e._withCommit((function(){i._data.$$state=null})),m.nextTick((function(){return i.$destroy()})))}function S(e,t,r,i,n){var o=!r.length,s=e._modules.getNamespace(r);if(i.namespaced&&(e._modulesNamespaceMap[s],e._modulesNamespaceMap[s]=i),!o&&!n){var a=k(t,r.slice(0,-1)),c=r[r.length-1];e._withCommit((function(){m.set(a,c,i.state)}))}var l=i.context=C(e,s,r);i.forEachMutation((function(t,r){var i=s+r;b(e,i,t,l)})),i.forEachAction((function(t,r){var i=t.root?r:s+r,n=t.handler||t;I(e,i,n,l)})),i.forEachGetter((function(t,r){var i=s+r;R(e,i,t,l)})),i.forEachChild((function(i,o){S(e,t,r.concat(o),i,n)}))}function C(e,t,r){var i=""===t,n={dispatch:i?e.dispatch:function(r,i,n){var o=O(r,i,n),s=o.payload,a=o.options,c=o.type;return a&&a.root||(c=t+c),e.dispatch(c,s)},commit:i?e.commit:function(r,i,n){var o=O(r,i,n),s=o.payload,a=o.options,c=o.type;a&&a.root||(c=t+c),e.commit(c,s,a)}};return Object.defineProperties(n,{getters:{get:i?function(){return e.getters}:function(){return T(e,t)}},state:{get:function(){return k(e.state,r)}}}),n}function T(e,t){if(!e._makeLocalGettersCache[t]){var r={},i=t.length;Object.keys(e.getters).forEach((function(n){if(n.slice(0,i)===t){var o=n.slice(i);Object.defineProperty(r,o,{get:function(){return e.getters[n]},enumerable:!0})}})),e._makeLocalGettersCache[t]=r}return e._makeLocalGettersCache[t]}function b(e,t,r,i){var n=e._mutations[t]||(e._mutations[t]=[]);n.push((function(t){r.call(e,i.state,t)}))}function I(e,t,r,i){var n=e._actions[t]||(e._actions[t]=[]);n.push((function(t){var n=r.call(e,{dispatch:i.dispatch,commit:i.commit,getters:i.getters,state:i.state,rootGetters:e.getters,rootState:e.state},t);return u(n)||(n=Promise.resolve(n)),e._devtoolHook?n.catch((function(t){throw e._devtoolHook.emit("vuex:error",t),t})):n}))}function R(e,t,r,i){e._wrappedGetters[t]||(e._wrappedGetters[t]=function(e){return r(i.state,i.getters,e.state,e.getters)})}function w(e){e._vm.$watch((function(){return this._data.$$state}),(function(){0}),{deep:!0,sync:!0})}function k(e,t){return t.reduce((function(e,t){return e[t]}),e)}function O(e,t,r){return l(e)&&e.type&&(r=t,t=e,e=e.type),{type:e,payload:t,options:r}}function N(e){m&&e===m||(m=e,r(m))}v.state.get=function(){return this._vm._data.$$state},v.state.set=function(e){0},_.prototype.commit=function(e,t,r){var i=this,n=O(e,t,r),o=n.type,s=n.payload,a=(n.options,{type:o,payload:s}),c=this._mutations[o];c&&(this._withCommit((function(){c.forEach((function(e){e(s)}))})),this._subscribers.slice().forEach((function(e){return e(a,i.state)})))},_.prototype.dispatch=function(e,t){var r=this,i=O(e,t),n=i.type,o=i.payload,s={type:n,payload:o},a=this._actions[n];if(a){try{this._actionSubscribers.slice().filter((function(e){return e.before})).forEach((function(e){return e.before(s,r.state)}))}catch(l){0}var c=a.length>1?Promise.all(a.map((function(e){return e(o)}))):a[0](o);return new Promise((function(e,t){c.then((function(t){try{r._actionSubscribers.filter((function(e){return e.after})).forEach((function(e){return e.after(s,r.state)}))}catch(l){0}e(t)}),(function(e){try{r._actionSubscribers.filter((function(e){return e.error})).forEach((function(t){return t.error(s,r.state,e)}))}catch(l){0}t(e)}))}))}},_.prototype.subscribe=function(e,t){return E(e,this._subscribers,t)},_.prototype.subscribeAction=function(e,t){var r="function"===typeof e?{before:e}:e;return E(r,this._actionSubscribers,t)},_.prototype.watch=function(e,t,r){var i=this;return this._watcherVM.$watch((function(){return e(i.state,i.getters)}),t,r)},_.prototype.replaceState=function(e){var t=this;this._withCommit((function(){t._vm._data.$$state=e}))},_.prototype.registerModule=function(e,t,r){void 0===r&&(r={}),"string"===typeof e&&(e=[e]),this._modules.register(e,t),S(this,this.state,e,this._modules.get(e),r.preserveState),y(this,this.state)},_.prototype.unregisterModule=function(e){var t=this;"string"===typeof e&&(e=[e]),this._modules.unregister(e),this._withCommit((function(){var r=k(t.state,e.slice(0,-1));m.delete(r,e[e.length-1])})),A(this)},_.prototype.hasModule=function(e){return"string"===typeof e&&(e=[e]),this._modules.isRegistered(e)},_.prototype.hotUpdate=function(e){this._modules.update(e),A(this,!0)},_.prototype._withCommit=function(e){var t=this._committing;this._committing=!0,e(),this._committing=t},Object.defineProperties(_.prototype,v);var L=F((function(e,t){var r={};return B(t).forEach((function(t){var i=t.key,n=t.val;r[i]=function(){var t=this.$store.state,r=this.$store.getters;if(e){var i=V(this.$store,"mapState",e);if(!i)return;t=i.context.state,r=i.context.getters}return"function"===typeof n?n.call(this,t,r):t[n]},r[i].vuex=!0})),r})),P=F((function(e,t){var r={};return B(t).forEach((function(t){var i=t.key,n=t.val;r[i]=function(){var t=[],r=arguments.length;while(r--)t[r]=arguments[r];var i=this.$store.commit;if(e){var o=V(this.$store,"mapMutations",e);if(!o)return;i=o.context.commit}return"function"===typeof n?n.apply(this,[i].concat(t)):i.apply(this.$store,[n].concat(t))}})),r})),D=F((function(e,t){var r={};return B(t).forEach((function(t){var i=t.key,n=t.val;n=e+n,r[i]=function(){if(!e||V(this.$store,"mapGetters",e))return this.$store.getters[n]},r[i].vuex=!0})),r})),M=F((function(e,t){var r={};return B(t).forEach((function(t){var i=t.key,n=t.val;r[i]=function(){var t=[],r=arguments.length;while(r--)t[r]=arguments[r];var i=this.$store.dispatch;if(e){var o=V(this.$store,"mapActions",e);if(!o)return;i=o.context.dispatch}return"function"===typeof n?n.apply(this,[i].concat(t)):i.apply(this.$store,[n].concat(t))}})),r})),x=function(e){return{mapState:L.bind(null,e),mapGetters:D.bind(null,e),mapMutations:P.bind(null,e),mapActions:M.bind(null,e)}};function B(e){return U(e)?Array.isArray(e)?e.map((function(e){return{key:e,val:e}})):Object.keys(e).map((function(t){return{key:t,val:e[t]}})):[]}function U(e){return Array.isArray(e)||l(e)}function F(e){return function(t,r){return"string"!==typeof t?(r=t,t=""):"/"!==t.charAt(t.length-1)&&(t+="/"),e(t,r)}}function V(e,t,r){var i=e._modulesNamespaceMap[r];return i}function j(e){void 0===e&&(e={});var t=e.collapsed;void 0===t&&(t=!0);var r=e.filter;void 0===r&&(r=function(e,t,r){return!0});var i=e.transformer;void 0===i&&(i=function(e){return e});var n=e.mutationTransformer;void 0===n&&(n=function(e){return e});var o=e.actionFilter;void 0===o&&(o=function(e,t){return!0});var s=e.actionTransformer;void 0===s&&(s=function(e){return e});var c=e.logMutations;void 0===c&&(c=!0);var l=e.logActions;void 0===l&&(l=!0);var u=e.logger;return void 0===u&&(u=console),function(e){var d=a(e.state);"undefined"!==typeof u&&(c&&e.subscribe((function(e,o){var s=a(o);if(r(e,d,s)){var c=Q(),l=n(e),h="mutation "+e.type+c;G(u,h,t),u.log("%c prev state","color: #9E9E9E; font-weight: bold",i(d)),u.log("%c mutation","color: #03A9F4; font-weight: bold",l),u.log("%c next state","color: #4CAF50; font-weight: bold",i(s)),H(u)}d=s})),l&&e.subscribeAction((function(e,r){if(o(e,r)){var i=Q(),n=s(e),a="action "+e.type+i;G(u,a,t),u.log("%c action","color: #03A9F4; font-weight: bold",n),H(u)}})))}}function G(e,t,r){var i=r?e.groupCollapsed:e.group;try{i.call(e,t)}catch(n){e.log(t)}}function H(e){try{e.groupEnd()}catch(t){e.log("—— log end ——")}}function Q(){var e=new Date;return" @ "+q(e.getHours(),2)+":"+q(e.getMinutes(),2)+":"+q(e.getSeconds(),2)+"."+q(e.getMilliseconds(),3)}function W(e,t){return new Array(t+1).join(e)}function q(e,t){return W("0",t-e.toString().length)+e}var z={Store:_,install:N,version:"3.6.2",mapState:L,mapMutations:P,mapGetters:D,mapActions:M,createNamespacedHelpers:x,createLogger:j};t["a"]=z}).call(this,r("c8ba"))},"2f9a":function(e,t){e.exports=function(){}},"301c":function(e,t,r){r("e198")("asyncIterator")},"30b5":function(e,t,r){"use strict";var i=r("c532");function n(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var o;if(r)o=r(t);else if(i.isURLSearchParams(t))o=t.toString();else{var s=[];i.forEach(t,(function(e,t){null!==e&&"undefined"!==typeof e&&(i.isArray(e)?t+="[]":e=[e],i.forEach(e,(function(e){i.isDate(e)?e=e.toISOString():i.isObject(e)&&(e=JSON.stringify(e)),s.push(n(t)+"="+n(e))})))})),o=s.join("&")}if(o){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}},3280:function(e,t,r){"use strict";var i=r("ebb5"),n=r("2ba4"),o=r("e58c"),s=i.aTypedArray,a=i.exportTypedArrayMethod;a("lastIndexOf",(function(e){var t=arguments.length;return n(o,s(this),t>1?[e,arguments[1]]:[e])}))},3397:function(e,t,r){var i=r("7a41");e.exports=function(e,t){if(!i(e))return e;var r,n;if(t&&"function"==typeof(r=e.toString)&&!i(n=r.call(e)))return n;if("function"==typeof(r=e.valueOf)&&!i(n=r.call(e)))return n;if(!t&&"function"==typeof(r=e.toString)&&!i(n=r.call(e)))return n;throw TypeError("Can't convert object to primitive value")}},3410:function(e,t,r){var i=r("23e7"),n=r("d039"),o=r("7b0b"),s=r("e163"),a=r("e177"),c=n((function(){s(1)}));i({target:"Object",stat:!0,forced:c,sham:!a},{getPrototypeOf:function(e){return s(o(e))}})},"342f":function(e,t,r){var i=r("d066");e.exports=i("navigator","userAgent")||""},"35a1":function(e,t,r){var i=r("f5df"),n=r("dc4a"),o=r("3f8c"),s=r("b622"),a=s("iterator");e.exports=function(e){if(void 0!=e)return n(e,a)||n(e,"@@iterator")||o[i(e)]}},"37e8":function(e,t,r){var i=r("83ab"),n=r("aed9"),o=r("9bf2"),s=r("825a"),a=r("fc6a"),c=r("df75");t.f=i&&!n?Object.defineProperties:function(e,t){s(e);var r,i=a(t),n=c(t),l=n.length,u=0;while(l>u)o.f(e,r=n[u++],i[r]);return e}},"387f":function(e,t,r){"use strict";e.exports=function(e,t,r,i,n){return e.config=t,r&&(e.code=r),e.request=i,e.response=n,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e}},3934:function(e,t,r){"use strict";var i=r("c532");e.exports=i.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function n(e){var i=e;return t&&(r.setAttribute("href",i),i=r.href),r.setAttribute("href",i),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=n(window.location.href),function(t){var r=i.isString(t)?n(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return function(){return!0}}()},"393a":function(e,t,r){"use strict";var i=r("e444"),n=r("512c"),o=r("ba01"),s=r("051b"),a=r("8a0d"),c=r("26dd"),l=r("92f0"),u=r("ce7a"),d=r("cc15")("iterator"),h=!([].keys&&"next"in[].keys()),p="@@iterator",f="keys",g="values",m=function(){return this};e.exports=function(e,t,r,_,v,E,A){c(r,t,_);var y,S,C,T=function(e){if(!h&&e in w)return w[e];switch(e){case f:return function(){return new r(this,e)};case g:return function(){return new r(this,e)}}return function(){return new r(this,e)}},b=t+" Iterator",I=v==g,R=!1,w=e.prototype,k=w[d]||w[p]||v&&w[v],O=k||T(v),N=v?I?T("entries"):O:void 0,L="Array"==t&&w.entries||k;if(L&&(C=u(L.call(new e)),C!==Object.prototype&&C.next&&(l(C,b,!0),i||"function"==typeof C[d]||s(C,d,m))),I&&k&&k.name!==g&&(R=!0,O=function(){return k.call(this)}),i&&!A||!h&&!R&&w[d]||s(w,d,O),a[t]=O,a[b]=m,v)if(y={values:I?O:T(g),keys:E?O:T(f),entries:N},A)for(S in y)S in w||o(w,S,y[S]);else n(n.P+n.F*(h||R),t,y);return y}},"39ad":function(e,t,r){var i=r("6ca1"),n=r("d16a"),o=r("9d11");e.exports=function(e){return function(t,r,s){var a,c=i(t),l=n(c.length),u=o(s,l);if(e&&r!=r){while(l>u)if(a=c[u++],a!=a)return!0}else for(;l>u;u++)if((e||u in c)&&c[u]===r)return e||u||0;return!e&&-1}}},"3a7b":function(e,t,r){"use strict";var i=r("ebb5"),n=r("b727").findIndex,o=i.aTypedArray,s=i.exportTypedArrayMethod;s("findIndex",(function(e){return n(o(this),e,arguments.length>1?arguments[1]:void 0)}))},"3a9b":function(e,t,r){var i=r("e330");e.exports=i({}.isPrototypeOf)},"3bbe":function(e,t,r){var i=r("da84"),n=r("1626"),o=i.String,s=i.TypeError;e.exports=function(e){if("object"==typeof e||n(e))return e;throw s("Can't set "+o(e)+" as a prototype")}},"3c5d":function(e,t,r){"use strict";var i=r("da84"),n=r("c65b"),o=r("ebb5"),s=r("07fa"),a=r("182d"),c=r("7b0b"),l=r("d039"),u=i.RangeError,d=i.Int8Array,h=d&&d.prototype,p=h&&h.set,f=o.aTypedArray,g=o.exportTypedArrayMethod,m=!l((function(){var e=new Uint8ClampedArray(2);return n(p,e,{length:1,0:3},1),3!==e[1]})),_=m&&o.NATIVE_ARRAY_BUFFER_VIEWS&&l((function(){var e=new d(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));g("set",(function(e){f(this);var t=a(arguments.length>1?arguments[1]:void 0,1),r=c(e);if(m)return n(p,this,r,t);var i=this.length,o=s(r),l=0;if(o+t>i)throw u("Wrong length");while(l<o)this[t+l]=r[l++]}),!m||_)},"3ca3":function(e,t,r){"use strict";var i=r("6547").charAt,n=r("577e"),o=r("69f3"),s=r("7dd0"),a="String Iterator",c=o.set,l=o.getterFor(a);s(String,"String",(function(e){c(this,{type:a,string:n(e),index:0})}),(function(){var e,t=l(this),r=t.string,n=t.index;return n>=r.length?{value:void 0,done:!0}:(e=i(r,n),t.index+=e.length,{value:e,done:!1})}))},"3f6b":function(e,t,r){e.exports={default:r("b9c7"),__esModule:!0}},"3f8c":function(e,t){e.exports={}},"3fcc":function(e,t,r){"use strict";var i=r("ebb5"),n=r("b727").map,o=r("b6b7"),s=i.aTypedArray,a=i.exportTypedArrayMethod;a("map",(function(e){return n(s(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(o(e))(t)}))}))},4010:function(e,t,r){"use strict";t.__esModule=!0,t.removeResizeListener=t.addResizeListener=void 0;var i=r("6dd8"),n=o(i);function o(e){return e&&e.__esModule?e:{default:e}}var s="undefined"===typeof window,a=function(e){var t=e,r=Array.isArray(t),i=0;for(t=r?t:t[Symbol.iterator]();;){var n;if(r){if(i>=t.length)break;n=t[i++]}else{if(i=t.next(),i.done)break;n=i.value}var o=n,s=o.target.__resizeListeners__||[];s.length&&s.forEach((function(e){e()}))}};t.addResizeListener=function(e,t){s||(e.__resizeListeners__||(e.__resizeListeners__=[],e.__ro__=new n.default(a),e.__ro__.observe(e)),e.__resizeListeners__.push(t))},t.removeResizeListener=function(e,t){e&&e.__resizeListeners__&&(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(t),1),e.__resizeListeners__.length||e.__ro__.disconnect())}},"408a":function(e,t,r){var i=r("e330");e.exports=i(1..valueOf)},"40d5":function(e,t,r){var i=r("d039");e.exports=!i((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},"417f":function(e,t,r){"use strict";t.__esModule=!0;var i=r("2b0e"),n=s(i),o=r("5924");function s(e){return e&&e.__esModule?e:{default:e}}var a=[],c="@@clickoutsideContext",l=void 0,u=0;function d(e,t,r){return function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!(r&&r.context&&i.target&&n.target)||e.contains(i.target)||e.contains(n.target)||e===i.target||r.context.popperElm&&(r.context.popperElm.contains(i.target)||r.context.popperElm.contains(n.target))||(t.expression&&e[c].methodName&&r.context[e[c].methodName]?r.context[e[c].methodName]():e[c].bindingFn&&e[c].bindingFn())}}!n.default.prototype.$isServer&&(0,o.on)(document,"mousedown",(function(e){return l=e})),!n.default.prototype.$isServer&&(0,o.on)(document,"mouseup",(function(e){a.forEach((function(t){return t[c].documentHandler(e,l)}))})),t.default={bind:function(e,t,r){a.push(e);var i=u++;e[c]={id:i,documentHandler:d(e,t,r),methodName:t.expression,bindingFn:t.value}},update:function(e,t,r){e[c].documentHandler=d(e,t,r),e[c].methodName=t.expression,e[c].bindingFn=t.value},unbind:function(e){for(var t=a.length,r=0;r<t;r++)if(a[r][c].id===e[c].id){a.splice(r,1);break}delete e[c]}}},"41b2":function(e,t,r){"use strict";t.__esModule=!0;var i=r("3f6b"),n=o(i);function o(e){return e&&e.__esModule?e:{default:e}}t.default=n.default||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}},"41f8":function(e,t,r){"use strict";t.__esModule=!0;var i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.isVNode=o;var n=r("8122");function o(e){return null!==e&&"object"===("undefined"===typeof e?"undefined":i(e))&&(0,n.hasOwn)(e,"componentOptions")}},"428f":function(e,t,r){var i=r("da84");e.exports=i},4362:function(e,t,r){t.nextTick=function(e){var t=Array.prototype.slice.call(arguments);t.shift(),setTimeout((function(){e.apply(null,t)}),0)},t.platform=t.arch=t.execPath=t.title="browser",t.pid=1,t.browser=!0,t.env={},t.argv=[],t.binding=function(e){throw new Error("No such module. (Possibly not yet loaded)")},function(){var e,i="/";t.cwd=function(){return i},t.chdir=function(t){e||(e=r("df7c")),i=e.resolve(t,i)}}(),t.exit=t.kill=t.umask=t.dlopen=t.uptime=t.memoryUsage=t.uvCounters=function(){},t.features={}},"44ad":function(e,t,r){var i=r("da84"),n=r("e330"),o=r("d039"),s=r("c6b6"),a=i.Object,c=n("".split);e.exports=o((function(){return!a("z").propertyIsEnumerable(0)}))?function(e){return"String"==s(e)?c(e,""):a(e)}:a},"44d2":function(e,t,r){var i=r("b622"),n=r("7c73"),o=r("9bf2"),s=i("unscopables"),a=Array.prototype;void 0==a[s]&&o.f(a,s,{configurable:!0,value:n(null)}),e.exports=function(e){a[s][e]=!0}},"44de":function(e,t,r){var i=r("da84");e.exports=function(e,t){var r=i.console;r&&r.error&&(1==arguments.length?r.error(e):r.error(e,t))}},"44e7":function(e,t,r){var i=r("861d"),n=r("c6b6"),o=r("b622"),s=o("match");e.exports=function(e){var t;return i(e)&&(void 0!==(t=e[s])?!!t:"RegExp"==n(e))}},"466d":function(e,t,r){"use strict";var i=r("c65b"),n=r("d784"),o=r("825a"),s=r("50c4"),a=r("577e"),c=r("1d80"),l=r("dc4a"),u=r("8aa5"),d=r("14c3");n("match",(function(e,t,r){return[function(t){var r=c(this),n=void 0==t?void 0:l(t,e);return n?i(n,t,r):new RegExp(t)[e](a(r))},function(e){var i=o(this),n=a(e),c=r(t,i,n);if(c.done)return c.value;if(!i.global)return d(i,n);var l=i.unicode;i.lastIndex=0;var h,p=[],f=0;while(null!==(h=d(i,n))){var g=a(h[0]);p[f]=g,""===g&&(i.lastIndex=u(n,s(i.lastIndex),l)),f++}return 0===f?null:p}]}))},"467f":function(e,t,r){"use strict";var i=r("2d83");e.exports=function(e,t,r){var n=r.config.validateStatus;r.status&&n&&!n(r.status)?t(i("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},4726:function(e,t,r){e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=59)}({0:function(e,t,r){"use strict";function i(e,t,r,i,n,o,s,a){var c,l="function"===typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=r,l._compiled=!0),i&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),s?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},l._ssrRegister=c):n&&(c=a?function(){n.call(this,this.$root.$options.shadowRoot)}:n),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(e,t){return c.call(t),u(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,c):[c]}return{exports:e,options:l}}r.d(t,"a",(function(){return i}))},15:function(e,t){e.exports=r("14e9")},19:function(e,t){e.exports=r("dcdc")},21:function(e,t){e.exports=r("d397")},26:function(e,t){e.exports=r("92fa")},3:function(e,t){e.exports=r("8122")},31:function(e,t){e.exports=r("2a5e")},40:function(e,t){e.exports=r("e452")},51:function(e,t){e.exports=r("f494")},59:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:["el-cascader-panel",e.border&&"is-bordered"],on:{keydown:e.handleKeyDown}},e._l(e.menus,(function(e,t){return r("cascader-menu",{key:t,ref:"menu",refInFor:!0,attrs:{index:t,nodes:e}})})),1)},n=[];i._withStripped=!0;var o,s,a=r(26),c=r.n(a),l=r(15),u=r.n(l),d=r(19),h=r.n(d),p=r(51),f=r.n(p),g=r(3),m=function(e){return e.stopPropagation()},_={inject:["panel"],components:{ElCheckbox:h.a,ElRadio:f.a},props:{node:{required:!0},nodeId:String},computed:{config:function(){return this.panel.config},isLeaf:function(){return this.node.isLeaf},isDisabled:function(){return this.node.isDisabled},checkedValue:function(){return this.panel.checkedValue},isChecked:function(){return this.node.isSameNode(this.checkedValue)},inActivePath:function(){return this.isInPath(this.panel.activePath)},inCheckedPath:function(){var e=this;return!!this.config.checkStrictly&&this.panel.checkedNodePaths.some((function(t){return e.isInPath(t)}))},value:function(){return this.node.getValueByOption()}},methods:{handleExpand:function(){var e=this,t=this.panel,r=this.node,i=this.isDisabled,n=this.config,o=n.multiple,s=n.checkStrictly;!s&&i||r.loading||(n.lazy&&!r.loaded?t.lazyLoad(r,(function(){var t=e.isLeaf;if(t||e.handleExpand(),o){var i=!!t&&r.checked;e.handleMultiCheckChange(i)}})):t.handleExpand(r))},handleCheckChange:function(){var e=this.panel,t=this.value,r=this.node;e.handleCheckChange(t),e.handleExpand(r)},handleMultiCheckChange:function(e){this.node.doCheck(e),this.panel.calculateMultiCheckedValue()},isInPath:function(e){var t=this.node,r=e[t.level-1]||{};return r.uid===t.uid},renderPrefix:function(e){var t=this.isLeaf,r=this.isChecked,i=this.config,n=i.checkStrictly,o=i.multiple;return o?this.renderCheckbox(e):n?this.renderRadio(e):t&&r?this.renderCheckIcon(e):null},renderPostfix:function(e){var t=this.node,r=this.isLeaf;return t.loading?this.renderLoadingIcon(e):r?null:this.renderExpandIcon(e)},renderCheckbox:function(e){var t=this.node,r=this.config,i=this.isDisabled,n={on:{change:this.handleMultiCheckChange},nativeOn:{}};return r.checkStrictly&&(n.nativeOn.click=m),e("el-checkbox",c()([{attrs:{value:t.checked,indeterminate:t.indeterminate,disabled:i}},n]))},renderRadio:function(e){var t=this.checkedValue,r=this.value,i=this.isDisabled;return Object(g["isEqual"])(r,t)&&(r=t),e("el-radio",{attrs:{value:t,label:r,disabled:i},on:{change:this.handleCheckChange},nativeOn:{click:m}},[e("span")])},renderCheckIcon:function(e){return e("i",{class:"el-icon-check el-cascader-node__prefix"})},renderLoadingIcon:function(e){return e("i",{class:"el-icon-loading el-cascader-node__postfix"})},renderExpandIcon:function(e){return e("i",{class:"el-icon-arrow-right el-cascader-node__postfix"})},renderContent:function(e){var t=this.panel,r=this.node,i=t.renderLabelFn,n=i?i({node:r,data:r.data}):null;return e("span",{class:"el-cascader-node__label"},[n||r.label])}},render:function(e){var t=this,r=this.inActivePath,i=this.inCheckedPath,n=this.isChecked,o=this.isLeaf,s=this.isDisabled,a=this.config,l=this.nodeId,u=a.expandTrigger,d=a.checkStrictly,h=a.multiple,p=!d&&s,f={on:{}};return"click"===u?f.on.click=this.handleExpand:(f.on.mouseenter=function(e){t.handleExpand(),t.$emit("expand",e)},f.on.focus=function(e){t.handleExpand(),t.$emit("expand",e)}),!o||s||d||h||(f.on.click=this.handleCheckChange),e("li",c()([{attrs:{role:"menuitem",id:l,"aria-expanded":r,tabindex:p?null:-1},class:{"el-cascader-node":!0,"is-selectable":d,"in-active-path":r,"in-checked-path":i,"is-active":n,"is-disabled":p}},f]),[this.renderPrefix(e),this.renderContent(e),this.renderPostfix(e)])}},v=_,E=r(0),A=Object(E["a"])(v,o,s,!1,null,null,null);A.options.__file="packages/cascader-panel/src/cascader-node.vue";var y,S,C=A.exports,T=r(6),b=r.n(T),I={name:"ElCascaderMenu",mixins:[b.a],inject:["panel"],components:{ElScrollbar:u.a,CascaderNode:C},props:{nodes:{type:Array,required:!0},index:Number},data:function(){return{activeNode:null,hoverTimer:null,id:Object(g["generateId"])()}},computed:{isEmpty:function(){return!this.nodes.length},menuId:function(){return"cascader-menu-"+this.id+"-"+this.index}},methods:{handleExpand:function(e){this.activeNode=e.target},handleMouseMove:function(e){var t=this.activeNode,r=this.hoverTimer,i=this.$refs.hoverZone;if(t&&i)if(t.contains(e.target)){clearTimeout(r);var n=this.$el.getBoundingClientRect(),o=n.left,s=e.clientX-o,a=this.$el,c=a.offsetWidth,l=a.offsetHeight,u=t.offsetTop,d=u+t.offsetHeight;i.innerHTML='\n          <path style="pointer-events: auto;" fill="transparent" d="M'+s+" "+u+" L"+c+" 0 V"+u+' Z" />\n          <path style="pointer-events: auto;" fill="transparent" d="M'+s+" "+d+" L"+c+" "+l+" V"+d+' Z" />\n        '}else r||(this.hoverTimer=setTimeout(this.clearHoverZone,this.panel.config.hoverThreshold))},clearHoverZone:function(){var e=this.$refs.hoverZone;e&&(e.innerHTML="")},renderEmptyText:function(e){return e("div",{class:"el-cascader-menu__empty-text"},[this.t("el.cascader.noData")])},renderNodeList:function(e){var t=this.menuId,r=this.panel.isHoverMenu,i={on:{}};r&&(i.on.expand=this.handleExpand);var n=this.nodes.map((function(r,n){var o=r.hasChildren;return e("cascader-node",c()([{key:r.uid,attrs:{node:r,"node-id":t+"-"+n,"aria-haspopup":o,"aria-owns":o?t:null}},i]))}));return[].concat(n,[r?e("svg",{ref:"hoverZone",class:"el-cascader-menu__hover-zone"}):null])}},render:function(e){var t=this.isEmpty,r=this.menuId,i={nativeOn:{}};return this.panel.isHoverMenu&&(i.nativeOn.mousemove=this.handleMouseMove),e("el-scrollbar",c()([{attrs:{tag:"ul",role:"menu",id:r,"wrap-class":"el-cascader-menu__wrap","view-class":{"el-cascader-menu__list":!0,"is-empty":t}},class:"el-cascader-menu"},i]),[t?this.renderEmptyText(e):this.renderNodeList(e)])}},R=I,w=Object(E["a"])(R,y,S,!1,null,null,null);w.options.__file="packages/cascader-panel/src/cascader-menu.vue";var k=w.exports,O=r(21),N=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();function L(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var P=0,D=function(){function e(t,r,i){L(this,e),this.data=t,this.config=r,this.parent=i||null,this.level=this.parent?this.parent.level+1:1,this.uid=P++,this.initState(),this.initChildren()}return e.prototype.initState=function(){var e=this.config,t=e.value,r=e.label;this.value=this.data[t],this.label=this.data[r],this.pathNodes=this.calculatePathNodes(),this.path=this.pathNodes.map((function(e){return e.value})),this.pathLabels=this.pathNodes.map((function(e){return e.label})),this.loading=!1,this.loaded=!1},e.prototype.initChildren=function(){var t=this,r=this.config,i=r.children,n=this.data[i];this.hasChildren=Array.isArray(n),this.children=(n||[]).map((function(i){return new e(i,r,t)}))},e.prototype.calculatePathNodes=function(){var e=[this],t=this.parent;while(t)e.unshift(t),t=t.parent;return e},e.prototype.getPath=function(){return this.path},e.prototype.getValue=function(){return this.value},e.prototype.getValueByOption=function(){return this.config.emitPath?this.getPath():this.getValue()},e.prototype.getText=function(e,t){return e?this.pathLabels.join(t):this.label},e.prototype.isSameNode=function(e){var t=this.getValueByOption();return this.config.multiple&&Array.isArray(e)?e.some((function(e){return Object(g["isEqual"])(e,t)})):Object(g["isEqual"])(e,t)},e.prototype.broadcast=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];var n="onParent"+Object(g["capitalize"])(e);this.children.forEach((function(t){t&&(t.broadcast.apply(t,[e].concat(r)),t[n]&&t[n].apply(t,r))}))},e.prototype.emit=function(e){var t=this.parent,r="onChild"+Object(g["capitalize"])(e);if(t){for(var i=arguments.length,n=Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];t[r]&&t[r].apply(t,n),t.emit.apply(t,[e].concat(n))}},e.prototype.onParentCheck=function(e){this.isDisabled||this.setCheckState(e)},e.prototype.onChildCheck=function(){var e=this.children,t=e.filter((function(e){return!e.isDisabled})),r=!!t.length&&t.every((function(e){return e.checked}));this.setCheckState(r)},e.prototype.setCheckState=function(e){var t=this.children.length,r=this.children.reduce((function(e,t){var r=t.checked?1:t.indeterminate?.5:0;return e+r}),0);this.checked=e,this.indeterminate=r!==t&&r>0},e.prototype.syncCheckState=function(e){var t=this.getValueByOption(),r=this.isSameNode(e,t);this.doCheck(r)},e.prototype.doCheck=function(e){this.checked!==e&&(this.config.checkStrictly?this.checked=e:(this.broadcast("check",e),this.setCheckState(e),this.emit("check")))},N(e,[{key:"isDisabled",get:function(){var e=this.data,t=this.parent,r=this.config,i=r.disabled,n=r.checkStrictly;return e[i]||!n&&t&&t.isDisabled}},{key:"isLeaf",get:function(){var e=this.data,t=this.loaded,r=this.hasChildren,i=this.children,n=this.config,o=n.lazy,s=n.leaf;if(o){var a=Object(O["isDef"])(e[s])?e[s]:!!t&&!i.length;return this.hasChildren=!a,a}return!r}}]),e}(),M=D;function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var B=function e(t,r){return t.reduce((function(t,i){return i.isLeaf?t.push(i):(!r&&t.push(i),t=t.concat(e(i.children,r))),t}),[])},U=function(){function e(t,r){x(this,e),this.config=r,this.initNodes(t)}return e.prototype.initNodes=function(e){var t=this;e=Object(g["coerceTruthyValueToArray"])(e),this.nodes=e.map((function(e){return new M(e,t.config)})),this.flattedNodes=this.getFlattedNodes(!1,!1),this.leafNodes=this.getFlattedNodes(!0,!1)},e.prototype.appendNode=function(e,t){var r=new M(e,this.config,t),i=t?t.children:this.nodes;i.push(r)},e.prototype.appendNodes=function(e,t){var r=this;e=Object(g["coerceTruthyValueToArray"])(e),e.forEach((function(e){return r.appendNode(e,t)}))},e.prototype.getNodes=function(){return this.nodes},e.prototype.getFlattedNodes=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e?this.leafNodes:this.flattedNodes;return t?r:B(this.nodes,e)},e.prototype.getNodeByValue=function(e){var t=this.getFlattedNodes(!1,!this.config.lazy).filter((function(t){return Object(g["valueEquals"])(t.path,e)||t.value===e}));return t&&t.length?t[0]:null},e}(),F=U,V=r(9),j=r.n(V),G=r(40),H=r.n(G),Q=r(31),W=r.n(Q),q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},z=H.a.keys,Z={expandTrigger:"click",multiple:!1,checkStrictly:!1,emitPath:!0,lazy:!1,lazyLoad:g["noop"],value:"value",label:"label",children:"children",leaf:"leaf",disabled:"disabled",hoverThreshold:500},Y=function(e){return!e.getAttribute("aria-owns")},K=function(e,t){var r=e.parentNode;if(r){var i=r.querySelectorAll('.el-cascader-node[tabindex="-1"]'),n=Array.prototype.indexOf.call(i,e);return i[n+t]||null}return null},$=function(e,t){if(e){var r=e.id.split("-");return Number(r[r.length-2])}},J=function(e){e&&(e.focus(),!Y(e)&&e.click())},X=function(e){if(e){var t=e.querySelector("input");t?t.click():Y(e)&&e.click()}},ee={name:"ElCascaderPanel",components:{CascaderMenu:k},props:{value:{},options:Array,props:Object,border:{type:Boolean,default:!0},renderLabel:Function},provide:function(){return{panel:this}},data:function(){return{checkedValue:null,checkedNodePaths:[],store:[],menus:[],activePath:[],loadCount:0}},computed:{config:function(){return j()(q({},Z),this.props||{})},multiple:function(){return this.config.multiple},checkStrictly:function(){return this.config.checkStrictly},leafOnly:function(){return!this.checkStrictly},isHoverMenu:function(){return"hover"===this.config.expandTrigger},renderLabelFn:function(){return this.renderLabel||this.$scopedSlots.default}},watch:{options:{handler:function(){this.initStore()},immediate:!0,deep:!0},value:function(){this.syncCheckedValue(),this.checkStrictly&&this.calculateCheckedNodePaths()},checkedValue:function(e){Object(g["isEqual"])(e,this.value)||(this.checkStrictly&&this.calculateCheckedNodePaths(),this.$emit("input",e),this.$emit("change",e))}},mounted:function(){this.isEmptyValue(this.value)||this.syncCheckedValue()},methods:{initStore:function(){var e=this.config,t=this.options;e.lazy&&Object(g["isEmpty"])(t)?this.lazyLoad():(this.store=new F(t,e),this.menus=[this.store.getNodes()],this.syncMenuState())},syncCheckedValue:function(){var e=this.value,t=this.checkedValue;Object(g["isEqual"])(e,t)||(this.activePath=[],this.checkedValue=e,this.syncMenuState())},syncMenuState:function(){var e=this.multiple,t=this.checkStrictly;this.syncActivePath(),e&&this.syncMultiCheckState(),t&&this.calculateCheckedNodePaths(),this.$nextTick(this.scrollIntoView)},syncMultiCheckState:function(){var e=this,t=this.getFlattedNodes(this.leafOnly);t.forEach((function(t){t.syncCheckState(e.checkedValue)}))},isEmptyValue:function(e){var t=this.multiple,r=this.config,i=r.emitPath;return!(!t&&!i)&&Object(g["isEmpty"])(e)},syncActivePath:function(){var e=this,t=this.store,r=this.multiple,i=this.activePath,n=this.checkedValue;if(Object(g["isEmpty"])(i))if(this.isEmptyValue(n))this.activePath=[],this.menus=[t.getNodes()];else{var o=r?n[0]:n,s=this.getNodeByValue(o)||{},a=(s.pathNodes||[]).slice(0,-1);this.expandNodes(a)}else{var c=i.map((function(t){return e.getNodeByValue(t.getValue())}));this.expandNodes(c)}},expandNodes:function(e){var t=this;e.forEach((function(e){return t.handleExpand(e,!0)}))},calculateCheckedNodePaths:function(){var e=this,t=this.checkedValue,r=this.multiple,i=r?Object(g["coerceTruthyValueToArray"])(t):[t];this.checkedNodePaths=i.map((function(t){var r=e.getNodeByValue(t);return r?r.pathNodes:[]}))},handleKeyDown:function(e){var t=e.target,r=e.keyCode;switch(r){case z.up:var i=K(t,-1);J(i);break;case z.down:var n=K(t,1);J(n);break;case z.left:var o=this.$refs.menu[$(t)-1];if(o){var s=o.$el.querySelector('.el-cascader-node[aria-expanded="true"]');J(s)}break;case z.right:var a=this.$refs.menu[$(t)+1];if(a){var c=a.$el.querySelector('.el-cascader-node[tabindex="-1"]');J(c)}break;case z.enter:X(t);break;case z.esc:case z.tab:this.$emit("close");break;default:return}},handleExpand:function(e,t){var r=this.activePath,i=e.level,n=r.slice(0,i-1),o=this.menus.slice(0,i);if(e.isLeaf||(n.push(e),o.push(e.children)),this.activePath=n,this.menus=o,!t){var s=n.map((function(e){return e.getValue()})),a=r.map((function(e){return e.getValue()}));Object(g["valueEquals"])(s,a)||(this.$emit("active-item-change",s),this.$emit("expand-change",s))}},handleCheckChange:function(e){this.checkedValue=e},lazyLoad:function(e,t){var r=this,i=this.config;e||(e=e||{root:!0,level:0},this.store=new F([],i),this.menus=[this.store.getNodes()]),e.loading=!0;var n=function(i){var n=e.root?null:e;if(i&&i.length&&r.store.appendNodes(i,n),e.loading=!1,e.loaded=!0,Array.isArray(r.checkedValue)){var o=r.checkedValue[r.loadCount++],s=r.config.value,a=r.config.leaf;if(Array.isArray(i)&&i.filter((function(e){return e[s]===o})).length>0){var c=r.store.getNodeByValue(o);c.data[a]||r.lazyLoad(c,(function(){r.handleExpand(c)})),r.loadCount===r.checkedValue.length&&r.$parent.computePresentText()}}t&&t(i)};i.lazyLoad(e,n)},calculateMultiCheckedValue:function(){this.checkedValue=this.getCheckedNodes(this.leafOnly).map((function(e){return e.getValueByOption()}))},scrollIntoView:function(){if(!this.$isServer){var e=this.$refs.menu||[];e.forEach((function(e){var t=e.$el;if(t){var r=t.querySelector(".el-scrollbar__wrap"),i=t.querySelector(".el-cascader-node.is-active")||t.querySelector(".el-cascader-node.in-active-path");W()(r,i)}}))}},getNodeByValue:function(e){return this.store.getNodeByValue(e)},getFlattedNodes:function(e){var t=!this.config.lazy;return this.store.getFlattedNodes(e,t)},getCheckedNodes:function(e){var t=this.checkedValue,r=this.multiple;if(r){var i=this.getFlattedNodes(e);return i.filter((function(e){return e.checked}))}return this.isEmptyValue(t)?[]:[this.getNodeByValue(t)]},clearCheckedNodes:function(){var e=this.config,t=this.leafOnly,r=e.multiple,i=e.emitPath;r?(this.getCheckedNodes(t).filter((function(e){return!e.isDisabled})).forEach((function(e){return e.doCheck(!1)})),this.calculateMultiCheckedValue()):this.checkedValue=i?[]:null}}},te=ee,re=Object(E["a"])(te,i,n,!1,null,null,null);re.options.__file="packages/cascader-panel/src/cascader-panel.vue";var ie=re.exports;ie.install=function(e){e.component(ie.name,ie)};t["default"]=ie},6:function(e,t){e.exports=r("6b7c")},9:function(e,t){e.exports=r("7f4d")}})},4840:function(e,t,r){var i=r("825a"),n=r("5087"),o=r("b622"),s=o("species");e.exports=function(e,t){var r,o=i(e).constructor;return void 0===o||void 0==(r=i(o)[s])?t:n(r)}},"485a":function(e,t,r){var i=r("da84"),n=r("c65b"),o=r("1626"),s=r("861d"),a=i.TypeError;e.exports=function(e,t){var r,i;if("string"===t&&o(r=e.toString)&&!s(i=n(r,e)))return i;if(o(r=e.valueOf)&&!s(i=n(r,e)))return i;if("string"!==t&&o(r=e.toString)&&!s(i=n(r,e)))return i;throw a("Can't convert object to primitive value")}},4897:function(e,t,r){"use strict";t.__esModule=!0,t.i18n=t.use=t.t=void 0;var i=r("f0d9"),n=d(i),o=r("2b0e"),s=d(o),a=r("9afc"),c=d(a),l=r("9d7e"),u=d(l);function d(e){return e&&e.__esModule?e:{default:e}}var h=(0,u.default)(s.default),p=n.default,f=!1,g=function(){var e=Object.getPrototypeOf(this||s.default).$t;if("function"===typeof e&&s.default.locale)return f||(f=!0,s.default.locale(s.default.config.lang,(0,c.default)(p,s.default.locale(s.default.config.lang)||{},{clone:!0}))),e.apply(this,arguments)},m=t.t=function(e,t){var r=g.apply(this,arguments);if(null!==r&&void 0!==r)return r;for(var i=e.split("."),n=p,o=0,s=i.length;o<s;o++){var a=i[o];if(r=n[a],o===s-1)return h(r,t);if(!r)return"";n=r}return""},_=t.use=function(e){p=e||p},v=t.i18n=function(e){g=e||g};t.default={use:_,t:m,i18n:v}},4930:function(e,t,r){var i=r("2d00"),n=r("d039");e.exports=!!Object.getOwnPropertySymbols&&!n((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&i&&i<41}))},"498a":function(e,t,r){"use strict";var i=r("23e7"),n=r("58a8").trim,o=r("c8d2");i({target:"String",proto:!0,forced:o("trim")},{trim:function(){return n(this)}})},"4a7b":function(e,t,r){"use strict";var i=r("c532");e.exports=function(e,t){t=t||{};var r={};function n(e,t){return i.isPlainObject(e)&&i.isPlainObject(t)?i.merge(e,t):i.isPlainObject(t)?i.merge({},t):i.isArray(t)?t.slice():t}function o(r){return i.isUndefined(t[r])?i.isUndefined(e[r])?void 0:n(void 0,e[r]):n(e[r],t[r])}function s(e){if(!i.isUndefined(t[e]))return n(void 0,t[e])}function a(r){return i.isUndefined(t[r])?i.isUndefined(e[r])?void 0:n(void 0,e[r]):n(void 0,t[r])}function c(r){return r in t?n(e[r],t[r]):r in e?n(void 0,e[r]):void 0}var l={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:c};return i.forEach(Object.keys(e).concat(Object.keys(t)),(function(e){var t=l[e]||o,n=t(e);i.isUndefined(n)&&t!==c||(r[e]=n)})),r}},"4a9b":function(e,t,r){var i=r("74e8");i("Float64",(function(e){return function(t,r,i){return e(this,t,r,i)}}))},"4ae1":function(e,t,r){var i=r("23e7"),n=r("d066"),o=r("2ba4"),s=r("0538"),a=r("5087"),c=r("825a"),l=r("861d"),u=r("7c73"),d=r("d039"),h=n("Reflect","construct"),p=Object.prototype,f=[].push,g=d((function(){function e(){}return!(h((function(){}),[],e)instanceof e)})),m=!d((function(){h((function(){}))})),_=g||m;i({target:"Reflect",stat:!0,forced:_,sham:_},{construct:function(e,t){a(e),c(t);var r=arguments.length<3?e:a(arguments[2]);if(m&&!g)return h(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var i=[null];return o(f,i,t),new(o(s,e,i))}var n=r.prototype,d=u(l(n)?n:p),_=o(e,d,t);return l(_)?_:d}})},"4b26":function(e,t,r){"use strict";t.__esModule=!0;var i=r("2b0e"),n=s(i),o=r("5924");function s(e){return e&&e.__esModule?e:{default:e}}var a=!1,c=!1,l=void 0,u=function(){if(!n.default.prototype.$isServer){var e=h.modalDom;return e?a=!0:(a=!1,e=document.createElement("div"),h.modalDom=e,e.addEventListener("touchmove",(function(e){e.preventDefault(),e.stopPropagation()})),e.addEventListener("click",(function(){h.doOnModalClick&&h.doOnModalClick()}))),e}},d={},h={modalFade:!0,getInstance:function(e){return d[e]},register:function(e,t){e&&t&&(d[e]=t)},deregister:function(e){e&&(d[e]=null,delete d[e])},nextZIndex:function(){return h.zIndex++},modalStack:[],doOnModalClick:function(){var e=h.modalStack[h.modalStack.length-1];if(e){var t=h.getInstance(e.id);t&&t.closeOnClickModal&&t.close()}},openModal:function(e,t,r,i,s){if(!n.default.prototype.$isServer&&e&&void 0!==t){this.modalFade=s;for(var c=this.modalStack,l=0,d=c.length;l<d;l++){var h=c[l];if(h.id===e)return}var p=u();if((0,o.addClass)(p,"v-modal"),this.modalFade&&!a&&(0,o.addClass)(p,"v-modal-enter"),i){var f=i.trim().split(/\s+/);f.forEach((function(e){return(0,o.addClass)(p,e)}))}setTimeout((function(){(0,o.removeClass)(p,"v-modal-enter")}),200),r&&r.parentNode&&11!==r.parentNode.nodeType?r.parentNode.appendChild(p):document.body.appendChild(p),t&&(p.style.zIndex=t),p.tabIndex=0,p.style.display="",this.modalStack.push({id:e,zIndex:t,modalClass:i})}},closeModal:function(e){var t=this.modalStack,r=u();if(t.length>0){var i=t[t.length-1];if(i.id===e){if(i.modalClass){var n=i.modalClass.trim().split(/\s+/);n.forEach((function(e){return(0,o.removeClass)(r,e)}))}t.pop(),t.length>0&&(r.style.zIndex=t[t.length-1].zIndex)}else for(var s=t.length-1;s>=0;s--)if(t[s].id===e){t.splice(s,1);break}}0===t.length&&(this.modalFade&&(0,o.addClass)(r,"v-modal-leave"),setTimeout((function(){0===t.length&&(r.parentNode&&r.parentNode.removeChild(r),r.style.display="none",h.modalDom=void 0),(0,o.removeClass)(r,"v-modal-leave")}),200))}};Object.defineProperty(h,"zIndex",{configurable:!0,get:function(){return c||(l=l||(n.default.prototype.$ELEMENT||{}).zIndex||2e3,c=!0),l},set:function(e){l=e}});var p=function(){if(!n.default.prototype.$isServer&&h.modalStack.length>0){var e=h.modalStack[h.modalStack.length-1];if(!e)return;var t=h.getInstance(e.id);return t}};n.default.prototype.$isServer||window.addEventListener("keydown",(function(e){if(27===e.keyCode){var t=p();t&&t.closeOnPressEscape&&(t.handleClose?t.handleClose():t.handleAction?t.handleAction("cancel"):t.close())}})),t.default=h},"4b8b":function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},"4d20":function(e,t,r){var i=r("1917"),n=r("10db"),o=r("6ca1"),s=r("3397"),a=r("9c0e"),c=r("faf5"),l=Object.getOwnPropertyDescriptor;t.f=r("0bad")?l:function(e,t){if(e=o(e),t=s(t,!0),c)try{return l(e,t)}catch(r){}if(a(e,t))return n(!i.f.call(e,t),e[t])}},"4d63":function(e,t,r){var i=r("83ab"),n=r("da84"),o=r("e330"),s=r("94ca"),a=r("7156"),c=r("9112"),l=r("9bf2").f,u=r("241c").f,d=r("3a9b"),h=r("44e7"),p=r("577e"),f=r("ad6d"),g=r("9f7f"),m=r("6eeb"),_=r("d039"),v=r("1a2d"),E=r("69f3").enforce,A=r("2626"),y=r("b622"),S=r("fce3"),C=r("107c"),T=y("match"),b=n.RegExp,I=b.prototype,R=n.SyntaxError,w=o(f),k=o(I.exec),O=o("".charAt),N=o("".replace),L=o("".indexOf),P=o("".slice),D=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,M=/a/g,x=/a/g,B=new b(M)!==M,U=g.MISSED_STICKY,F=g.UNSUPPORTED_Y,V=i&&(!B||U||S||C||_((function(){return x[T]=!1,b(M)!=M||b(x)==x||"/a/i"!=b(M,"i")}))),j=function(e){for(var t,r=e.length,i=0,n="",o=!1;i<=r;i++)t=O(e,i),"\\"!==t?o||"."!==t?("["===t?o=!0:"]"===t&&(o=!1),n+=t):n+="[\\s\\S]":n+=t+O(e,++i);return n},G=function(e){for(var t,r=e.length,i=0,n="",o=[],s={},a=!1,c=!1,l=0,u="";i<=r;i++){if(t=O(e,i),"\\"===t)t+=O(e,++i);else if("]"===t)a=!1;else if(!a)switch(!0){case"["===t:a=!0;break;case"("===t:k(D,P(e,i+1))&&(i+=2,c=!0),n+=t,l++;continue;case">"===t&&c:if(""===u||v(s,u))throw new R("Invalid capture group name");s[u]=!0,o[o.length]=[u,l],c=!1,u="";continue}c?u+=t:n+=t}return[n,o]};if(s("RegExp",V)){for(var H=function(e,t){var r,i,n,o,s,l,u=d(I,this),f=h(e),g=void 0===t,m=[],_=e;if(!u&&f&&g&&e.constructor===H)return e;if((f||d(I,e))&&(e=e.source,g&&(t="flags"in _?_.flags:w(_))),e=void 0===e?"":p(e),t=void 0===t?"":p(t),_=e,S&&"dotAll"in M&&(i=!!t&&L(t,"s")>-1,i&&(t=N(t,/s/g,""))),r=t,U&&"sticky"in M&&(n=!!t&&L(t,"y")>-1,n&&F&&(t=N(t,/y/g,""))),C&&(o=G(e),e=o[0],m=o[1]),s=a(b(e,t),u?this:I,H),(i||n||m.length)&&(l=E(s),i&&(l.dotAll=!0,l.raw=H(j(e),r)),n&&(l.sticky=!0),m.length&&(l.groups=m)),e!==_)try{c(s,"source",""===_?"(?:)":_)}catch(v){}return s},Q=function(e){e in H||l(H,e,{configurable:!0,get:function(){return b[e]},set:function(t){b[e]=t}})},W=u(b),q=0;W.length>q;)Q(W[q++]);I.constructor=H,H.prototype=I,m(n,"RegExp",H)}A("RegExp")},"4d64":function(e,t,r){var i=r("fc6a"),n=r("23cb"),o=r("07fa"),s=function(e){return function(t,r,s){var a,c=i(t),l=o(c),u=n(s,l);if(e&&r!=r){while(l>u)if(a=c[u++],a!=a)return!0}else for(;l>u;u++)if((e||u in c)&&c[u]===r)return e||u||0;return!e&&-1}};e.exports={includes:s(!0),indexOf:s(!1)}},"4d88":function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},"4dae":function(e,t,r){var i=r("da84"),n=r("23cb"),o=r("07fa"),s=r("8418"),a=i.Array,c=Math.max;e.exports=function(e,t,r){for(var i=o(e),l=n(t,i),u=n(void 0===r?i:r,i),d=a(c(u-l,0)),h=0;l<u;l++,h++)s(d,h,e[l]);return d.length=h,d}},"4de4":function(e,t,r){"use strict";var i=r("23e7"),n=r("b727").filter,o=r("1dde"),s=o("filter");i({target:"Array",proto:!0,forced:!s},{filter:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})},"4df4":function(e,t,r){"use strict";var i=r("da84"),n=r("0366"),o=r("c65b"),s=r("7b0b"),a=r("9bdd"),c=r("e95a"),l=r("68ee"),u=r("07fa"),d=r("8418"),h=r("9a1f"),p=r("35a1"),f=i.Array;e.exports=function(e){var t=s(e),r=l(this),i=arguments.length,g=i>1?arguments[1]:void 0,m=void 0!==g;m&&(g=n(g,i>2?arguments[2]:void 0));var _,v,E,A,y,S,C=p(t),T=0;if(!C||this==f&&c(C))for(_=u(t),v=r?new this(_):f(_);_>T;T++)S=m?g(t[T],T):t[T],d(v,T,S);else for(A=h(t,C),y=A.next,v=r?new this:[];!(E=o(y,A)).done;T++)S=m?a(A,g,[E.value,T],!0):E.value,d(v,T,S);return v.length=T,v}},"4e4b":function(e,t,r){e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=61)}({0:function(e,t,r){"use strict";function i(e,t,r,i,n,o,s,a){var c,l="function"===typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=r,l._compiled=!0),i&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),s?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},l._ssrRegister=c):n&&(c=a?function(){n.call(this,this.$root.$options.shadowRoot)}:n),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(e,t){return c.call(t),u(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,c):[c]}return{exports:e,options:l}}r.d(t,"a",(function(){return i}))},10:function(e,t){e.exports=r("f3ad")},12:function(e,t){e.exports=r("417f")},15:function(e,t){e.exports=r("14e9")},16:function(e,t){e.exports=r("4010")},18:function(e,t){e.exports=r("0e15")},21:function(e,t){e.exports=r("d397")},22:function(e,t){e.exports=r("12f2")},3:function(e,t){e.exports=r("8122")},31:function(e,t){e.exports=r("2a5e")},33:function(e,t,r){"use strict";var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"el-select-dropdown__item",class:{selected:e.itemSelected,"is-disabled":e.disabled||e.groupDisabled||e.limitReached,hover:e.hover},on:{mouseenter:e.hoverItem,click:function(t){return t.stopPropagation(),e.selectOptionClick(t)}}},[e._t("default",[r("span",[e._v(e._s(e.currentLabel))])])],2)},n=[];i._withStripped=!0;var o=r(4),s=r.n(o),a=r(3),c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l={mixins:[s.a],name:"ElOption",componentName:"ElOption",inject:["select"],props:{value:{required:!0},label:[String,Number],created:Boolean,disabled:{type:Boolean,default:!1}},data:function(){return{index:-1,groupDisabled:!1,visible:!0,hitState:!1,hover:!1}},computed:{isObject:function(){return"[object object]"===Object.prototype.toString.call(this.value).toLowerCase()},currentLabel:function(){return this.label||(this.isObject?"":this.value)},currentValue:function(){return this.value||this.label||""},itemSelected:function(){return this.select.multiple?this.contains(this.select.value,this.value):this.isEqual(this.value,this.select.value)},limitReached:function(){return!!this.select.multiple&&(!this.itemSelected&&(this.select.value||[]).length>=this.select.multipleLimit&&this.select.multipleLimit>0)}},watch:{currentLabel:function(){this.created||this.select.remote||this.dispatch("ElSelect","setSelected")},value:function(e,t){var r=this.select,i=r.remote,n=r.valueKey;if(!this.created&&!i){if(n&&"object"===("undefined"===typeof e?"undefined":c(e))&&"object"===("undefined"===typeof t?"undefined":c(t))&&e[n]===t[n])return;this.dispatch("ElSelect","setSelected")}}},methods:{isEqual:function(e,t){if(this.isObject){var r=this.select.valueKey;return Object(a["getValueByPath"])(e,r)===Object(a["getValueByPath"])(t,r)}return e===t},contains:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];if(this.isObject){var r=this.select.valueKey;return e&&e.some((function(e){return Object(a["getValueByPath"])(e,r)===Object(a["getValueByPath"])(t,r)}))}return e&&e.indexOf(t)>-1},handleGroupDisabled:function(e){this.groupDisabled=e},hoverItem:function(){this.disabled||this.groupDisabled||(this.select.hoverIndex=this.select.options.indexOf(this))},selectOptionClick:function(){!0!==this.disabled&&!0!==this.groupDisabled&&this.dispatch("ElSelect","handleOptionClick",[this,!0])},queryChange:function(e){this.visible=new RegExp(Object(a["escapeRegexpString"])(e),"i").test(this.currentLabel)||this.created,this.visible||this.select.filteredOptionsCount--}},created:function(){this.select.options.push(this),this.select.cachedOptions.push(this),this.select.optionsCount++,this.select.filteredOptionsCount++,this.$on("queryChange",this.queryChange),this.$on("handleGroupDisabled",this.handleGroupDisabled)},beforeDestroy:function(){var e=this.select,t=e.selected,r=e.multiple,i=r?t:[t],n=this.select.cachedOptions.indexOf(this),o=i.indexOf(this);n>-1&&o<0&&this.select.cachedOptions.splice(n,1),this.select.onOptionDestroy(this.select.options.indexOf(this))}},u=l,d=r(0),h=Object(d["a"])(u,i,n,!1,null,null,null);h.options.__file="packages/select/src/option.vue";t["a"]=h.exports},37:function(e,t){e.exports=r("8bbc")},4:function(e,t){e.exports=r("d010")},5:function(e,t){e.exports=r("e974")},6:function(e,t){e.exports=r("6b7c")},61:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.handleClose,expression:"handleClose"}],staticClass:"el-select",class:[e.selectSize?"el-select--"+e.selectSize:""],on:{click:function(t){return t.stopPropagation(),e.toggleMenu(t)}}},[e.multiple?r("div",{ref:"tags",staticClass:"el-select__tags",style:{"max-width":e.inputWidth-32+"px",width:"100%"}},[e.collapseTags&&e.selected.length?r("span",[r("el-tag",{attrs:{closable:!e.selectDisabled,size:e.collapseTagSize,hit:e.selected[0].hitState,type:"info","disable-transitions":""},on:{close:function(t){e.deleteTag(t,e.selected[0])}}},[r("span",{staticClass:"el-select__tags-text"},[e._v(e._s(e.selected[0].currentLabel))])]),e.selected.length>1?r("el-tag",{attrs:{closable:!1,size:e.collapseTagSize,type:"info","disable-transitions":""}},[r("span",{staticClass:"el-select__tags-text"},[e._v("+ "+e._s(e.selected.length-1))])]):e._e()],1):e._e(),e.collapseTags?e._e():r("transition-group",{on:{"after-leave":e.resetInputHeight}},e._l(e.selected,(function(t){return r("el-tag",{key:e.getValueKey(t),attrs:{closable:!e.selectDisabled,size:e.collapseTagSize,hit:t.hitState,type:"info","disable-transitions":""},on:{close:function(r){e.deleteTag(r,t)}}},[r("span",{staticClass:"el-select__tags-text"},[e._v(e._s(t.currentLabel))])])})),1),e.filterable?r("input",{directives:[{name:"model",rawName:"v-model",value:e.query,expression:"query"}],ref:"input",staticClass:"el-select__input",class:[e.selectSize?"is-"+e.selectSize:""],style:{"flex-grow":"1",width:e.inputLength/(e.inputWidth-32)+"%","max-width":e.inputWidth-42+"px"},attrs:{type:"text",disabled:e.selectDisabled,autocomplete:e.autoComplete||e.autocomplete},domProps:{value:e.query},on:{focus:e.handleFocus,blur:function(t){e.softFocus=!1},keyup:e.managePlaceholder,keydown:[e.resetInputState,function(t){if(!("button"in t)&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"]))return null;t.preventDefault(),e.navigateOptions("next")},function(t){if(!("button"in t)&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"]))return null;t.preventDefault(),e.navigateOptions("prev")},function(t){return!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.selectOption(t))},function(t){if(!("button"in t)&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"]))return null;t.stopPropagation(),t.preventDefault(),e.visible=!1},function(t){return!("button"in t)&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete","Del"])?null:e.deletePrevTag(t)},function(t){if(!("button"in t)&&e._k(t.keyCode,"tab",9,t.key,"Tab"))return null;e.visible=!1}],compositionstart:e.handleComposition,compositionupdate:e.handleComposition,compositionend:e.handleComposition,input:[function(t){t.target.composing||(e.query=t.target.value)},e.debouncedQueryChange]}}):e._e()],1):e._e(),r("el-input",{ref:"reference",class:{"is-focus":e.visible},attrs:{type:"text",placeholder:e.currentPlaceholder,name:e.name,id:e.id,autocomplete:e.autoComplete||e.autocomplete,size:e.selectSize,disabled:e.selectDisabled,readonly:e.readonly,"validate-event":!1,tabindex:e.multiple&&e.filterable?"-1":null},on:{focus:e.handleFocus,blur:e.handleBlur,input:e.debouncedOnInputChange},nativeOn:{keydown:[function(t){if(!("button"in t)&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"]))return null;t.stopPropagation(),t.preventDefault(),e.navigateOptions("next")},function(t){if(!("button"in t)&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"]))return null;t.stopPropagation(),t.preventDefault(),e.navigateOptions("prev")},function(t){return!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.selectOption(t))},function(t){if(!("button"in t)&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"]))return null;t.stopPropagation(),t.preventDefault(),e.visible=!1},function(t){if(!("button"in t)&&e._k(t.keyCode,"tab",9,t.key,"Tab"))return null;e.visible=!1}],mouseenter:function(t){e.inputHovering=!0},mouseleave:function(t){e.inputHovering=!1}},model:{value:e.selectedLabel,callback:function(t){e.selectedLabel=t},expression:"selectedLabel"}},[e.$slots.prefix?r("template",{slot:"prefix"},[e._t("prefix")],2):e._e(),r("template",{slot:"suffix"},[r("i",{directives:[{name:"show",rawName:"v-show",value:!e.showClose,expression:"!showClose"}],class:["el-select__caret","el-input__icon","el-icon-"+e.iconClass]}),e.showClose?r("i",{staticClass:"el-select__caret el-input__icon el-icon-circle-close",on:{click:e.handleClearClick}}):e._e()])],2),r("transition",{attrs:{name:"el-zoom-in-top"},on:{"before-enter":e.handleMenuEnter,"after-leave":e.doDestroy}},[r("el-select-menu",{directives:[{name:"show",rawName:"v-show",value:e.visible&&!1!==e.emptyText,expression:"visible && emptyText !== false"}],ref:"popper",attrs:{"append-to-body":e.popperAppendToBody}},[r("el-scrollbar",{directives:[{name:"show",rawName:"v-show",value:e.options.length>0&&!e.loading,expression:"options.length > 0 && !loading"}],ref:"scrollbar",class:{"is-empty":!e.allowCreate&&e.query&&0===e.filteredOptionsCount},attrs:{tag:"ul","wrap-class":"el-select-dropdown__wrap","view-class":"el-select-dropdown__list"}},[e.showNewOption?r("el-option",{attrs:{value:e.query,created:""}}):e._e(),e._t("default")],2),e.emptyText&&(!e.allowCreate||e.loading||e.allowCreate&&0===e.options.length)?[e.$slots.empty?e._t("empty"):r("p",{staticClass:"el-select-dropdown__empty"},[e._v("\n          "+e._s(e.emptyText)+"\n        ")])]:e._e()],2)],1)],1)},n=[];i._withStripped=!0;var o=r(4),s=r.n(o),a=r(22),c=r.n(a),l=r(6),u=r.n(l),d=r(10),h=r.n(d),p=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-select-dropdown el-popper",class:[{"is-multiple":e.$parent.multiple},e.popperClass],style:{minWidth:e.minWidth}},[e._t("default")],2)},f=[];p._withStripped=!0;var g=r(5),m=r.n(g),_={name:"ElSelectDropdown",componentName:"ElSelectDropdown",mixins:[m.a],props:{placement:{default:"bottom-start"},boundariesPadding:{default:0},popperOptions:{default:function(){return{gpuAcceleration:!1}}},visibleArrow:{default:!0},appendToBody:{type:Boolean,default:!0}},data:function(){return{minWidth:""}},computed:{popperClass:function(){return this.$parent.popperClass}},watch:{"$parent.inputWidth":function(){this.minWidth=this.$parent.$el.getBoundingClientRect().width+"px"}},mounted:function(){var e=this;this.referenceElm=this.$parent.$refs.reference.$el,this.$parent.popperElm=this.popperElm=this.$el,this.$on("updatePopper",(function(){e.$parent.visible&&e.updatePopper()})),this.$on("destroyPopper",this.destroyPopper)}},v=_,E=r(0),A=Object(E["a"])(v,p,f,!1,null,null,null);A.options.__file="packages/select/src/select-dropdown.vue";var y=A.exports,S=r(33),C=r(37),T=r.n(C),b=r(15),I=r.n(b),R=r(18),w=r.n(R),k=r(12),O=r.n(k),N=r(16),L=r(31),P=r.n(L),D=r(3),M={data:function(){return{hoverOption:-1}},computed:{optionsAllDisabled:function(){return this.options.filter((function(e){return e.visible})).every((function(e){return e.disabled}))}},watch:{hoverIndex:function(e){var t=this;"number"===typeof e&&e>-1&&(this.hoverOption=this.options[e]||{}),this.options.forEach((function(e){e.hover=t.hoverOption===e}))}},methods:{navigateOptions:function(e){var t=this;if(this.visible){if(0!==this.options.length&&0!==this.filteredOptionsCount&&!this.optionsAllDisabled){"next"===e?(this.hoverIndex++,this.hoverIndex===this.options.length&&(this.hoverIndex=0)):"prev"===e&&(this.hoverIndex--,this.hoverIndex<0&&(this.hoverIndex=this.options.length-1));var r=this.options[this.hoverIndex];!0!==r.disabled&&!0!==r.groupDisabled&&r.visible||this.navigateOptions(e),this.$nextTick((function(){return t.scrollToOption(t.hoverOption)}))}}else this.visible=!0}}},x=r(21),B={mixins:[s.a,u.a,c()("reference"),M],name:"ElSelect",componentName:"ElSelect",inject:{elForm:{default:""},elFormItem:{default:""}},provide:function(){return{select:this}},computed:{_elFormItemSize:function(){return(this.elFormItem||{}).elFormItemSize},readonly:function(){return!this.filterable||this.multiple||!Object(D["isIE"])()&&!Object(D["isEdge"])()&&!this.visible},showClose:function(){var e=this.multiple?Array.isArray(this.value)&&this.value.length>0:void 0!==this.value&&null!==this.value&&""!==this.value,t=this.clearable&&!this.selectDisabled&&this.inputHovering&&e;return t},iconClass:function(){return this.remote&&this.filterable?"":this.visible?"arrow-up is-reverse":"arrow-up"},debounce:function(){return this.remote?300:0},emptyText:function(){return this.loading?this.loadingText||this.t("el.select.loading"):(!this.remote||""!==this.query||0!==this.options.length)&&(this.filterable&&this.query&&this.options.length>0&&0===this.filteredOptionsCount?this.noMatchText||this.t("el.select.noMatch"):0===this.options.length?this.noDataText||this.t("el.select.noData"):null)},showNewOption:function(){var e=this,t=this.options.filter((function(e){return!e.created})).some((function(t){return t.currentLabel===e.query}));return this.filterable&&this.allowCreate&&""!==this.query&&!t},selectSize:function(){return this.size||this._elFormItemSize||(this.$ELEMENT||{}).size},selectDisabled:function(){return this.disabled||(this.elForm||{}).disabled},collapseTagSize:function(){return["small","mini"].indexOf(this.selectSize)>-1?"mini":"small"},propPlaceholder:function(){return"undefined"!==typeof this.placeholder?this.placeholder:this.t("el.select.placeholder")}},components:{ElInput:h.a,ElSelectMenu:y,ElOption:S["a"],ElTag:T.a,ElScrollbar:I.a},directives:{Clickoutside:O.a},props:{name:String,id:String,value:{required:!0},autocomplete:{type:String,default:"off"},autoComplete:{type:String,validator:function(e){return!0}},automaticDropdown:Boolean,size:String,disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:String,remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String,required:!1},defaultFirstOption:Boolean,reserveKeyword:Boolean,valueKey:{type:String,default:"value"},collapseTags:Boolean,popperAppendToBody:{type:Boolean,default:!0}},data:function(){return{options:[],cachedOptions:[],createdLabel:null,createdSelected:!1,selected:this.multiple?[]:{},inputLength:20,inputWidth:0,initialInputHeight:0,cachedPlaceHolder:"",optionsCount:0,filteredOptionsCount:0,visible:!1,softFocus:!1,selectedLabel:"",hoverIndex:-1,query:"",previousQuery:null,inputHovering:!1,currentPlaceholder:"",menuVisibleOnFocus:!1,isOnComposition:!1,isSilentBlur:!1}},watch:{selectDisabled:function(){var e=this;this.$nextTick((function(){e.resetInputHeight()}))},propPlaceholder:function(e){this.cachedPlaceHolder=this.currentPlaceholder=e},value:function(e,t){this.multiple&&(this.resetInputHeight(),e&&e.length>0||this.$refs.input&&""!==this.query?this.currentPlaceholder="":this.currentPlaceholder=this.cachedPlaceHolder,this.filterable&&!this.reserveKeyword&&(this.query="",this.handleQueryChange(this.query))),this.setSelected(),this.filterable&&!this.multiple&&(this.inputLength=20),Object(D["valueEquals"])(e,t)||this.dispatch("ElFormItem","el.form.change",e)},visible:function(e){var t=this;e?(this.broadcast("ElSelectDropdown","updatePopper"),this.filterable&&(this.query=this.remote?"":this.selectedLabel,this.handleQueryChange(this.query),this.multiple?this.$refs.input.focus():(this.remote||(this.broadcast("ElOption","queryChange",""),this.broadcast("ElOptionGroup","queryChange")),this.selectedLabel&&(this.currentPlaceholder=this.selectedLabel,this.selectedLabel="")))):(this.broadcast("ElSelectDropdown","destroyPopper"),this.$refs.input&&this.$refs.input.blur(),this.query="",this.previousQuery=null,this.selectedLabel="",this.inputLength=20,this.menuVisibleOnFocus=!1,this.resetHoverIndex(),this.$nextTick((function(){t.$refs.input&&""===t.$refs.input.value&&0===t.selected.length&&(t.currentPlaceholder=t.cachedPlaceHolder)})),this.multiple||(this.selected&&(this.filterable&&this.allowCreate&&this.createdSelected&&this.createdLabel?this.selectedLabel=this.createdLabel:this.selectedLabel=this.selected.currentLabel,this.filterable&&(this.query=this.selectedLabel)),this.filterable&&(this.currentPlaceholder=this.cachedPlaceHolder))),this.$emit("visible-change",e)},options:function(){var e=this;if(!this.$isServer){this.$nextTick((function(){e.broadcast("ElSelectDropdown","updatePopper")})),this.multiple&&this.resetInputHeight();var t=this.$el.querySelectorAll("input");-1===[].indexOf.call(t,document.activeElement)&&this.setSelected(),this.defaultFirstOption&&(this.filterable||this.remote)&&this.filteredOptionsCount&&this.checkDefaultFirstOption()}}},methods:{handleComposition:function(e){var t=this,r=e.target.value;if("compositionend"===e.type)this.isOnComposition=!1,this.$nextTick((function(e){return t.handleQueryChange(r)}));else{var i=r[r.length-1]||"";this.isOnComposition=!Object(x["isKorean"])(i)}},handleQueryChange:function(e){var t=this;this.previousQuery===e||this.isOnComposition||(null!==this.previousQuery||"function"!==typeof this.filterMethod&&"function"!==typeof this.remoteMethod?(this.previousQuery=e,this.$nextTick((function(){t.visible&&t.broadcast("ElSelectDropdown","updatePopper")})),this.hoverIndex=-1,this.multiple&&this.filterable&&this.$nextTick((function(){var e=15*t.$refs.input.value.length+20;t.inputLength=t.collapseTags?Math.min(50,e):e,t.managePlaceholder(),t.resetInputHeight()})),this.remote&&"function"===typeof this.remoteMethod?(this.hoverIndex=-1,this.remoteMethod(e)):"function"===typeof this.filterMethod?(this.filterMethod(e),this.broadcast("ElOptionGroup","queryChange")):(this.filteredOptionsCount=this.optionsCount,this.broadcast("ElOption","queryChange",e),this.broadcast("ElOptionGroup","queryChange")),this.defaultFirstOption&&(this.filterable||this.remote)&&this.filteredOptionsCount&&this.checkDefaultFirstOption()):this.previousQuery=e)},scrollToOption:function(e){var t=Array.isArray(e)&&e[0]?e[0].$el:e.$el;if(this.$refs.popper&&t){var r=this.$refs.popper.$el.querySelector(".el-select-dropdown__wrap");P()(r,t)}this.$refs.scrollbar&&this.$refs.scrollbar.handleScroll()},handleMenuEnter:function(){var e=this;this.$nextTick((function(){return e.scrollToOption(e.selected)}))},emitChange:function(e){Object(D["valueEquals"])(this.value,e)||this.$emit("change",e)},getOption:function(e){for(var t=void 0,r="[object object]"===Object.prototype.toString.call(e).toLowerCase(),i="[object null]"===Object.prototype.toString.call(e).toLowerCase(),n="[object undefined]"===Object.prototype.toString.call(e).toLowerCase(),o=this.cachedOptions.length-1;o>=0;o--){var s=this.cachedOptions[o],a=r?Object(D["getValueByPath"])(s.value,this.valueKey)===Object(D["getValueByPath"])(e,this.valueKey):s.value===e;if(a){t=s;break}}if(t)return t;var c=r||i||n?"":String(e),l={value:e,currentLabel:c};return this.multiple&&(l.hitState=!1),l},setSelected:function(){var e=this;if(!this.multiple){var t=this.getOption(this.value);return t.created?(this.createdLabel=t.currentLabel,this.createdSelected=!0):this.createdSelected=!1,this.selectedLabel=t.currentLabel,this.selected=t,void(this.filterable&&(this.query=this.selectedLabel))}var r=[];Array.isArray(this.value)&&this.value.forEach((function(t){r.push(e.getOption(t))})),this.selected=r,this.$nextTick((function(){e.resetInputHeight()}))},handleFocus:function(e){this.softFocus?this.softFocus=!1:((this.automaticDropdown||this.filterable)&&(this.visible=!0,this.filterable&&(this.menuVisibleOnFocus=!0)),this.$emit("focus",e))},blur:function(){this.visible=!1,this.$refs.reference.blur()},handleBlur:function(e){var t=this;setTimeout((function(){t.isSilentBlur?t.isSilentBlur=!1:t.$emit("blur",e)}),50),this.softFocus=!1},handleClearClick:function(e){this.deleteSelected(e)},doDestroy:function(){this.$refs.popper&&this.$refs.popper.doDestroy()},handleClose:function(){this.visible=!1},toggleLastOptionHitState:function(e){if(Array.isArray(this.selected)){var t=this.selected[this.selected.length-1];if(t)return!0===e||!1===e?(t.hitState=e,e):(t.hitState=!t.hitState,t.hitState)}},deletePrevTag:function(e){if(e.target.value.length<=0&&!this.toggleLastOptionHitState()){var t=this.value.slice();t.pop(),this.$emit("input",t),this.emitChange(t)}},managePlaceholder:function(){""!==this.currentPlaceholder&&(this.currentPlaceholder=this.$refs.input.value?"":this.cachedPlaceHolder)},resetInputState:function(e){8!==e.keyCode&&this.toggleLastOptionHitState(!1),this.inputLength=15*this.$refs.input.value.length+20,this.resetInputHeight()},resetInputHeight:function(){var e=this;this.collapseTags&&!this.filterable||this.$nextTick((function(){if(e.$refs.reference){var t=e.$refs.reference.$el.childNodes,r=[].filter.call(t,(function(e){return"INPUT"===e.tagName}))[0],i=e.$refs.tags,n=i?Math.round(i.getBoundingClientRect().height):0,o=e.initialInputHeight||40;r.style.height=0===e.selected.length?o+"px":Math.max(i?n+(n>o?6:0):0,o)+"px",e.visible&&!1!==e.emptyText&&e.broadcast("ElSelectDropdown","updatePopper")}}))},resetHoverIndex:function(){var e=this;setTimeout((function(){e.multiple?e.selected.length>0?e.hoverIndex=Math.min.apply(null,e.selected.map((function(t){return e.options.indexOf(t)}))):e.hoverIndex=-1:e.hoverIndex=e.options.indexOf(e.selected)}),300)},handleOptionSelect:function(e,t){var r=this;if(this.multiple){var i=(this.value||[]).slice(),n=this.getValueIndex(i,e.value);n>-1?i.splice(n,1):(this.multipleLimit<=0||i.length<this.multipleLimit)&&i.push(e.value),this.$emit("input",i),this.emitChange(i),e.created&&(this.query="",this.handleQueryChange(""),this.inputLength=20),this.filterable&&this.$refs.input.focus()}else this.$emit("input",e.value),this.emitChange(e.value),this.visible=!1;this.isSilentBlur=t,this.setSoftFocus(),this.visible||this.$nextTick((function(){r.scrollToOption(e)}))},setSoftFocus:function(){this.softFocus=!0;var e=this.$refs.input||this.$refs.reference;e&&e.focus()},getValueIndex:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],r="[object object]"===Object.prototype.toString.call(t).toLowerCase();if(r){var i=this.valueKey,n=-1;return e.some((function(e,r){return Object(D["getValueByPath"])(e,i)===Object(D["getValueByPath"])(t,i)&&(n=r,!0)})),n}return e.indexOf(t)},toggleMenu:function(){this.selectDisabled||(this.menuVisibleOnFocus?this.menuVisibleOnFocus=!1:this.visible=!this.visible,this.visible&&(this.$refs.input||this.$refs.reference).focus())},selectOption:function(){this.visible?this.options[this.hoverIndex]&&this.handleOptionSelect(this.options[this.hoverIndex]):this.toggleMenu()},deleteSelected:function(e){e.stopPropagation();var t=this.multiple?[]:"";this.$emit("input",t),this.emitChange(t),this.visible=!1,this.$emit("clear")},deleteTag:function(e,t){var r=this.selected.indexOf(t);if(r>-1&&!this.selectDisabled){var i=this.value.slice();i.splice(r,1),this.$emit("input",i),this.emitChange(i),this.$emit("remove-tag",t.value)}e.stopPropagation()},onInputChange:function(){this.filterable&&this.query!==this.selectedLabel&&(this.query=this.selectedLabel,this.handleQueryChange(this.query))},onOptionDestroy:function(e){e>-1&&(this.optionsCount--,this.filteredOptionsCount--,this.options.splice(e,1))},resetInputWidth:function(){this.inputWidth=this.$refs.reference.$el.getBoundingClientRect().width},handleResize:function(){this.resetInputWidth(),this.multiple&&this.resetInputHeight()},checkDefaultFirstOption:function(){this.hoverIndex=-1;for(var e=!1,t=this.options.length-1;t>=0;t--)if(this.options[t].created){e=!0,this.hoverIndex=t;break}if(!e)for(var r=0;r!==this.options.length;++r){var i=this.options[r];if(this.query){if(!i.disabled&&!i.groupDisabled&&i.visible){this.hoverIndex=r;break}}else if(i.itemSelected){this.hoverIndex=r;break}}},getValueKey:function(e){return"[object object]"!==Object.prototype.toString.call(e.value).toLowerCase()?e.value:Object(D["getValueByPath"])(e.value,this.valueKey)}},created:function(){var e=this;this.cachedPlaceHolder=this.currentPlaceholder=this.propPlaceholder,this.multiple&&!Array.isArray(this.value)&&this.$emit("input",[]),!this.multiple&&Array.isArray(this.value)&&this.$emit("input",""),this.debouncedOnInputChange=w()(this.debounce,(function(){e.onInputChange()})),this.debouncedQueryChange=w()(this.debounce,(function(t){e.handleQueryChange(t.target.value)})),this.$on("handleOptionClick",this.handleOptionSelect),this.$on("setSelected",this.setSelected)},mounted:function(){var e=this;this.multiple&&Array.isArray(this.value)&&this.value.length>0&&(this.currentPlaceholder=""),Object(N["addResizeListener"])(this.$el,this.handleResize);var t=this.$refs.reference;if(t&&t.$el){var r={medium:36,small:32,mini:28},i=t.$el.querySelector("input");this.initialInputHeight=i.getBoundingClientRect().height||r[this.selectSize]}this.remote&&this.multiple&&this.resetInputHeight(),this.$nextTick((function(){t&&t.$el&&(e.inputWidth=t.$el.getBoundingClientRect().width)})),this.setSelected()},beforeDestroy:function(){this.$el&&this.handleResize&&Object(N["removeResizeListener"])(this.$el,this.handleResize)}},U=B,F=Object(E["a"])(U,i,n,!1,null,null,null);F.options.__file="packages/select/src/select.vue";var V=F.exports;V.install=function(e){e.component(V.name,V)};t["default"]=V}})},"4e71":function(e,t,r){r("e198")("observable")},"4ebc":function(e,t,r){var i=r("4d88");e.exports=Array.isArray||function(e){return"Array"==i(e)}},"4fad":function(e,t,r){var i=r("d039"),n=r("861d"),o=r("c6b6"),s=r("d86b"),a=Object.isExtensible,c=i((function(){a(1)}));e.exports=c||s?function(e){return!!n(e)&&((!s||"ArrayBuffer"!=o(e))&&(!a||a(e)))}:a},5087:function(e,t,r){var i=r("da84"),n=r("68ee"),o=r("0d51"),s=i.TypeError;e.exports=function(e){if(n(e))return e;throw s(o(e)+" is not a constructor")}},"50c4":function(e,t,r){var i=r("5926"),n=Math.min;e.exports=function(e){return e>0?n(i(e),9007199254740991):0}},"511f":function(e,t,r){r("0b99"),r("658f"),e.exports=r("fcd4").f("iterator")},5128:function(e,t,r){"use strict";t.__esModule=!0,t.PopupManager=void 0;var i=r("2b0e"),n=h(i),o=r("7f4d"),s=h(o),a=r("4b26"),c=h(a),l=r("e62d"),u=h(l),d=r("5924");function h(e){return e&&e.__esModule?e:{default:e}}var p=1,f=void 0;t.default={props:{visible:{type:Boolean,default:!1},openDelay:{},closeDelay:{},zIndex:{},modal:{type:Boolean,default:!1},modalFade:{type:Boolean,default:!0},modalClass:{},modalAppendToBody:{type:Boolean,default:!1},lockScroll:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!1},closeOnClickModal:{type:Boolean,default:!1}},beforeMount:function(){this._popupId="popup-"+p++,c.default.register(this._popupId,this)},beforeDestroy:function(){c.default.deregister(this._popupId),c.default.closeModal(this._popupId),this.restoreBodyStyle()},data:function(){return{opened:!1,bodyPaddingRight:null,computedBodyPaddingRight:0,withoutHiddenClass:!0,rendered:!1}},watch:{visible:function(e){var t=this;if(e){if(this._opening)return;this.rendered?this.open():(this.rendered=!0,n.default.nextTick((function(){t.open()})))}else this.close()}},methods:{open:function(e){var t=this;this.rendered||(this.rendered=!0);var r=(0,s.default)({},this.$props||this,e);this._closeTimer&&(clearTimeout(this._closeTimer),this._closeTimer=null),clearTimeout(this._openTimer);var i=Number(r.openDelay);i>0?this._openTimer=setTimeout((function(){t._openTimer=null,t.doOpen(r)}),i):this.doOpen(r)},doOpen:function(e){if(!this.$isServer&&(!this.willOpen||this.willOpen())&&!this.opened){this._opening=!0;var t=this.$el,r=e.modal,i=e.zIndex;if(i&&(c.default.zIndex=i),r&&(this._closing&&(c.default.closeModal(this._popupId),this._closing=!1),c.default.openModal(this._popupId,c.default.nextZIndex(),this.modalAppendToBody?void 0:t,e.modalClass,e.modalFade),e.lockScroll)){this.withoutHiddenClass=!(0,d.hasClass)(document.body,"el-popup-parent--hidden"),this.withoutHiddenClass&&(this.bodyPaddingRight=document.body.style.paddingRight,this.computedBodyPaddingRight=parseInt((0,d.getStyle)(document.body,"paddingRight"),10)),f=(0,u.default)();var n=document.documentElement.clientHeight<document.body.scrollHeight,o=(0,d.getStyle)(document.body,"overflowY");f>0&&(n||"scroll"===o)&&this.withoutHiddenClass&&(document.body.style.paddingRight=this.computedBodyPaddingRight+f+"px"),(0,d.addClass)(document.body,"el-popup-parent--hidden")}"static"===getComputedStyle(t).position&&(t.style.position="absolute"),t.style.zIndex=c.default.nextZIndex(),this.opened=!0,this.onOpen&&this.onOpen(),this.doAfterOpen()}},doAfterOpen:function(){this._opening=!1},close:function(){var e=this;if(!this.willClose||this.willClose()){null!==this._openTimer&&(clearTimeout(this._openTimer),this._openTimer=null),clearTimeout(this._closeTimer);var t=Number(this.closeDelay);t>0?this._closeTimer=setTimeout((function(){e._closeTimer=null,e.doClose()}),t):this.doClose()}},doClose:function(){this._closing=!0,this.onClose&&this.onClose(),this.lockScroll&&setTimeout(this.restoreBodyStyle,200),this.opened=!1,this.doAfterClose()},doAfterClose:function(){c.default.closeModal(this._popupId),this._closing=!1},restoreBodyStyle:function(){this.modal&&this.withoutHiddenClass&&(document.body.style.paddingRight=this.bodyPaddingRight,(0,d.removeClass)(document.body,"el-popup-parent--hidden")),this.withoutHiddenClass=!0}}},t.PopupManager=c.default},"512c":function(e,t,r){var i=r("ef08"),n=r("5524"),o=r("9c0c"),s=r("051b"),a=r("9c0e"),c="prototype",l=function(e,t,r){var u,d,h,p=e&l.F,f=e&l.G,g=e&l.S,m=e&l.P,_=e&l.B,v=e&l.W,E=f?n:n[t]||(n[t]={}),A=E[c],y=f?i:g?i[t]:(i[t]||{})[c];for(u in f&&(r=t),r)d=!p&&y&&void 0!==y[u],d&&a(E,u)||(h=d?y[u]:r[u],E[u]=f&&"function"!=typeof y[u]?r[u]:_&&d?o(h,i):v&&y[u]==h?function(e){var t=function(t,r,i){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,i)}return e.apply(this,arguments)};return t[c]=e[c],t}(h):m&&"function"==typeof h?o(Function.call,h):h,m&&((E.virtual||(E.virtual={}))[u]=h,e&l.R&&A&&!A[u]&&s(A,u,h)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},"512ce":function(e,t,r){var i=r("342f"),n=i.match(/AppleWebKit\/(\d+)\./);e.exports=!!n&&+n[1]},5270:function(e,t,r){"use strict";var i=r("c532"),n=r("c401"),o=r("2e67"),s=r("2444"),a=r("7a77");function c(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new a("canceled")}e.exports=function(e){c(e),e.headers=e.headers||{},e.data=n.call(e,e.data,e.headers,e.transformRequest),e.headers=i.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),i.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]}));var t=e.adapter||s.adapter;return t(e).then((function(t){return c(e),t.data=n.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(c(e),t&&t.response&&(t.response.data=n.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},5319:function(e,t,r){"use strict";var i=r("2ba4"),n=r("c65b"),o=r("e330"),s=r("d784"),a=r("d039"),c=r("825a"),l=r("1626"),u=r("5926"),d=r("50c4"),h=r("577e"),p=r("1d80"),f=r("8aa5"),g=r("dc4a"),m=r("0cb2"),_=r("14c3"),v=r("b622"),E=v("replace"),A=Math.max,y=Math.min,S=o([].concat),C=o([].push),T=o("".indexOf),b=o("".slice),I=function(e){return void 0===e?e:String(e)},R=function(){return"$0"==="a".replace(/./,"$0")}(),w=function(){return!!/./[E]&&""===/./[E]("a","$0")}(),k=!a((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}));s("replace",(function(e,t,r){var o=w?"$":"$0";return[function(e,r){var i=p(this),o=void 0==e?void 0:g(e,E);return o?n(o,e,i,r):n(t,h(i),e,r)},function(e,n){var s=c(this),a=h(e);if("string"==typeof n&&-1===T(n,o)&&-1===T(n,"$<")){var p=r(t,s,a,n);if(p.done)return p.value}var g=l(n);g||(n=h(n));var v=s.global;if(v){var E=s.unicode;s.lastIndex=0}var R=[];while(1){var w=_(s,a);if(null===w)break;if(C(R,w),!v)break;var k=h(w[0]);""===k&&(s.lastIndex=f(a,d(s.lastIndex),E))}for(var O="",N=0,L=0;L<R.length;L++){w=R[L];for(var P=h(w[0]),D=A(y(u(w.index),a.length),0),M=[],x=1;x<w.length;x++)C(M,I(w[x]));var B=w.groups;if(g){var U=S([P],M,D,a);void 0!==B&&C(U,B);var F=h(i(n,void 0,U))}else F=m(P,a,D,M,B,n);D>=N&&(O+=b(a,N,D)+F,N=D+P.length)}return O+b(a,N)}]}),!k||!R||w)},5377:function(e,t,r){var i=r("83ab"),n=r("9bf2"),o=r("ad6d"),s=r("d039"),a=RegExp.prototype,c=i&&s((function(){return"sy"!==Object.getOwnPropertyDescriptor(a,"flags").get.call({dotAll:!0,sticky:!0})}));c&&n.f(a,"flags",{configurable:!0,get:o})},5488:function(e,t,r){"use strict";t.__esModule=!0;var i=r("5924");function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(){n(this,e)}return e.prototype.beforeEnter=function(e){(0,i.addClass)(e,"collapse-transition"),e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.style.height="0",e.style.paddingTop=0,e.style.paddingBottom=0},e.prototype.enter=function(e){e.dataset.oldOverflow=e.style.overflow,0!==e.scrollHeight?(e.style.height=e.scrollHeight+"px",e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom):(e.style.height="",e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom),e.style.overflow="hidden"},e.prototype.afterEnter=function(e){(0,i.removeClass)(e,"collapse-transition"),e.style.height="",e.style.overflow=e.dataset.oldOverflow},e.prototype.beforeLeave=function(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.dataset.oldOverflow=e.style.overflow,e.style.height=e.scrollHeight+"px",e.style.overflow="hidden"},e.prototype.leave=function(e){0!==e.scrollHeight&&((0,i.addClass)(e,"collapse-transition"),e.style.height=0,e.style.paddingTop=0,e.style.paddingBottom=0)},e.prototype.afterLeave=function(e){(0,i.removeClass)(e,"collapse-transition"),e.style.height="",e.style.overflow=e.dataset.oldOverflow,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom},e}();t.default={name:"ElCollapseTransition",functional:!0,render:function(e,t){var r=t.children,i={on:new o};return e("transition",i,r)}}},5524:function(e,t){var r=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=r)},5692:function(e,t,r){var i=r("c430"),n=r("c6cd");(e.exports=function(e,t){return n[e]||(n[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.20.3",mode:i?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"})},"56ef":function(e,t,r){var i=r("d066"),n=r("e330"),o=r("241c"),s=r("7418"),a=r("825a"),c=n([].concat);e.exports=i("Reflect","ownKeys")||function(e){var t=o.f(a(e)),r=s.f;return r?c(t,r(e)):t}},"577e":function(e,t,r){var i=r("da84"),n=r("f5df"),o=i.String;e.exports=function(e){if("Symbol"===n(e))throw TypeError("Cannot convert a Symbol value to a string");return o(e)}},5781:function(e,t,r){(function(t){!function(t,r){e.exports=r()}(0,(function(){function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function r(t){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?e(Object(i),!0).forEach((function(e){l(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t,r,i,n,o,s){try{var a=e[o](s),c=a.value}catch(u){return void r(u)}a.done?t(c):Promise.resolve(c).then(i,n)}function o(e){return function(){var t=this,r=arguments;return new Promise((function(i,o){var s=e.apply(t,r);function a(e){n(s,i,o,a,c,"next",e)}function c(e){n(s,i,o,a,c,"throw",e)}a(void 0)}))}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function c(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function f(e,t,r){return(f=p()?Reflect.construct:function(e,t,r){var i=[null];i.push.apply(i,t);var n=new(Function.bind.apply(e,i));return r&&h(n,r.prototype),n}).apply(null,arguments)}function g(e){var t="function"==typeof Map?new Map:void 0;return(g=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return f(e,arguments,d(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),h(i,e)})(e)}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _(e){var t=p();return function(){var r,i=d(e);if(t){var n=d(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return m(this,r)}}function v(e,t,r){return(v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(r):n.value}})(e,t,r||e)}function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,o=[],s=!0,a=!1;try{for(r=r.call(e);!(s=(i=r.next()).done)&&(o.push(i.value),!t||o.length!==t);s=!0);}catch(l){a=!0,n=l}finally{try{s||null==r.return||r.return()}finally{if(a)throw n}}return o}}(e,t)||y(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||y(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){if(e){if("string"==typeof e)return S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?S(e,t):void 0}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function C(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=y(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function T(e,t,r,i,n){var o={};return Object.keys(i).forEach((function(e){o[e]=i[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce((function(r,i){return i(e,t,r)||r}),o),n&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(n):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var b="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof t?t:"undefined"!=typeof self?self:{};function I(e,t){return e(t={exports:{}},t.exports),t.exports}var R,w,k=function(e){return e&&e.Math==Math&&e},O=k("object"==typeof globalThis&&globalThis)||k("object"==typeof window&&window)||k("object"==typeof self&&self)||k("object"==typeof b&&b)||function(){return this}()||Function("return this")(),N=function(e){try{return!!e()}catch(r){return!0}},L=!N((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),P={}.propertyIsEnumerable,D=Object.getOwnPropertyDescriptor,M={f:D&&!P.call({1:2},1)?function(e){var t=D(this,e);return!!t&&t.enumerable}:P},x=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},B={}.toString,U=function(e){return B.call(e).slice(8,-1)},F="".split,V=N((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==U(e)?F.call(e,""):Object(e)}:Object,j=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},G=function(e){return V(j(e))},H=function(e){return"function"==typeof e},Q=function(e){return"object"==typeof e?null!==e:H(e)},W=function(e){return H(e)?e:void 0},q=function(e,t){return arguments.length<2?W(O[e]):O[e]&&O[e][t]},z=q("navigator","userAgent")||"",Z=O.process,Y=O.Deno,K=Z&&Z.versions||Y&&Y.version,$=K&&K.v8;$?w=(R=$.split("."))[0]<4?1:R[0]+R[1]:z&&(!(R=z.match(/Edge\/(\d+)/))||R[1]>=74)&&(R=z.match(/Chrome\/(\d+)/))&&(w=R[1]);var J=w&&+w,X=!!Object.getOwnPropertySymbols&&!N((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&J&&J<41})),ee=X&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,te=ee?function(e){return"symbol"==typeof e}:function(e){var t=q("Symbol");return H(t)&&Object(e)instanceof t},re=function(e){try{return String(e)}catch(r){return"Object"}},ie=function(e){if(H(e))return e;throw TypeError(re(e)+" is not a function")},ne=function(e,t){var r=e[t];return null==r?void 0:ie(r)},oe=function(e,t){try{Object.defineProperty(O,e,{value:t,configurable:!0,writable:!0})}catch(i){O[e]=t}return t},se=O["__core-js_shared__"]||oe("__core-js_shared__",{}),ae=I((function(e){(e.exports=function(e,t){return se[e]||(se[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.18.2",mode:"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})})),ce=function(e){return Object(j(e))},le={}.hasOwnProperty,ue=Object.hasOwn||function(e,t){return le.call(ce(e),t)},de=0,he=Math.random(),pe=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++de+he).toString(36)},fe=ae("wks"),ge=O.Symbol,me=ee?ge:ge&&ge.withoutSetter||pe,_e=function(e){return ue(fe,e)&&(X||"string"==typeof fe[e])||(X&&ue(ge,e)?fe[e]=ge[e]:fe[e]=me("Symbol."+e)),fe[e]},ve=_e("toPrimitive"),Ee=function(e,t){if(!Q(e)||te(e))return e;var r,i=ne(e,ve);if(i){if(void 0===t&&(t="default"),r=i.call(e,t),!Q(r)||te(r))return r;throw TypeError("Can't convert object to primitive value")}return void 0===t&&(t="number"),function(e,t){var r,i;if("string"===t&&H(r=e.toString)&&!Q(i=r.call(e)))return i;if(H(r=e.valueOf)&&!Q(i=r.call(e)))return i;if("string"!==t&&H(r=e.toString)&&!Q(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}(e,t)},Ae=function(e){var t=Ee(e,"string");return te(t)?t:String(t)},ye=O.document,Se=Q(ye)&&Q(ye.createElement),Ce=function(e){return Se?ye.createElement(e):{}},Te=!L&&!N((function(){return 7!=Object.defineProperty(Ce("div"),"a",{get:function(){return 7}}).a})),be=Object.getOwnPropertyDescriptor,Ie={f:L?be:function(e,t){if(e=G(e),t=Ae(t),Te)try{return be(e,t)}catch(i){}if(ue(e,t))return x(!M.f.call(e,t),e[t])}},Re=function(e){if(Q(e))return e;throw TypeError(String(e)+" is not an object")},we=Object.defineProperty,ke={f:L?we:function(e,t,r){if(Re(e),t=Ae(t),Re(r),Te)try{return we(e,t,r)}catch(n){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},Oe=L?function(e,t,r){return ke.f(e,t,x(1,r))}:function(e,t,r){return e[t]=r,e},Ne=Function.toString;H(se.inspectSource)||(se.inspectSource=function(e){return Ne.call(e)});var Le,Pe,De,Me=se.inspectSource,xe=O.WeakMap,Be=H(xe)&&/native code/.test(Me(xe)),Ue=ae("keys"),Fe=function(e){return Ue[e]||(Ue[e]=pe(e))},Ve={},je=O.WeakMap;if(Be||se.state){var Ge=se.state||(se.state=new je),He=Ge.get,Qe=Ge.has,We=Ge.set;Le=function(e,t){if(Qe.call(Ge,e))throw new TypeError("Object already initialized");return t.facade=e,We.call(Ge,e,t),t},Pe=function(e){return He.call(Ge,e)||{}},De=function(e){return Qe.call(Ge,e)}}else{var qe=Fe("state");Ve[qe]=!0,Le=function(e,t){if(ue(e,qe))throw new TypeError("Object already initialized");return t.facade=e,Oe(e,qe,t),t},Pe=function(e){return ue(e,qe)?e[qe]:{}},De=function(e){return ue(e,qe)}}var ze={set:Le,get:Pe,has:De,enforce:function(e){return De(e)?Pe(e):Le(e,{})},getterFor:function(e){return function(t){var r;if(!Q(t)||(r=Pe(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return r}}},Ze=Function.prototype,Ye=L&&Object.getOwnPropertyDescriptor,Ke=ue(Ze,"name"),$e={EXISTS:Ke,PROPER:Ke&&"something"===function(){}.name,CONFIGURABLE:Ke&&(!L||L&&Ye(Ze,"name").configurable)},Je=I((function(e){var t=$e.CONFIGURABLE,r=ze.get,i=ze.enforce,n=String(String).split("String");(e.exports=function(e,r,o,s){var a,c=!!s&&!!s.unsafe,l=!!s&&!!s.enumerable,u=!!s&&!!s.noTargetGet,d=s&&void 0!==s.name?s.name:r;H(o)&&("Symbol("===String(d).slice(0,7)&&(d="["+String(d).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!ue(o,"name")||t&&o.name!==d)&&Oe(o,"name",d),(a=i(o)).source||(a.source=n.join("string"==typeof d?d:""))),e!==O?(c?!u&&e[r]&&(l=!0):delete e[r],l?e[r]=o:Oe(e,r,o)):l?e[r]=o:oe(r,o)})(Function.prototype,"toString",(function(){return H(this)&&r(this).source||Me(this)}))})),Xe=Math.ceil,et=Math.floor,tt=function(e){var t=+e;return t!=t||0===t?0:(t>0?et:Xe)(t)},rt=Math.max,it=Math.min,nt=function(e,t){var r=tt(e);return r<0?rt(r+t,0):it(r,t)},ot=Math.min,st=function(e){return e>0?ot(tt(e),9007199254740991):0},at=function(e){return st(e.length)},ct=function(e){return function(t,r,i){var n,o=G(t),s=at(o),a=nt(i,s);if(e&&r!=r){for(;s>a;)if((n=o[a++])!=n)return!0}else for(;s>a;a++)if((e||a in o)&&o[a]===r)return e||a||0;return!e&&-1}},lt={includes:ct(!0),indexOf:ct(!1)},ut=lt.indexOf,dt=function(e,t){var r,i=G(e),n=0,o=[];for(r in i)!ue(Ve,r)&&ue(i,r)&&o.push(r);for(;t.length>n;)ue(i,r=t[n++])&&(~ut(o,r)||o.push(r));return o},ht=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],pt=ht.concat("length","prototype"),ft={f:Object.getOwnPropertyNames||function(e){return dt(e,pt)}},gt={f:Object.getOwnPropertySymbols},mt=q("Reflect","ownKeys")||function(e){var t=ft.f(Re(e)),r=gt.f;return r?t.concat(r(e)):t},_t=function(e,t){for(var r=mt(t),i=ke.f,n=Ie.f,o=0;o<r.length;o++){var s=r[o];ue(e,s)||i(e,s,n(t,s))}},vt=/#|\.prototype\./,Et=function(e,t){var r=yt[At(e)];return r==Ct||r!=St&&(H(t)?N(t):!!t)},At=Et.normalize=function(e){return String(e).replace(vt,".").toLowerCase()},yt=Et.data={},St=Et.NATIVE="N",Ct=Et.POLYFILL="P",Tt=Et,bt=Ie.f,It=function(e,t){var r,i,n,o,s,a=e.target,c=e.global,l=e.stat;if(r=c?O:l?O[a]||oe(a,{}):(O[a]||{}).prototype)for(i in t){if(o=t[i],n=e.noTargetGet?(s=bt(r,i))&&s.value:r[i],!Tt(c?i:a+(l?".":"#")+i,e.forced)&&void 0!==n){if(typeof o==typeof n)continue;_t(o,n)}(e.sham||n&&n.sham)&&Oe(o,"sham",!0),Je(r,i,o,e)}},Rt=function(e,t,r){if(ie(e),void 0===t)return e;switch(r){case 0:return function(){return e.call(t)};case 1:return function(r){return e.call(t,r)};case 2:return function(r,i){return e.call(t,r,i)};case 3:return function(r,i,n){return e.call(t,r,i,n)}}return function(){return e.apply(t,arguments)}},wt=Array.isArray||function(e){return"Array"==U(e)},kt={};kt[_e("toStringTag")]="z";var Ot="[object z]"===String(kt),Nt=_e("toStringTag"),Lt="Arguments"==U(function(){return arguments}()),Pt=Ot?U:function(e){var t,r,i;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(r){}}(t=Object(e),Nt))?r:Lt?U(t):"Object"==(i=U(t))&&H(t.callee)?"Arguments":i},Dt=[],Mt=q("Reflect","construct"),xt=/^\s*(?:class|function)\b/,Bt=xt.exec,Ut=!xt.exec((function(){})),Ft=function(e){if(!H(e))return!1;try{return Mt(Object,Dt,e),!0}catch(r){return!1}},Vt=!Mt||N((function(){var e;return Ft(Ft.call)||!Ft(Object)||!Ft((function(){e=!0}))||e}))?function(e){if(!H(e))return!1;switch(Pt(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}return Ut||!!Bt.call(xt,Me(e))}:Ft,jt=_e("species"),Gt=function(e,t){return new(function(e){var t;return wt(e)&&(t=e.constructor,(Vt(t)&&(t===Array||wt(t.prototype))||Q(t)&&null===(t=t[jt]))&&(t=void 0)),void 0===t?Array:t}(e))(0===t?0:t)},Ht=[].push,Qt=function(e){var t=1==e,r=2==e,i=3==e,n=4==e,o=6==e,s=7==e,a=5==e||o;return function(c,l,u,d){for(var h,p,f=ce(c),g=V(f),m=Rt(l,u,3),_=at(g),v=0,E=d||Gt,A=t?E(c,_):r||s?E(c,0):void 0;_>v;v++)if((a||v in g)&&(p=m(h=g[v],v,f),e))if(t)A[v]=p;else if(p)switch(e){case 3:return!0;case 5:return h;case 6:return v;case 2:Ht.call(A,h)}else switch(e){case 4:return!1;case 7:Ht.call(A,h)}return o?-1:i||n?n:A}},Wt={forEach:Qt(0),map:Qt(1),filter:Qt(2),some:Qt(3),every:Qt(4),find:Qt(5),findIndex:Qt(6),filterReject:Qt(7)},qt=_e("species"),zt=function(e){return J>=51||!N((function(){var t=[];return(t.constructor={})[qt]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},Zt=Wt.map,Yt=zt("map");It({target:"Array",proto:!0,forced:!Yt},{map:function(e){return Zt(this,e,arguments.length>1?arguments[1]:void 0)}});var Kt=Wt.filter,$t=zt("filter");It({target:"Array",proto:!0,forced:!$t},{filter:function(e){return Kt(this,e,arguments.length>1?arguments[1]:void 0)}});var Jt=Ie.f,Xt=N((function(){Jt(1)}));It({target:"Object",stat:!0,forced:!L||Xt,sham:!L},{getOwnPropertyDescriptor:function(e,t){return Jt(G(e),t)}}),I((function(e){var t=function(e){var t=Object.prototype,r=t.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},n=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function a(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(R){a=function(e,t,r){return e[t]=r}}function c(e,t,r,i){var n=t&&t.prototype instanceof d?t:d,o=Object.create(n.prototype),s=new C(i||[]);return o._invoke=function(e,t,r){var i="suspendedStart";return function(n,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===n)throw o;return b()}for(r.method=n,r.arg=o;;){var s=r.delegate;if(s){var a=A(s,r);if(a){if(a===u)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===i)throw i="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i="executing";var c=l(e,t,r);if("normal"===c.type){if(i=r.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i="completed",r.method="throw",r.arg=c.arg)}}}(e,r,s),o}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(R){return{type:"throw",arg:R}}}e.wrap=c;var u={};function d(){}function h(){}function p(){}var f={};a(f,n,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(T([])));m&&m!==t&&r.call(m,n)&&(f=m);var _=p.prototype=d.prototype=Object.create(f);function v(e){["next","throw","return"].forEach((function(t){a(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){var i;this._invoke=function(n,o){function s(){return new t((function(i,s){!function i(n,o,s,a){var c=l(e[n],e,o);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==typeof d&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,s,a)}),(function(e){i("throw",e,s,a)})):t.resolve(d).then((function(e){u.value=e,s(u)}),(function(e){return i("throw",e,s,a)}))}a(c.arg)}(n,o,i,s)}))}return i=i?i.then(s,s):s()}}function A(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,A(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var i=l(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var n=i.arg;return n?n.done?(t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):n:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function y(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(y,this),this.reset(!0)}function T(e){if(e){var t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function t(){for(;++i<e.length;)if(r.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:b}}function b(){return{value:void 0,done:!0}}return h.prototype=p,a(_,"constructor",p),a(p,"constructor",h),h.displayName=a(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,a(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},v(E.prototype),a(E.prototype,o,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var s=new E(c(t,r,i,n),o);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},v(_),a(_,s,"Generator"),a(_,n,(function(){return this})),a(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var i=t.pop();if(i in e)return r.value=i,r.done=!1,r}return r.done=!0,r}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(r,i){return s.type="throw",s.arg=e,t.next=r,i&&(t.method="next",t.arg=void 0),!!i}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var i=r.completion;if("throw"===i.type){var n=i.arg;S(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),u}},e}(e.exports);try{regeneratorRuntime=t}catch(i){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}));let er=!0,tr=!0;function rr(e,t,r){const i=e.match(t);return i&&i.length>=r&&parseInt(i[r],10)}function ir(e,t,r){if(!e.RTCPeerConnection)return;const i=e.RTCPeerConnection.prototype,n=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return n.apply(this,arguments);const o=e=>{const t=r(e);t&&(i.handleEvent?i.handleEvent(t):i(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(i,o),n.apply(this,[e,o])};const o=i.removeEventListener;i.removeEventListener=function(e,r){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(r))return o.apply(this,arguments);const i=this._eventMap[t].get(r);return this._eventMap[t].delete(r),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,i])},Object.defineProperty(i,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function nr(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(er=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function or(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(tr=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function sr(){if("object"==typeof window){if(er)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function ar(e,t){tr&&console.warn(e+" is deprecated, please use "+t+" instead.")}function cr(e){return"[object Object]"===Object.prototype.toString.call(e)}function lr(e){return cr(e)?Object.keys(e).reduce((function(t,r){const i=cr(e[r]),n=i?lr(e[r]):e[r],o=i&&!Object.keys(n).length;return void 0===n||o?t:Object.assign(t,{[r]:n})}),{}):e}function ur(e,t,r){const i=r?"outbound-rtp":"inbound-rtp",n=new Map;if(null===t)return n;const o=[];return e.forEach(e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)}),o.forEach(t=>{e.forEach(r=>{r.type===i&&r.trackId===t.id&&function e(t,r,i){r&&!i.has(r.id)&&(i.set(r.id,r),Object.keys(r).forEach(n=>{n.endsWith("Id")?e(t,t.get(r[n]),i):n.endsWith("Ids")&&r[n].forEach(r=>{e(t,t.get(r),i)})}))}(e,r,n)})}),n}const dr=sr;function hr(e,t){const r=e&&e.navigator;if(!r.mediaDevices)return;const i=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach(r=>{if("require"===r||"advanced"===r||"mediaSource"===r)return;const i="object"==typeof e[r]?e[r]:{ideal:e[r]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);const n=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];let e={};"number"==typeof i.ideal?(e[n("min",r)]=i.ideal,t.optional.push(e),e={},e[n("max",r)]=i.ideal,t.optional.push(e)):(e[n("",r)]=i.ideal,t.optional.push(e))}void 0!==i.exact&&"number"!=typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[n("",r)]=i.exact):["min","max"].forEach(e=>{void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[n(e,r)]=i[e])})}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},n=function(e,n){if(t.version>=61)return n(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const t=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=i(e.audio)}if(e&&"object"==typeof e.video){let o=e.video.facingMode;o=o&&("object"==typeof o?o:{ideal:o});const s=t.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!r.mediaDevices.getSupportedConstraints||!r.mediaDevices.getSupportedConstraints().facingMode||s)){let t;if(delete e.video.facingMode,"environment"===o.exact||"environment"===o.ideal?t=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(t=["front"]),t)return r.mediaDevices.enumerateDevices().then(r=>{let s=(r=r.filter(e=>"videoinput"===e.kind)).find(e=>t.some(t=>e.label.toLowerCase().includes(t)));return!s&&r.length&&t.includes("back")&&(s=r[r.length-1]),s&&(e.video.deviceId=o.exact?{exact:s.deviceId}:{ideal:s.deviceId}),e.video=i(e.video),dr("chrome: "+JSON.stringify(e)),n(e)})}e.video=i(e.video)}return dr("chrome: "+JSON.stringify(e)),n(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(r.getUserMedia=function(e,t,i){n(e,e=>{r.webkitGetUserMedia(e,t,e=>{i&&i(o(e))})})}.bind(r),r.mediaDevices.getUserMedia){const e=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(t){return n(t,t=>e(t).then(e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(e=>{e.stop()}),new DOMException("","NotFoundError");return e},e=>Promise.reject(o(e))))}}}function pr(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function fr(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",r=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===r.track.id):{track:r.track};const n=new Event("track");n.track=r.track,n.receiver=i,n.transceiver={receiver:i},n.streams=[t.stream],this.dispatchEvent(n)}),t.stream.getTracks().forEach(r=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===r.id):{track:r};const n=new Event("track");n.track=r,n.receiver=i,n.transceiver={receiver:i},n.streams=[t.stream],this.dispatchEvent(n)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else ir(e,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function gr(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){let n=r.apply(this,arguments);return n||(n=t(this,e),this._senders.push(n)),n};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){i.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],r.apply(this,[e]),e.getTracks().forEach(e=>{this._senders.push(t(this,e))})};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach(e=>{const t=this._senders.find(t=>t.track===e);t&&this._senders.splice(this._senders.indexOf(t),1)})}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function mr(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,r,i]=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof e))return t.apply(this,[]);const n=function(e){const t={};return e.result().forEach(e=>{const r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(t=>{r[t]=e.stat(t)}),t[r.id]=r}),t},o=function(e){return new Map(Object.keys(e).map(t=>[t,e[t]]))};if(arguments.length>=2){const i=function(e){r(o(n(e)))};return t.apply(this,[i,e])}return new Promise((e,r)=>{t.apply(this,[function(t){e(o(n(t)))},r])}).then(r,i)}}function _r(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e});const r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>ur(t,e.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e}),ir(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>ur(t,e.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,r,i;return this.getSenders().forEach(r=>{r.track===e&&(t?i=!0:t=r)}),this.getReceivers().forEach(t=>(t.track===e&&(r?i=!0:r=t),t.track===e)),i||t&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function vr(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(e=>this._shimmedLocalStreams[e][0])};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const i=t.apply(this,arguments);return this._shimmedLocalStreams[r.id]?-1===this._shimmedLocalStreams[r.id].indexOf(i)&&this._shimmedLocalStreams[r.id].push(i):this._shimmedLocalStreams[r.id]=[r,i],i};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(e=>{if(this.getSenders().find(t=>t.track===e))throw new DOMException("Track already exists.","InvalidAccessError")});const t=this.getSenders();r.apply(this,arguments);const i=this.getSenders().filter(e=>-1===t.indexOf(e));this._shimmedLocalStreams[e.id]=[e].concat(i)};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],i.apply(this,arguments)};const n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach(t=>{const r=this._shimmedLocalStreams[t].indexOf(e);-1!==r&&this._shimmedLocalStreams[t].splice(r,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]}),n.apply(this,arguments)}}function Er(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return vr(e);const r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=r.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map(e=>this._reverseStreams[e.id])};const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach(e=>{if(this.getSenders().find(t=>t.track===e))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[t.id]){const r=new e.MediaStream(t.getTracks());this._streams[t.id]=r,this._reverseStreams[r.id]=t,t=r}i.apply(this,[t])};const n=e.RTCPeerConnection.prototype.removeStream;function o(e,t){let r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(t=>{const i=e._reverseStreams[t],n=e._streams[i.id];r=r.replace(new RegExp(n.id,"g"),i.id)}),new RTCSessionDescription({type:t.type,sdp:r})}function s(e,t){let r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(t=>{const i=e._reverseStreams[t],n=e._streams[i.id];r=r.replace(new RegExp(i.id,"g"),n.id)}),new RTCSessionDescription({type:t.type,sdp:r})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},n.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,r){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find(e=>e===t))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");const n=this.getSenders().find(e=>e.track===t);if(n)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const o=this._streams[r.id];if(o)o.addTrack(t),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const i=new e.MediaStream([t]);this._streams[r.id]=i,this._reverseStreams[i.id]=r,this.addStream(i)}return this.getSenders().find(e=>e.track===t)},["createOffer","createAnswer"].forEach((function(t){const r=e.RTCPeerConnection.prototype[t],i={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?r.apply(this,[t=>{const r=o(this,t);e[0].apply(null,[r])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):r.apply(this,arguments).then(e=>o(this,e))}};e.RTCPeerConnection.prototype[t]=i[t]}));const a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=s(this,arguments[0]),a.apply(this,arguments)):a.apply(this,arguments)};const c=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=c.get.apply(this);return""===e.type?e:o(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach(r=>{this._streams[r].getTracks().find(t=>e.track===t)&&(t=this._streams[r])}),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Ar(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const r=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]}))}function yr(e,t){ir(e,"negotiationneeded",e=>{const r=e.target;if(!(t.version<72||r.getConfiguration&&"plan-b"===r.getConfiguration().sdpSemantics)||"stable"===r.signalingState)return e})}var Sr=Object.freeze({__proto__:null,shimMediaStream:pr,shimOnTrack:fr,shimGetSendersWithDtmf:gr,shimGetStats:mr,shimSenderReceiverGetStats:_r,shimAddTrackRemoveTrackWithNative:vr,shimAddTrackRemoveTrack:Er,shimPeerConnection:Ar,fixNegotiationNeeded:yr,shimGetUserMedia:hr,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then(t=>{const i=r.video&&r.video.width,n=r.video&&r.video.height,o=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},i&&(r.video.mandatory.maxWidth=i),n&&(r.video.mandatory.maxHeight=n),e.navigator.mediaDevices.getUserMedia(r)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}}),Cr=I((function(e){var t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},t.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},t.getDescription=function(e){var r=t.splitSections(e);return r&&r[0]},t.getMediaSections=function(e){var r=t.splitSections(e);return r.shift(),r},t.matchPrefix=function(e,r){return t.splitLines(e).filter((function(e){return 0===e.indexOf(r)}))},t.parseCandidate=function(e){for(var t,r={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},i=8;i<t.length;i+=2)switch(t[i]){case"raddr":r.relatedAddress=t[i+1];break;case"rport":r.relatedPort=parseInt(t[i+1],10);break;case"tcptype":r.tcpType=t[i+1];break;case"ufrag":r.ufrag=t[i+1],r.usernameFragment=t[i+1];break;default:r[t[i]]=t[i+1]}return r},t.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=3===t.length?parseInt(t[2],10):1,r.numChannels=r.channels,r},t.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},t.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){for(var t,r={},i=e.substr(e.indexOf(" ")+1).split(";"),n=0;n<i.length;n++)r[(t=i[n].trim().split("="))[0].trim()]=t[1];return r},t.writeFmtp=function(e){var t="",r=e.payloadType;if(void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var i=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?i.push(t+"="+e.parameters[t]):i.push(t)})),t+="a=fmtp:"+r+" "+i.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){var t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},i=e.indexOf(":",t);return i>-1?(r.attribute=e.substr(t+1,i-t-1),r.value=e.substr(i+1)):r.attribute=e.substr(t+1),r},t.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},t.getMid=function(e){var r=t.matchPrefix(e,"a=mid:")[0];if(r)return r.substr(6)},t.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},t.getDtlsParameters=function(e,r){return{role:"auto",fingerprints:t.matchPrefix(e+r,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),r},t.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,r){return t.matchPrefix(e+r,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,r){var i=t.matchPrefix(e+r,"a=ice-ufrag:")[0],n=t.matchPrefix(e+r,"a=ice-pwd:")[0];return i&&n?{usernameFragment:i.substr(12),password:n.substr(10)}:null},t.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},t.parseRtpParameters=function(e){for(var r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=t.splitLines(e)[0].split(" "),n=3;n<i.length;n++){var o=i[n],s=t.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(s){var a=t.parseRtpMap(s),c=t.matchPrefix(e,"a=fmtp:"+o+" ");switch(a.parameters=c.length?t.parseFmtp(c[0]):{},a.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(t.parseRtcpFb),r.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(a.name.toUpperCase())}}}return t.matchPrefix(e,"a=extmap:").forEach((function(e){r.headerExtensions.push(t.parseExtmap(e))})),r},t.writeRtpDescription=function(e,r){var i="";i+="m="+e+" ",i+=r.codecs.length>0?"9":"0",i+=" UDP/TLS/RTP/SAVPF ",i+=r.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",i+="c=IN IP4 0.0.0.0\r\n",i+="a=rtcp:9 IN IP4 0.0.0.0\r\n",r.codecs.forEach((function(e){i+=t.writeRtpMap(e),i+=t.writeFmtp(e),i+=t.writeRtcpFb(e)}));var n=0;return r.codecs.forEach((function(e){e.maxptime>n&&(n=e.maxptime)})),n>0&&(i+="a=maxptime:"+n+"\r\n"),i+="a=rtcp-mux\r\n",r.headerExtensions&&r.headerExtensions.forEach((function(e){i+=t.writeExtmap(e)})),i},t.parseRtpEncodingParameters=function(e){var r,i=[],n=t.parseRtpParameters(e),o=-1!==n.fecMechanisms.indexOf("RED"),s=-1!==n.fecMechanisms.indexOf("ULPFEC"),a=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=a.length>0&&a[0].ssrc,l=t.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));l.length>0&&l[0].length>1&&l[0][0]===c&&(r=l[0][1]),n.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&r&&(t.rtx={ssrc:r}),i.push(t),o&&((t=JSON.parse(JSON.stringify(t))).fec={ssrc:c,mechanism:s?"red+ulpfec":"red"},i.push(t))}})),0===i.length&&c&&i.push({ssrc:c});var u=t.matchPrefix(e,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substr(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substr(5),10)*.95-16e3:void 0,i.forEach((function(e){e.maxBitrate=u}))),i},t.parseRtcpParameters=function(e){var r={},i=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);var n=t.matchPrefix(e,"a=rtcp-rsize");r.reducedSize=n.length>0,r.compound=0===n.length;var o=t.matchPrefix(e,"a=rtcp-mux");return r.mux=o.length>0,r},t.parseMsid=function(e){var r,i=t.matchPrefix(e,"a=msid:");if(1===i.length)return{stream:(r=i[0].substr(7).split(" "))[0],track:r[1]};var n=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return n.length>0?{stream:(r=n[0].value.split(" "))[0],track:r[1]}:void 0},t.parseSctpDescription=function(e){var r,i=t.parseMLine(e),n=t.matchPrefix(e,"a=max-message-size:");n.length>0&&(r=parseInt(n[0].substr(19),10)),isNaN(r)&&(r=65536);var o=t.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:i.fmt,maxMessageSize:r};if(t.matchPrefix(e,"a=sctpmap:").length>0){var s=t.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(s[0],10),protocol:s[1],maxMessageSize:r}}},t.writeSctpDescription=function(e,t){var r=[];return r="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&r.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),r.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,r,i){var n=void 0!==r?r:2;return"v=0\r\no="+(i||"thisisadapterortc")+" "+(e||t.generateSessionId())+" "+n+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.writeMediaSection=function(e,r,i,n){var o=t.writeRtpDescription(e.kind,r);if(o+=t.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=t.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===i?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var s="msid:"+n.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+s,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+t.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+t.localCName+"\r\n"),o},t.getDirection=function(e,r){for(var i=t.splitLines(e),n=0;n<i.length;n++)switch(i[n]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[n].substr(2)}return r?t.getDirection(r):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){var r=t.splitLines(e)[0].substr(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},t.parseOLine=function(e){var r=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var r=t.splitLines(e),i=0;i<r.length;i++)if(r[i].length<2||"="!==r[i].charAt(1))return!1;return!0},e.exports=t}));function Tr(e,t,r,i,n){var o=Cr.writeRtpDescription(e.kind,t);if(o+=Cr.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=Cr.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":n||"active"),o+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var s=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=s;var a="msid:"+(i?i.id:"-")+" "+s+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+Cr.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+Cr.localCName+"\r\n"),o}function br(e,t){var r={codecs:[],headerExtensions:[],fecMechanisms:[]},i=function(e,t){e=parseInt(e,10);for(var r=0;r<t.length;r++)if(t[r].payloadType===e||t[r].preferredPayloadType===e)return t[r]},n=function(e,t,r,n){var o=i(e.parameters.apt,r),s=i(t.parameters.apt,n);return o&&s&&o.name.toLowerCase()===s.name.toLowerCase()};return e.codecs.forEach((function(i){for(var o=0;o<t.codecs.length;o++){var s=t.codecs[o];if(i.name.toLowerCase()===s.name.toLowerCase()&&i.clockRate===s.clockRate){if("rtx"===i.name.toLowerCase()&&i.parameters&&s.parameters.apt&&!n(i,s,e.codecs,t.codecs))continue;(s=JSON.parse(JSON.stringify(s))).numChannels=Math.min(i.numChannels,s.numChannels),r.codecs.push(s),s.rtcpFeedback=s.rtcpFeedback.filter((function(e){for(var t=0;t<i.rtcpFeedback.length;t++)if(i.rtcpFeedback[t].type===e.type&&i.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var i=0;i<t.headerExtensions.length;i++){var n=t.headerExtensions[i];if(e.uri===n.uri){r.headerExtensions.push(n);break}}})),r}function Ir(e,t,r){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)}function Rr(e,t){var r=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return r||e.addRemoteCandidate(t),!r}function wr(e,t){var r=new Error(t);return r.name=e,r.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],r}var kr=function(e,t){function r(t,r){r.addTrack(t),r.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function i(t,r,i,n){var o=new Event("track");o.track=r,o.receiver=i,o.transceiver={receiver:i},o.streams=n,e.setTimeout((function(){t._dispatchEvent("track",o)}))}var n=function(r){var i=this,n=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){i[e]=n[e].bind(n)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",r=JSON.parse(JSON.stringify(r||{})),this.usingBundle="max-bundle"===r.bundlePolicy,"negotiate"===r.rtcpMuxPolicy)throw wr("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(r.rtcpMuxPolicy||(r.rtcpMuxPolicy="require"),r.iceTransportPolicy){case"all":case"relay":break;default:r.iceTransportPolicy="all"}switch(r.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:r.bundlePolicy="balanced"}if(r.iceServers=function(e,t){var r=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var i=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var n="string"==typeof i;return n&&(i=[i]),i=i.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||r?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(r=!0,!0)})),delete e.url,e.urls=n?i[0]:i,!!i.length}}))}(r.iceServers||[],t),this._iceGatherers=[],r.iceCandidatePoolSize)for(var o=r.iceCandidatePoolSize;o>0;o--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:r.iceServers,gatherPolicy:r.iceTransportPolicy}));else r.iceCandidatePoolSize=0;this._config=r,this.transceivers=[],this._sdpSessionId=Cr.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(n.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(n.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),n.prototype.onicecandidate=null,n.prototype.onaddstream=null,n.prototype.ontrack=null,n.prototype.onremovestream=null,n.prototype.onsignalingstatechange=null,n.prototype.oniceconnectionstatechange=null,n.prototype.onconnectionstatechange=null,n.prototype.onicegatheringstatechange=null,n.prototype.onnegotiationneeded=null,n.prototype.ondatachannel=null,n.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},n.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},n.prototype.getConfiguration=function(){return this._config},n.prototype.getLocalStreams=function(){return this.localStreams},n.prototype.getRemoteStreams=function(){return this.remoteStreams},n.prototype._createTransceiver=function(e,t){var r=this.transceivers.length>0,i={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&r)i.iceTransport=this.transceivers[0].iceTransport,i.dtlsTransport=this.transceivers[0].dtlsTransport;else{var n=this._createIceAndDtlsTransports();i.iceTransport=n.iceTransport,i.dtlsTransport=n.dtlsTransport}return t||this.transceivers.push(i),i},n.prototype.addTrack=function(t,r){if(this._isClosed)throw wr("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var i;if(this.transceivers.find((function(e){return e.track===t})))throw wr("InvalidAccessError","Track already exists.");for(var n=0;n<this.transceivers.length;n++)this.transceivers[n].track||this.transceivers[n].kind!==t.kind||(i=this.transceivers[n]);return i||(i=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(r)&&this.localStreams.push(r),i.track=t,i.stream=r,i.rtpSender=new e.RTCRtpSender(t,i.dtlsTransport),i.rtpSender},n.prototype.addStream=function(e){var r=this;if(t>=15025)e.getTracks().forEach((function(t){r.addTrack(t,e)}));else{var i=e.clone();e.getTracks().forEach((function(e,t){var r=i.getTracks()[t];e.addEventListener("enabled",(function(e){r.enabled=e.enabled}))})),i.getTracks().forEach((function(e){r.addTrack(e,i)}))}},n.prototype.removeTrack=function(t){if(this._isClosed)throw wr("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var r=this.transceivers.find((function(e){return e.rtpSender===t}));if(!r)throw wr("InvalidAccessError","Sender was not created by this connection.");var i=r.stream;r.rtpSender.stop(),r.rtpSender=null,r.track=null,r.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(i)&&this.localStreams.indexOf(i)>-1&&this.localStreams.splice(this.localStreams.indexOf(i),1),this._maybeFireNegotiationNeeded()},n.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var r=t.getSenders().find((function(t){return t.track===e}));r&&t.removeTrack(r)}))},n.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},n.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},n.prototype._createIceGatherer=function(t,r){var i=this;if(r&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var n=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(n,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var r=!e.candidate||0===Object.keys(e.candidate).length;n.state=r?"completed":"gathering",null!==i.transceivers[t].bufferedCandidateEvents&&i.transceivers[t].bufferedCandidateEvents.push(e)},n.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),n},n.prototype._gather=function(t,r){var i=this,n=this.transceivers[r].iceGatherer;if(!n.onlocalcandidate){var o=this.transceivers[r].bufferedCandidateEvents;this.transceivers[r].bufferedCandidateEvents=null,n.removeEventListener("localcandidate",this.transceivers[r].bufferCandidates),n.onlocalcandidate=function(e){if(!(i.usingBundle&&r>0)){var o=new Event("icecandidate");o.candidate={sdpMid:t,sdpMLineIndex:r};var s=e.candidate,a=!s||0===Object.keys(s).length;if(a)"new"!==n.state&&"gathering"!==n.state||(n.state="completed");else{"new"===n.state&&(n.state="gathering"),s.component=1,s.ufrag=n.getLocalParameters().usernameFragment;var c=Cr.writeCandidate(s);o.candidate=Object.assign(o.candidate,Cr.parseCandidate(c)),o.candidate.candidate=c,o.candidate.toJSON=function(){return{candidate:o.candidate.candidate,sdpMid:o.candidate.sdpMid,sdpMLineIndex:o.candidate.sdpMLineIndex,usernameFragment:o.candidate.usernameFragment}}}var l=Cr.getMediaSections(i._localDescription.sdp);l[o.candidate.sdpMLineIndex]+=a?"a=end-of-candidates\r\n":"a="+o.candidate.candidate+"\r\n",i._localDescription.sdp=Cr.getDescription(i._localDescription.sdp)+l.join("");var u=i.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==i.iceGatheringState&&(i.iceGatheringState="gathering",i._emitGatheringStateChange()),a||i._dispatchEvent("icecandidate",o),u&&(i._dispatchEvent("icecandidate",new Event("icecandidate")),i.iceGatheringState="complete",i._emitGatheringStateChange())}},e.setTimeout((function(){o.forEach((function(e){n.onlocalcandidate(e)}))}),0)}},n.prototype._createIceAndDtlsTransports=function(){var t=this,r=new e.RTCIceTransport(null);r.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var i=new e.RTCDtlsTransport(r);return i.ondtlsstatechange=function(){t._updateConnectionState()},i.onerror=function(){Object.defineProperty(i,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:r,dtlsTransport:i}},n.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var r=this.transceivers[e].iceTransport;r&&(delete r.onicestatechange,delete this.transceivers[e].iceTransport);var i=this.transceivers[e].dtlsTransport;i&&(delete i.ondtlsstatechange,delete i.onerror,delete this.transceivers[e].dtlsTransport)},n.prototype._transceive=function(e,r,i){var n=br(e.localCapabilities,e.remoteCapabilities);r&&e.rtpSender&&(n.encodings=e.sendEncodingParameters,n.rtcp={cname:Cr.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(n.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(n)),i&&e.rtpReceiver&&n.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?n.encodings=e.recvEncodingParameters:n.encodings=[{}],n.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(n.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(n.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(n))},n.prototype.setLocalDescription=function(e){var t,r,i=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(wr("TypeError",'Unsupported type "'+e.type+'"'));if(!Ir("setLocalDescription",e.type,i.signalingState)||i._isClosed)return Promise.reject(wr("InvalidStateError","Can not set local "+e.type+" in state "+i.signalingState));if("offer"===e.type)t=Cr.splitSections(e.sdp),r=t.shift(),t.forEach((function(e,t){var r=Cr.parseRtpParameters(e);i.transceivers[t].localCapabilities=r})),i.transceivers.forEach((function(e,t){i._gather(e.mid,t)}));else if("answer"===e.type){t=Cr.splitSections(i._remoteDescription.sdp),r=t.shift();var n=Cr.matchPrefix(r,"a=ice-lite").length>0;t.forEach((function(e,t){var o=i.transceivers[t],s=o.iceGatherer,a=o.iceTransport,c=o.dtlsTransport,l=o.localCapabilities,u=o.remoteCapabilities;if((!Cr.isRejected(e)||0!==Cr.matchPrefix(e,"a=bundle-only").length)&&!o.rejected){var d=Cr.getIceParameters(e,r),h=Cr.getDtlsParameters(e,r);n&&(h.role="server"),i.usingBundle&&0!==t||(i._gather(o.mid,t),"new"===a.state&&a.start(s,d,n?"controlling":"controlled"),"new"===c.state&&c.start(h));var p=br(l,u);i._transceive(o,p.codecs.length>0,!1)}}))}return i._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?i._updateSignalingState("have-local-offer"):i._updateSignalingState("stable"),Promise.resolve()},n.prototype.setRemoteDescription=function(n){var o=this;if(-1===["offer","answer"].indexOf(n.type))return Promise.reject(wr("TypeError",'Unsupported type "'+n.type+'"'));if(!Ir("setRemoteDescription",n.type,o.signalingState)||o._isClosed)return Promise.reject(wr("InvalidStateError","Can not set remote "+n.type+" in state "+o.signalingState));var s={};o.remoteStreams.forEach((function(e){s[e.id]=e}));var a=[],c=Cr.splitSections(n.sdp),l=c.shift(),u=Cr.matchPrefix(l,"a=ice-lite").length>0,d=Cr.matchPrefix(l,"a=group:BUNDLE ").length>0;o.usingBundle=d;var h=Cr.matchPrefix(l,"a=ice-options:")[0];return o.canTrickleIceCandidates=!!h&&h.substr(14).split(" ").indexOf("trickle")>=0,c.forEach((function(i,c){var h=Cr.splitLines(i),p=Cr.getKind(i),f=Cr.isRejected(i)&&0===Cr.matchPrefix(i,"a=bundle-only").length,g=h[0].substr(2).split(" ")[2],m=Cr.getDirection(i,l),_=Cr.parseMsid(i),v=Cr.getMid(i)||Cr.generateIdentifier();if(f||"application"===p&&("DTLS/SCTP"===g||"UDP/DTLS/SCTP"===g))o.transceivers[c]={mid:v,kind:p,protocol:g,rejected:!0};else{var E,A,y,S,C,T,b,I,R;!f&&o.transceivers[c]&&o.transceivers[c].rejected&&(o.transceivers[c]=o._createTransceiver(p,!0));var w,k,O=Cr.parseRtpParameters(i);f||(w=Cr.getIceParameters(i,l),(k=Cr.getDtlsParameters(i,l)).role="client"),b=Cr.parseRtpEncodingParameters(i);var N=Cr.parseRtcpParameters(i),L=Cr.matchPrefix(i,"a=end-of-candidates",l).length>0,P=Cr.matchPrefix(i,"a=candidate:").map((function(e){return Cr.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===n.type||"answer"===n.type)&&!f&&d&&c>0&&o.transceivers[c]&&(o._disposeIceAndDtlsTransports(c),o.transceivers[c].iceGatherer=o.transceivers[0].iceGatherer,o.transceivers[c].iceTransport=o.transceivers[0].iceTransport,o.transceivers[c].dtlsTransport=o.transceivers[0].dtlsTransport,o.transceivers[c].rtpSender&&o.transceivers[c].rtpSender.setTransport(o.transceivers[0].dtlsTransport),o.transceivers[c].rtpReceiver&&o.transceivers[c].rtpReceiver.setTransport(o.transceivers[0].dtlsTransport)),"offer"!==n.type||f)"answer"!==n.type||f||(A=(E=o.transceivers[c]).iceGatherer,y=E.iceTransport,S=E.dtlsTransport,C=E.rtpReceiver,T=E.sendEncodingParameters,I=E.localCapabilities,o.transceivers[c].recvEncodingParameters=b,o.transceivers[c].remoteCapabilities=O,o.transceivers[c].rtcpParameters=N,P.length&&"new"===y.state&&(!u&&!L||d&&0!==c?P.forEach((function(e){Rr(E.iceTransport,e)})):y.setRemoteCandidates(P)),d&&0!==c||("new"===y.state&&y.start(A,w,"controlling"),"new"===S.state&&S.start(k)),!br(E.localCapabilities,E.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&E.sendEncodingParameters[0].rtx&&delete E.sendEncodingParameters[0].rtx,o._transceive(E,"sendrecv"===m||"recvonly"===m,"sendrecv"===m||"sendonly"===m),!C||"sendrecv"!==m&&"sendonly"!==m?delete E.rtpReceiver:(R=C.track,_?(s[_.stream]||(s[_.stream]=new e.MediaStream),r(R,s[_.stream]),a.push([R,C,s[_.stream]])):(s.default||(s.default=new e.MediaStream),r(R,s.default),a.push([R,C,s.default]))));else{(E=o.transceivers[c]||o._createTransceiver(p)).mid=v,E.iceGatherer||(E.iceGatherer=o._createIceGatherer(c,d)),P.length&&"new"===E.iceTransport.state&&(!L||d&&0!==c?P.forEach((function(e){Rr(E.iceTransport,e)})):E.iceTransport.setRemoteCandidates(P)),I=e.RTCRtpReceiver.getCapabilities(p),t<15019&&(I.codecs=I.codecs.filter((function(e){return"rtx"!==e.name}))),T=E.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var D,M=!1;"sendrecv"===m||"sendonly"===m?(M=!E.rtpReceiver,C=E.rtpReceiver||new e.RTCRtpReceiver(E.dtlsTransport,p),M&&(R=C.track,_&&"-"===_.stream||(_?(s[_.stream]||(s[_.stream]=new e.MediaStream,Object.defineProperty(s[_.stream],"id",{get:function(){return _.stream}})),Object.defineProperty(R,"id",{get:function(){return _.track}}),D=s[_.stream]):(s.default||(s.default=new e.MediaStream),D=s.default)),D&&(r(R,D),E.associatedRemoteMediaStreams.push(D)),a.push([R,C,D]))):E.rtpReceiver&&E.rtpReceiver.track&&(E.associatedRemoteMediaStreams.forEach((function(t){var r=t.getTracks().find((function(e){return e.id===E.rtpReceiver.track.id}));r&&function(t,r){r.removeTrack(t),r.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(r,t)})),E.associatedRemoteMediaStreams=[]),E.localCapabilities=I,E.remoteCapabilities=O,E.rtpReceiver=C,E.rtcpParameters=N,E.sendEncodingParameters=T,E.recvEncodingParameters=b,o._transceive(o.transceivers[c],!1,M)}}})),void 0===o._dtlsRole&&(o._dtlsRole="offer"===n.type?"active":"passive"),o._remoteDescription={type:n.type,sdp:n.sdp},"offer"===n.type?o._updateSignalingState("have-remote-offer"):o._updateSignalingState("stable"),Object.keys(s).forEach((function(t){var r=s[t];if(r.getTracks().length){if(-1===o.remoteStreams.indexOf(r)){o.remoteStreams.push(r);var n=new Event("addstream");n.stream=r,e.setTimeout((function(){o._dispatchEvent("addstream",n)}))}a.forEach((function(e){var t=e[0],n=e[1];r.id===e[2].id&&i(o,t,n,[r])}))}})),a.forEach((function(e){e[2]||i(o,e[0],e[1],[])})),e.setTimeout((function(){o&&o.transceivers&&o.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},n.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},n.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},n.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},n.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",r)}},n.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var r=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",r)}},n.prototype.createOffer=function(){var r=this;if(r._isClosed)return Promise.reject(wr("InvalidStateError","Can not call createOffer after close"));var i=r.transceivers.filter((function(e){return"audio"===e.kind})).length,n=r.transceivers.filter((function(e){return"video"===e.kind})).length,o=arguments[0];if(o){if(o.mandatory||o.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==o.offerToReceiveAudio&&(i=!0===o.offerToReceiveAudio?1:!1===o.offerToReceiveAudio?0:o.offerToReceiveAudio),void 0!==o.offerToReceiveVideo&&(n=!0===o.offerToReceiveVideo?1:!1===o.offerToReceiveVideo?0:o.offerToReceiveVideo)}for(r.transceivers.forEach((function(e){"audio"===e.kind?--i<0&&(e.wantReceive=!1):"video"===e.kind&&--n<0&&(e.wantReceive=!1)}));i>0||n>0;)i>0&&(r._createTransceiver("audio"),i--),n>0&&(r._createTransceiver("video"),n--);var s=Cr.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.transceivers.forEach((function(i,n){var o=i.track,s=i.kind,a=i.mid||Cr.generateIdentifier();i.mid=a,i.iceGatherer||(i.iceGatherer=r._createIceGatherer(n,r.usingBundle));var c=e.RTCRtpSender.getCapabilities(s);t<15019&&(c.codecs=c.codecs.filter((function(e){return"rtx"!==e.name}))),c.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),i.remoteCapabilities&&i.remoteCapabilities.codecs&&i.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),c.headerExtensions.forEach((function(e){(i.remoteCapabilities&&i.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var l=i.sendEncodingParameters||[{ssrc:1001*(2*n+1)}];o&&t>=15019&&"video"===s&&!l[0].rtx&&(l[0].rtx={ssrc:l[0].ssrc+1}),i.wantReceive&&(i.rtpReceiver=new e.RTCRtpReceiver(i.dtlsTransport,s)),i.localCapabilities=c,i.sendEncodingParameters=l})),"max-compat"!==r._config.bundlePolicy&&(s+="a=group:BUNDLE "+r.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),s+="a=ice-options:trickle\r\n",r.transceivers.forEach((function(e,t){s+=Tr(e,e.localCapabilities,"offer",e.stream,r._dtlsRole),s+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===r.iceGatheringState||0!==t&&r.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,s+="a="+Cr.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(s+="a=end-of-candidates\r\n"))}));var a=new e.RTCSessionDescription({type:"offer",sdp:s});return Promise.resolve(a)},n.prototype.createAnswer=function(){var r=this;if(r._isClosed)return Promise.reject(wr("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==r.signalingState&&"have-local-pranswer"!==r.signalingState)return Promise.reject(wr("InvalidStateError","Can not call createAnswer in signalingState "+r.signalingState));var i=Cr.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.usingBundle&&(i+="a=group:BUNDLE "+r.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),i+="a=ice-options:trickle\r\n";var n=Cr.getMediaSections(r._remoteDescription.sdp).length;r.transceivers.forEach((function(e,o){if(!(o+1>n)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?i+="m=application 0 DTLS/SCTP 5000\r\n":i+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?i+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(i+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(i+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var s;e.stream&&("audio"===e.kind?s=e.stream.getAudioTracks()[0]:"video"===e.kind&&(s=e.stream.getVideoTracks()[0]),s&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var a=br(e.localCapabilities,e.remoteCapabilities);!a.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,i+=Tr(e,a,"answer",e.stream,r._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(i+="a=rtcp-rsize\r\n")}}));var o=new e.RTCSessionDescription({type:"answer",sdp:i});return Promise.resolve(o)},n.prototype.addIceCandidate=function(e){var t,r=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(i,n){if(!r._remoteDescription)return n(wr("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var o=e.sdpMLineIndex;if(e.sdpMid)for(var s=0;s<r.transceivers.length;s++)if(r.transceivers[s].mid===e.sdpMid){o=s;break}var a=r.transceivers[o];if(!a)return n(wr("OperationError","Can not add ICE candidate"));if(a.rejected)return i();var c=Object.keys(e.candidate).length>0?Cr.parseCandidate(e.candidate):{};if("tcp"===c.protocol&&(0===c.port||9===c.port))return i();if(c.component&&1!==c.component)return i();if((0===o||o>0&&a.iceTransport!==r.transceivers[0].iceTransport)&&!Rr(a.iceTransport,c))return n(wr("OperationError","Can not add ICE candidate"));var l=e.candidate.trim();0===l.indexOf("a=")&&(l=l.substr(2)),(t=Cr.getMediaSections(r._remoteDescription.sdp))[o]+="a="+(c.type?l:"end-of-candidates")+"\r\n",r._remoteDescription.sdp=Cr.getDescription(r._remoteDescription.sdp)+t.join("")}else for(var u=0;u<r.transceivers.length&&(r.transceivers[u].rejected||(r.transceivers[u].iceTransport.addRemoteCandidate({}),(t=Cr.getMediaSections(r._remoteDescription.sdp))[u]+="a=end-of-candidates\r\n",r._remoteDescription.sdp=Cr.getDescription(r._remoteDescription.sdp)+t.join(""),!r.usingBundle));u++);i()}))},n.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var r=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?r=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(r=e.rtpReceiver)})),!r)throw wr("InvalidAccessError","Invalid selector.");return r.getStats()}var i=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&i.push(e[t].getStats())}))})),Promise.all(i).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var r=e[t];if(r&&r.prototype&&r.prototype.getStats){var i=r.prototype.getStats;r.prototype.getStats=function(){return i.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(r){var i;e[r].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(i=e[r]).type]||i.type,t.set(r,e[r])})),t}))}}}));var o=["createOffer","createAnswer"];return o.forEach((function(e){var t=n.prototype[e];n.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(o=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=n.prototype[e];n.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=n.prototype[e];n.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),n};function Or(e){const t=e&&e.navigator,r=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return r(e).catch(e=>Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString(){return this.name}}}(e)))}}function Nr(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}function Lr(e,t){if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){const t=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set(e){t.set.call(this,e);const r=new Event("enabled");r.enabled=e,this.dispatchEvent(r)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);const r=kr(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=function(e,t){let r=!1;return(e=JSON.parse(JSON.stringify(e))).filter(e=>{if(e&&(e.urls||e.url)){let t=e.urls||e.url;e.url&&!e.urls&&ar("RTCIceServer.url","RTCIceServer.urls");const i="string"==typeof t;return i&&(t=[t]),t=t.filter(e=>{if(0===e.indexOf("stun:"))return!1;const t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!r?(r=!0,!0):t&&!r}),delete e.url,e.urls=i?t[0]:t,!!t.length}})}(e.iceServers,t.version),sr("ICE servers after filtering:",e.iceServers)),new r(e)},e.RTCPeerConnection.prototype=r.prototype}function Pr(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}var Dr=Object.freeze({__proto__:null,shimPeerConnection:Lr,shimReplaceTrack:Pr,shimGetUserMedia:Or,shimGetDisplayMedia:Nr});function Mr(e,t){const r=e&&e.navigator,i=e&&e.MediaStreamTrack;if(r.getUserMedia=function(e,t,i){ar("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){const e=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},t=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(r){return"object"==typeof r&&"object"==typeof r.audio&&(r=JSON.parse(JSON.stringify(r)),e(r.audio,"autoGainControl","mozAutoGainControl"),e(r.audio,"noiseSuppression","mozNoiseSuppression")),t(r)},i&&i.prototype.getSettings){const t=i.prototype.getSettings;i.prototype.getSettings=function(){const r=t.apply(this,arguments);return e(r,"mozAutoGainControl","autoGainControl"),e(r,"mozNoiseSuppression","noiseSuppression"),r}}if(i&&i.prototype.applyConstraints){const t=i.prototype.applyConstraints;i.prototype.applyConstraints=function(r){return"audio"===this.kind&&"object"==typeof r&&(r=JSON.parse(JSON.stringify(r)),e(r,"autoGainControl","mozAutoGainControl"),e(r,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[r])}}}}function xr(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Br(e,t){if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const r=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]}));const r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,n,o]=arguments;return i.apply(this,[e||null]).then(e=>{if(t.version<53&&!n)try{e.forEach(e=>{e.type=r[e.type]||e.type})}catch(i){if("TypeError"!==i.name)throw i;e.forEach((t,i)=>{e.set(i,Object.assign({},t,{type:r[t.type]||t.type}))})}return e}).then(n,o)}}function Ur(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e});const r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Fr(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e}),ir(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Vr(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){ar("removeStream","removeTrack"),this.getSenders().forEach(t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)})})}function jr(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function Gr(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const e=arguments[1],r=e&&"sendEncodings"in e;r&&e.sendEncodings.forEach(e=>{if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const i=t.apply(this,arguments);if(r){const{sender:t}=i,r=t.getParameters();(!("encodings"in r)||1===r.encodings.length&&0===Object.keys(r.encodings[0]).length)&&(r.encodings=e.sendEncodings,t.sendEncodings=e.sendEncodings,this.setParametersPromises.push(t.setParameters(r).then(()=>{delete t.sendEncodings}).catch(()=>{delete t.sendEncodings})))}return i})}function Hr(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function Qr(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function Wr(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}var qr=Object.freeze({__proto__:null,shimOnTrack:xr,shimPeerConnection:Br,shimSenderGetStats:Ur,shimReceiverGetStats:Fr,shimRemoveStream:Vr,shimRTCDataChannel:jr,shimAddTransceiver:Gr,shimGetParameters:Hr,shimCreateOffer:Qr,shimCreateAnswer:Wr,shimGetUserMedia:Mr,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===r.video?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)})}});function zr(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach(r=>t.call(this,r,e)),e.getVideoTracks().forEach(r=>t.call(this,r,e))},e.RTCPeerConnection.prototype.addTrack=function(e,...r){return r&&r.forEach(e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const r=e.getTracks();this.getSenders().forEach(e=>{r.includes(e.track)&&this.removeTrack(e)})})}}function Zr(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach(e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)})})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach(t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const r=new Event("addstream");r.stream=t,e.dispatchEvent(r)})}),t.apply(e,arguments)}}}function Yr(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,r=t.createOffer,i=t.createAnswer,n=t.setLocalDescription,o=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){const i=arguments.length>=2?arguments[2]:arguments[0],n=r.apply(this,[i]);return t?(n.then(e,t),Promise.resolve()):n},t.createAnswer=function(e,t){const r=arguments.length>=2?arguments[2]:arguments[0],n=i.apply(this,[r]);return t?(n.then(e,t),Promise.resolve()):n};let a=function(e,t,r){const i=n.apply(this,[e]);return r?(i.then(t,r),Promise.resolve()):i};t.setLocalDescription=a,a=function(e,t,r){const i=o.apply(this,[e]);return r?(i.then(t,r),Promise.resolve()):i},t.setRemoteDescription=a,a=function(e,t,r){const i=s.apply(this,[e]);return r?(i.then(t,r),Promise.resolve()):i},t.addIceCandidate=a}function Kr(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,r=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>r($r(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,r,i){t.mediaDevices.getUserMedia(e).then(r,i)}.bind(t))}function $r(e){return e&&void 0!==e.video?Object.assign({},e,{video:lr(e.video)}):e}function Jr(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,r){if(e&&e.iceServers){const t=[];for(let r=0;r<e.iceServers.length;r++){let i=e.iceServers[r];!i.hasOwnProperty("urls")&&i.hasOwnProperty("url")?(ar("RTCIceServer.url","RTCIceServer.urls"),i=JSON.parse(JSON.stringify(i)),i.urls=i.url,delete i.url,t.push(i)):t.push(e.iceServers[r])}e.iceServers=t}return new t(e,r)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function Xr(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ei(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find(e=>"audio"===e.receiver.track.kind);!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const r=this.getTransceivers().find(e=>"video"===e.receiver.track.kind);!1===e.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveVideo||r||this.addTransceiver("video")}return t.apply(this,arguments)}}function ti(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var ri=Object.freeze({__proto__:null,shimLocalStreamsAPI:zr,shimRemoteStreamsAPI:Zr,shimCallbacksAPI:Yr,shimGetUserMedia:Kr,shimConstraints:$r,shimRTCIceServerUrls:Jr,shimTrackEventTransceiver:Xr,shimCreateOfferLegacy:ei,shimAudioContext:ti});function ii(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){const r=new t(e),i=Cr.parseCandidate(e.candidate),n=Object.assign(r,i);return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,ir(e,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t))}function ni(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const r=function(e){if(!e||!e.sdp)return!1;const t=Cr.splitSections(e.sdp);return t.shift(),t.some(e=>{const t=Cr.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})},i=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const r=parseInt(t[1],10);return r!=r?-1:r},n=function(e){let r=65536;return"firefox"===t.browser&&(r=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),r},o=function(e,r){let i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);const n=Cr.matchPrefix(e.sdp,"a=max-message-size:");return n.length>0?i=parseInt(n[0].substr(19),10):"firefox"===t.browser&&-1!==r&&(i=2147483637),i},s=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(r(arguments[0])){const e=i(arguments[0]),t=n(e),r=o(arguments[0],e);let s;s=0===t&&0===r?Number.POSITIVE_INFINITY:0===t||0===r?Math.max(t,r):Math.min(t,r);const a={};Object.defineProperty(a,"maxMessageSize",{get:()=>s}),this._sctp=a}return s.apply(this,arguments)}}function oi(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const r=e.send;e.send=function(){const i=arguments[0],n=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&n>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return r.apply(e,arguments)}}const r=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=r.apply(this,arguments);return t(e,this),e},ir(e,"datachannel",e=>(t(e.channel,e.target),e))}function si(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(e=>{const r=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const r=new Event("connectionstatechange",e);t.dispatchEvent(r)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function ai(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const r=t.sdp.split("\n").filter(e=>"a=extmap-allow-mixed"!==e.trim()).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:r}):t.sdp=r}return r.apply(this,arguments)}}function ci(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const r=e.RTCPeerConnection.prototype.addIceCandidate;r&&0!==r.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}var li=Object.freeze({__proto__:null,shimRTCIceCandidate:ii,shimMaxMessageSize:ni,shimSendThrowTypeError:oi,shimConnectionState:si,removeExtmapAllowMixed:ai,shimAddIceCandidateNullOrEmpty:ci});!function({window:e}={},t={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0}){const r=sr,i=function(e){const t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;const{navigator:r}=e;if(r.mozGetUserMedia)t.browser="firefox",t.version=rr(r.userAgent,/Firefox\/(\d+)\./,1);else if(r.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=rr(r.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(r.mediaDevices&&r.userAgent.match(/Edge\/(\d+).(\d+)$/))t.browser="edge",t.version=rr(r.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!r.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=rr(r.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),n={browserDetails:i,commonShim:li,extractVersion:rr,disableLog:nr,disableWarnings:or};switch(i.browser){case"chrome":if(!Sr||!Ar||!t.shimChrome)return r("Chrome shim is not included in this adapter release."),n;if(null===i.version)return r("Chrome shim can not determine version, not shimming."),n;r("adapter.js shimming chrome."),n.browserShim=Sr,ci(e,i),hr(e,i),pr(e),Ar(e,i),fr(e),Er(e,i),gr(e),mr(e),_r(e),yr(e,i),ii(e),si(e),ni(e,i),oi(e),ai(e,i);break;case"firefox":if(!qr||!Br||!t.shimFirefox)return r("Firefox shim is not included in this adapter release."),n;r("adapter.js shimming firefox."),n.browserShim=qr,ci(e,i),Mr(e,i),Br(e,i),xr(e),Vr(e),Ur(e),Fr(e),jr(e),Gr(e),Hr(e),Qr(e),Wr(e),ii(e),si(e),ni(e,i),oi(e);break;case"edge":if(!Dr||!Lr||!t.shimEdge)return r("MS edge shim is not included in this adapter release."),n;r("adapter.js shimming edge."),n.browserShim=Dr,Or(e),Nr(e),Lr(e,i),Pr(e),ni(e,i),oi(e);break;case"safari":if(!ri||!t.shimSafari)return r("Safari shim is not included in this adapter release."),n;r("adapter.js shimming safari."),n.browserShim=ri,ci(e,i),Jr(e),ei(e),Yr(e),zr(e),Zr(e),Xr(e),Kr(e),ti(e),ii(e),ni(e,i),oi(e),ai(e,i);break;default:r("Unsupported browser!")}}({window:"undefined"==typeof window?void 0:window});var ui=[].slice,di=/MSIE .\./.test(z),hi=function(e){return function(t,r){var i=arguments.length>2,n=i?ui.call(arguments,2):void 0;return e(i?function(){(H(t)?t:Function(t)).apply(this,n)}:t,r)}};It({global:!0,bind:!0,forced:di},{setTimeout:hi(O.setTimeout),setInterval:hi(O.setInterval)});var pi,fi=Object.keys||function(e){return dt(e,ht)},gi=L?Object.defineProperties:function(e,t){Re(e);for(var r,i=fi(t),n=i.length,o=0;n>o;)ke.f(e,r=i[o++],t[r]);return e},mi=q("document","documentElement"),_i=Fe("IE_PROTO"),vi=function(){},Ei=function(e){return"<script>"+e+"<\/script>"},Ai=function(e){e.write(Ei("")),e.close();var t=e.parentWindow.Object;return e=null,t},yi=function(){try{pi=new ActiveXObject("htmlfile")}catch(n){}var e,t;yi="undefined"!=typeof document?document.domain&&pi?Ai(pi):((t=Ce("iframe")).style.display="none",mi.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(Ei("document.F=Object")),e.close(),e.F):Ai(pi);for(var r=ht.length;r--;)delete yi.prototype[ht[r]];return yi()};Ve[_i]=!0;var Si=Object.create||function(e,t){var r;return null!==e?(vi.prototype=Re(e),r=new vi,vi.prototype=null,r[_i]=e):r=yi(),void 0===t?r:gi(r,t)},Ci=_e("unscopables"),Ti=Array.prototype;null==Ti[Ci]&&ke.f(Ti,Ci,{configurable:!0,value:Si(null)});var bi,Ii,Ri,wi=function(e){Ti[Ci][e]=!0},ki={},Oi=!N((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Ni=Fe("IE_PROTO"),Li=Object.prototype,Pi=Oi?Object.getPrototypeOf:function(e){var t=ce(e);if(ue(t,Ni))return t[Ni];var r=t.constructor;return H(r)&&t instanceof r?r.prototype:t instanceof Object?Li:null},Di=_e("iterator"),Mi=!1;[].keys&&("next"in(Ri=[].keys())?(Ii=Pi(Pi(Ri)))!==Object.prototype&&(bi=Ii):Mi=!0),(null==bi||N((function(){var e={};return bi[Di].call(e)!==e})))&&(bi={}),H(bi[Di])||Je(bi,Di,(function(){return this}));var xi={IteratorPrototype:bi,BUGGY_SAFARI_ITERATORS:Mi},Bi=ke.f,Ui=_e("toStringTag"),Fi=function(e,t,r){e&&!ue(e=r?e:e.prototype,Ui)&&Bi(e,Ui,{configurable:!0,value:t})},Vi=xi.IteratorPrototype,ji=function(){return this},Gi=function(e,t,r){var i=t+" Iterator";return e.prototype=Si(Vi,{next:x(1,r)}),Fi(e,i,!1),ki[i]=ji,e},Hi=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(r,[]),t=r instanceof Array}catch(n){}return function(r,i){return Re(r),function(e){if("object"==typeof e||H(e))return e;throw TypeError("Can't set "+String(e)+" as a prototype")}(i),t?e.call(r,i):r.__proto__=i,r}}():void 0),Qi=$e.PROPER,Wi=$e.CONFIGURABLE,qi=xi.IteratorPrototype,zi=xi.BUGGY_SAFARI_ITERATORS,Zi=_e("iterator"),Yi=function(){return this},Ki=function(e,t,r,i,n,o,s){Gi(r,t,i);var a,c,l,u=function(e){if(e===n&&g)return g;if(!zi&&e in p)return p[e];switch(e){case"keys":case"values":case"entries":return function(){return new r(this,e)}}return function(){return new r(this)}},d=t+" Iterator",h=!1,p=e.prototype,f=p[Zi]||p["@@iterator"]||n&&p[n],g=!zi&&f||u(n),m="Array"==t&&p.entries||f;if(m&&(a=Pi(m.call(new e)))!==Object.prototype&&a.next&&(Pi(a)!==qi&&(Hi?Hi(a,qi):H(a[Zi])||Je(a,Zi,Yi)),Fi(a,d,!0)),Qi&&"values"==n&&f&&"values"!==f.name&&(Wi?Oe(p,"name","values"):(h=!0,g=function(){return f.call(this)})),n)if(c={values:u("values"),keys:o?g:u("keys"),entries:u("entries")},s)for(l in c)(zi||h||!(l in p))&&Je(p,l,c[l]);else It({target:t,proto:!0,forced:zi||h},c);return p[Zi]!==g&&Je(p,Zi,g,{name:n}),ki[t]=g,c},$i=ze.set,Ji=ze.getterFor("Array Iterator"),Xi=Ki(Array,"Array",(function(e,t){$i(this,{type:"Array Iterator",target:G(e),index:0,kind:t})}),(function(){var e=Ji(this),t=e.target,r=e.kind,i=e.index++;return!t||i>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:i,done:!1}:"values"==r?{value:t[i],done:!1}:{value:[i,t[i]],done:!1}}),"values");ki.Arguments=ki.Array,wi("keys"),wi("values"),wi("entries");var en=ft.f,tn={}.toString,rn="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],nn={f:function(e){return rn&&"[object Window]"==tn.call(e)?function(e){try{return en(e)}catch(r){return rn.slice()}}(e):en(G(e))}},on=!N((function(){return Object.isExtensible(Object.preventExtensions({}))})),sn=I((function(e){var t=ke.f,r=!1,i=pe("meta"),n=0,o=Object.isExtensible||function(){return!0},s=function(e){t(e,i,{value:{objectID:"O"+n++,weakData:{}}})},a=e.exports={enable:function(){a.enable=function(){},r=!0;var e=ft.f,t=[].splice,n={};n[i]=1,e(n).length&&(ft.f=function(r){for(var n=e(r),o=0,s=n.length;o<s;o++)if(n[o]===i){t.call(n,o,1);break}return n},It({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:nn.f}))},fastKey:function(e,t){if(!Q(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!ue(e,i)){if(!o(e))return"F";if(!t)return"E";s(e)}return e[i].objectID},getWeakData:function(e,t){if(!ue(e,i)){if(!o(e))return!0;if(!t)return!1;s(e)}return e[i].weakData},onFreeze:function(e){return on&&r&&o(e)&&!ue(e,i)&&s(e),e}};Ve[i]=!0})),an=(sn.enable,sn.fastKey,sn.getWeakData,sn.onFreeze,_e("iterator")),cn=Array.prototype,ln=_e("iterator"),un=function(e){if(null!=e)return ne(e,ln)||ne(e,"@@iterator")||ki[Pt(e)]},dn=function(e,t){var r=arguments.length<2?un(e):t;if(ie(r))return Re(r.call(e));throw TypeError(String(e)+" is not iterable")},hn=function(e,t,r){var i,n;Re(e);try{if(!(i=ne(e,"return"))){if("throw"===t)throw r;return r}i=i.call(e)}catch(s){n=!0,i=s}if("throw"===t)throw r;if(n)throw i;return Re(i),r},pn=function(e,t){this.stopped=e,this.result=t},fn=function(e,t,r){var i,n,o,s,a,c,l,u,d=r&&r.that,h=!(!r||!r.AS_ENTRIES),p=!(!r||!r.IS_ITERATOR),f=!(!r||!r.INTERRUPTED),g=Rt(t,d,1+h+f),m=function(e){return i&&hn(i,"normal",e),new pn(!0,e)},_=function(e){return h?(Re(e),f?g(e[0],e[1],m):g(e[0],e[1])):f?g(e,m):g(e)};if(p)i=e;else{if(!(n=un(e)))throw TypeError(String(e)+" is not iterable");if(void 0!==(u=n)&&(ki.Array===u||cn[an]===u)){for(o=0,s=at(e);s>o;o++)if((a=_(e[o]))&&a instanceof pn)return a;return new pn(!1)}i=dn(e,n)}for(c=i.next;!(l=c.call(i)).done;){try{a=_(l.value)}catch(E){hn(i,"throw",E)}if("object"==typeof a&&a&&a instanceof pn)return a}return new pn(!1)},gn=function(e,t,r){if(e instanceof t)return e;throw TypeError("Incorrect "+(r?r+" ":"")+"invocation")},mn=_e("iterator"),_n=!1;try{var vn=0,En={next:function(){return{done:!!vn++}},return:function(){_n=!0}};En[mn]=function(){return this},Array.from(En,(function(){throw 2}))}catch(ky){}var An=function(e,t){if(!t&&!_n)return!1;var r=!1;try{var i={};i[mn]=function(){return{next:function(){return{done:r=!0}}}},e(i)}catch(ky){}return r},yn=function(e,t,r){var i,n;return Hi&&H(i=t.constructor)&&i!==r&&Q(n=i.prototype)&&n!==r.prototype&&Hi(e,n),e},Sn=function(e,t,r){var i=-1!==e.indexOf("Map"),n=-1!==e.indexOf("Weak"),o=i?"set":"add",s=O[e],a=s&&s.prototype,c=s,l={},u=function(e){var t=a[e];Je(a,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(n&&!Q(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return n&&!Q(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(n&&!Q(e))&&t.call(this,0===e?0:e)}:function(e,r){return t.call(this,0===e?0:e,r),this})};if(Tt(e,!H(s)||!(n||a.forEach&&!N((function(){(new s).entries().next()})))))c=r.getConstructor(t,e,i,o),sn.enable();else if(Tt(e,!0)){var d=new c,h=d[o](n?{}:-0,1)!=d,p=N((function(){d.has(1)})),f=An((function(e){new s(e)})),g=!n&&N((function(){for(var e=new s,t=5;t--;)e[o](t,t);return!e.has(-0)}));f||((c=t((function(t,r){gn(t,c,e);var n=yn(new s,t,c);return null!=r&&fn(r,n[o],{that:n,AS_ENTRIES:i}),n}))).prototype=a,a.constructor=c),(p||g)&&(u("delete"),u("has"),i&&u("get")),(g||h)&&u(o),n&&a.clear&&delete a.clear}return l[e]=c,It({global:!0,forced:c!=s},l),Fi(c,e),n||r.setStrong(c,e,i),c},Cn=function(e,t,r){for(var i in t)Je(e,i,t[i],r);return e},Tn=_e("species"),bn=function(e){var t=q(e),r=ke.f;L&&t&&!t[Tn]&&r(t,Tn,{configurable:!0,get:function(){return this}})},In=ke.f,Rn=sn.fastKey,wn=ze.set,kn=ze.getterFor,On={getConstructor:function(e,t,r,i){var n=e((function(e,o){gn(e,n,t),wn(e,{type:t,index:Si(null),first:void 0,last:void 0,size:0}),L||(e.size=0),null!=o&&fn(o,e[i],{that:e,AS_ENTRIES:r})})),o=kn(t),s=function(e,t,r){var i,n,s=o(e),c=a(e,t);return c?c.value=r:(s.last=c={index:n=Rn(t,!0),key:t,value:r,previous:i=s.last,next:void 0,removed:!1},s.first||(s.first=c),i&&(i.next=c),L?s.size++:e.size++,"F"!==n&&(s.index[n]=c)),e},a=function(e,t){var r,i=o(e),n=Rn(t);if("F"!==n)return i.index[n];for(r=i.first;r;r=r.next)if(r.key==t)return r};return Cn(n.prototype,{clear:function(){for(var e=o(this),t=e.index,r=e.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete t[r.index],r=r.next;e.first=e.last=void 0,L?e.size=0:this.size=0},delete:function(e){var t=o(this),r=a(this,e);if(r){var i=r.next,n=r.previous;delete t.index[r.index],r.removed=!0,n&&(n.next=i),i&&(i.previous=n),t.first==r&&(t.first=i),t.last==r&&(t.last=n),L?t.size--:this.size--}return!!r},forEach:function(e){for(var t,r=o(this),i=Rt(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.next:r.first;)for(i(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!a(this,e)}}),Cn(n.prototype,r?{get:function(e){var t=a(this,e);return t&&t.value},set:function(e,t){return s(this,0===e?0:e,t)}}:{add:function(e){return s(this,e=0===e?0:e,e)}}),L&&In(n.prototype,"size",{get:function(){return o(this).size}}),n},setStrong:function(e,t,r){var i=t+" Iterator",n=kn(t),o=kn(i);Ki(e,t,(function(e,t){wn(this,{type:i,target:e,state:n(e),kind:t,last:void 0})}),(function(){for(var e=o(this),t=e.kind,r=e.last;r&&r.removed;)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?"keys"==t?{value:r.key,done:!1}:"values"==t?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),bn(t)}},Nn=(Sn("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),On),Ot?{}.toString:function(){return"[object "+Pt(this)+"]"});Ot||Je(Object.prototype,"toString",Nn,{unsafe:!0});var Ln=function(e){if("Symbol"===Pt(e))throw TypeError("Cannot convert a Symbol value to a string");return String(e)},Pn=function(e){return function(t,r){var i,n,o=Ln(j(t)),s=tt(r),a=o.length;return s<0||s>=a?e?"":void 0:(i=o.charCodeAt(s))<55296||i>56319||s+1===a||(n=o.charCodeAt(s+1))<56320||n>57343?e?o.charAt(s):i:e?o.slice(s,s+2):n-56320+(i-55296<<10)+65536}},Dn={codeAt:Pn(!1),charAt:Pn(!0)},Mn=Dn.charAt,xn=ze.set,Bn=ze.getterFor("String Iterator");Ki(String,"String",(function(e){xn(this,{type:"String Iterator",string:Ln(e),index:0})}),(function(){var e,t=Bn(this),r=t.string,i=t.index;return i>=r.length?{value:void 0,done:!0}:(e=Mn(r,i),t.index+=e.length,{value:e,done:!1})}));var Un={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Fn=Ce("span").classList,Vn=Fn&&Fn.constructor&&Fn.constructor.prototype,jn=Vn===Object.prototype?void 0:Vn,Gn=_e("iterator"),Hn=_e("toStringTag"),Qn=Xi.values,Wn=function(e,t){if(e){if(e[Gn]!==Qn)try{Oe(e,Gn,Qn)}catch(ky){e[Gn]=Qn}if(e[Hn]||Oe(e,Hn,t),Un[t])for(var r in Xi)if(e[r]!==Xi[r])try{Oe(e,r,Xi[r])}catch(ky){e[r]=Xi[r]}}};for(var qn in Un)Wn(O[qn]&&O[qn].prototype,qn);Wn(jn,"DOMTokenList");var zn=function(e,t,r){var i=Ae(t);i in e?ke.f(e,i,x(0,r)):e[i]=r},Zn=zt("splice"),Yn=Math.max,Kn=Math.min;It({target:"Array",proto:!0,forced:!Zn},{splice:function(e,t){var r,i,n,o,s,a,c=ce(this),l=at(c),u=nt(e,l),d=arguments.length;if(0===d?r=i=0:1===d?(r=0,i=l-u):(r=d-2,i=Kn(Yn(tt(t),0),l-u)),l+r-i>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(n=Gt(c,i),o=0;o<i;o++)(s=u+o)in c&&zn(n,o,c[s]);if(n.length=i,r<i){for(o=u;o<l-i;o++)a=o+r,(s=o+i)in c?c[a]=c[s]:delete c[a];for(o=l;o>l-i+r;o--)delete c[o-1]}else if(r>i)for(o=l-i;o>u;o--)a=o+r-1,(s=o+i-1)in c?c[a]=c[s]:delete c[a];for(o=0;o<r;o++)c[o+u]=arguments[o+2];return c.length=l-i+r,n}});var $n=function(e,t){var r=[][e];return!!r&&N((function(){r.call(null,t||function(){throw 1},1)}))},Jn=Wt.forEach,Xn=$n("forEach")?[].forEach:function(e){return Jn(this,e,arguments.length>1?arguments[1]:void 0)};It({target:"Array",proto:!0,forced:[].forEach!=Xn},{forEach:Xn});var eo=function(e){if(e&&e.forEach!==Xn)try{Oe(e,"forEach",Xn)}catch(ky){e.forEach=Xn}};for(var to in Un)Un[to]&&eo(O[to]&&O[to].prototype);eo(jn);var ro=[].join,io=V!=Object,no=$n("join",",");It({target:"Array",proto:!0,forced:io||!no},{join:function(e){return ro.call(G(this),void 0===e?",":e)}});var oo=_e("isConcatSpreadable"),so=J>=51||!N((function(){var e=[];return e[oo]=!1,e.concat()[0]!==e})),ao=zt("concat"),co=function(e){if(!Q(e))return!1;var t=e[oo];return void 0!==t?!!t:wt(e)};It({target:"Array",proto:!0,forced:!so||!ao},{concat:function(e){var t,r,i,n,o,s=ce(this),a=Gt(s,0),c=0;for(t=-1,i=arguments.length;t<i;t++)if(co(o=-1===t?s:arguments[t])){if(c+(n=at(o))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(r=0;r<n;r++,c++)r in o&&zn(a,c,o[r])}else{if(c>=9007199254740991)throw TypeError("Maximum allowed index exceeded");zn(a,c++,o)}return a.length=c,a}});var lo=Date.prototype,uo=lo.toString,ho=lo.getTime;"Invalid Date"!=String(new Date(NaN))&&Je(lo,"toString",(function(){var e=ho.call(this);return e==e?uo.call(this):"Invalid Date"}));var po=function(){var e=Re(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},fo=O.RegExp,go={UNSUPPORTED_Y:N((function(){var e=fo("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),BROKEN_CARET:N((function(){var e=fo("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},mo=O.RegExp,_o=N((function(){var e=mo(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)})),vo=O.RegExp,Eo=N((function(){var e=vo("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})),Ao=ze.get,yo=RegExp.prototype.exec,So=ae("native-string-replace",String.prototype.replace),Co=yo,To=function(){var e=/a/,t=/b*/g;return yo.call(e,"a"),yo.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),bo=go.UNSUPPORTED_Y||go.BROKEN_CARET,Io=void 0!==/()??/.exec("")[1];(To||Io||bo||_o||Eo)&&(Co=function(e){var t,r,i,n,o,s,a,c=this,l=Ao(c),u=Ln(e),d=l.raw;if(d)return d.lastIndex=c.lastIndex,t=Co.call(d,u),c.lastIndex=d.lastIndex,t;var h=l.groups,p=bo&&c.sticky,f=po.call(c),g=c.source,m=0,_=u;if(p&&(-1===(f=f.replace("y","")).indexOf("g")&&(f+="g"),_=u.slice(c.lastIndex),c.lastIndex>0&&(!c.multiline||c.multiline&&"\n"!==u.charAt(c.lastIndex-1))&&(g="(?: "+g+")",_=" "+_,m++),r=new RegExp("^(?:"+g+")",f)),Io&&(r=new RegExp("^"+g+"$(?!\\s)",f)),To&&(i=c.lastIndex),n=yo.call(p?r:c,_),p?n?(n.input=n.input.slice(m),n[0]=n[0].slice(m),n.index=c.lastIndex,c.lastIndex+=n[0].length):c.lastIndex=0:To&&n&&(c.lastIndex=c.global?n.index+n[0].length:i),Io&&n&&n.length>1&&So.call(n[0],r,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(n[o]=void 0)})),n&&h)for(n.groups=s=Si(null),o=0;o<h.length;o++)s[(a=h[o])[0]]=n[a[1]];return n});var Ro=Co;It({target:"RegExp",proto:!0,forced:/./.exec!==Ro},{exec:Ro});var wo=_e("species"),ko=RegExp.prototype,Oo=function(e,t,r,i){var n=_e(e),o=!N((function(){var t={};return t[n]=function(){return 7},7!=""[e](t)})),s=o&&!N((function(){var t=!1,r=/a/;return"split"===e&&((r={}).constructor={},r.constructor[wo]=function(){return r},r.flags="",r[n]=/./[n]),r.exec=function(){return t=!0,null},r[n](""),!t}));if(!o||!s||r){var a=/./[n],c=t(n,""[e],(function(e,t,r,i,n){var s=t.exec;return s===Ro||s===ko.exec?o&&!n?{done:!0,value:a.call(t,r,i)}:{done:!0,value:e.call(r,t,i)}:{done:!1}}));Je(String.prototype,e,c[0]),Je(ko,n,c[1])}i&&Oe(ko[n],"sham",!0)},No=Dn.charAt,Lo=function(e,t,r){return t+(r?No(e,t).length:1)},Po=Math.floor,Do="".replace,Mo=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,xo=/\$([$&'`]|\d{1,2})/g,Bo=function(e,t,r,i,n,o){var s=r+e.length,a=i.length,c=xo;return void 0!==n&&(n=ce(n),c=Mo),Do.call(o,c,(function(o,c){var l;switch(c.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);case"'":return t.slice(s);case"<":l=n[c.slice(1,-1)];break;default:var u=+c;if(0===u)return o;if(u>a){var d=Po(u/10);return 0===d?o:d<=a?void 0===i[d-1]?c.charAt(1):i[d-1]+c.charAt(1):o}l=i[u-1]}return void 0===l?"":l}))},Uo=function(e,t){var r=e.exec;if(H(r)){var i=r.call(e,t);return null!==i&&Re(i),i}if("RegExp"===U(e))return Ro.call(e,t);throw TypeError("RegExp#exec called on incompatible receiver")},Fo=_e("replace"),Vo=Math.max,jo=Math.min,Go="$0"==="a".replace(/./,"$0"),Ho=!!/./[Fo]&&""===/./[Fo]("a","$0");Oo("replace",(function(e,t,r){var i=Ho?"$":"$0";return[function(e,r){var i=j(this),n=null==e?void 0:ne(e,Fo);return n?n.call(e,i,r):t.call(Ln(i),e,r)},function(e,n){var o=Re(this),s=Ln(e);if("string"==typeof n&&-1===n.indexOf(i)&&-1===n.indexOf("$<")){var a=r(t,o,s,n);if(a.done)return a.value}var c=H(n);c||(n=Ln(n));var l=o.global;if(l){var u=o.unicode;o.lastIndex=0}for(var d=[];;){var h=Uo(o,s);if(null===h)break;if(d.push(h),!l)break;""===Ln(h[0])&&(o.lastIndex=Lo(s,st(o.lastIndex),u))}for(var p,f="",g=0,m=0;m<d.length;m++){h=d[m];for(var _=Ln(h[0]),v=Vo(jo(tt(h.index),s.length),0),E=[],A=1;A<h.length;A++)E.push(void 0===(p=h[A])?p:String(p));var y=h.groups;if(c){var S=[_].concat(E,v,s);void 0!==y&&S.push(y);var C=Ln(n.apply(void 0,S))}else C=Bo(_,s,v,E,y,n);v>=g&&(f+=s.slice(g,v)+C,g=v+_.length)}return f+s.slice(g)}]}),!!N((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!Go||Ho);var Qo=_e("iterator"),Wo=!N((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r="";return e.pathname="c%20d",t.forEach((function(e,i){t.delete("b"),r+=i+e})),!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[Qo]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==r||"x"!==new URL("http://x",void 0).host})),qo=q("fetch"),zo=q("Request"),Zo=zo&&zo.prototype,Yo=q("Headers"),Ko=_e("iterator"),$o=ze.set,Jo=ze.getterFor("URLSearchParams"),Xo=ze.getterFor("URLSearchParamsIterator"),es=/\+/g,ts=Array(4),rs=function(e){return ts[e-1]||(ts[e-1]=RegExp("((?:%[\\da-f]{2}){"+e+"})","gi"))},is=function(e){try{return decodeURIComponent(e)}catch(ky){return e}},ns=function(e){var t=e.replace(es," "),r=4;try{return decodeURIComponent(t)}catch(ky){for(;r;)t=t.replace(rs(r--),is);return t}},os=/[!'()~]|%20/g,ss={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},as=function(e){return ss[e]},cs=function(e){return encodeURIComponent(e).replace(os,as)},ls=function(e,t){if(t)for(var r,i,n=t.split("&"),o=0;o<n.length;)(r=n[o++]).length&&(i=r.split("="),e.push({key:ns(i.shift()),value:ns(i.join("="))}))},us=function(e){this.entries.length=0,ls(this.entries,e)},ds=function(e,t){if(e<t)throw TypeError("Not enough arguments")},hs=Gi((function(e,t){$o(this,{type:"URLSearchParamsIterator",iterator:dn(Jo(e).entries),kind:t})}),"Iterator",(function(){var e=Xo(this),t=e.kind,r=e.iterator.next(),i=r.value;return r.done||(r.value="keys"===t?i.key:"values"===t?i.value:[i.key,i.value]),r})),ps=function(){gn(this,ps,"URLSearchParams");var e,t,r,i,n,o,s,a,c,l=arguments.length>0?arguments[0]:void 0,u=this,d=[];if($o(u,{type:"URLSearchParams",entries:d,updateURL:function(){},updateSearchParams:us}),void 0!==l)if(Q(l))if(e=un(l))for(r=(t=dn(l,e)).next;!(i=r.call(t)).done;){if((s=(o=(n=dn(Re(i.value))).next).call(n)).done||(a=o.call(n)).done||!o.call(n).done)throw TypeError("Expected sequence with length 2");d.push({key:Ln(s.value),value:Ln(a.value)})}else for(c in l)ue(l,c)&&d.push({key:c,value:Ln(l[c])});else ls(d,"string"==typeof l?"?"===l.charAt(0)?l.slice(1):l:Ln(l))},fs=ps.prototype;if(Cn(fs,{append:function(e,t){ds(arguments.length,2);var r=Jo(this);r.entries.push({key:Ln(e),value:Ln(t)}),r.updateURL()},delete:function(e){ds(arguments.length,1);for(var t=Jo(this),r=t.entries,i=Ln(e),n=0;n<r.length;)r[n].key===i?r.splice(n,1):n++;t.updateURL()},get:function(e){ds(arguments.length,1);for(var t=Jo(this).entries,r=Ln(e),i=0;i<t.length;i++)if(t[i].key===r)return t[i].value;return null},getAll:function(e){ds(arguments.length,1);for(var t=Jo(this).entries,r=Ln(e),i=[],n=0;n<t.length;n++)t[n].key===r&&i.push(t[n].value);return i},has:function(e){ds(arguments.length,1);for(var t=Jo(this).entries,r=Ln(e),i=0;i<t.length;)if(t[i++].key===r)return!0;return!1},set:function(e,t){ds(arguments.length,1);for(var r,i=Jo(this),n=i.entries,o=!1,s=Ln(e),a=Ln(t),c=0;c<n.length;c++)(r=n[c]).key===s&&(o?n.splice(c--,1):(o=!0,r.value=a));o||n.push({key:s,value:a}),i.updateURL()},sort:function(){var e,t,r,i=Jo(this),n=i.entries,o=n.slice();for(n.length=0,r=0;r<o.length;r++){for(e=o[r],t=0;t<r;t++)if(n[t].key>e.key){n.splice(t,0,e);break}t===r&&n.push(e)}i.updateURL()},forEach:function(e){for(var t,r=Jo(this).entries,i=Rt(e,arguments.length>1?arguments[1]:void 0,3),n=0;n<r.length;)i((t=r[n++]).value,t.key,this)},keys:function(){return new hs(this,"keys")},values:function(){return new hs(this,"values")},entries:function(){return new hs(this,"entries")}},{enumerable:!0}),Je(fs,Ko,fs.entries,{name:"entries"}),Je(fs,"toString",(function(){for(var e,t=Jo(this).entries,r=[],i=0;i<t.length;)e=t[i++],r.push(cs(e.key)+"="+cs(e.value));return r.join("&")}),{enumerable:!0}),Fi(ps,"URLSearchParams"),It({global:!0,forced:!Wo},{URLSearchParams:ps}),!Wo&&H(Yo)){var gs=function(e){if(Q(e)){var t,r=e.body;if("URLSearchParams"===Pt(r))return(t=e.headers?new Yo(e.headers):new Yo).has("content-type")||t.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),Si(e,{body:x(0,String(r)),headers:x(0,t)})}return e};if(H(qo)&&It({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return qo(e,arguments.length>1?gs(arguments[1]):{})}}),H(zo)){var ms=function(e){return gn(this,ms,"Request"),new zo(e,arguments.length>1?gs(arguments[1]):{})};Zo.constructor=ms,ms.prototype=Zo,It({global:!0,forced:!0},{Request:ms})}}var _s=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t};Oo("search",(function(e,t,r){return[function(t){var r=j(this),i=null==t?void 0:ne(t,e);return i?i.call(t,r):new RegExp(t)[e](Ln(r))},function(e){var i=Re(this),n=Ln(e),o=r(t,i,n);if(o.done)return o.value;var s=i.lastIndex;_s(s,0)||(i.lastIndex=0);var a=Uo(i,n);return _s(i.lastIndex,s)||(i.lastIndex=s),null===a?-1:a.index}]})),(new Date).getTime();var vs=0,Es=function(){return(new Date).getTime()+vs},As=function(){var e=new Date;return e.setTime(Es()),e.toLocaleString()};Oo("match",(function(e,t,r){return[function(t){var r=j(this),i=null==t?void 0:ne(t,e);return i?i.call(t,r):new RegExp(t)[e](Ln(r))},function(e){var i=Re(this),n=Ln(e),o=r(t,i,n);if(o.done)return o.value;if(!i.global)return Uo(i,n);var s=i.unicode;i.lastIndex=0;for(var a,c=[],l=0;null!==(a=Uo(i,n));){var u=Ln(a[0]);c[l]=u,""===u&&(i.lastIndex=Lo(n,st(i.lastIndex),s)),l++}return 0===l?null:c}]}));var ys=_e("match"),Ss=function(e){var t;return Q(e)&&(void 0!==(t=e[ys])?!!t:"RegExp"==U(e))},Cs=ke.f,Ts=ft.f,bs=ze.enforce,Is=_e("match"),Rs=O.RegExp,ws=Rs.prototype,ks=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Os=/a/g,Ns=/a/g,Ls=new Rs(Os)!==Os,Ps=go.UNSUPPORTED_Y,Ds=L&&(!Ls||Ps||_o||Eo||N((function(){return Ns[Is]=!1,Rs(Os)!=Os||Rs(Ns)==Ns||"/a/i"!=Rs(Os,"i")})));if(Tt("RegExp",Ds)){for(var Ms=function(e,t){var r,i,n,o,s,a,c=this instanceof Ms,l=Ss(e),u=void 0===t,d=[],h=e;if(!c&&l&&u&&e.constructor===Ms)return e;if((l||e instanceof Ms)&&(e=e.source,u&&(t="flags"in h?h.flags:po.call(h))),e=void 0===e?"":Ln(e),t=void 0===t?"":Ln(t),h=e,_o&&"dotAll"in Os&&(i=!!t&&t.indexOf("s")>-1)&&(t=t.replace(/s/g,"")),r=t,Ps&&"sticky"in Os&&(n=!!t&&t.indexOf("y")>-1)&&(t=t.replace(/y/g,"")),Eo&&(e=(o=function(e){for(var t,r=e.length,i=0,n="",o=[],s={},a=!1,c=!1,l=0,u="";i<=r;i++){if("\\"===(t=e.charAt(i)))t+=e.charAt(++i);else if("]"===t)a=!1;else if(!a)switch(!0){case"["===t:a=!0;break;case"("===t:ks.test(e.slice(i+1))&&(i+=2,c=!0),n+=t,l++;continue;case">"===t&&c:if(""===u||ue(s,u))throw new SyntaxError("Invalid capture group name");s[u]=!0,o.push([u,l]),c=!1,u="";continue}c?u+=t:n+=t}return[n,o]}(e))[0],d=o[1]),s=yn(Rs(e,t),c?this:ws,Ms),(i||n||d.length)&&(a=bs(s),i&&(a.dotAll=!0,a.raw=Ms(function(e){for(var t,r=e.length,i=0,n="",o=!1;i<=r;i++)"\\"!==(t=e.charAt(i))?o||"."!==t?("["===t?o=!0:"]"===t&&(o=!1),n+=t):n+="[\\s\\S]":n+=t+e.charAt(++i);return n}(e),r)),n&&(a.sticky=!0),d.length&&(a.groups=d)),e!==h)try{Oe(s,"source",""===h?"(?:)":h)}catch(ky){}return s},xs=function(e){e in Ms||Cs(Ms,e,{configurable:!0,get:function(){return Rs[e]},set:function(t){Rs[e]=t}})},Bs=Ts(Rs),Us=0;Bs.length>Us;)xs(Bs[Us++]);ws.constructor=Ms,Ms.prototype=ws,Je(O,"RegExp",Ms)}bn("RegExp");var Fs=$e.PROPER,Vs=RegExp.prototype,js=Vs.toString,Gs=N((function(){return"/a/b"!=js.call({source:"a",flags:"b"})})),Hs=Fs&&"toString"!=js.name;(Gs||Hs)&&Je(RegExp.prototype,"toString",(function(){var e=Re(this),t=Ln(e.source),r=e.flags;return"/"+t+"/"+Ln(void 0===r&&e instanceof RegExp&&!("flags"in Vs)?po.call(e):r)}),{unsafe:!0});var Qs=lt.indexOf,Ws=[].indexOf,qs=!!Ws&&1/[1].indexOf(1,-0)<0,zs=$n("indexOf");It({target:"Array",proto:!0,forced:qs||!zs},{indexOf:function(e){return qs?Ws.apply(this,arguments)||0:Qs(this,e,arguments.length>1?arguments[1]:void 0)}});var Zs=N((function(){Pi(1)}));It({target:"Object",stat:!0,forced:Zs,sham:!Oi},{getPrototypeOf:function(e){return Pi(ce(e))}});var Ys=q("Reflect","apply"),Ks=Function.apply,$s=!N((function(){Ys((function(){}))}));It({target:"Reflect",stat:!0,forced:$s},{apply:function(e,t,r){return ie(e),Re(r),Ys?Ys(e,t,r):Ks.call(e,t,r)}});var Js=$e.EXISTS,Xs=ke.f,ea=Function.prototype,ta=ea.toString,ra=/^\s*function ([^ (]*)/;L&&!Js&&Xs(ea,"name",{configurable:!0,get:function(){try{return ta.call(this).match(ra)[1]}catch(ky){return""}}}),It({target:"Date",stat:!0},{now:function(){return(new Date).getTime()}});var ia=_e("species"),na=function(e,t){var r,i=Re(e).constructor;return void 0===i||null==(r=Re(i)[ia])?t:function(e){if(Vt(e))return e;throw TypeError(re(e)+" is not a constructor")}(r)},oa=go.UNSUPPORTED_Y,sa=[].push,aa=Math.min;Oo("split",(function(e,t,r){var i;return i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var i=Ln(j(this)),n=void 0===r?4294967295:r>>>0;if(0===n)return[];if(void 0===e)return[i];if(!Ss(e))return t.call(i,e,n);for(var o,s,a,c=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),u=0,d=new RegExp(e.source,l+"g");(o=Ro.call(d,i))&&!((s=d.lastIndex)>u&&(c.push(i.slice(u,o.index)),o.length>1&&o.index<i.length&&sa.apply(c,o.slice(1)),a=o[0].length,u=s,c.length>=n));)d.lastIndex===o.index&&d.lastIndex++;return u===i.length?!a&&d.test("")||c.push(""):c.push(i.slice(u)),c.length>n?c.slice(0,n):c}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:t.call(this,e,r)}:t,[function(t,r){var n=j(this),o=null==t?void 0:ne(t,e);return o?o.call(t,n,r):i.call(Ln(n),t,r)},function(e,n){var o=Re(this),s=Ln(e),a=r(i,o,s,n,i!==t);if(a.done)return a.value;var c=na(o,RegExp),l=o.unicode,u=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(oa?"g":"y"),d=new c(oa?"^(?:"+o.source+")":o,u),h=void 0===n?4294967295:n>>>0;if(0===h)return[];if(0===s.length)return null===Uo(d,s)?[s]:[];for(var p=0,f=0,g=[];f<s.length;){d.lastIndex=oa?0:f;var m,_=Uo(d,oa?s.slice(f):s);if(null===_||(m=aa(st(d.lastIndex+(oa?f:0)),s.length))===p)f=Lo(s,f,l);else{if(g.push(s.slice(p,f)),g.length===h)return g;for(var v=1;v<=_.length-1;v++)if(g.push(_[v]),g.length===h)return g;f=p=m}}return g.push(s.slice(p)),g}]}),!!N((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2!==r.length||"a"!==r[0]||"b"!==r[1]})),oa);var ca=1..valueOf,la=function(e){return ca.call(e)},ua="\t\n\v\f\r                　\u2028\u2029\ufeff",da="["+ua+"]",ha=RegExp("^"+da+da+"*"),pa=RegExp(da+da+"*$"),fa=function(e){return function(t){var r=Ln(j(t));return 1&e&&(r=r.replace(ha,"")),2&e&&(r=r.replace(pa,"")),r}},ga={start:fa(1),end:fa(2),trim:fa(3)},ma=ft.f,_a=Ie.f,va=ke.f,Ea=ga.trim,Aa=O.Number,ya=Aa.prototype,Sa=function(e){var t=Ee(e,"number");return"bigint"==typeof t?t:Ca(t)},Ca=function(e){var t,r,i,n,o,s,a,c,l=Ee(e,"number");if(te(l))throw TypeError("Cannot convert a Symbol value to a number");if("string"==typeof l&&l.length>2)if(43===(t=(l=Ea(l)).charCodeAt(0))||45===t){if(88===(r=l.charCodeAt(2))||120===r)return NaN}else if(48===t){switch(l.charCodeAt(1)){case 66:case 98:i=2,n=49;break;case 79:case 111:i=8,n=55;break;default:return+l}for(s=(o=l.slice(2)).length,a=0;a<s;a++)if((c=o.charCodeAt(a))<48||c>n)return NaN;return parseInt(o,i)}return+l};if(Tt("Number",!Aa(" 0o1")||!Aa("0b1")||Aa("+0x1"))){for(var Ta,ba=function(e){var t=arguments.length<1?0:Aa(Sa(e)),r=this;return r instanceof ba&&N((function(){la(r)}))?yn(Object(t),r,ba):t},Ia=L?ma(Aa):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),Ra=0;Ia.length>Ra;Ra++)ue(Aa,Ta=Ia[Ra])&&!ue(ba,Ta)&&va(ba,Ta,_a(Aa,Ta));ba.prototype=ya,ya.constructor=ba,Je(O,"Number",ba)}var wa=ga.trim,ka=O.parseFloat,Oa=O.Symbol,Na=Oa&&Oa.iterator,La=1/ka(ua+"-0")!=-1/0||Na&&!N((function(){ka(Object(Na))}))?function(e){var t=wa(Ln(e)),r=ka(t);return 0===r&&"-"==t.charAt(0)?-0:r}:ka;It({global:!0,forced:parseFloat!=La},{parseFloat:La});var Pa,Da=window.navigator&&window.navigator.userAgent||"",Ma=/AppleWebKit\/([\d.]+)/i.exec(Da),xa=(Ma&&parseFloat(Ma.pop()),/iPad/i.test(Da)),Ba=navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&/Macintosh/.test(Da),Ua=/iPhone/i.test(Da)&&!xa,Fa=/iPod/i.test(Da),Va=Ua||xa||Fa||Ba,ja=/Android/i.test(Da),Ga=(ja&&function(){var e=Da.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),r=e[2]&&parseFloat(e[2]);t&&r&&parseFloat(e[1]+"."+e[2])}(),ja&&/webkit/i.test(Da),/Firefox/i.test(Da)),Ha=Ga&&function(){var e=Da.match(/Firefox\/(\d+)/);return e&&e[1]?parseFloat(e[1]):null}(),Qa=/Edge\//i.test(Da),Wa=Qa&&function(){var e=Da.match(/Edge\/(\d+)/i);if(e&&e[1])return e[1]}(),qa=/Edg\//i.test(Da),za=qa&&function(){var e=Da.match(/Edg\/(\d+)/);return e&&e[1]?parseFloat(e[1]):null}(),Za=/SogouMobileBrowser\//i.test(Da),Ya=Za&&function(){var e=Da.match(/SogouMobileBrowser\/(\d+)/);return e&&e[1]?parseFloat(e[1]):null}(),Ka=/MetaSr\s/i.test(Da),$a=Ka&&function(){var e=Da.match(/MetaSr(\s\d+(\.\d+)+)/);return e&&e[1]?parseFloat(e[1]):null}(),Ja=/TBS\/\d+/i.test(Da),Xa=Ja&&function(){var e=Da.match(/TBS\/(\d+)/i);if(e&&e[1])return e[1]}(),ec=/XWEB\/\d+/i.test(Da),tc=ec&&function(){var e=Da.match(/XWEB\/(\d+)/i);if(e&&e[1])return e[1]}(),rc=(/MSIE\s8\.0/.test(Da),/MSIE\/\d+/i.test(Da)&&function(){var e=/MSIE\s(\d+)\.\d/.exec(Da),t=e&&parseFloat(e[1]);!t&&/Trident\/7.0/i.test(Da)&&/rv:11.0/.test(Da)&&(t=11)}(),/(micromessenger|webbrowser)/i.test(Da)),ic=rc&&function(){var e=Da.match(/MicroMessenger\/(\d+)/i);if(e&&e[1])return e[1]}(),nc=!Ja&&/MQQBrowser\/\d+/i.test(Da)&&/COVC\/\d+/i.test(Da),oc=!Ja&&/MQQBrowser\/\d+/i.test(Da)&&!/COVC\/\d+/i.test(Da),sc=(oc||nc)&&function(){var e=Da.match(/ MQQBrowser\/([\d.]+)/);return e&&e[1]?e[1]:null}(),ac=!Ja&&/ QQBrowser\/\d+/i.test(Da),cc=ac&&function(){var e=Da.match(/ QQBrowser\/([\d.]+)/);return e&&e[1]?e[1]:null}(),lc=!Ja&&/QQBrowserLite\/\d+/i.test(Da),uc=lc&&function(){var e=Da.match(/QQBrowserLite\/([\d.]+)/);return e&&e[1]?e[1]:null}(),dc=!Ja&&/MQBHD\/\d+/i.test(Da),hc=dc&&function(){var e=Da.match(/MQBHD\/([\d.]+)/);return e&&e[1]?e[1]:null}(),pc=/Windows/i.test(Da),fc=!Va&&/MAC OS X/i.test(Da),gc=!ja&&/Linux/i.test(Da),mc=(/MicroMessenger/i.test(Da),/UCBrowser/i.test(Da)),_c=(/Electron/i.test(Da),/MiuiBrowser/i.test(Da)),vc=_c&&function(){var e=Da.match(/MiuiBrowser\/([\d.]+)/);return e&&e[1]?e[1]:null}(),Ec=/HuaweiBrowser/i.test(Da),Ac=/Huawei/i.test(Da),yc=Ec&&function(){var e=Da.match(/HuaweiBrowser\/([\d.]+)/);return e&&e[1]?e[1]:null}(),Sc=/SamsungBrowser/i.test(Da),Cc=Sc&&function(){var e=Da.match(/SamsungBrowser\/([\d.]+)/);return e&&e[1]?e[1]:null}(),Tc=/HeyTapBrowser/i.test(Da),bc=Tc&&function(){var e=Da.match(/HeyTapBrowser\/([\d.]+)/);return e&&e[1]?e[1]:null}(),Ic=/VivoBrowser/i.test(Da),Rc=Ic&&function(){var e=Da.match(/VivoBrowser\/([\d.]+)/);return e&&e[1]?e[1]:null}(),wc=function(){var e=Da.match(/Chrome\/(\d+)/);return e&&e[1]?Number(e[1]):null},kc=/Chrome/i.test(Da),Oc=!Qa&&!Ka&&!Za&&!Ja&&!ec&&!qa&&!ac&&!_c&&!Ec&&!Sc&&!Tc&&!Ic&&/Chrome/i.test(Da),Nc=Oc&&wc(),Lc=Oc&&function(){var e=Da.match(/Chrome\/([\d.]+)/);return e&&e[1]?e[1]:null}(),Pc=!kc&&!oc&&!nc&&!lc&&!dc&&/Safari/i.test(Da),Dc=Pc&&function(){var e=Da.match(/Version\/([\d.]+)/);return e&&e[1]?e[1]:null}(),Mc=/Android.*(wv|.0.0.0)/.test(Da),xc=Oc?"Chrome/"+Lc:Pc?"Safari/"+Dc:"NotSupportedBrowser",Bc="15.1"===function(){if(Ba)return Dc;if(Va){var e=Da.match(/OS (\d+)_(\d+)/i);if(e&&e[1]){var t=e[1];return e[2]&&(t+=".".concat(e[2])),t}}return null}(),Uc="file:"===location.protocol||"localhost"===location.hostname||"127.0.0.1"===location.hostname,Fc=function(){if(Yd(Pa))try{Pa=window.localStorage}catch(ky){Tf.warn(ky),Pa=!1}return Pa},Vc=new Map([[Ga,["Firefox",Ha]],[qa,["Edg",za]],[Oc,["Chrome",Lc]],[Pc,["Safari",Dc]],[Ja,["TBS",Xa]],[ec,["XWEB",tc]],[rc&&Ua,["WeChat",ic]],[ac,["QQ(Win)",cc]],[oc,["QQ(Mobile)",sc]],[nc,["QQ(Mobile X5)",sc]],[lc,["QQ(Mac)",uc]],[dc,["QQ(iPad)",hc]],[_c,["MI",vc]],[Ec,["HW",yc]],[Sc,["Samsung",Cc]],[Tc,["OPPO",bc]],[Ic,["VIVO",Rc]],[Qa,["EDGE",Wa]],[Za,["SogouMobile",Ya]],[Ka,["Sogou",$a]]]);function jc(){var e="unknown",t="unknown";return Vc.get(!0)&&(e=Vc.get(!0)[0],t=Vc.get(!0)[1]),{name:e,version:t}}var Gc=N((function(){fi(1)}));It({target:"Object",stat:!0,forced:Gc},{keys:function(e){return fi(ce(e))}});var Hc="wss://qcloud.rtc.qq.com",Qc="wss://bk.rtc.qq.com",Wc="wss://trtc.rtc.qq.com",qc="wss://webrtc.qq.com",zc="qcloud",Zc="trtc",Yc="webrtc",Kc="",$c=function(e){return Kc=e},Jc=1,Xc=2,el=20,tl=21,rl="5Y2wZK8nANNAoVw6dSAHVjNxrD1ObBM2kBPV",il="224d130c-7b5c-415b-aaa2-79c2eb5a6df2",nl=2,ol="DISCONNECTED",sl="CONNECTING",al="RECONNECTING",cl="CONNECTED",ll="new",ul="connecting",dl="failed",hl="closed",pl="disconnected",fl="connected",gl="completed",ml="join",_l="delta-join",vl="rejoin",El="leave",Al="delta-leave",yl="publish",Sl="delta-publish",Cl="unpublish",Tl="subscribe",bl="unsubscribe",Il="uplink-connection",Rl="uplink-reconnection",wl="downlink-connection",kl="downlink-reconnection",Ol="setLocalDescription",Nl="setRemoteDescription",Ll="iceConnectionState",Pl="stream-initialize",Dl="websocketConnectionState",Ml="websocketReconnectionState",xl="update-stream",Bl="recover-subscription",Ul="start-mix-transcode",Fl="stop-mix-transcode",Vl="player-error",jl="unsubscribe",Gl="subscribe_change",Hl={MANUAL:"manual",PRESET_LAYOUT:"preset-layout"},Ql={REMOTE:"$PLACE_HOLDER_REMOTE$"},Wl={IT_AUDIO_VIDEO:0,IT_PICTURE:2,IT_CANVAS:3,IT_PURE_AUDIO:4,IT_PURE_VIDEO:5},ql="string",zl="number",Zl="boolean",Yl="array",Kl="object",$l="canvas",Jl="audio",Xl="video",eu="auxiliary",tu="user",ru="environment",iu="mute",nu="unmute",ou="ended",su="playing",au="pause",cu="error",lu="loadeddata",uu="audioinput",du="videoinput",hu="detail",pu="text",fu="add",gu="remove",mu={unknown:0,wifi:1,"3g":2,"2g":3,"4g":4,wired:5},_u=-1,vu=0,Eu=1,Au="https://schedule.rtc.qq.com/api/v1/config",yu="TRTC",Su="Client",Cu="LocalStream",Tu="RemoteStream",bu="Stream",Iu="https://web.sdk.qcloud.com/trtc/webrtc/doc",Ru="".concat(Iu,"/zh-cn/"),wu={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,NONE:5},ku=Object.keys(wu),Ou=function(e,t){return function(){for(var r=new Array(arguments.length),i=0;i<r.length;i++)r[i]=arguments[i];return e.apply(t,r)}},Nu=Object.prototype.toString;function Lu(e){return"[object Array]"===Nu.call(e)}function Pu(e){return void 0===e}function Du(e){return null!==e&&"object"==typeof e}function Mu(e){return"[object Function]"===Nu.call(e)}function xu(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),Lu(e))for(var r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.call(null,e[n],n,e)}var Bu={isArray:Lu,isArrayBuffer:function(e){return"[object ArrayBuffer]"===Nu.call(e)},isBuffer:function(e){return null!==e&&!Pu(e)&&null!==e.constructor&&!Pu(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:Du,isUndefined:Pu,isDate:function(e){return"[object Date]"===Nu.call(e)},isFile:function(e){return"[object File]"===Nu.call(e)},isBlob:function(e){return"[object Blob]"===Nu.call(e)},isFunction:Mu,isStream:function(e){return Du(e)&&Mu(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:xu,merge:function e(){var t={};function r(r,i){"object"==typeof t[i]&&"object"==typeof r?t[i]=e(t[i],r):t[i]=r}for(var i=0,n=arguments.length;i<n;i++)xu(arguments[i],r);return t},deepMerge:function e(){var t={};function r(r,i){"object"==typeof t[i]&&"object"==typeof r?t[i]=e(t[i],r):t[i]="object"==typeof r?e({},r):r}for(var i=0,n=arguments.length;i<n;i++)xu(arguments[i],r);return t},extend:function(e,t,r){return xu(t,(function(t,i){e[i]=r&&"function"==typeof t?Ou(t,r):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}};function Uu(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var Fu=function(e,t,r){if(!t)return e;var i;if(r)i=r(t);else if(Bu.isURLSearchParams(t))i=t.toString();else{var n=[];Bu.forEach(t,(function(e,t){null!=e&&(Bu.isArray(e)?t+="[]":e=[e],Bu.forEach(e,(function(e){Bu.isDate(e)?e=e.toISOString():Bu.isObject(e)&&(e=JSON.stringify(e)),n.push(Uu(t)+"="+Uu(e))})))})),i=n.join("&")}if(i){var o=e.indexOf("#");-1!==o&&(e=e.slice(0,o)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e};function Vu(){this.handlers=[]}Vu.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},Vu.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},Vu.prototype.forEach=function(e){Bu.forEach(this.handlers,(function(t){null!==t&&e(t)}))};var ju=Vu,Gu=function(e,t,r){return Bu.forEach(r,(function(r){e=r(e,t)})),e},Hu=function(e){return!(!e||!e.__CANCEL__)},Qu="undefined"!=typeof t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function Wu(){throw new Error("setTimeout has not been defined")}function qu(){throw new Error("clearTimeout has not been defined")}var zu=Wu,Zu=qu;function Yu(e){if(zu===setTimeout)return setTimeout(e,0);if((zu===Wu||!zu)&&setTimeout)return zu=setTimeout,setTimeout(e,0);try{return zu(e,0)}catch(r){try{return zu.call(null,e,0)}catch(r){return zu.call(this,e,0)}}}"function"==typeof Qu.setTimeout&&(zu=setTimeout),"function"==typeof Qu.clearTimeout&&(Zu=clearTimeout);var Ku,$u=[],Ju=!1,Xu=-1;function ed(){Ju&&Ku&&(Ju=!1,Ku.length?$u=Ku.concat($u):Xu=-1,$u.length&&td())}function td(){if(!Ju){var e=Yu(ed);Ju=!0;for(var t=$u.length;t;){for(Ku=$u,$u=[];++Xu<t;)Ku&&Ku[Xu].run();Xu=-1,t=$u.length}Ku=null,Ju=!1,function(e){if(Zu===clearTimeout)return clearTimeout(e);if((Zu===qu||!Zu)&&clearTimeout)return Zu=clearTimeout,clearTimeout(e);try{Zu(e)}catch(t){try{return Zu.call(null,e)}catch(t){return Zu.call(this,e)}}}(e)}}function rd(e,t){this.fun=e,this.array=t}function id(){}rd.prototype.run=function(){this.fun.apply(null,this.array)};var nd=id,od=id,sd=id,ad=id,cd=id,ld=id,ud=id,dd=Qu.performance||{},hd=dd.now||dd.mozNow||dd.msNow||dd.oNow||dd.webkitNow||function(){return(new Date).getTime()},pd=new Date,fd={nextTick:function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];$u.push(new rd(e,t)),1!==$u.length||Ju||Yu(td)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:nd,addListener:od,once:sd,off:ad,removeListener:cd,removeAllListeners:ld,emit:ud,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*hd.call(dd),r=Math.floor(t),i=Math.floor(t%1*1e9);return e&&(r-=e[0],(i-=e[1])<0&&(r--,i+=1e9)),[r,i]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-pd)/1e3}},gd=function(e,t){Bu.forEach(e,(function(r,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[i])}))},md=function(e,t,r,i,n){return function(e,t,r,i,n){return e.config=t,r&&(e.code=r),e.request=i,e.response=n,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}(new Error(e),t,r,i,n)},_d=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],vd=Bu.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function i(e){var i=e;return t&&(r.setAttribute("href",i),i=r.href),r.setAttribute("href",i),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=i(window.location.href),function(t){var r=Bu.isString(t)?i(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0},Ed=Bu.isStandardBrowserEnv()?{write:function(e,t,r,i,n,o){var s=[];s.push(e+"="+encodeURIComponent(t)),Bu.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),Bu.isString(i)&&s.push("path="+i),Bu.isString(n)&&s.push("domain="+n),!0===o&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},Ad=function(e){return new Promise((function(t,r){var i=e.data,n=e.headers;Bu.isFormData(i)&&delete n["Content-Type"];var o=new XMLHttpRequest;if(e.auth){var s=e.auth.username||"",a=e.auth.password||"";n.Authorization="Basic "+btoa(s+":"+a)}var c,l,u=(c=e.baseURL,l=e.url,c&&!/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(l)?function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}(c,l):l);if(o.open(e.method.toUpperCase(),Fu(u,e.params,e.paramsSerializer),!0),o.timeout=e.timeout,o.onreadystatechange=function(){if(o&&4===o.readyState&&(0!==o.status||o.responseURL&&0===o.responseURL.indexOf("file:"))){var i="getAllResponseHeaders"in o?function(e){var t,r,i,n={};return e?(Bu.forEach(e.split("\n"),(function(e){if(i=e.indexOf(":"),t=Bu.trim(e.substr(0,i)).toLowerCase(),r=Bu.trim(e.substr(i+1)),t){if(n[t]&&_d.indexOf(t)>=0)return;n[t]="set-cookie"===t?(n[t]?n[t]:[]).concat([r]):n[t]?n[t]+", "+r:r}})),n):n}(o.getAllResponseHeaders()):null,n={data:e.responseType&&"text"!==e.responseType?o.response:o.responseText,status:o.status,statusText:o.statusText,headers:i,config:e,request:o};!function(e,t,r){var i=r.config.validateStatus;!i||i(r.status)?e(r):t(md("Request failed with status code "+r.status,r.config,null,r.request,r))}(t,r,n),o=null}},o.onabort=function(){o&&(r(md("Request aborted",e,"ECONNABORTED",o)),o=null)},o.onerror=function(){r(md("Network Error",e,null,o)),o=null},o.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),r(md(t,e,"ECONNABORTED",o)),o=null},Bu.isStandardBrowserEnv()){var d=Ed,h=(e.withCredentials||vd(u))&&e.xsrfCookieName?d.read(e.xsrfCookieName):void 0;h&&(n[e.xsrfHeaderName]=h)}if("setRequestHeader"in o&&Bu.forEach(n,(function(e,t){void 0===i&&"content-type"===t.toLowerCase()?delete n[t]:o.setRequestHeader(t,e)})),Bu.isUndefined(e.withCredentials)||(o.withCredentials=!!e.withCredentials),e.responseType)try{o.responseType=e.responseType}catch(f){if("json"!==e.responseType)throw f}"function"==typeof e.onDownloadProgress&&o.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&o.upload&&o.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){o&&(o.abort(),r(e),o=null)})),void 0===i&&(i=null),o.send(i)}))},yd={"Content-Type":"application/x-www-form-urlencoded"};function Sd(e,t){!Bu.isUndefined(e)&&Bu.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var Cd={adapter:function(){var e;return("undefined"!=typeof XMLHttpRequest||void 0!==fd&&"[object process]"===Object.prototype.toString.call(fd))&&(e=Ad),e}(),transformRequest:[function(e,t){return gd(t,"Accept"),gd(t,"Content-Type"),Bu.isFormData(e)||Bu.isArrayBuffer(e)||Bu.isBuffer(e)||Bu.isStream(e)||Bu.isFile(e)||Bu.isBlob(e)?e:Bu.isArrayBufferView(e)?e.buffer:Bu.isURLSearchParams(e)?(Sd(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):Bu.isObject(e)?(Sd(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(r){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Bu.forEach(["delete","get","head"],(function(e){Cd.headers[e]={}})),Bu.forEach(["post","put","patch"],(function(e){Cd.headers[e]=Bu.merge(yd)}));var Td=Cd;function bd(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var Id=function(e){return bd(e),e.headers=e.headers||{},e.data=Gu(e.data,e.headers,e.transformRequest),e.headers=Bu.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),Bu.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||Td.adapter)(e).then((function(t){return bd(e),t.data=Gu(t.data,t.headers,e.transformResponse),t}),(function(t){return Hu(t)||(bd(e),t&&t.response&&(t.response.data=Gu(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))},Rd=function(e,t){t=t||{};var r={},i=["url","method","params","data"],n=["headers","auth","proxy"],o=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];Bu.forEach(i,(function(e){void 0!==t[e]&&(r[e]=t[e])})),Bu.forEach(n,(function(i){Bu.isObject(t[i])?r[i]=Bu.deepMerge(e[i],t[i]):void 0!==t[i]?r[i]=t[i]:Bu.isObject(e[i])?r[i]=Bu.deepMerge(e[i]):void 0!==e[i]&&(r[i]=e[i])})),Bu.forEach(o,(function(i){void 0!==t[i]?r[i]=t[i]:void 0!==e[i]&&(r[i]=e[i])}));var s=i.concat(n).concat(o),a=Object.keys(t).filter((function(e){return-1===s.indexOf(e)}));return Bu.forEach(a,(function(i){void 0!==t[i]?r[i]=t[i]:void 0!==e[i]&&(r[i]=e[i])})),r};function wd(e){this.defaults=e,this.interceptors={request:new ju,response:new ju}}wd.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=Rd(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[Id,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)r=r.then(t.shift(),t.shift());return r},wd.prototype.getUri=function(e){return e=Rd(this.defaults,e),Fu(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},Bu.forEach(["delete","get","head","options"],(function(e){wd.prototype[e]=function(t,r){return this.request(Bu.merge(r||{},{method:e,url:t}))}})),Bu.forEach(["post","put","patch"],(function(e){wd.prototype[e]=function(t,r,i){return this.request(Bu.merge(i||{},{method:e,url:t,data:r}))}}));var kd=wd;function Od(e){this.message=e}Od.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},Od.prototype.__CANCEL__=!0;var Nd=Od;function Ld(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;e((function(e){r.reason||(r.reason=new Nd(e),t(r.reason))}))}Ld.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},Ld.source=function(){var e;return{token:new Ld((function(t){e=t})),cancel:e}};var Pd=Ld;function Dd(e){var t=new kd(e),r=Ou(kd.prototype.request,t);return Bu.extend(r,kd.prototype,t),Bu.extend(r,t),r}var Md=Dd(Td);Md.Axios=kd,Md.create=function(e){return Dd(Rd(Md.defaults,e))},Md.Cancel=Nd,Md.CancelToken=Pd,Md.isCancel=Hu,Md.all=function(e){return Promise.all(e)},Md.spread=function(e){return function(t){return e.apply(null,t)}};var xd=Md,Bd=Md;xd.default=Bd;var Ud=xd,Fd={INVALID_PARAMETER:4096,INVALID_OPERATION:4097,NOT_SUPPORTED:4098,DEVICE_NOT_FOUND:4099,INITIALIZE_FAILED:4100,SIGNAL_CHANNEL_SETUP_FAILED:16385,SIGNAL_CHANNEL_ERROR:16386,ICE_TRANSPORT_ERROR:16387,JOIN_ROOM_FAILED:16388,CREATE_OFFER_FAILED:16389,SIGNAL_CHANNEL_RECONNECTION_FAILED:16390,UPLINK_RECONNECTION_FAILED:16391,DOWNLINK_RECONNECTION_FAILED:16392,REMOTE_STREAM_NOT_EXIST:16400,CLIENT_BANNED:16448,SERVER_TIMEOUT:16449,SUBSCRIPTION_TIMEOUT:16450,PLAY_NOT_ALLOWED:16451,DEVICE_AUTO_RECOVER_FAILED:16452,START_PUBLISH_CDN_FAILED:16453,STOP_PUBLISH_CDN_FAILED:16454,START_MIX_TRANSCODE_FAILED:16455,STOP_MIX_TRANSCODE_FAILED:16456,NOT_SUPPORTED_H264:16457,SWITCH_ROLE_FAILED:16458,API_CALL_TIMEOUT:16459,UNKNOWN:65535},Vd=function(e){u(r,e);var t=_(r);function r(e){var i,n=e.name,o=void 0===n?"RtcError":n,a=e.message,c=e.code,l=void 0===c?Fd.UNKNOWN:c,u=e.extraCode,d=void 0===u?0:u;return s(this,r),(i=t.call(this,a+" <".concat(function(e){for(var t in Fd)if(Fd[t]===e)return t;return"UNKNOWN"}(l)," 0x").concat(l.toString(16),">"))).code_=l,i.extraCode_=d,i.name=o,i.message_=a,i}return c(r,[{key:"getCode",value:function(){return this.code_}},{key:"getExtraCode",value:function(){return this.extraCode_}}]),r}(g(Error)),jd=new(function(){function e(){s(this,e);var t=jc(),r=t.name,i=t.version;this.configs_={sdkAppId:"",userId:"",version:"4.11.12",env:zc,browserVersion:r+i,ua:navigator.userAgent}}return c(e,[{key:"setConfig",value:function(e){var t=e.sdkAppId,r=e.env,i=e.userId;t!==this.configs_.sdkAppId&&(this.configs_.sdkAppId=String(t)),this.configs_.env=r,this.configs_.userId=i}},{key:"logEvent",value:function(e){if(!Uc){var t=r(r(r({},e),this.configs_),{},{userId:e.userId||this.configs_.userId});Yd(t.code)&&(t.code="failed"===t.result?Fd.UNKNOWN:0),Ud.post(Qd(),JSON.stringify(t)).catch((function(){}))}}},{key:"logSuccessEvent",value:function(e){Uc||(this.logEvent(r(r({},e),{},{result:"success"})),this.configs_.env===zc&&this.uploadEventToKibana(r(r({},e),{},{result:"success"})))}},{key:"logFailedEvent",value:function(e){if(!Uc){var t=e.eventType,i=e.code,n=e.error,o={userId:e.userId,eventType:t,result:"failed",code:i||(n instanceof Vd?n.getExtraCode()||n.getCode():Fd.UNKNOWN)};this.logEvent(o),this.configs_.env===zc&&this.uploadEventToKibana(r(r({},o),{},{error:n}))}}},{key:"uploadEventToKibana",value:function(e){var t="stat-".concat(e.eventType,"-").concat(e.result);"delta-join"!==e.eventType&&"delta-leave"!==e.eventType&&"delta-publish"!==e.eventType||(t="".concat(e.eventType,":").concat(e.delta)),this.uploadEvent({log:t,userId:e.userId}),"failed"===e.result&&(t="stat-".concat(e.eventType,"-").concat(e.result,"-").concat(e.code),this.uploadEvent({log:t,userId:e.userId,error:e.error}))}},{key:"uploadEvent",value:function(e){var t=e.log,r=e.userId,i=e.error,n={timestamp:As(),sdkAppId:this.configs_.sdkAppId,userId:r||this.configs_.userId,version:this.configs_.version,log:t};i&&(n.errorInfo=i.message),Ud.post(Hd(),JSON.stringify(n)).catch((function(){}))}}]),e}()),Gd=function(){return function(e){var t=window.location.search.match(new RegExp("(\\?|&)"+e+"=([^&]*)(&|$)"));return t?decodeURIComponent(t[2]):""}("trtc_env")},Hd=function(){return"".concat(Kc||"https://yun.tim.qq.com","/v5/AVQualityReportSvc/C2S?sdkappid=1&cmdtype=jssdk_log")},Qd=function(){return"".concat(Kc||"https://yun.tim.qq.com","/v5/AVQualityReportSvc/C2S?sdkappid=1&cmdtype=jssdk_event")};function Wd(){var e=navigator.userAgent,t=navigator.connection,r=e.match(/NetType\/\w+/)?e.match(/NetType\/\w+/)[0]:"";"3gnet"===(r=r.toLowerCase().replace("nettype/",""))&&(r="3g");var i=t&&t.type&&t.type.toLowerCase(),n=t&&t.effectiveType&&t.effectiveType.toLowerCase();"slow-2"===n&&(n="2g");var o=r||"unknown";if(i)switch(i){case"cellular":case"wimax":o=n||"unknown";break;case"wifi":o="wifi";break;case"ethernet":o="wired";break;case"none":case"other":case"unknown":o="unknown"}return Tf.info("networkType:",o),o}var qd=function(e){if(!e||"object"!==i(e)||"[object Object]"!=Object.prototype.toString.call(e))return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var r=Object.prototype.hasOwnProperty.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Function.prototype.toString.call(r)===Function.prototype.toString.call(Object)};function zd(e){var t=Math.round(e/2)+1;return t>6?13e3:1e3*function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return t<=1?i:e(t-1,i,r+i)}(t)}var Zd=function(e){return"function"==typeof e},Yd=function(e){return void 0===e},Kd=function(e){return"string"==typeof e},$d=function(e){return"number"==typeof e},Jd=function(e){return"boolean"==typeof e},Xd=function(e){return eh(e)==="MediaStreamTrack".toLowerCase()};function eh(e){return Reflect.apply(Object.prototype.toString,e,[]).replace(/^\[object\s(\w+)\]$/,"$1").toLowerCase()}function th(e){var t={};return t.urls="turn:".concat(e.url),Yd(e.username)||Yd(e.credential)||(t.username=e.username,t.credential=e.credential,t.credentialType="password",Yd(e.credentialType)||(t.credentialType=e.credentialType)),t}function rh(){return performance&&performance.now?Math.floor(performance.now()):Date.now()}function ih(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"big";if(!Kd(e))return 0;var r=e.split(".");return"big"===t?(Number(r[0])<<24|Number(r[1])<<16|Number(r[2])<<8|Number(r[3]))>>>0:(Number(r[3])<<24|Number(r[2])<<16|Number(r[1])<<8|Number(r[0]))>>>0}function nh(e){return oh.apply(this,arguments)}function oh(){return(oh=o(regeneratorRuntime.mark((function e(t){var r,i,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={userId:String(t.userId),sdkAppId:String(t.sdkAppId),isStrGroupId:t.useStringRoomId,groupId:String(t.roomId),sdkVersion:"4.11.12",userSig:String(t.userSig)},i=rh(),e.next=5,Ud.post(Au,r,{timeout:1500});case 5:if(n=e.sent,jd.uploadEvent({log:"stat-schedule-delta:".concat(rh()-i),userId:t.userId}),0!==n.data.code){e.next=9;break}return e.abrupt("return",n.data.data);case 9:Tf.info("schedule failed: "+n.data.msg),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),Tf.info("schedule failed: "+e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}var sh,ah,ch,lh,uh,dh,hh=function(){var e=navigator.language||navigator.userLanguage;return"zh"===e.substr(0,2)},ph=(sh=!1,ah=document.visibilityState,function(){document.visibilityState!==ah&&Tf.info("visibility change: ".concat(document.visibilityState)),sh||(document.addEventListener("visibilitychange",(function(){Tf.info("visibility change: "+document.visibilityState),ah=document.visibilityState})),sh=!0)}),fh=I((function(e){var t=Object.prototype.hasOwnProperty,r="~";function i(){}function n(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,i,o,s){if("function"!=typeof i)throw new TypeError("The listener must be a function");var a=new n(i,o||e,s),c=r?r+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function a(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,i,n=[];if(0===this._eventsCount)return n;for(i in e=this._events)t.call(e,i)&&n.push(r?i.slice(1):i);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},a.prototype.listeners=function(e){var t=r?r+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,o=i.length,s=new Array(o);n<o;n++)s[n]=i[n].fn;return s},a.prototype.listenerCount=function(e){var t=r?r+e:e,i=this._events[t];return i?i.fn?1:i.length:0},a.prototype.emit=function(e,t,i,n,o,s){var a=r?r+e:e;if(!this._events[a])return!1;var c,l,u=this._events[a],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,i),!0;case 4:return u.fn.call(u.context,t,i,n),!0;case 5:return u.fn.call(u.context,t,i,n,o),!0;case 6:return u.fn.call(u.context,t,i,n,o,s),!0}for(l=1,c=new Array(d-1);l<d;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var h,p=u.length;for(l=0;l<p;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),d){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,i);break;case 4:u[l].fn.call(u[l].context,t,i,n);break;default:if(!c)for(h=1,c=new Array(d-1);h<d;h++)c[h-1]=arguments[h];u[l].fn.apply(u[l].context,c)}}return!0},a.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,i,n){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||n&&!a.once||i&&a.context!==i||s(this,o);else{for(var c=0,l=[],u=a.length;c<u;c++)(a[c].fn!==t||n&&!a[c].once||i&&a[c].context!==i)&&l.push(a[c]);l.length?this._events[o]=1===l.length?l[0]:l:s(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a})),gh=new fh,mh=1,_h=2,vh=3,Eh=4,Ah=5,yh=20,Sh=21,Ch=22,Th=23,bh=24,Ih=27,Rh=28,wh=29,kh=30,Oh=31,Nh=100,Lh=101,Ph=102,Dh=103,Mh=110,xh=111,Bh=112,Uh=113,Fh=114,Vh=115,jh=116,Gh=120,Hh=121,Qh=122,Wh=123,qh=130,zh=131,Zh=132,Yh=133,Kh=134,$h=135,Jh=136,Xh=137,ep=200,tp=201,rp=300,ip=301,np=O.Promise,op=/(?:ipad|iphone|ipod).*applewebkit/i.test(z),sp="process"==U(O.process),ap=O.setImmediate,cp=O.clearImmediate,lp=O.process,up=O.MessageChannel,dp=O.Dispatch,hp=0,pp={};try{ch=O.location}catch(ky){}var fp=function(e){if(pp.hasOwnProperty(e)){var t=pp[e];delete pp[e],t()}},gp=function(e){return function(){fp(e)}},mp=function(e){fp(e.data)},_p=function(e){O.postMessage(String(e),ch.protocol+"//"+ch.host)};ap&&cp||(ap=function(e){for(var t=[],r=arguments.length,i=1;r>i;)t.push(arguments[i++]);return pp[++hp]=function(){(H(e)?e:Function(e)).apply(void 0,t)},lh(hp),hp},cp=function(e){delete pp[e]},sp?lh=function(e){lp.nextTick(gp(e))}:dp&&dp.now?lh=function(e){dp.now(gp(e))}:up&&!op?(dh=(uh=new up).port2,uh.port1.onmessage=mp,lh=Rt(dh.postMessage,dh,1)):O.addEventListener&&H(O.postMessage)&&!O.importScripts&&ch&&"file:"!==ch.protocol&&!N(_p)?(lh=_p,O.addEventListener("message",mp,!1)):lh="onreadystatechange"in Ce("script")?function(e){mi.appendChild(Ce("script")).onreadystatechange=function(){mi.removeChild(this),fp(e)}}:function(e){setTimeout(gp(e),0)});var vp,Ep,Ap,yp,Sp,Cp,Tp,bp,Ip={set:ap,clear:cp},Rp=/ipad|iphone|ipod/i.test(z)&&void 0!==O.Pebble,wp=/web0s(?!.*chrome)/i.test(z),kp=Ie.f,Op=Ip.set,Np=O.MutationObserver||O.WebKitMutationObserver,Lp=O.document,Pp=O.process,Dp=O.Promise,Mp=kp(O,"queueMicrotask"),xp=Mp&&Mp.value;xp||(vp=function(){var e,t;for(sp&&(e=Pp.domain)&&e.exit();Ep;){t=Ep.fn,Ep=Ep.next;try{t()}catch(ky){throw Ep?yp():Ap=void 0,ky}}Ap=void 0,e&&e.enter()},op||sp||wp||!Np||!Lp?!Rp&&Dp&&Dp.resolve?((Tp=Dp.resolve(void 0)).constructor=Dp,bp=Tp.then,yp=function(){bp.call(Tp,vp)}):yp=sp?function(){Pp.nextTick(vp)}:function(){Op.call(O,vp)}:(Sp=!0,Cp=Lp.createTextNode(""),new Np(vp).observe(Cp,{characterData:!0}),yp=function(){Cp.data=Sp=!Sp}));var Bp,Up,Fp,Vp,jp=xp||function(e){var t={fn:e,next:void 0};Ap&&(Ap.next=t),Ep||(Ep=t,yp()),Ap=t},Gp=function(e){var t,r;this.promise=new e((function(e,i){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=i})),this.resolve=ie(t),this.reject=ie(r)},Hp={f:function(e){return new Gp(e)}},Qp=function(e){try{return{error:!1,value:e()}}catch(ky){return{error:!0,value:ky}}},Wp="object"==typeof window,qp=Ip.set,zp=_e("species"),Zp="Promise",Yp=ze.get,Kp=ze.set,$p=ze.getterFor(Zp),Jp=np&&np.prototype,Xp=np,ef=Jp,tf=O.TypeError,rf=O.document,nf=O.process,of=Hp.f,sf=of,af=!!(rf&&rf.createEvent&&O.dispatchEvent),cf=H(O.PromiseRejectionEvent),lf=!1,uf=Tt(Zp,(function(){var e=Me(Xp),t=e!==String(Xp);if(!t&&66===J)return!0;if(J>=51&&/native code/.test(e))return!1;var r=new Xp((function(e){e(1)})),i=function(e){e((function(){}),(function(){}))};return(r.constructor={})[zp]=i,!(lf=r.then((function(){}))instanceof i)||!t&&Wp&&!cf})),df=uf||!An((function(e){Xp.all(e).catch((function(){}))})),hf=function(e){var t;return!(!Q(e)||!H(t=e.then))&&t},pf=function(e,t){if(!e.notified){e.notified=!0;var r=e.reactions;jp((function(){for(var i=e.value,n=1==e.state,o=0;r.length>o;){var s,a,c,l=r[o++],u=n?l.ok:l.fail,d=l.resolve,h=l.reject,p=l.domain;try{u?(n||(2===e.rejection&&_f(e),e.rejection=1),!0===u?s=i:(p&&p.enter(),s=u(i),p&&(p.exit(),c=!0)),s===l.promise?h(tf("Promise-chain cycle")):(a=hf(s))?a.call(s,d,h):d(s)):h(i)}catch(ky){p&&!c&&p.exit(),h(ky)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&gf(e)}))}},ff=function(e,t,r){var i,n;af?((i=rf.createEvent("Event")).promise=t,i.reason=r,i.initEvent(e,!1,!0),O.dispatchEvent(i)):i={promise:t,reason:r},!cf&&(n=O["on"+e])?n(i):"unhandledrejection"===e&&function(e,t){var r=O.console;r&&r.error&&(1===arguments.length?r.error(e):r.error(e,t))}("Unhandled promise rejection",r)},gf=function(e){qp.call(O,(function(){var t,r=e.facade,i=e.value;if(mf(e)&&(t=Qp((function(){sp?nf.emit("unhandledRejection",i,r):ff("unhandledrejection",r,i)})),e.rejection=sp||mf(e)?2:1,t.error))throw t.value}))},mf=function(e){return 1!==e.rejection&&!e.parent},_f=function(e){qp.call(O,(function(){var t=e.facade;sp?nf.emit("rejectionHandled",t):ff("rejectionhandled",t,e.value)}))},vf=function(e,t,r){return function(i){e(t,i,r)}},Ef=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=2,pf(e,!0))},Af=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw tf("Promise can't be resolved itself");var i=hf(t);i?jp((function(){var r={done:!1};try{i.call(t,vf(Af,r,e),vf(Ef,r,e))}catch(ky){Ef(r,ky,e)}})):(e.value=t,e.state=1,pf(e,!1))}catch(ky){Ef({done:!1},ky,e)}}};if(uf&&(ef=(Xp=function(e){gn(this,Xp,Zp),ie(e),Bp.call(this);var t=Yp(this);try{e(vf(Af,t),vf(Ef,t))}catch(ky){Ef(t,ky)}}).prototype,(Bp=function(e){Kp(this,{type:Zp,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=Cn(ef,{then:function(e,t){var r=$p(this),i=of(na(this,Xp));return i.ok=!H(e)||e,i.fail=H(t)&&t,i.domain=sp?nf.domain:void 0,r.parent=!0,r.reactions.push(i),0!=r.state&&pf(r,!1),i.promise},catch:function(e){return this.then(void 0,e)}}),Up=function(){var e=new Bp,t=Yp(e);this.promise=e,this.resolve=vf(Af,t),this.reject=vf(Ef,t)},Hp.f=of=function(e){return e===Xp||e===Fp?new Up(e):sf(e)},H(np)&&Jp!==Object.prototype)){Vp=Jp.then,lf||(Je(Jp,"then",(function(e,t){var r=this;return new Xp((function(e,t){Vp.call(r,e,t)})).then(e,t)}),{unsafe:!0}),Je(Jp,"catch",ef.catch,{unsafe:!0}));try{delete Jp.constructor}catch(ky){}Hi&&Hi(Jp,ef)}function yf(e){var t=e.retryFunction,r=e.settings,i=e.onError,n=e.onRetrying,s=e.context;return function(){for(var e=this,a=arguments.length,c=new Array(a),l=0;l<a;l++)c[l]=arguments[l];var u=r.retries||5,d=0,h=-1,p=0,f=function(){var a=o(regeneratorRuntime.mark((function o(a,l){var g,m,_,v;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,g=s||e,o.next=4,t.apply(g,c);case 4:m=o.sent,d=0,a(m),o.next=14;break;case 9:o.prev=9,o.t0=o.catch(0),_=function(){clearTimeout(h),d=0,p=2,l(o.t0)},v=function(){2!==p&&d<u?(d++,p=1,Zd(n)&&n(d,_),h=setTimeout((function(){h=-1,f(a,l)}),r.timeout||1e3)):_()},i(o.t0,v,l);case 14:case"end":return o.stop()}}),o,null,[[0,9]])})));return function(e,t){return a.apply(this,arguments)}}();return new Promise(f)}}It({global:!0,wrap:!0,forced:uf},{Promise:Xp}),Fi(Xp,Zp,!1),bn(Zp),Fp=q(Zp),It({target:Zp,stat:!0,forced:uf},{reject:function(e){var t=of(this);return t.reject.call(void 0,e),t.promise}}),It({target:Zp,stat:!0,forced:uf},{resolve:function(e){return function(e,t){if(Re(e),Q(t)&&t.constructor===e)return t;var r=Hp.f(e);return(0,r.resolve)(t),r.promise}(this,e)}}),It({target:Zp,stat:!0,forced:df},{all:function(e){var t=this,r=of(t),i=r.resolve,n=r.reject,o=Qp((function(){var r=ie(t.resolve),o=[],s=0,a=1;fn(e,(function(e){var c=s++,l=!1;o.push(void 0),a++,r.call(t,e).then((function(e){l||(l=!0,o[c]=e,--a||i(o))}),n)})),--a||i(o)}));return o.error&&n(o.value),r.promise},race:function(e){var t=this,r=of(t),i=r.reject,n=Qp((function(){var n=ie(t.resolve);fn(e,(function(e){n.call(t,e).then(r.resolve,i)}))}));return n.error&&i(n.value),r.promise}});var Sf=function e(t){s(this,e),this.log=t.log,this.level=t.level,this.userId=t.userId,this.sdkAppId=t.sdkAppId,this.forAllJoinedClients=t.forAllJoinedClients,this.uploaded=!1},Cf=function(){function e(t){s(this,e),this.id_=t.id,this.userId_=t.userId,this.sdkAppId_=t.sdkAppId,this.type_=t.type,this.isLocal_=!Jd(t.isLocal)||t.isLocal}return c(e,[{key:"setUserId",value:function(e){this.userId_=e}},{key:"setSdkAppId",value:function(e){this.sdkAppId_=e}},{key:"log",value:function(e,t){Tf.log({log:"[".concat(this.isLocal_?"":"*").concat(this.id_,"] ").concat(this.type_?this.type_+" ":"").concat(t),level:e,forAllJoinedClients:Yd(this.userId_),userId:this.userId_,sdkAppId:this.sdkAppId_})}},{key:"info",value:function(e){this.log(wu.INFO,e)}},{key:"debug",value:function(e){this.log(wu.DEBUG,e)}},{key:"warn",value:function(e){this.log(wu.WARN,e)}},{key:"error",value:function(e){this.log(wu.ERROR,e)}}]),e}(),Tf=new(function(){function e(){var t=this;s(this,e),this.clients_=[],this.queue_=[],this.timeoutId_=-1,this.logLevel_=wu.DEBUG,this.logLevelToUpload_=wu.INFO,this.enableUploadLog_=!0,this.startUpload(),this.checkURLParam(),gh.on(kh,(function(e){var r=e.client;return t.clients_.push(r)})),gh.on(Oh,(function(e){e&&qd(e.config)&&ku[e.config.logLevelToUpload]&&(t.logLevelToUpload_=e.config.logLevelToUpload)}))}var t,r;return c(e,[{key:"startUpload",value:(r=o(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.upload();case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:this.timeoutId_=setTimeout((function(){return t.startUpload()}),2e3);case 8:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(){return r.apply(this,arguments)})},{key:"stopUpload",value:function(){-1!==this.timeoutId_&&(clearTimeout(this.timeoutId_),this.timeoutId_=-1)}},{key:"getLogsToUpload",value:function(){var e=this,t={map:new Map,splicedQueue:[]};if(this.queue_[0].forAllJoinedClients&&0===this.clients_.length)return t;for(var r=0,i=function(){if(50===r)return"break";var i=e.queue_[r];i.forAllJoinedClients?e.clients_.forEach((function(e){if(e.getIsJoined()){var r=e.getUserId(),n=e.getSDKAppId();t.map.has(r)?t.map.get(r).logs.push(i):t.map.set(r,{userId:r,sdkAppId:n,logs:[i]})}})):t.map.has(i.userId)?t.map.get(i.userId).logs.push(i):t.map.set(i.userId,{userId:i.userId,sdkAppId:i.sdkAppId,logs:[i]})};r<this.queue_.length;r++)if("break"===i())break;return t.map.size>0&&(t.splicedQueue=this.queue_.splice(0,r)),t}},{key:"upload",value:(t=o(regeneratorRuntime.mark((function e(){var t,r,i,n,o,s,a,c,l,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.queue_.length){e.next=2;break}return e.abrupt("return");case 2:if(t=this.getLogsToUpload(),r=t.map,i=t.splicedQueue,0!==r.size){e.next=5;break}return e.abrupt("return");case 5:e.prev=5,n=A(r.values()),o=0;case 8:if(!(o<n.length)){e.next=16;break}return s=n[o],a=s.userId,c=s.sdkAppId,l=s.logs,e.next=12,this.uploadLogWithRetry(JSON.stringify({timestamp:As(),sdkAppId:String(c),userId:a,version:"4.11.12",log:l.map((function(e){return e.log})).join("\n")}));case 12:l.forEach((function(e){return e.uploaded=!0}));case 13:o++,e.next=8;break;case 16:e.next=20;break;case 18:e.prev=18,e.t0=e.catch(5);case 20:(u=i.filter((function(e){return!e.uploaded}))).length>0&&(this.queue_=u.concat(this.queue_));case 22:case"end":return e.stop()}}),e,this,[[5,18]])}))),function(){return t.apply(this,arguments)})},{key:"uploadLogWithRetry",value:function(e){return yf({retryFunction:function(){return Ud.post(Hd(),e,{timeout:5e3})},settings:{retries:3,timeout:1e3},onError:function(e,t){t()}})()}},{key:"getPrefix",value:function(e){var t=new Date;return t.setTime(Es()),"[".concat(t.toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/,"$1"),":").concat(t.getMilliseconds(),"] <").concat(ku[e],">")}},{key:"getLogLevel",value:function(){return this.logLevel_}},{key:"setLogLevel",value:function(e){Yd(ku[e])||(this.logLevel_=e)}},{key:"enableUploadLog",value:function(){this.enableUploadLog_=!0}},{key:"disableUploadLog",value:function(){this.enableUploadLog_=!1}},{key:"log",value:function(e){var t=e.log,r=e.level,i=e.forAllJoinedClients,n=void 0===i||i,o=e.userId,s=e.sdkAppId;if(t="".concat(this.getPrefix(r)," ").concat(t),this.enableUploadLog_&&r>=this.logLevelToUpload_&&this.queue_.push(new Sf({log:t,level:r,userId:o,sdkAppId:s,forAllJoinedClients:n})),!(r<this.logLevel_))switch(r){case wu.ERROR:console.error(t);break;case wu.WARN:console.warn(t);break;case wu.INFO:console.log(t);break;case wu.DEBUG:console.debug(t)}}},{key:"debug",value:function(e){this.log({log:e,level:wu.DEBUG})}},{key:"info",value:function(e){this.log({log:e,level:wu.INFO})}},{key:"warn",value:function(e){this.log({log:e,level:wu.WARN})}},{key:"error",value:function(e){this.log({log:e,level:wu.ERROR})}},{key:"createLogger",value:function(e){return new Cf(e)}},{key:"checkURLParam",value:function(){var e=new URLSearchParams(location.search).get("logLevelToUpload");ku[e]&&(this.logLevelToUpload_=e)}}]),e}()),bf=!0,If=Math.floor,Rf=Number.isInteger||function(e){return!Q(e)&&isFinite(e)&&If(e)===e};It({target:"Number",stat:!0},{isInteger:Rf});var wf,kf=function(e){if(Ss(e))throw TypeError("The method doesn't accept regular expressions");return e},Of=_e("match"),Nf=function(e){var t=/./;try{"/./"[e](t)}catch(i){try{return t[Of]=!1,"/./"[e](t)}catch(n){}}return!1},Lf=Ie.f,Pf="".startsWith,Df=Math.min,Mf=Nf("startsWith"),xf=!(Mf||(wf=Lf(String.prototype,"startsWith"),!wf||wf.writable));It({target:"String",proto:!0,forced:!xf&&!Mf},{startsWith:function(e){var t=Ln(j(this));kf(e);var r=st(Df(arguments.length>1?arguments[1]:void 0,t.length)),i=Ln(e);return Pf?Pf.call(t,i,r):t.slice(r,r+i.length)===i}}),It({target:"Array",stat:!0},{isArray:wt});var Bf=ga.trim,Uf=O.parseInt,Ff=O.Symbol,Vf=Ff&&Ff.iterator,jf=/^[+-]?0[Xx]/,Gf=8!==Uf(ua+"08")||22!==Uf(ua+"0x16")||Vf&&!N((function(){Uf(Object(Vf))}))?function(e,t){var r=Bf(Ln(e));return Uf(r,t>>>0||(jf.test(r)?16:10))}:Uf;It({global:!0,forced:parseInt!=Gf},{parseInt:Gf});var Hf=[].slice,Qf={},Wf=function(e,t,r){if(!(t in Qf)){for(var i=[],n=0;n<t;n++)i[n]="a["+n+"]";Qf[t]=Function("C,a","return new C("+i.join(",")+")")}return Qf[t](e,r)},qf=Function.bind||function(e){var t=ie(this),r=Hf.call(arguments,1),i=function(){var n=r.concat(Hf.call(arguments));return this instanceof i?Wf(t,n.length,n):t.apply(e,n)};return Q(t.prototype)&&(i.prototype=t.prototype),i};It({target:"Function",proto:!0},{bind:qf});var zf=Wt.findIndex,Zf=!0;"findIndex"in[]&&Array(1).findIndex((function(){Zf=!1})),It({target:"Array",proto:!0,forced:Zf},{findIndex:function(e){return zf(this,e,arguments.length>1?arguments[1]:void 0)}}),wi("findIndex");var Yf=M.f,Kf=function(e){return function(t){for(var r,i=G(t),n=fi(i),o=n.length,s=0,a=[];o>s;)r=n[s++],L&&!Yf.call(i,r)||a.push(e?[r,i[r]]:i[r]);return a}},$f={entries:Kf(!0),values:Kf(!1)}.values;It({target:"Object",stat:!0},{values:function(e){return $f(e)}});var Jf=lt.includes;It({target:"Array",proto:!0},{includes:function(e){return Jf(this,e,arguments.length>1?arguments[1]:void 0)}}),wi("includes"),It({target:"String",proto:!0,forced:!Nf("includes")},{includes:function(e){return!!~Ln(j(this)).indexOf(Ln(kf(e)),arguments.length>1?arguments[1]:void 0)}});var Xf="connection-state-changed",eg="connected",tg="error",rg="DISCONNECTED",ig="CONNECTING",ng="RECONNECTING",og="CONNECTED",sg={ON_PUBLISH_RESPONSE:2,NEW_ICE_CANDIDATE:4,CLINET_BANNED:8,CHANNEL_SETUP_SUCCESS:19,CHANNEL_SETUP_FAILED:80,REBUILD_SESSION_RESULT:514,JOIN_ROOM_RESULT:20,PEER_JOIN:4134,PEER_LEAVE:4135,STREAM_ADDED:16,STREAM_REMOVED:18,UPDATE_REMOTE_SDP:48,UPDATE_AUDIO_SSRC:50,UPDATE_VIDEO_SSRC:52,UPLINK_NETWORK_STATS:22,UPDATE_REMOTE_MUTE_STAT:23,CLOSE_PEER_ACK:10,SUBSCRIBE_ACK:26,PONG:775,PUBLISH_RESULT:4098,UNPUBLISH_RESULT:4100,SUBSCRIBE_RESULT:4102,UNSUBSCRIBE_RESULT:4104,SUBSCRIBE_CHANGE_RESULT:4106,UPDATE_OFFER_RESULT:4128,REMOTE_STREAM_UPDATE:4130,START_PUBLISH_TENCENT_CDN_RES:1286,STOP_PUBLISH_TENCENT_CDN_RES:1288,START_PUBLISH_GIVEN_CDN_RES:777,STOP_PUBLISH_GIVEN_CDN_RES:779,START_MIX_TRANSCODE_RES:781,STOP_MIX_TRANSCODE_RES:783,USER_LIST_RES:4137,SWITCH_ROLE_RES:4110},ag=[sg.UPDATE_REMOTE_MUTE_STAT,sg.UPLINK_NETWORK_STATS,sg.PONG,sg.REMOTE_STREAM_UPDATE,sg.USER_LIST_RES],cg={ON_PUBLISH_RESPONSE:"on-publish-response",NEW_ICE_CANDIDATE:"new-ice-candidate",CLINET_BANNED:"client-banned",CHANNEL_SETUP_SUCCESS:"channel-setup-success",CHANNEL_SETUP_FAILED:"channel-setup-failed",REBUILD_SESSION_RESULT:"channel-reconnect-result",JOIN_ROOM_RESULT:"join-room-result",PEER_JOIN:"peer-join",PEER_LEAVE:"peer-leave",STREAM_ADDED:"stream-added",STREAM_REMOVED:"stream-removed",UPDATE_REMOTE_SDP:"update-remote-sdp",UPDATE_AUDIO_SSRC:"update-audio-ssrc",UPDATE_VIDEO_SSRC:"update-video-ssrc",UPLINK_NETWORK_STATS:"uplink-network-stats",UPDATE_REMOTE_MUTE_STAT:"update-remote-mute-stat",CLOSE_PEER_ACK:"close-peer-ack",SUBSCRIBE_ACK:"subscribe-ack",REQUEST_REBUILD_SESSION:"request-rebuild-session",CLIENT_REJOIN:"client-rejoin",PONG:"pong",PUBLISH_RESULT:"publish-result",UNPUBLISH_RESULT:"unpublish-result",SUBSCRIBE_RESULT:"subscribe-result",SUBSCRIBE_CHANGE_RESULT:"subscribe-change-result",UNSUBSCRIBE_RESULT:"unsubscribe-result",UPDATE_OFFER_RESULT:"update-offer-result",REMOTE_STREAM_UPDATE:"remote-stream-update",START_PUBLISH_TENCENT_CDN_RES:"start-publish-tencent-cdn-res",STOP_PUBLISH_TENCENT_CDN_RES:"stop-publish-tencent-cdn-res",START_PUBLISH_GIVEN_CDN_RES:"start-publish-given-cdn-res",STOP_PUBLISH_GIVEN_CDN_RES:"stop-publish-given-cdn-res",START_MIX_TRANSCODE_RES:"start-mix-transcode-res",STOP_MIX_TRANSCODE_RES:"stop-mix-transcode-res",USER_LIST_RES:"user-list-res",SWITCH_ROLE_RES:"switch_role_res"},lg="on_update_track",ug="on_create_room",dg="on_quit_room",hg="on_quality_report",pg="on_rebuild_session",fg="on_mute_uplink",gg="on_constraints_config",mg="ping",_g="on_publish",vg="on_unpublish",Eg="on_sub",Ag="on_unsub",yg="on_sub_change",Sg="on_start_publishing",Cg="on_stop_publishing",Tg="on_start_push_user_cdn",bg="on_stop_push_user_cdn",Ig="on_start_mcu_mix",Rg="on_stop_mcu_mix",wg="on_get_user_list",kg="on_switch_role",Og="on_change_video_type",Ng=32768,Lg=32769,Pg=32770,Dg=32771,Mg=32772,xg=32773,Bg=32774,Ug=32775,Fg=32777,Vg=32778,jg=32779,Gg=32780,Hg=32781,Qg=32782,Wg=32783,qg=32784,zg=32785,Zg=32786,Yg=32787,Kg=32788,$g=32789,Jg=32790,Xg=32791,em=32792,tm=32793,rm=32794,im=32795,nm=32796,om=32797,sm=32798,am=32799,cm=32800,lm=32801,um=32802,dm=new Map,hm=function(e,t){var r=dm.get(e);r||(dm.set(e,[]),r=dm.get(e)),r.push(t)},pm=Object.prototype.hasOwnProperty;function fm(e){if(null==e)return!0;if("boolean"==typeof e)return!1;if("number"==typeof e)return 0===e;if("string"==typeof e)return 0===e.length;if("function"==typeof e)return 0===e.length;if(Array.isArray(e))return 0===e.length;if(e instanceof Error)return""===e.message;if(qd(e))switch(Object.prototype.toString.call(e)){case"[object File]":case"[object Map]":case"[object Set]":return 0===e.size;case"[object Object]":for(var t in e)if(pm.call(e,t))return!1;return!0}return!1}var gm=/"/g,mm=function(e,t,r,i){var n=Ln(j(e)),o="<"+t;return""!==r&&(o+=" "+r+'="'+Ln(i).replace(gm,"&quot;")+'"'),o+">"+n+"</"+t+">"},_m=function(e){return N((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))};It({target:"String",proto:!0,forced:_m("link")},{link:function(e){return mm(this,"a","href",e)}});var vm="AVOID_REPEATED_CALL",Em="INVALID_PARAMETER_REQUIRED",Am="INVALID_PARAMETER_TYPE",ym="INVALID_PARAMETER_EMPTY",Sm="INVALID_PARAMETER_INSTANCE",Cm="INVALID_PARAMETER_RANGE",Tm="API_CALL_TIMEOUT",bm="SIGNAL_CHANNEL_RECONNECTION_FAILED",Im="SIGNAL_CHANNEL_SETUP_FAILED",Rm="ERROR_MESSAGE",wm="SUBSCRIPTION_TIMEOUT",km="EXCHANGE_SDP_TIMEOUT",Om="DOWNLINK_RECONNECTION_FAILED",Nm="EXCHANGE_SDP_FAILED",Lm="UPLINK_RECONNECTION_FAILED",Pm="AUDIO",Dm="VIDEO",Mm="INVALID_RECORDID",xm="INVALID_PURE_AUDIO",Bm="INVALID_STREAMID",Um="INVALID_USER_DEFINE_RECORDID",Fm="INVALID_USER_DEFINE_PUSH_ARGS",Vm="INVALID_PROXY",jm="INVALID_JOIN",Gm="INVALID_ROOMID_STRING",Hm="INVALID_ROOMID_INTEGER",Qm="INVALID_SIGNAL_CHANNEL",Wm="JOIN_ROOM_TIMEOUT",qm="JOIN_ROOM_FAILED",zm="REJOIN_ROOM_FAILED",Zm="INVALID_LEAVE",Ym="INVALID_PUBLISH",Km="INVALID_UNPUBLISH",$m="INVALID_AUDIENCE",Jm="INVALID_INITIALIZE",Xm="INVALID_DUPLICATE_PUBLISHING",e_="INVALID_REMOTE_STREAM",t_="SUBSCRIBE_FAILED",r_="INVALID_ROLE",i_="INVALID_OPERATION_SWITCH_ROLE",n_="SWITCH_ROLE_TIMEOUT",o_="SWITCH_ROLE_FAILED",s_="CLIENT_BANNED",a_="INVALID_OPERATION_START_PUBLISH_CDN",c_="INVALID_OPERATION_STOP_PUBLISH_CDN",l_="INVALID_STREAM_ID",u_="START_PUBLISH_CDN_FAILED",d_="STOP_PUBLISH_CDN_FAILED",h_="START_MIX_TRANSCODE",p_="STOP_MIX_TRANSCODE",f_="INVALID_AUDIO_VOLUME",g_="ENABLE_SMALL_STREAM_PUBLISHED",m_="DISABLE_SMALL_STREAM_PUBLISHED",__="NOT_SUPPORTED_SMALL_STREAM",v_="INVALID_SMALL_STREAM_PROFILE",E_="INVALID_PARAMETER_REMOTE_STREAM",A_="REMOTE_NOT_PUBLISH_SMALL_STREAM",y_="INVALID_SWITCH_DEVICE",S_="INVALID_SWITCH_DEVICE_PUBLISHING",C_="INVALID_REPLACE_TRACK",T_="INVALID_INITIALIZE_LOCAL_STREAM",b_="INVALID_ADD_TRACK_REPETITIVE",I_="INVALID_ADD_TRACK_REMOVING",R_="INVALID_ADD_TRACK_PUBLISHING",w_="INVALID_STREAM_INITIALIZED",k_="INVALID_ADD_TRACK_NUMBER",O_="INVALID_REMOVE_AUDIO_TRACK",N_="INVALID_REMOVE_AUDIO_ADDING",L_="INVALID_REMOVE_AUDIO_ON",P_="INVALID_REMOVE_TRACK_PUBLISHING",D_="INVALID_REMOVE_TRACK_NOT_PUBLISHING",M_="INVALID_REMOVE_TRACK_NUMBER",x_="INVALID_REMOVE_TRACK_NOT_PUBLISHED",B_="START_MIX_TRANSCODE_FAILED",U_="STOP_MIX_TRANSCODE_FAILED",F_="MIX_TRANSCODE_NOT_STARTED",V_="CANNOT_LESS_THAN_ZERO",j_="MIX_PARAMS_VIDEO_FRAMERATE",G_="MIX_PARAMS_VIDEO_GOP",H_="MIX_PARAMS_AUDIO_BITRATE",Q_="MIX_PARAMS_USER_Z_ORDER",W_="MIX_PARAMS_NOT_SELF",q_="MIX_PARAMS_USER_STREAM",z_="INVALID_PLAY",Z_="INVALID_CREATE_STREAM_SOURCE",Y_="INVALID_CREATE_STREAM_SCREEN",K_="INVALID_CREATE_STREAM_AUDIO",$_="INVALID_CREATE_STREAM_SCREEN_AUDIO",J_="NOT_SUPPORTED_HTTP",X_="NOT_SUPPORTED_WEBRTC",ev="NOT_SUPPORTED_PROFILE",tv="NOT_SUPPORTED_H264ENCODE",rv="NOT_SUPPORTED_H264DECODE",iv="NOT_SUPPORTED_REPLACE_TRACK",nv="NOT_SUPPORTED_CAPTURE",ov="MICROPHONE_NOT_FOUND",sv="CAMERA_NOT_FOUND",av={AVOID_REPEATED_CALL:function(e){return"previous ".concat(e.name,"() is ongoing, please avoid repeated calls.")},INVALID_PARAMETER_REQUIRED:function(e){var t=e.key,r=e.rule,i=e.fnName,n=e.value;return"'".concat(t||r.name,"' is a required param when calling ").concat(i,"(), received: ").concat(n,".")},INVALID_PARAMETER_TYPE:function(e){var t=e.key,r=e.rule,i=e.fnName,n=e.value,o="".concat(t||r.name),s="";return s=Array.isArray(r.type)?r.type.join("|"):r.type,"'".concat(o,"' must be type of ").concat(s," when calling ").concat(i,"(), received type: ").concat(eh(n),".")},INVALID_PARAMETER_EMPTY:function(e){var t=e.key,r=e.rule,i=e.fnName,n=e.value;return"'".concat(t||r.name,"' cannot be '").concat(n,"' when calling ").concat(i,"().")},INVALID_PARAMETER_INSTANCE:function(e){var t=e.key,r=e.rule,i=e.fnName,n=e.value,o="".concat(t||r.name),s="".concat(r.instanceOf.name||r.instanceOf);return"'".concat(o,"' must be instanceof ").concat(s," when calling ").concat(i,"(), received type: ").concat(eh(n),".")},INVALID_PARAMETER_RANGE:function(e){var t=e.key,r=e.rule,i=e.fnName,n=e.value;return"'".concat(t||r.name,"' must be one of ").concat(r.values.join("|")," when calling ").concat(i,"(), received: ").concat(n,".")},API_CALL_TIMEOUT:function(e){return"".concat(e.commandDesc||e.command," timeout observed.")},SIGNAL_CHANNEL_RECONNECTION_FAILED:"signal channel reconnection failed, please check your network.",SIGNAL_CHANNEL_SETUP_FAILED:function(e){return"SignalChannel setup failure: (errorCode: ".concat(e.errorCode,", errorMsg: ").concat(e.errorMsg," }).")},ERROR_MESSAGE:function(e){var t="".concat(e.type," failed");return e.message&&(t="".concat(t,": ").concat(e.message,".")),t},SUBSCRIPTION_TIMEOUT:"remote server does not respond to the subscription.",EXCHANGE_SDP_TIMEOUT:"exchange sdp timeout.",DOWNLINK_RECONNECTION_FAILED:"downlink reconnection failed, please check your network and re-join room.",EXCHANGE_SDP_FAILED:function(e){return"exchange sdp failed ".concat(e.errMsg,".")},UPDATE_OFFER_TIMEOUT:"update offer timeout observed.",UPLINK_RECONNECTION_FAILED:"uplink reconnection failed, please check your network and publish again.",AUDIO:function(e){return e.error.toString()+" <audio>"},VIDEO:function(e){return e.error.toString()+" <video>"},INVALID_RECORDID:"recordId must be an integer number.",INVALID_PURE_AUDIO:"pureAudioPushMode must be 1 or 2.",INVALID_STREAMID:"streamId must be a sting literal within 64 bytes, and not be empty.",INVALID_USER_DEFINE_RECORDID:"userDefineRecordId must be a sting literal contains (a-zA-Z),(0-9), underline and hyphen, within 64 bytes, and not be empty.",INVALID_USER_DEFINE_PUSH_ARGS:"userDefinePushArgs must be a sting literal within 256 bytes, and not be empty.",INVALID_PROXY:'proxy server url must start with "wss://".',INVALID_JOIN:"duplicate join() called.",INVALID_ROOMID_STRING:function(e){return"'".concat(e,"' must be validate string when useStringRoomId is true.")},INVALID_ROOMID_INTEGER:function(e){return"'".concat(e,"' must be an integer between [1, 4294967294] when useStringRoomId is false.")},INVALID_SIGNAL_CHANNEL:"SignalChannel is not ready yet.",JOIN_ROOM_TIMEOUT:"join room timeout.",JOIN_ROOM_FAILED:function(e){return"Failed to join room - "+e.error},REJOIN_ROOM_FAILED:function(e){return"reJoin room: ".concat(e.roomId," failed, please check your network.")},INVALID_LEAVE:"please call leave() before destroy().",INVALID_PUBLISH:"please call join() before publish().",INVALID_UNPUBLISH:"stream has not been published yet.",INVALID_AUDIENCE:"no permission to publish() under live/".concat("audience",', please call switchRole("').concat("anchor",'") firstly before publish().'),INVALID_INITIALIZE:"cannot publish stream because stream is not initialized or is switching device.",INVALID_DUPLICATE_PUBLISHING:"duplicate publishing, please unpublish and then re-publish.",INVALID_SUBSCRIBE_UNDEFINED:"stream is undefined or null.",INVALID_SUBSCRIBE_LOCAL:"stream cannot be LocalStream.",INVALID_REMOTE_STREAM:"remoteStream does not exist because it has been unpublished by remote peer.",SUBSCRIBE_FAILED:function(e){return"failed to subscribe stream, reason: ".concat(e.message,".")},INVALID_ROLE:"switchRole can only be called in live mode.",INVALID_PARAMETER_SWITCH_ROLE:"role could only be set to a value as ".concat("anchor"," or ").concat("audience","."),INVALID_OPERATION_SWITCH_ROLE:"please call join() before switchRole().",SWITCH_ROLE_TIMEOUT:"switchRole timeout.",SWITCH_ROLE_FAILED:function(e){return"switchRole failed, errCode: ".concat(e.errCode," errMsg: ").concat(e.errMsg,".")},CLIENT_BANNED:function(e){return"client was banned because of "+e.reason+"."},INVALID_OPERATION_START_PUBLISH_CDN:"please call publish() before startPublishCDNStream().",INVALID_OPERATION_STOP_PUBLISH_CDN:"please call startPublishCDNStream() before stopPublishCDNStream().",START_PUBLISH_CDN_FAILED:function(e){return"startPublishCDNStream failed, errMsg: ".concat(e.message,".")},STOP_PUBLISH_CDN_FAILED:function(e){return"stopPublishCDNStream failed, errMsg: ".concat(e.message,".")},INVALID_STREAM_ID:function(e){return"'".concat(e,"' can only consist of uppercase and lowercase english letters (a-zA-Z), numbers (0-9), hyphens and underscores.")},START_MIX_TRANSCODE:"please call startMixTranscode() after join().",STOP_MIX_TRANSCODE:"please call stopMixTranscode() after startMixTranscode().",INVALID_AUDIO_VOLUME:"interval must be a number.",ENABLE_SMALL_STREAM_PUBLISHED:"Cannot enable small stream after localStream published.",DISABLE_SMALL_STREAM_PUBLISHED:"Cannot disable small stream after localStream published.",NOT_SUPPORTED_SMALL_STREAM:"your browser does not support opening small stream.",INVALID_SMALL_STREAM_PROFILE:"small stream profile is invalid.",INVALID_PARAMETER_REMOTE_STREAM:"remoteStream is invalid.",REMOTE_NOT_PUBLISH_SMALL_STREAM:"remote peer does not publish small stream.",INVALID_SWITCH_DEVICE:"cannot switch device on current stream.",INVALID_SWITCH_DEVICE_PUBLISHING:"cannot switch device when publishing localStream.",INVALID_REPLACE_TRACK:"cannot replace track when publishing localStream.",INVALID_INITIALIZE_LOCAL_STREAM:"local stream has not initialized yet.",INVALID_ADD_TRACK_REPETITIVE:"previous addTrack is ongoing, please avoid repetitive execution.",INVALID_ADD_TRACK_REMOVING:"cannot add track when a track is removing.",INVALID_ADD_TRACK_PUBLISHING:"cannot add track when publishing localStream.",INVALID_STREAM_INITIALIZED:"your local stream haven't been initialized yet.",INVALID_ADD_TRACK_NUMBER:"a Stream has at most one audio track and one video track.",INVALID_REMOVE_AUDIO_TRACK:"remove audio track is not supported.",INVALID_REMOVE_AUDIO_ADDING:"cannot remove track when a track is adding.",INVALID_REMOVE_AUDIO_ON:"previous removeTrack is ongoing, please avoid repetitive execution.",INVALID_REMOVE_TRACK_PUBLISHING:"cannot remove track when publishing localStream.",INVALID_REMOVE_TRACK_NOT_PUBLISHING:"the track to be removed is not being publishing.",INVALID_REMOVE_TRACK_NUMBER:"remove the only video track is not supported, please use replaceTrack or muteVideo.",INVALID_REMOVE_TRACK_NOT_PUBLISHED:function(e){return"try to replace ".concat(e.kind," track but there's no previous ").concat(e.kind," being published.")},START_MIX_TRANSCODE_FAILED:function(e){return"startMixTranscode failed, errMsg: ".concat(e.message,".")},STOP_MIX_TRANSCODE_FAILED:function(e){return"stopMixTranscode failed, errMsg: ".concat(e.message,".")},MIX_TRANSCODE_NOT_STARTED:"mixTranscode has not been started.",CANNOT_LESS_THAN_ZERO:function(e){var t=e.key,r=e.rule,i=e.fnName;return e.value,"'".concat(t||r.name,"' cannot be less than 0 when calling ").concat(i,"().")},MIX_PARAMS_VIDEO_FRAMERATE:"'config.videoFramerate' should be an integer between 0 and 30, excluding 0.",MIX_PARAMS_VIDEO_GOP:"'config.videoGOP' should be an integer between 1 and 8.",MIX_PARAMS_AUDIO_BITRATE:"'config.audioBitrate' should be an integer between 32 and 192.",MIX_PARAMS_USER_Z_ORDER:function(e){return"'".concat(e,"' is required and must be between 1 and 15.")},MIX_PARAMS_NOT_SELF:"'config.mixUsers' must contain self.",MIX_PARAMS_USER_STREAM:"'config.videoWidth' and 'config.videoHeight' of output stream should be contain all mix stream.",INVALID_PLAY:"duplicate play() call observed, please stop() firstly.",INVALID_USERID:"userId cannot be all spaces.",INVALID_CREATE_STREAM_SOURCE:"LocalStream must be created by createStream() with either audio/video or audioSource/videoSource, but can not be mixed with audio/video and audioSource/videoSource.",INVALID_CREATE_STREAM_SCREEN:"screen/video cannot be both true.",INVALID_CREATE_STREAM_AUDIO:"audio/screenAudio cannot be both true.",INVALID_CREATE_STREAM_SCREEN_AUDIO:"when screen is true, screenAudio can be configured.",NOT_SUPPORTED_HTTP:"not supported in http protocol, please use https protocol.",NOT_SUPPORTED_WEBRTC:"your browser does NOT support WebRTC!",NOT_SUPPORTED_PROFILE:"your browser does not support setVideoProfile.",NOT_SUPPORTED_MEDIA:"your browser does not support navigator.mediaDevices.",NOT_SUPPORTED_H264ENCODE:"your device does not support H.264 encoding.",NOT_SUPPORTED_H264DECODE:"your device does not support H.264 decoding.",NOT_SUPPORTED_REPLACE_TRACK:"replaceTrack is not supported in this browser, please use switchDevice or addTrack instead.",NOT_SUPPORTED_CAPTURE:"captureScreen is not supported, please use chrome.",MICROPHONE_NOT_FOUND:"no microphone detected, please check your microphone and the configuration on TRTC.createStream.",CAMERA_NOT_FOUND:"no camera detected, please check your camera and the configuration on TRTC.createStream."},cv=Ru+"module-ErrorCode.html",lv=function(){if(!Fc())return!1;var e=localStorage.getItem("trtc_error_assistance");e&&!function(e){var t=e.saveTime&&(new Date).getTime()-e.saveTime>=6048e5,r=!e.saveVersion||"4.11.12"!==e.saveVersion;return t||r}(JSON.parse(e))||(Tf.log("request error info"),function(){var e=new XMLHttpRequest;if(e.open("GET","https://web.sdk.qcloud.com/trtc/webrtc/download/error-message/0.0.1/script.js",!1),e.send(null),4===e.readyState&&200===e.status){var t=document.createElement("script");t.type="text/javascript",t.text=e.responseText,document.body.appendChild(t),localStorage.setItem("trtc_error_assistance",JSON.stringify({message:e.responseText,saveTime:(new Date).getTime(),saveVersion:"4.11.12"})),document.body.removeChild(t)}}())};function uv(e){var t=e.key,r=e.data,i=e.link,n="",o="",s="";Zd(av[t])?n=av[t](r):Kd(av[t])&&(n=av[t]);var a=function(){if(window.TRTC_ERROR_INFO&&window.TRTC_ERROR_LINK)return{TRTC_ERROR_INFO:window.TRTC_ERROR_INFO,TRTC_ERROR_LINK:window.TRTC_ERROR_LINK};var e=localStorage.getItem("trtc_error_assistance");if(e){e=JSON.parse(e);var t=document.createElement("script");t.type="text/javascript",t.text=e.message,document.body.appendChild(t);var r=window.TRTC_ERROR_INFO,i=window.TRTC_ERROR_LINK;return document.body.removeChild(t),{TRTC_ERROR_INFO:r,TRTC_ERROR_LINK:i}}return{}}(),c=a.TRTC_ERROR_INFO,l=a.TRTC_ERROR_LINK;c&&c[t]&&(Zd(c[t])?o=c[t](r):Kd(c[t])&&(o=c[t])),i?s=Ru+"".concat(i.className,".html#").concat(i.className===yu?".":"").concat(i.fnName):l&&l[t]&&(s=Ru+l[t]);var u=n;return u+=" "+o,u+(o?s?"查看文档："+s:"查看文档："+cv:s?"Refer to："+s:"Refer to："+cv)}var dv=function(){function e(t){s(this,e),this.client_=t.client,this.sdkAppId_=t.sdkAppId,this.userId_=t.userId,this.userSig_=t.userSig,this.url_=t.url,this.backupUrl_=t.backupUrl,this.version_=t.version,this.urlWithParam_="".concat(this.url_,"?sdkAppid=").concat(this.sdkAppId_,"&identifier=").concat(this.userId_,"&userSig=").concat(this.userSig_),this.backupUrlWithParam_="".concat(this.backupUrl_,"?sdkAppid=").concat(this.sdkAppId_,"&identifier=").concat(this.userId_,"&userSig=").concat(this.userSig_),this.isConnected_=!1,this.isConnecting_=!1,this.socketInUse_=null,this.socket_=null,this.backupSocket_=null,this.backupTimer_=-1,this.signalInfo_={},this.currentState_=rg,this.reconnectionCount_=0,this.reconnectionTimer_=-1,this.seq_=0,this.log_=Tf.createLogger({id:"ws|"+this.userId_,userId:this.userId_,sdkAppId:this.sdkAppId_}),this.pingPongTimeoutId_=-1,this.pingTimeoutId_=-1,this.emitter_=new fh}var t;return c(e,[{key:"connect",value:function(){var e=this;this.log_.info("connect to url: ".concat(this.urlWithParam_)),this.emitter_.emit(Xf,{prevState:this.currentState_,state:ig}),this.currentState_=ig,this.socket_=new WebSocket(this.urlWithParam_),this.bindSocket(this.socket_),this.backupTimer_=setTimeout((function(){e.isConnected_||(e.log_.info("trying to connect to backupUrl"),e.tryConnectBackup())}),5e3)}},{key:"tryConnectBackup",value:function(){this.backupSocket_||(this.unbindAndCloseSocket("main"),this.log_.debug("try to connect to url: ".concat(this.backupUrlWithParam_)),this.backupSocket_=new WebSocket(this.backupUrlWithParam_),this.bindSocket(this.backupSocket_))}},{key:"bindSocket",value:function(e){e.onopen=this.onopen.bind(this),e.onclose=this.onclose.bind(this),e.onerror=this.onerror.bind(this),e.onmessage=this.onmessage.bind(this)}},{key:"unbindSocket",value:function(e){e.onopen=function(){},e.onclose=function(){},e.onerror=function(){},e.onmessage=function(){}}},{key:"unbindAndCloseSocket",value:function(e){if("main"===e){if(this.socket_){this.unbindSocket(this.socket_);try{this.socket_.close(1e3)}catch(ky){}this.socket_=null}}else if(this.backupSocket_){this.unbindSocket(this.backupSocket_);try{this.backupSocket_.close(1e3)}catch(ky){}this.backupSocket_=null}}},{key:"clearBackupTimer",value:function(){-1!==this.backupTimer_&&(clearTimeout(this.backupTimer_),this.backupTimer_=-1)}},{key:"clearReconnectionTimer",value:function(){-1!==this.reconnectionTimer_&&(clearTimeout(this.reconnectionTimer_),this.reconnectionTimer_=-1)}},{key:"onopen",value:function(e){if(!this.isConnected_){this.isConnected_=!0,this.isConnecting_=!1,this.clearBackupTimer(),e.target===this.socket_?(this.unbindAndCloseSocket("backup"),this.socketInUse_=this.socket_):(this.unbindAndCloseSocket("main"),this.socketInUse_=this.backupSocket_);var t=e.target.url;this.log_.info("websocket[".concat(t,"] is connected")),this.emitter_.emit(Xf,{prevState:this.currentState_,state:og}),this.currentState_===ig?this.addSignalEvent(Xg,"signal channel is connected"):this.currentState_===ng&&this.addSignalEvent(im,"signal channel reconnect success"),this.currentState_=og,this.emitter_.emit(eg)}}},{key:"onclose",value:function(e){var t=e.target.url,r=e.target===this.socketInUse_;this.log_.info("websocket[".concat(t," InUse: ").concat(r,"] is closed with code: ").concat(e.code)),e.target===this.socketInUse_&&(this.isConnected_=!1,e.wasClean&&1e3===e.code?(this.emitter_.emit(Xf,{prevState:this.currentState_,state:rg}),this.currentState_=rg,this.addSignalEvent(Jg,"signal channel is disconnected")):(this.log_.warn("onclose code:".concat(e.code," reason:").concat(e.reason)),this.log_.warn("close current websocket and schedule a reconnect timeout"),this.socketInUse_.onclose=function(){},this.socketInUse_.close(4011),this.socket_=this.backupSocket_=this.socketInUse_=null,this.reconnect("main")))}},{key:"onerror",value:function(e){var t=e.target.url;this.log_.error("websocket[".concat(t,"] error observed")),this.isConnected_?e.target===this.socketInUse_&&(this.isConnected_=!1,this.unbindAndCloseSocket("main"),this.unbindAndCloseSocket("backup"),this.socketInUse_=null,this.reconnect("main")):(this.isReconnecting_||jd.logFailedEvent({userId:this.client_.getUserId(),eventType:Dl,code:Fd.UNKNOWN}),e.target==this.socket_?(this.unbindAndCloseSocket("main"),this.reconnect("backup")):(this.unbindAndCloseSocket("backup"),this.reconnect("main"))),this.isConnecting_=!1,this.isConnected_=!1}},{key:"onmessage",value:function(e){var t=this;if(this.isConnected_){var r=JSON.parse(e.data),i=r.cmd,n=r.content,o=Object.values(sg),s=Object.keys(sg)[o.indexOf(i)],a=cg[s];if(!ag.includes(i)){var c=e.target==this.socket_?this.url_:this.backupUrl_;if(this.log_.debug("websocket[".concat(c,"] received message: ").concat(e.data)),this.log_.info("Received event: [ ".concat(a||"unknown cmd: "+i," ]")),(a===cg.UPDATE_REMOTE_SDP||a===cg.UPDATE_AUDIO_SSRC||a===cg.UPDATE_VIDEO_SSRC)&&n.offersdp)try{var l=JSON.parse(n.offersdp),u=l.audiossrc,d=l.videossrc,h=l.rtxssrc;this.log_.info("ssrc info in offersdp: [ audiossrc: ".concat(u," videossrc: ").concat(d," rtxssrc: ").concat(h," ]"))}catch(g){}}switch(i){case sg.CHANNEL_SETUP_SUCCESS:this.signalInfo_.relayIp=n.relayip,this.signalInfo_.relayInnerIp=n.innerip,this.signalInfo_.signalIp=n.signalip,this.signalInfo_.localIp=n.localip,this.signalInfo_.dataPort=n.dataport,this.signalInfo_.stunPort=n.stunport,this.signalInfo_.checkSigSeq=n.checkSigSeq,this.signalInfo_.socketId=n.socketid,this.signalInfo_.tinyId=n.tinyid,this.signalInfo_.openId=n.openid,this.signalInfo_.stunPortList=n.stunportList,!n.stunportList||n.stunportList.length<=0?this.signalInfo_.stunServers="stun:"+n.relayip+":"+n.stunport:(this.signalInfo_.stunServers=[],n.stunportList.forEach((function(e){var r="stun:"+n.relayip+":"+e;t.signalInfo_.stunServers.push(r)}))),n.cgiurl&&(this.signalInfo_.logCgiUrl=n.cgiurl),n.svrTime&&function(e){vs=e-(new Date).getTime();var t=new Date;t.setTime(e),Tf.info("baseTime from server: "+t+" offset: "+vs)}(n.svrTime),this.log_.info("ChannelSetup Success: signalIp:".concat(n.signalip," relayIp:").concat(n.relayip," clientIp:").concat(n.localip," checkSigSeq:").concat(n.checkSigSeq)),this.log_.info("start ping pong"),this.startPingPong(),this.isReconnecting_&&(this.reconnectionCount_=0,this.clearReconnectionTimer(),1===n.rc&&this.emitter_.emit(cg.REQUEST_REBUILD_SESSION,{signalInfo:this.signalInfo_})),this.emitter_.emit(a,{signalInfo:this.signalInfo_});break;case sg.REBUILD_SESSION_RESULT:0===n.result?(this.log_.info("reconnect - rebuild session succeeded"),this.client_.checkConnectionsToReconnect()):(this.emitter_.emit(cg.CLIENT_REJOIN),this.log_.error("reconnect - rebuild session failed: ".concat(JSON.stringify(n))));break;case sg.CHANNEL_SETUP_FAILED:if(!this.isReconnecting_){var p="sdkAppId invalid",f="";Yd(n.errorCode)||(p=n.errorCode,f=n.errorMsg);var g=new Vd({code:Fd.SIGNAL_CHANNEL_SETUP_FAILED,extraCode:p,message:uv({key:Im,data:{errorCode:p,errorMsg:f}})});this.close(),jd.logFailedEvent({userId:this.client_.getUserId(),eventType:Dl,error:g}),this.emitter_.emit(tg,g)}break;default:this.emitter_.emit(a,{data:r})}}}},{key:"addSignalEvent",value:function(e,t){hm(this.userId_,{eventId:e,eventDesc:t,timestamp:Es(),userId:this.userId_,tinyId:this.signalInfo_.tinyId})}},{key:"reconnect",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";if(this.isConnecting_||-1!==this.reconnectionTimer_)this.log_.info("signal channel is reconnecting, ignoring current reconnection");else{if(this.reconnectionCount_>=30){this.log_.warn("SDK has tried reconnect signal channel for ".concat(30," times, but all failed. please check your network"));var r=new Vd({code:Fd.SIGNAL_CHANNEL_RECONNECTION_FAILED,message:uv({key:bm})});return jd.logFailedEvent({userId:this.client_.getUserId(),eventType:Ml,error:r}),this.addSignalEvent(nm,"signal channel reconnect fail"),void this.emitter_.emit(tg,r)}this.isConnecting_=!0,this.reconnectionCount_++,this.currentState_!==ng&&(this.emitter_.emit(Xf,{prevState:this.currentState_,state:ng}),this.currentState_=ng,this.addSignalEvent(rm,"signal channel is reconnecting")),this.log_.warn("reconnecting to ".concat(t," signal channel [").concat(this.reconnectionCount_,"/").concat(30,"]"));var i=this.getReconnectionUrl(t);"main"===t?(this.socket_=new WebSocket(i),this.bindSocket(this.socket_)):(this.backupSocket_=new WebSocket(i),this.bindSocket(this.backupSocket_));var n=zd(this.reconnectionCount_);this.reconnectionTimer_=setTimeout((function(){e.log_.warn("reconnect ".concat(t," signal channel timeout(").concat(n/1e3,"s), close and try again")),e.isConnecting_=!1,e.clearReconnectionTimer(),e.unbindAndCloseSocket(t),e.reconnect("main"===t?"backup":"main")}),n)}}},{key:"isConnected",value:function(){return this.isConnected_}},{key:"isReconnecting_",get:function(){return-1!==this.reconnectionTimer_}},{key:"getReconnectionUrl",value:function(e){var t="main"===e?this.urlWithParam_:this.backupUrlWithParam_;return fm(this.signalInfo_)||-1!==t.indexOf("&rc=1")||(t+="&iip="+this.signalInfo_.relayInnerIp+"&dp="+this.signalInfo_.dataPort+"&oip="+this.signalInfo_.relayIp+"&sp="+this.signalInfo_.stunPort+"&rc=1"),t}},{key:"send",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if(this.isConnected_){var i=this.createSendMessage(e);return i.data=t,void 0!==r&&(i.srctinyid=r),this.socketInUse_.send(JSON.stringify(i)),i.seq}}},{key:"sendWithoutUA",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0;if(this.isConnected_){var i=this.createSendMessage(e,!1);return i.data=t,void 0!==r&&(i.srctinyid=r),this.socketInUse_.send(JSON.stringify(i)),i.seq}}},{key:"sendWithReport",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0;if(this.isConnected_){var i=this.createSendMessage(e);return i.data=t,i.report=r,this.socketInUse_.send(JSON.stringify(i)),i.seq}}},{key:"sendWaitForResponse",value:function(e){var t=this,r=e.command,i=e.data,n=e.timeout,o=void 0===n?5e3:n,s=e.responseCommand,a=e.commandDesc,c=e.retry,l=void 0===c?0:c,u=0;return new Promise((function(e,n){var c,d,h=function(){if(u<l)return u++,t.log_.warn("".concat(a," timeout observed, retrying [").concat(u,"/").concat(l,"]")),void f();t.off(s,p);var e=new Vd({code:Fd.API_CALL_TIMEOUT,message:uv({key:Tm,data:{commandDesc:a,command:r}})});t.log_.warn(e),n(e)},p=function r(i){i.data.seq===d&&(clearTimeout(c),t.off(s,r),e(i))},f=function(){c=setTimeout(h,o),d=t.send(r,i,0)};t.on(s,p),f()}))}},{key:"startPingPong",value:(t=o(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,-1===this.pingPongTimeoutId_){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.ping();case 5:this.pingPongTimeoutId_=setTimeout((function(){t.pingPongTimeoutId_=-1,t.startPingPong()}),1e4),this.client_.isRelayMaybeFailed()&&this.emitter_.emit(cg.CLIENT_REJOIN),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),this.log_.warn("ping-pong failed, start signal reconnection"),this.close(),this.reconnect("main");case 14:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(){return t.apply(this,arguments)})},{key:"stopPingPong",value:function(){this.log_.info("stop ping pong"),clearTimeout(this.pingTimeoutId_),clearTimeout(this.pingPongTimeoutId_),this.pingTimeoutId_=-1,this.pingPongTimeoutId_=-1}},{key:"ping",value:function(){var e=this;return new Promise((function(t,r){if(-1!==e.pingTimeoutId_)return t();e.sendWithoutUA(mg),e.once(cg.PONG,(function(){clearTimeout(e.pingTimeoutId_),e.pingTimeoutId_=-1,t()})),e.pingTimeoutId_=setTimeout((function(){e.pingTimeoutId_=-1,r()}),1e4)}))}},{key:"createSendMessage",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r={tag_key:e,data:"",openid:this.userId_,tinyid:this.signalInfo_.tinyId,version:this.version_,seq:++this.seq_};return t&&(r.ua=navigator.userAgent),r}},{key:"getCurrentState",value:function(){return this.currentState_}},{key:"getSocketId",value:function(){return this.signalInfo_.socketId}},{key:"close",value:function(){this.log_.info("close SignalChannel"),this.clearBackupTimer(),this.clearReconnectionTimer(),this.stopPingPong(),this.isConnecting_=!1,this.isConnected_=!1,this.socketInUse_=null,this.unbindAndCloseSocket("main"),this.unbindAndCloseSocket("backup")}},{key:"on",value:function(e,t,r){this.emitter_.on(e,t,r)}},{key:"removeListener",value:function(e,t,r){this.emitter_.removeListener(e,t,r)}},{key:"once",value:function(e,t,r){this.emitter_.once(e,t,r)}},{key:"off",value:function(e,t,r){this.emitter_.off(e,t,r)}}]),e}(),hv=Wt.find,pv=!0;"find"in[]&&Array(1).find((function(){pv=!1})),It({target:"Array",proto:!0,forced:pv},{find:function(e){return hv(this,e,arguments.length>1?arguments[1]:void 0)}}),wi("find"),Sn("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),On);var fv=I((function(e){var t=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+(null!=e["network-cost"]?" network-cost %d":"%v")}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",t+=null!=e.rateNumerator?" rate=%s":"",t+(null!=e.rateDenominator?"/%s":"")}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(t).forEach((function(e){t[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}))})),gv=(fv.v,fv.o,fv.s,fv.i,fv.u,fv.e,fv.p,fv.z,fv.r,fv.t,fv.c,fv.b,fv.m,fv.a,I((function(e,t){var r=function(e){return String(Number(e))===e?Number(e):e},i=function(e,t,i){var n=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:n&&!t[e.name]&&(t[e.name]={});var o=e.push?{}:n?t[e.name]:t;!function(e,t,i,n){if(n&&!i)t[n]=r(e[1]);else for(var o=0;o<i.length;o+=1)null!=e[o+1]&&(t[i[o]]=r(e[o+1]))}(i.match(e.reg),o,e.names,e.name),e.push&&t[e.push].push(o)},n=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},r=[],o=t;return e.split(/(\r\n|\r|\n)/).filter(n).forEach((function(e){var t=e[0],n=e.slice(2);"m"===t&&(r.push({rtp:[],fmtp:[]}),o=r[r.length-1]);for(var s=0;s<(fv[t]||[]).length;s+=1){var a=fv[t][s];if(a.reg.test(n))return i(a,o,n)}})),t.media=r,t};var o=function(e,t){var i=t.split(/=(.+)/,2);return 2===i.length?e[i[0]]=r(i[1]):1===i.length&&t.length>1&&(e[i[0]]=void 0),e};t.parseParams=function(e){return e.split(/;\s?/).reduce(o,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],i=e.split(" ").map(r),n=0;n<i.length;n+=3)t.push({component:i[n],ip:i[n+1],port:i[n+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(o,{})}))},t.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var t,i=!1;return"~"!==e[0]?t=r(e):(t=r(e.substring(1,e.length)),i=!0),{scid:t,paused:i}}))}))}}))),mv=(gv.parse,gv.parseParams,gv.parseFmtpConfig,gv.parsePayloads,gv.parseRemoteCandidates,gv.parseImageAttributes,gv.parseSimulcastStreamList,/%[sdv%]/g),_v=function(e){var t=1,r=arguments,i=r.length;return e.replace(mv,(function(e){if(t>=i)return e;var n=r[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(n);case"%d":return Number(n);case"%v":return""}}))},vv=function(e,t,r){var i=[e+"="+(t.format instanceof Function?t.format(t.push?r:r[t.name]):t.format)];if(t.names)for(var n=0;n<t.names.length;n+=1){var o=t.names[n];t.name?i.push(r[t.name][o]):i.push(r[t.names[n]])}else i.push(r[t.name]);return _v.apply(null,i)},Ev=["v","o","s","i","u","e","p","c","b","t","r","z","a"],Av=["i","c","b","a"],yv={write:function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var r=t.outerOrder||Ev,i=t.innerOrder||Av,n=[];return r.forEach((function(t){fv[t].forEach((function(r){r.name in e&&null!=e[r.name]?n.push(vv(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach((function(e){n.push(vv(t,r,e))}))}))})),e.media.forEach((function(e){n.push(vv("m",fv.m[0],e)),i.forEach((function(t){fv[t].forEach((function(r){r.name in e&&null!=e[r.name]?n.push(vv(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach((function(e){n.push(vv(t,r,e))}))}))}))})),n.join("\r\n")+"\r\n"},parse:gv.parse,parseParams:gv.parseParams,parseFmtpConfig:gv.parseFmtpConfig,parsePayloads:gv.parsePayloads,parseRemoteCandidates:gv.parseRemoteCandidates,parseImageAttributes:gv.parseImageAttributes,parseSimulcastStreamList:gv.parseSimulcastStreamList},Sv=function(e){return yv.parse(e)},Cv=function(e){return yv.write(e)},Tv=function(e){var t=Sv(e);return t.media.forEach((function(e){e.type===Jl&&e.fmtp.forEach((function(e){e.config+=";sprop-stereo=1;stereo=1"}))})),Cv(t)};function bv(e){var t=Sv(e);return t.media.forEach((function(e){if(e.type===Xl){var t=new Set;e.rtp.forEach((function(e){var r=e.payload;return"H264"===e.codec&&t.add(r)})),e.fmtp.forEach((function(e){var r=e.payload,i=e.config.match(/apt=(\d+)/);i&&i[1]&&t.has(Number(i[1]))&&t.add(r)}));var r=function(e){var r=e.payload;return!t.has(r)};e.rtp=e.rtp.filter(r),e.rtcpFb=e.rtcpFb.filter(r),e.fmtp=e.fmtp.filter(r),e.payloads=e.payloads.split(" ").filter((function(e){return!t.has(Number(e))})).join(" ")}})),Cv(t)}var Iv,Rv=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},wv=new(function(){function e(){s(this,e),this.intervalMap_=new Map}return c(e,[{key:"setInterval",value:function(e){function t(t,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){var r=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!window||!window.requestAnimationFrame)return setInterval(e,t);var n=Rv(),o=rh(),s=o;this.intervalMap_.set(n,{rafId:null,timeoutId:null,onVisibilityChange:null});var a=function a(){if(i&&document.hidden){e();var c=setTimeout(a,t);r.setTimeoutId(n,c),o=rh(),s=o}else{(s=rh())-o>=t&&(o=s,e());var l=requestAnimationFrame(a);r.setRafId(n,l)}},c=requestAnimationFrame(a);if(this.setRafId(n,c),i){var l=function(){if(document.hidden){var e=rh()-o;if(e>=t)a();else{var i=setTimeout(a,t-e);r.setTimeoutId(n,i)}}};document.addEventListener("visibilitychange",l),this.setOnVisibilityChange(n,l)}return n}))},{key:"clearInterval",value:function(e){if(this.intervalMap_.has(e)){var t=this.intervalMap_.get(e),r=t.rafId,i=t.timeoutId,n=t.onVisibilityChange;cancelAnimationFrame(r),clearTimeout(i),document.removeEventListener("visibilitychange",n),this.intervalMap_.delete(e)}}},{key:"setTimeoutId",value:function(e,t){if(this.intervalMap_.has(e)){var r=this.intervalMap_.get(e);r.timeoutId&&clearTimeout(r.timeoutId),r.timeoutId=t}}},{key:"setRafId",value:function(e,t){if(this.intervalMap_.has(e)){var r=this.intervalMap_.get(e);r.rafId&&cancelAnimationFrame(r.rafId),r.rafId=t}}},{key:"setOnVisibilityChange",value:function(e,t){this.intervalMap_.has(e)&&(this.intervalMap_.get(e).onVisibilityChange=t)}}]),e}()),kv=new(function(){function e(){s(this,e),this.prefix_="TRTC",this.queue_=new Map,this.intervalId_=wv.setInterval(this.doFlush.bind(this),2e4),this.checkStorage()}return c(e,[{key:"getRealKey",value:function(e){return"".concat(this.prefix_,"_").concat(e)}},{key:"checkStorage",value:function(){var e=this;Fc()&&Object.keys(localStorage).filter((function(t){if(t.startsWith(e.prefix_)){var r=JSON.parse(localStorage.getItem(t));if(r&&r.expiresIn<Date.now())return!0}return!1})).forEach((function(e){return localStorage.removeItem(e)}))}},{key:"doFlush",value:function(){if(Fc())try{var e,t=C(this.queue_);try{for(t.s();!(e=t.n()).done;){var r=E(e.value,2),i=r[0],n=r[1];localStorage.setItem(i,JSON.stringify(n))}}catch(s){t.e(s)}finally{t.f()}}catch(ky){Tf.warn(ky)}}},{key:"getItem",value:function(e){if(!Fc())return null;try{var t=JSON.parse(localStorage.getItem(this.getRealKey(e)));return t&&t.expiresIn>=Date.now()?t.value:null}catch(ky){Tf.warn(ky)}}},{key:"setItem",value:function(e,t){if(Fc())try{var r={expiresIn:Date.now()+6048e5,value:t};this.queue_.set(this.getRealKey(e),r)}catch(ky){Tf.warn(ky)}}},{key:"deleteItem",value:function(e){if(!Fc())return!1;try{return e=this.getRealKey(e),this.queue_.delete(e),localStorage.removeItem(e),!0}catch(ky){return Tf.warn(ky),!1}}},{key:"clear",value:function(){if(Fc())try{localStorage.clear()}catch(ky){Tf.warn(ky)}}}]),e}()),Ov={result:!1,detail:{isBrowserSupported:!1,isWebRTCSupported:!1,isMediaDevicesSupported:!1,isH264EncodeSupported:!1,isVp8EncodeSupported:!1,isH264DecodeSupported:!1,isVp8DecodeSupported:!1}};(Iv=kv.getItem("checkResult"))&&Iv.ua===navigator.userAgent&&(Ov=Iv.checkResult,Fv());var Nv=function(){return!mc&&!Qa&&!(qa&&za<80)&&!(Ga&&Ha<56)},Lv=function(){return["RTCPeerConnection","webkitRTCPeerConnection","RTCIceGatherer"].filter((function(e){return e in window})).length>0},Pv=function(){if(!navigator.mediaDevices)return!1;var e=["getUserMedia","enumerateDevices"];return e.filter((function(e){return e in navigator.mediaDevices})).length===e.length},Dv=function(){var e=o(regeneratorRuntime.mark((function e(){var t,r,i,n,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ov.detail.isH264EncodeSupported&&!Ov.detail.isVp8EncodeSupported){e.next=2;break}return e.abrupt("return",{isH264EncodeSupported:Ov.detail.isH264EncodeSupported,isVp8EncodeSupported:Ov.detail.isVp8EncodeSupported});case 2:return t="",r=!1,i=!1,e.prev=5,n=new RTCPeerConnection,(o=document.createElement("canvas")).getContext("2d"),s=o.captureStream(0),n.addTrack(s.getVideoTracks()[0],s),e.next=13,n.createOffer();case 13:return-1!==(t=e.sent).sdp.toLowerCase().indexOf("h264")&&(r=!0),-1!==t.sdp.toLowerCase().indexOf("vp8")&&(i=!0),n.close(),Ov.detail.isH264EncodeSupported=r,Ov.detail.isVp8EncodeSupported=i,e.abrupt("return",{isH264EncodeSupported:Ov.detail.isH264EncodeSupported,isVp8EncodeSupported:Ov.detail.isVp8EncodeSupported});case 22:return e.prev=22,e.t0=e.catch(5),e.abrupt("return",{isH264EncodeSupported:!1,isVp8EncodeSupported:!1});case 25:case"end":return e.stop()}}),e,null,[[5,22]])})));return function(){return e.apply(this,arguments)}}();function Mv(){return xv.apply(this,arguments)}function xv(){return(xv=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=o(regeneratorRuntime.mark((function e(t){var r,i,n,s,a,c,l,u,d,h,p,f,g,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={encode:!1,decode:!1},i=null,e.prev=2,n=document.createElement("canvas"),s=n.getContext("2d"),n.width=640,n.height=480,a=setInterval((function(){s.fillText("test",Math.floor(640*Math.random()),Math.floor(480*Math.random()))}),33),c=-1,l=-1,i=function(){clearInterval(c),clearInterval(a),clearTimeout(l),d.close(),h.close(),u.getTracks().forEach((function(e){return e.stop()}))},l=setTimeout((function(){i(),t(r)}),3e3),u=n.captureStream(),d=new RTCPeerConnection({}),h=new RTCPeerConnection({offerToReceiveAudio:!0,offerToReceiveVideo:!0}),d.addEventListener("icecandidate",(function(e){return h.addIceCandidate(e.candidate)})),h.addEventListener("icecandidate",(function(e){return d.addIceCandidate(e.candidate)})),d.addTrack(u.getVideoTracks()[0],u),e.next=20,d.createOffer();case 20:return p=e.sent,e.next=23,d.setLocalDescription(p);case 23:return e.next=25,h.setRemoteDescription(p);case 25:return e.next=27,h.createAnswer();case 27:return f=e.sent,g=Sv(f.sdp),m=g.media[0].rtp.findIndex((function(e){return"H264"===e.codec})),g.media[0].rtp=[g.media[0].rtp[m]],g.media[0].fmtp=g.media[0].fmtp.filter((function(e){return e.payload===g.media[0].rtp[0].payload})),g.media[0].rtcpFb=g.media[0].rtcpFb.filter((function(e){return e.payload===g.media[0].rtp[0].payload})),f.sdp=Cv(g),e.next=36,h.setLocalDescription(f);case 36:return e.next=38,d.setRemoteDescription(f);case 38:c=setInterval(o(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.encode&&r.decode&&(i(),t(r)),e.next=3,d.getStats();case 3:return n=e.sent,e.next=6,h.getStats();case 6:o=e.sent,r.encode||n.forEach((function(e){"outbound-rtp"===e.type&&e.mediaType===Xl&&e.framesEncoded>0&&(r.encode=!0)})),r.decode||o.forEach((function(e){"inbound-rtp"===e.type&&e.mediaType===Xl&&e.framesDecoded>0&&(r.decode=!0)}));case 9:case"end":return e.stop()}}),e)}))),500),e.next=46;break;case 41:e.prev=41,e.t0=e.catch(2),i(),Tf.warn(e.t0),t(r);case 46:case"end":return e.stop()}}),e,null,[[2,41]])})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Bv=function(){var e=o(regeneratorRuntime.mark((function e(){var t,r,i,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ov.detail.isH264DecodeSupported&&!Ov.detail.isVp8DecodeSupported){e.next=2;break}return e.abrupt("return",{isH264DecodeSupported:Ov.detail.isH264DecodeSupported,isVp8DecodeSupported:Ov.detail.isVp8DecodeSupported});case 2:return t="",r=!1,i=!1,e.prev=5,n=new RTCPeerConnection,e.next=9,n.createOffer({offerToReceiveAudio:1,offerToReceiveVideo:1});case 9:return-1!==(t=e.sent).sdp.toLowerCase().indexOf("h264")&&(r=!0),-1!==t.sdp.toLowerCase().indexOf("vp8")&&(i=!0),n.close(),e.abrupt("return",{isH264DecodeSupported:r,isVp8DecodeSupported:i});case 16:return e.prev=16,e.t0=e.catch(5),e.abrupt("return",{isH264DecodeSupported:!1,isVp8DecodeSupported:!1});case 19:case"end":return e.stop()}}),e,null,[[5,16]])})));return function(){return e.apply(this,arguments)}}(),Uv=function(e,t){var r=null;return function(){if(r)return r;for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(r=e.apply(t||this,n)).then((function(e){return r=null,e})).catch((function(e){throw r=null,e})),r}}(function(){var e=o(regeneratorRuntime.mark((function e(){var t,r,i,n,o,s,a,c,l,u,d,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ov.result){e.next=2;break}return e.abrupt("return",Ov);case 2:return t=Nv(),r=Lv(),i=Pv(),e.next=7,Dv();case 7:return n=e.sent,o=n.isH264EncodeSupported,s=n.isVp8EncodeSupported,e.next=12,Bv();case 12:if(a=e.sent,c=a.isH264DecodeSupported,l=a.isVp8DecodeSupported,!(o&&c&&(Tc||Ic||Mc)&&wc()<79)){e.next=23;break}return e.next=18,Mv();case 18:u=e.sent,d=u.encode,h=u.decode,o=d,c=h;case 23:return Ov.result=t&&r&&i&&(o||s)&&(c||l),Ov.detail.isBrowserSupported=t,Ov.detail.isWebRTCSupported=r,Ov.detail.isMediaDevicesSupported=i,Ov.detail.isH264EncodeSupported=o,Ov.detail.isVp8EncodeSupported=s,Ov.detail.isH264DecodeSupported=c,Ov.detail.isVp8DecodeSupported=l,Fv(),kv.setItem("checkResult",{ua:navigator.userAgent,checkResult:Ov}),e.abrupt("return",Ov);case 34:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}());function Fv(){Object.keys(Ov.detail).findIndex((function(e){return!Ov.detail[e]}))>=0&&Tf.error("".concat(navigator.userAgent," ").concat(JSON.stringify(Ov.detail)))}var Vv=function(){return!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia)},jv=function(){return"RTCPeerConnection"in window&&"getReceivers"in window.RTCPeerConnection.prototype},Gv=function(){return"RTCPeerConnection"in window&&"getSenders"in window.RTCPeerConnection.prototype},Hv=function(){return"RTCPeerConnection"in window&&"getTransceivers"in window.RTCPeerConnection.prototype},Qv=function(){return"RTCRtpTransceiver"in window&&"stop"in window.RTCRtpTransceiver.prototype},Wv=function(){return"RTCRtpSender"in window&&"setParameters"in window.RTCRtpSender.prototype&&Gv()},qv=function(){return!!Yd(navigator.mediaDevices)&&(Tf.error(av.NOT_SUPPORTED_MEDIA),!0)},zv=function(){return"http:"===location.protocol&&!Uc&&(Tf.error(av.NOT_SUPPORTED_HTTP),!0)},Zv=function(e){return!("candidate-pair"!==e.type||!e.nominated||"in-progress"!==e.state&&"succeeded"!==e.state)&&!(Jd(e.selected)&&!e.selected)},Yv=new Map([[ja,"Android"],[Va,"iOS"],[pc,"Windows"],[fc,"MacOS"],[gc,"Linux"]]),Kv=function(){var e="unknown";return Yv.get(!0)&&(e=Yv.get(!0)),e};function $v(){var e="";return screen.width&&(e+=(screen.width?screen.width*window.devicePixelRatio:"")+" * "+(screen.height?screen.height*window.devicePixelRatio:"")),e}function Jv(){var e=!1;return(navigator.getUserMedia||navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)&&(e=!0),e}function Xv(){for(var e={isSupported:!1},t=["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"],r=0;r<t.length;r++)if(t[r]in window){e.isSupported=!0;break}return e.isSupported}function eE(){return!rc&&!Va&&!(!Nv()||!("captureStream"in HTMLCanvasElement.prototype))}Uv();var tE="stream-added",rE="stream-removed",iE="stream-updated",nE="stream-subscribed",oE="error",sE="connection-state-changed",aE="stream-added",cE="stream-removed",lE="stream-updated",uE="stream-subscribed",dE="connection-state-changed",hE="peer-join",pE="peer-leave",fE="mute-audio",gE="mute-video",mE="unmute-audio",_E="unmute-video",vE="client-banned",EE="network-quality",AE="audio-volume",yE="error",SE="player-state-changed",CE="screen-sharing-stopped",TE="connection-state-changed",bE="error",IE="player-state-changed",RE=function(){function e(t){s(this,e);var r=t.getUserId();this.log_=Tf.createLogger({id:r,userId:r,sdkAppId:t.getSDKAppId()}),this.prevReport_={},this.prevEncoderImplementation_="",this.prevQualityLimitationReason_="",this.prevDecoderImplementationMap_=new Map}var t,r,i,n;return c(e,[{key:"getSenderStats",value:(n=o(regeneratorRuntime.mark((function e(t){var r,i,n,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={audio:{bytesSent:0,packetsSent:0,audioLevel:0,totalAudioEnergy:0},video:{bytesSent:0,packetsSent:0,framesEncoded:0,frameWidth:0,frameHeight:0,framesSent:0,fpsCapture:0,smallFramesEncoded:0,smallFPSCapture:0,smallFramesSent:0},rtt:0},i=t.getPeerConnection(),n=t.getSSRC(),!i){e.next=14;break}return e.prev=4,e.next=7,i.getStats();case 7:e.sent.forEach((function(e){if("outbound-rtp"===e.type)if(e.mediaType===Xl){if(!Ga&&Yd(e.trackId))return;e.ssrc!==n.video||Yd(e.encoderImplementation)||o.prevEncoderImplementation_===e.encoderImplementation||(o.log_.info("encoderImplementation change to ".concat(e.encoderImplementation)),o.prevEncoderImplementation_=e.encoderImplementation),e.ssrc!==n.video||Yd(e.qualityLimitationReason)||o.prevQualityLimitationReason_===e.qualityLimitationReason||(o.log_.info("qualityLimitationReason change to ".concat(e.qualityLimitationReason)),o.prevQualityLimitationReason_=e.qualityLimitationReason);var i=t.getSSRC();e.ssrc===i.video?(r.video.bytesSent=e.bytesSent,r.video.packetsSent=e.packetsSent,r.video.framesEncoded=e.framesEncoded):(r.video.smallBytesSent=e.bytesSent,r.video.smallFramesEncoded=e.framesEncoded)}else e.mediaType===Jl&&(r.audio.bytesSent=e.bytesSent,r.audio.packetsSent=e.packetsSent);else"candidate-pair"===e.type?Zv(e)&&$d(e.currentRoundTripTime)&&(r.rtt=Math.floor(1e3*e.currentRoundTripTime)):"track"===e.type?(Yd(e.frameWidth)||(e.trackIdentifier===t.getLocalStreamVideoTrackId()?(r.video.frameWidth=e.frameWidth,r.video.frameHeight=e.frameHeight,r.video.framesSent=e.framesSent):(r.video.smallFrameWidth=e.frameWidth,r.video.smallFrameHeight=e.frameHeight,r.video.smallFramesSent=e.framesSent)),Yd(e.audioLevel)||(r.audio.audioLevel=e.audioLevel||0)):"media-source"===e.type&&(e.kind===Jl?(r.audio.audioLevel=e.audioLevel||0,r.audio.totalAudioEnergy=e.totalAudioEnergy||0):e.kind===Xl&&(e.trackIdentifier===t.getLocalStreamVideoTrackId()?r.video.fpsCapture=e.framesPerSecond:r.video.smallFPSCapture=e.framesPerSecond))})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),this.log_.warn("failed to getStats on sender connection");case 14:return e.abrupt("return",r);case 15:case"end":return e.stop()}}),e,this,[[4,11]])}))),function(e){return n.apply(this,arguments)})},{key:"getReceiverStats",value:(i=o(regeneratorRuntime.mark((function e(t){var r,i,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={tinyId:t.getTinyId(),userId:t.getUserId(),rtt:0,hasAudio:!1,hasVideo:!1,hasAuxiliary:!1,audio:{bytesReceived:0,packetsReceived:0,packetsLost:0,jitter:0,audioLevel:0,totalAudioEnergy:0},video:{bytesReceived:0,packetsReceived:0,packetsLost:0,framesReceived:0,framesDecoded:0,frameWidth:0,frameHeight:0},auxiliary:{bytesReceived:0,packetsReceived:0,packetsLost:0,framesReceived:0,framesDecoded:0,frameWidth:0,frameHeight:0}},!(i=t.getPeerConnection())){e.next=13;break}return e.prev=3,e.next=6,i.getStats();case 6:e.sent.forEach((function(e){if("inbound-rtp"===e.type){if(e.mediaType===Jl)r.audio.packetsReceived=e.packetsReceived,r.audio.bytesReceived=e.bytesReceived,r.audio.packetsLost=e.packetsLost,r.audio.jitter=e.jitter,r.hasAudio=!0;else if(e.mediaType===Xl){if(Ga&&0===e.bytesReceived)return;var i=t.getSSRC();e.ssrc===i.video&&(r.video.packetsReceived=e.packetsReceived,r.video.bytesReceived=e.bytesReceived,r.video.packetsLost=e.packetsLost,r.video.framesReceived=e.framesReceived,r.video.framesDecoded=e.framesDecoded,r.video.fpsDecoded=e.framesPerSecond,r.hasVideo=!0,!e.decoderImplementation||n.prevDecoderImplementationMap_.has(r.userId)&&n.prevDecoderImplementationMap_.get(r.userId)===e.decoderImplementation||(Tf.info("[".concat(r.userId,"] decoderImplementation change to ").concat(e.decoderImplementation)),n.prevDecoderImplementationMap_.set(r.userId,e.decoderImplementation))),e.ssrc===i.auxiliary&&(r.auxiliary.packetsReceived=e.packetsReceived,r.auxiliary.bytesReceived=e.bytesReceived,r.auxiliary.packetsLost=e.packetsLost,r.auxiliary.framesReceived=e.framesReceived,r.auxiliary.framesDecoded=e.framesDecoded,r.auxiliary.fpsDecoded=e.framesPerSecond,r.hasAuxiliary=!0)}}else"track"===e.type?(Yd(e.frameWidth)||(e.trackIdentifier===t.getMainStreamVideoTrackId()&&(r.video.frameWidth=e.frameWidth,r.video.frameHeight=e.frameHeight),e.trackIdentifier===t.getAuxStreamVideoTrackId()&&(r.auxiliary.frameWidth=e.frameWidth,r.auxiliary.frameHeight=e.frameHeight)),e.kind===Jl&&(r.audio.audioLevel=e.audioLevel||0,r.audio.totalAudioEnergy=e.totalAudioEnergy||0)):"candidate-pair"===e.type&&Zv(e)&&$d(e.currentRoundTripTime)&&(r.rtt=Math.floor(1e3*e.currentRoundTripTime))})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),this.log_.warn("failed to getStats on receiver connection");case 13:return e.abrupt("return",r);case 14:case"end":return e.stop()}}),e,this,[[3,10]])}))),function(e){return i.apply(this,arguments)})},{key:"getStats",value:(r=o(regeneratorRuntime.mark((function e(t,r){var i,n,o,s,a,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i={},!t){e.next=5;break}return e.next=4,this.getSenderStats(t);case 4:i=e.sent;case 5:n=[],o=C(r),e.prev=7,o.s();case 9:if((s=o.n()).done){e.next=17;break}return(a=E(s.value,2))[0],c=a[1],e.next=13,this.getReceiverStats(c);case 13:l=e.sent,n.push(l);case 15:e.next=9;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(7),o.e(e.t0);case 22:return e.prev=22,o.f(),e.finish(22);case 25:return e.abrupt("return",{senderStats:i,receiverStats:n});case 26:case"end":return e.stop()}}),e,this,[[7,19,22,25]])}))),function(e,t){return r.apply(this,arguments)})},{key:"prepareReport",value:function(e){var t=e.stats,r=e.report,i=e.freezeMap;if(!fm(t.senderStats)&&(r.uint32_delay=t.senderStats.rtt,r.RTTReportState.uint32_delay=t.senderStats.rtt,r.AudioReportState.sentAudioLevel=t.senderStats.audio.audioLevel,r.AudioReportState.sentAudioEnergy=t.senderStats.audio.totalAudioEnergy,r.AudioReportState.uint32_audio_enc_pkg_br=t.senderStats.audio.bytesSent,r.VideoReportState.uint32_video_snd_br=t.senderStats.video.bytesSent,r.VideoReportState.uint32_send_total_pkg=t.senderStats.video.packetsSent,r.VideoReportState.VideoEncState[0].uint32_enc_width=t.senderStats.video.frameWidth,r.VideoReportState.VideoEncState[0].uint32_enc_height=t.senderStats.video.frameHeight,r.VideoReportState.VideoEncState[0].uint32_enc_fps=t.senderStats.video.framesEncoded,r.VideoReportState.VideoEncState[0].uint32_capture_fps=t.senderStats.video.fpsCapture,r.VideoReportState.VideoEncState[0].uint32_send_fps=t.senderStats.video.framesSent,t.senderStats.video.smallBytesSent)){r.VideoReportState.uint32_small_video_snd_br=t.senderStats.video.smallBytesSent;var n={uint32_enc_width:t.senderStats.video.smallFrameWidth||0,uint32_enc_height:t.senderStats.video.smallFrameHeight||0,uint32_enc_fps:t.senderStats.video.smallFramesEncoded||0,uint32_capture_fps:t.senderStats.video.smallFPSCapture||0,uint32_send_fps:t.senderStats.video.smallFramesSent||0};r.VideoReportState.VideoEncState.push(n)}t.receiverStats.forEach((function(e){var t=e.userId;if(r.RTTReportState.RTTDecState.push({uint32_delay:e.rtt,uint64_sender_uin:e.tinyId}),e.hasAudio&&(r.AudioReportState.AudioDecState.push({uint32_audio_delay:0,uint32_audio_jitter:e.audio.jitter,uint32_audio_real_recv_pkg:e.audio.packetsReceived,uint32_audio_flow:e.audio.bytesReceived,uint32_audio_real_recv_br:0,uint64_sender_uin:e.tinyId,userId:e.userId,packetsLost:e.audio.packetsLost,totalPacketsLost:e.audio.packetsLost,audioLevel:e.audio.audioLevel,audioEnergy:e.audio.totalAudioEnergy}),r.AudioReportState.uint32_audio_real_recv_pkg+=e.audio.packetsReceived,r.AudioReportState.uint32_audio_flow+=e.audio.bytesReceived,r.uint32_real_num+=e.audio.packetsReceived),e.hasVideo){var n=i.get(t+"_main"),o=n?n.duration:0;r.VideoReportState.VideoDecState.push({uint32_video_recv_fps:e.video.framesReceived,uint32_video_dec_fps:e.video.fpsDecoded,uint32_video_recv_br:e.video.bytesReceived,uint32_video_real_recv_pkg:e.video.packetsReceived,uint32_dec_height:e.video.frameHeight,uint32_dec_width:e.video.frameWidth,uint32_video_jitter:0,uint64_sender_uin:e.tinyId,userId:e.userId,packetsLost:e.video.packetsLost,totalPacketsLost:e.video.packetsLost,uint32_video_strtype:0,int32_video_freeze_ms:o}),r.VideoReportState.uint32_video_total_real_recv_pkg+=e.video.packetsReceived,r.VideoReportState.uint32_video_rcv_br+=e.video.bytesReceived}if(e.hasAuxiliary){var s=i.get(t+"_auxiliary"),a=s?s.duration:0;r.VideoReportState.VideoDecState.push({uint32_video_recv_fps:e.auxiliary.framesReceived,uint32_video_dec_fps:e.auxiliary.fpsDecoded,uint32_video_recv_br:e.auxiliary.bytesReceived,uint32_video_real_recv_pkg:e.auxiliary.packetsReceived,uint32_dec_height:e.auxiliary.frameHeight,uint32_dec_width:e.auxiliary.frameWidth,uint32_video_jitter:0,uint64_sender_uin:e.tinyId,userId:e.userId,packetsLost:e.auxiliary.packetsLost,totalPacketsLost:e.auxiliary.packetsLost,uint32_video_strtype:2,int32_video_freeze_ms:a})}})),r.uint64_end_utime=(new Date).getTime();var o=this.prevReport_;if(this.prevReport_=JSON.parse(JSON.stringify(r)),fm(o))r.AudioReportState.uint32_audio_enc_pkg_br=8*r.AudioReportState.uint32_audio_enc_pkg_br/2,r.VideoReportState.uint32_video_rcv_br=8*r.VideoReportState.uint32_video_rcv_br/2,r.VideoReportState.uint32_video_snd_br=8*r.VideoReportState.uint32_video_snd_br/2,r.VideoReportState.uint32_small_video_snd_br&&(r.VideoReportState.uint32_small_video_snd_br=8*r.VideoReportState.uint32_small_video_snd_br/2),r.VideoReportState.VideoDecState.forEach((function(e){e.uint32_video_recv_br=8*e.uint32_video_recv_br/2,r.uint32_total_send_bps=r.AudioReportState.uint32_audio_enc_pkg_br+r.VideoReportState.uint32_video_snd_br}));else{if(r.uint64_begine_utime=o.uint64_end_utime,r.uint32_real_num-=o.uint32_real_num,r.uint32_real_num<=0&&(r.uint32_real_num=0),r.AudioReportState.uint32_audio_real_recv_pkg-=o.AudioReportState.uint32_audio_real_recv_pkg,r.AudioReportState.uint32_audio_real_recv_pkg<=0&&(r.AudioReportState.uint32_audio_real_recv_pkg=0),r.AudioReportState.uint32_audio_enc_pkg_br-=o.AudioReportState.uint32_audio_enc_pkg_br,r.AudioReportState.uint32_audio_enc_pkg_br<=0&&(r.AudioReportState.uint32_audio_enc_pkg_br=0),r.AudioReportState.uint32_audio_enc_pkg_br=8*r.AudioReportState.uint32_audio_enc_pkg_br/2,r.VideoReportState.uint32_video_snd_br-=o.VideoReportState.uint32_video_snd_br,r.VideoReportState.uint32_video_snd_br<=0&&(r.VideoReportState.uint32_video_snd_br=0),r.VideoReportState.uint32_video_snd_br=8*r.VideoReportState.uint32_video_snd_br/2,r.VideoReportState.uint32_small_video_snd_br&&(r.VideoReportState.uint32_small_video_snd_br-=o.VideoReportState.uint32_small_video_snd_br,r.VideoReportState.uint32_small_video_snd_br<=0&&(r.VideoReportState.uint32_small_video_snd_br=0),r.VideoReportState.uint32_small_video_snd_br=8*r.VideoReportState.uint32_small_video_snd_br/2),r.AudioReportState.uint32_audio_flow-=o.AudioReportState.uint32_audio_flow,r.AudioReportState.uint32_audio_flow<=0&&(r.AudioReportState.uint32_audio_flow=0),r.VideoReportState.uint32_send_total_pkg-=o.VideoReportState.uint32_send_total_pkg,r.VideoReportState.uint32_send_total_pkg<=0&&(r.VideoReportState.uint32_send_total_pkg=0),r.VideoReportState.uint32_video_rcv_br-=o.VideoReportState.uint32_video_rcv_br,r.VideoReportState.uint32_video_rcv_br<=0&&(r.VideoReportState.uint32_video_rcv_br=0),r.VideoReportState.uint32_video_rcv_br=8*r.VideoReportState.uint32_video_rcv_br/2,r.VideoReportState.uint32_video_total_real_recv_pkg-=o.VideoReportState.uint32_video_total_real_recv_pkg,r.VideoReportState.uint32_video_total_real_recv_pkg<=0&&(r.VideoReportState.uint32_video_total_real_recv_pkg=0),r.VideoReportState.VideoEncState[0].uint32_enc_fps-=o.VideoReportState.VideoEncState[0].uint32_enc_fps,r.VideoReportState.VideoEncState[0].uint32_enc_fps<0&&(r.VideoReportState.VideoEncState[0].uint32_enc_fps=0),r.VideoReportState.VideoEncState[0].uint32_enc_fps=r.VideoReportState.VideoEncState[0].uint32_enc_fps/2,r.VideoReportState.VideoEncState[0].uint32_send_fps-=o.VideoReportState.VideoEncState[0].uint32_send_fps,r.VideoReportState.VideoEncState[0].uint32_send_fps<0&&(r.VideoReportState.VideoEncState[0].uint32_send_fps=0),r.VideoReportState.VideoEncState[0].uint32_send_fps=r.VideoReportState.VideoEncState[0].uint32_send_fps/2,r.VideoReportState.VideoEncState[1]){var s=0,a=0;o.VideoReportState.VideoEncState[1]&&(s=o.VideoReportState.VideoEncState[1].uint32_enc_fps,a=o.VideoReportState.VideoEncState[1].uint32_enc_fps),r.VideoReportState.VideoEncState[1].uint32_enc_fps-=s,r.VideoReportState.VideoEncState[1].uint32_enc_fps<0&&(r.VideoReportState.VideoEncState[1].uint32_enc_fps=0),r.VideoReportState.VideoEncState[1].uint32_enc_fps=r.VideoReportState.VideoEncState[1].uint32_enc_fps/2,r.VideoReportState.VideoEncState[1].uint32_send_fps-=a,r.VideoReportState.VideoEncState[1].uint32_send_fps<0&&(r.VideoReportState.VideoEncState[1].uint32_send_fps=0),r.VideoReportState.VideoEncState[1].uint32_send_fps=r.VideoReportState.VideoEncState[1].uint32_send_fps/2}for(var c=r.VideoReportState.VideoDecState.length,l=0;l<c;l++){for(var u=r.VideoReportState.VideoDecState[l],d=u.uint64_sender_uin,h=u.uint32_video_strtype,p=u.uint32_video_real_recv_pkg,f=u.uint32_video_recv_br,g=u.uint32_video_recv_fps,m=0;m<o.VideoReportState.VideoDecState.length;m++){var _=o.VideoReportState.VideoDecState[m];if(_.uint64_sender_uin===d&&_.uint32_video_strtype===h){u.packetsLost=u.totalPacketsLost-_.totalPacketsLost,(p-=_.uint32_video_real_recv_pkg)<=0&&(p=0),(f-=_.uint32_video_recv_br)<=0&&(f=0),(g-=_.uint32_video_recv_fps)<0&&(g=0);break}}r.VideoReportState.VideoDecState[l].uint32_video_real_recv_pkg=p,r.VideoReportState.VideoDecState[l].uint32_video_recv_br=8*f/2,r.VideoReportState.VideoDecState[l].uint32_video_recv_fps=g/2}c=r.AudioReportState.AudioDecState.length;for(var v=0;v<c;v++){for(var E=r.AudioReportState.AudioDecState[v],A=E.uint32_audio_real_recv_pkg,y=E.uint32_audio_flow,S=E.uint64_sender_uin,C=0;C<o.AudioReportState.AudioDecState.length;C++){var T=o.AudioReportState.AudioDecState[C];if(T.uint64_sender_uin===S){E.packetsLost=E.totalPacketsLost-T.totalPacketsLost,(A-=T.uint32_audio_real_recv_pkg)<=0&&(A=0),(y-=T.uint32_audio_flow)<=0&&(y=0);break}}r.AudioReportState.AudioDecState[v].uint32_audio_real_recv_pkg=A,r.AudioReportState.AudioDecState[v].uint32_audio_flow=y,r.AudioReportState.AudioDecState[v].uint32_audio_real_recv_br=8*y/2}r.AudioReportState.uint32_audio_real_recv_br=8*r.AudioReportState.uint32_audio_flow/2,r.uint32_real_num=r.AudioReportState.uint32_audio_real_recv_pkg+r.VideoReportState.uint32_video_total_real_recv_pkg,r.uint32_total_send_bps=r.AudioReportState.uint32_audio_enc_pkg_br+r.VideoReportState.uint32_video_snd_br,r.uint32_total_recv_bps=r.AudioReportState.uint32_audio_real_recv_br+r.VideoReportState.uint32_video_rcv_br}return r}},{key:"getStatsReport",value:(t=o(regeneratorRuntime.mark((function e(t){var r,i,n,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.uplinkConnection,i=t.downlinkConnections,n=t.freezeMap,o={uint64_begine_utime:(new Date).getTime(),uint64_end_utime:0,uint32_real_num:0,uint32_delay:0,uint32_CPU_curfreq:0,uint32_total_send_bps:0,uint32_total_recv_bps:0,AudioReportState:{uint32_audio_enc_pkg_br:0,uint32_audio_real_recv_pkg:0,uint32_audio_flow:0,uint32_audio_real_recv_br:0,uint32_audio_delay:0,uint32_audio_jitter:0,uint32_microphone_status:1,sentAudioLevel:0,sentAudioEnergy:0,AudioDecState:[]},VideoReportState:{uint32_video_delay:0,uint32_video_snd_br:0,uint32_video_total_real_recv_pkg:0,uint32_video_rcv_br:0,uint32_send_total_pkg:0,VideoEncState:[{uint32_enc_width:0,uint32_enc_height:0,uint32_capture_fps:0,uint32_enc_fps:0,uint32_send_fps:0}],VideoDecState:[]},RTTReportState:{uint32_delay:0,RTTDecState:[]}},e.next=4,this.getStats(r,i);case 4:return s=e.sent,this.prepareReport({stats:s,report:o,freezeMap:n}),e.abrupt("return",o);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}(),wE=function(){function e(t){var r=t.signalChannel,i=t.connections,n=t.client;s(this,e),this.client_=n,this.signalChannel_=r,this.connections_=i,this.client_=n,this.log_=Tf.createLogger({id:"q|"+this.client_.getUserId(),userId:this.client_.getUserId(),sdkAppId:this.client_.getSDKAppId()}),this.uplinkConnection_=null,this.uplinkNetworkQuality_=0,this.uplinkRTT_=0,this.uplinkLoss_=0,this.downlinkNetworkQuality_=0,this.downlinkRTT_=0,this.downlinkLoss_=0,this.downlinkPrevStatMap_=new Map,this.downlinkLossAndRTTMap_=new Map,this.interval_=-1,this.emitter_=new fh,this.initialize()}var t,r;return c(e,[{key:"uplinkNetworkQuality",get:function(){return this.uplinkNetworkQuality_},set:function(e){e!==this.uplinkNetworkQuality_&&this.log_.info("uplink network quality change ".concat(this.uplinkNetworkQuality," -> ").concat(e,", rtt: ").concat(this.uplinkRTT_,", loss: ").concat(this.uplinkLoss_)),this.uplinkNetworkQuality_=e}},{key:"downlinkNetworkQuality",get:function(){return this.downlinkNetworkQuality_},set:function(e){if(e!==this.downlinkNetworkQuality_){var t=this.getAverageLossAndRTT(A(this.downlinkLossAndRTTMap_.values())),r=t.rtt,i=t.loss;this.log_.info("downlink network quality change ".concat(this.downlinkNetworkQuality," -> ").concat(e,", rtt: ").concat(r,", loss: ").concat(i))}this.downlinkNetworkQuality_=e}},{key:"initialize",value:function(){var e=this;this.signalChannel_.on(cg.UPLINK_NETWORK_STATS,(function(t){e.handleUplinkNetworkQuality(t)})),this.signalChannel_.on(Xf,this.handleSignalConnectionStateChange.bind(this)),this.start()}},{key:"handleUplinkNetworkQuality",value:function(e){if(!this.uplinkConnection_)return this.uplinkNetworkQuality=0,this.uplinkLoss_=0,void(this.uplinkRTT_=0);var t=this.uplinkConnection_.getPeerConnection();if(t&&this.isPeerConnectionDisconnected(t))return this.uplinkNetworkQuality=6,this.uplinkLoss_=0,void(this.uplinkRTT_=0);var r=e.data.content;if(0===r.result){var i=r.expectAudPkg+r.expectVidPkg,n=r.recvAudPkg+r.recvVidPkg,o=i-n;if(0===i&&0===n)return;this.uplinkLoss_=o<=0?0:Math.round(o/i*100),this.uplinkRTT_=r.rtt,this.uplinkNetworkQuality=this.getNetworkQuality(this.uplinkLoss_,this.uplinkRTT_)}}},{key:"handleDownlinkNetworkQuality",value:(r=o(regeneratorRuntime.mark((function e(){var t,r,i,n,o,s,a,c,l,u,d,h,p,f,g,m=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connections_&&0!==this.connections_.size){e.next=3;break}return this.downlinkNetworkQuality=0,e.abrupt("return");case 3:if(t=A(this.connections_.values()),r=t.filter((function(e){return e.getPeerConnection()&&e.getPeerConnection().connectionState===fl})),t.filter((function(e){return e.getPeerConnection()&&m.isPeerConnectionDisconnected(e.getPeerConnection())})).length!==t.length){e.next=9;break}return this.downlinkNetworkQuality=6,e.abrupt("return");case 9:i=0;case 10:if(!(i<r.length)){e.next=31;break}return n=r[i].getPeerConnection(),e.next=14,this.getStat(n);case 14:if(o=e.sent,s=o.rtt,a=o.totalPacketsLost,c=o.totalPacketsReceived,this.downlinkPrevStatMap_.has(n)){e.next=21;break}return this.downlinkPrevStatMap_.set(n,{totalPacketsLost:a,totalPacketsReceived:c}),e.abrupt("continue",28);case 21:l=0,u=this.downlinkPrevStatMap_.get(n),d=a-u.totalPacketsLost,h=c-u.totalPacketsReceived,l=d<=0||h<0?0:Math.round(d/(d+h)*100),this.downlinkPrevStatMap_.set(n,{totalPacketsLost:a,totalPacketsReceived:c}),this.downlinkLossAndRTTMap_.set(n,{rtt:s,loss:l,userId:r[i].getUserId()});case 28:i++,e.next=10;break;case 31:if(A(this.downlinkPrevStatMap_.keys()).forEach((function(e){m.isPeerConnectionDisconnected(e)&&(m.downlinkPrevStatMap_.delete(e),m.downlinkLossAndRTTMap_.delete(e))})),0!==this.downlinkLossAndRTTMap_.size){e.next=34;break}return e.abrupt("return");case 34:p=this.getAverageLossAndRTT(A(this.downlinkLossAndRTTMap_.values())),f=p.rtt,g=p.loss,this.downlinkRTT_=f,this.downlinkLoss_=g,this.downlinkNetworkQuality=this.getNetworkQuality(g,f);case 38:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"getStat",value:(t=o(regeneratorRuntime.mark((function e(t){var r,i,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={rtt:0,totalPacketsLost:0,totalPacketsReceived:0},t&&jv()){e.next=3;break}return e.abrupt("return",r);case 3:i=t.getReceivers(),e.prev=4,n=0;case 6:if(!(n<i.length)){e.next=15;break}return o=i[n],e.next=10,o.getStats();case 10:e.sent.forEach((function(e){"candidate-pair"===e.type&&$d(e.currentRoundTripTime)&&(r.rtt=Math.round(1e3*e.currentRoundTripTime)),"inbound-rtp"!==e.type||e.mediaType!==Jl&&e.mediaType!==Xl||(r.totalPacketsLost+=e.packetsLost,r.totalPacketsReceived+=e.packetsReceived)}));case 12:n++,e.next=6;break;case 15:return e.abrupt("return",r);case 18:return e.prev=18,e.t0=e.catch(4),e.abrupt("return",r);case 21:case"end":return e.stop()}}),e,null,[[4,18]])}))),function(e){return t.apply(this,arguments)})},{key:"getAverageLossAndRTT",value:function(e){var t={rtt:0,loss:0};return Array.isArray(e)&&e.length>0&&(e.forEach((function(e){t.rtt+=e.rtt,t.loss+=e.loss})),Object.keys(t).forEach((function(r){t[r]=Math.round(t[r]/e.length)}))),t}},{key:"getNetworkQuality",value:function(e,t){return e>50||t>500?5:e>30||t>350?4:e>20||t>200?3:e>10||t>100?2:e>=0||t>=0?1:0}},{key:"handleSignalConnectionStateChange",value:function(e){e.state===rg?(this.uplinkRTT_=0,this.uplinkLoss_=0,this.uplinkNetworkQuality=6):e.state===og&&6===this.uplinkNetworkQuality&&(this.uplinkNetworkQuality=5)}},{key:"handleUplinkConnectionStateChange",value:function(e){var t=e.state;t===ol?(this.uplinkLoss_=0,this.uplinkRTT_=0,this.uplinkNetworkQuality=6):t===cl&&6===this.uplinkNetworkQuality&&(this.uplinkNetworkQuality=5)}},{key:"isPeerConnectionDisconnected",value:function(e){return!(!e||e.connectionState!==pl&&e.connectionState!==dl&&e.connectionState!==hl)}},{key:"setUplinkConnection",value:function(e){this.uplinkConnection_=e,this.uplinkConnection_?this.uplinkConnection_.on(sE,this.handleUplinkConnectionStateChange.bind(this)):(this.uplinkNetworkQuality=0,this.uplinkRTT_=0,this.uplinkLoss_=0)}},{key:"start",value:function(){var e=this;-1===this.interval_?(this.log_.info("start network quality calculating"),this.interval_=wv.setInterval((function(){e.handleDownlinkNetworkQuality(),gh.emit(rp,{client:e.client_,uplinkNetworkQuality:e.uplinkNetworkQuality,downlinkNetworkQuality:e.downlinkNetworkQuality,uplinkRTT:e.uplinkRTT_,uplinkLoss:e.uplinkLoss_,downlinkRTT:e.downlinkRTT_,downlinkLoss:e.downlinkLoss_,downlinkLossAndRTTMap:e.downlinkLossAndRTTMap_}),e.emitter_.emit(EE,{uplinkNetworkQuality:e.uplinkNetworkQuality,downlinkNetworkQuality:e.downlinkNetworkQuality,uplinkRTT:e.uplinkRTT_,uplinkLoss:e.uplinkLoss_,downlinkRTT:e.downlinkRTT_,downlinkLoss:e.downlinkLoss_})}),2e3)):this.log_.info("network quality calculating is already started")}},{key:"stop",value:function(){this.log_.info("stop network quality calculating"),-1!==this.interval_&&(wv.clearInterval(this.interval_),this.interval_=-1)}},{key:"on",value:function(e,t){this.emitter_.on(e,t)}}]),e}(),kE=function(){function e(t){s(this,e),this.log_=Tf.createLogger({id:t.client.getUserId(),userId:t.client.getUserId(),sdkAppId:t.client.getSDKAppId()}),this.localStream_=null,this.prevDevices_=[],this.initialize()}var t,r,i;return c(e,[{key:"initialize",value:(i=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:navigator.mediaDevices&&navigator.mediaDevices.addEventListener("devicechange",this.onDeviceChange.bind(this));case 1:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"onDeviceChange",value:(r=o(regeneratorRuntime.mark((function e(){var t,r,i,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.localStream_&&this.localStream_.getMediaStream()&&!this.localStream_.getScreen()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,wy.getDevices();case 4:t=e.sent,r=t.filter((function(e){return n.prevDevices_.findIndex((function(t){var r=t.deviceId;return e.deviceId===r}))<0})),i=this.prevDevices_.filter((function(e){return t.findIndex((function(t){var r=t.deviceId;return e.deviceId===r}))<0})),r.length>0&&this.handleDeviceAdded(this.prevDevices_,r),i.length>0&&this.handleDeviceRemoved(t,i),this.prevDevices_=t;case 10:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"setLocalStream",value:(t=o(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}return e.next=3,wy.getDevices();case 3:this.prevDevices_=e.sent;case 4:this.localStream_=t;case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"handleDeviceAdded",value:function(e,t){this.log_.warn("devicesAdded: ".concat(JSON.stringify(t))),this.localStream_.updateDeviceIdInUse();var r=t.filter((function(e){return e.kind===du})),i=t.filter((function(e){return e.kind===uu})),n=e.filter((function(e){return e.kind===du})),o=e.filter((function(e){return e.kind===uu})),s=r.length>0&&0===n.length&&this.localStream_.getVideo(),a=i.length>0&&0===o.length&&this.localStream_.getAudio();if(a&&s)return this.log_.info("new microphone and camera detected, but there was no device before."),void this.localStream_.updateStream({audio:!0,video:!0,cameraId:r[0].deviceId,microphoneId:i[0].deviceId});s&&(this.log_.info("new camera detected, but there was no camera before."),this.localStream_.updateStream({audio:!1,video:!0,cameraId:r[0].deviceId})),a&&(this.log_.info("new microphone detected, but there was no microphone before."),this.localStream_.updateStream({audio:!0,video:!1,microphoneId:i[0].deviceId}))}},{key:"handleDeviceRemoved",value:function(e,t){this.log_.warn("devicesRemoved: ".concat(JSON.stringify(t))),this.localStream_.updateDeviceIdInUse();var r=!1,i=!1,n=this.localStream_.getCameraId(),o=this.localStream_.getMicrophoneId();if("default"===o){var s=this.localStream_.getMicrophoneGroupId(),a=e.filter((function(e){return"default"===e.deviceId&&e.kind===uu}))[0];a&&a.groupId!==s&&(i=!0)}if(t.forEach((function(e){var t=e.deviceId;n.length>0&&t===n?r=!0:o.length>0&&t===o&&(i=!0)})),r&&i)return this.log_.warn("current camera and microphone in use is lost, cameraId: ".concat(n,", microphoneId: ").concat(o)),void((this.localStream_.getAudio()||this.localStream_.getVideo())&&this.localStream_.updateStream({video:!0,audio:!0}));r&&(this.log_.warn("current camera in use is lost, deviceId: ".concat(n)),this.localStream_.getVideo()&&this.localStream_.updateStream({video:!0,audio:!1})),i&&(this.log_.warn("current microphone in use is lost, deviceId: ".concat(o)),this.localStream_.getAudio()&&this.localStream_.updateStream({video:!1,audio:!0}))}}]),e}(),OE=function(e){var t=Ln(j(this)),r="",i=tt(e);if(i<0||1/0==i)throw RangeError("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(t+=t))1&i&&(r+=t);return r},NE=1..toFixed,LE=Math.floor,PE=function(e,t,r){return 0===t?r:t%2==1?PE(e,t-1,r*e):PE(e*e,t/2,r)},DE=function(e,t,r){for(var i=-1,n=r;++i<6;)n+=t*e[i],e[i]=n%1e7,n=LE(n/1e7)},ME=function(e,t){for(var r=6,i=0;--r>=0;)i+=e[r],e[r]=LE(i/t),i=i%t*1e7},xE=function(e){for(var t=6,r="";--t>=0;)if(""!==r||0===t||0!==e[t]){var i=String(e[t]);r=""===r?i:r+OE.call("0",7-i.length)+i}return r},BE=NE&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!N((function(){NE.call({})}));It({target:"Number",proto:!0,forced:BE},{toFixed:function(e){var t,r,i,n,o=la(this),s=tt(e),a=[0,0,0,0,0,0],c="",l="0";if(s<0||s>20)throw RangeError("Incorrect fraction digits");if(o!=o)return"NaN";if(o<=-1e21||o>=1e21)return String(o);if(o<0&&(c="-",o=-o),o>1e-21)if(r=(t=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t}(o*PE(2,69,1))-69)<0?o*PE(2,-t,1):o/PE(2,t,1),r*=4503599627370496,(t=52-t)>0){for(DE(a,0,r),i=s;i>=7;)DE(a,1e7,0),i-=7;for(DE(a,PE(10,i,1),0),i=t-1;i>=23;)ME(a,1<<23),i-=23;ME(a,1<<i),DE(a,1,1),ME(a,2),l=xE(a)}else DE(a,0,r),DE(a,1<<-t,0),l=xE(a)+OE.call("0",s);return s>0?c+((n=l.length)<=s?"0."+OE.call("0",s-n)+l:l.slice(0,n-s)+"."+l.slice(n-s)):c+l}});var UE,FE=window.AudioContext||window.webkitAudioContext,VE=null,jE=function(){function e(){var t=this;s(this,e),VE||(VE=new FE),this.context_=VE,this.instant_=0,this.slow_=0,this.clip_=0,this.script_=this.context_.createScriptProcessor(2048,1,1),this.script_.onaudioprocess=function(e){var r,i=e.inputBuffer.getChannelData(0),n=0,o=0;for(r=0;r<i.length;++r)n+=i[r]*i[r],Math.abs(i[r])>.99&&(o+=1);t.instant_=Math.sqrt(n/i.length),t.slow_=.95*t.slow_+.05*t.instant_,t.clip_=o/i.length}}return c(e,[{key:"connectToSource",value:function(e,t){try{var r=new MediaStream;r.addTrack(e),this.mic_=this.context_.createMediaStreamSource(r),this.mic_.connect(this.script_),this.script_.connect(this.context_.destination),Yd(t)||t(null)}catch(ky){Tf.error("soundMeter connectToSource error: "+ky),Yd(t)||t(ky)}}},{key:"stop",value:function(){this.mic_.disconnect(),this.script_.disconnect()}},{key:"resume",value:function(){this.context_&&this.context_.resume()}},{key:"getVolume",value:function(){return this.instant_.toFixed(2)}}]),e}(),GE=function(){function e(t){s(this,e),this.stream_=t.stream,this.userId_=t.stream.getUserId(),this.log_=this.stream_.getLogger(),this.track_=t.track,this.div_=t.div,this.muted_=t.muted,this.outputDeviceId_=t.outputDeviceId,this.volume_=t.volume,this.emitter_=new fh,this.initializeElement(),this.state_="NONE",this.soundMeter_=null}var t,r,i,n;return c(e,[{key:"isPlaying",get:function(){return"PLAYING"===this.state_}},{key:"initializeElement",value:function(){var e=new MediaStream;e.addTrack(this.track_);var t=document.createElement(Jl);t.srcObject=e,t.muted=this.muted_,t.setAttribute("id","audio_".concat(this.stream_.getId())),t.setAttribute("autoplay","autoplay"),t.setAttribute("playsinline","playsinline"),this.div_.appendChild(t),this.element_=t,this.handleEvents()}},{key:"play",value:(n=o(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.outputDeviceId_){e.next=3;break}return e.next=3,this.element_.setSinkId(this.outputDeviceId_);case 3:return this.setVolume(this.volume_),e.prev=4,e.next=7,this.element_.play();case 7:e.next=15;break;case 9:if(e.prev=9,e.t0=e.catch(4),this.log_.warn("<audio> play() error: "+e.t0),!(t=e.t0.toString()+" <audio>").startsWith("NotAllowedError")){e.next=15;break}throw new Vd({code:Fd.PLAY_NOT_ALLOWED,message:t});case 15:case"end":return e.stop()}}),e,this,[[4,9]])}))),function(){return n.apply(this,arguments)})},{key:"handleEvents",value:function(){this.handleElementEvent=this.handleElementEvent.bind(this),this.handleTrackEvent=this.handleTrackEvent.bind(this),this.element_.addEventListener(su,this.handleElementEvent),this.element_.addEventListener(ou,this.handleElementEvent),this.element_.addEventListener(au,this.handleElementEvent),this.element_.addEventListener(cu,this.handleElementEvent),this.track_.addEventListener(ou,this.handleTrackEvent),this.track_.addEventListener(iu,this.handleTrackEvent),this.track_.addEventListener(nu,this.handleTrackEvent),this.track_.readyState===ou&&this.handleTrackEvent({type:ou}),this.track_.muted&&this.handleTrackEvent({type:iu})}},{key:"handleElementEvent",value:(i=o(regeneratorRuntime.mark((function e(t){var r,i,n,o,s,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.type,e.t0=r,e.next=e.t0===su?4:e.t0===ou?9:e.t0===au?12:e.t0===cu?16:27;break;case 4:return this.log_.info("stream - audio player is starting playing"),this.state_="PLAYING",gh.emit(Dh,{stream:this.stream_}),this.emitter_.emit(IE,{state:this.state_,reason:su}),e.abrupt("break",27);case 9:return this.log_.info("stream - audio player is ended"),"STOPPED"!==this.state_&&(this.state_="STOPPED",this.emitter_.emit(IE,{state:this.state_,reason:ou})),e.abrupt("break",27);case 12:return this.log_.info("stream - audio player is paused"),this.state_="PAUSED",this.emitter_.emit(IE,{state:this.state_,reason:au}),e.abrupt("break",27);case 16:if(!this.element_||!this.element_.error){e.next=26;break}return i="".concat(Kv(),"/").concat(jc().name,"/").concat(jc().version),e.next=20,wy.getSpeakers();case 20:n=e.sent,o=n[0].label,(s=n.find((function(e){return e.deviceId===a.outputDeviceId_})))&&(o=s.label),this.log_.error("stream - audio player error observed. code: ".concat(this.element_.error.code," message: ").concat(this.element_.error.message," deviceInfo: ").concat(i," speaker: ").concat(o)),jd.uploadEvent("stat-".concat(this.stream_.getType(),"-audio-").concat(Vl,"-").concat(this.element_.error.code,"-").concat(i,"-").concat(o),this.element_.error);case 26:return e.abrupt("break",27);case 27:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"handleTrackEvent",value:function(e){var t=e.type;switch(t){case ou:this.log_.info("stream - audio player track is ended"),"STOPPED"!==this.state_&&(this.state_="STOPPED",this.emitter_.emit(IE,{state:this.state_,reason:ou})),gh.emit(Xh,{stream:this.stream_,type:t});break;case iu:this.log_.info("stream - audio track is unable to provide media output"),this.stream_.isRemote()||ph(),"PAUSED"!==this.state_&&(this.state_="PAUSED",this.emitter_.emit(IE,{state:this.state_,reason:iu})),gh.emit(Jh,{stream:this.stream_,type:t});break;case nu:this.log_.info("stream - audio track is able to provide media output"),"PAUSED"===this.state_&&(this.state_="PLAYING",this.emitter_.emit(IE,{state:this.state_,reason:nu}))}}},{key:"unbindEvents",value:function(){this.element_&&(this.element_.removeEventListener(su,this.handleElementEvent),this.element_.removeEventListener(ou,this.handleElementEvent),this.element_.removeEventListener(au,this.handleElementEvent),this.element_.removeEventListener(cu,this.handleElementEvent)),this.track_&&(this.track_.removeEventListener(ou,this.handleTrackEvent),this.track_.removeEventListener(iu,this.handleTrackEvent),this.track_.removeEventListener(nu,this.handleTrackEvent))}},{key:"setSinkId",value:(r=o(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.outputDeviceId_===t){e.next=4;break}return e.next=3,this.element_.setSinkId(t);case 3:this.outputDeviceId_=t;case 4:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"setVolume",value:function(e){this.log_.info("stream - audioElement setVolume to : ".concat(e)),this.element_.volume=e}},{key:"getAudioLevel",value:function(){return this.soundMeter_||(this.soundMeter_=new jE,this.soundMeter_.connectToSource(this.track_)),this.soundMeter_.getVolume()}},{key:"stop",value:function(){this.unbindEvents(),this.div_.removeChild(this.element_),this.element_.srcObject=null,this.soundMeter_&&(this.soundMeter_.stop(),this.soundMeter_=null),this.element_=null}},{key:"resume",value:(t=o(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.soundMeter_&&this.soundMeter_.resume(),e.next=4,this.element_.play();case 4:e.next=12;break;case 6:if(e.prev=6,e.t0=e.catch(0),this.log_.warn("<audio> play() error: "+e.t0),!(t=uv({key:Pm,data:{error:e.t0}})).startsWith("NotAllowedError")){e.next=12;break}throw new Vd({code:Fd.PLAY_NOT_ALLOWED,message:t});case 12:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(){return t.apply(this,arguments)})},{key:"on",value:function(e,t){this.emitter_.on(e,t)}}]),e}(),HE=$e.PROPER,QE=ga.trim;It({target:"String",proto:!0,forced:(UE="trim",N((function(){return!!ua[UE]()||"​᠎"!=="​᠎"[UE]()||HE&&ua[UE].name!==UE})))},{trim:function(){return QE(this)}});var WE="".concat("trtc_autoplay","_mask"),qE="".concat("trtc_autoplay","_wrapper"),zE="".concat("trtc_autoplay","_header"),ZE="".concat("trtc_autoplay","_content"),YE="".concat("trtc_autoplay","_action_wrapper"),KE="".concat("trtc_autoplay","_question"),$E="".concat("trtc_autoplay","_collapse"),JE="".concat("trtc_autoplay","_action_confirm"),XE="".concat("trtc_autoplay","_detail"),eA="".concat("dialog","-show"),tA="".concat("dialog","-1"),rA="".concat("dialog","-2"),iA=!1,nA=function(){return!!document.querySelector(".".concat(qE))},oA="".concat(Iu,"/").concat(hh()?"zh-cn":"en","/tutorial-21-advanced-auto-play-policy.html"),sA="<br><a href='".concat(oA,"' target='_blank'>").concat(hh()?"其他方案？":"Any other solution?","</a>"),aA="".concat(hh()?"浏览器自动播放策略：在用户与页面产生交互（点击、触摸）之前，浏览器禁止播放有声媒体。该弹窗用于帮助用户恢复音视频播放。".concat(sA):"Autoplay Policy: Before user interacts with the web page (clicking, touching), page will not be allowed to play media with sound. This Dialog is used to help users resume playback. ".concat(sA)),cA=function(){function e(){if(s(this,e),this.dialogNode_=null,this.bodyPosition_="",this.content="音视频播放被浏览器拦截，请点击“恢复播放”。",hh()||(this.content='Media playback failed. Click the "Resume" to resume playback.'),!iA){var t=document.createElement("style");t.innerHTML=".".concat(WE,"{position:fixed;top:0;left:0;right:0;bottom:0;width:100vw;height:100vh;display:flex;justify-content:center;align-items:center;background:rgba(0,0,0,0.5);z-index:1500;}.").concat(WE," div:not(.").concat(YE,"){display:block !important;}.").concat(qE,"{padding:14px;background:#fff;border-radius:3px;box-shadow:0px 3px 15px #434343;border:1px solid #d1cfcf;max-width:500px;}.").concat(qE," a{color:").concat("#2473E8",";}.").concat(zE,"{overflow:hidden;text-overflow:ellipsis;font-size:16px;font-weight:600;}.").concat(ZE,"{margin:8px 0;}.").concat(YE,"{width:100%;display:flex !important;align-items:center;justify-content:right;float:right;}.").concat($E,"{margin-right:auto;cursor:pointer}.").concat(KE,"{height:100%;line-height:16px;cursor:pointer;}.").concat(JE,"{margin-left:8px;color:#fff;background:").concat("#2473E8",";padding:4px 12px;outline:none;border:1px solid;border-radius:3px;font-weight:bold;}.").concat(JE,":hover{opacity:0.9;}.").concat($E,",.").concat(JE,",.").concat(ZE,",.").concat(KE,"{font-size:14px;}@media screen and (max-width:750px){.").concat(qE,"{width:80vw;}}"),document.head.appendChild(t),iA=!0}this.showDetail_=!1,this.isCollapseClicked_=!1,this.isQuestionClicked_=!1,this.addDiaLog()}return c(e,[{key:"createDiaLog",value:function(){var e=document.createElement("template");e.innerHTML='<div class="'.concat(WE,"\"><div class='").concat(qE,"'><div class='").concat(zE,"'>").concat(location.host,"</div><div class='").concat(ZE,"'>").concat(this.content,"</div><div class='").concat(XE,'\' style="visibility:hidden;width:100%;height:0;font-size:12px;color:gray;">').concat(aA,"</div><div class='").concat(YE,"'></div></div></div>").trim();var t=document.createElement("button");t.className=JE,t.innerText=hh()?"恢复播放":"Resume",t.onclick=this.onConfirm.bind(this);var r=document.createElement("div");r.className=KE,r.innerHTML='<?xml version="1.0" encoding="UTF-8"?>\n    <svg class="icon" width="18" height="18" p-id="2030" t="1639646523624" version="1.1" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">\n    <path d="m464 784.35c0 26.51 21.49 48 48 48s48-21.49 48-48-21.49-48-48-48-48 21.49-48 48z" p-id="2031"/>\n    <path d="m512 960c-247.04 0-448-200.96-448-448s200.96-448 448-448 448 200.96 448 448-200.96 448-448 448zm0-831.71c-211.58 0-383.71 172.13-383.71 383.71 0 211.55 172.13 383.71 383.71 383.71 211.55 0 383.71-172.16 383.71-383.71 0-211.58-172.16-383.71-383.71-383.71z" p-id="2032"/>\n    <path d="m512 673.7c-17.665 0-32.001-14.336-32.001-31.999v-54.112c0-52.353 40-92.352 75.328-127.65 25.887-25.92 52.672-52.672 52.672-74.017 0-53.343-43.072-96.735-95.999-96.735-53.823 0-95.999 41.536-95.999 94.559 0 17.665-14.336 31.999-32.001 31.999s-32.001-14.336-32.001-31.999c0-87.424 71.775-158.56 160-158.56s160 72.095 160 160.74c0 47.904-36.32 84.192-71.424 119.3-27.84 27.776-56.576 56.512-56.576 82.336v54.112c0 17.665-14.336 32.032-32.001 32.032z" p-id="2033"/>\n    </svg>\n    ',r.onclick=this.onQuestionClick.bind(this);var i=document.createElement("div");i.className=$E,i.innerText="".concat(hh()?"详情 >":"Detail >"),i.onclick=this.onCollapseClick.bind(this);var n=e.content.firstChild,o=n.querySelector(".".concat(YE));return o.appendChild(i),o.appendChild(r),o.appendChild(t),n}},{key:"addDiaLog",value:function(){nA()||(this.dialogNode_=this.createDiaLog(),document.body.appendChild(this.dialogNode_),this.dialogNode_.onclick=this.onConfirm.bind(this),this.dialogNode_.querySelector(".".concat(qE)).onclick=function(e){return e.stopPropagation()},this.bodyPosition_=document.body.style.position,document.body.style.position="fixed",Tf.warn("show autoplay dialog"),jd.uploadEvent({log:eA}))}},{key:"deleteDiaLog",value:function(){this.dialogNode_&&(document.body.removeChild(this.dialogNode_),document.body.style.position=this.bodyPosition_,this.dialogNode_=null)}},{key:"onConfirm",value:function(){Tf.warn("confirm clicked, try resume stream"),gh.emit(ip),this.deleteDiaLog()}},{key:"onCollapseClick",value:function(){var e=this.dialogNode_.querySelector(".".concat(XE));e.style.visibility="".concat(this.showDetail_?"hidden":"visible"),e.style.height="".concat(this.showDetail_?0:"fit-content"),this.showDetail_=!this.showDetail_,this.isCollapseClicked_||jd.uploadEvent({log:tA}),this.isCollapseClicked_=!0}},{key:"onQuestionClick",value:function(){window.open(oA,"_blank"),this.isQuestionClicked_||jd.uploadEvent({log:rA}),this.isQuestionClicked_=!0}}]),e}(),lA=function(){function e(t){s(this,e),this.stream_=t.stream,this.userId_=t.stream.getUserId(),this.log_=this.stream_.getLogger(),this.track_=t.track,this.div_=t.div,this.muted_=t.muted,this.objectFit_=t.objectFit,this.mirror_=t.mirror,this.emitter_=new fh,this.initializeElement(),this.state_="NONE",this.pausedRetryCount_=5}var t,r;return c(e,[{key:"isPlaying",get:function(){return"PLAYING"===this.state_}},{key:"initializeElement",value:function(){var e=new MediaStream;e.addTrack(this.track_);var t=document.createElement(Xl);t.srcObject=e,t.muted=!0;var r="width: 100%; height: 100%; object-fit: ".concat(this.objectFit_,";");this.mirror_&&(r+="transform: rotateY(180deg);"),t.setAttribute("id","video_".concat(this.stream_.getId())),t.setAttribute("style",r),t.setAttribute("autoplay","autoplay"),t.setAttribute("playsinline","playsinline"),this.div_&&this.div_.appendChild(t),this.element_=t,this.handleEvents()}},{key:"setRect",value:function(e){var t=e.width,r=e.height;this.element_&&(this.element_.style.width=t+"px",this.element_.style.height=r+"px")}},{key:"play",value:(r=o(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.element_.play();case 3:e.next=11;break;case 5:if(e.prev=5,e.t0=e.catch(0),this.log_.warn("<video> play() error: "+e.t0),!(t=e.t0.toString()+" <video>").startsWith("NotAllowedError")){e.next=11;break}throw new Vd({code:Fd.PLAY_NOT_ALLOWED,message:t});case 11:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(){return r.apply(this,arguments)})},{key:"handleEvents",value:function(){this.handleElementEvent=this.handleElementEvent.bind(this),this.handleTrackEvent=this.handleTrackEvent.bind(this),this.element_.addEventListener(su,this.handleElementEvent),this.element_.addEventListener(ou,this.handleElementEvent),this.element_.addEventListener(au,this.handleElementEvent),this.element_.addEventListener(cu,this.handleElementEvent),this.element_.addEventListener(lu,this.handleElementEvent),this.track_.addEventListener(ou,this.handleTrackEvent),this.track_.addEventListener(iu,this.handleTrackEvent),this.track_.addEventListener(nu,this.handleTrackEvent),this.track_.readyState===ou&&this.handleTrackEvent({type:ou}),this.track_.muted&&this.handleTrackEvent({type:iu})}},{key:"handleElementEvent",value:function(e){switch(e.type){case su:this.log_.info("stream - video player is starting playing"),this.state_="PLAYING",gh.emit(Ph,{stream:this.stream_}),this.emitter_.emit(IE,{state:this.state_,reason:su});break;case ou:this.log_.info("stream - video player is ended"),"STOPPED"!==this.state_&&(this.state_="STOPPED",this.emitter_.emit(IE,{state:this.state_,reason:ou}));break;case au:this.log_.info("stream - video player is paused"),this.state_="PAUSED",this.emitter_.emit(IE,{state:this.state_,reason:au}),this.pausedRetryCount_>0&&!nA()&&(this.log_.info("auto resume when video paused"),this.resume(),this.pausedRetryCount_--);break;case cu:if(this.element_&&this.element_.error){var t="".concat(Kv(),"/").concat(jc().name,"/").concat(jc().version);this.log_.error("stream - video player error observed. code: ".concat(this.element_.error.code," message: ").concat(this.element_.error.message," deviceInfo: ").concat(t)),jd.uploadEvent("stat-".concat(this.stream_.getType(),"-video-").concat(Vl,"-").concat(this.element_.error.code,"-").concat(t),this.element_.error)}break;case lu:gh.emit(Yh,{stream:this.stream_})}}},{key:"handleTrackEvent",value:function(e){var t=e.type;switch(t){case ou:this.log_.info("stream - video player track is ended"),"STOPPED"!==this.state_&&(this.state_="STOPPED",this.emitter_.emit(IE,{state:this.state_,reason:ou})),gh.emit($h,{stream:this.stream_,type:t});break;case iu:this.log_.info("stream - video track is unable to provide media output"),this.stream_.isRemote()||ph(),"PAUSED"!==this.state_&&(this.state_="PAUSED",this.emitter_.emit(IE,{state:this.state_,reason:iu})),gh.emit(qh,{stream:this.stream_,type:t});break;case nu:this.log_.info("stream - video track is able to provide media output"),"PAUSED"===this.state_&&(this.state_="PLAYING",this.emitter_.emit(IE,{state:this.state_,reason:nu}),gh.emit(zh,{stream:this.stream_}))}}},{key:"unbindEvents",value:function(){this.element_&&(this.element_.removeEventListener(su,this.handleElementEvent),this.element_.removeEventListener(ou,this.handleElementEvent),this.element_.removeEventListener(au,this.handleElementEvent),this.element_.removeEventListener(cu,this.handleElementEvent),this.element_.removeEventListener(lu,this.handleElementEvent)),this.track_&&(this.track_.removeEventListener(ou,this.handleTrackEvent),this.track_.removeEventListener(iu,this.handleTrackEvent),this.track_.removeEventListener(nu,this.handleTrackEvent))}},{key:"stop",value:function(){this.unbindEvents(),this.div_&&this.div_.removeChild(this.element_),this.element_.srcObject=null,this.element_=null}},{key:"resume",value:(t=o(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.element_.play();case 3:e.next=11;break;case 5:if(e.prev=5,e.t0=e.catch(0),this.log_.warn("<video> play() error: "+e.t0),!(t=uv({key:Dm,data:{error:e.t0}})).startsWith("NotAllowedError")){e.next=11;break}throw new Vd({code:Fd.PLAY_NOT_ALLOWED,message:t});case 11:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(){return t.apply(this,arguments)})},{key:"getVideoFrame",value:function(){var e=document.createElement("canvas");return e.width=this.element_.videoWidth,e.height=this.element_.videoHeight,e.getContext("2d").drawImage(this.element_,0,0),e.toDataURL("image/png")}},{key:"on",value:function(e,t){this.emitter_.on(e,t)}},{key:"getElement",value:function(){return this.element_?this.element_:null}}]),e}(),uA=function(){function e(t){s(this,e),this.userId_=t.userId,this.tinyId_=t.tinyId,this.client_=t.client,this.sdpSemantics_=t.client.getSdpSemantics(),this.isUplink_=t.isUplink,this.log_=Tf.createLogger({id:"n|"+this.userId_,userId:this.client_.getUserId(),sdkAppId:this.client_.getSDKAppId(),isLocal:this.isUplink_}),this.signalChannel_=t.signalChannel,this.peerConnection_=null,this.connectTimer_=-1,this.isErrorObserved_=!1,this.emitter_=new fh,this.currentState_=ol,this.waitForPeerConnectionConnectedPromise_=null,this.isReconnecting_=!1,this.reconnectionCount_=0,this.reconnectionTimer_=-1,this.isFirstConnection_=!0}var t;return c(e,[{key:"initialize",value:function(){var e={iceServers:this.client_.getIceServers(),iceTransportPolicy:this.client_.getIceTransportPolicy(),sdpSemantics:this.sdpSemantics_,bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",tcpCandidatePolicy:"disable",IceTransportsType:"nohost"};this.peerConnection_=new RTCPeerConnection(e),this.peerConnection_.onconnectionstatechange=this.onConnectionStateChange.bind(this)}},{key:"close",value:function(){this.log_.info("closing connection"),this.closePeerConnection()}},{key:"closePeerConnection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.peerConnection_&&(this.peerConnection_.onconnectionstatechange=function(){},this.peerConnection_.close(),this.peerConnection_=null,e&&this.emitConnectionStateChangedEvent(ol))}},{key:"getDTLSTransportState",value:function(){if(!this.peerConnection_)return"unknown";var e=null;if(this.isUplink_){if(!Gv()||0===this.peerConnection_.getSenders().length)return"unknown";e=this.peerConnection_.getSenders()[0].transport}else{if(!jv()||0===this.peerConnection_.getReceivers().length)return"unknown";e=this.peerConnection_.getReceivers()[0].transport}return e?e.state:"unknown"}},{key:"onConnectionStateChange",value:function(e){var t=this.peerConnection_.iceConnectionState,r=this.getDTLSTransportState();if(this.log_.info("onConnectionStateChange() connectionState: "+e.target.connectionState),this.log_.info("ICE Transport state: ".concat(t,", DTLS Transport state: ").concat(r)),e.target.connectionState===ul&&this.emitConnectionStateChangedEvent(sl),e.target.connectionState===dl||e.target.connectionState===hl){var i="".concat(this.isUplink_?"uplink":"downlink"," ICE/DTLS Transport connection ").concat(e.target.connectionState,". ICE Transport state: ").concat(t,", DTLS Transport state: ").concat(r),n=new Vd({message:i,code:Fd.ICE_TRANSPORT_ERROR});jd.logFailedEvent({userId:this.client_.getUserId(),eventType:Ll,error:n}),this.emitConnectionStateChangedEvent(ol),this.isErrorObserved_||this.emitter_.emit(oE,n)}if((e.target.connectionState===fl||e.target.connectionState===gl)&&(this.logSelectedCandidate(),jd.logSuccessEvent({userId:this.client_.getUserId(),eventType:Ll}),this.emitConnectionStateChangedEvent(cl),!this.isUplink_&&!this.sentSubscriptionAfterConnected_&&this.pendingSubscription_.length>0)){this.log_.info("send pending subscription after RTCPeerConnection is connected");var o=this.pendingSubscription_[0];this.doSendSubscription(o.data,o.stream,o.type),this.sentSubscriptionAfterConnected_=!0}}},{key:"emitConnectionStateChangedEvent",value:function(e){e!==this.currentState_&&(this.currentState_===al&&e===sl||(gh.emit(ep,{client:this.client_,connection:this,prevState:this.currentState_,state:e}),this.emitter_.emit(sE,{prevState:this.currentState_,state:e}),this.currentState_=e))}},{key:"hitTest",value:function(e){return(0===e||"0"===e)&&this.isUplink_||e===this.tinyId_}},{key:"addEventInternal",value:function(e,t){var r=this.client_.getUserId(),i={eventId:e,eventDesc:t,timestamp:Es(),userId:r,tinyId:this.client_.getTinyId()};this.isUplink_||(i.remoteUserId=this.userId_,i.remoteTinyId=this.tinyId_),hm(r,i)}},{key:"getPeerConnection",value:function(){return this.peerConnection_}},{key:"getClient",value:function(){return this.client_}},{key:"getUserId",value:function(){return this.userId_}},{key:"getTinyId",value:function(){return this.tinyId_}},{key:"logSelectedCandidate",value:(t=o(regeneratorRuntime.mark((function e(){var t,r,i,n,o,s,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.peerConnection_){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.peerConnection_.getStats();case 4:t=e.sent,r=C(t),e.prev=6,r.s();case 8:if((i=r.n()).done){e.next=18;break}if((n=E(i.value,2))[0],o=n[1],!Zv(o)){e.next=16;break}return s=t.get(o.localCandidateId),a=t.get(o.remoteCandidateId),s&&this.log_.info("local candidate: ".concat(s.candidateType," ").concat(s.protocol,":").concat(s.ip||s.address,":").concat(s.port," ").concat(s.networkType||""," ").concat("relay"===s.candidateType?"relayProtocol:"+s.relayProtocol:"")),a&&this.log_.info("remote candidate: ".concat(a.candidateType," ").concat(a.protocol,":").concat(a.ip||a.address,":").concat(a.port)),e.abrupt("break",18);case 16:e.next=8;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(6),r.e(e.t0);case 23:return e.prev=23,r.f(),e.finish(23);case 26:case"end":return e.stop()}}),e,this,[[6,20,23,26]])}))),function(){return t.apply(this,arguments)})},{key:"getCurrentState",value:function(){return this.currentState_}},{key:"waitForPeerConnectionConnected",value:function(){var e=this;return this.waitForPeerConnectionConnectedPromise_||(this.waitForPeerConnectionConnectedPromise_=new Promise((function(t,r){if(e.currentState_===cl)return t();var i=-1,n=function r(n){n.state===cl&&(clearTimeout(i),e.emitter_.off(sE,r,e),t())};i=setTimeout((function(){e.emitter_.off(sE,n,e);var t=new Vd({code:Fd.API_CALL_TIMEOUT,message:"connection timeout"});e.peerConnection_||e.isUplink_||(t=e.genRemoteStreamNotExistError()),r(t)}),1e4),e.emitter_.on(sE,n,e)})),this.waitForPeerConnectionConnectedPromise_=this.waitForPeerConnectionConnectedPromise_.then((function(t){return e.waitForPeerConnectionConnectedPromise_=null,t})).catch((function(t){throw e.waitForPeerConnectionConnectedPromise_=null,t}))),this.waitForPeerConnectionConnectedPromise_}},{key:"getReconnectionCount",value:function(){return this.reconnectionCount_}},{key:"startReconnection",value:function(){this.isReconnecting_=!0,this.emitConnectionStateChangedEvent(al),this.reconnect(),this.addEventInternal(this.isUplink_?om:cm,"".concat(this.isUplink_?"uplink":"downlink","-connection is reconnecting"))}},{key:"stopReconnection",value:function(){this.log_.info("stop reconnection"),this.isReconnecting_=!1,this.reconnectionCount_=0,this.clearReconnectionTimer(),this.signalChannel_.off(eg,this.reconnect,this)}},{key:"on",value:function(e,t,r){this.emitter_.on(e,t,r)}},{key:"off",value:function(e,t,r){this.emitter_.off(e,t,r)}},{key:"genRemoteStreamNotExistError",value:function(){return new Vd({code:Fd.REMOTE_STREAM_NOT_EXIST,message:"because the remote user ".concat(this.userId_," unpublished stream")})}}]),e}();function dA(e,t,r,i){if(this.useStringRoomId_){if(!Kd(e)||!/^[A-Za-z\d\s!#$%&()+\-:;<=.>?@[\]^_{}|~,]{1,64}$/.test(e))throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:Gm,data:t,link:{className:i,fnName:r}})})}else if(!($d(e)&&/^[1-9]\d*$/.test(String(e))&&e<4294967295))throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:Hm,data:t,link:{className:i,fnName:r}})})}function hA(e,t,r,i){if(!/^[A-Za-z\d_-]*$/.test(e))throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:l_,data:t,link:{className:i,fnName:r}})})}var pA,fA,gA={TRTC:{createClient:{name:"clientConfig",required:!0,type:Kl,properties:{sdkAppId:{required:!0,type:zl,allowEmpty:!1},userId:{required:!0,type:ql,allowEmpty:!1},userSig:{required:!0,type:ql,allowEmpty:!1},mode:{required:!0,type:ql,values:["rtc","live"]},useStringRoomId:{type:Zl},autoSubscribe:{type:Zl},enableAutoPlayDialog:{type:Zl},streamId:{type:ql},userDefineRecordId:{type:ql},pureAudioPushMode:{type:zl,values:[1,2]}}},createStream:{name:"streamConfig",required:!0,type:Kl,properties:{userId:{type:ql},audio:{type:Zl},video:{type:Zl},screen:{type:Zl},screenAudio:{type:Zl},microphoneId:{type:ql},cameraId:{type:ql},facingMode:{type:ql,values:[tu,ru]},audioSource:{instanceOf:MediaStreamTrack},videoSource:{instanceOf:MediaStreamTrack},mirror:{type:Zl}},validate:function(e){if(!Yd(e.screen)&&e.screen&&Yd(e.audio)&&(e.audio=!1),!(Yd(e.audio)&&Yd(e.video)||Yd(e.audioSource)&&Yd(e.videoSource)))throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:Z_})});if(!Yd(e.screen)&&!0===e.screen&&!0===e.video)throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:Y_})});if(e.audio&&e.screenAudio)throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:K_})});if(!0!==e.screen&&!0===e.screenAudio)throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:$_})});if(!Yd(e.screen)&&!0===e.screen&&!this.isScreenShareSupported())throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:nv})})}}},CLIENT:{join:{name:"options",required:!0,properties:{roomId:{required:!0,type:[zl,ql],allowEmpty:!1,validate:dA},role:{type:[ql],values:["anchor","audience"]}}},publish:{name:"stream",required:!0,instanceOf:Cu,validate:function(e){if(!this.isJoined_)throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:Ym})});if("live"===this.mode_&&"audience"===this.role_)throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:$m})});if(this.localStream_)throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:Xm})});if(!e.getIsReadyToPublish())throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:Jm})});if(this.notPublishWithoutH264Supported_)throw new Vd({code:Fd.NOT_SUPPORTED_H264,message:uv({key:tv})})}},unpublish:{name:"stream",required:!0,instanceOf:Cu,validate:function(e){if(e!==this.localStream_)throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:Km})})}},subscribe:[{name:"stream",required:!0,instanceOf:Tu,validate:function(e){if(!e.getConnection())throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:e_})});if(this.notSubscribeWithoutH264Supported_)throw new Vd({code:Fd.NOT_SUPPORTED_H264,message:uv({key:rv})})}},{name:"options",type:Kl,properties:{audio:{type:Zl},video:{type:Zl}}}],unsubscribe:{name:"stream",required:!0,instanceOf:Tu,validate:function(e){if(!e.getConnection())throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:e_})})}},switchRole:{name:"role",required:!0,values:["anchor","audience"],validate:function(){if("live"!==this.mode_)throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:r_})});if(!this.isJoined_)throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:i_})})}},startPublishCDNStream:{name:"options",required:!1,properties:{streamId:{type:ql,validate:hA},appId:{type:zl,allowEmpty:!1},bizId:{type:zl,allowEmpty:!1},url:{type:ql,allowEmpty:!1}}},startMixTranscode:{name:"config",required:!0,type:Kl,properties:{mode:{type:ql,values:["preset-layout","manual"]},streamId:{type:ql,validate:hA},videoWidth:{type:zl,notLessThanZero:!0},videoHeight:{type:zl,notLessThanZero:!0},videoBitrate:{type:zl,notLessThanZero:!0,allowEmpty:!1},videoFramerate:{type:zl,validate:function(e,t,r,i){if(e<=0||e>30)throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:j_,link:{className:i,fnName:r}})})}},videoGop:{type:zl,validate:function(e,t,r,i){if(e<1||e>8)throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:G_,link:{className:i,fnName:r}})})}},audioSampleRate:{type:zl,notLessThanZero:!0},audioBitrate:{type:zl,validate:function(e,t,r,i){if(e<32||e>192)throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:H_,link:{className:i,fnName:r}})})}},audioChannels:{type:zl,values:[1,2]},backgroundColor:{type:zl},backgroundImage:{type:ql},mixUsers:{required:!0,type:Yl,arrayItem:{require:!0,type:Kl,properties:{userId:{required:!0,type:ql},roomId:{type:[ql,zl],validate:dA},pureAudio:{type:Zl},width:{type:zl,notLessThanZero:!0},height:{type:zl,notLessThanZero:!0},locationX:{type:zl,notLessThanZero:!0},locationY:{type:zl,notLessThanZero:!0},zOrder:{type:zl},streamType:{type:ql,values:["main","auxiliary"]}}}}},validate:function(e,t,r,i,n){var o=0,s=0,a=e.mixUsers,c=[];if(a.forEach((function(e,t){if(c.push(e.userId),!e.pureAudio){if(!e.zOrder||e.zOrder<1||e>15)throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:Q_,data:"config.mixUsers[".concat(t,"].zOrder"),link:{className:i,fnName:r}})});e.width+e.locationX>o&&(o=e.width+e.locationX),e.height+e.locationY>s&&(s=e.height+e.locationY)}})),c.indexOf(this.getUserId())<0)throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:W_,link:{className:i,fnName:r}})});if(e.videoWidth<o||e.videoHeight<s)throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:q_,link:{className:i,fnName:r}})})}}},LOCAL_STREAM:{switchDevice:[{name:"type",required:!0,type:ql,values:[Jl,Xl]},{name:"deviceId",required:!0,type:ql,validate:function(){if(this.screen_&&!this.audio_||this.audioSource_||this.videoSource_)throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:y_})});if(this.publishState_===vu)throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:S_})})}}]},STREAM:{play:[{name:"elementId",required:!0,type:[ql,"HTMLDivElement"],validate:function(){if(this.isPlaying_)throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:z_})})}},{name:"options",type:Kl,properties:{objectFit:{type:ql,values:["contain","cover"]},muted:{type:Zl}}}]}};function mA(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e,r,i){var n=i.value;return i.value=function(){for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return vA.call(this,t,i,r,this.name_),n.apply(this,i)},i}}function _A(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e,r,i){var n=i.value;return i.value=o(regeneratorRuntime.mark((function e(){var i,o,s,a=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=a.length,o=new Array(i),s=0;s<i;s++)o[s]=a[s];return vA.call(this,t,o,r,this.name_),e.abrupt("return",n.apply(this,o));case 3:case"end":return e.stop()}}),e,this)}))),i}}function vA(e,t,r,i){try{for(var n=0;n<e.length;n++)EA.call(this,{rule:e[n],value:t[n],key:e[n].name,fnName:r,className:i})}catch(ky){throw Tf.error(ky),ky}}function EA(e){var t=this,r=e.rule,i=e.value,n=e.key,o=e.fnName,s=e.className;if(Yd(i)){if(r.required)throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:Em,data:{key:n,rule:r,fnName:o,value:i},link:{className:s,fnName:o}})})}else{if(Array.isArray(r.type)){if(!r.type.map((function(e){return e.toLowerCase()})).includes(eh(i)))throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:Am,data:{key:n,rule:r,fnName:o,value:i},link:{className:s,fnName:o}})})}else if(!Yd(r.type)&&eh(i)!==r.type)throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:Am,data:{key:n,rule:r,fnName:o,value:i},link:{className:s,fnName:o}})});if(!1===r.allowEmpty){var a=$d(i)&&(0===i||Number.isNaN(i)),c=Kd(i)&&""===i.trim();if(a||c)throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:ym,data:{key:n,rule:r,fnName:o,value:i},link:{className:s,fnName:o}})})}if(r.notLessThanZero&&$d(i)&&i<0)throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:V_,data:{key:n,rule:r,fnName:o,value:i},link:{className:s,fnName:o}})});if(Kd(r.instanceOf)){if(!i||i.name_!==r.instanceOf)throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:Sm,data:{key:n,rule:r,fnName:o,value:i},link:{className:s,fnName:o}})})}else if(Zd(r.instanceOf)&&!(i instanceof r.instanceOf))throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:Sm,data:{key:n,rule:r,fnName:o,value:i},link:{className:s,fnName:o}})});if(r.values&&!r.values.includes(i))throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:Cm,data:{key:n,rule:r,fnName:o,value:i},link:{className:s,fnName:o}})});var l=r.properties;qd(l)&&"object"===eh(i)&&Object.keys(l).forEach((function(e){EA.call(t,{rule:l[e],value:i&&i[e],key:"".concat(n,".").concat(e),fnName:o,className:s})}));var u=r.arrayItem;qd(u)&&function(e){return"array"===eh(e)}(i)&&i.forEach((function(e,r){EA.call(t,{rule:u,value:e,key:"".concat(n,"[").concat(r,"]"),fnName:o,className:s})})),Zd(r.validate)&&r.validate.call(this,i,n,o,s,this)}}It({target:"Number",stat:!0},{isNaN:function(e){return e!=e}});var AA=(pA=_A.apply(void 0,A(gA.STREAM.play)),T((fA=function(){function e(t){s(this,e),this.name_=bu,this.userId_=t.userId,this.isRemote_=t.isRemote,this.type_=t.type,this.log_=Tf.createLogger({id:"s".concat(t.seq?t.seq:"","|").concat(this.userId_),userId:Yd(t.client)?void 0:t.client.getUserId(),sdkAppId:Yd(t.client)?void 0:t.client.getSDKAppId(),isLocal:!this.isRemote_,type:this.isRemote_?this.type_:""}),this.mirror_=!1,this.isRemote_||(this.mirror_=!0),Yd(t.mirror)||(this.mirror_=t.mirror),this.client_=null,Yd(t.client)||(this.client_=t.client),this.mediaStream_=null,this.div_=null,this.isPlaying_=!1,this.connection_=null,this.audioPlayer_=null,this.videoPlayer_=null,this.muted_=!1,this.objectFit_="cover",this.id_=Rv(),this.audioOutputDeviceId_=0,this.audioVolume_=1,this.emitter_=new fh,this.connectionState_=ol,this.installEvents()}var t,n,a,l,u;return c(e,[{key:"installEvents",value:function(){gh.on(ip,this.restartPlayback,this)}},{key:"uninstallEvents",value:function(){gh.off(ip,this.restartPlayback,this)}},{key:"getType",value:function(){return this.type_}},{key:"getLogger",value:function(){return this.log_}},{key:"isSubscribed",get:function(){return"main"===this.type_&&this.connection_.isMainStreamSubscribed||"auxiliary"===this.type_&&this.connection_.isAuxStreamSubscribed}},{key:"isMainVideoSubscribed",get:function(){var e=this.getSubscribedState();return"main"===this.type_&&e&&e.video}},{key:"isMainAudioSubscribed",get:function(){var e=this.getSubscribedState();return"main"===this.type_&&e&&e.audio}},{key:"isAuxVideoSubscribed",get:function(){var e=this.getSubscribedState();return"auxiliary"===this.type_&&e&&e.auxiliary}},{key:"emitConnectionStateChanged",value:function(e){e.state!==this.connectionState_&&(e.state!==ol&&this.isRemote_&&!this.isSubscribed||(this.emitter_.emit(TE,e),this.connectionState_=e.state))}},{key:"setConnection",value:function(e){this.connection_!==e&&(e instanceof uA?(null!==this.connection_&&this.connection_.off(sE,this.emitConnectionStateChanged,this),e.on(sE,this.emitConnectionStateChanged,this)):null===e&&this.connection_.off(sE,this.emitConnectionStateChanged,this),this.connection_=e)}},{key:"getConnection",value:function(){return this.connection_}},{key:"play",value:(u=o(regeneratorRuntime.mark((function e(t,r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isPlaying_=!0,this.log_.info("stream start to play with options: ".concat(JSON.stringify(r))),(n=document.createElement("div")).setAttribute("id","player_".concat(this.id_)),n.setAttribute("style","width: 100%; height: 100%; position: relative; background-color: black; overflow: hidden;"),o=t,"object"!==i(t)&&(o=document.getElementById(t)),o.appendChild(n),this.div_=n,this.isRemote_||(this.muted_=!0),r&&!Yd(r.muted)&&(this.muted_=r.muted),this.isRemote_&&"auxiliary"===this.getType()&&(this.objectFit_="contain"),r&&!Yd(r.objectFit)&&(this.objectFit_=r.objectFit),gh.emit(Zh,{stream:this}),e.next=16,Promise.all([this.playAudio(),this.playVideo()]);case 16:gh.emit(Nh,{stream:this});case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"playAudio",value:(l=o(regeneratorRuntime.mark((function e(){var t,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hasAudio()&&(!this.isRemote_||this.isMainAudioSubscribed)){e.next=2;break}return e.abrupt("return");case 2:if(t=this.getAudioTrack(),this.audioPlayer_||!t){e.next=17;break}return this.log_.info("stream - create AudioPlayer and play"),this.audioPlayer_=new GE({stream:this,track:t,div:this.div_,muted:this.muted_,outputDeviceId:this.audioOutputDeviceId_,volume:this.audioVolume_}),this.audioPlayer_.on(IE,(function(e){var t={type:Jl,state:e.state,reason:e.reason};gh.emit(Lh,r({stream:i},t)),i.emitter_.emit(SE,t)})),e.prev=7,e.next=10,this.audioPlayer_.play();case 10:e.next=17;break;case 12:throw e.prev=12,e.t0=e.catch(7),this.client_&&this.client_.getEnableAutoPlayDialog()&&new cA,this.emitter_.emit(bE,e.t0),e.t0;case 17:case"end":return e.stop()}}),e,this,[[7,12]])}))),function(){return l.apply(this,arguments)})},{key:"playVideo",value:(a=o(regeneratorRuntime.mark((function e(){var t,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hasVideo()&&(!this.isRemote_||this.isMainVideoSubscribed||this.isAuxVideoSubscribed)){e.next=2;break}return e.abrupt("return");case 2:if(t=this.getVideoTrack(),this.videoPlayer_||!t){e.next=18;break}return gh.emit(Kh,{stream:this}),this.log_.info("stream - create VideoPlayer and play"),this.videoPlayer_=new lA({stream:this,track:t,div:this.div_,muted:this.muted_,objectFit:this.objectFit_,mirror:this.mirror_}),this.videoPlayer_.on(IE,(function(e){var t={type:Xl,state:e.state,reason:e.reason};gh.emit(Lh,r({stream:i},t)),i.emitter_.emit(SE,t)})),e.prev=8,e.next=11,this.videoPlayer_.play();case 11:e.next=18;break;case 13:throw e.prev=13,e.t0=e.catch(8),this.client_&&this.client_.getEnableAutoPlayDialog()&&new cA,this.emitter_.emit(bE,e.t0),e.t0;case 18:case"end":return e.stop()}}),e,this,[[8,13]])}))),function(){return a.apply(this,arguments)})},{key:"stopAudio",value:function(){this.audioPlayer_&&(this.log_.info("stream - stop AudioPlayer"),this.audioPlayer_.stop(),this.audioPlayer_=null)}},{key:"stopVideo",value:function(){this.videoPlayer_&&(this.log_.info("stream - stop VideoPlayer"),this.videoPlayer_.stop(),this.videoPlayer_=null)}},{key:"restartPlayback",value:function(){this.audioPlayer_&&!this.audioPlayer_.isPlaying&&this.restartAudio(),this.videoPlayer_&&!this.videoPlayer_.isPlaying&&this.restartVideo()}},{key:"restartAudio",value:function(){this.isPlaying_&&(this.stopAudio(),this.playAudio().catch((function(e){})))}},{key:"restartVideo",value:function(){this.isPlaying_&&(this.stopVideo(),this.playVideo().catch((function(e){})))}},{key:"stop",value:function(){this.isPlaying_&&(this.isPlaying_=!1,this.stopAudio(),this.stopVideo(),this.div_.parentNode.removeChild(this.div_))}},{key:"resume",value:(n=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isPlaying_){e.next=2;break}return e.abrupt("return");case 2:if(this.log_.info("stream - resume"),!this.audioPlayer_){e.next=6;break}return e.next=6,this.audioPlayer_.resume();case 6:if(!this.videoPlayer_){e.next=9;break}return e.next=9,this.videoPlayer_.resume();case 9:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"close",value:function(){this.isPlaying_&&this.stop(),this.isRemote_||(this.mediaStream_&&(this.mediaStream_.preventEvent=1,this.mediaStream_.getTracks().forEach((function(e){e.stop()})),this.mediaStream_=null),this.uninstallEvents())}},{key:"muteAudio",value:function(){return this.addRemoteEvent(!0,Jl),this.doEnableTrack(Jl,!1)}},{key:"muteVideo",value:function(){return this.addRemoteEvent(!0,Xl),this.doEnableTrack(Xl,!1)}},{key:"unmuteAudio",value:function(){return this.addRemoteEvent(!1,Jl),this.doEnableTrack(Jl,!0)}},{key:"unmuteVideo",value:function(){return this.addRemoteEvent(!1,Xl),this.doEnableTrack(Xl,!0)}},{key:"addRemoteEvent",value:function(e,t){if(this.isRemote_&&this.client_){var r=this.client_.getUserId(),i="".concat(e?iu:nu," remote ").concat(t);hm(r,{eventId:t===Jl?e?zg:Yg:e?qg:Zg,eventDesc:i,timestamp:(new Date).getTime(),userId:r,tinyId:this.client_.getTinyId(),remoteUserId:this.userId_,remoteTinyId:this.connection_.getTinyId()})}}},{key:"doEnableTrack",value:function(e,t){var r=!1;return e===Jl?this.mediaStream_.getAudioTracks().forEach((function(e){r=!0,e.enabled=t})):this.mediaStream_.getVideoTracks().forEach((function(e){r=!0,e.enabled=t})),r}},{key:"getId",value:function(){return this.id_}},{key:"getUserId",value:function(){return this.userId_}},{key:"getTinyId",value:function(){return this.connection_?this.connection_.getTinyId():""}},{key:"isPlaying",value:function(){return this.isPlaying_}},{key:"setAudioOutput",value:(t=o(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.audioOutputDeviceId_=t,!this.audioPlayer_){e.next=4;break}return e.next=4,this.audioPlayer_.setSinkId(t);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"setAudioVolume",value:function(e){this.audioVolume_=e,this.log_.info("setAudioVolume to ".concat(e)),this.audioPlayer_&&this.audioPlayer_.setVolume(e)}},{key:"getAudioLevel",value:function(){var e=0;return this.audioPlayer_&&(e=this.audioPlayer_.getAudioLevel()),e}},{key:"hasAudio",value:function(){if(this.isRemote_){if(!this.connection_)return!1;var e=this.connection_.getTrackState();return"main"===this.type_&&e.audio}return!!this.getAudioTrack()}},{key:"hasVideo",value:function(){if(this.isRemote_){if(!this.connection_)return!1;var e=this.connection_.getTrackState();return"auxiliary"===this.type_?e.auxiliary:e.video}return!!this.getVideoTrack()}},{key:"getSubscribedState",value:function(){return this.isRemote_&&this.connection_?this.connection_.getSubscribeState():null}},{key:"getAudioTrack",value:function(){var e=null;if(this.mediaStream_){var t=this.mediaStream_.getAudioTracks();t.length>0&&(e=t[0])}return e}},{key:"getVideoTrack",value:function(){var e=null;if(this.mediaStream_){var t=this.mediaStream_.getVideoTracks();t.length>0&&(e=t[0])}return e}},{key:"getVideoFrame",value:function(){return this.videoPlayer_?this.videoPlayer_.getVideoFrame():null}},{key:"getMediaStream",value:function(){return this.mediaStream_}},{key:"setMediaStream",value:function(e){e!==this.mediaStream_&&(this.mediaStream_&&this.mediaStream_.getTracks().forEach((function(e){return e.stop()})),this.mediaStream_=e)}},{key:"updateVideoPlayingState",value:function(e){this.isPlaying_&&(e?(this.log_.info("playing state updated, play video"),this.playVideo().catch((function(e){}))):(this.log_.info("playing state updated, stop video"),this.stopVideo()))}},{key:"updateAudioPlayingState",value:function(e){this.isPlaying_&&(e?(this.log_.info("playing state updated, play audio"),this.playAudio().catch((function(e){}))):(this.log_.info("playing state updated, stop audio"),this.stopAudio()))}},{key:"on",value:function(e,t,r){this.emitter_.on(e,t,r)}},{key:"off",value:function(e,t,r){"*"===e?this.emitter_.removeAllListeners():this.emitter_.off(e,t,r)}},{key:"isRemote",value:function(){return this.isRemote_}},{key:"getDiv",value:function(){return this.div_}},{key:"getObjectFit",value:function(){return this.objectFit_}},{key:"getMuted",value:function(){return this.muted_}},{key:"getClient",value:function(){return this.client_}}]),e}()).prototype,"play",[pA],Object.getOwnPropertyDescriptor(fA.prototype,"play"),fA.prototype),fA),yA=function(e){u(i,e);var t=_(i);function i(e){var n;s(this,i);var o={isRemote:!0,type:e.type},a=r(r({},e),o);return(n=t.call(this,a)).name_=Tu,n.isInSubscriptionCycle_=!1,n.isStreamAddedEventEmitted_=!1,n.isAbleToCallSubscription_=!0,n}return c(i,[{key:"installEvents",value:function(){v(d(i.prototype),"installEvents",this).call(this),gh.on(Uh,this.handleStreamSubscribed,this),gh.on(Fh,this.handleStreamUnsubscribed,this)}},{key:"uninstallEvents",value:function(){v(d(i.prototype),"uninstallEvents",this).call(this),gh.off(Uh,this.handleStreamSubscribed,this),gh.off(Fh,this.handleStreamUnsubscribed,this)}},{key:"handleStreamSubscribed",value:function(e){e.client===this.client_&&e.stream===this&&this.connection_.getCurrentState()===cl&&this.emitConnectionStateChanged({prevState:ol,state:cl})}},{key:"handleStreamUnsubscribed",value:function(e){e.client===this.client_&&e.stream===this&&this.emitConnectionStateChanged({prevState:cl,state:ol})}},{key:"getType",value:function(){return v(d(i.prototype),"getType",this).call(this)}},{key:"getIsAbleToCallSubscription",value:function(){return this.isAbleToCallSubscription_}},{key:"setIsAbleToCallSubscription",value:function(e){this.isAbleToCallSubscription_=e}},{key:"setInSubscriptionCycle",value:function(e){this.isInSubscriptionCycle_=e}},{key:"isInSubscriptionCycle",value:function(){return this.isInSubscriptionCycle_}},{key:"setIsStreamAddedEventEmitted",value:function(e){this.isStreamAddedEventEmitted_=e}},{key:"getIsStreamAddedEventEmitted",value:function(){return this.isStreamAddedEventEmitted_}},{key:"getAudioTrack",value:function(){return this.connection_&&this.connection_.getTrackState().audio?v(d(i.prototype),"getAudioTrack",this).call(this):null}},{key:"getVideoTrack",value:function(){if(!this.connection_)return null;var e=this.connection_.getTrackState();return"main"===this.type_&&!e.video||"auxiliary"===this.type_&&!e.auxiliary?null:v(d(i.prototype),"getVideoTrack",this).call(this)}},{key:"close",value:function(){v(d(i.prototype),"close",this).call(this)}}]),i}(AA),SA=function(){function e(t){s(this,e),this.client_=t.client,this.subscribedStreams_=new Map,this.unsubscribedStreams_=new Map,this.subscriptedOptions_=new Map,this.autoRecoveryFlags_=new Map}var t,r,i;return c(e,[{key:"isEnabled",get:function(){return"webrtc"!==this.client_.getEnv()}},{key:"recover",value:(i=o(regeneratorRuntime.mark((function e(t){var r,i,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.getUserId(),i=t.getType(),this.hasAutoRecoveryFlag(r,i)){e.next=5;break}return e.abrupt("return");case 5:if(n=this.getUnsubscribedStream(r,i)?"unsubscribe":"subscribe",e.prev=6,Tf.warn("recover() try to recover subscription [".concat(n,"][").concat(r,"][").concat(i,"]")),"subscribe"!==n){e.next=13;break}return e.next=11,this.recoverSubscription(r,t);case 11:e.next=15;break;case 13:return e.next=15,this.recoverUnsubscription(r,t);case 15:jd.logSuccessEvent({userId:this.client_.getUserId(),eventType:Bl}),Tf.warn("recover() recover successfully [".concat(n,"][").concat(r,"][").concat(i,"]")),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(6),Tf.error("recover() recover failed [".concat(n,"][").concat(r,"][").concat(i,"]"),e.t0),jd.logFailedEvent({userId:this.client_.getUserId(),eventType:Bl,error:e.t0});case 23:this.deleteAutoRecoveryFlag(r,i);case 24:case"end":return e.stop()}}),e,this,[[6,19]])}))),function(e){return i.apply(this,arguments)})},{key:"recoverSubscription",value:(r=o(regeneratorRuntime.mark((function e(t,r){var i,n,o,s,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.getOptions(t,r.getType()),n=this.getSubscribedStream(t,r.getType()),i&&n){e.next=4;break}return e.abrupt("return");case 4:o=this.getStreamMuteState(n),s=o.isAudioMuted,a=o.isVideoMuted,this.mergeStream(n,r),this.recoverPlayingState(n),s&&n.doEnableTrack(Jl,!1),a&&n.doEnableTrack(Xl,!1);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"recoverUnsubscription",value:(t=o(regeneratorRuntime.mark((function e(t,r){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.getUnsubscribedStream(t,r.getType())){e.next=3;break}return e.abrupt("return");case 3:this.mergeStream(i,r);case 4:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})},{key:"getStreamMuteState",value:function(e){var t={isAudioMuted:!1,isVideoMuted:!1},r=e.getMediaStream();return r&&(t.isAudioMuted=r.getAudioTracks().map((function(e){return e.enabled})).includes(!1),t.isVideoMuted=r.getVideoTracks().map((function(e){return e.enabled})).includes(!1)),t}},{key:"recoverPlayingState",value:function(e){var t=e.isPlaying(),r=e.getDiv();if(t&&r){var i=r.parentNode;e.stop(),e.play(i,{objectFit:e.getObjectFit(),muted:e.getMuted()})}}},{key:"mergeStream",value:function(e,t){var r=t.getConnection(),i=t.getMediaStream();e.setConnection(r),r.setRemoteStream(i.id,e),e.setMediaStream(i),e.updateAudioPlayingState(t.hasAudio()),e.updateVideoPlayingState(t.hasVideo())}},{key:"addSubscriptionRecord",value:function(e,t,r){var i=t.getType();if(this.subscribedStreams_.has(e))this.subscribedStreams_.get(e).set(i,t);else{var n=new Map;n.set(t.getType(),t),this.subscribedStreams_.set(e,n)}if(this.subscriptedOptions_.has(e))this.subscriptedOptions_.get(e).set(i,r);else{var o=new Map;o.set(t.getType(),r),this.subscriptedOptions_.set(e,o)}this.deleteUnsubscriptionRecord(e,i)}},{key:"addUnsubscriptionRecord",value:function(e,t){if(this.unsubscribedStreams_.has(e))this.unsubscribedStreams_.get(e).set(t.getType(),t);else{var r=new Map;r.set(t.getType(),t),this.unsubscribedStreams_.set(e,r)}this.deleteSubscriptionRecord(e,t.getType())}},{key:"getSubscribedStream",value:function(e,t){return this.subscribedStreams_.has(e)&&this.subscribedStreams_.get(e).has(t)?this.subscribedStreams_.get(e).get(t):null}},{key:"getOptions",value:function(e,t){return this.subscriptedOptions_.has(e)&&this.subscriptedOptions_.get(e).has(t)?this.subscriptedOptions_.get(e).get(t):null}},{key:"getUnsubscribedStream",value:function(e,t){return this.unsubscribedStreams_.has(e)&&this.unsubscribedStreams_.get(e).has(t)?this.unsubscribedStreams_.get(e).get(t):null}},{key:"deleteSubscriptionRecord",value:function(e,t){this.subscribedStreams_.has(e)&&this.subscribedStreams_.get(e).delete(t),this.subscriptedOptions_.has(e)&&this.subscriptedOptions_.get(e).delete(t)}},{key:"deleteUnsubscriptionRecord",value:function(e,t){this.unsubscribedStreams_.has(e)&&this.unsubscribedStreams_.get(e).delete(t)}},{key:"markAllStream",value:function(){for(var e=0,t=A(this.subscribedStreams_.entries());e<t.length;e++)for(var r=E(t[e],2),i=r[0],n=0,o=A(r[1].entries());n<o.length;n++){var s=E(o[n],1)[0];this.setAutoRecoveryFlag(i,s)}for(var a=0,c=A(this.unsubscribedStreams_.entries());a<c.length;a++)for(var l=E(c[a],2),u=l[0],d=0,h=A(l[1].entries());d<h.length;d++){var p=E(h[d],1)[0];this.setAutoRecoveryFlag(u,p)}}},{key:"setAutoRecoveryFlag",value:function(e,t){if(Tf.info("setAutoRecoveryFlag() mark [".concat(e,"][").concat(t,"]")),this.autoRecoveryFlags_.has(e))this.autoRecoveryFlags_.get(e).set(t);else{var r=new Map;r.set(t),this.autoRecoveryFlags_.set(e,r)}}},{key:"hasAutoRecoveryFlag",value:function(e,t){return!!this.isEnabled&&this.autoRecoveryFlags_.has(e)&&this.autoRecoveryFlags_.get(e).has(t)}},{key:"deleteAutoRecoveryFlag",value:function(e,t){this.autoRecoveryFlags_.has(e)&&this.autoRecoveryFlags_.get(e).delete(t)}},{key:"delete",value:function(e){this.unsubscribedStreams_.delete(e),this.subscribedStreams_.delete(e),this.subscriptedOptions_.delete(e),this.autoRecoveryFlags_.delete(e)}}]),e}(),CA=zt("slice"),TA=_e("species"),bA=[].slice,IA=Math.max;It({target:"Array",proto:!0,forced:!CA},{slice:function(e,t){var r,i,n,o=G(this),s=at(o),a=nt(e,s),c=nt(void 0===t?s:t,s);if(wt(o)&&(r=o.constructor,(Vt(r)&&(r===Array||wt(r.prototype))||Q(r)&&null===(r=r[TA]))&&(r=void 0),r===Array||void 0===r))return bA.call(o,a,c);for(i=new(void 0===r?Array:r)(IA(c-a,0)),n=0;a<c;a++,n++)a in o&&zn(i,n,o[a]);return i.length=n,i}}),It({target:"String",proto:!0,forced:_m("small")},{small:function(){return mm(this,"small","","")}});var RA=function(){function e(t){s(this,e),this.player_=t,this.canvas_=document.createElement($l),this.canvasCtx_=this.canvas_.getContext("2d")}return c(e,[{key:"setCanvasRect",value:function(e,t){this.canvas_.width=e,this.canvas_.height=t}},{key:"drawVideoToCanvas",value:function(){var e=this.player_.getElement();this.canvasCtx_.drawImage(e,0,0,this.canvas_.width,this.canvas_.height)}},{key:"generateVideoTrackFromCanvasCapture",value:function(e){return this.canvas_.captureStream(e).getVideoTracks()[0]}},{key:"generateStreamFromTrack",value:function(e){var t=new MediaStream;return t.addTrack(e),t}},{key:"destroy",value:function(){this.player_.stop(),this.canvas_=null,this.canvasCtx_=null}},{key:"canvas",get:function(){return this.canvas_}},{key:"canvasCtx",get:function(){return this.canvasCtx_}},{key:"canDrawVideoToCanvas",get:function(){if(this.player_){var e=this.player_.getElement();if(e)return e.readyState===e.HAVE_ENOUGH_DATA}return!1}}]),e}(),wA=function(){function e(t){s(this,e),this.localStream_=t,this.player_=new lA({stream:t,track:t.getVideoTrack(),muted:!0,objectFit:"cover",mirror:!1}),this.player_.play().then((function(){Tf.info("VideoGenerator: play local video success")})).catch((function(){Tf.error("VideoGenerator: Failed to play local video")})),this.processor_=new RA(this.player_)}return c(e,[{key:"generateSmallVideoTrack",value:function(e){var t=this.getSmallVideoProfile(e);this.processor_.setCanvasRect(t.width,t.height),this.player_.setRect({width:t.width,height:t.height});var r=this.processor_.generateVideoTrackFromCanvasCapture(t.frameRate);return this.interval_=wv.setInterval(this.render.bind(this),Math.ceil(1e3/t.frameRate)),r}},{key:"render",value:function(){this.processor_.canDrawVideoToCanvas&&this.processor_.drawVideoToCanvas()}},{key:"destroy",value:function(){wv.clearInterval(this.interval_),this.processor_&&this.processor_.destroy()}},{key:"getSmallVideoProfile",value:function(e){var t,r=this.localStream_.getVideoTrack(),i=this.localStream_.getVideoProfile(),n=r.getSettings(),o=n&&n.width&&n.height?{width:n.width,height:n.height}:i,s=o.width*o.height,a=e.width*e.height;return Tf.log("big stream resolution: ".concat(o.height,"*").concat(o.width," small stream resolution: ").concat(e.height,"*").concat(e.width," ")),s>a?t=s/a:(Tf.warn("Small stream resolution is larger than big stream, which is invalid. big: ".concat(o.width," * ").concat(o.height," small: ").concat(e.width," * ").concat(e.height)),t=s/19200),{width:parseInt(o.width/Math.sqrt(t)),height:parseInt(o.height/Math.sqrt(t)),frameRate:e.frameRate}}}]),e}(),kA={voiceActivityDetection:!1},OA=function(e){u(S,e);var t,r,i,n,a,l,h,p,f,g,m,E,A,y=_(S);function S(e){var t;return s(this,S),(t=y.call(this,e)).localStream_=null,t.exchangeSDPTimeout_=-1,t.smallGenerator_=null,t.isSDPExchanging_=!1,t.ssrc_={audio:0,video:0,small:0},t.canvasTrack_=null,t}return c(S,[{key:"initialize",value:function(){v(d(S.prototype),"initialize",this).call(this),this.installEvents()}},{key:"reset",value:function(){v(d(S.prototype),"close",this).call(this),this.uninstallEvents(),this.clearExchangeSDPTimeout(),this.canvasTrack_=null,this.localStream_&&this.localStream_.clearCanvas()}},{key:"close",value:function(){this.reset(),this.emitConnectionStateChangedEvent(ol),this.smallGenerator_&&(this.smallGenerator_.destroy(),this.smallGenerator_=null)}},{key:"installEvents",value:function(){this.emitter_.on(oE,this.handleError,this),this.emitter_.on(sE,this.handleConnectionStateChange,this)}},{key:"uninstallEvents",value:function(){this.emitter_.off(oE,this.handleError,this),this.emitter_.off(sE,this.handleConnectionStateChange,this)}},{key:"publish",value:(A=o(regeneratorRuntime.mark((function e(t){var r,i,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.localStream_=t,r=t.getMediaStream(),this.log_.info("is publishing stream: ".concat(t.getId())),i=this.localStream_.getAudioTrack(),n=this.localStream_.getVideoTrack(),i&&this.peerConnection_.addTrack(i,r),n&&(Bc&&Xd(n)?(this.canvasTrack_=this.localStream_.genCanvasTrack(n),this.peerConnection_.addTrack(this.canvasTrack_,r)):this.peerConnection_.addTrack(n,r),this.client_.getIsEnableSmallStream()&&(this.smallGenerator_=new wA(this.localStream_),o=this.smallGenerator_.generateSmallVideoTrack(this.client_.smallStreamConfig_),this.peerConnection_.addTrack(o,r))),this.updateMediaSettings(r),e.next=10,this.connect();case 10:return e.abrupt("return",t);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"updateMediaSettings",value:function(e){var t=this,r=this.client_.getSystemResult().detail,i=r.isH264EncodeSupported,n=r.isVp8EncodeSupported,o="";i?o="H264":n&&(o="VP8");var s={EncVideoCodec:o,EncVideoWidth:0,EncVideoHeight:0,EncVideoBr:"0",EncVideoFps:0,EncAudioCodec:"opus",EncAudioFS:0,EncAudioCh:0,EncAudioBr:"0"};"getSettings"in MediaStreamTrack.prototype?e.getTracks().forEach((function(e){var r=e.getSettings();if(e.kind===Jl){var i=1;r.channelCount&&(i=r.channelCount),s.EncAudioCh=i,s.EncAudioBr="".concat(1e3*t.localStream_.getAudioBitrate()),s.EncAudioFS=r.sampleRate}else e.kind===Xl&&(t.client_.getIsEnableSmallStream()&&(s.EncSmallVideoWidth=t.client_.smallStreamConfig.width,s.EncSmallVideoHeight=t.client_.smallStreamConfig.height,s.EncSmallVideoFps=t.client_.smallStreamConfig.framerate,s.EncSmallVideoBr="".concat(1e3*t.client_.smallStreamConfig.bitrate)),s.EncVideoWidth=r.width,s.EncVideoHeight=r.height,s.EncVideoFps=r.frameRate,s.EncVideoBr="".concat(1e3*t.localStream_.getVideoBitrate()))})):s=this.getMediaSettingsFromProfile(s),this.log_.info("updateMediaSettings: "+JSON.stringify(s)),this.signalChannel_.send(gg,s)}},{key:"getMediaSettingsFromProfile",value:function(e){var t=this.localStream_;if(t){if(t.getAudioTrack()){var r=t.getAudioProfile();e.EncAudioCh=r.channelCount,e.EncAudioBr="".concat(1e3*r.bitrate),e.EncAudioFS=r.sampleRate}if(t.getVideoTrack()){var i=t.getVideoProfile();e.EncVideoWidth=i.width,e.EncVideoHeight=i.height,e.EncVideoFps=i.frameRate,e.EncVideoBr="".concat(1e3*i.bitrate)}}return e}},{key:"addTrack",value:(E=o(regeneratorRuntime.mark((function e(t){var r,i,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.peerConnection_){e.next=20;break}if(t.kind===Xl&&Bc&&Xd(t)&&(t=this.canvasTrack_=this.localStream_.genCanvasTrack(t)),this.log_.info("is adding ".concat(t.kind," track to current published local stream")),!(Hv()&&this.peerConnection_.getTransceivers().findIndex((function(e){return"stopped"===e.direction}))>=0)){e.next=7;break}return this.log_.warn("transceiver is stopping, negotiate sdp first"),e.next=7,this.updateOffer(gu,t);case 7:if(!(r=this.peerConnection_.getSenders().find((function(e){return e.track&&e.track.kind===t.kind})))){e.next=14;break}return this.log_.warn("sender already exists, remove sender first"),i=r.track,this.removeSender(r),e.next=14,this.updateOffer(gu,i);case 14:return n=this.localStream_.getMediaStream(),this.peerConnection_.addTrack(t,n),this.updateMediaSettings(n),e.next=19,this.updateOffer(fu,t);case 19:hm(this.userId_,{eventId:t.kind===Jl?Lg:Ng,eventDesc:"add ".concat(t.kind," track to current published stream"),timestamp:Es(),userId:this.userId_,tinyId:this.tinyId_});case 20:case"end":return e.stop()}}),e,this)}))),function(e){return E.apply(this,arguments)})},{key:"isNeedToResetOfferOrder",value:function(){if("plan-b"===this.sdpSemantics_||!this.peerConnection_||!this.peerConnection_.localDescription)return!1;for(var e=this.peerConnection_.localDescription.sdp,t=Sv(e),r=0;r<t.media.length;r++)if(0===t.media[r].mid&&t.media[r].type===Xl)return!0;return!1}},{key:"removeSender",value:function(e){var t=null;Hv()&&(t=this.peerConnection_.getTransceivers().find((function(t){return t.sender&&t.sender.track===e.track}))),this.peerConnection_.removeTrack(e),t&&Zd(t.stop)&&(this.log_.info("stop transceiver"),t.stop())}},{key:"removeTrack",value:(m=o(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.peerConnection_||!Gv()){e.next=14;break}if(t.kind===Xl&&Bc&&this.canvasTrack_&&(t=this.canvasTrack_,this.localStream_.clearCanvas()),this.log_.info("is removing ".concat(t.kind," track from current published local stream")),t.kind!==Xl||!this.isNeedToResetOfferOrder()){e.next=9;break}return this.reset(),this.initialize(),e.next=8,this.publish(this.localStream_);case 8:return e.abrupt("return");case 9:return(r=this.peerConnection_.getSenders().find((function(e){return e.track===t})))&&(this.removeSender(r),this.updateMediaSettings(this.localStream_.getMediaStream())),e.next=13,this.updateOffer(gu,t);case 13:hm(this.userId_,{eventId:t.kind===Jl?Dg:Pg,eventDesc:"remove ".concat(t.kind," track from current published stream"),timestamp:Es(),userId:this.userId_,tinyId:this.tinyId_});case 14:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"isReplaceTrackAvailable",value:function(){return"RTCRtpSender"in window&&"replaceTrack"in window.RTCRtpSender.prototype}},{key:"replaceTrack",value:(g=o(regeneratorRuntime.mark((function e(t){var r,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.kind!==Xl||!Bc||!this.canvasTrack_){e.next=2;break}return e.abrupt("return");case 2:if(this.isReplaceTrackAvailable()&&Gv()){e.next=4;break}throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:iv})});case 4:if(this.peerConnection_){e.next=6;break}throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:C_})});case 6:if(0!==(r=this.peerConnection_.getSenders()).length){e.next=9;break}throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:C_})});case 9:r.forEach((function(e){e.track&&e.track.kind===t.kind&&(i.log_.info("is replacing ".concat(t.kind," track to current published local stream")),e.replaceTrack(t))})),hm(this.userId_,{eventId:t.kind===Jl?Wg:Qg,eventDesc:"replace ".concat(t.kind," track from current published stream"),timestamp:Es(),userId:this.userId_,tinyId:this.tinyId_});case 11:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"setBandwidth",value:(f=o(regeneratorRuntime.mark((function e(t,r,i){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isUplink_){e.next=2;break}return e.abrupt("return",i);case 2:if(Wv()){e.next=4;break}return e.abrupt("return",r===Xl?this.updateVideoBandwidthRestriction(i,t):this.updateAudioBandwidthRestriction(i,t));case 4:if(!(n=this.peerConnection_.getSenders().find((function(e){return e.track&&e.track.kind===r})))){e.next=20;break}return(o=n.getParameters()).encodings&&0!==o.encodings.length||(o.encodings=[{}]),"unlimited"===t?delete o.encodings[0].maxBitrate:o.encodings[0].maxBitrate=1e3*t,e.prev=9,e.next=12,n.setParameters(o);case 12:return this.log_.info(r+" bandwidth was set to "+t+" kbps"),e.abrupt("return",i);case 16:return e.prev=16,e.t0=e.catch(9),this.log_.info("failed to set bandwidth by setting maxBitrate: "+e.t0),e.abrupt("return",r===Xl?this.updateVideoBandwidthRestriction(i,t):this.updateAudioBandwidthRestriction(i,t));case 20:return e.abrupt("return",i);case 21:case"end":return e.stop()}}),e,this,[[9,16]])}))),function(e,t,r){return f.apply(this,arguments)})},{key:"setSmallStreamBandwidth",value:(p=o(regeneratorRuntime.mark((function e(t,r){var i,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isUplink_){e.next=2;break}return e.abrupt("return",r);case 2:if(Wv()){e.next=4;break}return e.abrupt("return",this.updateSmallVideoBandwidthRestriction(r,t));case 4:if(!(i=this.peerConnection_.getSenders().filter((function(e){return e.track&&e.track.kind===Xl}))[1])){e.next=20;break}return(n=i.getParameters()).encodings&&0!==n.encodings.length||(n.encodings=[{}]),"unlimited"===t?delete n.encodings[0].maxBitrate:n.encodings[0].maxBitrate=1e3*t,e.prev=9,e.next=12,i.setParameters(n);case 12:return this.log_.info("small stream bandwidth was set to "+t+" kbps"),e.abrupt("return",r);case 16:return e.prev=16,e.t0=e.catch(9),this.log_.info("failed to set small stream bandwidth by setting maxBitrate: "+e.t0),e.abrupt("return",this.updateSmallVideoBandwidthRestriction(r,t));case 20:return e.abrupt("return",r);case 21:case"end":return e.stop()}}),e,this,[[9,16]])}))),function(e,t){return p.apply(this,arguments)})},{key:"updateVideoBandwidthRestriction",value:function(e,t){var r="AS";return Ga&&(r="TIAS",t*=1e3),-1===e.indexOf("b="+r+":")?e.replace(/m=video (.*)\r\nc=IN (.*)\r\n/,"m=video $1\r\nc=IN $2\r\nb="+r+":"+t+"\r\n"):e.replace(new RegExp("b="+r+":.*\r\n"),"b="+r+":"+t+"\r\n")}},{key:"updateAudioBandwidthRestriction",value:function(e,t){var r="AS";return Ga&&(r="TIAS",t*=1e3),e.replace(/m=audio (.*)\r\nc=IN (.*)\r\n/,"m=audio $1\r\nc=IN $2\r\nb="+r+":"+t+"\r\n")}},{key:"updateSmallVideoBandwidthRestriction",value:function(e,t){var r="AS";Ga&&(r="TIAS",t*=1e3);var i=/m=video (.*)\r\nc=IN (.*)\r\n/g,n=[],o=i.exec(e);for(n.push(o);null!==o;)o=i.exec(e),n.push(o);var s=n[n.length-2],a=e.slice(0,s.index),c=e.slice(s.index);return-1===e.indexOf("b="+r+":")?a+(c=c.replace(/m=video (.*)\r\nc=IN (.*)\r\n/,"m=video $1\r\nc=IN $2\r\nb="+r+":"+t+"\r\n")):a+(c=c.replace(new RegExp("b="+r+":.*\r\n"),"b="+r+":"+t+"\r\n"))}},{key:"removeBandwidthRestriction",value:function(e){return e.replace(/b=AS:.*\r\n/,"").replace(/b=TIAS:.*\r\n/,"")}},{key:"removeVideoOrientation",value:function(e){return e.replace(/urn:3gpp:video-orientation/,"")}},{key:"connect",value:(h=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.exchangeSDP();case 3:return e.next=5,this.waitForPeerConnectionConnected();case 5:e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(0),this.closePeerConnection(!0),e.t0;case 11:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return h.apply(this,arguments)})},{key:"exchangeSDP",value:(l=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.isSDPExchanging_=!0,e.next=4,this.createOffer();case 4:return this.log_.info("createOffer success, sending offer to remote server"),e.next=7,this.doExchangeSDP();case 7:this.isSDPExchanging_=!1,e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(0),this.isSDPExchanging_=!1,e.t0;case 14:case"end":return e.stop()}}),e,this,[[0,10]])}))),function(){return l.apply(this,arguments)})},{key:"createOffer",value:(a=o(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.peerConnection_.createOffer(kA);case 3:return t=e.sent,e.next=6,this.peerConnection_.setLocalDescription(t);case 6:this.updateSSRC(t.sdp),jd.logSuccessEvent({userId:this.client_.getUserId(),eventType:Ol,kind:"offer"}),e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(0),jd.logFailedEvent({userId:this.client_.getUserId(),eventType:Ol,kind:"offer",error:e.t0}),e.t0;case 14:case"end":return e.stop()}}),e,this,[[0,10]])}))),function(){return a.apply(this,arguments)})},{key:"doExchangeSDP",value:function(){var e=this;return new Promise((function(t,r){e.exchangeSDPTimeout_=setTimeout((function(){e.signalChannel_.off(cg.PUBLISH_RESULT,i),e.signalChannel_.off(cg.ON_PUBLISH_RESPONSE,i),e.clearExchangeSDPTimeout();var t=new Vd({code:Fd.API_CALL_TIMEOUT,message:uv({key:km})});r(t)}),5e3);var i=function(){var i=o(regeneratorRuntime.mark((function i(n){return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,e.clearExchangeSDPTimeout(),i.next=4,e.acceptAnswer(n.data.content);case 4:t(),i.next=10;break;case 7:i.prev=7,i.t0=i.catch(0),r(i.t0);case 10:case"end":return i.stop()}}),i,null,[[0,7]])})));return function(e){return i.apply(this,arguments)}}(),n={type:e.peerConnection_.localDescription.type,sdp:e.removeVideoOrientation(e.peerConnection_.localDescription.sdp),screen:e.localStream_.hasScreenTrack()};e.signalChannel_.once(cg.PUBLISH_RESULT,i),e.signalChannel_.once(cg.ON_PUBLISH_RESPONSE,i),e.log_.debug("sending sdp offer: "+n.sdp),e.signalChannel_.send(_g,n,0)}))}},{key:"setSDPDirection",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",i=Sv(e);return i.media.forEach((function(e){"all"!==r&&e.type!==r||(e.direction=t)})),Cv(i)}},{key:"updateOffer",value:(n=o(regeneratorRuntime.mark((function e(t,r){var i,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.peerConnection_.createOffer(kA);case 3:return i=e.sent,Ga&&(i.sdp=this.setSDPDirection(i.sdp,"sendrecv")),e.next=7,this.peerConnection_.setLocalDescription(i);case 7:return n={action:t,trackId:r.id,kind:r.kind,type:"offer",sdp:this.peerConnection_.localDescription.sdp},this.log_.info("createOffer success, sending updated offer to remote server"),this.log_.debug("updatedOffer: "+n.sdp),e.next=12,this.signalChannel_.sendWaitForResponse({command:lg,data:n,responseCommand:cg.UPDATE_OFFER_RESULT,timeout:1e4,commandDesc:"update offer"});case 12:return o=e.sent,e.next=15,this.acceptAnswer(o.data.content);case 15:this.updateSSRC(i.sdp),jd.logSuccessEvent({userId:this.client_.getUserId(),eventType:Ol,kind:"offer"}),e.next=24;break;case 19:throw e.prev=19,e.t0=e.catch(0),this.log_.error(e.t0),jd.logFailedEvent({userId:this.client_.getUserId(),eventType:Ol,kind:"offer",error:e.t0}),e.t0;case 24:case"end":return e.stop()}}),e,this,[[0,19]])}))),function(e,t){return n.apply(this,arguments)})},{key:"acceptAnswer",value:(i=o(regeneratorRuntime.mark((function e(t){var r,i,n,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(77392!==t.result){e.next=3;break}throw this.log_.error(av.NOT_SUPPORTED_H264ENCODE),new Vd({code:Fd.NOT_SUPPORTED_H264,message:uv({key:tv})});case 3:return r=this.localStream_.getVideoBitrate(),i=this.localStream_.getAudioBitrate(),n=this.removeVideoOrientation(t.sdp),e.prev=6,e.next=9,this.setBandwidth(r,Xl,n);case 9:return n=e.sent,e.next=12,this.setBandwidth(i,Jl,n);case 12:if(n=e.sent,!this.client_.getIsEnableSmallStream()){e.next=18;break}return o=this.client_.smallStreamConfig,e.next=17,this.setSmallStreamBandwidth(o.bitrate,n);case 17:n=e.sent;case 18:return s={type:t.type,sdp:n},e.next=21,this.peerConnection_.setRemoteDescription(s);case 21:this.log_.debug("accepted answer: "+n),jd.logSuccessEvent({userId:this.client_.getUserId(),eventType:Nl,kind:"answer"}),e.next=30;break;case 25:throw e.prev=25,e.t0=e.catch(6),jd.logFailedEvent({userId:this.client_.getUserId(),eventType:Nl,kind:"answer",error:e.t0}),this.log_.error("failed to accept remote answer "+e.t0),e.t0;case 30:case"end":return e.stop()}}),e,this,[[6,25]])}))),function(e){return i.apply(this,arguments)})},{key:"sendMutedFlag",value:function(e){var t={srctinyid:0,userid:this.userId_,flag:e};this.log_.info("send muted flag: ".concat(e)),this.signalChannel_.send(fg,t)}},{key:"getIsReconnecting",value:function(){return this.isReconnecting_}},{key:"reconnect",value:(r=o(regeneratorRuntime.mark((function e(){var t,r,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1===this.reconnectionTimer_){e.next=3;break}return this.log_.warn("reconnect() uplink is reconnecting, ignore current reconnection"),e.abrupt("return");case 3:if(!(this.reconnectionCount_>=30)){e.next=12;break}return this.log_.warn("SDK has tried reconnect uplink for ".concat(30," times, but all failed, please check your network")),this.stopReconnection(),t=new Vd({code:Fd.UPLINK_RECONNECTION_FAILED,message:uv({key:Lm})}),jd.logFailedEvent({userId:this.client_.getUserId(),eventType:Rl,error:t}),this.addEventInternal(am,"uplink-connection reconnect fail"),this.emitConnectionStateChangedEvent(ol),this.emitter_.emit(oE,t),e.abrupt("return");case 12:if(this.signalChannel_.getCurrentState()===og){e.next=16;break}return this.log_.warn("reconnect() signal channel is not connected, suspend reconnection until signal is connected"),this.signalChannel_.once(eg,this.reconnect,this),e.abrupt("return");case 16:if(this.reconnectionCount_++,e.prev=17,this.log_.warn("reconnect() try to reconnect uplink [".concat(this.reconnectionCount_,"/").concat(30,"]")),r=zd(this.reconnectionCount_),this.reconnectionTimer_=setTimeout((function(){i.log_.warn("reconnect() uplink reconnect timeout(".concat(r/1e3,"s), try again")),i.signalChannel_.off(cg.UNPUBLISH_RESULT,i.onUnpublishResult,i),i.clearReconnectionTimer(),i.reconnect()}),r),!(this.isSDPExchanging_||this.peerConnection_&&this.peerConnection_.connectionState===ul)){e.next=23;break}return e.abrupt("return");case 23:this.signalChannel_.send(vg),this.signalChannel_.once(cg.UNPUBLISH_RESULT,this.onUnpublishResult,this),e.next=29;break;case 27:e.prev=27,e.t0=e.catch(17);case 29:case"end":return e.stop()}}),e,this,[[17,27]])}))),function(){return r.apply(this,arguments)})},{key:"onUnpublishResult",value:(t=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.reset(),this.initialize(),e.next=5,this.publish(this.localStream_);case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return t.apply(this,arguments)})},{key:"clearExchangeSDPTimeout",value:function(){-1!==this.exchangeSDPTimeout_&&(clearTimeout(this.exchangeSDPTimeout_),this.exchangeSDPTimeout_=-1)}},{key:"clearReconnectionTimer",value:function(){-1!==this.reconnectionTimer_&&(clearTimeout(this.reconnectionTimer_),this.reconnectionTimer_=-1)}},{key:"handleError",value:function(e){e.getCode()===Fd.ICE_TRANSPORT_ERROR&&(this.isFirstConnection_&&(this.isFirstConnection_=!1,jd.logFailedEvent({userId:this.client_.getUserId(),eventType:Il,error:e})),this.isReconnecting_||this.startReconnection())}},{key:"handleConnectionStateChange",value:function(e){e.state===cl&&(this.isFirstConnection_&&(this.isFirstConnection_=!1,jd.logSuccessEvent({userId:this.client_.getUserId(),eventType:Il}),this.addEventInternal(em,"uplink-connection is connected")),this.isReconnecting_&&(jd.logSuccessEvent({userId:this.client_.getUserId(),eventType:Rl}),this.log_.warn("reconnect() uplink reconnect successfully"),this.addEventInternal(sm,"uplink-connection reconnect success"),this.stopReconnection()))}},{key:"updateSSRC",value:function(e){var t=this;try{var r=0;Sv(e).media.forEach((function(e){if(e.type===Jl){var i=e.ssrcs[0];i&&(t.ssrc_.audio=i.id)}else{var n=e.ssrcs[0];switch(r+=1){case 1:n&&(t.ssrc_.video=n.id);break;case 2:n&&(t.ssrc_.small=n.id)}}}))}catch(ky){}}},{key:"getLocalStreamVideoTrackId",value:function(){if(this.peerConnection_){var e=this.peerConnection_.getSenders().filter((function(e){return e.track&&e.track.kind===Xl}));if(e[0])return e[0].track.id}if(this.localStream_){var t=this.localStream_.getVideoTrack();if(t)return t.id}return""}},{key:"getSSRC",value:function(){return this.ssrc_}}]),S}(uA),NA=function(e){u(f,e);var t,r,i,n,a,l,h,p=_(f);function f(e){var t;return s(this,f),(t=p.call(this,e)).remoteStreams_=new Map,t.autoSubscribe=e.autoSubscribe,t.trackState_={audio:e.trackState.audio,video:e.trackState.video,auxiliary:e.trackState.auxiliary},t.ssrc_={audio:0,video:0,auxiliary:0},t.subscribeState_={audio:e.autoSubscribe,video:e.autoSubscribe,auxiliary:e.autoSubscribe},t.pendingSubscription_=[],t.pendingStreams_=[],t.subscriptionTimeout_=-1,t.subscriptionRetryCount_=0,t.isSubscriptionPending_=!1,t.sentSubscriptionAfterConnected_=!1,t.isSDPExchanging_=!1,t.installEvents(),t}return c(f,[{key:"isMainStreamSubscribed",get:function(){return(this.subscribeState_.audio||this.subscribeState_.video)&&(this.trackState_.audio||this.trackState_.video)}},{key:"isAuxStreamSubscribed",get:function(){return this.subscribeState_.auxiliary&&this.trackState_.auxiliary}},{key:"initialize",value:function(){v(d(f.prototype),"initialize",this).call(this),this.peerConnection_.ontrack=this.onTrack.bind(this)}},{key:"close",value:function(){var e=this;v(d(f.prototype),"close",this).call(this),this.trackState_.audio=!1,this.trackState_.video=!1,this.trackState_.auxiliary=!1,this.emitConnectionStateChangedEvent(ol),-1!==this.subscriptionTimeout_&&(clearTimeout(this.subscriptionTimeout_),this.subscriptionTimeout_=-1),this.remoteStreams_.forEach((function(t){var r=t;r.setConnection(null),r.getIsStreamAddedEventEmitted()&&e.emitter_.emit(rE,{stream:r})})),this.remoteStreams_.clear(),this.uninstallEvents()}},{key:"installEvents",value:function(){var e=this;gh.on(Mh,this.onRemoteStreamUpdate,this),this.signalChannel_.on(cg.SUBSCRIBE_CHANGE_RESULT,this.onSubscribeChangeResult,this),this.signalChannel_.on(cg.UNSUBSCRIBE_RESULT,this.onUnsubscribeResult,this),this.emitter_.on(oE,(function(t){t.getCode()===Fd.ICE_TRANSPORT_ERROR&&(e.isFirstConnection_&&(e.isFirstConnection_=!1,jd.logFailedEvent({userId:e.client_.getUserId(),eventType:wl,error:t})),e.isReconnecting_||e.startReconnection())})),this.emitter_.on(sE,(function(t){t.state===cl&&e.isFirstConnection_&&(e.isFirstConnection_=!1,jd.logSuccessEvent({userId:e.client_.getUserId(),eventType:wl}),e.addEventInternal(tm,"downlink-connection is connected"))}))}},{key:"uninstallEvents",value:function(){gh.removeListener(Mh,this.onRemoteStreamUpdate,this),this.signalChannel_.removeListener(cg.SUBSCRIBE_CHANGE_RESULT,this.onSubscribeChangeResult,this),this.signalChannel_.removeListener(cg.UNSUBSCRIBE_RESULT,this.onUnsubscribeResult,this)}},{key:"onRemoteStreamUpdate",value:function(e){if(this.hitTest(e.tinyId)&&e.client===this.client_){this.updateTrackState(e.action,e.kind);var t=e.kind===eu?il:rl,r=this.remoteStreams_.get(t);if(!r)return;e.action===fu?this.handleRemoteAddTrack(e.kind,r):this.handleRemoteRemoveTrack(e.kind,r)}}},{key:"handleRemoteAddTrack",value:function(e,t){this.log_.info("remote add ".concat(e," track")),e===Jl?t.updateAudioPlayingState(this.subscribeState_.audio):t.updateVideoPlayingState(e===eu?this.subscribeState_.auxiliary:this.subscribeState_.video),t.getIsStreamAddedEventEmitted()?this.emitter_.emit(iE,{stream:t}):(this.emitter_.emit(tE,{stream:t}),this.currentState_===cl&&t.emitConnectionStateChanged({prevState:ol,state:cl}))}},{key:"handleRemoteRemoveTrack",value:function(e,t){t.getIsStreamAddedEventEmitted()&&(this.log_.info("remote remove ".concat(e," track")),e!==eu&&(this.trackState_.audio||this.trackState_.video)||t.isInSubscriptionCycle()?(e===Jl?t.updateAudioPlayingState(!1):t.updateVideoPlayingState(!1),this.emitter_.emit(iE,{stream:t})):(this.log_.info("remote stream ".concat(t.getType()," removed")),this.currentState_===cl&&t.emitConnectionStateChanged({prevState:cl,state:ol}),this.emitter_.emit(rE,{stream:t})))}},{key:"updateTrackState",value:function(e,t){var r=e===fu;switch(t){case Jl:this.trackState_.audio=r;break;case Xl:this.trackState_.video=r;break;case eu:this.trackState_.auxiliary=r}this.log_.info("trackState updated: ".concat(JSON.stringify(this.trackState_)))}},{key:"onTrack",value:function(e){var t=e.streams[0],r=e.track;if(this.log_.info("ontrack() kind: ".concat(r.kind," id: ").concat(r.id," streamId: ").concat(t.id)),"unified-plan"===this.sdpSemantics_){var i=function(e){var t=yv.parse(e),r={audio:[],video:[]};return t.media.forEach((function(e){if(e.ssrcs){var t=e.ssrcs[0].id>>16&255;if(e.type===Jl)r.audio.push(rl);else if(e.type==Xl){var i=t===nl?rl:il;r.video.push(i)}}})),r}(this.peerConnection_.remoteDescription.sdp);if(r.kind===Jl){if(0===i.audio.length||t.id!==rl)return void this.log_.debug("skip this invalid audio track")}else if(-1===i.video.indexOf(t.id))return void this.log_.debug("skip this invalid video track: ".concat(r.id,"  msid: ").concat(t.id))}jd.logEvent({eventType:"ontrack",kind:r.kind});var n=!1,o=this.remoteStreams_.get(t.id),s=t.id===rl?"main":"auxiliary";if(Yd(o)&&((o=new yA({type:s,userId:this.userId_,client:this.client_})).setConnection(this),this.remoteStreams_.set(t.id,o),n=!0),o.setMediaStream(t),r.kind===Jl?o.updateAudioPlayingState(this.subscribeState_.audio):"main"===s?o.updateVideoPlayingState(this.subscribeState_.video):o.updateVideoPlayingState(this.subscribeState_.auxiliary),("auxiliary"!==s||this.trackState_.auxiliary)&&("main"!==s||this.trackState_.audio||this.trackState_.video)){var a=this.client_.getSubscriptionManager();a&&a.hasAutoRecoveryFlag(this.userId_,s)||(n?this.emitter_.emit(tE,{stream:o}):this.emitter_.emit(iE,{stream:o}))}}},{key:"addRRTRLine",value:function(e){var t=e.split("\r\n"),r=new Map;t.forEach((function(e,i){/^a=rtcp-fb:/.test(e)&&t[i+1]&&!/^a=rtcp-fb:/.test(t[i+1])&&r.set(i+1,e.match(/^a=rtcp-fb:\d+/)[0]+" rrtr")}));for(var i=A(r),n=0;n<i.length;n++){var o=E(i[n],2),s=o[0],a=o[1];t.splice(s+n,0,a)}return t.join("\r\n")}},{key:"addSPSDescription",value:function(e){var t=Sv(e);return t.media.forEach((function(e){e.type===Xl&&e.fmtp.forEach((function(e){e.config+=";sps-pps-idr-in-keyframe=1"}))})),Cv(t)}},{key:"removeSDESDescription",value:function(e){var t=["urn:ietf:params:rtp-hdrext:sdes:mid","urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id","urn:ietf:params:rtp-hdrext:sdes:repaired-rtp-stream-id"],r=Sv(e);return r.media.forEach((function(e){e.ext=e.ext.filter((function(e){return!t.includes(e.uri)}))})),Cv(r)}},{key:"isSubscriptionStateNotChanged",value:function(e,t){return"main"===e.getType()?!Yd(t.audio)&&!Yd(t.video)&&t.audio===this.subscribeState_.audio&&t.video===this.subscribeState_.video:"auxiliary"===e.getType()?!Yd(t.video)&&this.subscribeState_.auxiliary===t.video:void 0}},{key:"subscribe",value:(h=o(regeneratorRuntime.mark((function e(t,r){var i,n,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.emitEvent,n=void 0===i||i,o=t.getType(),!this.peerConnection_||this.peerConnection_.connectionState!==ll&&this.peerConnection_.connectionState!==ul){e.next=5;break}return e.next=5,this.waitForPeerConnectionConnected();case 5:if(!this.isSubscriptionStateNotChanged(t,r)){e.next=12;break}if(this.peerConnection_){e.next=10;break}return this.initialize(),e.next=10,this.connect();case 10:return n&&this.emitter_.emit(nE,{stream:t,result:!0}),e.abrupt("return",t);case 12:if("main"===o?(Yd(r.audio)||(this.subscribeState_.audio=r.audio),Yd(r.video)||(this.subscribeState_.video=r.video),this.addEventInternal(this.subscribeState_.audio?Fg:jg,this.subscribeState_.audio?"subscribe audio":"unsubscribe audio"),this.addEventInternal(this.subscribeState_.video?Fg:jg,this.subscribeState_.video?"subscribe video":"unsubscribe video")):Yd(r.video)||(this.subscribeState_.auxiliary=r.video),this.log_.info("subscribe ".concat(o," stream with options ").concat(JSON.stringify(r)," current state: ").concat(JSON.stringify(this.subscribeState_))),!this.peerConnection_&&!this.isSDPExchanging_){e.next=22;break}return s=Gl,this.isMainStreamSubscribed||this.isAuxStreamSubscribed||(s=jl),e.next=19,this.sendSubscription(t,s);case 19:"main"===o?(t.updateAudioPlayingState(this.subscribeState_.audio),t.updateVideoPlayingState(this.subscribeState_.video)):t.updateVideoPlayingState(this.subscribeState_.auxiliary),e.next=25;break;case 22:return this.initialize(),e.next=25,this.connect();case 25:return n&&this.emitter_.emit(nE,{stream:t,result:!0}),e.abrupt("return",t);case 27:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"unsubscribe",value:(l=o(regeneratorRuntime.mark((function e(t){var r,i,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("main"!==(r=t.getType())){e.next=9;break}if(this.isMainStreamSubscribed){e.next=5;break}return this.log_.info("main stream already unsubscribed"),e.abrupt("return",t);case 5:this.subscribeState_.audio=!1,this.subscribeState_.video=!1,e.next=13;break;case 9:if(this.isAuxStreamSubscribed){e.next=12;break}return this.log_.info("auxiliary stream already unsubscribed"),e.abrupt("return",t);case 12:this.subscribeState_.auxiliary=!1;case 13:return i=jl,("main"===r&&this.isAuxStreamSubscribed||"auxiliary"===r&&this.isMainStreamSubscribed)&&(i=Gl),this.log_.info("unsubscribe ".concat(r," stream with ").concat(JSON.stringify(this.subscribeState_))),e.next=18,this.sendSubscription(t,i);case 18:return t.updateVideoPlayingState(!1),t.updateAudioPlayingState(!1),i===jl&&((n=t.getMediaStream())&&n.getTracks().forEach((function(e){return n.removeTrack(e)})),this.closePeerConnection(),this.emitConnectionStateChangedEvent(ol)),this.addEventInternal(jg,"unsubscribe audio"),this.addEventInternal(Vg,"unsubscribe video"),e.abrupt("return",t);case 24:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"sendSubscription",value:function(e,t){var r=this;return new Promise((function(i,n){var o={srctinyid:r.tinyId_,userid:r.userId_,audio:r.subscribeState_.audio,bigVideo:r.subscribeState_.video,auxVideo:r.subscribeState_.auxiliary};r.pendingSubscription_.length>0?r.log_.debug("queue the subscription for later handling"):r.doSendSubscription(o,e,t),r.pendingSubscription_.push({stream:e,type:t,data:o,callback:function(e){var o=e.code,s=e.message;if(0===o)i();else{var a=new Vd({code:o,message:uv({key:Rm,data:{type:t,message:s}})});r.log_.error(a),n(a)}}}),e.setInSubscriptionCycle(!0)}))}},{key:"doSendSubscription",value:function(e,t,r){var i=this;if(!this.peerConnection_||this.peerConnection_.connectionState!==fl&&this.peerConnection_.connectionState!==gl)return this.log_.debug("try to send subscription [".concat(r,"] when peeConnection connected")),void(this.sentSubscriptionAfterConnected_=!1);t&&this.pendingStreams_.push(t),this.log_.debug("doSendSubscription() send SUBSCRIBE command with data: ".concat(JSON.stringify(e))),r===Gl?this.signalChannel_.send(yg,e):r===jl&&this.signalChannel_.send(Ag,e),this.isSubscriptionPending_=!0,this.subscriptionTimeout_=setTimeout((function(){if(i.isSubscriptionPending_)if(i.log_.debug("subscription timeout"),i.subscriptionRetryCount_+=1,i.subscriptionRetryCount_<=3){i.log_.debug("resend subscription");var e=i.pendingSubscription_[0].data;i.doSendSubscription(e,t,r)}else i.log_.error(av.SUBSCRIPTION_TIMEOUT),i.pendingSubscription_.shift(),i.pendingStreams_.shift(),i.isSubscriptionPending_=!1,i.subscriptionRetryCount_=0,i.emitter_.emit(oE,new Vd({code:Fd.SUBSCRIPTION_TIMEOUT,message:uv({key:wm})}))}),5e3)}},{key:"onSubscribeChangeResult",value:function(e){var t=e.data.content,r=t.srctinyid;if(this.hitTest(r)){var i=this.pendingSubscription_[0];i&&i.type===Gl&&i.callback({code:t.errCode,message:t.errMsg}),this.sendNextSubscription()}}},{key:"onUnsubscribeResult",value:function(e){var t=e.data.content,r=t.srctinyid;if(this.hitTest(r)){var i=this.pendingSubscription_[0];i&&i.type===jl&&i.callback({code:t.errCode,message:t.errMsg}),this.sendNextSubscription()}}},{key:"connect",value:(a=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.exchangeSDP();case 3:return e.next=5,this.waitForPeerConnectionConnected();case 5:e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(0),this.closePeerConnection(!0),e.t0;case 11:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return a.apply(this,arguments)})},{key:"exchangeSDP",value:(n=o(regeneratorRuntime.mark((function e(){var t,r,i,n,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.isSDPExchanging_=!0,e.next=4,this.createOffer();case 4:return this.log_.info("createOffer success, sending offer to remote server"),t=this.peerConnection_.localDescription,r=t.type,i=t.sdp,n={type:r,sdp:i,userid:this.userId_,srctinyid:this.tinyId_,audio:this.subscribeState_.audio,bigVideo:this.subscribeState_.video,auxVideo:this.subscribeState_.auxiliary},gh.emit(tp,{client:this.client_,connection:this,userId:this.userId_,tinyId:this.tinyId_,role:el,subscribeState:this.subscribeState_,trackState:this.trackState_}),e.next=10,this.signalChannel_.sendWaitForResponse({command:Eg,commandDesc:"exchange sdp",data:n,responseCommand:cg.SUBSCRIBE_RESULT});case 10:if(o=e.sent,this.peerConnection_){e.next=15;break}throw s=this.genRemoteStreamNotExistError(),this.log_.warn(s),s;case 15:return e.next=17,this.onSubscribeResult(o);case 17:this.isSDPExchanging_=!1,e.next=24;break;case 20:throw e.prev=20,e.t0=e.catch(0),this.isSDPExchanging_=!1,e.t0;case 24:case"end":return e.stop()}}),e,this,[[0,20]])}))),function(){return n.apply(this,arguments)})},{key:"createOffer",value:(i=o(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={voiceActivityDetection:!1},"RTCPeerConnection"in window&&"addTransceiver"in window.RTCPeerConnection.prototype&&"unified-plan"===this.sdpSemantics_?(this.peerConnection_.addTransceiver(Jl,{direction:"recvonly"}),this.peerConnection_.addTransceiver(Xl,{direction:"recvonly"}),this.peerConnection_.addTransceiver(Xl,{direction:"recvonly"})):(t.offerToReceiveAudio=!0,t.offerToReceiveVideo=!0),e.next=4,this.peerConnection_.createOffer(t);case 4:return r=e.sent,e.next=7,Bv();case 7:return e.sent.isH264DecodeSupported||(this.log_.warn("remove h264 desc from sdp"),r.sdp=bv(r.sdp)),r.sdp=this.addRRTRLine(r.sdp),r.sdp=this.addSPSDescription(r.sdp),r.sdp=Tv(r.sdp),"unified-plan"===this.sdpSemantics_&&(r.sdp=this.removeSDESDescription(r.sdp)),e.next=16,this.peerConnection_.setLocalDescription(r);case 16:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"onSubscribeResult",value:(r=o(regeneratorRuntime.mark((function e(t){var r,i,n,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.data.content||77393!==t.data.content.errCode){e.next=3;break}throw this.log_.error(av.NOT_SUPPORTED_H264DECODE),new Vd({code:Fd.NOT_SUPPORTED_H264,message:uv({key:rv})});case 3:if(r=t.data.content,i=r.type,n=r.sdp,o=r.errCode,s=r.errMsg,e.prev=4,0===o){e.next=7;break}throw new Vd({code:o,message:uv({key:Nm,data:{errMsg:s}})});case 7:return this.log_.debug("accept remote answer: "+n),e.next=10,this.peerConnection_.setRemoteDescription({type:i,sdp:n});case 10:this.updateSSRC(n),e.next=17;break;case 13:throw e.prev=13,e.t0=e.catch(4),this.log_.error(e.t0),e.t0;case 17:case"end":return e.stop()}}),e,this,[[4,13]])}))),function(e){return r.apply(this,arguments)})},{key:"updateSSRC",value:function(e){var t=this;try{Sv(e).media.forEach((function(e){if(e.type===Jl){var r=e.ssrcs.find((function(e){return e.value.includes(rl)}));r&&(t.ssrc_.audio=r.id)}else{var i=e.ssrcs.find((function(e){return e.value.includes(rl)})),n=e.ssrcs.find((function(e){return e.value.includes(il)}));i&&(t.ssrc_.video=i.id),n&&(t.ssrc_.auxiliary=n.id)}}))}catch(ky){}}},{key:"sendNextSubscription",value:function(){void 0!==this.pendingSubscription_.shift()&&(this.subscriptionRetryCount_=0,this.isSubscriptionPending_=!1,-1!==this.subscriptionTimeout_&&(clearTimeout(this.subscriptionTimeout_),this.subscriptionTimeout_=-1));var e=this.pendingStreams_.shift();if(e&&(this.log_.debug("mark ".concat(e.getType()," stream exit subscription cycle")),e.setInSubscriptionCycle(!1)),this.pendingSubscription_.length>0){var t=this.pendingSubscription_[0];this.log_.info("schedule a pending subscription"),this.doSendSubscription(t.data,t.stream,t.type)}}},{key:"setRemoteStream",value:function(e,t){this.remoteStreams_.set(e,t)}},{key:"getSubscribeState",value:function(){return this.subscribeState_}},{key:"getTrackState",value:function(){return this.trackState_}},{key:"getSSRC",value:function(){return this.ssrc_}},{key:"getMainStream",value:function(){return this.remoteStreams_.get(rl)}},{key:"getAuxStream",value:function(){return this.remoteStreams_.get(il)}},{key:"getMainStreamVideoTrackId",value:function(){var e=this.getMainStream();if(e){var t=e.getVideoTrack();if(t)return t.id}return""}},{key:"getAuxStreamVideoTrackId",value:function(){var e=this.getAuxStream();if(e){var t=e.getVideoTrack();if(t)return t.id}return""}},{key:"reconnect",value:(t=o(regeneratorRuntime.mark((function e(){var t,r,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1===this.reconnectionTimer_){e.next=3;break}return this.log_.warn("reconnect() downlink is reconnecting, ignore current reconnection"),e.abrupt("return");case 3:if(!(this.reconnectionCount_>=30)){e.next=12;break}return this.log_.warn("SDK has tried reconnect downlink [".concat(this.userId_,"] for ").concat(30," times, but all failed, please check your network")),this.stopReconnection(),t=new Vd({code:Fd.DOWNLINK_RECONNECTION_FAILED,message:uv({key:Om})}),jd.logFailedEvent({userId:this.client_.getUserId(),eventType:kl,error:t}),this.addEventInternal(um,"downlink-connection reconnect fail"),this.emitConnectionStateChangedEvent(ol),this.emitter_.emit(oE,t),e.abrupt("return");case 12:if(this.signalChannel_.getCurrentState()===og){e.next=16;break}return this.log_.warn("reconnect() signal channel is not connected, suspend reconnection until signal is connected"),this.signalChannel_.once(eg,this.reconnect,this),e.abrupt("return");case 16:if(this.reconnectionCount_++,this.log_.warn("reconnect() try to reconnect downlink [".concat(this.reconnectionCount_,"/").concat(30,"]")),r=zd(this.reconnectionCount_),this.reconnectionTimer_=setTimeout((function(){i.log_.warn("reconnect() downlink [".concat(i.userId_,"] reconnect timeout(").concat(r/1e3,"s), try again")),i.clearReconnectionTimer(),i.reconnect()}),r),!(this.isSDPExchanging_||this.peerConnection_&&this.peerConnection_.connectionState===ul)){e.next=22;break}return e.abrupt("return");case 22:return e.prev=22,this.closePeerConnection(),this.sentSubscriptionAfterConnected_=!1,this.initialize(),e.next=28,this.connect();case 28:this.stopReconnection(),this.log_.warn("reconnect() downlink reconnect successfully"),jd.logSuccessEvent({userId:this.client_.getUserId(),eventType:kl}),this.addEventInternal(lm,"downlink-connection reconnect success"),this.recoverSubscription(),e.next=37;break;case 35:e.prev=35,e.t0=e.catch(22);case 37:case"end":return e.stop()}}),e,this,[[22,35]])}))),function(){return t.apply(this,arguments)})},{key:"recoverSubscription",value:function(){var e=this,t=this.client_.getSubscriptionManager();t&&A(this.remoteStreams_.values()).forEach((function(r){t.hasAutoRecoveryFlag(e.userId_,r.getType())&&t.recover(r)}))}},{key:"getIsReconnecting",value:function(){return this.isReconnecting_}},{key:"getSubscribedMainStream",value:function(){var e=null;return this.isMainStreamSubscribed&&(e=this.remoteStreams_.get(rl)),e}},{key:"clearReconnectionTimer",value:function(){-1!==this.reconnectionTimer_&&(clearTimeout(this.reconnectionTimer_),this.reconnectionTimer_=-1)}},{key:"startReconnection",value:function(){var e=this.client_.getSubscriptionManager();if(e){var t,r=C(this.remoteStreams_.values());try{for(r.s();!(t=r.n()).done;){var i=t.value,n=i.getType();("main"===n&&(this.trackState_.audio||this.trackState_.video)||"auxiliary"===n&&this.trackState_.auxiliary)&&e.setAutoRecoveryFlag(this.userId_,i.getType())}}catch(s){r.e(s)}finally{r.f()}}v(d(f.prototype),"startReconnection",this).call(this)}},{key:"getCurrentState",value:function(){return this.currentState_}}]),f}(uA),LA=function(e){return function(t,r,i,n){ie(r);var o=ce(t),s=V(o),a=at(o),c=e?a-1:0,l=e?-1:1;if(i<2)for(;;){if(c in s){n=s[c],c+=l;break}if(c+=l,e?c<0:a<=c)throw TypeError("Reduce of empty array with no initial value")}for(;e?c>=0:a>c;c+=l)c in s&&(n=r(n,s[c],c,o));return n}},PA={left:LA(!1),right:LA(!0)}.left,DA=$n("reduce");It({target:"Array",proto:!0,forced:!DA||!sp&&J>79&&J<83},{reduce:function(e){return PA(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}});var MA=function(){function e(){s(this,e),this.startTime=0,this.endTime=0,this.start()}return c(e,[{key:"start",value:function(){0===this.startTime&&(this.startTime=rh())}},{key:"stop",value:function(){0===this.endTime&&(this.endTime=rh())}},{key:"getDuration",value:function(){return 0===this.endTime?rh()-this.startTime:this.endTime-this.startTime}}]),e}(),xA=function(){function e(t){s(this,e),this.client_=t.client,this.intervalId_=-1,this.statsCalculator_=t.stats,this.prevStats_=null,this.renderFreezeMap_=new Map,this.remoteStreamMap_=new Map,this.dataFreezeMap_=new Map,this.monitorFreezeData_=new Map}var t,r,i;return c(e,[{key:"installEvents",value:function(){gh.on(Kh,this.handlePlayVideoStart,this),gh.on(qh,this.onVideoTrackMuted,this),gh.on(zh,this.onVideoTrackUnmuted,this),gh.on(jh,this.handleStreamStopped,this),gh.on(Fh,this.handleStreamStopped,this),gh.on(Ph,this.handleVideoPlaying,this)}},{key:"uninstallEvents",value:function(){gh.off(Kh,this.handlePlayVideoStart,this),gh.off(qh,this.onVideoTrackMuted,this),gh.off(zh,this.onVideoTrackUnmuted,this),gh.off(jh,this.handleStreamStopped,this),gh.off(Fh,this.handleStreamStopped,this),gh.off(Ph,this.handleVideoPlaying,this)}},{key:"start",value:function(){var e=this;-1===this.intervalId_&&(this.installEvents(),this.intervalId_=wv.setInterval(o(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.detectFPS();case 3:t.next=7;break;case 5:t.prev=5,t.t0=t.catch(0);case 7:case"end":return t.stop()}}),t,null,[[0,5]])}))),1e3))}},{key:"stop",value:function(){-1!==this.intervalId_&&(this.uninstallEvents(),wv.clearInterval(this.intervalId_),this.intervalId_=-1,this.renderFreezeMap_.clear(),this.dataFreezeMap_.clear(),this.remoteStreamMap_.clear())}},{key:"onVideoTrackMuted",value:function(e){var t=e.stream;if(t.getClient()===this.client_&&t.isRemote()){var r=t.userId_,i=t.type_,n="".concat(r,"_").concat(i),o=this.dataFreezeMap_.get(n),s=new MA;o?o.durationItemList.push(s):this.dataFreezeMap_.set(n,{userId:r,type:i,durationItemList:[s],isFreezing:function(){var e=this.durationItemList[this.durationItemList.length-1];return e&&0===e.endTime}})}}},{key:"onVideoTrackUnmuted",value:function(e){var t=e.stream;if(t.getClient()===this.client_&&t.isRemote()){var r=t.userId_,i=t.type_,n="".concat(r,"_").concat(i);this.stopDataFreeze({key:n,userId:r,type:i})}}},{key:"handleStreamStopped",value:function(e){var t=e.client,r=e.stream;if(t===this.client_){var i=r.getUserId(),n=r.getType(),o="".concat(i,"_").concat(n);this.stopDataFreeze({key:o,userId:i,type:n})}}},{key:"stopDataFreeze",value:function(e){var t=e.key,r=e.userId,i=e.type,n=this.dataFreezeMap_.get(t);if(n&&n.isFreezing()){var o=n.durationItemList[n.durationItemList.length-1];o.stop();var s=o.getDuration();s>500?(jd.logEvent({eventType:"videoFrozenCount",delta:s}),this.monitorFreezeData_.set(t,{userId:r,type:i,duration:s})):n.durationItemList.pop()}}},{key:"getTotalDuration",value:function(e){return e.reduce((function(e,t){var r=t.getDuration();return e+Math.min(r,5e3)}),0)}},{key:"getStats",value:(i=o(regeneratorRuntime.mark((function e(){var t,r,i,n,o,s,a,c,l,u,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.client_.getConnections(),r={},i=C(t),e.prev=3,i.s();case 5:if((n=i.n()).done){e.next=20;break}if(o=E(n.value,2),s=o[0],(a=o[1]).getPeerConnection()){e.next=9;break}return e.abrupt("continue",18);case 9:return c=a.getSubscribeState(),l=a.getTrackState(),e.next=13,this.statsCalculator_.getReceiverStats(a);case 13:u=e.sent,(d={userId:u.userId,tinyId:s,hasVideo:l.video&&c.video,hasAuxiliary:l.auxiliary&&c.auxiliary,video:{framesDecoded:0},auxiliary:{framesDecoded:0}}).hasVideo&&(d.video.framesDecoded=u.video.framesDecoded),d.hasAuxiliary&&(d.auxiliary.framesDecoded=u.auxiliary.framesDecoded),r[u.userId]=d;case 18:e.next=5;break;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(3),i.e(e.t0);case 25:return e.prev=25,i.f(),e.finish(25);case 28:return e.abrupt("return",r);case 29:case"end":return e.stop()}}),e,this,[[3,22,25,28]])}))),function(){return i.apply(this,arguments)})},{key:"detectFPS",value:(r=o(regeneratorRuntime.mark((function e(){var t,r,i,n,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getStats();case 2:if(t=e.sent,this.prevStats_){e.next=6;break}return this.prevStats_=t,e.abrupt("return");case 6:e.t0=regeneratorRuntime.keys(t);case 7:if((e.t1=e.t0()).done){e.next=17;break}if(r=e.t1.value,this.prevStats_[r]){e.next=11;break}return e.abrupt("continue",7);case 11:i=t[r].tinyId,n=this.client_.getMutedStates(),t[r].hasVideo&&this.prevStats_[r].hasVideo&&n.has(i)&&!n.get(i).videoMuted&&(o=t[r].video.framesDecoded-this.prevStats_[r].video.framesDecoded,this.handleRenderFreeze({userId:r,type:"main",fps:o})),t[r].hasAuxiliary&&this.prevStats_[r].hasAuxiliary&&(s=t[r].auxiliary.framesDecoded-this.prevStats_[r].auxiliary.framesDecoded,this.handleRenderFreeze({userId:r,type:"auxiliary",fps:s})),e.next=7;break;case 17:this.prevStats_=t;case 18:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"handleRenderFreeze",value:(t=o(regeneratorRuntime.mark((function e(t){var r,i,n,o,s,a,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.userId,i=t.fps,n=t.type,o="".concat(r,"_").concat(n),s=this.renderFreezeMap_.get(o),i<=2?(a=rh(),s&&!s.isFreeze&&(s.freezeTimeline.push({startTime:a,endTime:void 0}),s.isFreeze=!0),s||this.renderFreezeMap_.set(o,{userId:r,type:n,isFreeze:!0,freezeTimeline:[{startTime:a,endTime:void 0}],renderFreezeTotal:0})):s&&s.isFreeze&&(s.isFreeze=!1,(c=s.freezeTimeline.pop()).endTime=rh(),l=c.endTime-c.startTime,s.freezeTimeline.push(c),s.renderFreezeTotal+=Math.min(5e3,l));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"handlePlayVideoStart",value:function(e){var t=e.stream;if(t.getClient()===this.client_&&t.isRemote()&&t.hasVideo()){var r="".concat(t.getUserId(),"_").concat(t.getType());this.remoteStreamMap_.has(r)?this.remoteStreamMap_.get(r).remoteStream=t:this.remoteStreamMap_.set(r,{isPlayingFired:!1,remoteStream:t})}}},{key:"handleVideoPlaying",value:function(e){var t=e.stream;if(t.isRemote()&&t.getClient()===this.client_){var r="".concat(t.getUserId(),"_").concat(t.getType());this.remoteStreamMap_.has(r)&&(this.remoteStreamMap_.get(r).isPlayingFired=!0)}}},{key:"getDataFreezeDuration",value:function(e){var t={dataFreeze:0,count:0},r=this.dataFreezeMap_.get(e);if(r){if(r.isFreezing()){var i=r.durationItemList[r.durationItemList.length-1];i.stop(),i.getDuration()<500&&r.durationItemList.pop()}t.dataFreeze=this.getTotalDuration(r.durationItemList),t.count=r.durationItemList.length}return t}},{key:"getRenderFreezeDuration",value:function(e){var t=this.renderFreezeMap_.get(e),r=0,i=0;if(t)if(t.isFreeze){var n=rh()-t.freezeTimeline[t.freezeTimeline.length-1].startTime;r=t.renderFreezeTotal+Math.min(n,5e3),i=t.freezeTimeline.length}else r=t.renderFreezeTotal;return{renderFreeze:r,count:i}}},{key:"getMonitorFreeze",value:function(){return this.monitorFreezeData_}},{key:"isBlackStream",value:function(e){return!!this.remoteStreamMap_.has(e)&&!this.remoteStreamMap_.get(e).isPlayingFired}},{key:"resetMonitor",value:function(){this.monitorFreezeData_.clear()}}]),e}(),BA=function e(t){s(this,e),this.userId=t.userId,this.tinyId=t.tinyId,this.role=t.role===el?"anchor":"audience"},UA=I((function(e){!function(t){function r(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function i(e,t,i,n,o,s){return r((a=r(r(t,e),r(n,s)))<<(c=o)|a>>>32-c,i);var a,c}function n(e,t,r,n,o,s,a){return i(t&r|~t&n,e,t,o,s,a)}function o(e,t,r,n,o,s,a){return i(t&n|r&~n,e,t,o,s,a)}function s(e,t,r,n,o,s,a){return i(t^r^n,e,t,o,s,a)}function a(e,t,r,n,o,s,a){return i(r^(t|~n),e,t,o,s,a)}function c(e,t){var i,c,l,u,d;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var h=1732584193,p=-271733879,f=-1732584194,g=271733878;for(i=0;i<e.length;i+=16)c=h,l=p,u=f,d=g,h=n(h,p,f,g,e[i],7,-680876936),g=n(g,h,p,f,e[i+1],12,-389564586),f=n(f,g,h,p,e[i+2],17,606105819),p=n(p,f,g,h,e[i+3],22,-1044525330),h=n(h,p,f,g,e[i+4],7,-176418897),g=n(g,h,p,f,e[i+5],12,1200080426),f=n(f,g,h,p,e[i+6],17,-1473231341),p=n(p,f,g,h,e[i+7],22,-45705983),h=n(h,p,f,g,e[i+8],7,1770035416),g=n(g,h,p,f,e[i+9],12,-1958414417),f=n(f,g,h,p,e[i+10],17,-42063),p=n(p,f,g,h,e[i+11],22,-1990404162),h=n(h,p,f,g,e[i+12],7,1804603682),g=n(g,h,p,f,e[i+13],12,-40341101),f=n(f,g,h,p,e[i+14],17,-1502002290),h=o(h,p=n(p,f,g,h,e[i+15],22,1236535329),f,g,e[i+1],5,-165796510),g=o(g,h,p,f,e[i+6],9,-1069501632),f=o(f,g,h,p,e[i+11],14,643717713),p=o(p,f,g,h,e[i],20,-373897302),h=o(h,p,f,g,e[i+5],5,-701558691),g=o(g,h,p,f,e[i+10],9,38016083),f=o(f,g,h,p,e[i+15],14,-660478335),p=o(p,f,g,h,e[i+4],20,-405537848),h=o(h,p,f,g,e[i+9],5,568446438),g=o(g,h,p,f,e[i+14],9,-1019803690),f=o(f,g,h,p,e[i+3],14,-187363961),p=o(p,f,g,h,e[i+8],20,1163531501),h=o(h,p,f,g,e[i+13],5,-1444681467),g=o(g,h,p,f,e[i+2],9,-51403784),f=o(f,g,h,p,e[i+7],14,1735328473),h=s(h,p=o(p,f,g,h,e[i+12],20,-1926607734),f,g,e[i+5],4,-378558),g=s(g,h,p,f,e[i+8],11,-2022574463),f=s(f,g,h,p,e[i+11],16,1839030562),p=s(p,f,g,h,e[i+14],23,-35309556),h=s(h,p,f,g,e[i+1],4,-1530992060),g=s(g,h,p,f,e[i+4],11,1272893353),f=s(f,g,h,p,e[i+7],16,-155497632),p=s(p,f,g,h,e[i+10],23,-1094730640),h=s(h,p,f,g,e[i+13],4,681279174),g=s(g,h,p,f,e[i],11,-358537222),f=s(f,g,h,p,e[i+3],16,-722521979),p=s(p,f,g,h,e[i+6],23,76029189),h=s(h,p,f,g,e[i+9],4,-640364487),g=s(g,h,p,f,e[i+12],11,-421815835),f=s(f,g,h,p,e[i+15],16,530742520),h=a(h,p=s(p,f,g,h,e[i+2],23,-995338651),f,g,e[i],6,-198630844),g=a(g,h,p,f,e[i+7],10,1126891415),f=a(f,g,h,p,e[i+14],15,-1416354905),p=a(p,f,g,h,e[i+5],21,-57434055),h=a(h,p,f,g,e[i+12],6,1700485571),g=a(g,h,p,f,e[i+3],10,-1894986606),f=a(f,g,h,p,e[i+10],15,-1051523),p=a(p,f,g,h,e[i+1],21,-2054922799),h=a(h,p,f,g,e[i+8],6,1873313359),g=a(g,h,p,f,e[i+15],10,-30611744),f=a(f,g,h,p,e[i+6],15,-1560198380),p=a(p,f,g,h,e[i+13],21,1309151649),h=a(h,p,f,g,e[i+4],6,-145523070),g=a(g,h,p,f,e[i+11],10,-1120210379),f=a(f,g,h,p,e[i+2],15,718787259),p=a(p,f,g,h,e[i+9],21,-343485551),h=r(h,c),p=r(p,l),f=r(f,u),g=r(g,d);return[h,p,f,g]}function l(e){var t,r="",i=32*e.length;for(t=0;t<i;t+=8)r+=String.fromCharCode(e[t>>5]>>>t%32&255);return r}function u(e){var t,r=[];for(r[(e.length>>2)-1]=void 0,t=0;t<r.length;t+=1)r[t]=0;var i=8*e.length;for(t=0;t<i;t+=8)r[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return r}function d(e){var t,r,i="";for(r=0;r<e.length;r+=1)t=e.charCodeAt(r),i+="0123456789abcdef".charAt(t>>>4&15)+"0123456789abcdef".charAt(15&t);return i}function h(e){return unescape(encodeURIComponent(e))}function p(e){return function(e){return l(c(u(e),8*e.length))}(h(e))}function f(e,t){return function(e,t){var r,i,n=u(e),o=[],s=[];for(o[15]=s[15]=void 0,n.length>16&&(n=c(n,8*e.length)),r=0;r<16;r+=1)o[r]=909522486^n[r],s[r]=1549556828^n[r];return i=c(o.concat(u(t)),512+8*t.length),l(c(s.concat(i),640))}(h(e),h(t))}function g(e,t,r){return t?r?f(t,e):d(f(t,e)):r?p(e):d(p(e))}e.exports?e.exports=g:t.md5=g}(b)})),FA=function(){function e(t){s(this,e),this.client_=t.client,this.signalChannel_=t.signalChannel,this.log_=Tf.createLogger({id:"mix|"+this.client_.getUserId(),userId:t.client.getUserId(),sdkAppId:t.client.getSDKAppId()}),this.isMixing_=!1,this.config_=null,this.data_=null,this.remoteStreamMap_=new Map,this.installEvents()}var t,r,i,n;return c(e,[{key:"isPresetLayoutMode",get:function(){return this.config_&&this.config_.mode===Hl.PRESET_LAYOUT}},{key:"installEvents",value:function(){gh.on(Uh,this.onStreamSubscribed,this),gh.on(Fh,this.onStreamUnsubscribed,this),this.client_.on("stream-removed",this.onStreamRemoved,this)}},{key:"uninstallEvents",value:function(){gh.off(Uh,this.onStreamSubscribed,this),gh.off(Fh,this.onStreamUnsubscribed,this),this.client_.off("stream-removed",this.onStreamRemoved,this)}},{key:"stop",value:function(){this.uninstallEvents()}},{key:"onStreamSubscribed",value:function(e){var t=e.client,r=e.stream;t===this.client_&&(this.remoteStreamMap_.set(r.getId(),{remoteStream:r,isUsed:!1}),this.isMixing_&&this.hasAvailablePlaceHolder()&&this.startMixTranscode(this.config_))}},{key:"onStreamUnsubscribed",value:function(e){var t=e.client,r=e.stream;t===this.client_&&this.onStreamRemoved({stream:r})}},{key:"onStreamRemoved",value:function(e){var t=e.stream;if(this.remoteStreamMap_.has(t.getId())){var r=this.remoteStreamMap_.get(t.getId()).isUsed;this.remoteStreamMap_.delete(t.getId()),this.isMixing_&&this.isPresetLayoutMode&&r&&this.startMixTranscode(this.config_)}}},{key:"startMixTranscode",value:(n=o(regeneratorRuntime.mark((function e(t){var r,i,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.resetIsUsedFlag(),this.config_=t,r=this.getInputParam(t,this.remoteStreamMap_),i=this.getOutputParam(t),n=this.getOutputSessionId({config:t,roomId:this.client_.getRoomId(),userId:this.client_.getUserId()}),!this.isMixing_||!this.data_||n===this.data_.outputSessionId){e.next=10;break}return this.log_.info("startMixTranscode() streamId changed, stop mixing before start"),e.next=10,this.doStopMixTranscode();case 10:return e.next=12,this.doStartMixTranscode({outputSessionId:n,inputParam:r,outputParam:i});case 12:e.next=18;break;case 14:throw e.prev=14,e.t0=e.catch(0),this.resetIsUsedFlag(),e.t0;case 18:case"end":return e.stop()}}),e,this,[[0,14]])}))),function(e){return n.apply(this,arguments)})},{key:"doStartMixTranscode",value:(i=o(regeneratorRuntime.mark((function e(t){var r,i,n,o,s,a,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.outputSessionId,i=t.inputParam,n=t.outputParam,o={roomid:String(this.client_.getRoomId()),sdkAppID:String(this.client_.getSDKAppId()),socketid:this.signalChannel_.getSocketId(),mcuRequestTime:Date.now(),outputSessionId:r,inputParam:i,outputParam:n},this.data_=o,this.log_.info("startMixTranscode: ".concat(JSON.stringify(o))),this.isMixing_=!0,e.prev=5,e.next=8,this.signalChannel_.sendWaitForResponse({command:Ig,data:o,timeout:5e3,responseCommand:cg.START_MIX_TRANSCODE_RES,commandDesc:"startMixTranscode"});case 8:if(s=e.sent,a=s.data.content,c=a.errCode,l=a.errMsg,0===c){e.next=15;break}throw-102083===c&&(l="Please enable relayed-push in ".concat("https://console.cloud.tencent.com/trtc"," and try later, refer to ").concat(Ru,"tutorial-26-advanced-publish-cdn-stream.html")),this.log_.error("startMixTranscode failed, errCode: ".concat(c," errMsg: ").concat(l)),this.isMixing_=!1,new Vd({code:Fd.START_MIX_TRANSCODE_FAILED,message:uv({key:B_,data:{message:l},link:{className:"Client",fnName:"startMixTranscode"}})});case 15:e.next=21;break;case 17:throw e.prev=17,e.t0=e.catch(5),this.isMixing_=!1,e.t0;case 21:case"end":return e.stop()}}),e,this,[[5,17]])}))),function(e){return i.apply(this,arguments)})},{key:"stopMixTranscode",value:(r=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isMixing_){e.next=2;break}throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:F_})});case 2:return e.next=4,this.doStopMixTranscode();case 4:this.resetIsUsedFlag();case 5:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"doStopMixTranscode",value:(t=o(regeneratorRuntime.mark((function e(){var t,r,i,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={roomid:String(this.client_.getRoomId()),sdkAppID:String(this.client_.getSDKAppId()),socketid:this.signalChannel_.getSocketId(),userid:this.client_.getUserId(),mcuRequestTime:Date.now(),outPutSessionId:this.data_.outputSessionId,streamType:this.data_.outputParam.streamType},this.log_.info("stopMixTranscode: ".concat(JSON.stringify(t))),e.next=4,this.signalChannel_.sendWaitForResponse({command:Rg,data:t,timeout:5e3,responseCommand:cg.STOP_MIX_TRANSCODE_RES,commandDesc:"stopMixTranscode"});case 4:if(r=e.sent,i=r.data.content,n=i.errCode,o=i.errMsg,0!==n){e.next=10;break}this.isMixing_=!1,e.next=12;break;case 10:throw this.log_.error("stopMixTranscode failed, errCode: ".concat(n," errMsg: ").concat(o)),new Vd({code:Fd.STOP_MIX_TRANSCODE_FAILED,message:uv({key:U_,data:{message:o},link:{className:"Client",fnName:"stopMixTranscode"}})});case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"getOutputSessionId",value:function(e){var t=e.config,r=e.userId,i=e.roomId;return Kd(t.streamId)&&t.streamId.length>0?t.streamId:UA("".concat(i,"_").concat(r,"_main"))}},{key:"getInputParam",value:function(e,t){var r=this,i=e.mixUsers.map((function(e){return{userid:e.userId,roomid:String(e.roomId||r.client_.getRoomId()),width:e.width||0,height:e.height||0,locationX:e.locationX||0,locationY:e.locationY||0,zOrder:e.zOrder,streamType:Yd(e.streamType)||"auxiliary"!==e.streamType?0:1,inputType:e.pureAudio?Wl.IT_PURE_AUDIO:Wl.IT_AUDIO_VIDEO}}));return e.mode===Hl.PRESET_LAYOUT&&(i.forEach((function(e){if(e.userid===Ql.REMOTE){var r=A(t.values()).find((function(e){return!e.isUsed}));r&&(e.userid=r.remoteStream.getUserId(),e.streamType="auxiliary"===r.remoteStream.getType()?1:0,r.isUsed=!0)}})),i=i.filter((function(e){return e.userid!==Ql.REMOTE}))),i}},{key:"getOutputParam",value:function(e){var t=e.streamId||"";return{streamId:t,streamType:t.length>0?1:0,videoWidth:Yd(e.videoWidth)?640:e.videoWidth,videoHeight:Yd(e.videoHeight)?480:e.videoHeight,videoBitrate:e.videoBitrate||0,videoFramerate:e.videoFramerate||15,videoGOP:e.videoGOP||2,audioSampleRate:e.audioSampleRate||48e3,audioBitrate:e.audioBitrate||64,audioChannels:e.audioChannels||1,backgroundColor:e.backgroundColor||0,backgroundImage:e.backgroundImage||"",extraInfo:"",VCodec:2,ACodec:0}}},{key:"hasAvailablePlaceHolder",value:function(){return!!this.isPresetLayoutMode&&this.data_.inputParam.length!==this.config_.mixUsers.length}},{key:"resetIsUsedFlag",value:function(){this.remoteStreamMap_.forEach((function(e){return e.isUsed=!1}))}}]),e}(),VA=function(){function e(t){s(this,e),this.client_=t.client,this.signalChannel_=t.signalChannel,this.isPublishingTencentCDN_=!1,this.publishTencentStreamRetryCount_=0,this.publishGivenCDNData_=null,this.isPublishingGivenCDN_=!1}var t,r,i,n,a;return c(e,[{key:"getIsPublishingTencentCDN",value:function(){return this.isPublishingTencentCDN_}},{key:"getIsPublishingGivenCDN",value:function(){return this.isPublishingGivenCDN_}},{key:"startPublishTencentCDN",value:(a=o(regeneratorRuntime.mark((function e(t){var r,i,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t.streamId)||(i="".concat(this.client_.getRoomId(),"_").concat(this.client_.getUserId(),"_main"),/^[A-Za-z\d_-]*$/.test(i)||(i=UA(i)),r="".concat(this.client_.getSDKAppId(),"_").concat(i)),n={roomid:String(this.client_.getRoomId()),sdkAppID:String(this.client_.getSDKAppId()),requestTime:Date.now(),sessionId:UA("".concat(this.client_.getRoomId(),"_").concat(this.client_.getUserId(),"_main")),streamId:r,streamType:0},this.isPublishingTencentCDN_=!0,this.publishTencentStreamRetryCount_=0,e.next=7,this.doStartPublishTencentCDN(n);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"doStartPublishTencentCDN",value:(n=o(regeneratorRuntime.mark((function e(t){var r,i,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Tf.info("startPublishTencentCDN: "+JSON.stringify(t)),e.next=4,this.signalChannel_.sendWaitForResponse({command:Sg,data:t,timeout:2e3,responseCommand:cg.START_PUBLISH_TENCENT_CDN_RES,commandDesc:"startPublishCDNStream",retry:2});case 4:if(r=e.sent,i=r.data.content,n=i.errCode,o=i.errMsg,0===n){e.next=11;break}throw this.isPublishingTencentCDN_=!1,-102083===n&&(o="Please enable relayed-push in ".concat("https://console.cloud.tencent.com/trtc"," and try later, refer to ").concat(Ru,"tutorial-26-advanced-publish-cdn-stream.html")),Tf.error("startPublishTencentCDN failed, errCode: ".concat(n,", errMsg: ").concat(o)),new Vd({code:Fd.START_PUBLISH_CDN_FAILED,message:uv({key:u_,data:{message:o},link:{className:"Client",fnName:"startPublishCDNStream"}})});case 11:e.next=17;break;case 13:throw e.prev=13,e.t0=e.catch(0),this.isPublishingTencentCDN_=!1,e.t0;case 17:case"end":return e.stop()}}),e,this,[[0,13]])}))),function(e){return n.apply(this,arguments)})},{key:"stopPublishTencentCDN",value:(i=o(regeneratorRuntime.mark((function e(){var t,r,i,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={roomid:String(this.client_.getRoomId()),sdkAppID:String(this.client_.getSDKAppId()),requestTime:Date.now(),sessionId:UA("".concat(this.client_.getRoomId(),"_").concat(this.client_.getUserId(),"_main"))},Tf.info("stopPublishTencentCDN: "+JSON.stringify(t)),e.next=4,this.signalChannel_.sendWaitForResponse({command:Cg,data:t,timeout:5e3,responseCommand:cg.STOP_PUBLISH_TENCENT_CDN_RES,commandDesc:"stopPublishCDNStream"});case 4:if(r=e.sent,i=r.data.content,n=i.errCode,o=i.errMsg,0!==n){e.next=10;break}this.isPublishingTencentCDN_=!1,e.next=17;break;case 10:if(-102069!==n){e.next=15;break}Tf.warn("stopPublishTencentCDN failed, can not stopPublishTencentCDN in auto relayed-push mode"),this.isPublishingTencentCDN_=!1,e.next=17;break;case 15:throw Tf.error("stopPublishTencentCDN failed, errCode: ".concat(n," errMsg: ").concat(o)),new Vd({code:Fd.STOP_PUBLISH_CDN_FAILED,message:uv({key:d_,data:{message:o},link:{className:"Client",fnName:"stopPublishCDNStream"}})});case 17:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"startPublishGivenCDN",value:(r=o(regeneratorRuntime.mark((function e(t){var r,i,n,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={roomid:String(this.client_.getRoomId()),sdkAppID:String(this.client_.getSDKAppId()),socketid:this.signalChannel_.getSocketId(),pushRequestTime:Date.now(),pushAppid:t.appId,pushBizId:t.bizId,pushCdnUrl:t.url,pushStreamType:"main"},Tf.info("startPublishGivenCDN: "+JSON.stringify(r)),this.publishGivenCDNData_=r,this.isPublishingGivenCDN_=!0,e.prev=4,e.next=7,this.signalChannel_.sendWaitForResponse({command:Tg,data:r,timeout:5e3,responseCommand:cg.START_PUBLISH_GIVEN_CDN_RES,commandDesc:"startPublishCDNStream"});case 7:if(i=e.sent,n=i.data.content,o=n.errCode,s=n.errMsg,0===o){e.next=13;break}throw Tf.error("startPublishGivenCDN failed, errCode: ".concat(o,", errMsg: ").concat(s)),this.isPublishingGivenCDN_=!1,new Vd({code:Fd.START_PUBLISH_CDN_FAILED,message:uv({key:u_,data:{message:s},link:{className:"Client",fnName:"startPublishCDNStream"}})});case 13:e.next=19;break;case 15:throw e.prev=15,e.t0=e.catch(4),this.isPublishingGivenCDN_=!1,e.t0;case 19:case"end":return e.stop()}}),e,this,[[4,15]])}))),function(e){return r.apply(this,arguments)})},{key:"stopPublishGivenCDN",value:(t=o(regeneratorRuntime.mark((function e(){var t,r,i,n,o,s,a,c,l,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.publishGivenCDNData_,r=t.pushAppid,i=t.pushBizId,n=t.pushCdnUrl,o=t.pushStreamType,s={roomid:String(this.client_.getRoomId()),sdkAppID:String(this.client_.getSDKAppId()),socketid:this.signalChannel_.getSocketId(),pushRequestTime:Date.now(),pushAppid:r,pushBizId:i,pushCdnUrl:n,pushStreamType:o},Tf.info("stopPublishGivenCDN: "+JSON.stringify(s)),e.next=5,this.signalChannel_.sendWaitForResponse({command:bg,data:s,timeout:5e3,responseCommand:cg.STOP_PUBLISH_GIVEN_CDN_RES,commandDesc:"stopPublishCDNStream"});case 5:if(a=e.sent,c=a.data.content,l=c.errCode,u=c.errMsg,0!==l){e.next=11;break}this.isPublishingGivenCDN_=!1,e.next=13;break;case 11:throw Tf.error("stopPublishGivenCDN failed, errCode: ".concat(l," errMsg: ").concat(u)),new Vd({code:Fd.STOP_PUBLISH_CDN_FAILED,message:uv({key:d_,data:{message:u},link:{className:"Client",fnName:"stopPublishCDNStream"}})});case 13:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),jA=function(){function e(t){s(this,e),this.client_=t.client,this.durationMap_=new Map,this.installEvents()}return c(e,[{key:"installEvents",value:function(){gh.on(Uh,this.handleSubscribed,this),gh.on(Mh,this.handleStreamTrackUpdated,this),gh.on(Fh,this.handleStreamStopped,this),gh.on(jh,this.handleStreamStopped,this)}},{key:"uninstallEvents",value:function(){gh.off(Uh,this.handleSubscribed,this),gh.off(Vh,this.handleStreamTrackUpdated,this),gh.off(Fh,this.handleStreamStopped,this),gh.off(jh,this.handleStreamStopped,this)}},{key:"handleSubscribed",value:function(e){var t=e.client,r=e.stream;if(t===this.client_){var i=r.getUserId(),n=r.getType(),o="".concat(i,"_").concat(n);if(r.hasAudio())if(r.isMainAudioSubscribed){var s=new MA,a=this.durationMap_.get(o);a?this.isRecording(a.audio)||a.audio.push(s):this.durationMap_.set(o,{userId:i,type:n,audio:[s],video:[]})}else this.stopDurationItem(o,Jl);if(r.hasVideo())if("main"===n&&r.isMainVideoSubscribed||"auxiliary"===n&&r.isAuxVideoSubscribed){var c=new MA,l=this.durationMap_.get(o);l?this.isRecording(l.video)||l.video.push(c):this.durationMap_.set(o,{userId:i,type:n,audio:[],video:[c]})}else this.stopDurationItem(o,Xl)}}},{key:"handleStreamStopped",value:function(e){var t=e.client,r=e.stream;if(this.clientHitTest(t)){var i=r.getUserId(),n=r.getType(),o="".concat(i,"_").concat(n);this.stopDurationItem(o,Jl),this.stopDurationItem(o,Xl)}}},{key:"handleStreamTrackUpdated",value:function(e){var t=e.client,r=e.userId,i=e.tinyId,n=e.kind,o=e.action;if(this.clientHitTest(t)&&this.client_.getConnections().has(i)){var s=n===eu?n:"main",a="".concat(r,"_").concat(s);if(o===fu){var c=this.client_.getConnections().get(i).getSubscribeState();if(n===Jl&&!c.audio||n===Xl&&!c.video||n===eu&&!c.auxiliary)return;var l=new MA,u=this.durationMap_.get(a);u?(n!==Jl||this.isRecording(u.audio)||u.audio.push(l),n===Jl||this.isRecording(u.video)||u.video.push(l)):this.durationMap_.set(a,{userId:r,type:s,audio:n===Jl?[l]:[],video:n===Jl?[]:[l]})}else this.stopDurationItem(a,n===Jl?Jl:Xl)}}},{key:"isRecording",value:function(e){return e.findIndex((function(e){return 0===e.endTime}))>=0}},{key:"stopDurationItem",value:function(e,t){if(this.durationMap_.has(e)){var r=this.durationMap_.get(e)[t].find((function(e){return 0===e.endTime}));r&&r.stop()}}},{key:"clientHitTest",value:function(e){return this.client_===e}},{key:"getDuration",value:function(e,t){return this.durationMap_.has(e)?this.durationMap_.get(e)[t].reduce((function(e,t){return e+t.getDuration()}),0):0}},{key:"getDurationMap",value:function(){return this.durationMap_}},{key:"reset",value:function(){this.durationMap_.clear()}}]),e}(),GA=nn.f,HA=N((function(){return!Object.getOwnPropertyNames(1)}));It({target:"Object",stat:!0,forced:HA},{getOwnPropertyNames:GA});var QA,WA,qA,zA,ZA,YA,KA,$A,JA,XA,ey,ty,ry,iy,ny={unknown:0,wifi:1,"4g":2,"3g":3,"2g":4,wired:5},oy={msg_user_info:0,uint32_video_avg_fps:0,uint32_video_width:0,uint32_video_height:0,uint32_video_avg_bitrate:0,uint32_video_block_time:0,uint32_video_play_time:0,uint32_audio_block_time:0,uint32_audio_play_time:0,uint32_audio_play_db:0,uint32_avg_down_loss:0,uint32_stream_type:0,uint32_video_render_first:0,uint32_video_block_count:0,uint32_audio_block_count:0,uint32_audio_bitrate:0,uint32_video_black_screen_subjective:0,uint32_audio_recv_bitrate:0,uint32_video_external_block_time:0},sy=function e(t){s(this,e),this.str_identifier=String(t.userId),this.uint64_tinyid=Number(t.tinyId),this.uint32_role=t.role},ay=function(){function e(t){var r=this;s(this,e),this.frameWorkType_=t.frameWorkType||30,this.client_=t.client,this.keyPrefix_="key_point",this.storageKey_="".concat(this.keyPrefix_,"_").concat(this.client_.getUserId()),this.log_=Tf.createLogger({id:"kpm|"+this.client_.getUserId(),userId:this.client_.getUserId(),sdkAppId:this.client_.getSDKAppId()}),this.upload=yf({retryFunction:this.upload,settings:{timeout:500,retries:3},onError:function(e,t){return t()}}),Object.getOwnPropertyNames(this.__proto__).forEach((function(e){e.startsWith("handle")&&Zd(r[e])&&(r[e]=function(e){var t=e.fn,r=e.context;return o(regeneratorRuntime.mark((function e(){var i,n,o,s=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(e.prev=0,i=s.length,n=new Array(i),o=0;o<i;o++)n[o]=s[o];return e.next=4,t.apply(r||this,n);case 4:return e.abrupt("return",e.sent);case 7:e.prev=7,e.t0=e.catch(0),Tf.error("".concat(t.name,"() error observed ")+e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})))}({fn:r[e],context:r}))})),this.initData(),this.installEvents(),this.intervalId_=wv.setInterval(this.setStorage.bind(this),2e4)}var t,i,n;return c(e,[{key:"initData",value:function(){this.firstPublishedUserList_=[],this.networkQuality_={totalUplinkRTT:0,totalUplinkLoss:0,count:0,totalDownlinkRTTAndLossMap:new Map},this.basicInfo={string_sdk_version:"4.11.12",uint32_os_type:15,string_device_name:"",string_http_user_agent:navigator.userAgent,string_os_version:"",uint32_avg_rtt:0,uint32_avg_up_loss:0,uint32_scene:"live"===this.client_.getMode()?1:0,uint32_joining_duration:0,uint32_networkType:ny[Wd()],uint32_framework:this.frameWorkType_},this.pathJoinRoom_={uint64_start_time:0,uint64_init_audio_start_time:0,uint64_init_audio_end_time:0,uint64_init_camera_start_time:0,uint64_init_camera_end_time:0,uint64_send_request_acc_ip_cmd_start_time:0,uint64_send_request_acc_ip_cmd_end_time:0,uint64_send_request_enter_room_cmd_start_time:0,uint64_send_request_enter_room_cmd_end_time:0,uint64_send_first_video_frame_time:0,uint64_recv_userlist_time:0,uint64_end_time:0,int32_init_audio_ret:0,int32_init_camera_ret:0,int32_send_request_acc_ip_cmd_ret:0,int32_send_request_enter_room_cmd_ret:0,int32_end_ret:0},this.pathLeaveRoom_={uint64_start_time:0,uint64_send_request_exit_room_cmd_start_time:0,uint64_send_request_exit_room_cmd_end_time:0,uint64_end_time:0,int32_send_request_exit_room_cmd_ret:0,int32_end_ret:0},this.pathMainVideoMap_=new Map,this.pathMainAudioMap_=new Map,this.pathAuxiliaryMap_=new Map,this.localStreamStats_={totalVideoBitrate:0,totalVideoFPS:0,totalVideoHeight:0,totalVideoWidth:0,totalAudioLevel:0,videoCount:0,audioLevelCount:0,publishStartTime:0,statsToReport:{uint32_audio_capture_db:0,uint32_video_big_capture_fps:0,uint32_video_big_bitrate:0,uint32_video_big_resolution:0}},this.remoteStreamStatsMap_=new Map}},{key:"installEvents",value:function(){gh.on(mh,this.handleJoinStart,this),gh.on(Rh,this.handleWSStart,this),gh.on(wh,this.handleWSEnd,this),gh.on(_h,this.handleJoinSendCMD,this),gh.on(vh,this.handleJoinReceivedCMDResponce,this),gh.on(Eh,this.handleJoinSuccess,this),gh.on(Ah,this.handleJoinFailed,this),gh.on(bh,this.handleReceivedPublishUserList,this),gh.on(ep,this.handleConnectionStateChanged,this),gh.on(yh,this.handleLeaveStart,this),gh.on(Ch,this.handleLeaveSuccess,this),gh.on(Sh,this.handleLeaveSendCMD,this),gh.on(tp,this.handleSendSubscribeCMD,this),gh.on(Ph,this.handleVideoPlaying,this),gh.on(Dh,this.handleAudioPlaying,this),gh.on(rp,this.handleNetworkQuality,this),gh.on(Th,this.handleHeartbeatStats,this),gh.on(xh,this.handleRemoteStreamAdded,this),gh.on(Bh,this.handleRemoteStreamSubscribeStart,this),gh.on(Uh,this.handleRemoteStreamSubscribed,this),gh.on(Yh,this.handleVideoLoadedData,this),gh.on(Zh,this.handlePlayStream,this),gh.on(Ih,this.handlePublishStart,this),gh.on(Hh,this.handleLocalStreamInitStart,this),gh.on(Qh,this.handleLocalStreamInitEnd,this),gh.on(Wh,this.handleLocalStreamInitFailed,this)}},{key:"uninstallEvents",value:function(){gh.off(mh,this.handleJoinStart,this),gh.off(Rh,this.handleWSStart,this),gh.off(wh,this.handleWSEnd,this),gh.off(_h,this.handleJoinSendCMD,this),gh.off(vh,this.handleJoinReceivedCMDResponce,this),gh.off(bh,this.handleReceivedPublishUserList,this),gh.off(ep,this.handleConnectionStateChanged,this),gh.off(yh,this.handleLeaveStart,this),gh.off(Ch,this.handleLeaveSuccess,this),gh.off(Eh,this.handleJoinSuccess,this),gh.off(Ah,this.handleJoinFailed,this),gh.off(Sh,this.handleLeaveSendCMD,this),gh.off(tp,this.handleSendSubscribeCMD,this),gh.off(Ph,this.handleVideoPlaying,this),gh.off(Dh,this.handleAudioPlaying,this),gh.off(rp,this.handleNetworkQuality,this),gh.off(Th,this.handleHeartbeatStats,this),gh.off(xh,this.handleRemoteStreamAdded,this),gh.off(Bh,this.handleRemoteStreamSubscribeStart,this),gh.off(Uh,this.handleRemoteStreamSubscribed,this),gh.off(Yh,this.handleVideoLoadedData,this),gh.off(Zh,this.handlePlayStream,this),gh.off(Ih,this.handlePublishStart,this),gh.off(Hh,this.handleLocalStreamInitStart,this),gh.off(Qh,this.handleLocalStreamInitEnd,this),gh.off(Wh,this.handleLocalStreamInitFailed,this)}},{key:"handleJoinStart",value:function(e){this.hitTest(e.client)&&0===this.pathJoinRoom_.uint64_start_time&&(this.pathJoinRoom_.uint64_start_time=Date.now(),this.checkStorage())}},{key:"handleWSStart",value:function(e){var t=e.client;this.hitTest(t)&&0===this.pathJoinRoom_.uint64_send_request_acc_ip_cmd_start_time&&(this.pathJoinRoom_.uint64_send_request_acc_ip_cmd_start_time=Date.now())}},{key:"handleWSEnd",value:function(e){var t=e.client,r=e.error;this.hitTest(t)&&0===this.pathJoinRoom_.uint64_send_request_acc_ip_cmd_end_time&&(this.pathJoinRoom_.uint64_send_request_acc_ip_cmd_end_time=Date.now(),r&&(this.pathJoinRoom_.int32_send_request_acc_ip_cmd_ret=r instanceof Vd?Number(r.getExtraCode()||r.getCode()):Fd.UNKNOWN,this.pathJoinRoom_.int32_end_ret=2))}},{key:"handleJoinSendCMD",value:function(e){this.hitTest(e.client)&&0===this.pathJoinRoom_.uint64_send_request_enter_room_cmd_start_time&&(this.pathJoinRoom_.uint64_send_request_enter_room_cmd_start_time=Date.now())}},{key:"handleJoinReceivedCMDResponce",value:function(e){this.hitTest(e.client)&&0===this.pathJoinRoom_.uint64_send_request_enter_room_cmd_end_time&&(this.pathJoinRoom_.uint64_send_request_enter_room_cmd_end_time=Date.now(),this.pathJoinRoom_.int32_send_request_enter_room_cmd_ret=e.code,0!==e.code&&(this.pathJoinRoom_.int32_end_ret=3))}},{key:"handleJoinSuccess",value:function(e){this.hitTest(e.client)&&0===this.pathJoinRoom_.uint64_end_time&&(this.pathJoinRoom_.uint64_end_time=Date.now(),this.pathJoinRoom_.int32_end_ret=0)}},{key:"handleJoinFailed",value:function(e){var t=e.client;this.hitTest(t)&&(this.pathJoinRoom_.uint64_end_time=Date.now(),0===this.pathJoinRoom_.int32_end_ret&&(this.pathJoinRoom_.int32_end_ret=3),this.prepareReport(),this.report())}},{key:"handleReceivedPublishUserList",value:function(e){this.hitTest(e.client)&&0===this.pathJoinRoom_.uint64_recv_userlist_time&&(this.pathJoinRoom_.uint64_recv_userlist_time=Date.now(),this.firstPublishedUserList_=e.data.content.userlist)}},{key:"handleConnectionStateChanged",value:function(e){var t=e.client,r=e.state,i=e.connection;if(this.hitTest(t)&&r===cl){this.client_.getUplinkConnection()===i&&0===this.pathJoinRoom_.uint64_send_first_video_frame_time&&this.localStreamStats_.publishStartTime>this.pathJoinRoom_.uint64_end_time&&this.localStreamStats_.publishStartTime-this.pathJoinRoom_.uint64_end_time<=100&&(this.pathJoinRoom_.uint64_send_first_video_frame_time=Date.now());var n=this.pathMainVideoMap_.get("".concat(i.getUserId(),"_").concat("main"));n&&0===n.statsToReport.uint64_pc_connected_time&&(n.statsToReport.uint64_pc_connected_time=Date.now())}}},{key:"handleLeaveStart",value:function(e){this.hitTest(e.client)&&(this.pathLeaveRoom_.uint64_start_time=Date.now())}},{key:"handleLeaveSuccess",value:function(e){this.hitTest(e.client)&&0===this.pathLeaveRoom_.uint64_end_time&&(this.pathLeaveRoom_.uint64_end_time=Date.now(),0!==this.pathJoinRoom_.uint64_end_time?this.basicInfo.uint32_joining_duration=this.pathLeaveRoom_.uint64_end_time-this.pathJoinRoom_.uint64_end_time:this.log_.warn("pathJoinRoom endTime is 0"),this.report())}},{key:"handleLeaveSendCMD",value:function(e){this.hitTest(e.client)&&(this.pathLeaveRoom_.uint64_send_request_exit_room_cmd_start_time=Date.now(),this.pathLeaveRoom_.uint64_send_request_exit_room_cmd_end_time=Date.now())}},{key:"handleRemoteStreamAdded",value:function(e){var t=e.client,i=e.stream;if(this.hitTest(t)){var n=i.getUserId(),o=i.getType(),s="".concat(n,"_").concat(o),a=this.remoteStreamStatsMap_.get(s);if(a)a.stream=i;else{var c={userId:n,totalVideoFPS:0,totalVideoBitrate:0,totalAudioLevel:0,totalAudioBitrate:0,totalLoss:0,audioCount:0,audioLevelCount:0,videoCount:0,networkQualityCount:0,streamAddedTime:Date.now(),subscribeStartTime:0,subscribedTime:0,playStreamTime:0,statsToReport:r({},oy),stream:i};c.statsToReport.msg_user_info=new sy({userId:n,tinyId:i.getTinyId(),role:el}),c.statsToReport.uint32_stream_type="main"===o?2:7,this.remoteStreamStatsMap_.set(s,c)}}}},{key:"handleRemoteStreamSubscribeStart",value:function(e){var t=e.client,r=e.stream;if(this.hitTest(t)){var i=r.getUserId(),n=r.getType(),o="".concat(i,"_").concat(n),s=this.remoteStreamStatsMap_.get(o);s&&0===s.subscribeStartTime&&(s.subscribeStartTime=Date.now())}}},{key:"handleSendSubscribeCMD",value:function(e){if(this.hitTest(e.client)){var t=new sy(e),r=Date.now(),i="".concat(e.userId,"_").concat("main");e.trackState.video&&e.subscribeState.video&&!this.pathMainVideoMap_.has(i)&&this.pathMainVideoMap_.set(i,{statsToReport:{msg_user_info:t,uint64_start_enter_time:this.pathJoinRoom_.uint64_start_time,uint64_render_first_frame_time:0,uint64_combine_first_frame_time:0,uint64_pc_connected_time:0},userId:e.userId,sendSubscribeCMDTime:r}),e.trackState.audio&&e.subscribeState.audio&&!this.pathMainAudioMap_.has(i)&&this.pathMainAudioMap_.set(i,{statsToReport:{msg_user_info:t,uint64_start_enter_time:this.pathJoinRoom_.uint64_start_time,uint64_play_first_frame_time:0},userId:e.userId,sendSubscribeCMDTime:r});var n="".concat(e.userId,"_").concat("auxiliary");e.trackState.auxiliary&&e.subscribeState.auxiliary&&!this.pathAuxiliaryMap_.has(n)&&this.pathAuxiliaryMap_.set(n,{sendSubscribeCMDTime:r})}}},{key:"handleRemoteStreamSubscribed",value:function(e){var t=e.client,r=e.stream;if(this.hitTest(t)){var i=r.getUserId(),n=r.getType(),o="".concat(i,"_").concat(n),s=this.remoteStreamStatsMap_.get(o);s&&0===s.subscribedTime&&(s.subscribedTime=Date.now(),s.stream=r)}}},{key:"handlePlayStream",value:function(e){var t=e.stream;if(t.isRemote()&&t.getConnection()&&this.hitTest(t.getConnection().getClient())){var r=t.getConnection().getUserId(),i="".concat(r,"_").concat(t.getType());if(this.remoteStreamStatsMap_.has(i)){var n=this.remoteStreamStatsMap_.get(i);0===n.playStreamTime&&(n.playStreamTime=Date.now())}}}},{key:"handleVideoLoadedData",value:function(e){var t=e.stream;if(t.isRemote()&&t.getConnection()&&this.hitTest(t.getConnection().getClient())){var r=t.getConnection().getUserId(),i="".concat(r,"_").concat(t.getType());if(this.pathMainVideoMap_.has(i)){var n=this.pathMainVideoMap_.get(i);0===n.statsToReport.uint64_combine_first_frame_time&&(n.statsToReport.uint64_combine_first_frame_time=Date.now())}}}},{key:"handleVideoPlaying",value:function(e){var t=e.stream;if(t.isRemote()&&t.getConnection()&&this.hitTest(t.getConnection().getClient())){var r=t.getConnection().getUserId(),i="".concat(r,"_").concat(t.getType()),n=Date.now();if(this.pathMainVideoMap_.has(i)){var o=this.pathMainVideoMap_.get(i);if(0===o.statsToReport.uint64_render_first_frame_time&&(o.statsToReport.uint64_render_first_frame_time=n),this.remoteStreamStatsMap_.has(i)){var s=this.remoteStreamStatsMap_.get(i),a=s.statsToReport,c=s.playStreamTime,l=s.subscribedTime;0===a.uint32_video_render_first&&c-l<=100&&(a.uint32_video_render_first=n-o.sendSubscribeCMDTime)}}if("auxiliary"===t.getType()&&this.pathAuxiliaryMap_.has(i)&&this.remoteStreamStatsMap_.has(i)){var u=this.remoteStreamStatsMap_.get(i),d=u.statsToReport,h=u.playStreamTime,p=u.subscribedTime;0===d.uint32_video_render_first&&h-p<=100&&(d.uint32_video_render_first=n-this.pathAuxiliaryMap_.get(i).sendSubscribeCMDTime)}}}},{key:"handleAudioPlaying",value:function(e){if(e.stream.isRemote()&&e.stream.getConnection()&&this.hitTest(e.stream.getConnection().getClient())){var t=e.stream.getConnection().getUserId(),r="".concat(t,"_").concat(e.stream.getType());if(this.pathMainAudioMap_.has(r)){var i=this.pathMainAudioMap_.get(r);0===i.statsToReport.uint64_play_first_frame_time&&(i.statsToReport.uint64_play_first_frame_time=Date.now())}}}},{key:"handleNetworkQuality",value:function(e){var t=this;this.hitTest(e.client)&&(this.networkQuality_.totalUplinkLoss+=e.uplinkLoss,this.networkQuality_.totalUplinkRTT+=e.uplinkRTT,this.networkQuality_.count++,e.downlinkLossAndRTTMap.forEach((function(e){var r=e.rtt,i=e.loss,n=e.userId,o=t.networkQuality_.totalDownlinkRTTAndLossMap.get(n);o?(o.totalRTT+=r,o.totalLoss+=i,o.count++):t.networkQuality_.totalDownlinkRTTAndLossMap.set(n,{totalRTT:r,totalLoss:i,count:1})})))}},{key:"handleHeartbeatStats",value:function(e){var t=this;if(this.hitTest(e.client)){var r=e.stats,i=r.VideoReportState,n=r.AudioReportState;i.VideoEncState[0]&&(this.localStreamStats_.totalVideoBitrate+=i.uint32_video_snd_br,this.localStreamStats_.totalVideoFPS+=i.VideoEncState[0].uint32_enc_fps,this.localStreamStats_.totalVideoWidth+=i.VideoEncState[0].uint32_enc_width,this.localStreamStats_.totalVideoHeight+=i.VideoEncState[0].uint32_enc_height,this.localStreamStats_.videoCount++),i.VideoDecState.forEach((function(e){var r=0===e.uint32_video_strtype,i=2===e.uint32_video_strtype,n="".concat(e.userId,"_").concat(r?"main":"auxiliary");if(t.remoteStreamStatsMap_.has(n)){var o=t.remoteStreamStatsMap_.get(n);(r&&o.stream.isMainVideoSubscribed||i&&o.stream.isAuxVideoSubscribed)&&(o.totalVideoFPS+=e.uint32_video_recv_fps,o.totalVideoBitrate+=e.uint32_video_recv_br,o.videoCount++,0===o.statsToReport.uint32_video_width&&(o.statsToReport.uint32_video_width=e.uint32_dec_width),0===o.statsToReport.uint32_video_height&&(o.statsToReport.uint32_video_height=e.uint32_dec_height))}})),n&&(n.AudioDecState.forEach((function(e){var r="".concat(e.userId,"_").concat("main");if(t.remoteStreamStatsMap_.has(r)){var i=t.remoteStreamStatsMap_.get(r);i.stream.isMainAudioSubscribed&&(i.totalAudioBitrate+=e.uint32_audio_real_recv_br,i.audioCount++,Math.floor(100*e.audioLevel)>0&&(i.totalAudioLevel+=e.audioLevel,i.audioLevelCount++))}})),Math.floor(100*n.sentAudioLevel)>0&&(this.localStreamStats_.totalAudioLevel+=n.sentAudioLevel,this.localStreamStats_.audioLevelCount++))}}},{key:"handlePublishStart",value:function(e){var t=e.client;this.hitTest(t)&&0===this.localStreamStats_.publishStartTime&&(this.localStreamStats_.publishStartTime=Date.now())}},{key:"handleLocalStreamInitStart",value:function(e){var t=e.audio,r=e.video;t&&0===this.pathJoinRoom_.uint64_init_audio_start_time&&(this.pathJoinRoom_.uint64_init_audio_start_time=Date.now()),r&&0===this.pathJoinRoom_.uint64_init_camera_start_time&&(this.pathJoinRoom_.uint64_init_camera_start_time=Date.now())}},{key:"handleLocalStreamInitEnd",value:function(e){var t=e.audio,r=e.video;t&&0===this.pathJoinRoom_.uint64_init_audio_end_time&&(this.pathJoinRoom_.uint64_init_audio_end_time=Date.now()),r&&0===this.pathJoinRoom_.uint64_init_camera_end_time&&(this.pathJoinRoom_.uint64_init_camera_end_time=Date.now())}},{key:"handleLocalStreamInitFailed",value:function(e){var t=e.audio,r=e.video,i=e.error,n=i instanceof Vd?i.getExtraCode()||i.getCode():{NotFoundError:1,NotAllowedError:2,NotReadableError:3,OverConstrainedError:4,AbortError:5}[i.name]||Fd.UNKNOWN;t&&0===this.pathJoinRoom_.uint64_init_audio_end_time&&(this.pathJoinRoom_.int32_init_audio_ret=n,this.pathJoinRoom_.uint64_init_audio_end_time=Date.now()),r&&0===this.pathJoinRoom_.uint64_init_camera_end_time&&(this.pathJoinRoom_.int32_init_camera_ret=n,this.pathJoinRoom_.uint64_init_camera_end_time=Date.now())}},{key:"hasVideoFlag",value:function(e){return this.firstPublishedUserList_.findIndex((function(t){return t.userid===e&&1&t.flag}))>=0}},{key:"hasAudioFlag",value:function(e){return this.firstPublishedUserList_.findIndex((function(t){return t.userid===e&&8&t.flag}))>=0}},{key:"hasAuxFlag",value:function(e){return this.firstPublishedUserList_.findIndex((function(t){return t.userid===e&&4&t.flag}))>=0}},{key:"hitTest",value:function(e){return e===this.client_}},{key:"checkStorage",value:(n=o(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(t=kv.getItem(this.storageKey_))){e.next=6;break}return e.next=5,this.upload(t);case 5:kv.deleteItem(this.storageKey_);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.log_.warn(e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return n.apply(this,arguments)})},{key:"setStorage",value:function(){this.prepareReport();var e=this.getReportData();0!==e.msg_path_enter_room.uint64_start_time&&kv.setItem(this.storageKey_,e)}},{key:"prepareReport",value:function(){var e=this;if(this.networkQuality_.count>0&&(this.basicInfo.uint32_avg_rtt=Math.floor(this.networkQuality_.totalUplinkRTT/this.networkQuality_.count),this.basicInfo.uint32_avg_up_loss=Math.floor(this.networkQuality_.totalUplinkLoss/this.networkQuality_.count)),this.localStreamStats_.videoCount>0){this.localStreamStats_.statsToReport.uint32_video_big_capture_fps=Math.floor(this.localStreamStats_.totalVideoFPS/this.localStreamStats_.videoCount),this.localStreamStats_.statsToReport.uint32_video_big_bitrate=Math.floor(this.localStreamStats_.totalVideoBitrate/this.localStreamStats_.videoCount);var t=Math.floor(this.localStreamStats_.totalVideoWidth/this.localStreamStats_.videoCount),r=Math.floor(this.localStreamStats_.totalVideoHeight/this.localStreamStats_.videoCount);this.localStreamStats_.statsToReport.uint32_video_big_resolution=t<<16|r}this.localStreamStats_.audioLevelCount>0&&(this.localStreamStats_.statsToReport.uint32_audio_capture_db=Math.floor(this.localStreamStats_.totalAudioLevel/this.localStreamStats_.audioLevelCount*100)),this.remoteStreamStatsMap_.forEach((function(t,r){var i=t.userId;if(e.networkQuality_.totalDownlinkRTTAndLossMap.has(i)){var n=e.networkQuality_.totalDownlinkRTTAndLossMap.get(i),o=n.totalLoss,s=n.count;t.statsToReport.uint32_avg_down_loss=Math.floor(o/s)}t.videoCount>0&&(t.statsToReport.uint32_video_avg_fps=Math.floor(t.totalVideoFPS/t.videoCount),t.statsToReport.uint32_video_avg_bitrate=Math.floor(t.totalVideoBitrate/t.videoCount)),t.audioCount>0&&(t.statsToReport.uint32_audio_recv_bitrate=t.statsToReport.uint32_audio_bitrate=Math.floor(t.totalAudioBitrate/t.audioCount)),t.audioLevelCount>0&&(t.statsToReport.uint32_audio_play_db=Math.floor(t.totalAudioLevel/t.audioLevelCount*100));var a=e.client_.getCallDurationCalculator();a&&(t.statsToReport.uint32_audio_play_time=a.getDuration(r,Jl),t.statsToReport.uint32_video_play_time=a.getDuration(r,Xl)),t.statsToReport.uint32_video_render_first=Math.min(t.statsToReport.uint32_video_render_first,5e3);var c=e.client_.getBadCaseDetector();if(c){var l=c.getDataFreezeDuration(r),u=l.dataFreeze,d=l.count,h=c.getRenderFreezeDuration(r).renderFreeze;t.statsToReport.uint32_video_block_count=d,t.statsToReport.uint32_video_block_time=Math.min(u,t.statsToReport.uint32_video_play_time),t.statsToReport.uint32_video_external_block_time=Math.min(h,t.statsToReport.uint32_video_play_time),c.isBlackStream(r)&&0===t.statsToReport.uint32_video_avg_fps?t.statsToReport.uint32_video_black_screen_subjective=1:t.statsToReport.uint32_video_black_screen_subjective=0}(0===t.subscribeStartTime||t.subscribeStartTime-t.streamAddedTime>100||0===t.playStreamTime)&&(e.pathMainAudioMap_.delete(r),e.pathMainVideoMap_.delete(r),t.statsToReport.uint32_video_render_first=0)})),this.pathMainAudioMap_.forEach((function(t,r){e.hasAudioFlag(t.userId)?t.statsToReport.uint64_play_first_frame_time-t.statsToReport.uint64_start_enter_time>5e3&&(t.statsToReport.uint64_play_first_frame_time=t.statsToReport.uint64_start_enter_time+5e3):e.pathMainAudioMap_.delete(r)})),this.pathMainVideoMap_.forEach((function(t,r){e.hasVideoFlag(t.userId)?t.statsToReport.uint64_render_first_frame_time-t.statsToReport.uint64_start_enter_time>5e3&&(t.statsToReport.uint64_render_first_frame_time=t.statsToReport.uint64_start_enter_time+5e3):e.pathMainVideoMap_.delete(r)})),this.pathJoinRoom_.uint64_end_time-this.pathJoinRoom_.uint64_start_time>5e3&&(this.pathJoinRoom_.uint64_end_time=this.pathJoinRoom_.uint64_start_time+5e3)}},{key:"getReportData",value:function(){var e=this.client_.getSignalInfo();return{uint32_sdk_app_id:Number(this.client_.getSDKAppId()),msg_user_info:new sy({userId:this.client_.getUserId(),tinyId:this.client_.getTinyId(),role:"anchor"===this.client_.getRole()?el:tl}),msg_basic_info:this.basicInfo,uint32_acc_ip:ih(e.relayIp),uint32_client_ip:ih(e.localIp,"small"),uint32_acc_port:0,uint64_timestamp:Date.now(),uint32_seq:Math.floor(Math.random()*Math.pow(2,31)),msg_path_enter_room:this.pathJoinRoom_,msg_path_exit_room:this.pathLeaveRoom_,msg_path_recv_video:A(this.pathMainVideoMap_.values()).map((function(e){return e.statsToReport})),msg_quality_statistics:A(this.remoteStreamStatsMap_.values()).map((function(e){return e.statsToReport})),str_room_name:String(this.client_.getRoomId()),msg_path_recv_audio:A(this.pathMainAudioMap_.values()).map((function(e){return e.statsToReport})),uint32_info_client_ip:ih(e.localIp,"small"),error_code:[],msg_local_statistics:this.localStreamStats_.statsToReport}}},{key:"report",value:(i=o(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.getReportData(),e.next=4,this.upload(t);case 4:kv.deleteItem(this.storageKey_),this.initData(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.log_.warn(e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return i.apply(this,arguments)})},{key:"upload",value:(t=o(regeneratorRuntime.mark((function e(t){var r,i,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Uc&&0!==t.msg_path_enter_room.uint64_start_time){e.next=2;break}return e.abrupt("return");case 2:return r=Math.floor(Math.random()*Math.pow(2,31)),i=Number(this.client_.getSDKAppId()),n="".concat("https://yun.tim.qq.com","/v5/AVQualityReportSvc/C2S?random=").concat(r,"&sdkappid=").concat(i,"&cmdtype=jssdk_new_endreport"),e.next=7,Ud.post(n,JSON.stringify(t));case 7:if("ok"===(o=e.sent).data){e.next=10;break}throw"key point upload failed: ".concat(o.data);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();function cy(){return function(e,t,r){var i=r.value,n=new Map;return r.value=o(regeneratorRuntime.mark((function e(){var r,o,s,a,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.get(this)){e.next=2;break}throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:vm,data:{name:t}})});case 2:for(e.prev=2,n.set(this,!0),r=c.length,o=new Array(r),s=0;s<r;s++)o[s]=c[s];return e.next=7,i.apply(this,o);case 7:return a=e.sent,n.set(this,!1),e.abrupt("return",a);case 12:throw e.prev=12,e.t0=e.catch(2),n.set(this,!1),e.t0;case 16:case"end":return e.stop()}}),e,this,[[2,12]])}))),r}}var ly=(QA=cy(),WA=_A(gA.CLIENT.join),qA=cy(),zA=cy(),ZA=_A(gA.CLIENT.publish),YA=cy(),KA=_A(gA.CLIENT.unpublish),$A=_A.apply(void 0,A(gA.CLIENT.subscribe)),JA=_A(gA.CLIENT.unsubscribe),XA=cy(),ey=_A(gA.CLIENT.switchRole),ty=_A(gA.CLIENT.startPublishCDNStream),ry=_A(gA.CLIENT.startMixTranscode),T((iy=function(){function e(t){var r,i=this;if(s(this,e),this.name_=Su,this.mode_=t.mode,this.sdpSemantics_="plan-b",Yd(t.sdpSemantics)?function(){if(!Qv())return!1;if(Yd(window.RTCRtpTransceiver))return!1;if(!("currentDirection"in RTCRtpTransceiver.prototype))return!1;var e=new RTCPeerConnection,t=!1;try{e.addTransceiver(Jl),t=!0}catch(ky){}return e.close(),t}()&&(this.sdpSemantics_="unified-plan"):this.sdpSemantics_=t.sdpSemantics,this.sdkAppId_=t.sdkAppId,this.userId_=t.userId,this.log_=Tf.createLogger({id:"c".concat(t.seq,"|").concat(this.userId_),userId:this.userId_,sdkAppId:this.sdkAppId_}),this.userSig_=t.userSig,this.roomId_=0,this.useStringRoomId_=t.useStringRoomId||!1,this.recordId_=null,this.pureAudioPushMode_=null,this.version_=t.version,this.log_.info("using sdpSemantics: "+this.sdpSemantics_),!Yd(t.recordId)){if(!Number.isInteger(Number(t.recordId)))throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:Mm})});this.recordId_=t.recordId}this.signalChannel_=null,this.isScreenShareOnly_=0,Yd(t.isScreenShareOnly)||(this.isScreenShareOnly_=t.isScreenShareOnly?1:0),this.role_="anchor",this.privateMapKey_="",this.tinyId_=0,this.env_="",this.proxy_=null,this.connections_=new Map,this.mutedStates_=new Map,this.userMap_=new Map,this.syncUserListInterval_=-1,this.localStream_=null,this.uplinkConnection_=null,this.emitter_=new fh,this.signalInfo_={},this.isSignalReady_=!1,this.isJoined_=!1,this.heartbeat_=-1,this.lastHeartBeatTime_=-1,this.stats_=new RE(this),this.joinTimeout_=-1,this.networkQuality_=null,this.badCaseDetector_=null,this.autoSubscribe_=!!Yd(t.autoSubscribe)||t.autoSubscribe,this.startJoinTimestamp_=0,this.joinedTimestamp_=0,this.joinOptions_={},this.basis_={browser:jc().name+"/"+jc().version,os:Kv(),displayResolution:$v(),isScreenShareSupported:Vv(),isWebRTCSupported:Lv(),isGetUserMediaSupported:Jv(),isWebAudioSupported:Xv(),isWebSocketsSupported:"WebSocket"in window&&2===window.WebSocket.CLOSING,isWebCodecSupported:(r={AudioDecoder:!1,AudioEncoder:!1,VideoDecoder:!1,VideoEncoder:!1,ImageDecoder:!1},Yd(window.AudioDecoder)||(r.AudioDecoder=!0),Yd(window.AudioEncoder)||(r.AudioEncoder=!0),Yd(window.VideoDecoder)||(r.VideoDecoder=!0),Yd(window.VideoEncoder)||(r.VideoEncoder=!0),Yd(window.ImageDecoder)||(r.ImageDecoder=!0),r),isMediaSessionSupported:"mediaSession"in navigator&&!Yd(navigator.mediaSession.setActionHandler),isWebTransportSupported:!Yd(window.WebTransport)},this.initBussinessInfo_(t),this.publishedCDN_=!1,this.publishCDNData_=null,this.mixedMCU_=!1,this.mixTranscodeData_=null,this.checkSystemResult_=null,this.enableAudioVolumeEvaluation_=!1,this.audioVolumeIntervalId_=null,this.mixTranscodeManager_=null,this.publishCDNManager_=null,this.keyPointManager_=new ay({client:this,frameWorkType:t.frameWorkType}),this.getUserList=yf({retryFunction:this.getUserList,settings:{retries:3},onError:function(e,t){return t()},onRetrying:function(e){i.log_.info("retrying to get user list [".concat(e,"/3]"))}}),this.isPublishing_=!1,this.isEnableSmallStream_=!1,this.smallStreamConfig_={bitrate:100,frameRate:15,height:120,width:160},this.turnServers_=[],this.iceTransportPolicy_=t.iceTransportPolicy,this.schedule_={domains:null,iceServers:null,iceTransportPolicy:null},this.enableAutoPlayDialog_=!!Yd(t.enableAutoPlayDialog)||t.enableAutoPlayDialog}var t,i,n,a,l,u,d,h,p,f,g,m,_,v,y,S,T,b,I,R,w,k,O,N;return c(e,[{key:"initBussinessInfo_",value:function(e){this.bussinessInfo_=e.bussinessInfo;var t={};if(Kd(e.bussinessInfo)&&(t=JSON.parse(e.bussinessInfo)),!Yd(e.pureAudioPushMode)){if(!Number.isInteger(Number(e.pureAudioPushMode)))throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:xm})});this.pureAudioPushMode_=e.pureAudioPushMode,t.Str_uc_params||(t.Str_uc_params={}),t.Str_uc_params.pure_audio_push_mod=this.pureAudioPushMode_}if(!Yd(e.streamId)){if(!(Kd(e.streamId)&&String(e.streamId)&&String(e.streamId).length<=64))throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:Bm})});t.Str_uc_params||(t.Str_uc_params={}),t.Str_uc_params.userdefine_streamid_main=e.streamId}if(!Yd(e.userDefineRecordId)){if(null===e.userDefineRecordId.match(/^[A-Za-z0-9_-]{1,64}$/gi))throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:Um})});t.Str_uc_params||(t.Str_uc_params={}),t.Str_uc_params.userdefine_record_id=e.userDefineRecordId}if(!Yd(e.userDefinePushArgs)){if(!(Kd(e.userDefinePushArgs)&&String(e.userDefinePushArgs)&&String(e.userDefinePushArgs).length<=256))throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:Fm})});t.Str_uc_params||(t.Str_uc_params={}),t.Str_uc_params.userdefine_push_args=e.userDefinePushArgs}fm(t)||(this.bussinessInfo_=JSON.stringify(t))}},{key:"setProxyServer",value:function(e){if(this.log_.info("set proxy server: ".concat(JSON.stringify(e))),Kd(e)){if(!e.startsWith("wss://"))throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:Vm})});this.proxy_=e}else if(qd(e)){var t=e.websocketProxy,r=e.loggerProxy;t&&(this.proxy_=t),r&&$c(r)}}},{key:"schedule",value:(N=o(regeneratorRuntime.mark((function e(t){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,nh({userId:this.userId_,sdkAppId:this.sdkAppId_,roomId:t,useStringRoomId:this.useStringRoomId_,version:this.version_,userSig:this.userSig_});case 2:(i=e.sent)&&(this.log_.info("schedule: ".concat(JSON.stringify(i))),this.schedule_=r(r({},this.schedule_),i),gh.emit(Oh,this.schedule_));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return N.apply(this,arguments)})},{key:"getSignalChannelUrl",value:function(){var e={mainUrl:Hc,backupUrl:Qc},t=Gd();return t?e.mainUrl=e.backupUrl="wss://".concat(t,".rtc.qq.com"):this.proxy_?e.mainUrl=e.backupUrl=this.proxy_:Array.isArray(this.schedule_.domains)&&this.schedule_.domains.length>0&&(e.mainUrl=e.backupUrl="wss://".concat(this.schedule_.domains[0]),this.schedule_.domains[1]&&(e.backupUrl="wss://".concat(this.schedule_.domains[1]))),e}},{key:"getUserId",value:function(){return this.userId_}},{key:"getUserSig",value:function(){return this.userSig_}},{key:"getRole",value:function(){return this.role_}},{key:"getSignalInfo",value:function(){return this.signalInfo_}},{key:"getRoomId",value:function(){return this.roomId_}},{key:"getSDKAppId",value:function(){return this.sdkAppId_}},{key:"getTinyId",value:function(){return this.tinyId_}},{key:"setTurnServer",value:function(e){this.log_.info("set turn server: "+JSON.stringify(e));var t=[];Array.isArray(e)?e.forEach((function(e){return t.push(th(e))})):qd(e)&&t.push(th(e)),this.turnServers_=t}},{key:"getIceTransportPolicy",value:function(){return this.iceTransportPolicy_||this.schedule_.iceTransportPolicy||"all"}},{key:"initialize",value:function(){var e=this;return new Promise((function(t,r){e.log_.info("setup signal channel");var i=e.getSignalChannelUrl(),n=i.mainUrl,o=i.backupUrl;e.signalChannel_=new dv({sdkAppId:e.sdkAppId_,userId:e.userId_,userSig:e.userSig_,url:n,backupUrl:o,version:e.version_,client:e}),e.networkQuality_||(e.networkQuality_=new wE({connections:e.connections_,signalChannel:e.signalChannel_,userId:e.userId_,client:e}),e.networkQuality_.on(EE,(function(t){e.emitter_.emit(EE,t)}))),e.deviceDetector_||(e.deviceDetector_=new kE({client:e})),e.subscriptionManager_||(e.subscriptionManager_=new SA({client:e})),e.badCaseDetector_||(e.badCaseDetector_=new xA({client:e,stats:e.stats_})),e.callDurationCalculator_||(e.callDurationCalculator_=new jA({client:e})),e.mixTranscodeManager_||(e.mixTranscodeManager_=new FA({client:e,signalChannel:e.signalChannel_})),e.publishCDNManager_||(e.publishCDNManager_=new VA({client:e,signalChannel:e.signalChannel_})),e.signalChannel_.on(Xf,(function(t){switch(e.log_.info("SignalChannel state changed from ".concat(t.prevState," to ").concat(t.state)),t.state){case og:t.prevState===ng?(e.log_.warn("signal channel reconnect successfully"),e.syncUserList(),jd.logSuccessEvent({userId:e.userId_,eventType:Ml})):t.prevState===ig&&jd.logSuccessEvent({userId:e.userId_,eventType:Dl})}e.emitter_.emit(dE,t)})),e.signalChannel_.on(tg,(function(t){e.isSignalReady_?(e.closeUplink(),e.closeConnections(),e.emitter_.emit(yE,t)):(gh.emit(wh,{client:e,error:t}),r(t))})),e.signalChannel_.on(cg.CHANNEL_SETUP_SUCCESS,(function(r){e.signalInfo_=r.signalInfo,e.tinyId_=e.signalInfo_.tinyId,e.isSignalReady_||(e.isSignalReady_=!0,gh.emit(wh,{client:e}),t())})),e.signalChannel_.on(cg.PEER_JOIN,e.onPeerJoin,e),e.signalChannel_.on(cg.PEER_LEAVE,e.onPeerLeave,e),e.signalChannel_.on(cg.STREAM_ADDED,(function(t){e.onRemoteStreamAdded(t.data)})),e.signalChannel_.on(cg.STREAM_REMOVED,(function(t){e.onRemoteStreamRemoved(t.data)})),e.signalChannel_.on(cg.UPDATE_REMOTE_MUTE_STAT,(function(t){gh.emit(bh,{client:e,data:t.data}),e.onPublishedUserList(t.data),e.onUpdateRemoteMuteStat(t.data)})),e.signalChannel_.on(cg.CLINET_BANNED,(function(t){var r=t.data.content,i=r.type;"banned"===r.type?i="you got banned by account admin":"kick"===r.type?i="duplicated userId joining the room":"user_time_out"===r.type&&e.log_.warn("last heart beat time: ".concat(e.lastHeartBeatTime_," interval: ").concat(Date.now()-e.lastHeartBeatTime_)),jd.uploadEvent({log:"stat-banned:".concat(r.type),userId:e.userId_}),e.log_.error("user was banned because of [".concat(r.type,"]")),e.reset(),e.onClientBanned(i)})),e.signalChannel_.on(cg.REQUEST_REBUILD_SESSION,(function(t){e.signalInfo_=t.signalInfo;var r=[];e.connections_&&r.push(0);var i,n=[],o=C(e.connections_);try{for(o.s();!(i=o.n()).done;){var s=E(i.value,2),a=s[0],c=s[1];r.push(a);var l=c.getPeerConnection();if(l){var u=l.remoteDescription;u&&n.push(u.sdp)}}}catch(p){o.e(p)}finally{o.f()}var d={socketid:e.signalInfo_.socketId,tinyid:e.tinyId_,appid:e.sdkAppId_,openid:e.userId_,sessionid:String(e.roomId_),sids:r,relayInfo:e.signalInfo_.relayInnerIp,remotesdp:n,useStrRoomid:!!e.useStringRoomId_&&1};e.log_.debug("reconnect - rebuild session with data: ".concat(JSON.stringify(d))),e.signalChannel_.send(pg,d)})),e.signalChannel_.on(cg.CLIENT_REJOIN,(function(){e.reJoin()})),gh.emit(Rh,{client:e}),e.signalChannel_.connect()}))}},{key:"join",value:(O=o(regeneratorRuntime.mark((function e(t){var r,i,n,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isJoined_){e.next=2;break}throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:jm})});case 2:return e.next=4,Uv();case 4:if(this.checkSystemResult_=e.sent,(r=Gd())||(r=zc,this.proxy_&&(this.proxy_.startsWith(Wc)?r=Zc:this.proxy_.startsWith(qc)&&(r=Yc))),this.env_=r,jd.setConfig({env:r,sdkAppId:this.sdkAppId_,userId:this.userId_}),this.uploadTrtcStats(),i=this.checkSystemResult_.detail,n=i.isH264EncodeSupported,o=i.isVp8EncodeSupported,Lv()&&(n||o)){e.next=13;break}throw new Vd({code:Fd.NOT_SUPPORTED,message:uv({key:X_})});case 13:if(this.joinOptions_=t,this.startJoinTimestamp_=rh(),gh.emit(mh,{client:this}),hm(this.userId_,{eventId:Kg,eventDesc:"joining room",timestamp:Es(),userId:this.userId_,tinyId:this.tinyId_}),e.prev=17,this.proxy_||this.schedule_.domains){e.next=21;break}return e.next=21,this.schedule(t.roomId);case 21:return e.next=23,this.initialize(t);case 23:return e.next=25,this.doJoin(t);case 25:gh.emit(Eh,{client:this}),this.joinedTimestamp_=rh(),s=this.joinedTimestamp_-this.startJoinTimestamp_,jd.logSuccessEvent({userId:this.userId_,eventType:_l,delta:s}),jd.logSuccessEvent({userId:this.userId_,eventType:ml}),jd.uploadEvent({log:"stat-autoplay-dialog:".concat(this.enableAutoPlayDialog_),userId:this.userId_}),e.next=39;break;case 33:throw e.prev=33,e.t0=e.catch(17),gh.emit(Ah,{client:this,error:e.t0}),jd.logFailedEvent({userId:this.userId_,eventType:ml,error:e.t0}),this.reset(),e.t0;case 39:case"end":return e.stop()}}),e,this,[[17,33]])}))),function(e){return O.apply(this,arguments)})},{key:"uploadTrtcStats",value:(k=o(regeneratorRuntime.mark((function e(){var t,r,i,n,o,s,a,c,l,u,d,h,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,wy.getMicrophones();case 3:i=e.sent,t=i&&i.length,e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:return e.prev=9,e.next=12,wy.getCameras();case 12:n=e.sent,r=n&&n.length,e.next=18;break;case 16:e.prev=16,e.t1=e.catch(9);case 18:o={microphone:t,camera:r},s=this.checkSystemResult_.detail,a=s.isH264EncodeSupported,c=s.isVp8EncodeSupported,l=s.isH264DecodeSupported,u=s.isVp8DecodeSupported,d={webRTC:this.basis_.isWebRTCSupported,getUserMedia:this.basis_.isGetUserMediaSupported,webSocket:this.basis_.isWebSocketsSupported,screenShare:this.basis_.isScreenShareSupported,webAudio:this.basis_.isWebAudioSupported,h264Encode:a,h264Decode:l,vp8Encode:c,vp8Decode:u},h={browser:this.basis_.browser,os:this.basis_.os,trtc:d,devices:o},p={isWebCodecSupported:this.basis_.isWebCodecSupported,isMediaSessionSupported:this.basis_.isMediaSessionSupported,isWebTransportSupported:this.basis_.isWebTransportSupported},jd.uploadEvent({log:"trtcstats-"+JSON.stringify(h),userId:this.userId_}),this.log_.info("TrtcStats-"+JSON.stringify(h)),jd.uploadEvent({log:"trtcadvancedstats-"+JSON.stringify(p),userId:this.userId_});case 26:case"end":return e.stop()}}),e,this,[[0,7],[9,16]])}))),function(){return k.apply(this,arguments)})},{key:"getVersion",value:function(){var e=this.version_.split(".");return 1e3*parseInt(e[0])+100*parseInt(e[1])+parseInt(e[2])}},{key:"doJoin",value:function(e){var t=this;return new Promise((function(r,i){if(!t.isSignalReady_)throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:Qm})});t.roomId_=e.roomId,Yd(e.role)||(t.role_=e.role);var n="";Yd(e.privateMapKey)||(n=e.privateMapKey),t.privateMapKey_=n,t.log_.info("Join() => joining room: ".concat(e.roomId," useStringRoomId: ").concat(t.useStringRoomId_," mode: ").concat(t.mode_," role: ").concat(t.role_));var o=t.signalInfo_,s={openid:o.openId,tinyid:o.tinyId,peerconnectionport:"",useStrRoomid:!!t.useStringRoomId_&&1,roomid:String(e.roomId),sdkAppID:String(t.sdkAppId_),socketid:o.socketId,userSig:t.userSig_,privMapEncrypt:n,privMap:"",relayip:o.relayInnerIp,dataport:o.dataPort,stunport:o.stunPort,checkSigSeq:o.checkSigSeq,pstnBizType:0,pstnPhoneNumber:null,recordId:t.recordId_,role:"user",jsSdkVersion:String(t.getVersion()),sdpSemantics:t.sdpSemantics_,browserVersion:xc,closeLocalMedia:!0,trtcscene:"live"===t.mode_?Xc:Jc,trtcrole:"anchor"===t.role_?el:tl,bussinessInfo:t.bussinessInfo_,isAuxUser:t.isScreenShareOnly_,autoSubscribe:t.autoSubscribe_};t.joinTimeout_=setTimeout((function(){t.log_.error("join room timeout observed"),i(new Vd({code:Fd.JOIN_ROOM_FAILED,message:uv({key:Wm})}))}),5e3),gh.emit(_h,{client:t});var a={AbilityOption:{GeneralLimit:{CPULimit:{uint32_CPU_num:String(navigator.hardwareConcurrency||0),str_CPU_name:String(navigator.platform),uint32_CPU_maxfreq:String(0),model:"",uint32_total_memory:String(0)},uint32_terminal_type:String(ja?4:Ua?2:xa?3:fc?12:pc?5:gc?13:1),uint32_device_type:String(0),str_os_verion:ja?"Android":Ua?"iPhone":xa?"iPad":fc?"Mac":pc?"Windows":gc?"Linux":"unknown",uint32_link_type:String(1),str_client_version:"4.11.12",uint32_net_type:String(mu[Wd()]),ua:navigator.userAgent,version:""}}},c=t.getSystemResult().detail,l=c.isH264EncodeSupported,u=c.isVp8EncodeSupported,d="";l?d="H264":u&&(d="VP8");var h={EncVideoCodec:d,EncVideoWidth:0,EncVideoHeight:0,EncVideoBr:"0",EncVideoFps:0,EncAudioCodec:"opus",EncAudioFS:0,EncAudioCh:0,EncAudioBr:"0"};a.AbilityOption.AVLimit=h,t.signalChannel_.sendWithReport(ug,s,a),t.signalChannel_.once(cg.JOIN_ROOM_RESULT,(function(e){clearTimeout(t.joinTimeout_),t.joinTimeout_=-1;var n=e.data.content.ret;gh.emit(vh,{client:t,code:n}),n?(t.log_.error("Join room failed result: "+n+" error: "+e.data.content.error),i(new Vd({code:Fd.JOIN_ROOM_FAILED,extraCode:n,message:uv({key:qm,data:{error:e.data.content.error}})}))):(t.isJoined_=!0,t.log_.info("Join room success, start heartbeat"),t.startHeartbeat(),t.badCaseDetector_&&t.badCaseDetector_.start(),t.syncUserList(),t.startSyncUserListInterval(),r())}))}))}},{key:"connectSignalBeforeReJoin",value:function(){var e=this;return new Promise((function(t,r){e.log_.warn("connectSignalBeforeReJoin() try to connect signal before reJoin"),e.isSignalReady_=!1,e.signalChannel_.close(),e.signalChannel_.once(cg.CHANNEL_SETUP_SUCCESS,(function(r){e.log_.warn("connectSignalBeforeReJoin() signal setup successfully"),t()})),e.signalChannel_.once(tg,(function(t){e.log_.warn("connectSignalBeforeReJoin() signal setup failed"),r(t)})),e.signalChannel_.connect()}))}},{key:"reJoin",value:(w=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isJoined_){e.next=3;break}return this.log_.warn("reJoin() you haven't join room yet, abort reJoin"),e.abrupt("return");case 3:return this.isJoined_=!1,e.prev=4,this.log_.warn("reJoin() try to reJoin room: ".concat(this.joinOptions_.roomId)),this.subscriptionManager_&&this.subscriptionManager_.markAllStream(),e.next=9,this.connectSignalBeforeReJoin();case 9:return e.next=11,this.doJoin(this.joinOptions_);case 11:if(this.log_.warn("reJoin() reJoin successfully"),jd.logSuccessEvent({userId:this.userId_,eventType:vl}),this.checkConnectionsToReconnect(),e.prev=14,!this.uplinkConnection_||!this.localStream_||this.uplinkConnection_.getIsReconnecting()){e.next=18;break}return e.next=18,this.republish();case 18:e.next=22;break;case 20:e.prev=20,e.t0=e.catch(14);case 22:e.next=29;break;case 24:e.prev=24,e.t1=e.catch(4),this.log_.warn("reJoin() reJoin failed"+e.t1),jd.logFailedEvent({userId:this.userId_,eventType:vl,error:e.t1}),this.emitter_.emit(yE,new Vd({code:Fd.JOIN_ROOM_FAILED,message:uv({key:zm,data:{roomId:this.joinOptions_.roomId}})}));case 29:case"end":return e.stop()}}),e,this,[[4,24],[14,20]])}))),function(){return w.apply(this,arguments)})},{key:"republish",value:(R=o(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.log_.warn("republish() try to re-publish localStream"),t=this.localStream_,e.next=5,this.doUnpublish(t);case 5:return e.next=7,this.publish(t);case 7:this.log_.warn("republish() re-publish localStream successfully"),e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(0),this.log_.warn("republish() re-publish localStream failed "+e.t0),e.t0;case 14:case"end":return e.stop()}}),e,this,[[0,10]])}))),function(){return R.apply(this,arguments)})},{key:"leave",value:(I=o(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gh.emit(yh,{client:this}),hm(this.userId_,{eventId:$g,eventDesc:"leaving room",timestamp:Es(),userId:this.userId_,tinyId:this.tinyId_}),e.prev=2,e.next=5,this.doHeartbeat();case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:this.doLeave(),gh.emit(Ch,{client:this}),jd.logSuccessEvent({userId:this.userId_,eventType:El}),t=Math.floor((rh()-this.joinedTimestamp_)/1e3),jd.logSuccessEvent({userId:this.userId_,eventType:Al,delta:t});case 14:case"end":return e.stop()}}),e,this,[[2,7]])}))),function(){return I.apply(this,arguments)})},{key:"doLeave",value:function(){this.isJoined_&&(gh.emit(Sh,{client:this}),this.log_.info("leave() => leaving room"),this.signalChannel_.send(dg),this.reset())}},{key:"clearNetworkQuality",value:function(){this.networkQuality_&&(this.networkQuality_.stop(),this.networkQuality_=null)}},{key:"closeConnections",value:function(){var e=this;this.connections_.forEach((function(t){e.closeDownLink(t.getTinyId())}))}},{key:"destroy",value:function(){if(this.isJoined_)throw this.log_.warn("please call leave() before destroy() client"),new Vd({code:Fd.INVALID_OPERATION,message:uv({key:Zm})});this.log_.info("destroying SignalChannel"),this.signalChannel_&&(this.signalChannel_.close(),this.signalChannel_=null)}},{key:"reset",value:function(){this.keyPointManager_&&this.keyPointManager_.prepareReport(),this.mixTranscodeManager_&&(this.mixTranscodeManager_.stop(),this.mixTranscodeManager_=null),this.publishCDNManager_&&(this.publishCDNManager_=null),this.userMap_.clear(),this.stopSyncUserListInterval(),this.stopHeartbeat(),this.closeConnections(),this.mutedStates_.clear(),this.clearNetworkQuality(),this.badCaseDetector_&&this.callDurationCalculator_&&this.uploadAllCallStats(),this.closeUplink(),this.isJoined_=!1,this.isSignalReady_=!1,this.destroy()}},{key:"startSyncUserListInterval",value:function(){"live"===this.mode_&&"audience"===this.role_&&-1===this.syncUserListInterval_&&(this.syncUserListInterval_=wv.setInterval(this.syncUserList.bind(this),1e4))}},{key:"stopSyncUserListInterval",value:function(){wv.clearInterval(this.syncUserListInterval_),this.syncUserListInterval_=-1}},{key:"syncUserList",value:(b=o(regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getUserList();case 3:t=e.sent,0!==this.userMap_.size&&this.userMap_.forEach((function(e){t.findIndex((function(t){return t.userId===e.userId}))<0&&(r.log_.info("peer leave detected: ".concat(e.userId)),r.cleanUser({userId:e.userId,tinyId:e.tinyId}))})),t.forEach((function(e){var t=e.userId;r.userMap_.has(t)||t===r.userId_||(r.userMap_.set(t,e),r.emitter_.emit(hE,{userId:t}))})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.log_.warn("sync user list failed: "+e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return b.apply(this,arguments)})},{key:"getUserList",value:function(){var e=this;return new Promise((function(t,r){e.signalChannel_.send(wg),e.signalChannel_.once(cg.USER_LIST_RES,(function(e){var r=e.data.content.userlist.map((function(e){var t=e.userid,r=e.srctinyid,i=e.role;return new BA({userId:t,tinyId:r,role:i})}));t(r)})),setTimeout(r,2e3)}))}},{key:"publish",value:(T=o(regeneratorRuntime.mark((function e(t){var r,i,n,o,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setPublishState(vu),this.isPublishing_=!0,r=rh(),gh.emit(Ih,{client:this,stream:t}),this.log_.info("publish() => publishing local stream"),i=new OA({userId:this.userId_,tinyId:this.tinyId_,client:this,isUplink:!0,signalChannel:this.signalChannel_}),t.setConnection(i),i.initialize(),i.on(oE,(function(e){var t=e.getCode();t!==Fd.ICE_TRANSPORT_ERROR&&(t===Fd.UPLINK_RECONNECTION_FAILED&&s.closeUplink(),s.emitter_.emit(yE,e))})),e.prev=9,e.next=12,i.publish(t);case 12:this.localStream_=e.sent,this.localStream_.getBeautyStatus()&&this.log_.info("beauty stream is published successfully"),this.log_.info("local stream is published successfully"),this.isPublishing_=!1,t.setPublishState(Eu),this.uplinkConnection_=i,n=rh(),o=n-r,jd.logSuccessEvent({userId:this.userId_,eventType:yl}),jd.logSuccessEvent({userId:this.userId_,eventType:Sl,delta:o}),t.hasAudio()&&hm(this.userId_,{eventId:Lg,eventDesc:"publish audio track",timestamp:Es(),userId:this.userId_,tinyId:this.tinyId_}),t.hasVideo()&&hm(this.userId_,{eventId:Ng,eventDesc:"publish video track",timestamp:Es(),userId:this.userId_,tinyId:this.tinyId_}),this.networkQuality_&&this.networkQuality_.setUplinkConnection(this.uplinkConnection_),this.deviceDetector_&&this.deviceDetector_.setLocalStream(this.localStream_),gh.emit(Gh,{localStream:this.localStream_,client:this}),this.notPublishWithoutH264Supported_=!1,e.next=39;break;case 30:throw e.prev=30,e.t0=e.catch(9),e.t0 instanceof Vd&&e.t0.getCode()===Fd.NOT_SUPPORTED_H264&&(this.notPublishWithoutH264Supported_=!0),t.setPublishState(_u),i.close(),this.log_.error("failed to publish stream "+e.t0),this.isPublishing_=!1,jd.logFailedEvent({userId:this.userId_,eventType:yl,error:e.t0}),e.t0;case 39:case"end":return e.stop()}}),e,this,[[9,30]])}))),function(e){return T.apply(this,arguments)})},{key:"unpublish",value:(S=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.log_.info("unpublish() => unpublishing local stream"),e.prev=1,e.next=4,this.doUnpublish();case 4:jd.logSuccessEvent({userId:this.userId_,eventType:Cl}),e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(1),jd.logFailedEvent({userId:this.userId_,eventType:Cl,error:e.t0}),e.t0;case 11:case"end":return e.stop()}}),e,this,[[1,7]])}))),function(){return S.apply(this,arguments)})},{key:"doUnpublish",value:function(){var e=this;return this.signalChannel_.sendWaitForResponse({command:vg,commandDesc:"unpublish",responseCommand:cg.UNPUBLISH_RESULT}).then((function(){e.closeUplink()})).catch((function(){e.closeUplink()}))}},{key:"closeUplink",value:function(){this.uplinkConnection_&&(this.uplinkConnection_.getIsReconnecting()&&this.uplinkConnection_.stopReconnection(),this.uplinkConnection_.close(),this.uplinkConnection_=null,this.networkQuality_&&this.networkQuality_.setUplinkConnection(null),this.localStream_.hasAudio()&&hm(this.userId_,{eventId:Dg,eventDesc:"unpublish audio track",timestamp:Es(),userId:this.userId_,tinyId:this.tinyId_}),this.localStream_.hasVideo()&&hm(this.userId_,{eventId:Pg,eventDesc:"unpublish video track",timestamp:Es(),userId:this.userId_,tinyId:this.tinyId_}),this.localStream_.setConnection(null),this.localStream_=null,this.deviceDetector_&&this.deviceDetector_.setLocalStream(null))}},{key:"closeDownLink",value:function(e){var t=this.connections_.get(e);t&&(t.getIsReconnecting()&&t.stopReconnection(),this.subscriptionManager_&&this.subscriptionManager_.delete(t.getUserId()),t.close(),this.connections_.delete(e),this.mutedStates_.delete(e))}},{key:"subscribe",value:(y=o(regeneratorRuntime.mark((function e(t,r){var i,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.log_.info("subscribe() => subscribe to [".concat(t.getUserId(),"] ").concat(t.getType()," stream with options: ").concat(JSON.stringify(r))),Yd(r)&&(r={audio:!0,video:!0}),Yd(r.video)&&(r.video=!0),Yd(r.audio)&&(r.audio=!0),e.prev=4,i=t.getConnection(),gh.emit(Bh,{client:this,stream:t}),e.next=9,i.subscribe(t,r);case 9:this.subscriptionManager_&&this.subscriptionManager_.addSubscriptionRecord(t.getUserId(),t,r),this.notSubscribeWithoutH264Supported_=!1,jd.logSuccessEvent({userId:this.userId_,eventType:Tl}),e.next=22;break;case 14:throw e.prev=14,e.t0=e.catch(4),(n=e.t0 instanceof Vd?e.t0.getCode():Fd.UNKNOWN)===Fd.NOT_SUPPORTED_H264&&(this.notSubscribeWithoutH264Supported_=!0),o=new Vd({code:n,message:uv({key:t_,data:{message:e.t0.message}})}),jd.logFailedEvent({userId:this.userId_,eventType:Tl,error:o}),this.log_.error(o),o;case 22:case"end":return e.stop()}}),e,this,[[4,14]])}))),function(e,t){return y.apply(this,arguments)})},{key:"unsubscribe",value:(v=o(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.log_.info("unsubscribe() => unsubscribe to [".concat(t.getUserId(),"] ").concat(t.getType()," stream")),e.prev=1,r=t.getConnection(),e.next=5,r.unsubscribe(t);case 5:this.subscriptionManager_&&this.subscriptionManager_.addUnsubscriptionRecord(t.getUserId(),t),gh.emit(Fh,{client:this,stream:t}),jd.logSuccessEvent({userId:this.userId_,eventType:bl}),e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(1),jd.logFailedEvent({userId:this.userId_,eventType:bl,error:e.t0}),e.t0;case 14:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(e){return v.apply(this,arguments)})},{key:"switchRole",value:(_=o(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.role_!==t){e.next=2;break}return e.abrupt("return");case 2:if("audience"!==t||!this.localStream_){e.next=5;break}return e.next=5,this.unpublish(this.localStream_);case 5:return this.log_.info("switchRole() => switch role to: "+t),e.next=8,this.doSwitchRole(t);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return _.apply(this,arguments)})},{key:"doSwitchRole",value:function(e){var t=this;return new Promise((function(r,i){var n={trtcscene:"live"===t.mode_?Xc:Jc,trtcrole:"anchor"===e?el:tl};t.log_.info("switchRole signal data: "+JSON.stringify(n));var o=setTimeout((function(){t.log_.error("switchRole timeout observed"),t.signalChannel_.off(cg.SWITCH_ROLE_RES,s),i(new Vd({code:Fd.SWITCH_ROLE_FAILED,message:uv({key:n_})}))}),5e3),s=function(n){clearTimeout(o);var s=n.data.content,a=s.errCode,c=s.errMsg;0===a?(t.role_=e,r()):(t.log_.error("switchRole failed, errCode: ".concat(a,", errMsg: ").concat(c)),i(new Vd({code:Fd.SWITCH_ROLE_FAILED,message:uv({key:o_,data:{errMsg:c,errCode:a}})})))};t.signalChannel_.once(cg.SWITCH_ROLE_RES,s),t.signalChannel_.send(kg,n)}))}},{key:"on",value:function(e,t,r){this.emitter_.on(e,t,r)}},{key:"off",value:function(e,t,r){"*"===e?this.emitter_.removeAllListeners():this.emitter_.off(e,t,r)}},{key:"getRemoteMutedState",value:function(){var e=this,t=[];return this.mutedStates_.forEach((function(i,n,o){var s=e.connections_.get(n);s&&t.push(r({userId:s.getUserId()},i))})),t}},{key:"getTransportStats",value:(m=o(regeneratorRuntime.mark((function e(){var t,r,i,n,o,s,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={rtt:0,downlinksRTT:{}},!this.uplinkConnection_){e.next=6;break}return e.next=4,this.stats_.getSenderStats(this.uplinkConnection_);case 4:r=e.sent,t.rtt=r.rtt;case 6:i=C(this.connections_),e.prev=7,i.s();case 9:if((n=i.n()).done){e.next=17;break}return(o=E(n.value,2))[0],s=o[1],e.next=13,this.stats_.getReceiverStats(s);case 13:a=e.sent,t.downlinksRTT[a.userId]=a.rtt;case 15:e.next=9;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(7),i.e(e.t0);case 22:return e.prev=22,i.f(),e.finish(22);case 25:return e.abrupt("return",t);case 26:case"end":return e.stop()}}),e,this,[[7,19,22,25]])}))),function(){return m.apply(this,arguments)})},{key:"getLocalAudioStats",value:(g=o(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t={})[this.userId_]={bytesSent:0,packetsSent:0},!this.uplinkConnection_){e.next=7;break}return e.next=5,this.stats_.getSenderStats(this.uplinkConnection_);case 5:r=e.sent,t[this.userId_]={bytesSent:r.audio.bytesSent,packetsSent:r.audio.packetsSent};case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"getLocalVideoStats",value:(f=o(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t={})[this.userId_]={bytesSent:0,packetsSent:0,framesEncoded:0,framesSent:0,frameWidth:0,frameHeight:0},!this.uplinkConnection_){e.next=7;break}return e.next=5,this.stats_.getSenderStats(this.uplinkConnection_);case 5:r=e.sent,t[this.userId_]={bytesSent:r.video.bytesSent,packetsSent:r.video.packetsSent,framesEncoded:r.video.framesEncoded,framesSent:r.video.framesSent,frameWidth:r.video.frameWidth,frameHeight:r.video.frameHeight};case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"getRemoteAudioStats",value:(p=o(regeneratorRuntime.mark((function e(){var t,r,i,n,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={},r=C(this.connections_),e.prev=2,r.s();case 4:if((i=r.n()).done){e.next=12;break}return(n=E(i.value,2))[0],o=n[1],e.next=8,this.stats_.getReceiverStats(o);case 8:(s=e.sent).hasAudio&&(t[s.userId]={bytesReceived:s.audio.bytesReceived,packetsReceived:s.audio.packetsReceived,packetsLost:s.audio.packetsLost});case 10:e.next=4;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),r.e(e.t0);case 17:return e.prev=17,r.f(),e.finish(17);case 20:return e.abrupt("return",t);case 21:case"end":return e.stop()}}),e,this,[[2,14,17,20]])}))),function(){return p.apply(this,arguments)})},{key:"getRemoteVideoStats",value:(h=o(regeneratorRuntime.mark((function e(){var t,r,i,n,o,s,a,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=c.length>0&&void 0!==c[0]?c[0]:"main",r={},i=C(this.connections_),e.prev=3,i.s();case 5:if((n=i.n()).done){e.next=14;break}return(o=E(n.value,2))[0],s=o[1],e.next=9,this.stats_.getReceiverStats(s);case 9:a=e.sent,"main"===t&&a.hasVideo&&(r[a.userId]={bytesReceived:a.video.bytesReceived,packetsReceived:a.video.packetsReceived,packetsLost:a.video.packetsLost,framesDecoded:a.video.framesDecoded,frameWidth:a.video.frameWidth,frameHeight:a.video.frameHeight}),"auxiliary"===t&&a.hasAuxiliary&&(r[a.userId]={bytesReceived:a.auxiliary.bytesReceived,packetsReceived:a.auxiliary.packetsReceived,packetsLost:a.auxiliary.packetsLost,framesDecoded:a.auxiliary.framesDecoded,frameWidth:a.auxiliary.frameWidth,frameHeight:a.auxiliary.frameHeight});case 12:e.next=5;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(3),i.e(e.t0);case 19:return e.prev=19,i.f(),e.finish(19);case 22:return e.abrupt("return",r);case 23:case"end":return e.stop()}}),e,this,[[3,16,19,22]])}))),function(){return h.apply(this,arguments)})},{key:"getSdpSemantics",value:function(){return this.sdpSemantics_}},{key:"getIceServers",value:function(){return 0===this.turnServers_.length&&this.schedule_.iceServers?this.schedule_.iceServers:this.turnServers_}},{key:"getConnections",value:function(){return this.connections_}},{key:"getMutedStates",value:function(){return this.mutedStates_}},{key:"startHeartbeat",value:function(){-1===this.heartbeat_&&(this.log_.info("startHeartbeat..."),this.heartbeat_=wv.setInterval(this.doHeartbeat.bind(this),2e3))}},{key:"stopHeartbeat",value:function(){-1!==this.heartbeat_&&(this.log_.info("stopHeartbeat"),wv.clearInterval(this.heartbeat_),this.heartbeat_=-1,this.lastHeartBeatTime_=-1)}},{key:"doHeartbeat",value:(d=o(regeneratorRuntime.mark((function e(){var t,r,i,n,o,s,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.badCaseDetector_.getMonitorFreeze(),e.next=3,this.stats_.getStatsReport({uplinkConnection:this.uplinkConnection_,downlinkConnections:this.connections_,freezeMap:t});case 3:if(r=e.sent,gh.emit(Th,{client:this,stats:r}),this.badCaseDetector_.resetMonitor(),this.signalChannel_){e.next=8;break}return e.abrupt("return");case 8:i=this.signalChannel_.isConnected()?(c=this.userId_,l=void 0,(l=dm.get(c))?dm.delete(c):l=[],l):[],n={WebRTCQualityReq:r,eventList:i,sdkAppId:this.sdkAppId_,tinyid:this.tinyId_,roomid:this.roomId_,socketid:this.signalInfo_.socketId,clientip:this.signalInfo_.localIp,serverip:this.signalInfo_.relayIp,cpunumber:navigator.hardwareConcurrency||0,cpudevice:navigator.platform,devicename:navigator.platform,ostype:navigator.platform,mode:this.localStream_?this.localStream_.getScreen()?"screen":Xl:""},o=0,this.localStream_&&this.localStream_.getMediaStream()&&(s=this.localStream_.getMediaStream().getAudioTracks(),o=s.length>0&&s[0].muted?3:1),n.WebRTCQualityReq.AudioReportState.uint32_microphone_status=o,this.signalChannel_.send(hg,n),a=Date.now(),this.lastHeartBeatTime_>0&&a-this.lastHeartBeatTime_>1e4&&this.log_.warn("heartbeat took ".concat(a-this.lastHeartBeatTime_)),this.lastHeartBeatTime_=a;case 17:case"end":return e.stop()}var c,l}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"onRemoteStreamAdded",value:function(e){var t=e.content,r=t.srcopenid,i=t.srctinyid;if(null!==r){this.userMap_.has(r)||(this.userMap_.set(r,new BA({userId:r,tinyId:i,role:"anchor"})),this.emitter_.emit(hE,{userId:r}));var n=this.connections_.get(i);if(n){if(n.getIsReconnecting())return;this.log_.warn("duplicated stream-added observed, rebuild the connection"),n.close(),this.connections_.delete(i)}var o={audio:t.audio,video:t.bigVideo,auxiliary:t.auxVideo};this.log_.info("remote peer [".concat(r,"] published stream. trackState: ").concat(JSON.stringify(o))),this.createDownlinkConnection({userId:r,tinyId:i,trackState:o})}else this.log_.warn("received null userId on stream added")}},{key:"createDownlinkConnection",value:function(e){var t=this,r=e.userId,i=e.tinyId,n=e.trackState,o=new NA({userId:r,tinyId:i,client:this,isUplink:!1,signalChannel:this.signalChannel_,autoSubscribe:this.autoSubscribe_,trackState:n});this.connections_.set(i,o),this.installDownlinkEvents(o,r,i),this.autoSubscribe_?(o.initialize(),o.connect().catch((function(){var e=o.getTrackState();o.getMainStream()||!e.audio&&!e.video||t.initRemoteStream({type:"main",userId:r,downlinkConnection:o}),!o.getAuxStream()&&e.auxiliary&&t.initRemoteStream({type:"auxiliary",userId:r,downlinkConnection:o})}))):((n.audio||n.video)&&this.initRemoteStream({type:"main",userId:r,downlinkConnection:o}),n.auxiliary&&this.initRemoteStream({type:"auxiliary",userId:r,downlinkConnection:o}))}},{key:"initRemoteStream",value:function(e){var t=e.type,r=e.userId,i=e.downlinkConnection,n=new yA({type:t,userId:r,client:this});n.setConnection(i),i.setRemoteStream("main"===t?rl:il,n),n.setIsStreamAddedEventEmitted(!0),gh.emit(xh,{client:this,stream:n}),this.emitter_.emit(aE,{stream:n})}},{key:"installDownlinkEvents",value:function(e,t,r){var i=this;e.on(tE,(function(e){e.stream.setIsStreamAddedEventEmitted(!0),gh.emit(xh,{client:i,stream:e.stream}),i.emitter_.emit(aE,{stream:e.stream})})),e.on(rE,(function(e){e.stream.stop(),e.stream.setIsStreamAddedEventEmitted(!1),i.subscriptionManager_&&i.subscriptionManager_.deleteAutoRecoveryFlag(e.stream.getUserId(),e.stream.getType()),gh.emit(jh,{client:i,stream:e.stream}),i.emitter_.emit(cE,{stream:e.stream})})),e.on(iE,(function(e){gh.emit(Vh,{client:i,stream:e.stream}),i.emitter_.emit(lE,{stream:e.stream})})),e.on(nE,(function(e){gh.emit(Uh,{client:i,stream:e.stream}),i.emitter_.emit(uE,{stream:e.stream})})),e.on(oE,(function(e){var t=e.getCode();t!==Fd.ICE_TRANSPORT_ERROR&&(t===Fd.DOWNLINK_RECONNECTION_FAILED&&i.closeDownLink(r),i.emitter_.emit(yE,e))}))}},{key:"onRemoteStreamRemoved",value:function(e){var t=e.content,r=t.srctinyid,i=t.srcopenid,n=this.connections_.get(r);n&&(void 0===i&&(i=n.getUserId()),this.log_.info("remote peer [".concat(i,"] unpublished stream")),this.closeDownLink(r))}},{key:"onPeerJoin",value:function(e){var t=e.data.content,r=t.srctinyid,i=t.userid,n=t.role;this.userMap_.has(i)||(this.userMap_.set(i,new BA({userId:i,tinyId:r,role:n})),this.emitter_.emit(hE,{userId:i}))}},{key:"onPeerLeave",value:function(e){var t=e.data.content,r=t.srctinyid,i=t.userid;this.log_.info("peer leave [".concat(i,"]")),this.cleanUser({userId:i,tinyId:r})}},{key:"cleanUser",value:function(e){var t=e.userId,r=e.tinyId;this.userMap_.delete(t),this.closeDownLink(r),this.emitter_.emit(pE,{userId:t})}},{key:"onPublishedUserList",value:function(e){var t=this;try{var r=e.content.userlist.map((function(e){return e.userid}));this.connections_.forEach((function(e){var i=e.getUserId(),n=e.getTinyId();r.findIndex((function(e){return e===i}))<0&&(t.log_.info("peer unpublished detected [".concat(i,"]")),t.closeDownLink(n))})),e.content.userlist.forEach((function(e){var r=e.userid,i=e.srctinyid,n=e.flag;if(r!==t.userId_){var o=!!(1&n),s=!!(8&n),a=!!(4&n);if(t.connections_.has(i)){var c=t.connections_.get(i).getTrackState(),l=c.audio,u=c.video,d=c.auxiliary;!u&&o&&gh.emit(Mh,{client:t,tinyId:i,userId:r,action:fu,kind:Xl}),!l&&s&&gh.emit(Mh,{client:t,tinyId:i,userId:r,action:fu,kind:Jl}),!d&&a&&gh.emit(Mh,{client:t,tinyId:i,userId:r,action:fu,kind:eu}),u&&!o&&gh.emit(Mh,{client:t,tinyId:i,userId:r,action:gu,kind:Xl}),l&&!s&&gh.emit(Mh,{client:t,tinyId:i,userId:r,action:gu,kind:Jl}),d&&!a&&gh.emit(Mh,{client:t,tinyId:i,userId:r,action:gu,kind:eu})}else t.log_.info("peer published detected [".concat(r,"]")),t.onRemoteStreamAdded({content:{audio:s,auxVideo:a,bigVideo:o,srcopenid:r,srctinyid:i}})}}))}catch(ky){}}},{key:"onUpdateRemoteMuteStat",value:function(e){var t=this;e.content.userlist.forEach((function(e){var r=e.srctinyid,i=e.userid;if(0!==r&&r!==t.tinyId_){var n=t.connections_.get(r);if(n){var o=n.getMainStream();if(o&&o.getIsStreamAddedEventEmitted()){var s=!!(1&e.flag),a=!!(8&e.flag),c=!!(2&e.flag),l=!!(64&e.flag),u=!!(16&e.flag),d=t.mutedStates_.get(r);if(void 0===d)return t.mutedStates_.set(r,{hasAudio:a,hasVideo:s,hasSmall:c,audioMuted:l,videoMuted:u}),s?u?t.emitter_.emit(gE,{userId:i}):t.emitter_.emit(_E,{userId:i}):t.emitter_.emit(gE,{userId:i}),void(a?l?t.emitter_.emit(fE,{userId:i}):t.emitter_.emit(mE,{userId:i}):t.emitter_.emit(fE,{userId:i}));var h=!l&&a;(!d.audioMuted&&d.hasAudio)!==h&&(h?t.emitter_.emit(mE,{userId:i}):t.emitter_.emit(fE,{userId:i}));var p=!u&&s;(!d.videoMuted&&d.hasVideo)!==p&&(p?t.emitter_.emit(_E,{userId:i}):t.emitter_.emit(gE,{userId:i})),t.mutedStates_.set(r,{hasAudio:a,hasVideo:s,hasSmall:c,audioMuted:l,videoMuted:u})}}else t.mutedStates_.delete(r)}}))}},{key:"onClientBanned",value:function(e){this.emitter_.emit(vE,new Vd({code:Fd.CLIENT_BANNED,message:uv({key:s_,data:{reason:e}})}))}},{key:"getEnv",value:function(){return this.env_}},{key:"getSubscriptionManager",value:function(){return this.subscriptionManager_}},{key:"startPublishCDNStream",value:(u=o(regeneratorRuntime.mark((function e(){var t,r=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:{},this.localStream_){e.next=3;break}throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:a_})});case 3:return this.log_.info("startPublishCDNStream params: ".concat(JSON.stringify(t))),e.next=6,this.publishCDNManager_.startPublishTencentCDN(t);case 6:if(!(t.appId&&t.bizId&&t.url)){e.next=9;break}return e.next=9,this.publishCDNManager_.startPublishGivenCDN(t);case 9:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"stopPublishCDNStream",value:(l=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.publishCDNManager_.getIsPublishingTencentCDN()){e.next=2;break}throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:c_})});case 2:return this.log_.info("stopPublishCDNStream"),e.next=5,this.publishCDNManager_.stopPublishTencentCDN();case 5:if(!this.publishCDNManager_.getIsPublishingGivenCDN()){e.next=8;break}return e.next=8,this.publishCDNManager_.stopPublishGivenCDN();case 8:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"startMixTranscode",value:(a=o(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isJoined_&&this.mixTranscodeManager_){e.next=2;break}throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:h_})});case 2:return Yd(t.mode)&&(t.mode=Hl.MANUAL),e.prev=3,this.log_.info("startMixTranscode with config ".concat(JSON.stringify(t))),jd.uploadEvent({log:"mix-transcode-mode:".concat(t.mode),userId:this.userId_}),e.next=8,this.mixTranscodeManager_.startMixTranscode(t);case 8:jd.logSuccessEvent({userId:this.userId_,eventType:Ul}),e.next=15;break;case 11:throw e.prev=11,e.t0=e.catch(3),jd.logFailedEvent({userId:this.userId_,eventType:Ul,error:e.t0}),e.t0;case 15:case"end":return e.stop()}}),e,this,[[3,11]])}))),function(e){return a.apply(this,arguments)})},{key:"stopMixTranscode",value:(n=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isJoined_&&this.mixTranscodeManager_){e.next=2;break}throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:p_})});case 2:return e.prev=2,e.next=5,this.mixTranscodeManager_.stopMixTranscode();case 5:jd.logSuccessEvent({userId:this.userId_,eventType:Fl}),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(2),jd.logFailedEvent({userId:this.userId_,eventType:Fl,error:e.t0}),e.t0;case 12:case"end":return e.stop()}}),e,this,[[2,8]])}))),function(){return n.apply(this,arguments)})},{key:"getSystemResult",value:function(){return this.checkSystemResult_}},{key:"enableAudioVolumeEvaluation",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!$d(t))throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:f_})});if(this.log_.info("enableAudioVolumeEvaluation with interval: "+t),t<=0)return this.enableAudioVolumeEvaluation_=!1,wv.clearInterval(this.audioVolumeIntervalId_),void(this.audioVolumeIntervalId_=null);t=Math.floor(Math.max(t,16)),this.audioVolumeIntervalId_&&(wv.clearInterval(this.audioVolumeIntervalId_),this.audioVolumeIntervalId_=null),this.enableAudioVolumeEvaluation_=!0,this.audioVolumeIntervalId_=wv.setInterval((function(){var t=[];if(e.localStream_){var r=Math.floor(100*e.localStream_.getAudioLevel());t.push({userId:e.userId_,audioVolume:r,stream:e.localStream_})}e.connections_.forEach((function(e){var r=e.getSubscribedMainStream();if(r){var i=Math.floor(100*r.getAudioLevel());t.push({userId:e.getUserId(),audioVolume:i,stream:r})}})),e.emitter_.emit(AE,{result:t})}),t,r)}},{key:"uploadAllCallStats",value:function(){var e=this;this.callDurationCalculator_.getDurationMap().forEach((function(t,r){var i={userId:t.userId,type:t.type,duration:e.callDurationCalculator_.getDuration(r,Xl),dataFreeze:e.badCaseDetector_.getDataFreezeDuration(r).dataFreeze,renderFreeze:e.badCaseDetector_.getRenderFreezeDuration(r).renderFreeze};jd.uploadEvent({log:"callStats-"+JSON.stringify(i),userId:e.userId_})})),this.badCaseDetector_.stop(),this.callDurationCalculator_.reset()}},{key:"enableSmallStream",value:(i=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPublished()&&!this.isPublishing_){e.next=2;break}throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:g_})});case 2:if(!eE()){e.next=7;break}this.setIsEnableSmallStream(!0),this.log_.info("SmallStream successfully enabled"),e.next=8;break;case 7:throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:__})});case 8:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"disableSmallStream",value:(t=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPublished()&&!this.isPublishing_){e.next=2;break}throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:m_})});case 2:this.setIsEnableSmallStream(!1),this.log_.info("SmallStream successfully disabled");case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"setSmallStreamProfile",value:function(e){var t=this;e&&e.framerate&&(e.frameRate=e.framerate),Object.keys(this.smallStreamConfig_).forEach((function(r){e[r]&&(t.smallStreamConfig_[r]=e[r])})),this.log_.info("setSmallStreamProfile: bitrate=".concat(this.smallStreamConfig_.bitrate,", frameRate=").concat(this.smallStreamConfig_.frameRate,", height=").concat(this.smallStreamConfig_.height,", width=").concat(this.smallStreamConfig_.width));var r=this.smallStreamConfig_,i=r.width,n=r.height,o=r.bitrate,s=r.frameRate;if(i<0||n<0||o<0||s<0)throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:v_})})}},{key:"setRemoteVideoStreamType",value:function(e,t){switch(this.log_.info("setRemoteVideoStreamType: streamType=".concat(e.getType(),", set ").concat(t)),t){case"big":case"small":this.changeVideoType(e,t)}}},{key:"changeVideoType",value:function(e,t){if(!(e instanceof yA))throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:E_})});if(!e.getConnection())throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:e_})});var r=this.getRemoteMutedState().filter((function(t){return t.userId===e.getUserId()}))[0];if("small"===t&&r&&!r.hasSmall)throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:A_})});this.log_.info("change video type: streamType=".concat(e.getType(),", set ").concat(t));var i=e.getConnection().getTinyId(),n=1;"big"===t&&(n=0),this.signalChannel_.send(Og,{type:n,srctinyid:i})}},{key:"setIsEnableSmallStream",value:function(e){this.isEnableSmallStream_=e}},{key:"getIsEnableSmallStream",value:function(){return this.isEnableSmallStream_}},{key:"smallStreamConfig",get:function(){return this.smallStreamConfig_}},{key:"isPublished",value:function(){return!!this.localStream_}},{key:"getUplinkConnection",value:function(){return this.uplinkConnection_}},{key:"getLocalStream",value:function(){return this.localStream_}},{key:"getMode",value:function(){return this.mode_}},{key:"getBadCaseDetector",value:function(){return this.badCaseDetector_}},{key:"getCallDurationCalculator",value:function(){return this.callDurationCalculator_}},{key:"getIsJoined",value:function(){return this.isJoined_}},{key:"getAllConnections",value:function(){var e=A(this.connections_.values());return this.uplinkConnection_&&e.push(this.uplinkConnection_),e}},{key:"isRelayMaybeFailed",value:function(){var e=this.getAllConnections();if(0===e.length)return!1;for(var t=0;t<e.length;t++)if(e[t].getReconnectionCount()<6)return!1;return!0}},{key:"getUseStringRoomId",value:function(){return this.useStringRoomId_}},{key:"checkConnectionsToReconnect",value:function(){var e=this;this.getAllConnections().forEach((function(t){if(!t.getIsReconnecting()){var r=t.getPeerConnection();r&&r.connectionState===hl&&(e.log_.warn("[".concat(t.getUserId(),"] pc is closed but not reconnect")),t.startReconnection())}}))}},{key:"getEnableAutoPlayDialog",value:function(){return this.enableAutoPlayDialog_}}]),e}()).prototype,"join",[QA,WA],Object.getOwnPropertyDescriptor(iy.prototype,"join"),iy.prototype),T(iy.prototype,"leave",[qA],Object.getOwnPropertyDescriptor(iy.prototype,"leave"),iy.prototype),T(iy.prototype,"publish",[zA,ZA],Object.getOwnPropertyDescriptor(iy.prototype,"publish"),iy.prototype),T(iy.prototype,"unpublish",[YA,KA],Object.getOwnPropertyDescriptor(iy.prototype,"unpublish"),iy.prototype),T(iy.prototype,"subscribe",[$A],Object.getOwnPropertyDescriptor(iy.prototype,"subscribe"),iy.prototype),T(iy.prototype,"unsubscribe",[JA],Object.getOwnPropertyDescriptor(iy.prototype,"unsubscribe"),iy.prototype),T(iy.prototype,"switchRole",[XA,ey],Object.getOwnPropertyDescriptor(iy.prototype,"switchRole"),iy.prototype),T(iy.prototype,"startPublishCDNStream",[ty],Object.getOwnPropertyDescriptor(iy.prototype,"startPublishCDNStream"),iy.prototype),T(iy.prototype,"startMixTranscode",[ry],Object.getOwnPropertyDescriptor(iy.prototype,"startMixTranscode"),iy.prototype),iy),uy=yf({retryFunction:function(){var e=o(regeneratorRuntime.mark((function e(t){var r,i,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!qv()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,dy(t);case 4:if(r=e.sent,Tf.info("getUserMedia with constraints: "+JSON.stringify(r)),!r.audio){e.next=13;break}return e.next=9,wy.getMicrophones();case 9:if(i=e.sent,Tf.info("microphones: ".concat(JSON.stringify(i))),0!==i.length){e.next=13;break}throw new Vd({code:Fd.DEVICE_NOT_FOUND,message:uv({key:ov})});case 13:if(!r.video){e.next=20;break}return e.next=16,wy.getCameras();case 16:if(n=e.sent,Tf.info("cameras: ".concat(JSON.stringify(n))),0!==n.length){e.next=20;break}throw new Vd({code:Fd.DEVICE_NOT_FOUND,message:uv({key:sv})});case 20:return e.next=22,navigator.mediaDevices.getUserMedia(r);case 22:return e.abrupt("return",e.sent);case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),settings:{retries:3,timeout:500},onError:function(e,t,r){"NotReadableError"===e.name?t():r(e)},onRetrying:function(e){Tf.warn("getUserMedia NotReadableError observed, retrying [".concat(e,"/3]"))}});function dy(e){return hy.apply(this,arguments)}function hy(){return(hy=o(regeneratorRuntime.mark((function e(t){var i,n,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i={echoCancellation:t.echoCancellation,autoGainControl:t.autoGainControl,noiseSuppression:t.noiseSuppression},t.audio){e.next=5;break}i=!1,e.next=15;break;case 5:if(fm(t.microphoneId)){e.next=9;break}i=r({deviceId:{exact:t.microphoneId},sampleRate:t.sampleRate,channelCount:t.channelCount},i),e.next=15;break;case 9:return i=r({sampleRate:t.sampleRate,channelCount:t.channelCount},i),e.next=12,wy.getMicrophones();case 12:n=e.sent,(o=n.filter((function(e){return e.deviceId.length>0}))).length>0&&(i.deviceId={exact:o[0].deviceId});case 15:return s={},s=!Yd(t.facingMode)&&t.video?{facingMode:t.facingMode,width:t.width,height:t.height,frameRate:t.frameRate}:!fm(t.cameraId)&&t.video?{deviceId:{exact:t.cameraId},width:t.width,height:t.height,frameRate:t.frameRate}:!!t.video&&(!!Yd(t.width)||{width:t.width,height:t.height,frameRate:t.frameRate}),e.abrupt("return",{audio:i,video:s});case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var py=function(){var e=o(regeneratorRuntime.mark((function e(t){var r,i,n,o,s,a,c,l,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!qv()){e.next=2;break}return e.abrupt("return");case 2:if(r=null,!(Oc&&Nc<74||Pc)){e.next=27;break}return i=gy(t),Tf.info("getDisplayMedia with constraints: "+JSON.stringify(i)),e.next=8,navigator.mediaDevices.getDisplayMedia(i);case 8:if(n=e.sent,!t.screenAudio){e.next=14;break}return Tf.warn("Your browser not support capture system audio"),e.abrupt("return",n);case 14:if(!t.audio){e.next=24;break}return o=fy(t),Tf.info("getUserMedia with constraints: "+JSON.stringify(o)),e.next=19,navigator.mediaDevices.getUserMedia(o);case 19:return r=e.sent,n.addTrack(r.getAudioTracks()[0]),e.abrupt("return",n);case 24:return e.abrupt("return",n);case 25:e.next=53;break;case 27:if(!t.screenAudio){e.next=37;break}return t.audioConstraints={echoCancellation:!0,noiseSuppression:!0,sampleRate:44100},s=gy(t),Tf.info("getDisplayMedia with constraints: "+JSON.stringify(s)),e.next=33,navigator.mediaDevices.getDisplayMedia(s);case 33:return a=e.sent,e.abrupt("return",a);case 37:return c=gy(t),Tf.info("getDisplayMedia with constraints: "+JSON.stringify(c)),e.next=41,navigator.mediaDevices.getDisplayMedia(c);case 41:if(l=e.sent,!t.audio){e.next=52;break}return u=fy(t),Tf.info("getUserMedia with constraints: "+JSON.stringify(u)),e.next=47,navigator.mediaDevices.getUserMedia(u);case 47:return r=e.sent,l.addTrack(r.getAudioTracks()[0]),e.abrupt("return",l);case 52:return e.abrupt("return",l);case 53:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function fy(e){var t={echoCancellation:e.echoCancellation,autoGainControl:e.autoGainControl,noiseSuppression:e.noiseSuppression,sampleRate:e.sampleRate,channelCount:e.channelCount};return Yd(e.microphoneId)||(t.deviceId={exact:e.microphoneId}),{audio:t,video:!1}}function gy(e){var t={},r={width:e.width,height:e.height,frameRate:e.frameRate};return Yd(e.screenSource)||(r.displaySurface=e.screenSource),t.video=r,Yd(e.audioConstraints)||(t.audio=e.audioConstraints),t}var my=new Map;my.set("120p",{width:160,height:120,frameRate:15,bitrate:200}),my.set("180p",{width:320,height:180,frameRate:15,bitrate:350}),my.set("240p",{width:320,height:240,frameRate:15,bitrate:400}),my.set("360p",{width:640,height:360,frameRate:15,bitrate:800}),my.set("480p",{width:640,height:480,frameRate:15,bitrate:900}),my.set("720p",{width:1280,height:720,frameRate:15,bitrate:1500}),my.set("1080p",{width:1920,height:1080,frameRate:15,bitrate:2e3}),my.set("1440p",{width:2560,height:1440,frameRate:30,bitrate:4860}),my.set("4K",{width:3840,height:2160,frameRate:30,bitrate:9e3});var _y=new Map;_y.set("480p",{width:640,height:480,frameRate:5,bitrate:900}),_y.set("480p_2",{width:640,height:480,frameRate:30,bitrate:1e3}),_y.set("720p",{width:1280,height:720,frameRate:5,bitrate:1200}),_y.set("720p_2",{width:1280,height:720,frameRate:30,bitrate:3e3}),_y.set("1080p",{width:1920,height:1080,frameRate:5,bitrate:1600}),_y.set("1080p_2",{width:1920,height:1080,frameRate:30,bitrate:4e3});var vy,Ey,Ay=new Map;Ay.set("standard",{sampleRate:48e3,channelCount:1,bitrate:40}),Ay.set("standard-stereo",{sampleRate:48e3,channelCount:2,bitrate:64}),Ay.set("high",{sampleRate:48e3,channelCount:1,bitrate:128}),Ay.set("high-stereo",{sampleRate:48e3,channelCount:2,bitrate:192});var yy,Sy,Cy,Ty=(vy=_A.apply(void 0,A(gA.LOCAL_STREAM.switchDevice)),T((Ey=function(e){u(E,e);var t,n,a,l,h,p,f,g,m=_(E);function E(e){var t;s(this,E);var i=r(r({},e),{isRemote:!1,type:"local"});return e.screen&&(i.mirror=!1),(t=m.call(this,i)).name_=Cu,t.client_=null,t.video_=e.video,t.audio_=e.audio,t.cameraId_=e.cameraId,t.cameraGroupId_="",t.facingMode_=e.facingMode,t.microphoneId_=e.microphoneId,t.microphoneGroupId_="",t.videoSource_=e.videoSource,t.audioSource_=e.audioSource,t.screen_=e.screen,t.screenSource_=e.screenSource,t.screenAudio_=e.screenAudio,t.audioProfile_={echoCancellation:!!Yd(e.echoCancellation)||e.echoCancellation,autoGainControl:!!Yd(e.autoGainControl)||e.autoGainControl,noiseSuppression:!!Yd(e.noiseSuppression)||e.noiseSuppression,sampleRate:48e3,channelCount:1,bitrate:40},t.videoProfile_={width:640,height:480,frameRate:15,bitrate:900},t.screenProfile_={width:1920,height:1080,frameRate:5,bitrate:1600},t.videoBitrate_=t.screen_?1600:900,t.videoSetting_=null,t.mutedFlag_=0,t.beautyStatus_=!1,t.recoverCaptureCount_=0,t.initState(),t.canvas_=null,t.canvasInterval_=-1,t.log_.info("stream created: "+t.id_),t}return c(E,[{key:"initState",value:function(){this.isAddingTrack_=!1,this.isRemovingTrack_=!1,this.setIsReadyToPublish(!1),this.setPublishState(_u)}},{key:"installEvents",value:function(){v(d(E.prototype),"installEvents",this).call(this),gh.on(Gh,this.onStreamPublished,this),gh.on($h,this.onVideoTrackStopped,this),gh.on(qh,this.onVideoTrackStopped,this),gh.on(Xh,this.onAudioTrackStopped,this),gh.on(Jh,this.onAudioTrackStopped,this)}},{key:"uninstallEvents",value:function(){v(d(E.prototype),"uninstallEvents",this).call(this),gh.off(Gh,this.onStreamPublished,this),gh.off($h,this.onVideoTrackStopped,this),gh.off(qh,this.onVideoTrackStopped,this),gh.off(Xh,this.onAudioTrackStopped,this),gh.off(Jh,this.onAudioTrackStopped,this)}},{key:"initialize",value:function(){var e=this;return new Promise((function(t,r){if(zv())r(new Vd({code:Fd.INVALID_OPERATION,message:uv({key:J_})}));else{if(Yd(e.audio_)){var i=new MediaStream;return Yd(e.audioSource_)||(i.addTrack(e.audioSource_),e.updateAudioPlayingState(!0)),Yd(e.videoSource_)||(i.addTrack(e.videoSource_),e.updateVideoPlayingState(!0)),e.setMediaStream(i),jd.logSuccessEvent({userId:e.client_?e.client_.getUserId():e.userId_,eventType:Pl,kind:"custom"}),e.setIsReadyToPublish(!0),t()}e.screen_?(e.log_.info("initialize stream audio: "+e.audio_+" screenAudio: "+e.screenAudio_+" screen: "+e.screen_),py({audio:e.audio_,screenAudio:e.screenAudio_,microphoneId:e.microphoneId_,screenSource:e.screenSource_,width:e.screenProfile_.width,height:e.screenProfile_.height,frameRate:e.screenProfile_.frameRate,sampleRate:e.audioProfile_.sampleRate,channelCount:e.audioProfile_.channelCount,autoGainControl:e.audioProfile_.autoGainControl,noiseSuppression:e.audioProfile_.noiseSuppression,echoCancellation:e.audioProfile_.echoCancellation}).then((function(r){e.setMediaStream(r),e.updateAudioPlayingState(e.audio_||e.screenAudio_),e.updateVideoPlayingState(!0);var i=e.getVideoTrack();return e.listenForScreenSharingStopped(i),e.setVideoContentHint(hu),e.updateDeviceIdInUse(),e.setIsReadyToPublish(!0),e.log_.info(JSON.stringify(i.getSettings())),jd.logSuccessEvent({userId:e.client_?e.client_.getUserId():e.userId_,eventType:Pl,kind:"getDisplayMedia"}),t()})).catch((function(t){jd.logFailedEvent({userId:e.client_?e.client_.getUserId():e.userId_,eventType:Pl,kind:"getDisplayMedia",error:t}),e.log_.error("getDisplayMedia error observed "+t),r(t instanceof Vd?t:new Vd({code:Fd.INITIALIZE_FAILED,name:t.name,message:t.message}))}))):(gh.emit(Hh,{stream:e,audio:e.audio_,video:e.video_}),e.log_.info("initialize stream audio: "+e.audio_+" video: "+e.video_),uy({audio:e.audio_,video:e.video_,facingMode:e.facingMode_,cameraId:e.cameraId_,microphoneId:e.microphoneId_,width:e.videoProfile_.width,height:e.videoProfile_.height,frameRate:e.videoProfile_.frameRate,sampleRate:e.audioProfile_.sampleRate,channelCount:e.audioProfile_.channelCount,autoGainControl:e.audioProfile_.autoGainControl,noiseSuppression:e.audioProfile_.noiseSuppression,echoCancellation:e.audioProfile_.echoCancellation}).then((function(r){return gh.emit(Qh,{stream:e,audio:e.audio_,video:e.video_}),"getSettings"in MediaStreamTrack.prototype&&(e.videoSetting_=r.getVideoTracks().length>0&&r.getVideoTracks()[0].getSettings()),e.setMediaStream(r),e.updateAudioPlayingState(e.audio_),e.updateVideoPlayingState(e.video_),e.updateDeviceIdInUse(),e.log_.info("gotStream hasAudio: "+e.hasAudio()+" hasVideo: "+e.hasVideo()),e.setIsReadyToPublish(!0),jd.logSuccessEvent({userId:e.client_?e.client_.getUserId():e.userId_,eventType:Pl,kind:"getUserMedia"}),t()})).catch((function(t){gh.emit(Wh,{stream:e,audio:e.audio_,video:e.video_,error:t}),jd.logFailedEvent({userId:e.client_?e.client_.getUserId():e.userId_,eventType:Pl,kind:"getUserMedia",error:t}),e.log_.error("getUserMedia error observed "+t),r(t instanceof Vd?t:new Vd({code:Fd.INITIALIZE_FAILED,name:t.name,message:t.message}))})))}}))}},{key:"listenForScreenSharingStopped",value:function(e){var t=this;e.addEventListener("ended",(function(e){t.log_.info("screen sharing was stopped because the video track is ended"),t.emitter_.emit(CE)}))}},{key:"muteAudio",value:function(){var e=v(d(E.prototype),"muteAudio",this).call(this);return e&&(this.log_.info("localStream mute audio"),this.sendMutedFlag(Jl,!0)),e}},{key:"muteVideo",value:function(){var e=v(d(E.prototype),"muteVideo",this).call(this);return e&&(this.log_.info("localStream mute video"),this.sendMutedFlag(Xl,!0)),e}},{key:"unmuteAudio",value:function(){var e=v(d(E.prototype),"unmuteAudio",this).call(this);return e&&(this.log_.info("localStream unmute audio"),this.sendMutedFlag(Jl,!1)),e}},{key:"unmuteVideo",value:function(){var e=v(d(E.prototype),"unmuteVideo",this).call(this);return e&&(this.log_.info("localStream unmute video"),this.sendMutedFlag(Xl,!1)),e}},{key:"sendMutedFlag",value:function(e,t){this.setMutedFlag(e,t);var r=this.getConnection();if(r){r.sendMutedFlag(this.mutedFlag_);var i=r.getUserId(),n=r.getTinyId(),o="".concat(t?iu:nu," local ").concat(e," track");hm(i,{eventId:e===Jl?t?Mg:Bg:t?xg:Ug,eventDesc:o,timestamp:Es(),userId:i,tinyId:n})}}},{key:"setMutedFlag",value:function(e,t){e===Jl?t?this.mutedFlag_|=4:this.mutedFlag_&=-5:t?this.mutedFlag_|=1:this.mutedFlag_&=-2,this.log_.info("set ".concat(e," muted state: [").concat(t?iu:nu,"]"))}},{key:"setAudioProfile",value:function(e){var t;"object"===i(e)?t=e:void 0===(t=Ay.get(e))&&(t=Ay.get("standard")),this.log_.info("setAudioProfile: "+JSON.stringify(t)),this.audioProfile_=r(r({},this.audioProfile_),t)}},{key:"setVideoProfile",value:(g=o(regeneratorRuntime.mark((function e(t){var i,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.connection_||Wv()){e.next=2;break}throw new Vd({code:Fd.NOT_SUPPORTED,message:uv({key:ev})});case 2:if(qd(t)?i=r(r({},this.videoProfile_),t):Kd(t)&&(i=my.get(t),Yd(i)&&(i=my.get("480p"))),this.log_.info("setVideoProfile "+JSON.stringify(i)),!(n=this.getVideoTrack())){e.next=8;break}return e.next=8,n.applyConstraints(i);case 8:if(this.videoBitrate_===i.bitrate){e.next=13;break}if(!this.connection_){e.next=12;break}return e.next=12,this.connection_.setBandwidth(i.bitrate,Xl);case 12:this.videoBitrate_=i.bitrate;case 13:this.videoProfile_=i;case 14:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"getVideoBitrate",value:function(){return this.videoBitrate_}},{key:"getAudioBitrate",value:function(){return this.audioProfile_.bitrate}},{key:"setScreenProfile",value:function(e){var t=e;"object"!==i(e)&&void 0===(t=_y.get(e))&&(t=_y.get("1080p")),this.log_.info("setScreenProfile "+JSON.stringify(e)),this.screenProfile_=t,this.videoBitrate_=t.bitrate}},{key:"getVideoProfile",value:function(){return this.screen_?this.screenProfile_:this.videoProfile_}},{key:"getAudioProfile",value:function(){return this.audioProfile_}},{key:"setVideoContentHint",value:function(e){var t=this.getVideoTrack();t&&"contentHint"in t&&(this.log_.info("set video track contentHint to: "+e),t.contentHint=e,t.contentHint!==e&&this.log_.warn("Invalid video track contentHint: "+e))}},{key:"switchDevice",value:(f=o(regeneratorRuntime.mark((function e(t,r){var i,n,o,s,a,c,l,u,d,h,p,f,g,m,_,v,E;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=t===Jl)){e.next=8;break}if(this.microphoneId_!==r){e.next=4;break}return e.abrupt("return");case 4:this.microphoneId_=r,this.audio_=!0,e.next=12;break;case 8:if(this.cameraId_!==r){e.next=10;break}return e.abrupt("return");case 10:r===tu||r===ru?this.facingMode_=r:this.cameraId_=r,this.video_=!0;case 12:if(this.getMediaStream()){e.next=14;break}return e.abrupt("return");case 14:return this.setIsReadyToPublish(!1),this.log_.info("switchDevice "+t+" to: "+r),i||((n=this.getVideoTrack())&&n.stop(),Ac&&(o=this.getAudioTrack())&&(this.log_.info("stop audio track first in huawei env"),o.stop())),i&&(s=this.getAudioTrack(),a=this.getMicrophoneTrackMixed(),s&&s.stop(),a&&a.stop()),e.next=20,uy({audio:this.audio_&&t===Jl||Ac,video:this.video_&&t===Xl,facingMode:r===tu||r===ru?r:void 0,cameraId:this.cameraId_,microphoneId:this.microphoneId_,width:this.videoProfile_.width,height:this.videoProfile_.height,frameRate:this.videoProfile_.frameRate,sampleRate:this.audioProfile_.sampleRate,channelCount:this.audioProfile_.channelCount});case 20:if(c=e.sent,l=null,!i){e.next=27;break}(u=c.getAudioTracks()[0])&&this.isAudioTrackMixed()?(d=this.getAudioTrack(),h=wy.AudioMixerPlugin.getAudioTrackMap(),p=wy.AudioMixerPlugin.mix({targetTrack:u,sourceList:h.get(d.id).sourceList,trackList:h.get(d.id).trackList}),l=p):l=u,e.next=36;break;case 27:if(!(l=c.getVideoTracks()[0])||!this.isVideoTrackBeautified()){e.next=32;break}return e.next=31,this.generateBeautyTrack(l);case 31:l=e.sent;case 32:if(!(f=c.getAudioTracks()[0])||!Ac){e.next=36;break}return e.next=36,this.replaceTrack_(f);case 36:return e.next=38,this.replaceTrack_(l);case 38:this.updateDeviceIdInUse(),(g=this.getConnection())&&(m=g.getUserId(),_=g.getTinyId(),v=Gg,E="switch camera",i&&(v=Hg,E="switch microphone"),hm(m,{eventId:v,eventDesc:E,timestamp:Es(),userId:m,tinyId:_})),this.log_.info("switch ".concat(i?"microphone":"camera"," success ")),this.setIsReadyToPublish(!0);case 43:case"end":return e.stop()}}),e,this)}))),function(e,t){return f.apply(this,arguments)})},{key:"addTrack",value:(p=o(regeneratorRuntime.mark((function e(t){var r,i,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isAddingTrack_){e.next=2;break}throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:b_})});case 2:if(!this.isRemovingTrack_){e.next=4;break}throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:I_})});case 4:if(this.publishState_!==vu){e.next=6;break}throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:R_})});case 6:if(r=this.getMediaStream()){e.next=9;break}throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:w_})});case 9:if(!(t.kind===Jl&&r.getAudioTracks().length>0||t.kind===Xl&&r.getVideoTracks().length>0)){e.next=11;break}throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:k_})});case 11:if(t.kind===Xl&&"getSettings"in MediaStreamTrack.prototype&&(i=t.getSettings(),!this.videoSetting_||i.width===this.videoSetting_.width&&i.height===this.videoSetting_.height||this.log_.warn("video resolution of the track (".concat(i.width," x ").concat(i.height,") shall be kept the same as the previous: ").concat(this.videoSetting_.width," x ").concat(this.videoSetting_.height,". It may cause abnormal Cloud Recording."))),e.prev=12,this.isAddingTrack_=!0,this.keepMuteState(t),r.addTrack(t),!(n=this.getConnection())){e.next=20;break}return e.next=20,n.addTrack(t);case 20:t.kind===Jl?(this.audio_=!0,this.updateAudioPlayingState(!0)):(this.video_=!0,this.updateVideoPlayingState(!0)),this.isAddingTrack_=!1,e.next=29;break;case 24:throw e.prev=24,e.t0=e.catch(12),r.removeTrack(t),this.isAddingTrack_=!1,e.t0;case 29:case"end":return e.stop()}}),e,this,[[12,24]])}))),function(e){return p.apply(this,arguments)})},{key:"removeTrack",value:(h=o(regeneratorRuntime.mark((function e(t){var r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.kind!==Jl){e.next=2;break}throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:O_})});case 2:if(!this.isAddingTrack_){e.next=4;break}throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:N_})});case 4:if(!this.isRemovingTrack_){e.next=6;break}throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:L_})});case 6:if(this.publishState_!==vu){e.next=8;break}throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:P_})});case 8:if(r=this.getMediaStream()){e.next=11;break}throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:w_})});case 11:if(-1!==r.getTracks().indexOf(t)){e.next=13;break}throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:D_})});case 13:if(1!==r.getTracks().length){e.next=15;break}throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:M_})});case 15:if(e.prev=15,this.isRemovingTrack_=!0,!(i=this.getConnection())){e.next=21;break}return e.next=21,i.removeTrack(t);case 21:r.removeTrack(t),t.kind===Jl?(this.audio_=!1,this.updateAudioPlayingState(!1)):(this.video_=!1,this.updateVideoPlayingState(!1)),this.isRemovingTrack_=!1,e.next=30;break;case 26:throw e.prev=26,e.t0=e.catch(15),this.isRemovingTrack_=!1,e.t0;case 30:case"end":return e.stop()}}),e,this,[[15,26]])}))),function(e){return h.apply(this,arguments)})},{key:"replaceTrack",value:(l=o(regeneratorRuntime.mark((function e(t){var r,i,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.getMediaStream()){e.next=3;break}throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:T_})});case 3:if(this.publishState_!==vu){e.next=5;break}throw new Vd({code:Fd.INVALID_OPERATION,message:uv({key:C_})});case 5:if(!(t.kind===Jl&&r.getAudioTracks().length<=0||t.kind===Xl&&r.getVideoTracks().length<=0)){e.next=7;break}throw new Vd({code:Fd.INVALID_PARAMETER,message:uv({key:x_,data:t})});case 7:if(t.kind===Xl&&"getSettings"in MediaStreamTrack.prototype&&(i=t.getSettings(),!this.videoSetting_||i.width===this.videoSetting_.width&&i.height===this.videoSetting_.height||this.log_.warn("video resolution of the track (".concat(i.width," x ").concat(i.height,") shall be kept the same as the previous: ").concat(this.videoSetting_.width," x ").concat(this.videoSetting_.height,". It may cause abnormal Cloud Recording."))),this.keepMuteState(t),t.kind===Jl?(r.removeTrack(r.getAudioTracks()[0]),r.addTrack(t),v(d(E.prototype),"restartAudio",this).call(this)):(r.removeTrack(r.getVideoTracks()[0]),r.addTrack(t),v(d(E.prototype),"restartVideo",this).call(this)),!(n=this.getConnection())){e.next=14;break}return e.next=14,n.replaceTrack(t);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"updateStream",value:(a=o(regeneratorRuntime.mark((function e(t){var r,i,n,o,s,a,c,l,u,d,h,p,f,g,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mediaStream_){e.next=2;break}return e.abrupt("return");case 2:return this.log_.info("updateStream() try to recover local stream"),e.prev=3,e.next=6,wy.getCameras();case 6:return r=e.sent,e.next=9,wy.getMicrophones();case 9:if(i=e.sent,n=this.audio_&&t.audio,(o=this.video_&&t.video)&&0===r.length&&(o=!1,this.log_.info("updateStream() video flag is true, but no camera detected, set video to false")),n&&0===i.length&&(n=!1,this.log_.info("updateStream() audio flag is true, but no microphone detected, set audio to false")),!1!==n||!1!==o){e.next=17;break}return this.log_.info("updateStream() both audio and video are false, recover stream aborted"),e.abrupt("return");case 17:return s=t&&r.findIndex((function(e){return e.deviceId===t.cameraId}))>=0,a=t&&i.findIndex((function(e){return e.deviceId===t.microphoneId}))>=0,e.next=21,uy({audio:n,video:o,cameraId:s?t.cameraId:void 0,microphoneId:a?t.microphoneId:void 0,facingMode:this.facingMode_,width:this.videoProfile_.width,height:this.videoProfile_.height,frameRate:this.videoProfile_.frameRate,sampleRate:this.audioProfile_.sampleRate,channelCount:this.audioProfile_.channelCount});case 21:c=e.sent,l=c.getTracks(),u=0;case 24:if(!(u<l.length)){e.next=49;break}if((d=l[u]).kind!==Jl||!this.isAudioTrackMixed()){e.next=37;break}if(h=this.getAudioTrack(),p=wy.AudioMixerPlugin.getAudioTrackMap(),(f=p.get(h.id)).hasMicrophone){e.next=33;break}return d.stop(),e.abrupt("continue",46);case 33:return g=wy.AudioMixerPlugin.mix({targetTrack:d,sourceList:f.sourceList,trackList:f.trackList}),e.next=36,this.replaceTrack_(g);case 36:return e.abrupt("continue",46);case 37:if(d.kind!==Xl||!this.isVideoTrackBeautified()){e.next=44;break}return e.next=40,this.generateBeautyTrack(d);case 40:return m=e.sent,e.next=43,this.replaceTrack_(m);case 43:return e.abrupt("continue",46);case 44:return e.next=46,this.replaceTrack_(d);case 46:u++,e.next=24;break;case 49:this.updateDeviceIdInUse(),jd.logSuccessEvent({userId:this.client_?this.client_.getUserId():this.userId_,eventType:xl}),this.log_.info("updateStream() recover local stream successfully"),e.next=59;break;case 54:e.prev=54,e.t0=e.catch(3),jd.logFailedEvent({userId:this.client_?this.client_.getUserId():this.userId_,eventType:xl,error:e.t0}),this.log_.error("updateStream() failed to recover local stream, "+e.t0),this.emitter_.emit(bE,new Vd({code:Fd.DEVICE_AUTO_RECOVER_FAILED,message:e.t0.message}));case 59:case"end":return e.stop()}}),e,this,[[3,54]])}))),function(e){return a.apply(this,arguments)})},{key:"replaceTrack_",value:(n=o(regeneratorRuntime.mark((function e(t){var r,i,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.mediaStream_.getAudioTracks(),i=this.mediaStream_.getVideoTracks(),!(t.kind===Jl&&r.length<=0||t.kind===Xl&&i.length<=0)){e.next=5;break}return this.log_.info("there is no previous ".concat(t.kind," track, replacement ignored")),e.abrupt("return");case 5:if(this.keepMuteState(t),t.kind===Jl?(this.mediaStream_.removeTrack(r[0]),this.mediaStream_.addTrack(t),v(d(E.prototype),"restartAudio",this).call(this)):("getSettings"in MediaStreamTrack.prototype&&(n=t.getSettings(),!this.videoSetting_||n.width===this.videoSetting_.width&&n.height===this.videoSetting_.height||this.log_.warn("the resolution of video track to be replaced (".concat(n.width," x ").concat(n.height,") is different from the previous video settings (").concat(this.videoSetting_.width," x ").concat(this.videoSetting_.height,"). It may cause a cloud recording exception"))),this.mediaStream_.removeTrack(i[0]),this.mediaStream_.addTrack(t),v(d(E.prototype),"restartVideo",this).call(this)),!(o=this.getConnection())){e.next=11;break}return e.next=11,o.replaceTrack(t);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"updateDeviceIdInUse",value:function(){var e=this;if(!this.mediaStream_)return this.cameraId_="",this.cameraGroupId_="",this.microphoneId_="",void(this.microphoneGroupId_="");"getSettings"in MediaStreamTrack.prototype&&this.mediaStream_.getTracks().forEach((function(t){if(t.kind===Jl&&e.isAudioTrackMixed()){var r=e.getMicrophoneTrackMixed();if(r){var i=r.getSettings(),n=i.deviceId,o=i.groupId;n&&(e.microphoneId_=n,e.microphoneGroupId_=o)}}else if(t.kind===Xl&&e.isVideoTrackBeautified()){var s=e.getBeautyOriginTrack();if(s){var a=s.getSettings(),c=a.deviceId,l=a.groupId;c&&(e.cameraId_=c,e.cameraGroupId_=l)}}else{var u=t.getSettings(),d=u.deviceId,h=u.groupId;d&&(t.kind===Jl?(e.microphoneId_=d,e.microphoneGroupId_=h):t.kind!==Xl||e.screen_||(e.cameraId_=d,e.cameraGroupId_=h))}}));var t=this.mediaStream_.getAudioTracks(),r=this.mediaStream_.getVideoTracks();t&&0===t.length&&(this.microphoneId_="",this.microphoneGroupId_=""),r&&0===r.length&&(this.cameraId_="",this.cameraGroupId_="")}},{key:"isAudioTrackMixed",value:function(){if(wy.AudioMixerPlugin){var e=wy.AudioMixerPlugin.getAudioTrackMap(),t=this.getAudioTrack();if(e&&t&&e.has(t.id))return!0}return!1}},{key:"getMicrophoneTrackMixed",value:function(){if(wy.AudioMixerPlugin){var e=wy.AudioMixerPlugin.getAudioTrackMap(),t=this.getAudioTrack();if(e&&t&&e.has(t.id)){var r=e.get(t.id);return r.hasMicrophone?r.microphoneTrack:null}}return null}},{key:"isVideoTrackBeautified",value:function(){if(wy.beautyTrackMap){var e=wy.beautyTrackMap,t=this.getVideoTrack();if(t&&e.has(t.id))return!0}return!1}},{key:"getBeautyOriginTrack",value:function(){if(wy.beautyTrackMap){var e=wy.beautyTrackMap,t=this.getVideoTrack();if(t&&e.has(t.id)){var r=e.get(t.id);if(r.originTrack)return r.originTrack}}return null}},{key:"generateBeautyTrack",value:(t=o(regeneratorRuntime.mark((function e(t){var r,i,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null,i=this.getVideoTrack(),n=wy.beautyTrackMap.get(i.id),o=n.param,n.type){e.next=8;break}r=n.pluginInstance.generateBeautyTrack(t),e.next=22;break;case 8:e.t0=n.type,e.next="beauty"===e.t0?11:"virtual"===e.t0?13:"mixed"===e.t0?17:21;break;case 11:return r=n.pluginInstance.generateBeautyTrack(t),e.abrupt("break",22);case 13:return e.next=15,n.pluginInstance.generateVirtualTrack({videoTrack:t,type:o.type,img:o.img});case 15:return r=e.sent,e.abrupt("break",22);case 17:return e.next=19,n.pluginInstance.generateMixedTrack({videoTrack:t,type:o.type,img:o.img});case 19:return r=e.sent,e.abrupt("break",22);case 21:return e.abrupt("break",22);case 22:return n.pluginInstance.deleteSource(i.id),this.log_.info("regenerate beauty track, track id = ".concat(t.id)),e.abrupt("return",r);case 25:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getScreen",value:function(){return this.screen_}},{key:"hasScreenTrack",value:function(){if(this.screen_)return!0;var e=this.getVideoTrack();return!!e&&(e.contentHint===hu||e.contentHint===pu)}},{key:"getVideo",value:function(){return this.video_}},{key:"getAudio",value:function(){return this.audio_}},{key:"getCameraId",value:function(){return this.cameraId_}},{key:"getMicrophoneId",value:function(){return this.microphoneId_}},{key:"getMicrophoneGroupId",value:function(){return this.microphoneGroupId_}},{key:"getIsReadyToPublish",value:function(){return this.isReadyToPublish_}},{key:"setIsReadyToPublish",value:function(e){this.isReadyToPublish_=e}},{key:"setPublishState",value:function(e){this.publishState_=e}},{key:"setBeautyStatus",value:function(e){this.beautyStatus_=!!e}},{key:"getBeautyStatus",value:function(){return this.beautyStatus_}},{key:"onStreamPublished",value:function(e){var t=e.localStream,r=e.client;if(t===this){this.client_=r,this.log_.setUserId(r.getUserId()),this.log_.setSdkAppId(r.getSDKAppId());var i=this.getAudioTrack(),n=this.getVideoTrack();if(i){var o=!i.enabled;this.setMutedFlag(Jl,o)}if(n){var s=!n.enabled;this.setMutedFlag(Xl,s)}this.connection_&&this.connection_.sendMutedFlag(this.mutedFlag_)}}},{key:"keepMuteState",value:function(e){e instanceof MediaStreamTrack&&this.mutedFlag_&(e.kind===Xl?1:4)&&(e.enabled=!1,this.log_.warn("prev ".concat(e.kind," track is muted, keep mute state")))}},{key:"onVideoTrackStopped",value:function(e){var t=e.stream,r=e.type;t!==this||!this.video_||!this.cameraId_||this.recoverCaptureCount_>10||(Va||ja)&&r===iu||(this.recoverCaptureCount_+=1,jd.uploadEvent({log:"stat-local-video-".concat(r),userId:this.userId_}),this.updateStream({audio:!1,video:!0,cameraId:this.cameraId_}))}},{key:"onAudioTrackStopped",value:function(e){var t=e.stream,r=e.type;t!==this||!this.audio_||!this.microphoneId_||this.recoverCaptureCount_>10||(Va||ja)&&r===iu||(this.recoverCaptureCount_+=1,jd.uploadEvent({log:"stat-local-audio-".concat(r),userId:this.userId_}),this.updateStream({audio:!0,video:!1,microphoneId:this.microphoneId_}))}},{key:"setAudioVolume",value:function(e){v(d(E.prototype),"setAudioVolume",this).call(this,e)}},{key:"clearCanvas",value:function(){this.canvasInterval_&&(wv.clearInterval(this.canvasInterval_),this.canvasInterval_=-1,this.canvas_=null)}},{key:"genCanvasTrack",value:function(e){var t=this;this.log_.info("gen canvas track");var r=e.getSettings(),i=r.width,n=r.height,o=r.frameRate;this.canvas_=document.createElement("canvas");var s=this.canvas_.getContext("2d");return this.canvas_.width=i,this.canvas_.height=n,this.canvasInterval_=wv.setInterval((function(){if(t.hasVideo()){var e=t.getVideoTrack().getSettings();e.width===t.canvas_.width&&e.height===t.canvas_.height||(t.canvas_.width=e.width,t.canvas_.height=e.height)}t.videoPlayer_&&t.videoPlayer_.element_&&s.drawImage(t.videoPlayer_.element_,0,0,t.canvas_.width,t.canvas_.height)}),Math.max(66,Math.floor(1e3/o))),this.canvas_.captureStream().getVideoTracks()[0]}}]),E}(AA)).prototype,"switchDevice",[vy],Object.getOwnPropertyDescriptor(Ey.prototype,"switchDevice"),Ey.prototype),Ey),by=0,Iy=0,Ry=(yy=mA(gA.TRTC.createClient),Sy=mA(gA.TRTC.createStream),T((Cy=function(){function e(){s(this,e),this.name_=yu,this.VERSION="4.11.12",this.Logger={loggerManager:Tf,LogLevel:{TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,NONE:5},setLogLevel:function(e){Tf.setLogLevel(e),hh()&&e<=1&&lv()},enableUploadLog:function(){Tf.enableUploadLog()},disableUploadLog:function(){Tf.disableUploadLog()}}}var t,i,n,a,l;return c(e,[{key:"checkSystemRequirements",value:(l=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Uv();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(){return l.apply(this,arguments)})},{key:"isScreenShareSupported",value:function(){return Vv()}},{key:"isSmallStreamSupported",value:function(){return eE()}},{key:"getDevices",value:(a=o(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!zv()&&!qv()){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,navigator.mediaDevices.enumerateDevices();case 4:return t=e.sent,e.abrupt("return",t.filter((function(e){return e.kind!==uu||"communications"!=e.deviceId})).map((function(e,t){var r=e.label;e.label||(r=e.kind+"_"+t);var i={label:r,deviceId:e.deviceId,kind:e.kind};return e.groupId&&(i.groupId=e.groupId),i})));case 6:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},{key:"getCameras",value:(n=o(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!zv()&&!qv()){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,navigator.mediaDevices.enumerateDevices();case 4:return t=e.sent,e.abrupt("return",t.filter((function(e){return e.kind===du})).map((function(e,t){var r=e.label;e.label||(r="camera_"+t);var i={label:r,deviceId:e.deviceId,kind:e.kind};return e.groupId&&(i.groupId=e.groupId),i})));case 6:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"getMicrophones",value:(i=o(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!zv()&&!qv()){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,navigator.mediaDevices.enumerateDevices();case 4:return t=e.sent,e.abrupt("return",t.filter((function(e){return e.kind===uu&&"communications"!==e.deviceId})).map((function(e,t){var r=e.label;e.label||(r="microphone_"+t);var i={label:r,deviceId:e.deviceId,kind:e.kind};return e.groupId&&(i.groupId=e.groupId),i})));case 6:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)})},{key:"getSpeakers",value:(t=o(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!zv()&&!qv()){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,navigator.mediaDevices.enumerateDevices();case 4:return t=e.sent,e.abrupt("return",t.filter((function(e){return"audiooutput"===e.kind})).map((function(e,t){var r=e.label;e.label||(r="speaker_"+t);var i={label:r,deviceId:e.deviceId,kind:e.kind};return e.groupId&&(i.groupId=e.groupId),i})));case 6:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"createClient",value:function(e){bf&&(bf=!1,Tf.getLogLevel()!=wy.Logger.LogLevel.NONE&&(console.info("******************************************************************************"),console.info("*   TRTC Web SDK"),console.info("*   API Document: "+"".concat(Ru,"index.html")),console.info("*   Changelog: https://cloud.tencent.com/document/product/647/38958"),console.info("*   Report issues: https://github.com/tencentyun/TRTCSDK/issues"),console.info("******************************************************************************")),Tf.info("TRTC Web SDK Version: 4.11.12"),Tf.info("UserAgent: "+navigator.userAgent),Tf.info("URL of current page: "+location.href));var t={version:this.VERSION},i=new ly(r(r(r({},t),e),{},{seq:++by}));return gh.emit(kh,{client:i}),i}},{key:"createStream",value:function(e){return new Ty(r(r({},e),{},{seq:++Iy}))}}]),e}()).prototype,"createClient",[yy],Object.getOwnPropertyDescriptor(Cy.prototype,"createClient"),Cy.prototype),T(Cy.prototype,"createStream",[Sy],Object.getOwnPropertyDescriptor(Cy.prototype,"createStream"),Cy.prototype),Cy);zv();var wy=new Ry;return wy}))}).call(this,r("c8ba"))},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,r){var i=r("e330"),n=r("1d80"),o=r("577e"),s=r("5899"),a=i("".replace),c="["+s+"]",l=RegExp("^"+c+c+"*"),u=RegExp(c+c+"*$"),d=function(e){return function(t){var r=o(n(t));return 1&e&&(r=a(r,l,"")),2&e&&(r=a(r,u,"")),r}};e.exports={start:d(1),end:d(2),trim:d(3)}},5924:function(e,t,r){"use strict";t.__esModule=!0,t.isInContainer=t.getScrollContainer=t.isScroll=t.getStyle=t.once=t.off=t.on=void 0;var i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.hasClass=g,t.addClass=m,t.removeClass=_,t.setStyle=E;var n=r("2b0e"),o=s(n);function s(e){return e&&e.__esModule?e:{default:e}}var a=o.default.prototype.$isServer,c=/([\:\-\_]+(.))/g,l=/^moz([A-Z])/,u=a?0:Number(document.documentMode),d=function(e){return(e||"").replace(/^[\s\uFEFF]+|[\s\uFEFF]+$/g,"")},h=function(e){return e.replace(c,(function(e,t,r,i){return i?r.toUpperCase():r})).replace(l,"Moz$1")},p=t.on=function(){return!a&&document.addEventListener?function(e,t,r){e&&t&&r&&e.addEventListener(t,r,!1)}:function(e,t,r){e&&t&&r&&e.attachEvent("on"+t,r)}}(),f=t.off=function(){return!a&&document.removeEventListener?function(e,t,r){e&&t&&e.removeEventListener(t,r,!1)}:function(e,t,r){e&&t&&e.detachEvent("on"+t,r)}}();t.once=function(e,t,r){var i=function i(){r&&r.apply(this,arguments),f(e,t,i)};p(e,t,i)};function g(e,t){if(!e||!t)return!1;if(-1!==t.indexOf(" "))throw new Error("className should not contain space.");return e.classList?e.classList.contains(t):(" "+e.className+" ").indexOf(" "+t+" ")>-1}function m(e,t){if(e){for(var r=e.className,i=(t||"").split(" "),n=0,o=i.length;n<o;n++){var s=i[n];s&&(e.classList?e.classList.add(s):g(e,s)||(r+=" "+s))}e.classList||e.setAttribute("class",r)}}function _(e,t){if(e&&t){for(var r=t.split(" "),i=" "+e.className+" ",n=0,o=r.length;n<o;n++){var s=r[n];s&&(e.classList?e.classList.remove(s):g(e,s)&&(i=i.replace(" "+s+" "," ")))}e.classList||e.setAttribute("class",d(i))}}var v=t.getStyle=u<9?function(e,t){if(!a){if(!e||!t)return null;t=h(t),"float"===t&&(t="styleFloat");try{switch(t){case"opacity":try{return e.filters.item("alpha").opacity/100}catch(r){return 1}default:return e.style[t]||e.currentStyle?e.currentStyle[t]:null}}catch(r){return e.style[t]}}}:function(e,t){if(!a){if(!e||!t)return null;t=h(t),"float"===t&&(t="cssFloat");try{var r=document.defaultView.getComputedStyle(e,"");return e.style[t]||r?r[t]:null}catch(i){return e.style[t]}}};function E(e,t,r){if(e&&t)if("object"===("undefined"===typeof t?"undefined":i(t)))for(var n in t)t.hasOwnProperty(n)&&E(e,n,t[n]);else t=h(t),"opacity"===t&&u<9?e.style.filter=isNaN(r)?"":"alpha(opacity="+100*r+")":e.style[t]=r}var A=t.isScroll=function(e,t){if(!a){var r=null!==t&&void 0!==t,i=v(e,r?t?"overflow-y":"overflow-x":"overflow");return i.match(/(scroll|auto|overlay)/)}};t.getScrollContainer=function(e,t){if(!a){var r=e;while(r){if([window,document,document.documentElement].includes(r))return window;if(A(r,t))return r;r=r.parentNode}return r}},t.isInContainer=function(e,t){if(a||!e||!t)return!1;var r=e.getBoundingClientRect(),i=void 0;return i=[window,document,document.documentElement,null,void 0].includes(t)?{top:0,right:window.innerWidth,bottom:window.innerHeight,left:0}:t.getBoundingClientRect(),r.top<i.bottom&&r.bottom>i.top&&r.right>i.left&&r.left<i.right}},5926:function(e,t){var r=Math.ceil,i=Math.floor;e.exports=function(e){var t=+e;return t!==t||0===t?0:(t>0?i:r)(t)}},"597f":function(e,t){e.exports=function(e,t,r,i){var n,o=0;function s(){var s=this,a=Number(new Date)-o,c=arguments;function l(){o=Number(new Date),r.apply(s,c)}function u(){n=void 0}i&&!n&&l(),n&&clearTimeout(n),void 0===i&&a>e?l():!0!==t&&(n=setTimeout(i?u:l,void 0===i?e-a:e))}return"boolean"!==typeof t&&(i=r,r=t,t=void 0),s}},"59ed":function(e,t,r){var i=r("da84"),n=r("1626"),o=r("0d51"),s=i.TypeError;e.exports=function(e){if(n(e))return e;throw s(o(e)+" is not a function")}},"5a0c":function(e,t,r){!function(t,r){e.exports=r()}(0,(function(){"use strict";var e=1e3,t=6e4,r=36e5,i="millisecond",n="second",o="minute",s="hour",a="day",c="week",l="month",u="quarter",d="year",h="date",p="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,g=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,m={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},_=function(e,t,r){var i=String(e);return!i||i.length>=t?e:""+Array(t+1-i.length).join(r)+e},v={s:_,z:function(e){var t=-e.utcOffset(),r=Math.abs(t),i=Math.floor(r/60),n=r%60;return(t<=0?"+":"-")+_(i,2,"0")+":"+_(n,2,"0")},m:function e(t,r){if(t.date()<r.date())return-e(r,t);var i=12*(r.year()-t.year())+(r.month()-t.month()),n=t.clone().add(i,l),o=r-n<0,s=t.clone().add(i+(o?-1:1),l);return+(-(i+(r-n)/(o?n-s:s-n))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:l,y:d,w:c,d:a,D:h,h:s,m:o,s:n,ms:i,Q:u}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},E="en",A={};A[E]=m;var y=function(e){return e instanceof b},S=function(e,t,r){var i;if(!e)return E;if("string"==typeof e)A[e]&&(i=e),t&&(A[e]=t,i=e);else{var n=e.name;A[n]=e,i=n}return!r&&i&&(E=i),i||!r&&E},C=function(e,t){if(y(e))return e.clone();var r="object"==typeof t?t:{};return r.date=e,r.args=arguments,new b(r)},T=v;T.l=S,T.i=y,T.w=function(e,t){return C(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var b=function(){function m(e){this.$L=S(e.locale,null,!0),this.parse(e)}var _=m.prototype;return _.parse=function(e){this.$d=function(e){var t=e.date,r=e.utc;if(null===t)return new Date(NaN);if(T.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var i=t.match(f);if(i){var n=i[2]-1||0,o=(i[7]||"0").substring(0,3);return r?new Date(Date.UTC(i[1],n,i[3]||1,i[4]||0,i[5]||0,i[6]||0,o)):new Date(i[1],n,i[3]||1,i[4]||0,i[5]||0,i[6]||0,o)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},_.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},_.$utils=function(){return T},_.isValid=function(){return!(this.$d.toString()===p)},_.isSame=function(e,t){var r=C(e);return this.startOf(t)<=r&&r<=this.endOf(t)},_.isAfter=function(e,t){return C(e)<this.startOf(t)},_.isBefore=function(e,t){return this.endOf(t)<C(e)},_.$g=function(e,t,r){return T.u(e)?this[t]:this.set(r,e)},_.unix=function(){return Math.floor(this.valueOf()/1e3)},_.valueOf=function(){return this.$d.getTime()},_.startOf=function(e,t){var r=this,i=!!T.u(t)||t,u=T.p(e),p=function(e,t){var n=T.w(r.$u?Date.UTC(r.$y,t,e):new Date(r.$y,t,e),r);return i?n:n.endOf(a)},f=function(e,t){return T.w(r.toDate()[e].apply(r.toDate("s"),(i?[0,0,0,0]:[23,59,59,999]).slice(t)),r)},g=this.$W,m=this.$M,_=this.$D,v="set"+(this.$u?"UTC":"");switch(u){case d:return i?p(1,0):p(31,11);case l:return i?p(1,m):p(0,m+1);case c:var E=this.$locale().weekStart||0,A=(g<E?g+7:g)-E;return p(i?_-A:_+(6-A),m);case a:case h:return f(v+"Hours",0);case s:return f(v+"Minutes",1);case o:return f(v+"Seconds",2);case n:return f(v+"Milliseconds",3);default:return this.clone()}},_.endOf=function(e){return this.startOf(e,!1)},_.$set=function(e,t){var r,c=T.p(e),u="set"+(this.$u?"UTC":""),p=(r={},r[a]=u+"Date",r[h]=u+"Date",r[l]=u+"Month",r[d]=u+"FullYear",r[s]=u+"Hours",r[o]=u+"Minutes",r[n]=u+"Seconds",r[i]=u+"Milliseconds",r)[c],f=c===a?this.$D+(t-this.$W):t;if(c===l||c===d){var g=this.clone().set(h,1);g.$d[p](f),g.init(),this.$d=g.set(h,Math.min(this.$D,g.daysInMonth())).$d}else p&&this.$d[p](f);return this.init(),this},_.set=function(e,t){return this.clone().$set(e,t)},_.get=function(e){return this[T.p(e)]()},_.add=function(i,u){var h,p=this;i=Number(i);var f=T.p(u),g=function(e){var t=C(p);return T.w(t.date(t.date()+Math.round(e*i)),p)};if(f===l)return this.set(l,this.$M+i);if(f===d)return this.set(d,this.$y+i);if(f===a)return g(1);if(f===c)return g(7);var m=(h={},h[o]=t,h[s]=r,h[n]=e,h)[f]||1,_=this.$d.getTime()+i*m;return T.w(_,this)},_.subtract=function(e,t){return this.add(-1*e,t)},_.format=function(e){var t=this,r=this.$locale();if(!this.isValid())return r.invalidDate||p;var i=e||"YYYY-MM-DDTHH:mm:ssZ",n=T.z(this),o=this.$H,s=this.$m,a=this.$M,c=r.weekdays,l=r.months,u=function(e,r,n,o){return e&&(e[r]||e(t,i))||n[r].substr(0,o)},d=function(e){return T.s(o%12||12,e,"0")},h=r.meridiem||function(e,t,r){var i=e<12?"AM":"PM";return r?i.toLowerCase():i},f={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:T.s(a+1,2,"0"),MMM:u(r.monthsShort,a,l,3),MMMM:u(l,a),D:this.$D,DD:T.s(this.$D,2,"0"),d:String(this.$W),dd:u(r.weekdaysMin,this.$W,c,2),ddd:u(r.weekdaysShort,this.$W,c,3),dddd:c[this.$W],H:String(o),HH:T.s(o,2,"0"),h:d(1),hh:d(2),a:h(o,s,!0),A:h(o,s,!1),m:String(s),mm:T.s(s,2,"0"),s:String(this.$s),ss:T.s(this.$s,2,"0"),SSS:T.s(this.$ms,3,"0"),Z:n};return i.replace(g,(function(e,t){return t||f[e]||n.replace(":","")}))},_.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},_.diff=function(i,h,p){var f,g=T.p(h),m=C(i),_=(m.utcOffset()-this.utcOffset())*t,v=this-m,E=T.m(this,m);return E=(f={},f[d]=E/12,f[l]=E,f[u]=E/3,f[c]=(v-_)/6048e5,f[a]=(v-_)/864e5,f[s]=v/r,f[o]=v/t,f[n]=v/e,f)[g]||v,p?E:T.a(E)},_.daysInMonth=function(){return this.endOf(l).$D},_.$locale=function(){return A[this.$L]},_.locale=function(e,t){if(!e)return this.$L;var r=this.clone(),i=S(e,t,!0);return i&&(r.$L=i),r},_.clone=function(){return T.w(this.$d,this)},_.toDate=function(){return new Date(this.valueOf())},_.toJSON=function(){return this.isValid()?this.toISOString():null},_.toISOString=function(){return this.$d.toISOString()},_.toString=function(){return this.$d.toUTCString()},m}(),I=b.prototype;return C.prototype=I,[["$ms",i],["$s",n],["$m",o],["$H",s],["$W",a],["$M",l],["$y",d],["$D",h]].forEach((function(e){I[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),C.extend=function(e,t){return e.$i||(e(t,b,C),e.$i=!0),C},C.locale=S,C.isDayjs=y,C.unix=function(e){return C(1e3*e)},C.en=A[E],C.Ls=A,C.p={},C}))},"5a34":function(e,t,r){var i=r("da84"),n=r("44e7"),o=i.TypeError;e.exports=function(e){if(n(e))throw o("The method doesn't accept regular expressions");return e}},"5a94":function(e,t,r){var i=r("b367")("keys"),n=r("8b1a");e.exports=function(e){return i[e]||(i[e]=n(e))}},"5c6c":function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},"5c96":function(e,t,r){e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=45)}([function(e,t){e.exports=r("d940")},function(e,t){e.exports=r("5924")},function(e,t){e.exports=r("8122")},function(e,t){e.exports=r("d010")},function(e,t){e.exports=r("6b7c")},function(e,t){e.exports=r("e974")},function(e,t){e.exports=r("2b0e")},function(e,t){e.exports=r("7f4d")},function(e,t){e.exports=r("f3ad")},function(e,t){e.exports=r("2bb5")},function(e,t){e.exports=r("417f")},function(e,t){e.exports=r("5128")},function(e,t){e.exports=r("4897")},function(e,t){e.exports=r("eedf")},function(e,t){e.exports=r("4010")},function(e,t){e.exports=r("a742")},function(e,t){e.exports=r("0e15")},function(e,t){e.exports=r("dcdc")},function(e,t){e.exports=r("14e9")},function(e,t){e.exports=r("d397")},function(e,t){e.exports=r("d7d1")},function(e,t){e.exports=r("5488")},function(e,t){e.exports=r("41f8")},function(e,t){e.exports=r("12f2")},function(e,t){e.exports=r("92fa")},function(e,t){e.exports=r("597f")},function(e,t){e.exports=r("299c")},function(e,t){e.exports=r("2a5e")},function(e,t){e.exports=r("845f")},function(e,t){e.exports=r("8bbc")},function(e,t){e.exports=r("e62d")},function(e,t){e.exports=r("7fc1")},function(e,t){e.exports=r("c56a")},function(e,t){e.exports=r("c284")},function(e,t){e.exports=r("e452")},function(e,t){e.exports=r("9619")},function(e,t){e.exports=r("4e4b")},function(e,t){e.exports=r("e772")},function(e,t){e.exports=r("c098")},function(e,t){e.exports=r("722f")},function(e,t){e.exports=r("a15e")},function(e,t){e.exports=r("e450")},function(e,t){e.exports=r("4726")},function(e,t){e.exports=r("f494")},function(e,t){e.exports=r("6ac9")},function(e,t,r){e.exports=r(46)},function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ul",{staticClass:"el-pager",on:{click:e.onPagerClick}},[e.pageCount>0?r("li",{staticClass:"number",class:{active:1===e.currentPage,disabled:e.disabled}},[e._v("1")]):e._e(),e.showPrevMore?r("li",{staticClass:"el-icon more btn-quickprev",class:[e.quickprevIconClass,{disabled:e.disabled}],on:{mouseenter:function(t){e.onMouseenter("left")},mouseleave:function(t){e.quickprevIconClass="el-icon-more"}}}):e._e(),e._l(e.pagers,(function(t){return r("li",{key:t,staticClass:"number",class:{active:e.currentPage===t,disabled:e.disabled}},[e._v(e._s(t))])})),e.showNextMore?r("li",{staticClass:"el-icon more btn-quicknext",class:[e.quicknextIconClass,{disabled:e.disabled}],on:{mouseenter:function(t){e.onMouseenter("right")},mouseleave:function(t){e.quicknextIconClass="el-icon-more"}}}):e._e(),e.pageCount>1?r("li",{staticClass:"number",class:{active:e.currentPage===e.pageCount,disabled:e.disabled}},[e._v(e._s(e.pageCount))]):e._e()],2)},n=[];i._withStripped=!0;var o={name:"ElPager",props:{currentPage:Number,pageCount:Number,pagerCount:Number,disabled:Boolean},watch:{showPrevMore:function(e){e||(this.quickprevIconClass="el-icon-more")},showNextMore:function(e){e||(this.quicknextIconClass="el-icon-more")}},methods:{onPagerClick:function(e){var t=e.target;if("UL"!==t.tagName&&!this.disabled){var r=Number(e.target.textContent),i=this.pageCount,n=this.currentPage,o=this.pagerCount-2;-1!==t.className.indexOf("more")&&(-1!==t.className.indexOf("quickprev")?r=n-o:-1!==t.className.indexOf("quicknext")&&(r=n+o)),isNaN(r)||(r<1&&(r=1),r>i&&(r=i)),r!==n&&this.$emit("change",r)}},onMouseenter:function(e){this.disabled||("left"===e?this.quickprevIconClass="el-icon-d-arrow-left":this.quicknextIconClass="el-icon-d-arrow-right")}},computed:{pagers:function(){var e=this.pagerCount,t=(e-1)/2,r=Number(this.currentPage),i=Number(this.pageCount),n=!1,o=!1;i>e&&(r>e-t&&(n=!0),r<i-t&&(o=!0));var s=[];if(n&&!o)for(var a=i-(e-2),c=a;c<i;c++)s.push(c);else if(!n&&o)for(var l=2;l<e;l++)s.push(l);else if(n&&o)for(var u=Math.floor(e/2)-1,d=r-u;d<=r+u;d++)s.push(d);else for(var h=2;h<i;h++)s.push(h);return this.showPrevMore=n,this.showNextMore=o,s}},data:function(){return{current:null,showPrevMore:!1,showNextMore:!1,quicknextIconClass:"el-icon-more",quickprevIconClass:"el-icon-more"}}},s=o;function a(e,t,r,i,n,o,s,a){var c,l="function"===typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=r,l._compiled=!0),i&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),s?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},l._ssrRegister=c):n&&(c=a?function(){n.call(this,this.$root.$options.shadowRoot)}:n),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(e,t){return c.call(t),u(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,c):[c]}return{exports:e,options:l}}var c=a(s,i,n,!1,null,null,null);c.options.__file="packages/pagination/src/pager.vue";var l=c.exports,u=r(36),d=r.n(u),h=r(37),p=r.n(h),f=r(8),g=r.n(f),m=r(4),_=r.n(m),v=r(2),E={name:"ElPagination",props:{pageSize:{type:Number,default:10},small:Boolean,total:Number,pageCount:Number,pagerCount:{type:Number,validator:function(e){return(0|e)===e&&e>4&&e<22&&e%2===1},default:7},currentPage:{type:Number,default:1},layout:{default:"prev, pager, next, jumper, ->, total"},pageSizes:{type:Array,default:function(){return[10,20,30,40,50,100]}},popperClass:String,prevText:String,nextText:String,background:Boolean,disabled:Boolean,hideOnSinglePage:Boolean},data:function(){return{internalCurrentPage:1,internalPageSize:0,lastEmittedPage:-1,userChangePageSize:!1}},render:function(e){var t=this.layout;if(!t)return null;if(this.hideOnSinglePage&&(!this.internalPageCount||1===this.internalPageCount))return null;var r=e("div",{class:["el-pagination",{"is-background":this.background,"el-pagination--small":this.small}]}),i={prev:e("prev"),jumper:e("jumper"),pager:e("pager",{attrs:{currentPage:this.internalCurrentPage,pageCount:this.internalPageCount,pagerCount:this.pagerCount,disabled:this.disabled},on:{change:this.handleCurrentChange}}),next:e("next"),sizes:e("sizes",{attrs:{pageSizes:this.pageSizes}}),slot:e("slot",[this.$slots.default?this.$slots.default:""]),total:e("total")},n=t.split(",").map((function(e){return e.trim()})),o=e("div",{class:"el-pagination__rightwrapper"}),s=!1;return r.children=r.children||[],o.children=o.children||[],n.forEach((function(e){"->"!==e?s?o.children.push(i[e]):r.children.push(i[e]):s=!0})),s&&r.children.unshift(o),r},components:{Prev:{render:function(e){return e("button",{attrs:{type:"button",disabled:this.$parent.disabled||this.$parent.internalCurrentPage<=1},class:"btn-prev",on:{click:this.$parent.prev}},[this.$parent.prevText?e("span",[this.$parent.prevText]):e("i",{class:"el-icon el-icon-arrow-left"})])}},Next:{render:function(e){return e("button",{attrs:{type:"button",disabled:this.$parent.disabled||this.$parent.internalCurrentPage===this.$parent.internalPageCount||0===this.$parent.internalPageCount},class:"btn-next",on:{click:this.$parent.next}},[this.$parent.nextText?e("span",[this.$parent.nextText]):e("i",{class:"el-icon el-icon-arrow-right"})])}},Sizes:{mixins:[_.a],props:{pageSizes:Array},watch:{pageSizes:{immediate:!0,handler:function(e,t){Object(v["valueEquals"])(e,t)||Array.isArray(e)&&(this.$parent.internalPageSize=e.indexOf(this.$parent.pageSize)>-1?this.$parent.pageSize:this.pageSizes[0])}}},render:function(e){var t=this;return e("span",{class:"el-pagination__sizes"},[e("el-select",{attrs:{value:this.$parent.internalPageSize,popperClass:this.$parent.popperClass||"",size:"mini",disabled:this.$parent.disabled},on:{input:this.handleChange}},[this.pageSizes.map((function(r){return e("el-option",{attrs:{value:r,label:r+t.t("el.pagination.pagesize")}})}))])])},components:{ElSelect:d.a,ElOption:p.a},methods:{handleChange:function(e){e!==this.$parent.internalPageSize&&(this.$parent.internalPageSize=e=parseInt(e,10),this.$parent.userChangePageSize=!0,this.$parent.$emit("update:pageSize",e),this.$parent.$emit("size-change",e))}}},Jumper:{mixins:[_.a],components:{ElInput:g.a},data:function(){return{userInput:null}},watch:{"$parent.internalCurrentPage":function(){this.userInput=null}},methods:{handleKeyup:function(e){var t=e.keyCode,r=e.target;13===t&&this.handleChange(r.value)},handleInput:function(e){this.userInput=e},handleChange:function(e){this.$parent.internalCurrentPage=this.$parent.getValidCurrentPage(e),this.$parent.emitChange(),this.userInput=null}},render:function(e){return e("span",{class:"el-pagination__jump"},[this.t("el.pagination.goto"),e("el-input",{class:"el-pagination__editor is-in-pagination",attrs:{min:1,max:this.$parent.internalPageCount,value:null!==this.userInput?this.userInput:this.$parent.internalCurrentPage,type:"number",disabled:this.$parent.disabled},nativeOn:{keyup:this.handleKeyup},on:{input:this.handleInput,change:this.handleChange}}),this.t("el.pagination.pageClassifier")])}},Total:{mixins:[_.a],render:function(e){return"number"===typeof this.$parent.total?e("span",{class:"el-pagination__total"},[this.t("el.pagination.total",{total:this.$parent.total})]):""}},Pager:l},methods:{handleCurrentChange:function(e){this.internalCurrentPage=this.getValidCurrentPage(e),this.userChangePageSize=!0,this.emitChange()},prev:function(){if(!this.disabled){var e=this.internalCurrentPage-1;this.internalCurrentPage=this.getValidCurrentPage(e),this.$emit("prev-click",this.internalCurrentPage),this.emitChange()}},next:function(){if(!this.disabled){var e=this.internalCurrentPage+1;this.internalCurrentPage=this.getValidCurrentPage(e),this.$emit("next-click",this.internalCurrentPage),this.emitChange()}},getValidCurrentPage:function(e){e=parseInt(e,10);var t="number"===typeof this.internalPageCount,r=void 0;return t?e<1?r=1:e>this.internalPageCount&&(r=this.internalPageCount):(isNaN(e)||e<1)&&(r=1),(void 0===r&&isNaN(e)||0===r)&&(r=1),void 0===r?e:r},emitChange:function(){var e=this;this.$nextTick((function(){(e.internalCurrentPage!==e.lastEmittedPage||e.userChangePageSize)&&(e.$emit("current-change",e.internalCurrentPage),e.lastEmittedPage=e.internalCurrentPage,e.userChangePageSize=!1)}))}},computed:{internalPageCount:function(){return"number"===typeof this.total?Math.max(1,Math.ceil(this.total/this.internalPageSize)):"number"===typeof this.pageCount?Math.max(1,this.pageCount):null}},watch:{currentPage:{immediate:!0,handler:function(e){this.internalCurrentPage=this.getValidCurrentPage(e)}},pageSize:{immediate:!0,handler:function(e){this.internalPageSize=isNaN(e)?10:e}},internalCurrentPage:{immediate:!0,handler:function(e){this.$emit("update:currentPage",e),this.lastEmittedPage=-1}},internalPageCount:function(e){var t=this.internalCurrentPage;e>0&&0===t?this.internalCurrentPage=1:t>e&&(this.internalCurrentPage=0===e?1:e,this.userChangePageSize&&this.emitChange()),this.userChangePageSize=!1}},install:function(e){e.component(E.name,E)}},A=E,y=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition",{attrs:{name:"dialog-fade"},on:{"after-enter":e.afterEnter,"after-leave":e.afterLeave}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"el-dialog__wrapper",on:{click:function(t){return t.target!==t.currentTarget?null:e.handleWrapperClick(t)}}},[r("div",{key:e.key,ref:"dialog",class:["el-dialog",{"is-fullscreen":e.fullscreen,"el-dialog--center":e.center},e.customClass],style:e.style,attrs:{role:"dialog","aria-modal":"true","aria-label":e.title||"dialog"}},[r("div",{staticClass:"el-dialog__header"},[e._t("title",[r("span",{staticClass:"el-dialog__title"},[e._v(e._s(e.title))])]),e.showClose?r("button",{staticClass:"el-dialog__headerbtn",attrs:{type:"button","aria-label":"Close"},on:{click:e.handleClose}},[r("i",{staticClass:"el-dialog__close el-icon el-icon-close"})]):e._e()],2),e.rendered?r("div",{staticClass:"el-dialog__body"},[e._t("default")],2):e._e(),e.$slots.footer?r("div",{staticClass:"el-dialog__footer"},[e._t("footer")],2):e._e()])])])},S=[];y._withStripped=!0;var C=r(11),T=r.n(C),b=r(9),I=r.n(b),R=r(3),w=r.n(R),k={name:"ElDialog",mixins:[T.a,w.a,I.a],props:{title:{type:String,default:""},modal:{type:Boolean,default:!0},modalAppendToBody:{type:Boolean,default:!0},appendToBody:{type:Boolean,default:!1},lockScroll:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},width:String,fullscreen:Boolean,customClass:{type:String,default:""},top:{type:String,default:"15vh"},beforeClose:Function,center:{type:Boolean,default:!1},destroyOnClose:Boolean},data:function(){return{closed:!1,key:0}},watch:{visible:function(e){var t=this;e?(this.closed=!1,this.$emit("open"),this.$el.addEventListener("scroll",this.updatePopper),this.$nextTick((function(){t.$refs.dialog.scrollTop=0})),this.appendToBody&&document.body.appendChild(this.$el)):(this.$el.removeEventListener("scroll",this.updatePopper),this.closed||this.$emit("close"),this.destroyOnClose&&this.$nextTick((function(){t.key++})))}},computed:{style:function(){var e={};return this.fullscreen||(e.marginTop=this.top,this.width&&(e.width=this.width)),e}},methods:{getMigratingConfig:function(){return{props:{size:"size is removed."}}},handleWrapperClick:function(){this.closeOnClickModal&&this.handleClose()},handleClose:function(){"function"===typeof this.beforeClose?this.beforeClose(this.hide):this.hide()},hide:function(e){!1!==e&&(this.$emit("update:visible",!1),this.$emit("close"),this.closed=!0)},updatePopper:function(){this.broadcast("ElSelectDropdown","updatePopper"),this.broadcast("ElDropdownMenu","updatePopper")},afterEnter:function(){this.$emit("opened")},afterLeave:function(){this.$emit("closed")}},mounted:function(){this.visible&&(this.rendered=!0,this.open(),this.appendToBody&&document.body.appendChild(this.$el))},destroyed:function(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}},O=k,N=a(O,y,S,!1,null,null,null);N.options.__file="packages/dialog/src/component.vue";var L=N.exports;L.install=function(e){e.component(L.name,L)};var P=L,D=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.close,expression:"close"}],staticClass:"el-autocomplete",attrs:{"aria-haspopup":"listbox",role:"combobox","aria-expanded":e.suggestionVisible,"aria-owns":e.id}},[r("el-input",e._b({ref:"input",on:{input:e.handleInput,change:e.handleChange,focus:e.handleFocus,blur:e.handleBlur,clear:e.handleClear},nativeOn:{keydown:[function(t){if(!("button"in t)&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"]))return null;t.preventDefault(),e.highlight(e.highlightedIndex-1)},function(t){if(!("button"in t)&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"]))return null;t.preventDefault(),e.highlight(e.highlightedIndex+1)},function(t){return!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleKeyEnter(t)},function(t){return!("button"in t)&&e._k(t.keyCode,"tab",9,t.key,"Tab")?null:e.close(t)}]}},"el-input",[e.$props,e.$attrs],!1),[e.$slots.prepend?r("template",{slot:"prepend"},[e._t("prepend")],2):e._e(),e.$slots.append?r("template",{slot:"append"},[e._t("append")],2):e._e(),e.$slots.prefix?r("template",{slot:"prefix"},[e._t("prefix")],2):e._e(),e.$slots.suffix?r("template",{slot:"suffix"},[e._t("suffix")],2):e._e()],2),r("el-autocomplete-suggestions",{ref:"suggestions",class:[e.popperClass?e.popperClass:""],attrs:{"visible-arrow":"","popper-options":e.popperOptions,"append-to-body":e.popperAppendToBody,placement:e.placement,id:e.id}},e._l(e.suggestions,(function(t,i){return r("li",{key:i,class:{highlighted:e.highlightedIndex===i},attrs:{id:e.id+"-item-"+i,role:"option","aria-selected":e.highlightedIndex===i},on:{click:function(r){e.select(t)}}},[e._t("default",[e._v("\n        "+e._s(t[e.valueKey])+"\n      ")],{item:t})],2)})),0)],1)},M=[];D._withStripped=!0;var x=r(16),B=r.n(x),U=r(10),F=r.n(U),V=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition",{attrs:{name:"el-zoom-in-top"},on:{"after-leave":e.doDestroy}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.showPopper,expression:"showPopper"}],staticClass:"el-autocomplete-suggestion el-popper",class:{"is-loading":!e.parent.hideLoading&&e.parent.loading},style:{width:e.dropdownWidth},attrs:{role:"region"}},[r("el-scrollbar",{attrs:{tag:"ul","wrap-class":"el-autocomplete-suggestion__wrap","view-class":"el-autocomplete-suggestion__list"}},[!e.parent.hideLoading&&e.parent.loading?r("li",[r("i",{staticClass:"el-icon-loading"})]):e._t("default")],2)],1)])},j=[];V._withStripped=!0;var G=r(5),H=r.n(G),Q=r(18),W=r.n(Q),q={components:{ElScrollbar:W.a},mixins:[H.a,w.a],componentName:"ElAutocompleteSuggestions",data:function(){return{parent:this.$parent,dropdownWidth:""}},props:{options:{default:function(){return{gpuAcceleration:!1}}},id:String},methods:{select:function(e){this.dispatch("ElAutocomplete","item-click",e)}},updated:function(){var e=this;this.$nextTick((function(t){e.popperJS&&e.updatePopper()}))},mounted:function(){this.$parent.popperElm=this.popperElm=this.$el,this.referenceElm=this.$parent.$refs.input.$refs.input||this.$parent.$refs.input.$refs.textarea,this.referenceList=this.$el.querySelector(".el-autocomplete-suggestion__list"),this.referenceList.setAttribute("role","listbox"),this.referenceList.setAttribute("id",this.id)},created:function(){var e=this;this.$on("visible",(function(t,r){e.dropdownWidth=r+"px",e.showPopper=t}))}},z=q,Z=a(z,V,j,!1,null,null,null);Z.options.__file="packages/autocomplete/src/autocomplete-suggestions.vue";var Y=Z.exports,K=r(23),$=r.n(K),J={name:"ElAutocomplete",mixins:[w.a,$()("input"),I.a],inheritAttrs:!1,componentName:"ElAutocomplete",components:{ElInput:g.a,ElAutocompleteSuggestions:Y},directives:{Clickoutside:F.a},props:{valueKey:{type:String,default:"value"},popperClass:String,popperOptions:Object,placeholder:String,clearable:{type:Boolean,default:!1},disabled:Boolean,name:String,size:String,value:String,maxlength:Number,minlength:Number,autofocus:Boolean,fetchSuggestions:Function,triggerOnFocus:{type:Boolean,default:!0},customItem:String,selectWhenUnmatched:{type:Boolean,default:!1},prefixIcon:String,suffixIcon:String,label:String,debounce:{type:Number,default:300},placement:{type:String,default:"bottom-start"},hideLoading:Boolean,popperAppendToBody:{type:Boolean,default:!0},highlightFirstItem:{type:Boolean,default:!1}},data:function(){return{activated:!1,suggestions:[],loading:!1,highlightedIndex:-1,suggestionDisabled:!1}},computed:{suggestionVisible:function(){var e=this.suggestions,t=Array.isArray(e)&&e.length>0;return(t||this.loading)&&this.activated},id:function(){return"el-autocomplete-"+Object(v["generateId"])()}},watch:{suggestionVisible:function(e){var t=this.getInput();t&&this.broadcast("ElAutocompleteSuggestions","visible",[e,t.offsetWidth])}},methods:{getMigratingConfig:function(){return{props:{"custom-item":"custom-item is removed, use scoped slot instead.",props:"props is removed, use value-key instead."}}},getData:function(e){var t=this;this.suggestionDisabled||(this.loading=!0,this.fetchSuggestions(e,(function(e){t.loading=!1,t.suggestionDisabled||(Array.isArray(e)?(t.suggestions=e,t.highlightedIndex=t.highlightFirstItem?0:-1):console.error("[Element Error][Autocomplete]autocomplete suggestions must be an array"))})))},handleInput:function(e){if(this.$emit("input",e),this.suggestionDisabled=!1,!this.triggerOnFocus&&!e)return this.suggestionDisabled=!0,void(this.suggestions=[]);this.debouncedGetData(e)},handleChange:function(e){this.$emit("change",e)},handleFocus:function(e){this.activated=!0,this.$emit("focus",e),this.triggerOnFocus&&this.debouncedGetData(this.value)},handleBlur:function(e){this.$emit("blur",e)},handleClear:function(){this.activated=!1,this.$emit("clear")},close:function(e){this.activated=!1},handleKeyEnter:function(e){var t=this;this.suggestionVisible&&this.highlightedIndex>=0&&this.highlightedIndex<this.suggestions.length?(e.preventDefault(),this.select(this.suggestions[this.highlightedIndex])):this.selectWhenUnmatched&&(this.$emit("select",{value:this.value}),this.$nextTick((function(e){t.suggestions=[],t.highlightedIndex=-1})))},select:function(e){var t=this;this.$emit("input",e[this.valueKey]),this.$emit("select",e),this.$nextTick((function(e){t.suggestions=[],t.highlightedIndex=-1}))},highlight:function(e){if(this.suggestionVisible&&!this.loading)if(e<0)this.highlightedIndex=-1;else{e>=this.suggestions.length&&(e=this.suggestions.length-1);var t=this.$refs.suggestions.$el.querySelector(".el-autocomplete-suggestion__wrap"),r=t.querySelectorAll(".el-autocomplete-suggestion__list li"),i=r[e],n=t.scrollTop,o=i.offsetTop;o+i.scrollHeight>n+t.clientHeight&&(t.scrollTop+=i.scrollHeight),o<n&&(t.scrollTop-=i.scrollHeight),this.highlightedIndex=e;var s=this.getInput();s.setAttribute("aria-activedescendant",this.id+"-item-"+this.highlightedIndex)}},getInput:function(){return this.$refs.input.getInput()}},mounted:function(){var e=this;this.debouncedGetData=B()(this.debounce,this.getData),this.$on("item-click",(function(t){e.select(t)}));var t=this.getInput();t.setAttribute("role","textbox"),t.setAttribute("aria-autocomplete","list"),t.setAttribute("aria-controls","id"),t.setAttribute("aria-activedescendant",this.id+"-item-"+this.highlightedIndex)},beforeDestroy:function(){this.$refs.suggestions.$destroy()}},X=J,ee=a(X,D,M,!1,null,null,null);ee.options.__file="packages/autocomplete/src/autocomplete.vue";var te=ee.exports;te.install=function(e){e.component(te.name,te)};var re,ie,ne=te,oe=r(13),se=r.n(oe),ae=r(28),ce=r.n(ae),le={name:"ElDropdown",componentName:"ElDropdown",mixins:[w.a,I.a],directives:{Clickoutside:F.a},components:{ElButton:se.a,ElButtonGroup:ce.a},provide:function(){return{dropdown:this}},props:{trigger:{type:String,default:"hover"},type:String,size:{type:String,default:""},splitButton:Boolean,hideOnClick:{type:Boolean,default:!0},placement:{type:String,default:"bottom-end"},visibleArrow:{default:!0},showTimeout:{type:Number,default:250},hideTimeout:{type:Number,default:150},tabindex:{type:Number,default:0},disabled:{type:Boolean,default:!1}},data:function(){return{timeout:null,visible:!1,triggerElm:null,menuItems:null,menuItemsArray:null,dropdownElm:null,focusing:!1,listId:"dropdown-menu-"+Object(v["generateId"])()}},computed:{dropdownSize:function(){return this.size||(this.$ELEMENT||{}).size}},mounted:function(){this.$on("menu-item-click",this.handleMenuItemClick)},watch:{visible:function(e){this.broadcast("ElDropdownMenu","visible",e),this.$emit("visible-change",e)},focusing:function(e){var t=this.$el.querySelector(".el-dropdown-selfdefine");t&&(e?t.className+=" focusing":t.className=t.className.replace("focusing",""))}},methods:{getMigratingConfig:function(){return{props:{"menu-align":"menu-align is renamed to placement."}}},show:function(){var e=this;this.disabled||(clearTimeout(this.timeout),this.timeout=setTimeout((function(){e.visible=!0}),"click"===this.trigger?0:this.showTimeout))},hide:function(){var e=this;this.disabled||(this.removeTabindex(),this.tabindex>=0&&this.resetTabindex(this.triggerElm),clearTimeout(this.timeout),this.timeout=setTimeout((function(){e.visible=!1}),"click"===this.trigger?0:this.hideTimeout))},handleClick:function(){this.disabled||(this.visible?this.hide():this.show())},handleTriggerKeyDown:function(e){var t=e.keyCode;[38,40].indexOf(t)>-1?(this.removeTabindex(),this.resetTabindex(this.menuItems[0]),this.menuItems[0].focus(),e.preventDefault(),e.stopPropagation()):13===t?this.handleClick():[9,27].indexOf(t)>-1&&this.hide()},handleItemKeyDown:function(e){var t=e.keyCode,r=e.target,i=this.menuItemsArray.indexOf(r),n=this.menuItemsArray.length-1,o=void 0;[38,40].indexOf(t)>-1?(o=38===t?0!==i?i-1:0:i<n?i+1:n,this.removeTabindex(),this.resetTabindex(this.menuItems[o]),this.menuItems[o].focus(),e.preventDefault(),e.stopPropagation()):13===t?(this.triggerElmFocus(),r.click(),this.hideOnClick&&(this.visible=!1)):[9,27].indexOf(t)>-1&&(this.hide(),this.triggerElmFocus())},resetTabindex:function(e){this.removeTabindex(),e.setAttribute("tabindex","0")},removeTabindex:function(){this.triggerElm.setAttribute("tabindex","-1"),this.menuItemsArray.forEach((function(e){e.setAttribute("tabindex","-1")}))},initAria:function(){this.dropdownElm.setAttribute("id",this.listId),this.triggerElm.setAttribute("aria-haspopup","list"),this.triggerElm.setAttribute("aria-controls",this.listId),this.splitButton||(this.triggerElm.setAttribute("role","button"),this.triggerElm.setAttribute("tabindex",this.tabindex),this.triggerElm.setAttribute("class",(this.triggerElm.getAttribute("class")||"")+" el-dropdown-selfdefine"))},initEvent:function(){var e=this,t=this.trigger,r=this.show,i=this.hide,n=this.handleClick,o=this.splitButton,s=this.handleTriggerKeyDown,a=this.handleItemKeyDown;this.triggerElm=o?this.$refs.trigger.$el:this.$slots.default[0].elm;var c=this.dropdownElm;this.triggerElm.addEventListener("keydown",s),c.addEventListener("keydown",a,!0),o||(this.triggerElm.addEventListener("focus",(function(){e.focusing=!0})),this.triggerElm.addEventListener("blur",(function(){e.focusing=!1})),this.triggerElm.addEventListener("click",(function(){e.focusing=!1}))),"hover"===t?(this.triggerElm.addEventListener("mouseenter",r),this.triggerElm.addEventListener("mouseleave",i),c.addEventListener("mouseenter",r),c.addEventListener("mouseleave",i)):"click"===t&&this.triggerElm.addEventListener("click",n)},handleMenuItemClick:function(e,t){this.hideOnClick&&(this.visible=!1),this.$emit("command",e,t)},triggerElmFocus:function(){this.triggerElm.focus&&this.triggerElm.focus()},initDomOperation:function(){this.dropdownElm=this.popperElm,this.menuItems=this.dropdownElm.querySelectorAll("[tabindex='-1']"),this.menuItemsArray=[].slice.call(this.menuItems),this.initEvent(),this.initAria()}},render:function(e){var t=this,r=this.hide,i=this.splitButton,n=this.type,o=this.dropdownSize,s=this.disabled,a=function(e){t.$emit("click",e),r()},c=null;if(i)c=e("el-button-group",[e("el-button",{attrs:{type:n,size:o,disabled:s},nativeOn:{click:a}},[this.$slots.default]),e("el-button",{ref:"trigger",attrs:{type:n,size:o,disabled:s},class:"el-dropdown__caret-button"},[e("i",{class:"el-dropdown__icon el-icon-arrow-down"})])]);else{c=this.$slots.default;var l=c[0].data||{},u=l.attrs,d=void 0===u?{}:u;s&&!d.disabled&&(d.disabled=!0,l.attrs=d)}var h=s?null:this.$slots.dropdown;return e("div",{class:"el-dropdown",directives:[{name:"clickoutside",value:r}],attrs:{"aria-disabled":s}},[c,h])}},ue=le,de=a(ue,re,ie,!1,null,null,null);de.options.__file="packages/dropdown/src/dropdown.vue";var he=de.exports;he.install=function(e){e.component(he.name,he)};var pe=he,fe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition",{attrs:{name:"el-zoom-in-top"},on:{"after-leave":e.doDestroy}},[r("ul",{directives:[{name:"show",rawName:"v-show",value:e.showPopper,expression:"showPopper"}],staticClass:"el-dropdown-menu el-popper",class:[e.size&&"el-dropdown-menu--"+e.size]},[e._t("default")],2)])},ge=[];fe._withStripped=!0;var me={name:"ElDropdownMenu",componentName:"ElDropdownMenu",mixins:[H.a],props:{visibleArrow:{type:Boolean,default:!0},arrowOffset:{type:Number,default:0}},data:function(){return{size:this.dropdown.dropdownSize}},inject:["dropdown"],created:function(){var e=this;this.$on("updatePopper",(function(){e.showPopper&&e.updatePopper()})),this.$on("visible",(function(t){e.showPopper=t}))},mounted:function(){this.dropdown.popperElm=this.popperElm=this.$el,this.referenceElm=this.dropdown.$el,this.dropdown.initDomOperation()},watch:{"dropdown.placement":{immediate:!0,handler:function(e){this.currentPlacement=e}}}},_e=me,ve=a(_e,fe,ge,!1,null,null,null);ve.options.__file="packages/dropdown/src/dropdown-menu.vue";var Ee=ve.exports;Ee.install=function(e){e.component(Ee.name,Ee)};var Ae=Ee,ye=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{staticClass:"el-dropdown-menu__item",class:{"is-disabled":e.disabled,"el-dropdown-menu__item--divided":e.divided},attrs:{"aria-disabled":e.disabled,tabindex:e.disabled?null:-1},on:{click:e.handleClick}},[e.icon?r("i",{class:e.icon}):e._e(),e._t("default")],2)},Se=[];ye._withStripped=!0;var Ce={name:"ElDropdownItem",mixins:[w.a],props:{command:{},disabled:Boolean,divided:Boolean,icon:String},methods:{handleClick:function(e){this.dispatch("ElDropdown","menu-item-click",[this.command,this])}}},Te=Ce,be=a(Te,ye,Se,!1,null,null,null);be.options.__file="packages/dropdown/src/dropdown-item.vue";var Ie=be.exports;Ie.install=function(e){e.component(Ie.name,Ie)};var Re=Ie,we=we||{};we.Utils=we.Utils||{},we.Utils.focusFirstDescendant=function(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(we.Utils.attemptFocus(r)||we.Utils.focusFirstDescendant(r))return!0}return!1},we.Utils.focusLastDescendant=function(e){for(var t=e.childNodes.length-1;t>=0;t--){var r=e.childNodes[t];if(we.Utils.attemptFocus(r)||we.Utils.focusLastDescendant(r))return!0}return!1},we.Utils.attemptFocus=function(e){if(!we.Utils.isFocusable(e))return!1;we.Utils.IgnoreUtilFocusChanges=!0;try{e.focus()}catch(t){}return we.Utils.IgnoreUtilFocusChanges=!1,document.activeElement===e},we.Utils.isFocusable=function(e){if(e.tabIndex>0||0===e.tabIndex&&null!==e.getAttribute("tabIndex"))return!0;if(e.disabled)return!1;switch(e.nodeName){case"A":return!!e.href&&"ignore"!==e.rel;case"INPUT":return"hidden"!==e.type&&"file"!==e.type;case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},we.Utils.triggerEvent=function(e,t){var r=void 0;r=/^mouse|click/.test(t)?"MouseEvents":/^key/.test(t)?"KeyboardEvent":"HTMLEvents";for(var i=document.createEvent(r),n=arguments.length,o=Array(n>2?n-2:0),s=2;s<n;s++)o[s-2]=arguments[s];return i.initEvent.apply(i,[t].concat(o)),e.dispatchEvent?e.dispatchEvent(i):e.fireEvent("on"+t,i),e},we.Utils.keys={tab:9,enter:13,space:32,left:37,up:38,right:39,down:40,esc:27};var ke=we.Utils,Oe=function(e,t){this.domNode=t,this.parent=e,this.subMenuItems=[],this.subIndex=0,this.init()};Oe.prototype.init=function(){this.subMenuItems=this.domNode.querySelectorAll("li"),this.addListeners()},Oe.prototype.gotoSubIndex=function(e){e===this.subMenuItems.length?e=0:e<0&&(e=this.subMenuItems.length-1),this.subMenuItems[e].focus(),this.subIndex=e},Oe.prototype.addListeners=function(){var e=this,t=ke.keys,r=this.parent.domNode;Array.prototype.forEach.call(this.subMenuItems,(function(i){i.addEventListener("keydown",(function(i){var n=!1;switch(i.keyCode){case t.down:e.gotoSubIndex(e.subIndex+1),n=!0;break;case t.up:e.gotoSubIndex(e.subIndex-1),n=!0;break;case t.tab:ke.triggerEvent(r,"mouseleave");break;case t.enter:case t.space:n=!0,i.currentTarget.click();break}return n&&(i.preventDefault(),i.stopPropagation()),!1}))}))};var Ne=Oe,Le=function(e){this.domNode=e,this.submenu=null,this.init()};Le.prototype.init=function(){this.domNode.setAttribute("tabindex","0");var e=this.domNode.querySelector(".el-menu");e&&(this.submenu=new Ne(this,e)),this.addListeners()},Le.prototype.addListeners=function(){var e=this,t=ke.keys;this.domNode.addEventListener("keydown",(function(r){var i=!1;switch(r.keyCode){case t.down:ke.triggerEvent(r.currentTarget,"mouseenter"),e.submenu&&e.submenu.gotoSubIndex(0),i=!0;break;case t.up:ke.triggerEvent(r.currentTarget,"mouseenter"),e.submenu&&e.submenu.gotoSubIndex(e.submenu.subMenuItems.length-1),i=!0;break;case t.tab:ke.triggerEvent(r.currentTarget,"mouseleave");break;case t.enter:case t.space:i=!0,r.currentTarget.click();break}i&&r.preventDefault()}))};var Pe=Le,De=function(e){this.domNode=e,this.init()};De.prototype.init=function(){var e=this.domNode.childNodes;[].filter.call(e,(function(e){return 1===e.nodeType})).forEach((function(e){new Pe(e)}))};var Me,xe,Be=De,Ue=r(1),Fe={name:"ElMenu",render:function(e){var t=e("ul",{attrs:{role:"menubar"},key:+this.collapse,style:{backgroundColor:this.backgroundColor||""},class:{"el-menu--horizontal":"horizontal"===this.mode,"el-menu--collapse":this.collapse,"el-menu":!0}},[this.$slots.default]);return this.collapseTransition?e("el-menu-collapse-transition",[t]):t},componentName:"ElMenu",mixins:[w.a,I.a],provide:function(){return{rootMenu:this}},components:{"el-menu-collapse-transition":{functional:!0,render:function(e,t){var r={props:{mode:"out-in"},on:{beforeEnter:function(e){e.style.opacity=.2},enter:function(e){Object(Ue["addClass"])(e,"el-opacity-transition"),e.style.opacity=1},afterEnter:function(e){Object(Ue["removeClass"])(e,"el-opacity-transition"),e.style.opacity=""},beforeLeave:function(e){e.dataset||(e.dataset={}),Object(Ue["hasClass"])(e,"el-menu--collapse")?(Object(Ue["removeClass"])(e,"el-menu--collapse"),e.dataset.oldOverflow=e.style.overflow,e.dataset.scrollWidth=e.clientWidth,Object(Ue["addClass"])(e,"el-menu--collapse")):(Object(Ue["addClass"])(e,"el-menu--collapse"),e.dataset.oldOverflow=e.style.overflow,e.dataset.scrollWidth=e.clientWidth,Object(Ue["removeClass"])(e,"el-menu--collapse")),e.style.width=e.scrollWidth+"px",e.style.overflow="hidden"},leave:function(e){Object(Ue["addClass"])(e,"horizontal-collapse-transition"),e.style.width=e.dataset.scrollWidth+"px"}}};return e("transition",r,t.children)}}},props:{mode:{type:String,default:"vertical"},defaultActive:{type:String,default:""},defaultOpeneds:Array,uniqueOpened:Boolean,router:Boolean,menuTrigger:{type:String,default:"hover"},collapse:Boolean,backgroundColor:String,textColor:String,activeTextColor:String,collapseTransition:{type:Boolean,default:!0}},data:function(){return{activeIndex:this.defaultActive,openedMenus:this.defaultOpeneds&&!this.collapse?this.defaultOpeneds.slice(0):[],items:{},submenus:{}}},computed:{hoverBackground:function(){return this.backgroundColor?this.mixColor(this.backgroundColor,.2):""},isMenuPopup:function(){return"horizontal"===this.mode||"vertical"===this.mode&&this.collapse}},watch:{defaultActive:function(e){this.items[e]||(this.activeIndex=null),this.updateActiveIndex(e)},defaultOpeneds:function(e){this.collapse||(this.openedMenus=e)},collapse:function(e){e&&(this.openedMenus=[]),this.broadcast("ElSubmenu","toggle-collapse",e)}},methods:{updateActiveIndex:function(e){var t=this.items[e]||this.items[this.activeIndex]||this.items[this.defaultActive];t?(this.activeIndex=t.index,this.initOpenedMenu()):this.activeIndex=null},getMigratingConfig:function(){return{props:{theme:"theme is removed."}}},getColorChannels:function(e){if(e=e.replace("#",""),/^[0-9a-fA-F]{3}$/.test(e)){e=e.split("");for(var t=2;t>=0;t--)e.splice(t,0,e[t]);e=e.join("")}return/^[0-9a-fA-F]{6}$/.test(e)?{red:parseInt(e.slice(0,2),16),green:parseInt(e.slice(2,4),16),blue:parseInt(e.slice(4,6),16)}:{red:255,green:255,blue:255}},mixColor:function(e,t){var r=this.getColorChannels(e),i=r.red,n=r.green,o=r.blue;return t>0?(i*=1-t,n*=1-t,o*=1-t):(i+=(255-i)*t,n+=(255-n)*t,o+=(255-o)*t),"rgb("+Math.round(i)+", "+Math.round(n)+", "+Math.round(o)+")"},addItem:function(e){this.$set(this.items,e.index,e)},removeItem:function(e){delete this.items[e.index]},addSubmenu:function(e){this.$set(this.submenus,e.index,e)},removeSubmenu:function(e){delete this.submenus[e.index]},openMenu:function(e,t){var r=this.openedMenus;-1===r.indexOf(e)&&(this.uniqueOpened&&(this.openedMenus=r.filter((function(e){return-1!==t.indexOf(e)}))),this.openedMenus.push(e))},closeMenu:function(e){var t=this.openedMenus.indexOf(e);-1!==t&&this.openedMenus.splice(t,1)},handleSubmenuClick:function(e){var t=e.index,r=e.indexPath,i=-1!==this.openedMenus.indexOf(t);i?(this.closeMenu(t),this.$emit("close",t,r)):(this.openMenu(t,r),this.$emit("open",t,r))},handleItemClick:function(e){var t=this,r=e.index,i=e.indexPath,n=this.activeIndex,o=null!==e.index;o&&(this.activeIndex=e.index),this.$emit("select",r,i,e),("horizontal"===this.mode||this.collapse)&&(this.openedMenus=[]),this.router&&o&&this.routeToItem(e,(function(e){if(t.activeIndex=n,e){if("NavigationDuplicated"===e.name)return;console.error(e)}}))},initOpenedMenu:function(){var e=this,t=this.activeIndex,r=this.items[t];if(r&&"horizontal"!==this.mode&&!this.collapse){var i=r.indexPath;i.forEach((function(t){var r=e.submenus[t];r&&e.openMenu(t,r.indexPath)}))}},routeToItem:function(e,t){var r=e.route||e.index;try{this.$router.push(r,(function(){}),t)}catch(i){console.error(i)}},open:function(e){var t=this,r=this.submenus[e.toString()].indexPath;r.forEach((function(e){return t.openMenu(e,r)}))},close:function(e){this.closeMenu(e)}},mounted:function(){this.initOpenedMenu(),this.$on("item-click",this.handleItemClick),this.$on("submenu-click",this.handleSubmenuClick),"horizontal"===this.mode&&new Be(this.$el),this.$watch("items",this.updateActiveIndex)}},Ve=Fe,je=a(Ve,Me,xe,!1,null,null,null);je.options.__file="packages/menu/src/menu.vue";var Ge=je.exports;Ge.install=function(e){e.component(Ge.name,Ge)};var He,Qe,We=Ge,qe=r(21),ze=r.n(qe),Ze={inject:["rootMenu"],computed:{indexPath:function(){var e=[this.index],t=this.$parent;while("ElMenu"!==t.$options.componentName)t.index&&e.unshift(t.index),t=t.$parent;return e},parentMenu:function(){var e=this.$parent;while(e&&-1===["ElMenu","ElSubmenu"].indexOf(e.$options.componentName))e=e.$parent;return e},paddingStyle:function(){if("vertical"!==this.rootMenu.mode)return{};var e=20,t=this.$parent;if(this.rootMenu.collapse)e=20;else while(t&&"ElMenu"!==t.$options.componentName)"ElSubmenu"===t.$options.componentName&&(e+=20),t=t.$parent;return{paddingLeft:e+"px"}}}},Ye={props:{transformOrigin:{type:[Boolean,String],default:!1},offset:H.a.props.offset,boundariesPadding:H.a.props.boundariesPadding,popperOptions:H.a.props.popperOptions},data:H.a.data,methods:H.a.methods,beforeDestroy:H.a.beforeDestroy,deactivated:H.a.deactivated},Ke={name:"ElSubmenu",componentName:"ElSubmenu",mixins:[Ze,w.a,Ye],components:{ElCollapseTransition:ze.a},props:{index:{type:String,required:!0},showTimeout:{type:Number,default:300},hideTimeout:{type:Number,default:300},popperClass:String,disabled:Boolean,popperAppendToBody:{type:Boolean,default:void 0}},data:function(){return{popperJS:null,timeout:null,items:{},submenus:{},mouseInChild:!1}},watch:{opened:function(e){var t=this;this.isMenuPopup&&this.$nextTick((function(e){t.updatePopper()}))}},computed:{appendToBody:function(){return void 0===this.popperAppendToBody?this.isFirstLevel:this.popperAppendToBody},menuTransitionName:function(){return this.rootMenu.collapse?"el-zoom-in-left":"el-zoom-in-top"},opened:function(){return this.rootMenu.openedMenus.indexOf(this.index)>-1},active:function(){var e=!1,t=this.submenus,r=this.items;return Object.keys(r).forEach((function(t){r[t].active&&(e=!0)})),Object.keys(t).forEach((function(r){t[r].active&&(e=!0)})),e},hoverBackground:function(){return this.rootMenu.hoverBackground},backgroundColor:function(){return this.rootMenu.backgroundColor||""},activeTextColor:function(){return this.rootMenu.activeTextColor||""},textColor:function(){return this.rootMenu.textColor||""},mode:function(){return this.rootMenu.mode},isMenuPopup:function(){return this.rootMenu.isMenuPopup},titleStyle:function(){return"horizontal"!==this.mode?{color:this.textColor}:{borderBottomColor:this.active?this.rootMenu.activeTextColor?this.activeTextColor:"":"transparent",color:this.active?this.activeTextColor:this.textColor}},isFirstLevel:function(){var e=!0,t=this.$parent;while(t&&t!==this.rootMenu){if(["ElSubmenu","ElMenuItemGroup"].indexOf(t.$options.componentName)>-1){e=!1;break}t=t.$parent}return e}},methods:{handleCollapseToggle:function(e){e?this.initPopper():this.doDestroy()},addItem:function(e){this.$set(this.items,e.index,e)},removeItem:function(e){delete this.items[e.index]},addSubmenu:function(e){this.$set(this.submenus,e.index,e)},removeSubmenu:function(e){delete this.submenus[e.index]},handleClick:function(){var e=this.rootMenu,t=this.disabled;"hover"===e.menuTrigger&&"horizontal"===e.mode||e.collapse&&"vertical"===e.mode||t||this.dispatch("ElMenu","submenu-click",this)},handleMouseenter:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.showTimeout;if("ActiveXObject"in window||"focus"!==e.type||e.relatedTarget){var i=this.rootMenu,n=this.disabled;"click"===i.menuTrigger&&"horizontal"===i.mode||!i.collapse&&"vertical"===i.mode||n||(this.dispatch("ElSubmenu","mouse-enter-child"),clearTimeout(this.timeout),this.timeout=setTimeout((function(){t.rootMenu.openMenu(t.index,t.indexPath)}),r),this.appendToBody&&this.$parent.$el.dispatchEvent(new MouseEvent("mouseenter")))}},handleMouseleave:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this.rootMenu;"click"===r.menuTrigger&&"horizontal"===r.mode||!r.collapse&&"vertical"===r.mode||(this.dispatch("ElSubmenu","mouse-leave-child"),clearTimeout(this.timeout),this.timeout=setTimeout((function(){!e.mouseInChild&&e.rootMenu.closeMenu(e.index)}),this.hideTimeout),this.appendToBody&&t&&"ElSubmenu"===this.$parent.$options.name&&this.$parent.handleMouseleave(!0))},handleTitleMouseenter:function(){if("horizontal"!==this.mode||this.rootMenu.backgroundColor){var e=this.$refs["submenu-title"];e&&(e.style.backgroundColor=this.rootMenu.hoverBackground)}},handleTitleMouseleave:function(){if("horizontal"!==this.mode||this.rootMenu.backgroundColor){var e=this.$refs["submenu-title"];e&&(e.style.backgroundColor=this.rootMenu.backgroundColor||"")}},updatePlacement:function(){this.currentPlacement="horizontal"===this.mode&&this.isFirstLevel?"bottom-start":"right-start"},initPopper:function(){this.referenceElm=this.$el,this.popperElm=this.$refs.menu,this.updatePlacement()}},created:function(){var e=this;this.$on("toggle-collapse",this.handleCollapseToggle),this.$on("mouse-enter-child",(function(){e.mouseInChild=!0,clearTimeout(e.timeout)})),this.$on("mouse-leave-child",(function(){e.mouseInChild=!1,clearTimeout(e.timeout)}))},mounted:function(){this.parentMenu.addSubmenu(this),this.rootMenu.addSubmenu(this),this.initPopper()},beforeDestroy:function(){this.parentMenu.removeSubmenu(this),this.rootMenu.removeSubmenu(this)},render:function(e){var t=this,r=this.active,i=this.opened,n=this.paddingStyle,o=this.titleStyle,s=this.backgroundColor,a=this.rootMenu,c=this.currentPlacement,l=this.menuTransitionName,u=this.mode,d=this.disabled,h=this.popperClass,p=this.$slots,f=this.isFirstLevel,g=e("transition",{attrs:{name:l}},[e("div",{ref:"menu",directives:[{name:"show",value:i}],class:["el-menu--"+u,h],on:{mouseenter:function(e){return t.handleMouseenter(e,100)},mouseleave:function(){return t.handleMouseleave(!0)},focus:function(e){return t.handleMouseenter(e,100)}}},[e("ul",{attrs:{role:"menu"},class:["el-menu el-menu--popup","el-menu--popup-"+c],style:{backgroundColor:a.backgroundColor||""}},[p.default])])]),m=e("el-collapse-transition",[e("ul",{attrs:{role:"menu"},class:"el-menu el-menu--inline",directives:[{name:"show",value:i}],style:{backgroundColor:a.backgroundColor||""}},[p.default])]),_="horizontal"===a.mode&&f||"vertical"===a.mode&&!a.collapse?"el-icon-arrow-down":"el-icon-arrow-right";return e("li",{class:{"el-submenu":!0,"is-active":r,"is-opened":i,"is-disabled":d},attrs:{role:"menuitem","aria-haspopup":"true","aria-expanded":i},on:{mouseenter:this.handleMouseenter,mouseleave:function(){return t.handleMouseleave(!1)},focus:this.handleMouseenter}},[e("div",{class:"el-submenu__title",ref:"submenu-title",on:{click:this.handleClick,mouseenter:this.handleTitleMouseenter,mouseleave:this.handleTitleMouseleave},style:[n,o,{backgroundColor:s}]},[p.title,e("i",{class:["el-submenu__icon-arrow",_]})]),this.isMenuPopup?g:m])}},$e=Ke,Je=a($e,He,Qe,!1,null,null,null);Je.options.__file="packages/menu/src/submenu.vue";var Xe=Je.exports;Xe.install=function(e){e.component(Xe.name,Xe)};var et=Xe,tt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{staticClass:"el-menu-item",class:{"is-active":e.active,"is-disabled":e.disabled},style:[e.paddingStyle,e.itemStyle,{backgroundColor:e.backgroundColor}],attrs:{role:"menuitem",tabindex:"-1"},on:{click:e.handleClick,mouseenter:e.onMouseEnter,focus:e.onMouseEnter,blur:e.onMouseLeave,mouseleave:e.onMouseLeave}},["ElMenu"===e.parentMenu.$options.componentName&&e.rootMenu.collapse&&e.$slots.title?r("el-tooltip",{attrs:{effect:"dark",placement:"right"}},[r("div",{attrs:{slot:"content"},slot:"content"},[e._t("title")],2),r("div",{staticStyle:{position:"absolute",left:"0",top:"0",height:"100%",width:"100%",display:"inline-block","box-sizing":"border-box",padding:"0 20px"}},[e._t("default")],2)]):[e._t("default"),e._t("title")]],2)},rt=[];tt._withStripped=!0;var it=r(26),nt=r.n(it),ot={name:"ElMenuItem",componentName:"ElMenuItem",mixins:[Ze,w.a],components:{ElTooltip:nt.a},props:{index:{default:null,validator:function(e){return"string"===typeof e||null===e}},route:[String,Object],disabled:Boolean},computed:{active:function(){return this.index===this.rootMenu.activeIndex},hoverBackground:function(){return this.rootMenu.hoverBackground},backgroundColor:function(){return this.rootMenu.backgroundColor||""},activeTextColor:function(){return this.rootMenu.activeTextColor||""},textColor:function(){return this.rootMenu.textColor||""},mode:function(){return this.rootMenu.mode},itemStyle:function(){var e={color:this.active?this.activeTextColor:this.textColor};return"horizontal"!==this.mode||this.isNested||(e.borderBottomColor=this.active?this.rootMenu.activeTextColor?this.activeTextColor:"":"transparent"),e},isNested:function(){return this.parentMenu!==this.rootMenu}},methods:{onMouseEnter:function(){("horizontal"!==this.mode||this.rootMenu.backgroundColor)&&(this.$el.style.backgroundColor=this.hoverBackground)},onMouseLeave:function(){("horizontal"!==this.mode||this.rootMenu.backgroundColor)&&(this.$el.style.backgroundColor=this.backgroundColor)},handleClick:function(){this.disabled||(this.dispatch("ElMenu","item-click",this),this.$emit("click",this))}},mounted:function(){this.parentMenu.addItem(this),this.rootMenu.addItem(this)},beforeDestroy:function(){this.parentMenu.removeItem(this),this.rootMenu.removeItem(this)}},st=ot,at=a(st,tt,rt,!1,null,null,null);at.options.__file="packages/menu/src/menu-item.vue";var ct=at.exports;ct.install=function(e){e.component(ct.name,ct)};var lt=ct,ut=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{staticClass:"el-menu-item-group"},[r("div",{staticClass:"el-menu-item-group__title",style:{paddingLeft:e.levelPadding+"px"}},[e.$slots.title?e._t("title"):[e._v(e._s(e.title))]],2),r("ul",[e._t("default")],2)])},dt=[];ut._withStripped=!0;var ht={name:"ElMenuItemGroup",componentName:"ElMenuItemGroup",inject:["rootMenu"],props:{title:{type:String}},data:function(){return{paddingLeft:20}},computed:{levelPadding:function(){var e=20,t=this.$parent;if(this.rootMenu.collapse)return 20;while(t&&"ElMenu"!==t.$options.componentName)"ElSubmenu"===t.$options.componentName&&(e+=20),t=t.$parent;return e}}},pt=ht,ft=a(pt,ut,dt,!1,null,null,null);ft.options.__file="packages/menu/src/menu-item-group.vue";var gt=ft.exports;gt.install=function(e){e.component(gt.name,gt)};var mt=gt,_t=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:["textarea"===e.type?"el-textarea":"el-input",e.inputSize?"el-input--"+e.inputSize:"",{"is-disabled":e.inputDisabled,"is-exceed":e.inputExceed,"el-input-group":e.$slots.prepend||e.$slots.append,"el-input-group--append":e.$slots.append,"el-input-group--prepend":e.$slots.prepend,"el-input--prefix":e.$slots.prefix||e.prefixIcon,"el-input--suffix":e.$slots.suffix||e.suffixIcon||e.clearable||e.showPassword}],on:{mouseenter:function(t){e.hovering=!0},mouseleave:function(t){e.hovering=!1}}},["textarea"!==e.type?[e.$slots.prepend?r("div",{staticClass:"el-input-group__prepend"},[e._t("prepend")],2):e._e(),"textarea"!==e.type?r("input",e._b({ref:"input",staticClass:"el-input__inner",attrs:{tabindex:e.tabindex,type:e.showPassword?e.passwordVisible?"text":"password":e.type,disabled:e.inputDisabled,readonly:e.readonly,autocomplete:e.autoComplete||e.autocomplete,"aria-label":e.label},on:{compositionstart:e.handleCompositionStart,compositionupdate:e.handleCompositionUpdate,compositionend:e.handleCompositionEnd,input:e.handleInput,focus:e.handleFocus,blur:e.handleBlur,change:e.handleChange}},"input",e.$attrs,!1)):e._e(),e.$slots.prefix||e.prefixIcon?r("span",{staticClass:"el-input__prefix"},[e._t("prefix"),e.prefixIcon?r("i",{staticClass:"el-input__icon",class:e.prefixIcon}):e._e()],2):e._e(),e.getSuffixVisible()?r("span",{staticClass:"el-input__suffix"},[r("span",{staticClass:"el-input__suffix-inner"},[e.showClear&&e.showPwdVisible&&e.isWordLimitVisible?e._e():[e._t("suffix"),e.suffixIcon?r("i",{staticClass:"el-input__icon",class:e.suffixIcon}):e._e()],e.showClear?r("i",{staticClass:"el-input__icon el-icon-circle-close el-input__clear",on:{mousedown:function(e){e.preventDefault()},click:e.clear}}):e._e(),e.showPwdVisible?r("i",{staticClass:"el-input__icon el-icon-view el-input__clear",on:{click:e.handlePasswordVisible}}):e._e(),e.isWordLimitVisible?r("span",{staticClass:"el-input__count"},[r("span",{staticClass:"el-input__count-inner"},[e._v("\n            "+e._s(e.textLength)+"/"+e._s(e.upperLimit)+"\n          ")])]):e._e()],2),e.validateState?r("i",{staticClass:"el-input__icon",class:["el-input__validateIcon",e.validateIcon]}):e._e()]):e._e(),e.$slots.append?r("div",{staticClass:"el-input-group__append"},[e._t("append")],2):e._e()]:r("textarea",e._b({ref:"textarea",staticClass:"el-textarea__inner",style:e.textareaStyle,attrs:{tabindex:e.tabindex,disabled:e.inputDisabled,readonly:e.readonly,autocomplete:e.autoComplete||e.autocomplete,"aria-label":e.label},on:{compositionstart:e.handleCompositionStart,compositionupdate:e.handleCompositionUpdate,compositionend:e.handleCompositionEnd,input:e.handleInput,focus:e.handleFocus,blur:e.handleBlur,change:e.handleChange}},"textarea",e.$attrs,!1)),e.isWordLimitVisible&&"textarea"===e.type?r("span",{staticClass:"el-input__count"},[e._v(e._s(e.textLength)+"/"+e._s(e.upperLimit))]):e._e()],2)},vt=[];_t._withStripped=!0;var Et=void 0,At="\n  height:0 !important;\n  visibility:hidden !important;\n  overflow:hidden !important;\n  position:absolute !important;\n  z-index:-1000 !important;\n  top:0 !important;\n  right:0 !important\n",yt=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function St(e){var t=window.getComputedStyle(e),r=t.getPropertyValue("box-sizing"),i=parseFloat(t.getPropertyValue("padding-bottom"))+parseFloat(t.getPropertyValue("padding-top")),n=parseFloat(t.getPropertyValue("border-bottom-width"))+parseFloat(t.getPropertyValue("border-top-width")),o=yt.map((function(e){return e+":"+t.getPropertyValue(e)})).join(";");return{contextStyle:o,paddingSize:i,borderSize:n,boxSizing:r}}function Ct(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Et||(Et=document.createElement("textarea"),document.body.appendChild(Et));var i=St(e),n=i.paddingSize,o=i.borderSize,s=i.boxSizing,a=i.contextStyle;Et.setAttribute("style",a+";"+At),Et.value=e.value||e.placeholder||"";var c=Et.scrollHeight,l={};"border-box"===s?c+=o:"content-box"===s&&(c-=n),Et.value="";var u=Et.scrollHeight-n;if(null!==t){var d=u*t;"border-box"===s&&(d=d+n+o),c=Math.max(d,c),l.minHeight=d+"px"}if(null!==r){var h=u*r;"border-box"===s&&(h=h+n+o),c=Math.min(h,c)}return l.height=c+"px",Et.parentNode&&Et.parentNode.removeChild(Et),Et=null,l}var Tt=r(7),bt=r.n(Tt),It=r(19),Rt={name:"ElInput",componentName:"ElInput",mixins:[w.a,I.a],inheritAttrs:!1,inject:{elForm:{default:""},elFormItem:{default:""}},data:function(){return{textareaCalcStyle:{},hovering:!1,focused:!1,isComposing:!1,passwordVisible:!1}},props:{value:[String,Number],size:String,resize:String,form:String,disabled:Boolean,readonly:Boolean,type:{type:String,default:"text"},autosize:{type:[Boolean,Object],default:!1},autocomplete:{type:String,default:"off"},autoComplete:{type:String,validator:function(e){return!0}},validateEvent:{type:Boolean,default:!0},suffixIcon:String,prefixIcon:String,label:String,clearable:{type:Boolean,default:!1},showPassword:{type:Boolean,default:!1},showWordLimit:{type:Boolean,default:!1},tabindex:String},computed:{_elFormItemSize:function(){return(this.elFormItem||{}).elFormItemSize},validateState:function(){return this.elFormItem?this.elFormItem.validateState:""},needStatusIcon:function(){return!!this.elForm&&this.elForm.statusIcon},validateIcon:function(){return{validating:"el-icon-loading",success:"el-icon-circle-check",error:"el-icon-circle-close"}[this.validateState]},textareaStyle:function(){return bt()({},this.textareaCalcStyle,{resize:this.resize})},inputSize:function(){return this.size||this._elFormItemSize||(this.$ELEMENT||{}).size},inputDisabled:function(){return this.disabled||(this.elForm||{}).disabled},nativeInputValue:function(){return null===this.value||void 0===this.value?"":String(this.value)},showClear:function(){return this.clearable&&!this.inputDisabled&&!this.readonly&&this.nativeInputValue&&(this.focused||this.hovering)},showPwdVisible:function(){return this.showPassword&&!this.inputDisabled&&!this.readonly&&(!!this.nativeInputValue||this.focused)},isWordLimitVisible:function(){return this.showWordLimit&&this.$attrs.maxlength&&("text"===this.type||"textarea"===this.type)&&!this.inputDisabled&&!this.readonly&&!this.showPassword},upperLimit:function(){return this.$attrs.maxlength},textLength:function(){return"number"===typeof this.value?String(this.value).length:(this.value||"").length},inputExceed:function(){return this.isWordLimitVisible&&this.textLength>this.upperLimit}},watch:{value:function(e){this.$nextTick(this.resizeTextarea),this.validateEvent&&this.dispatch("ElFormItem","el.form.change",[e])},nativeInputValue:function(){this.setNativeInputValue()},type:function(){var e=this;this.$nextTick((function(){e.setNativeInputValue(),e.resizeTextarea(),e.updateIconOffset()}))}},methods:{focus:function(){this.getInput().focus()},blur:function(){this.getInput().blur()},getMigratingConfig:function(){return{props:{icon:"icon is removed, use suffix-icon / prefix-icon instead.","on-icon-click":"on-icon-click is removed."},events:{click:"click is removed."}}},handleBlur:function(e){this.focused=!1,this.$emit("blur",e),this.validateEvent&&this.dispatch("ElFormItem","el.form.blur",[this.value])},select:function(){this.getInput().select()},resizeTextarea:function(){if(!this.$isServer){var e=this.autosize,t=this.type;if("textarea"===t)if(e){var r=e.minRows,i=e.maxRows;this.textareaCalcStyle=Ct(this.$refs.textarea,r,i)}else this.textareaCalcStyle={minHeight:Ct(this.$refs.textarea).minHeight}}},setNativeInputValue:function(){var e=this.getInput();e&&e.value!==this.nativeInputValue&&(e.value=this.nativeInputValue)},handleFocus:function(e){this.focused=!0,this.$emit("focus",e)},handleCompositionStart:function(){this.isComposing=!0},handleCompositionUpdate:function(e){var t=e.target.value,r=t[t.length-1]||"";this.isComposing=!Object(It["isKorean"])(r)},handleCompositionEnd:function(e){this.isComposing&&(this.isComposing=!1,this.handleInput(e))},handleInput:function(e){this.isComposing||e.target.value!==this.nativeInputValue&&(this.$emit("input",e.target.value),this.$nextTick(this.setNativeInputValue))},handleChange:function(e){this.$emit("change",e.target.value)},calcIconOffset:function(e){var t=[].slice.call(this.$el.querySelectorAll(".el-input__"+e)||[]);if(t.length){for(var r=null,i=0;i<t.length;i++)if(t[i].parentNode===this.$el){r=t[i];break}if(r){var n={suffix:"append",prefix:"prepend"},o=n[e];this.$slots[o]?r.style.transform="translateX("+("suffix"===e?"-":"")+this.$el.querySelector(".el-input-group__"+o).offsetWidth+"px)":r.removeAttribute("style")}}},updateIconOffset:function(){this.calcIconOffset("prefix"),this.calcIconOffset("suffix")},clear:function(){this.$emit("input",""),this.$emit("change",""),this.$emit("clear")},handlePasswordVisible:function(){var e=this;this.passwordVisible=!this.passwordVisible,this.$nextTick((function(){e.focus()}))},getInput:function(){return this.$refs.input||this.$refs.textarea},getSuffixVisible:function(){return this.$slots.suffix||this.suffixIcon||this.showClear||this.showPassword||this.isWordLimitVisible||this.validateState&&this.needStatusIcon}},created:function(){this.$on("inputSelect",this.select)},mounted:function(){this.setNativeInputValue(),this.resizeTextarea(),this.updateIconOffset()},updated:function(){this.$nextTick(this.updateIconOffset)}},wt=Rt,kt=a(wt,_t,vt,!1,null,null,null);kt.options.__file="packages/input/src/input.vue";var Ot=kt.exports;Ot.install=function(e){e.component(Ot.name,Ot)};var Nt=Ot,Lt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:["el-input-number",e.inputNumberSize?"el-input-number--"+e.inputNumberSize:"",{"is-disabled":e.inputNumberDisabled},{"is-without-controls":!e.controls},{"is-controls-right":e.controlsAtRight}],on:{dragstart:function(e){e.preventDefault()}}},[e.controls?r("span",{directives:[{name:"repeat-click",rawName:"v-repeat-click",value:e.decrease,expression:"decrease"}],staticClass:"el-input-number__decrease",class:{"is-disabled":e.minDisabled},attrs:{role:"button"},on:{keydown:function(t){return!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.decrease(t)}}},[r("i",{class:"el-icon-"+(e.controlsAtRight?"arrow-down":"minus")})]):e._e(),e.controls?r("span",{directives:[{name:"repeat-click",rawName:"v-repeat-click",value:e.increase,expression:"increase"}],staticClass:"el-input-number__increase",class:{"is-disabled":e.maxDisabled},attrs:{role:"button"},on:{keydown:function(t){return!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.increase(t)}}},[r("i",{class:"el-icon-"+(e.controlsAtRight?"arrow-up":"plus")})]):e._e(),r("el-input",{ref:"input",attrs:{value:e.displayValue,placeholder:e.placeholder,disabled:e.inputNumberDisabled,size:e.inputNumberSize,max:e.max,min:e.min,name:e.name,label:e.label},on:{blur:e.handleBlur,focus:e.handleFocus,input:e.handleInput,change:e.handleInputChange},nativeOn:{keydown:[function(t){return!("button"in t)&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:(t.preventDefault(),e.increase(t))},function(t){return!("button"in t)&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:(t.preventDefault(),e.decrease(t))}]}})],1)},Pt=[];Lt._withStripped=!0;var Dt={bind:function(e,t,r){var i=null,n=void 0,o=function(){return r.context[t.expression].apply()},s=function(){Date.now()-n<100&&o(),clearInterval(i),i=null};Object(Ue["on"])(e,"mousedown",(function(e){0===e.button&&(n=Date.now(),Object(Ue["once"])(document,"mouseup",s),clearInterval(i),i=setInterval(o,100))}))}},Mt={name:"ElInputNumber",mixins:[$()("input")],inject:{elForm:{default:""},elFormItem:{default:""}},directives:{repeatClick:Dt},components:{ElInput:g.a},props:{step:{type:Number,default:1},stepStrictly:{type:Boolean,default:!1},max:{type:Number,default:1/0},min:{type:Number,default:-1/0},value:{},disabled:Boolean,size:String,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:""},name:String,label:String,placeholder:String,precision:{type:Number,validator:function(e){return e>=0&&e===parseInt(e,10)}}},data:function(){return{currentValue:0,userInput:null}},watch:{value:{immediate:!0,handler:function(e){var t=void 0===e?e:Number(e);if(void 0!==t){if(isNaN(t))return;if(this.stepStrictly){var r=this.getPrecision(this.step),i=Math.pow(10,r);t=Math.round(t/this.step)*i*this.step/i}void 0!==this.precision&&(t=this.toPrecision(t,this.precision))}t>=this.max&&(t=this.max),t<=this.min&&(t=this.min),this.currentValue=t,this.userInput=null,this.$emit("input",t)}}},computed:{minDisabled:function(){return this._decrease(this.value,this.step)<this.min},maxDisabled:function(){return this._increase(this.value,this.step)>this.max},numPrecision:function(){var e=this.value,t=this.step,r=this.getPrecision,i=this.precision,n=r(t);return void 0!==i?(n>i&&console.warn("[Element Warn][InputNumber]precision should not be less than the decimal places of step"),i):Math.max(r(e),n)},controlsAtRight:function(){return this.controls&&"right"===this.controlsPosition},_elFormItemSize:function(){return(this.elFormItem||{}).elFormItemSize},inputNumberSize:function(){return this.size||this._elFormItemSize||(this.$ELEMENT||{}).size},inputNumberDisabled:function(){return this.disabled||!!(this.elForm||{}).disabled},displayValue:function(){if(null!==this.userInput)return this.userInput;var e=this.currentValue;if("number"===typeof e){if(this.stepStrictly){var t=this.getPrecision(this.step),r=Math.pow(10,t);e=Math.round(e/this.step)*r*this.step/r}void 0!==this.precision&&(e=e.toFixed(this.precision))}return e}},methods:{toPrecision:function(e,t){return void 0===t&&(t=this.numPrecision),parseFloat(Math.round(e*Math.pow(10,t))/Math.pow(10,t))},getPrecision:function(e){if(void 0===e)return 0;var t=e.toString(),r=t.indexOf("."),i=0;return-1!==r&&(i=t.length-r-1),i},_increase:function(e,t){if("number"!==typeof e&&void 0!==e)return this.currentValue;var r=Math.pow(10,this.numPrecision);return this.toPrecision((r*e+r*t)/r)},_decrease:function(e,t){if("number"!==typeof e&&void 0!==e)return this.currentValue;var r=Math.pow(10,this.numPrecision);return this.toPrecision((r*e-r*t)/r)},increase:function(){if(!this.inputNumberDisabled&&!this.maxDisabled){var e=this.value||0,t=this._increase(e,this.step);this.setCurrentValue(t)}},decrease:function(){if(!this.inputNumberDisabled&&!this.minDisabled){var e=this.value||0,t=this._decrease(e,this.step);this.setCurrentValue(t)}},handleBlur:function(e){this.$emit("blur",e)},handleFocus:function(e){this.$emit("focus",e)},setCurrentValue:function(e){var t=this.currentValue;"number"===typeof e&&void 0!==this.precision&&(e=this.toPrecision(e,this.precision)),e>=this.max&&(e=this.max),e<=this.min&&(e=this.min),t!==e&&(this.userInput=null,this.$emit("input",e),this.$emit("change",e,t),this.currentValue=e)},handleInput:function(e){this.userInput=e},handleInputChange:function(e){var t=""===e?void 0:Number(e);isNaN(t)&&""!==e||this.setCurrentValue(t),this.userInput=null},select:function(){this.$refs.input.select()}},mounted:function(){var e=this.$refs.input.$refs.input;e.setAttribute("role","spinbutton"),e.setAttribute("aria-valuemax",this.max),e.setAttribute("aria-valuemin",this.min),e.setAttribute("aria-valuenow",this.currentValue),e.setAttribute("aria-disabled",this.inputNumberDisabled)},updated:function(){if(this.$refs&&this.$refs.input){var e=this.$refs.input.$refs.input;e.setAttribute("aria-valuenow",this.currentValue)}}},xt=Mt,Bt=a(xt,Lt,Pt,!1,null,null,null);Bt.options.__file="packages/input-number/src/input-number.vue";var Ut=Bt.exports;Ut.install=function(e){e.component(Ut.name,Ut)};var Ft=Ut,Vt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("label",{staticClass:"el-radio",class:[e.border&&e.radioSize?"el-radio--"+e.radioSize:"",{"is-disabled":e.isDisabled},{"is-focus":e.focus},{"is-bordered":e.border},{"is-checked":e.model===e.label}],attrs:{role:"radio","aria-checked":e.model===e.label,"aria-disabled":e.isDisabled,tabindex:e.tabIndex},on:{keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"]))return null;t.stopPropagation(),t.preventDefault(),e.model=e.isDisabled?e.model:e.label}}},[r("span",{staticClass:"el-radio__input",class:{"is-disabled":e.isDisabled,"is-checked":e.model===e.label}},[r("span",{staticClass:"el-radio__inner"}),r("input",{directives:[{name:"model",rawName:"v-model",value:e.model,expression:"model"}],ref:"radio",staticClass:"el-radio__original",attrs:{type:"radio","aria-hidden":"true",name:e.name,disabled:e.isDisabled,tabindex:"-1",autocomplete:"off"},domProps:{value:e.label,checked:e._q(e.model,e.label)},on:{focus:function(t){e.focus=!0},blur:function(t){e.focus=!1},change:[function(t){e.model=e.label},e.handleChange]}})]),r("span",{staticClass:"el-radio__label",on:{keydown:function(e){e.stopPropagation()}}},[e._t("default"),e.$slots.default?e._e():[e._v(e._s(e.label))]],2)])},jt=[];Vt._withStripped=!0;var Gt={name:"ElRadio",mixins:[w.a],inject:{elForm:{default:""},elFormItem:{default:""}},componentName:"ElRadio",props:{value:{},label:{},disabled:Boolean,name:String,border:Boolean,size:String},data:function(){return{focus:!1}},computed:{isGroup:function(){var e=this.$parent;while(e){if("ElRadioGroup"===e.$options.componentName)return this._radioGroup=e,!0;e=e.$parent}return!1},model:{get:function(){return this.isGroup?this._radioGroup.value:this.value},set:function(e){this.isGroup?this.dispatch("ElRadioGroup","input",[e]):this.$emit("input",e),this.$refs.radio&&(this.$refs.radio.checked=this.model===this.label)}},_elFormItemSize:function(){return(this.elFormItem||{}).elFormItemSize},radioSize:function(){var e=this.size||this._elFormItemSize||(this.$ELEMENT||{}).size;return this.isGroup&&this._radioGroup.radioGroupSize||e},isDisabled:function(){return this.isGroup?this._radioGroup.disabled||this.disabled||(this.elForm||{}).disabled:this.disabled||(this.elForm||{}).disabled},tabIndex:function(){return this.isDisabled||this.isGroup&&this.model!==this.label?-1:0}},methods:{handleChange:function(){var e=this;this.$nextTick((function(){e.$emit("change",e.model),e.isGroup&&e.dispatch("ElRadioGroup","handleChange",e.model)}))}}},Ht=Gt,Qt=a(Ht,Vt,jt,!1,null,null,null);Qt.options.__file="packages/radio/src/radio.vue";var Wt=Qt.exports;Wt.install=function(e){e.component(Wt.name,Wt)};var qt=Wt,zt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r(e._elTag,{tag:"component",staticClass:"el-radio-group",attrs:{role:"radiogroup"},on:{keydown:e.handleKeydown}},[e._t("default")],2)},Zt=[];zt._withStripped=!0;var Yt=Object.freeze({LEFT:37,UP:38,RIGHT:39,DOWN:40}),Kt={name:"ElRadioGroup",componentName:"ElRadioGroup",inject:{elFormItem:{default:""}},mixins:[w.a],props:{value:{},size:String,fill:String,textColor:String,disabled:Boolean},computed:{_elFormItemSize:function(){return(this.elFormItem||{}).elFormItemSize},_elTag:function(){var e=(this.$vnode.data||{}).tag;return e&&"component"!==e||(e="div"),e},radioGroupSize:function(){return this.size||this._elFormItemSize||(this.$ELEMENT||{}).size}},created:function(){var e=this;this.$on("handleChange",(function(t){e.$emit("change",t)}))},mounted:function(){var e=this.$el.querySelectorAll("[type=radio]"),t=this.$el.querySelectorAll("[role=radio]")[0];![].some.call(e,(function(e){return e.checked}))&&t&&(t.tabIndex=0)},methods:{handleKeydown:function(e){var t=e.target,r="INPUT"===t.nodeName?"[type=radio]":"[role=radio]",i=this.$el.querySelectorAll(r),n=i.length,o=[].indexOf.call(i,t),s=this.$el.querySelectorAll("[role=radio]");switch(e.keyCode){case Yt.LEFT:case Yt.UP:e.stopPropagation(),e.preventDefault(),0===o?(s[n-1].click(),s[n-1].focus()):(s[o-1].click(),s[o-1].focus());break;case Yt.RIGHT:case Yt.DOWN:o===n-1?(e.stopPropagation(),e.preventDefault(),s[0].click(),s[0].focus()):(s[o+1].click(),s[o+1].focus());break;default:break}}},watch:{value:function(e){this.dispatch("ElFormItem","el.form.change",[this.value])}}},$t=Kt,Jt=a($t,zt,Zt,!1,null,null,null);Jt.options.__file="packages/radio/src/radio-group.vue";var Xt=Jt.exports;Xt.install=function(e){e.component(Xt.name,Xt)};var er=Xt,tr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("label",{staticClass:"el-radio-button",class:[e.size?"el-radio-button--"+e.size:"",{"is-active":e.value===e.label},{"is-disabled":e.isDisabled},{"is-focus":e.focus}],attrs:{role:"radio","aria-checked":e.value===e.label,"aria-disabled":e.isDisabled,tabindex:e.tabIndex},on:{keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"]))return null;t.stopPropagation(),t.preventDefault(),e.value=e.isDisabled?e.value:e.label}}},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],staticClass:"el-radio-button__orig-radio",attrs:{type:"radio",name:e.name,disabled:e.isDisabled,tabindex:"-1",autocomplete:"off"},domProps:{value:e.label,checked:e._q(e.value,e.label)},on:{change:[function(t){e.value=e.label},e.handleChange],focus:function(t){e.focus=!0},blur:function(t){e.focus=!1}}}),r("span",{staticClass:"el-radio-button__inner",style:e.value===e.label?e.activeStyle:null,on:{keydown:function(e){e.stopPropagation()}}},[e._t("default"),e.$slots.default?e._e():[e._v(e._s(e.label))]],2)])},rr=[];tr._withStripped=!0;var ir={name:"ElRadioButton",mixins:[w.a],inject:{elForm:{default:""},elFormItem:{default:""}},props:{label:{},disabled:Boolean,name:String},data:function(){return{focus:!1}},computed:{value:{get:function(){return this._radioGroup.value},set:function(e){this._radioGroup.$emit("input",e)}},_radioGroup:function(){var e=this.$parent;while(e){if("ElRadioGroup"===e.$options.componentName)return e;e=e.$parent}return!1},activeStyle:function(){return{backgroundColor:this._radioGroup.fill||"",borderColor:this._radioGroup.fill||"",boxShadow:this._radioGroup.fill?"-1px 0 0 0 "+this._radioGroup.fill:"",color:this._radioGroup.textColor||""}},_elFormItemSize:function(){return(this.elFormItem||{}).elFormItemSize},size:function(){return this._radioGroup.radioGroupSize||this._elFormItemSize||(this.$ELEMENT||{}).size},isDisabled:function(){return this.disabled||this._radioGroup.disabled||(this.elForm||{}).disabled},tabIndex:function(){return this.isDisabled||this._radioGroup&&this.value!==this.label?-1:0}},methods:{handleChange:function(){var e=this;this.$nextTick((function(){e.dispatch("ElRadioGroup","handleChange",e.value)}))}}},nr=ir,or=a(nr,tr,rr,!1,null,null,null);or.options.__file="packages/radio/src/radio-button.vue";var sr=or.exports;sr.install=function(e){e.component(sr.name,sr)};var ar=sr,cr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("label",{staticClass:"el-checkbox",class:[e.border&&e.checkboxSize?"el-checkbox--"+e.checkboxSize:"",{"is-disabled":e.isDisabled},{"is-bordered":e.border},{"is-checked":e.isChecked}],attrs:{id:e.id}},[r("span",{staticClass:"el-checkbox__input",class:{"is-disabled":e.isDisabled,"is-checked":e.isChecked,"is-indeterminate":e.indeterminate,"is-focus":e.focus},attrs:{tabindex:!!e.indeterminate&&0,role:!!e.indeterminate&&"checkbox","aria-checked":!!e.indeterminate&&"mixed"}},[r("span",{staticClass:"el-checkbox__inner"}),e.trueLabel||e.falseLabel?r("input",{directives:[{name:"model",rawName:"v-model",value:e.model,expression:"model"}],staticClass:"el-checkbox__original",attrs:{type:"checkbox","aria-hidden":e.indeterminate?"true":"false",name:e.name,disabled:e.isDisabled,"true-value":e.trueLabel,"false-value":e.falseLabel},domProps:{checked:Array.isArray(e.model)?e._i(e.model,null)>-1:e._q(e.model,e.trueLabel)},on:{change:[function(t){var r=e.model,i=t.target,n=i.checked?e.trueLabel:e.falseLabel;if(Array.isArray(r)){var o=null,s=e._i(r,o);i.checked?s<0&&(e.model=r.concat([o])):s>-1&&(e.model=r.slice(0,s).concat(r.slice(s+1)))}else e.model=n},e.handleChange],focus:function(t){e.focus=!0},blur:function(t){e.focus=!1}}}):r("input",{directives:[{name:"model",rawName:"v-model",value:e.model,expression:"model"}],staticClass:"el-checkbox__original",attrs:{type:"checkbox","aria-hidden":e.indeterminate?"true":"false",disabled:e.isDisabled,name:e.name},domProps:{value:e.label,checked:Array.isArray(e.model)?e._i(e.model,e.label)>-1:e.model},on:{change:[function(t){var r=e.model,i=t.target,n=!!i.checked;if(Array.isArray(r)){var o=e.label,s=e._i(r,o);i.checked?s<0&&(e.model=r.concat([o])):s>-1&&(e.model=r.slice(0,s).concat(r.slice(s+1)))}else e.model=n},e.handleChange],focus:function(t){e.focus=!0},blur:function(t){e.focus=!1}}})]),e.$slots.default||e.label?r("span",{staticClass:"el-checkbox__label"},[e._t("default"),e.$slots.default?e._e():[e._v(e._s(e.label))]],2):e._e()])},lr=[];cr._withStripped=!0;var ur={name:"ElCheckbox",mixins:[w.a],inject:{elForm:{default:""},elFormItem:{default:""}},componentName:"ElCheckbox",data:function(){return{selfModel:!1,focus:!1,isLimitExceeded:!1}},computed:{model:{get:function(){return this.isGroup?this.store:void 0!==this.value?this.value:this.selfModel},set:function(e){this.isGroup?(this.isLimitExceeded=!1,void 0!==this._checkboxGroup.min&&e.length<this._checkboxGroup.min&&(this.isLimitExceeded=!0),void 0!==this._checkboxGroup.max&&e.length>this._checkboxGroup.max&&(this.isLimitExceeded=!0),!1===this.isLimitExceeded&&this.dispatch("ElCheckboxGroup","input",[e])):(this.$emit("input",e),this.selfModel=e)}},isChecked:function(){return"[object Boolean]"==={}.toString.call(this.model)?this.model:Array.isArray(this.model)?this.model.indexOf(this.label)>-1:null!==this.model&&void 0!==this.model?this.model===this.trueLabel:void 0},isGroup:function(){var e=this.$parent;while(e){if("ElCheckboxGroup"===e.$options.componentName)return this._checkboxGroup=e,!0;e=e.$parent}return!1},store:function(){return this._checkboxGroup?this._checkboxGroup.value:this.value},isLimitDisabled:function(){var e=this._checkboxGroup,t=e.max,r=e.min;return!(!t&&!r)&&this.model.length>=t&&!this.isChecked||this.model.length<=r&&this.isChecked},isDisabled:function(){return this.isGroup?this._checkboxGroup.disabled||this.disabled||(this.elForm||{}).disabled||this.isLimitDisabled:this.disabled||(this.elForm||{}).disabled},_elFormItemSize:function(){return(this.elFormItem||{}).elFormItemSize},checkboxSize:function(){var e=this.size||this._elFormItemSize||(this.$ELEMENT||{}).size;return this.isGroup&&this._checkboxGroup.checkboxGroupSize||e}},props:{value:{},label:{},indeterminate:Boolean,disabled:Boolean,checked:Boolean,name:String,trueLabel:[String,Number],falseLabel:[String,Number],id:String,controls:String,border:Boolean,size:String},methods:{addToStore:function(){Array.isArray(this.model)&&-1===this.model.indexOf(this.label)?this.model.push(this.label):this.model=this.trueLabel||!0},handleChange:function(e){var t=this;if(!this.isLimitExceeded){var r=void 0;r=e.target.checked?void 0===this.trueLabel||this.trueLabel:void 0!==this.falseLabel&&this.falseLabel,this.$emit("change",r,e),this.$nextTick((function(){t.isGroup&&t.dispatch("ElCheckboxGroup","change",[t._checkboxGroup.value])}))}}},created:function(){this.checked&&this.addToStore()},mounted:function(){this.indeterminate&&this.$el.setAttribute("aria-controls",this.controls)},watch:{value:function(e){this.dispatch("ElFormItem","el.form.change",e)}}},dr=ur,hr=a(dr,cr,lr,!1,null,null,null);hr.options.__file="packages/checkbox/src/checkbox.vue";var pr=hr.exports;pr.install=function(e){e.component(pr.name,pr)};var fr=pr,gr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("label",{staticClass:"el-checkbox-button",class:[e.size?"el-checkbox-button--"+e.size:"",{"is-disabled":e.isDisabled},{"is-checked":e.isChecked},{"is-focus":e.focus}],attrs:{role:"checkbox","aria-checked":e.isChecked,"aria-disabled":e.isDisabled}},[e.trueLabel||e.falseLabel?r("input",{directives:[{name:"model",rawName:"v-model",value:e.model,expression:"model"}],staticClass:"el-checkbox-button__original",attrs:{type:"checkbox",name:e.name,disabled:e.isDisabled,"true-value":e.trueLabel,"false-value":e.falseLabel},domProps:{checked:Array.isArray(e.model)?e._i(e.model,null)>-1:e._q(e.model,e.trueLabel)},on:{change:[function(t){var r=e.model,i=t.target,n=i.checked?e.trueLabel:e.falseLabel;if(Array.isArray(r)){var o=null,s=e._i(r,o);i.checked?s<0&&(e.model=r.concat([o])):s>-1&&(e.model=r.slice(0,s).concat(r.slice(s+1)))}else e.model=n},e.handleChange],focus:function(t){e.focus=!0},blur:function(t){e.focus=!1}}}):r("input",{directives:[{name:"model",rawName:"v-model",value:e.model,expression:"model"}],staticClass:"el-checkbox-button__original",attrs:{type:"checkbox",name:e.name,disabled:e.isDisabled},domProps:{value:e.label,checked:Array.isArray(e.model)?e._i(e.model,e.label)>-1:e.model},on:{change:[function(t){var r=e.model,i=t.target,n=!!i.checked;if(Array.isArray(r)){var o=e.label,s=e._i(r,o);i.checked?s<0&&(e.model=r.concat([o])):s>-1&&(e.model=r.slice(0,s).concat(r.slice(s+1)))}else e.model=n},e.handleChange],focus:function(t){e.focus=!0},blur:function(t){e.focus=!1}}}),e.$slots.default||e.label?r("span",{staticClass:"el-checkbox-button__inner",style:e.isChecked?e.activeStyle:null},[e._t("default",[e._v(e._s(e.label))])],2):e._e()])},mr=[];gr._withStripped=!0;var _r={name:"ElCheckboxButton",mixins:[w.a],inject:{elForm:{default:""},elFormItem:{default:""}},data:function(){return{selfModel:!1,focus:!1,isLimitExceeded:!1}},props:{value:{},label:{},disabled:Boolean,checked:Boolean,name:String,trueLabel:[String,Number],falseLabel:[String,Number]},computed:{model:{get:function(){return this._checkboxGroup?this.store:void 0!==this.value?this.value:this.selfModel},set:function(e){this._checkboxGroup?(this.isLimitExceeded=!1,void 0!==this._checkboxGroup.min&&e.length<this._checkboxGroup.min&&(this.isLimitExceeded=!0),void 0!==this._checkboxGroup.max&&e.length>this._checkboxGroup.max&&(this.isLimitExceeded=!0),!1===this.isLimitExceeded&&this.dispatch("ElCheckboxGroup","input",[e])):void 0!==this.value?this.$emit("input",e):this.selfModel=e}},isChecked:function(){return"[object Boolean]"==={}.toString.call(this.model)?this.model:Array.isArray(this.model)?this.model.indexOf(this.label)>-1:null!==this.model&&void 0!==this.model?this.model===this.trueLabel:void 0},_checkboxGroup:function(){var e=this.$parent;while(e){if("ElCheckboxGroup"===e.$options.componentName)return e;e=e.$parent}return!1},store:function(){return this._checkboxGroup?this._checkboxGroup.value:this.value},activeStyle:function(){return{backgroundColor:this._checkboxGroup.fill||"",borderColor:this._checkboxGroup.fill||"",color:this._checkboxGroup.textColor||"","box-shadow":"-1px 0 0 0 "+this._checkboxGroup.fill}},_elFormItemSize:function(){return(this.elFormItem||{}).elFormItemSize},size:function(){return this._checkboxGroup.checkboxGroupSize||this._elFormItemSize||(this.$ELEMENT||{}).size},isLimitDisabled:function(){var e=this._checkboxGroup,t=e.max,r=e.min;return!(!t&&!r)&&this.model.length>=t&&!this.isChecked||this.model.length<=r&&this.isChecked},isDisabled:function(){return this._checkboxGroup?this._checkboxGroup.disabled||this.disabled||(this.elForm||{}).disabled||this.isLimitDisabled:this.disabled||(this.elForm||{}).disabled}},methods:{addToStore:function(){Array.isArray(this.model)&&-1===this.model.indexOf(this.label)?this.model.push(this.label):this.model=this.trueLabel||!0},handleChange:function(e){var t=this;if(!this.isLimitExceeded){var r=void 0;r=e.target.checked?void 0===this.trueLabel||this.trueLabel:void 0!==this.falseLabel&&this.falseLabel,this.$emit("change",r,e),this.$nextTick((function(){t._checkboxGroup&&t.dispatch("ElCheckboxGroup","change",[t._checkboxGroup.value])}))}}},created:function(){this.checked&&this.addToStore()}},vr=_r,Er=a(vr,gr,mr,!1,null,null,null);Er.options.__file="packages/checkbox/src/checkbox-button.vue";var Ar=Er.exports;Ar.install=function(e){e.component(Ar.name,Ar)};var yr=Ar,Sr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-checkbox-group",attrs:{role:"group","aria-label":"checkbox-group"}},[e._t("default")],2)},Cr=[];Sr._withStripped=!0;var Tr={name:"ElCheckboxGroup",componentName:"ElCheckboxGroup",mixins:[w.a],inject:{elFormItem:{default:""}},props:{value:{},disabled:Boolean,min:Number,max:Number,size:String,fill:String,textColor:String},computed:{_elFormItemSize:function(){return(this.elFormItem||{}).elFormItemSize},checkboxGroupSize:function(){return this.size||this._elFormItemSize||(this.$ELEMENT||{}).size}},watch:{value:function(e){this.dispatch("ElFormItem","el.form.change",[e])}}},br=Tr,Ir=a(br,Sr,Cr,!1,null,null,null);Ir.options.__file="packages/checkbox/src/checkbox-group.vue";var Rr=Ir.exports;Rr.install=function(e){e.component(Rr.name,Rr)};var wr=Rr,kr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-switch",class:{"is-disabled":e.switchDisabled,"is-checked":e.checked},attrs:{role:"switch","aria-checked":e.checked,"aria-disabled":e.switchDisabled},on:{click:function(t){return t.preventDefault(),e.switchValue(t)}}},[r("input",{ref:"input",staticClass:"el-switch__input",attrs:{type:"checkbox",id:e.id,name:e.name,"true-value":e.activeValue,"false-value":e.inactiveValue,disabled:e.switchDisabled},on:{change:e.handleChange,keydown:function(t){return!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.switchValue(t)}}}),e.inactiveIconClass||e.inactiveText?r("span",{class:["el-switch__label","el-switch__label--left",e.checked?"":"is-active"]},[e.inactiveIconClass?r("i",{class:[e.inactiveIconClass]}):e._e(),!e.inactiveIconClass&&e.inactiveText?r("span",{attrs:{"aria-hidden":e.checked}},[e._v(e._s(e.inactiveText))]):e._e()]):e._e(),r("span",{ref:"core",staticClass:"el-switch__core",style:{width:e.coreWidth+"px"}}),e.activeIconClass||e.activeText?r("span",{class:["el-switch__label","el-switch__label--right",e.checked?"is-active":""]},[e.activeIconClass?r("i",{class:[e.activeIconClass]}):e._e(),!e.activeIconClass&&e.activeText?r("span",{attrs:{"aria-hidden":!e.checked}},[e._v(e._s(e.activeText))]):e._e()]):e._e()])},Or=[];kr._withStripped=!0;var Nr={name:"ElSwitch",mixins:[$()("input"),I.a,w.a],inject:{elForm:{default:""}},props:{value:{type:[Boolean,String,Number],default:!1},disabled:{type:Boolean,default:!1},width:{type:Number,default:40},activeIconClass:{type:String,default:""},inactiveIconClass:{type:String,default:""},activeText:String,inactiveText:String,activeColor:{type:String,default:""},inactiveColor:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},id:String},data:function(){return{coreWidth:this.width}},created:function(){~[this.activeValue,this.inactiveValue].indexOf(this.value)||this.$emit("input",this.inactiveValue)},computed:{checked:function(){return this.value===this.activeValue},switchDisabled:function(){return this.disabled||(this.elForm||{}).disabled}},watch:{checked:function(){this.$refs.input.checked=this.checked,(this.activeColor||this.inactiveColor)&&this.setBackgroundColor(),this.validateEvent&&this.dispatch("ElFormItem","el.form.change",[this.value])}},methods:{handleChange:function(e){var t=this,r=this.checked?this.inactiveValue:this.activeValue;this.$emit("input",r),this.$emit("change",r),this.$nextTick((function(){t.$refs.input.checked=t.checked}))},setBackgroundColor:function(){var e=this.checked?this.activeColor:this.inactiveColor;this.$refs.core.style.borderColor=e,this.$refs.core.style.backgroundColor=e},switchValue:function(){!this.switchDisabled&&this.handleChange()},getMigratingConfig:function(){return{props:{"on-color":"on-color is renamed to active-color.","off-color":"off-color is renamed to inactive-color.","on-text":"on-text is renamed to active-text.","off-text":"off-text is renamed to inactive-text.","on-value":"on-value is renamed to active-value.","off-value":"off-value is renamed to inactive-value.","on-icon-class":"on-icon-class is renamed to active-icon-class.","off-icon-class":"off-icon-class is renamed to inactive-icon-class."}}}},mounted:function(){this.coreWidth=this.width||40,(this.activeColor||this.inactiveColor)&&this.setBackgroundColor(),this.$refs.input.checked=this.checked}},Lr=Nr,Pr=a(Lr,kr,Or,!1,null,null,null);Pr.options.__file="packages/switch/src/component.vue";var Dr=Pr.exports;Dr.install=function(e){e.component(Dr.name,Dr)};var Mr=Dr,xr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.handleClose,expression:"handleClose"}],staticClass:"el-select",class:[e.selectSize?"el-select--"+e.selectSize:""],on:{click:function(t){return t.stopPropagation(),e.toggleMenu(t)}}},[e.multiple?r("div",{ref:"tags",staticClass:"el-select__tags",style:{"max-width":e.inputWidth-32+"px",width:"100%"}},[e.collapseTags&&e.selected.length?r("span",[r("el-tag",{attrs:{closable:!e.selectDisabled,size:e.collapseTagSize,hit:e.selected[0].hitState,type:"info","disable-transitions":""},on:{close:function(t){e.deleteTag(t,e.selected[0])}}},[r("span",{staticClass:"el-select__tags-text"},[e._v(e._s(e.selected[0].currentLabel))])]),e.selected.length>1?r("el-tag",{attrs:{closable:!1,size:e.collapseTagSize,type:"info","disable-transitions":""}},[r("span",{staticClass:"el-select__tags-text"},[e._v("+ "+e._s(e.selected.length-1))])]):e._e()],1):e._e(),e.collapseTags?e._e():r("transition-group",{on:{"after-leave":e.resetInputHeight}},e._l(e.selected,(function(t){return r("el-tag",{key:e.getValueKey(t),attrs:{closable:!e.selectDisabled,size:e.collapseTagSize,hit:t.hitState,type:"info","disable-transitions":""},on:{close:function(r){e.deleteTag(r,t)}}},[r("span",{staticClass:"el-select__tags-text"},[e._v(e._s(t.currentLabel))])])})),1),e.filterable?r("input",{directives:[{name:"model",rawName:"v-model",value:e.query,expression:"query"}],ref:"input",staticClass:"el-select__input",class:[e.selectSize?"is-"+e.selectSize:""],style:{"flex-grow":"1",width:e.inputLength/(e.inputWidth-32)+"%","max-width":e.inputWidth-42+"px"},attrs:{type:"text",disabled:e.selectDisabled,autocomplete:e.autoComplete||e.autocomplete},domProps:{value:e.query},on:{focus:e.handleFocus,blur:function(t){e.softFocus=!1},keyup:e.managePlaceholder,keydown:[e.resetInputState,function(t){if(!("button"in t)&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"]))return null;t.preventDefault(),e.navigateOptions("next")},function(t){if(!("button"in t)&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"]))return null;t.preventDefault(),e.navigateOptions("prev")},function(t){return!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.selectOption(t))},function(t){if(!("button"in t)&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"]))return null;t.stopPropagation(),t.preventDefault(),e.visible=!1},function(t){return!("button"in t)&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete","Del"])?null:e.deletePrevTag(t)},function(t){if(!("button"in t)&&e._k(t.keyCode,"tab",9,t.key,"Tab"))return null;e.visible=!1}],compositionstart:e.handleComposition,compositionupdate:e.handleComposition,compositionend:e.handleComposition,input:[function(t){t.target.composing||(e.query=t.target.value)},e.debouncedQueryChange]}}):e._e()],1):e._e(),r("el-input",{ref:"reference",class:{"is-focus":e.visible},attrs:{type:"text",placeholder:e.currentPlaceholder,name:e.name,id:e.id,autocomplete:e.autoComplete||e.autocomplete,size:e.selectSize,disabled:e.selectDisabled,readonly:e.readonly,"validate-event":!1,tabindex:e.multiple&&e.filterable?"-1":null},on:{focus:e.handleFocus,blur:e.handleBlur,input:e.debouncedOnInputChange},nativeOn:{keydown:[function(t){if(!("button"in t)&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"]))return null;t.stopPropagation(),t.preventDefault(),e.navigateOptions("next")},function(t){if(!("button"in t)&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"]))return null;t.stopPropagation(),t.preventDefault(),e.navigateOptions("prev")},function(t){return!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.selectOption(t))},function(t){if(!("button"in t)&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"]))return null;t.stopPropagation(),t.preventDefault(),e.visible=!1},function(t){if(!("button"in t)&&e._k(t.keyCode,"tab",9,t.key,"Tab"))return null;e.visible=!1}],mouseenter:function(t){e.inputHovering=!0},mouseleave:function(t){e.inputHovering=!1}},model:{value:e.selectedLabel,callback:function(t){e.selectedLabel=t},expression:"selectedLabel"}},[e.$slots.prefix?r("template",{slot:"prefix"},[e._t("prefix")],2):e._e(),r("template",{slot:"suffix"},[r("i",{directives:[{name:"show",rawName:"v-show",value:!e.showClose,expression:"!showClose"}],class:["el-select__caret","el-input__icon","el-icon-"+e.iconClass]}),e.showClose?r("i",{staticClass:"el-select__caret el-input__icon el-icon-circle-close",on:{click:e.handleClearClick}}):e._e()])],2),r("transition",{attrs:{name:"el-zoom-in-top"},on:{"before-enter":e.handleMenuEnter,"after-leave":e.doDestroy}},[r("el-select-menu",{directives:[{name:"show",rawName:"v-show",value:e.visible&&!1!==e.emptyText,expression:"visible && emptyText !== false"}],ref:"popper",attrs:{"append-to-body":e.popperAppendToBody}},[r("el-scrollbar",{directives:[{name:"show",rawName:"v-show",value:e.options.length>0&&!e.loading,expression:"options.length > 0 && !loading"}],ref:"scrollbar",class:{"is-empty":!e.allowCreate&&e.query&&0===e.filteredOptionsCount},attrs:{tag:"ul","wrap-class":"el-select-dropdown__wrap","view-class":"el-select-dropdown__list"}},[e.showNewOption?r("el-option",{attrs:{value:e.query,created:""}}):e._e(),e._t("default")],2),e.emptyText&&(!e.allowCreate||e.loading||e.allowCreate&&0===e.options.length)?[e.$slots.empty?e._t("empty"):r("p",{staticClass:"el-select-dropdown__empty"},[e._v("\n          "+e._s(e.emptyText)+"\n        ")])]:e._e()],2)],1)],1)},Br=[];xr._withStripped=!0;var Ur=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-select-dropdown el-popper",class:[{"is-multiple":e.$parent.multiple},e.popperClass],style:{minWidth:e.minWidth}},[e._t("default")],2)},Fr=[];Ur._withStripped=!0;var Vr={name:"ElSelectDropdown",componentName:"ElSelectDropdown",mixins:[H.a],props:{placement:{default:"bottom-start"},boundariesPadding:{default:0},popperOptions:{default:function(){return{gpuAcceleration:!1}}},visibleArrow:{default:!0},appendToBody:{type:Boolean,default:!0}},data:function(){return{minWidth:""}},computed:{popperClass:function(){return this.$parent.popperClass}},watch:{"$parent.inputWidth":function(){this.minWidth=this.$parent.$el.getBoundingClientRect().width+"px"}},mounted:function(){var e=this;this.referenceElm=this.$parent.$refs.reference.$el,this.$parent.popperElm=this.popperElm=this.$el,this.$on("updatePopper",(function(){e.$parent.visible&&e.updatePopper()})),this.$on("destroyPopper",this.destroyPopper)}},jr=Vr,Gr=a(jr,Ur,Fr,!1,null,null,null);Gr.options.__file="packages/select/src/select-dropdown.vue";var Hr=Gr.exports,Qr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"el-select-dropdown__item",class:{selected:e.itemSelected,"is-disabled":e.disabled||e.groupDisabled||e.limitReached,hover:e.hover},on:{mouseenter:e.hoverItem,click:function(t){return t.stopPropagation(),e.selectOptionClick(t)}}},[e._t("default",[r("span",[e._v(e._s(e.currentLabel))])])],2)},Wr=[];Qr._withStripped=!0;var qr="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zr={mixins:[w.a],name:"ElOption",componentName:"ElOption",inject:["select"],props:{value:{required:!0},label:[String,Number],created:Boolean,disabled:{type:Boolean,default:!1}},data:function(){return{index:-1,groupDisabled:!1,visible:!0,hitState:!1,hover:!1}},computed:{isObject:function(){return"[object object]"===Object.prototype.toString.call(this.value).toLowerCase()},currentLabel:function(){return this.label||(this.isObject?"":this.value)},currentValue:function(){return this.value||this.label||""},itemSelected:function(){return this.select.multiple?this.contains(this.select.value,this.value):this.isEqual(this.value,this.select.value)},limitReached:function(){return!!this.select.multiple&&(!this.itemSelected&&(this.select.value||[]).length>=this.select.multipleLimit&&this.select.multipleLimit>0)}},watch:{currentLabel:function(){this.created||this.select.remote||this.dispatch("ElSelect","setSelected")},value:function(e,t){var r=this.select,i=r.remote,n=r.valueKey;if(!this.created&&!i){if(n&&"object"===("undefined"===typeof e?"undefined":qr(e))&&"object"===("undefined"===typeof t?"undefined":qr(t))&&e[n]===t[n])return;this.dispatch("ElSelect","setSelected")}}},methods:{isEqual:function(e,t){if(this.isObject){var r=this.select.valueKey;return Object(v["getValueByPath"])(e,r)===Object(v["getValueByPath"])(t,r)}return e===t},contains:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];if(this.isObject){var r=this.select.valueKey;return e&&e.some((function(e){return Object(v["getValueByPath"])(e,r)===Object(v["getValueByPath"])(t,r)}))}return e&&e.indexOf(t)>-1},handleGroupDisabled:function(e){this.groupDisabled=e},hoverItem:function(){this.disabled||this.groupDisabled||(this.select.hoverIndex=this.select.options.indexOf(this))},selectOptionClick:function(){!0!==this.disabled&&!0!==this.groupDisabled&&this.dispatch("ElSelect","handleOptionClick",[this,!0])},queryChange:function(e){this.visible=new RegExp(Object(v["escapeRegexpString"])(e),"i").test(this.currentLabel)||this.created,this.visible||this.select.filteredOptionsCount--}},created:function(){this.select.options.push(this),this.select.cachedOptions.push(this),this.select.optionsCount++,this.select.filteredOptionsCount++,this.$on("queryChange",this.queryChange),this.$on("handleGroupDisabled",this.handleGroupDisabled)},beforeDestroy:function(){var e=this.select,t=e.selected,r=e.multiple,i=r?t:[t],n=this.select.cachedOptions.indexOf(this),o=i.indexOf(this);n>-1&&o<0&&this.select.cachedOptions.splice(n,1),this.select.onOptionDestroy(this.select.options.indexOf(this))}},Zr=zr,Yr=a(Zr,Qr,Wr,!1,null,null,null);Yr.options.__file="packages/select/src/option.vue";var Kr=Yr.exports,$r=r(29),Jr=r.n($r),Xr=r(14),ei=r(27),ti=r.n(ei),ri={data:function(){return{hoverOption:-1}},computed:{optionsAllDisabled:function(){return this.options.filter((function(e){return e.visible})).every((function(e){return e.disabled}))}},watch:{hoverIndex:function(e){var t=this;"number"===typeof e&&e>-1&&(this.hoverOption=this.options[e]||{}),this.options.forEach((function(e){e.hover=t.hoverOption===e}))}},methods:{navigateOptions:function(e){var t=this;if(this.visible){if(0!==this.options.length&&0!==this.filteredOptionsCount&&!this.optionsAllDisabled){"next"===e?(this.hoverIndex++,this.hoverIndex===this.options.length&&(this.hoverIndex=0)):"prev"===e&&(this.hoverIndex--,this.hoverIndex<0&&(this.hoverIndex=this.options.length-1));var r=this.options[this.hoverIndex];!0!==r.disabled&&!0!==r.groupDisabled&&r.visible||this.navigateOptions(e),this.$nextTick((function(){return t.scrollToOption(t.hoverOption)}))}}else this.visible=!0}}},ii={mixins:[w.a,_.a,$()("reference"),ri],name:"ElSelect",componentName:"ElSelect",inject:{elForm:{default:""},elFormItem:{default:""}},provide:function(){return{select:this}},computed:{_elFormItemSize:function(){return(this.elFormItem||{}).elFormItemSize},readonly:function(){return!this.filterable||this.multiple||!Object(v["isIE"])()&&!Object(v["isEdge"])()&&!this.visible},showClose:function(){var e=this.multiple?Array.isArray(this.value)&&this.value.length>0:void 0!==this.value&&null!==this.value&&""!==this.value,t=this.clearable&&!this.selectDisabled&&this.inputHovering&&e;return t},iconClass:function(){return this.remote&&this.filterable?"":this.visible?"arrow-up is-reverse":"arrow-up"},debounce:function(){return this.remote?300:0},emptyText:function(){return this.loading?this.loadingText||this.t("el.select.loading"):(!this.remote||""!==this.query||0!==this.options.length)&&(this.filterable&&this.query&&this.options.length>0&&0===this.filteredOptionsCount?this.noMatchText||this.t("el.select.noMatch"):0===this.options.length?this.noDataText||this.t("el.select.noData"):null)},showNewOption:function(){var e=this,t=this.options.filter((function(e){return!e.created})).some((function(t){return t.currentLabel===e.query}));return this.filterable&&this.allowCreate&&""!==this.query&&!t},selectSize:function(){return this.size||this._elFormItemSize||(this.$ELEMENT||{}).size},selectDisabled:function(){return this.disabled||(this.elForm||{}).disabled},collapseTagSize:function(){return["small","mini"].indexOf(this.selectSize)>-1?"mini":"small"},propPlaceholder:function(){return"undefined"!==typeof this.placeholder?this.placeholder:this.t("el.select.placeholder")}},components:{ElInput:g.a,ElSelectMenu:Hr,ElOption:Kr,ElTag:Jr.a,ElScrollbar:W.a},directives:{Clickoutside:F.a},props:{name:String,id:String,value:{required:!0},autocomplete:{type:String,default:"off"},autoComplete:{type:String,validator:function(e){return!0}},automaticDropdown:Boolean,size:String,disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:String,remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String,required:!1},defaultFirstOption:Boolean,reserveKeyword:Boolean,valueKey:{type:String,default:"value"},collapseTags:Boolean,popperAppendToBody:{type:Boolean,default:!0}},data:function(){return{options:[],cachedOptions:[],createdLabel:null,createdSelected:!1,selected:this.multiple?[]:{},inputLength:20,inputWidth:0,initialInputHeight:0,cachedPlaceHolder:"",optionsCount:0,filteredOptionsCount:0,visible:!1,softFocus:!1,selectedLabel:"",hoverIndex:-1,query:"",previousQuery:null,inputHovering:!1,currentPlaceholder:"",menuVisibleOnFocus:!1,isOnComposition:!1,isSilentBlur:!1}},watch:{selectDisabled:function(){var e=this;this.$nextTick((function(){e.resetInputHeight()}))},propPlaceholder:function(e){this.cachedPlaceHolder=this.currentPlaceholder=e},value:function(e,t){this.multiple&&(this.resetInputHeight(),e&&e.length>0||this.$refs.input&&""!==this.query?this.currentPlaceholder="":this.currentPlaceholder=this.cachedPlaceHolder,this.filterable&&!this.reserveKeyword&&(this.query="",this.handleQueryChange(this.query))),this.setSelected(),this.filterable&&!this.multiple&&(this.inputLength=20),Object(v["valueEquals"])(e,t)||this.dispatch("ElFormItem","el.form.change",e)},visible:function(e){var t=this;e?(this.broadcast("ElSelectDropdown","updatePopper"),this.filterable&&(this.query=this.remote?"":this.selectedLabel,this.handleQueryChange(this.query),this.multiple?this.$refs.input.focus():(this.remote||(this.broadcast("ElOption","queryChange",""),this.broadcast("ElOptionGroup","queryChange")),this.selectedLabel&&(this.currentPlaceholder=this.selectedLabel,this.selectedLabel="")))):(this.broadcast("ElSelectDropdown","destroyPopper"),this.$refs.input&&this.$refs.input.blur(),this.query="",this.previousQuery=null,this.selectedLabel="",this.inputLength=20,this.menuVisibleOnFocus=!1,this.resetHoverIndex(),this.$nextTick((function(){t.$refs.input&&""===t.$refs.input.value&&0===t.selected.length&&(t.currentPlaceholder=t.cachedPlaceHolder)})),this.multiple||(this.selected&&(this.filterable&&this.allowCreate&&this.createdSelected&&this.createdLabel?this.selectedLabel=this.createdLabel:this.selectedLabel=this.selected.currentLabel,this.filterable&&(this.query=this.selectedLabel)),this.filterable&&(this.currentPlaceholder=this.cachedPlaceHolder))),this.$emit("visible-change",e)},options:function(){var e=this;if(!this.$isServer){this.$nextTick((function(){e.broadcast("ElSelectDropdown","updatePopper")})),this.multiple&&this.resetInputHeight();var t=this.$el.querySelectorAll("input");-1===[].indexOf.call(t,document.activeElement)&&this.setSelected(),this.defaultFirstOption&&(this.filterable||this.remote)&&this.filteredOptionsCount&&this.checkDefaultFirstOption()}}},methods:{handleComposition:function(e){var t=this,r=e.target.value;if("compositionend"===e.type)this.isOnComposition=!1,this.$nextTick((function(e){return t.handleQueryChange(r)}));else{var i=r[r.length-1]||"";this.isOnComposition=!Object(It["isKorean"])(i)}},handleQueryChange:function(e){var t=this;this.previousQuery===e||this.isOnComposition||(null!==this.previousQuery||"function"!==typeof this.filterMethod&&"function"!==typeof this.remoteMethod?(this.previousQuery=e,this.$nextTick((function(){t.visible&&t.broadcast("ElSelectDropdown","updatePopper")})),this.hoverIndex=-1,this.multiple&&this.filterable&&this.$nextTick((function(){var e=15*t.$refs.input.value.length+20;t.inputLength=t.collapseTags?Math.min(50,e):e,t.managePlaceholder(),t.resetInputHeight()})),this.remote&&"function"===typeof this.remoteMethod?(this.hoverIndex=-1,this.remoteMethod(e)):"function"===typeof this.filterMethod?(this.filterMethod(e),this.broadcast("ElOptionGroup","queryChange")):(this.filteredOptionsCount=this.optionsCount,this.broadcast("ElOption","queryChange",e),this.broadcast("ElOptionGroup","queryChange")),this.defaultFirstOption&&(this.filterable||this.remote)&&this.filteredOptionsCount&&this.checkDefaultFirstOption()):this.previousQuery=e)},scrollToOption:function(e){var t=Array.isArray(e)&&e[0]?e[0].$el:e.$el;if(this.$refs.popper&&t){var r=this.$refs.popper.$el.querySelector(".el-select-dropdown__wrap");ti()(r,t)}this.$refs.scrollbar&&this.$refs.scrollbar.handleScroll()},handleMenuEnter:function(){var e=this;this.$nextTick((function(){return e.scrollToOption(e.selected)}))},emitChange:function(e){Object(v["valueEquals"])(this.value,e)||this.$emit("change",e)},getOption:function(e){for(var t=void 0,r="[object object]"===Object.prototype.toString.call(e).toLowerCase(),i="[object null]"===Object.prototype.toString.call(e).toLowerCase(),n="[object undefined]"===Object.prototype.toString.call(e).toLowerCase(),o=this.cachedOptions.length-1;o>=0;o--){var s=this.cachedOptions[o],a=r?Object(v["getValueByPath"])(s.value,this.valueKey)===Object(v["getValueByPath"])(e,this.valueKey):s.value===e;if(a){t=s;break}}if(t)return t;var c=r||i||n?"":String(e),l={value:e,currentLabel:c};return this.multiple&&(l.hitState=!1),l},setSelected:function(){var e=this;if(!this.multiple){var t=this.getOption(this.value);return t.created?(this.createdLabel=t.currentLabel,this.createdSelected=!0):this.createdSelected=!1,this.selectedLabel=t.currentLabel,this.selected=t,void(this.filterable&&(this.query=this.selectedLabel))}var r=[];Array.isArray(this.value)&&this.value.forEach((function(t){r.push(e.getOption(t))})),this.selected=r,this.$nextTick((function(){e.resetInputHeight()}))},handleFocus:function(e){this.softFocus?this.softFocus=!1:((this.automaticDropdown||this.filterable)&&(this.visible=!0,this.filterable&&(this.menuVisibleOnFocus=!0)),this.$emit("focus",e))},blur:function(){this.visible=!1,this.$refs.reference.blur()},handleBlur:function(e){var t=this;setTimeout((function(){t.isSilentBlur?t.isSilentBlur=!1:t.$emit("blur",e)}),50),this.softFocus=!1},handleClearClick:function(e){this.deleteSelected(e)},doDestroy:function(){this.$refs.popper&&this.$refs.popper.doDestroy()},handleClose:function(){this.visible=!1},toggleLastOptionHitState:function(e){if(Array.isArray(this.selected)){var t=this.selected[this.selected.length-1];if(t)return!0===e||!1===e?(t.hitState=e,e):(t.hitState=!t.hitState,t.hitState)}},deletePrevTag:function(e){if(e.target.value.length<=0&&!this.toggleLastOptionHitState()){var t=this.value.slice();t.pop(),this.$emit("input",t),this.emitChange(t)}},managePlaceholder:function(){""!==this.currentPlaceholder&&(this.currentPlaceholder=this.$refs.input.value?"":this.cachedPlaceHolder)},resetInputState:function(e){8!==e.keyCode&&this.toggleLastOptionHitState(!1),this.inputLength=15*this.$refs.input.value.length+20,this.resetInputHeight()},resetInputHeight:function(){var e=this;this.collapseTags&&!this.filterable||this.$nextTick((function(){if(e.$refs.reference){var t=e.$refs.reference.$el.childNodes,r=[].filter.call(t,(function(e){return"INPUT"===e.tagName}))[0],i=e.$refs.tags,n=i?Math.round(i.getBoundingClientRect().height):0,o=e.initialInputHeight||40;r.style.height=0===e.selected.length?o+"px":Math.max(i?n+(n>o?6:0):0,o)+"px",e.visible&&!1!==e.emptyText&&e.broadcast("ElSelectDropdown","updatePopper")}}))},resetHoverIndex:function(){var e=this;setTimeout((function(){e.multiple?e.selected.length>0?e.hoverIndex=Math.min.apply(null,e.selected.map((function(t){return e.options.indexOf(t)}))):e.hoverIndex=-1:e.hoverIndex=e.options.indexOf(e.selected)}),300)},handleOptionSelect:function(e,t){var r=this;if(this.multiple){var i=(this.value||[]).slice(),n=this.getValueIndex(i,e.value);n>-1?i.splice(n,1):(this.multipleLimit<=0||i.length<this.multipleLimit)&&i.push(e.value),this.$emit("input",i),this.emitChange(i),e.created&&(this.query="",this.handleQueryChange(""),this.inputLength=20),this.filterable&&this.$refs.input.focus()}else this.$emit("input",e.value),this.emitChange(e.value),this.visible=!1;this.isSilentBlur=t,this.setSoftFocus(),this.visible||this.$nextTick((function(){r.scrollToOption(e)}))},setSoftFocus:function(){this.softFocus=!0;var e=this.$refs.input||this.$refs.reference;e&&e.focus()},getValueIndex:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],r="[object object]"===Object.prototype.toString.call(t).toLowerCase();if(r){var i=this.valueKey,n=-1;return e.some((function(e,r){return Object(v["getValueByPath"])(e,i)===Object(v["getValueByPath"])(t,i)&&(n=r,!0)})),n}return e.indexOf(t)},toggleMenu:function(){this.selectDisabled||(this.menuVisibleOnFocus?this.menuVisibleOnFocus=!1:this.visible=!this.visible,this.visible&&(this.$refs.input||this.$refs.reference).focus())},selectOption:function(){this.visible?this.options[this.hoverIndex]&&this.handleOptionSelect(this.options[this.hoverIndex]):this.toggleMenu()},deleteSelected:function(e){e.stopPropagation();var t=this.multiple?[]:"";this.$emit("input",t),this.emitChange(t),this.visible=!1,this.$emit("clear")},deleteTag:function(e,t){var r=this.selected.indexOf(t);if(r>-1&&!this.selectDisabled){var i=this.value.slice();i.splice(r,1),this.$emit("input",i),this.emitChange(i),this.$emit("remove-tag",t.value)}e.stopPropagation()},onInputChange:function(){this.filterable&&this.query!==this.selectedLabel&&(this.query=this.selectedLabel,this.handleQueryChange(this.query))},onOptionDestroy:function(e){e>-1&&(this.optionsCount--,this.filteredOptionsCount--,this.options.splice(e,1))},resetInputWidth:function(){this.inputWidth=this.$refs.reference.$el.getBoundingClientRect().width},handleResize:function(){this.resetInputWidth(),this.multiple&&this.resetInputHeight()},checkDefaultFirstOption:function(){this.hoverIndex=-1;for(var e=!1,t=this.options.length-1;t>=0;t--)if(this.options[t].created){e=!0,this.hoverIndex=t;break}if(!e)for(var r=0;r!==this.options.length;++r){var i=this.options[r];if(this.query){if(!i.disabled&&!i.groupDisabled&&i.visible){this.hoverIndex=r;break}}else if(i.itemSelected){this.hoverIndex=r;break}}},getValueKey:function(e){return"[object object]"!==Object.prototype.toString.call(e.value).toLowerCase()?e.value:Object(v["getValueByPath"])(e.value,this.valueKey)}},created:function(){var e=this;this.cachedPlaceHolder=this.currentPlaceholder=this.propPlaceholder,this.multiple&&!Array.isArray(this.value)&&this.$emit("input",[]),!this.multiple&&Array.isArray(this.value)&&this.$emit("input",""),this.debouncedOnInputChange=B()(this.debounce,(function(){e.onInputChange()})),this.debouncedQueryChange=B()(this.debounce,(function(t){e.handleQueryChange(t.target.value)})),this.$on("handleOptionClick",this.handleOptionSelect),this.$on("setSelected",this.setSelected)},mounted:function(){var e=this;this.multiple&&Array.isArray(this.value)&&this.value.length>0&&(this.currentPlaceholder=""),Object(Xr["addResizeListener"])(this.$el,this.handleResize);var t=this.$refs.reference;if(t&&t.$el){var r={medium:36,small:32,mini:28},i=t.$el.querySelector("input");this.initialInputHeight=i.getBoundingClientRect().height||r[this.selectSize]}this.remote&&this.multiple&&this.resetInputHeight(),this.$nextTick((function(){t&&t.$el&&(e.inputWidth=t.$el.getBoundingClientRect().width)})),this.setSelected()},beforeDestroy:function(){this.$el&&this.handleResize&&Object(Xr["removeResizeListener"])(this.$el,this.handleResize)}},ni=ii,oi=a(ni,xr,Br,!1,null,null,null);oi.options.__file="packages/select/src/select.vue";var si=oi.exports;si.install=function(e){e.component(si.name,si)};var ai=si;Kr.install=function(e){e.component(Kr.name,Kr)};var ci=Kr,li=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ul",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"el-select-group__wrap"},[r("li",{staticClass:"el-select-group__title"},[e._v(e._s(e.label))]),r("li",[r("ul",{staticClass:"el-select-group"},[e._t("default")],2)])])},ui=[];li._withStripped=!0;var di={mixins:[w.a],name:"ElOptionGroup",componentName:"ElOptionGroup",props:{label:String,disabled:{type:Boolean,default:!1}},data:function(){return{visible:!0}},watch:{disabled:function(e){this.broadcast("ElOption","handleGroupDisabled",e)}},methods:{queryChange:function(){this.visible=this.$children&&Array.isArray(this.$children)&&this.$children.some((function(e){return!0===e.visible}))}},created:function(){this.$on("queryChange",this.queryChange)},mounted:function(){this.disabled&&this.broadcast("ElOption","handleGroupDisabled",this.disabled)}},hi=di,pi=a(hi,li,ui,!1,null,null,null);pi.options.__file="packages/select/src/option-group.vue";var fi=pi.exports;fi.install=function(e){e.component(fi.name,fi)};var gi=fi,mi=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("button",{staticClass:"el-button",class:[e.type?"el-button--"+e.type:"",e.buttonSize?"el-button--"+e.buttonSize:"",{"is-disabled":e.buttonDisabled,"is-loading":e.loading,"is-plain":e.plain,"is-round":e.round,"is-circle":e.circle}],attrs:{disabled:e.buttonDisabled||e.loading,autofocus:e.autofocus,type:e.nativeType},on:{click:e.handleClick}},[e.loading?r("i",{staticClass:"el-icon-loading"}):e._e(),e.icon&&!e.loading?r("i",{class:e.icon}):e._e(),e.$slots.default?r("span",[e._t("default")],2):e._e()])},_i=[];mi._withStripped=!0;var vi={name:"ElButton",inject:{elForm:{default:""},elFormItem:{default:""}},props:{type:{type:String,default:"default"},size:String,icon:{type:String,default:""},nativeType:{type:String,default:"button"},loading:Boolean,disabled:Boolean,plain:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean},computed:{_elFormItemSize:function(){return(this.elFormItem||{}).elFormItemSize},buttonSize:function(){return this.size||this._elFormItemSize||(this.$ELEMENT||{}).size},buttonDisabled:function(){return this.disabled||(this.elForm||{}).disabled}},methods:{handleClick:function(e){this.$emit("click",e)}}},Ei=vi,Ai=a(Ei,mi,_i,!1,null,null,null);Ai.options.__file="packages/button/src/button.vue";var yi=Ai.exports;yi.install=function(e){e.component(yi.name,yi)};var Si=yi,Ci=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-button-group"},[e._t("default")],2)},Ti=[];Ci._withStripped=!0;var bi={name:"ElButtonGroup"},Ii=bi,Ri=a(Ii,Ci,Ti,!1,null,null,null);Ri.options.__file="packages/button/src/button-group.vue";var wi=Ri.exports;wi.install=function(e){e.component(wi.name,wi)};var ki=wi,Oi=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-table",class:[{"el-table--fit":e.fit,"el-table--striped":e.stripe,"el-table--border":e.border||e.isGroup,"el-table--hidden":e.isHidden,"el-table--group":e.isGroup,"el-table--fluid-height":e.maxHeight,"el-table--scrollable-x":e.layout.scrollX,"el-table--scrollable-y":e.layout.scrollY,"el-table--enable-row-hover":!e.store.states.isComplex,"el-table--enable-row-transition":0!==(e.store.states.data||[]).length&&(e.store.states.data||[]).length<100},e.tableSize?"el-table--"+e.tableSize:""],on:{mouseleave:function(t){e.handleMouseLeave(t)}}},[r("div",{ref:"hiddenColumns",staticClass:"hidden-columns"},[e._t("default")],2),e.showHeader?r("div",{directives:[{name:"mousewheel",rawName:"v-mousewheel",value:e.handleHeaderFooterMousewheel,expression:"handleHeaderFooterMousewheel"}],ref:"headerWrapper",staticClass:"el-table__header-wrapper"},[r("table-header",{ref:"tableHeader",style:{width:e.layout.bodyWidth?e.layout.bodyWidth+"px":""},attrs:{store:e.store,border:e.border,"default-sort":e.defaultSort}})],1):e._e(),r("div",{ref:"bodyWrapper",staticClass:"el-table__body-wrapper",class:[e.layout.scrollX?"is-scrolling-"+e.scrollPosition:"is-scrolling-none"],style:[e.bodyHeight]},[r("table-body",{style:{width:e.bodyWidth},attrs:{context:e.context,store:e.store,stripe:e.stripe,"row-class-name":e.rowClassName,"row-style":e.rowStyle,highlight:e.highlightCurrentRow}}),e.data&&0!==e.data.length?e._e():r("div",{ref:"emptyBlock",staticClass:"el-table__empty-block",style:e.emptyBlockStyle},[r("span",{staticClass:"el-table__empty-text"},[e._t("empty",[e._v(e._s(e.emptyText||e.t("el.table.emptyText")))])],2)]),e.$slots.append?r("div",{ref:"appendWrapper",staticClass:"el-table__append-wrapper"},[e._t("append")],2):e._e()],1),e.showSummary?r("div",{directives:[{name:"show",rawName:"v-show",value:e.data&&e.data.length>0,expression:"data && data.length > 0"},{name:"mousewheel",rawName:"v-mousewheel",value:e.handleHeaderFooterMousewheel,expression:"handleHeaderFooterMousewheel"}],ref:"footerWrapper",staticClass:"el-table__footer-wrapper"},[r("table-footer",{style:{width:e.layout.bodyWidth?e.layout.bodyWidth+"px":""},attrs:{store:e.store,border:e.border,"sum-text":e.sumText||e.t("el.table.sumText"),"summary-method":e.summaryMethod,"default-sort":e.defaultSort}})],1):e._e(),e.fixedColumns.length>0?r("div",{directives:[{name:"mousewheel",rawName:"v-mousewheel",value:e.handleFixedMousewheel,expression:"handleFixedMousewheel"}],ref:"fixedWrapper",staticClass:"el-table__fixed",style:[{width:e.layout.fixedWidth?e.layout.fixedWidth+"px":""},e.fixedHeight]},[e.showHeader?r("div",{ref:"fixedHeaderWrapper",staticClass:"el-table__fixed-header-wrapper"},[r("table-header",{ref:"fixedTableHeader",style:{width:e.bodyWidth},attrs:{fixed:"left",border:e.border,store:e.store}})],1):e._e(),r("div",{ref:"fixedBodyWrapper",staticClass:"el-table__fixed-body-wrapper",style:[{top:e.layout.headerHeight+"px"},e.fixedBodyHeight]},[r("table-body",{style:{width:e.bodyWidth},attrs:{fixed:"left",store:e.store,stripe:e.stripe,highlight:e.highlightCurrentRow,"row-class-name":e.rowClassName,"row-style":e.rowStyle}}),e.$slots.append?r("div",{staticClass:"el-table__append-gutter",style:{height:e.layout.appendHeight+"px"}}):e._e()],1),e.showSummary?r("div",{directives:[{name:"show",rawName:"v-show",value:e.data&&e.data.length>0,expression:"data && data.length > 0"}],ref:"fixedFooterWrapper",staticClass:"el-table__fixed-footer-wrapper"},[r("table-footer",{style:{width:e.bodyWidth},attrs:{fixed:"left",border:e.border,"sum-text":e.sumText||e.t("el.table.sumText"),"summary-method":e.summaryMethod,store:e.store}})],1):e._e()]):e._e(),e.rightFixedColumns.length>0?r("div",{directives:[{name:"mousewheel",rawName:"v-mousewheel",value:e.handleFixedMousewheel,expression:"handleFixedMousewheel"}],ref:"rightFixedWrapper",staticClass:"el-table__fixed-right",style:[{width:e.layout.rightFixedWidth?e.layout.rightFixedWidth+"px":"",right:e.layout.scrollY?(e.border?e.layout.gutterWidth:e.layout.gutterWidth||0)+"px":""},e.fixedHeight]},[e.showHeader?r("div",{ref:"rightFixedHeaderWrapper",staticClass:"el-table__fixed-header-wrapper"},[r("table-header",{ref:"rightFixedTableHeader",style:{width:e.bodyWidth},attrs:{fixed:"right",border:e.border,store:e.store}})],1):e._e(),r("div",{ref:"rightFixedBodyWrapper",staticClass:"el-table__fixed-body-wrapper",style:[{top:e.layout.headerHeight+"px"},e.fixedBodyHeight]},[r("table-body",{style:{width:e.bodyWidth},attrs:{fixed:"right",store:e.store,stripe:e.stripe,"row-class-name":e.rowClassName,"row-style":e.rowStyle,highlight:e.highlightCurrentRow}}),e.$slots.append?r("div",{staticClass:"el-table__append-gutter",style:{height:e.layout.appendHeight+"px"}}):e._e()],1),e.showSummary?r("div",{directives:[{name:"show",rawName:"v-show",value:e.data&&e.data.length>0,expression:"data && data.length > 0"}],ref:"rightFixedFooterWrapper",staticClass:"el-table__fixed-footer-wrapper"},[r("table-footer",{style:{width:e.bodyWidth},attrs:{fixed:"right",border:e.border,"sum-text":e.sumText||e.t("el.table.sumText"),"summary-method":e.summaryMethod,store:e.store}})],1):e._e()]):e._e(),e.rightFixedColumns.length>0?r("div",{ref:"rightFixedPatch",staticClass:"el-table__fixed-right-patch",style:{width:e.layout.scrollY?e.layout.gutterWidth+"px":"0",height:e.layout.headerHeight+"px"}}):e._e(),r("div",{directives:[{name:"show",rawName:"v-show",value:e.resizeProxyVisible,expression:"resizeProxyVisible"}],ref:"resizeProxy",staticClass:"el-table__column-resize-proxy"})])},Ni=[];Oi._withStripped=!0;var Li=r(17),Pi=r.n(Li),Di=r(35),Mi=r(38),xi=r.n(Mi),Bi="undefined"!==typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>-1,Ui=function(e,t){e&&e.addEventListener&&e.addEventListener(Bi?"DOMMouseScroll":"mousewheel",(function(e){var r=xi()(e);t&&t.apply(this,[e,r])}))},Fi={bind:function(e,t){Ui(e,t.value)}},Vi=r(6),ji=r.n(Vi),Gi="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hi=function(e){var t=e.target;while(t&&"HTML"!==t.tagName.toUpperCase()){if("TD"===t.tagName.toUpperCase())return t;t=t.parentNode}return null},Qi=function(e){return null!==e&&"object"===("undefined"===typeof e?"undefined":Gi(e))},Wi=function(e,t,r,i,n){if(!t&&!i&&(!n||Array.isArray(n)&&!n.length))return e;r="string"===typeof r?"descending"===r?-1:1:r&&r<0?-1:1;var o=i?null:function(r,i){return n?(Array.isArray(n)||(n=[n]),n.map((function(t){return"string"===typeof t?Object(v["getValueByPath"])(r,t):t(r,i,e)}))):("$key"!==t&&Qi(r)&&"$value"in r&&(r=r.$value),[Qi(r)?Object(v["getValueByPath"])(r,t):r])},s=function(e,t){if(i)return i(e.value,t.value);for(var r=0,n=e.key.length;r<n;r++){if(e.key[r]<t.key[r])return-1;if(e.key[r]>t.key[r])return 1}return 0};return e.map((function(e,t){return{value:e,index:t,key:o?o(e,t):null}})).sort((function(e,t){var i=s(e,t);return i||(i=e.index-t.index),i*r})).map((function(e){return e.value}))},qi=function(e,t){var r=null;return e.columns.forEach((function(e){e.id===t&&(r=e)})),r},zi=function(e,t){for(var r=null,i=0;i<e.columns.length;i++){var n=e.columns[i];if(n.columnKey===t){r=n;break}}return r},Zi=function(e,t){var r=(t.className||"").match(/el-table_[^\s]+/gm);return r?qi(e,r[0]):null},Yi=function(e,t){if(!e)throw new Error("row is required when get row identity");if("string"===typeof t){if(t.indexOf(".")<0)return e[t];for(var r=t.split("."),i=e,n=0;n<r.length;n++)i=i[r[n]];return i}if("function"===typeof t)return t.call(null,e)},Ki=function(e,t){var r={};return(e||[]).forEach((function(e,i){r[Yi(e,t)]={row:e,index:i}})),r};function $i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Ji(e,t){var r={},i=void 0;for(i in e)r[i]=e[i];for(i in t)if($i(t,i)){var n=t[i];"undefined"!==typeof n&&(r[i]=n)}return r}function Xi(e){return void 0!==e&&(e=parseInt(e,10),isNaN(e)&&(e=null)),e}function en(e){return"undefined"!==typeof e&&(e=Xi(e),isNaN(e)&&(e=80)),e}function tn(e){return"number"===typeof e?e:"string"===typeof e?/^\d+(?:px)?$/.test(e)?parseInt(e,10):e:null}function rn(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function nn(e,t,r){var i=!1,n=e.indexOf(t),o=-1!==n,s=function(){e.push(t),i=!0},a=function(){e.splice(n,1),i=!0};return"boolean"===typeof r?r&&!o?s():!r&&o&&a():o?a():s(),i}function on(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"children",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"hasChildren",n=function(e){return!(Array.isArray(e)&&e.length)};function o(e,s,a){t(e,s,a),s.forEach((function(e){if(e[i])t(e,null,a+1);else{var s=e[r];n(s)||o(e,s,a+1)}}))}e.forEach((function(e){if(e[i])t(e,null,0);else{var s=e[r];n(s)||o(e,s,0)}}))}var sn={data:function(){return{states:{defaultExpandAll:!1,expandRows:[]}}},methods:{updateExpandRows:function(){var e=this.states,t=e.data,r=void 0===t?[]:t,i=e.rowKey,n=e.defaultExpandAll,o=e.expandRows;if(n)this.states.expandRows=r.slice();else if(i){var s=Ki(o,i);this.states.expandRows=r.reduce((function(e,t){var r=Yi(t,i),n=s[r];return n&&e.push(t),e}),[])}else this.states.expandRows=[]},toggleRowExpansion:function(e,t){var r=nn(this.states.expandRows,e,t);r&&(this.table.$emit("expand-change",e,this.states.expandRows.slice()),this.scheduleLayout())},setExpandRowKeys:function(e){this.assertRowKey();var t=this.states,r=t.data,i=t.rowKey,n=Ki(r,i);this.states.expandRows=e.reduce((function(e,t){var r=n[t];return r&&e.push(r.row),e}),[])},isRowExpanded:function(e){var t=this.states,r=t.expandRows,i=void 0===r?[]:r,n=t.rowKey;if(n){var o=Ki(i,n);return!!o[Yi(e,n)]}return-1!==i.indexOf(e)}}},an={data:function(){return{states:{_currentRowKey:null,currentRow:null}}},methods:{setCurrentRowKey:function(e){this.assertRowKey(),this.states._currentRowKey=e,this.setCurrentRowByKey(e)},restoreCurrentRowKey:function(){this.states._currentRowKey=null},setCurrentRowByKey:function(e){var t=this.states,r=t.data,i=void 0===r?[]:r,n=t.rowKey,o=null;n&&(o=Object(v["arrayFind"])(i,(function(t){return Yi(t,n)===e}))),t.currentRow=o},updateCurrentRow:function(e){var t=this.states,r=this.table,i=t.currentRow;if(e&&e!==i)return t.currentRow=e,void r.$emit("current-change",e,i);!e&&i&&(t.currentRow=null,r.$emit("current-change",null,i))},updateCurrentRowData:function(){var e=this.states,t=this.table,r=e.rowKey,i=e._currentRowKey,n=e.data||[],o=e.currentRow;if(-1===n.indexOf(o)&&o){if(r){var s=Yi(o,r);this.setCurrentRowByKey(s)}else e.currentRow=null;null===e.currentRow&&t.$emit("current-change",null,o)}else i&&(this.setCurrentRowByKey(i),this.restoreCurrentRowKey())}}},cn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},ln={data:function(){return{states:{expandRowKeys:[],treeData:{},indent:16,lazy:!1,lazyTreeNodeMap:{},lazyColumnIdentifier:"hasChildren",childrenColumnName:"children"}}},computed:{normalizedData:function(){if(!this.states.rowKey)return{};var e=this.states.data||[];return this.normalize(e)},normalizedLazyNode:function(){var e=this.states,t=e.rowKey,r=e.lazyTreeNodeMap,i=e.lazyColumnIdentifier,n=Object.keys(r),o={};return n.length?(n.forEach((function(e){if(r[e].length){var n={children:[]};r[e].forEach((function(e){var r=Yi(e,t);n.children.push(r),e[i]&&!o[r]&&(o[r]={children:[]})})),o[e]=n}})),o):o}},watch:{normalizedData:"updateTreeData",normalizedLazyNode:"updateTreeData"},methods:{normalize:function(e){var t=this.states,r=t.childrenColumnName,i=t.lazyColumnIdentifier,n=t.rowKey,o=t.lazy,s={};return on(e,(function(e,t,r){var i=Yi(e,n);Array.isArray(t)?s[i]={children:t.map((function(e){return Yi(e,n)})),level:r}:o&&(s[i]={children:[],lazy:!0,level:r})}),r,i),s},updateTreeData:function(){var e=this.normalizedData,t=this.normalizedLazyNode,r=Object.keys(e),i={};if(r.length){var n=this.states,o=n.treeData,s=n.defaultExpandAll,a=n.expandRowKeys,c=n.lazy,l=[],u=function(e,t){var r=s||a&&-1!==a.indexOf(t);return!!(e&&e.expanded||r)};r.forEach((function(t){var r=o[t],n=cn({},e[t]);if(n.expanded=u(r,t),n.lazy){var s=r||{},a=s.loaded,c=void 0!==a&&a,d=s.loading,h=void 0!==d&&d;n.loaded=!!c,n.loading=!!h,l.push(t)}i[t]=n}));var d=Object.keys(t);c&&d.length&&l.length&&d.forEach((function(e){var r=o[e],n=t[e].children;if(-1!==l.indexOf(e)){if(0!==i[e].children.length)throw new Error("[ElTable]children must be an empty array.");i[e].children=n}else{var s=r||{},a=s.loaded,c=void 0!==a&&a,d=s.loading,h=void 0!==d&&d;i[e]={lazy:!0,loaded:!!c,loading:!!h,expanded:u(r,e),children:n,level:""}}}))}this.states.treeData=i,this.updateTableScrollY()},updateTreeExpandKeys:function(e){this.states.expandRowKeys=e,this.updateTreeData()},toggleTreeExpansion:function(e,t){this.assertRowKey();var r=this.states,i=r.rowKey,n=r.treeData,o=Yi(e,i),s=o&&n[o];if(o&&s&&"expanded"in s){var a=s.expanded;t="undefined"===typeof t?!s.expanded:t,n[o].expanded=t,a!==t&&this.table.$emit("expand-change",e,t),this.updateTableScrollY()}},loadOrToggle:function(e){this.assertRowKey();var t=this.states,r=t.lazy,i=t.treeData,n=t.rowKey,o=Yi(e,n),s=i[o];r&&s&&"loaded"in s&&!s.loaded?this.loadData(e,o,s):this.toggleTreeExpansion(e)},loadData:function(e,t,r){var i=this,n=this.table.load,o=this.states.treeData;n&&!o[t].loaded&&(o[t].loading=!0,n(e,r,(function(r){if(!Array.isArray(r))throw new Error("[ElTable] data must be an array");var n=i.states,o=n.lazyTreeNodeMap,s=n.treeData;s[t].loading=!1,s[t].loaded=!0,s[t].expanded=!0,r.length&&i.$set(o,t,r),i.table.$emit("expand-change",e,!0)})))}}},un=function(e,t){var r=t.sortingColumn;return r&&"string"!==typeof r.sortable?Wi(e,t.sortProp,t.sortOrder,r.sortMethod,r.sortBy):e},dn=function e(t){var r=[];return t.forEach((function(t){t.children?r.push.apply(r,e(t.children)):r.push(t)})),r},hn=ji.a.extend({data:function(){return{states:{rowKey:null,data:[],isComplex:!1,_columns:[],originColumns:[],columns:[],fixedColumns:[],rightFixedColumns:[],leafColumns:[],fixedLeafColumns:[],rightFixedLeafColumns:[],leafColumnsLength:0,fixedLeafColumnsLength:0,rightFixedLeafColumnsLength:0,isAllSelected:!1,selection:[],reserveSelection:!1,selectOnIndeterminate:!1,selectable:null,filters:{},filteredData:null,sortingColumn:null,sortProp:null,sortOrder:null,hoverRow:null}}},mixins:[sn,an,ln],methods:{assertRowKey:function(){var e=this.states.rowKey;if(!e)throw new Error("[ElTable] prop row-key is required")},updateColumns:function(){var e=this.states,t=e._columns||[];e.fixedColumns=t.filter((function(e){return!0===e.fixed||"left"===e.fixed})),e.rightFixedColumns=t.filter((function(e){return"right"===e.fixed})),e.fixedColumns.length>0&&t[0]&&"selection"===t[0].type&&!t[0].fixed&&(t[0].fixed=!0,e.fixedColumns.unshift(t[0]));var r=t.filter((function(e){return!e.fixed}));e.originColumns=[].concat(e.fixedColumns).concat(r).concat(e.rightFixedColumns);var i=dn(r),n=dn(e.fixedColumns),o=dn(e.rightFixedColumns);e.leafColumnsLength=i.length,e.fixedLeafColumnsLength=n.length,e.rightFixedLeafColumnsLength=o.length,e.columns=[].concat(n).concat(i).concat(o),e.isComplex=e.fixedColumns.length>0||e.rightFixedColumns.length>0},scheduleLayout:function(e){e&&this.updateColumns(),this.table.debouncedUpdateLayout()},isSelected:function(e){var t=this.states.selection,r=void 0===t?[]:t;return r.indexOf(e)>-1},clearSelection:function(){var e=this.states;e.isAllSelected=!1;var t=e.selection;t.length&&(e.selection=[],this.table.$emit("selection-change",[]))},cleanSelection:function(){var e=this.states,t=e.data,r=e.rowKey,i=e.selection,n=void 0;if(r){n=[];var o=Ki(i,r),s=Ki(t,r);for(var a in o)o.hasOwnProperty(a)&&!s[a]&&n.push(o[a].row)}else n=i.filter((function(e){return-1===t.indexOf(e)}));if(n.length){var c=i.filter((function(e){return-1===n.indexOf(e)}));e.selection=c,this.table.$emit("selection-change",c.slice())}},toggleRowSelection:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=nn(this.states.selection,e,t);if(i){var n=(this.states.selection||[]).slice();r&&this.table.$emit("select",n,e),this.table.$emit("selection-change",n)}},_toggleAllSelection:function(){var e=this.states,t=e.data,r=void 0===t?[]:t,i=e.selection,n=e.selectOnIndeterminate?!e.isAllSelected:!(e.isAllSelected||i.length);e.isAllSelected=n;var o=!1;r.forEach((function(t,r){e.selectable?e.selectable.call(null,t,r)&&nn(i,t,n)&&(o=!0):nn(i,t,n)&&(o=!0)})),o&&this.table.$emit("selection-change",i?i.slice():[]),this.table.$emit("select-all",i)},updateSelectionByRowKey:function(){var e=this.states,t=e.selection,r=e.rowKey,i=e.data,n=Ki(t,r);i.forEach((function(e){var i=Yi(e,r),o=n[i];o&&(t[o.index]=e)}))},updateAllSelected:function(){var e=this.states,t=e.selection,r=e.rowKey,i=e.selectable,n=e.data||[];if(0!==n.length){var o=void 0;r&&(o=Ki(t,r));for(var s=function(e){return o?!!o[Yi(e,r)]:-1!==t.indexOf(e)},a=!0,c=0,l=0,u=n.length;l<u;l++){var d=n[l],h=i&&i.call(null,d,l);if(s(d))c++;else if(!i||h){a=!1;break}}0===c&&(a=!1),e.isAllSelected=a}else e.isAllSelected=!1},updateFilters:function(e,t){Array.isArray(e)||(e=[e]);var r=this.states,i={};return e.forEach((function(e){r.filters[e.id]=t,i[e.columnKey||e.id]=t})),i},updateSort:function(e,t,r){this.states.sortingColumn&&this.states.sortingColumn!==e&&(this.states.sortingColumn.order=null),this.states.sortingColumn=e,this.states.sortProp=t,this.states.sortOrder=r},execFilter:function(){var e=this,t=this.states,r=t._data,i=t.filters,n=r;Object.keys(i).forEach((function(r){var i=t.filters[r];if(i&&0!==i.length){var o=qi(e.states,r);o&&o.filterMethod&&(n=n.filter((function(e){return i.some((function(t){return o.filterMethod.call(null,t,e,o)}))})))}})),t.filteredData=n},execSort:function(){var e=this.states;e.data=un(e.filteredData,e)},execQuery:function(e){e&&e.filter||this.execFilter(),this.execSort()},clearFilter:function(e){var t=this.states,r=this.table.$refs,i=r.tableHeader,n=r.fixedTableHeader,o=r.rightFixedTableHeader,s={};i&&(s=bt()(s,i.filterPanels)),n&&(s=bt()(s,n.filterPanels)),o&&(s=bt()(s,o.filterPanels));var a=Object.keys(s);if(a.length)if("string"===typeof e&&(e=[e]),Array.isArray(e)){var c=e.map((function(e){return zi(t,e)}));a.forEach((function(e){var t=c.find((function(t){return t.id===e}));t&&(s[e].filteredValue=[])})),this.commit("filterChange",{column:c,values:[],silent:!0,multi:!0})}else a.forEach((function(e){s[e].filteredValue=[]})),t.filters={},this.commit("filterChange",{column:{},values:[],silent:!0})},clearSort:function(){var e=this.states;e.sortingColumn&&(this.updateSort(null,null,null),this.commit("changeSortCondition",{silent:!0}))},setExpandRowKeysAdapter:function(e){this.setExpandRowKeys(e),this.updateTreeExpandKeys(e)},toggleRowExpansionAdapter:function(e,t){var r=this.states.columns.some((function(e){var t=e.type;return"expand"===t}));r?this.toggleRowExpansion(e,t):this.toggleTreeExpansion(e,t)}}});hn.prototype.mutations={setData:function(e,t){var r=e._data!==t;e._data=t,this.execQuery(),this.updateCurrentRowData(),this.updateExpandRows(),e.reserveSelection?(this.assertRowKey(),this.updateSelectionByRowKey()):r?this.clearSelection():this.cleanSelection(),this.updateAllSelected(),this.updateTableScrollY()},insertColumn:function(e,t,r,i){var n=e._columns;i&&(n=i.children,n||(n=i.children=[])),"undefined"!==typeof r?n.splice(r,0,t):n.push(t),"selection"===t.type&&(e.selectable=t.selectable,e.reserveSelection=t.reserveSelection),this.table.$ready&&(this.updateColumns(),this.scheduleLayout())},removeColumn:function(e,t,r){var i=e._columns;r&&(i=r.children,i||(i=r.children=[])),i&&i.splice(i.indexOf(t),1),this.table.$ready&&(this.updateColumns(),this.scheduleLayout())},sort:function(e,t){var r=t.prop,i=t.order,n=t.init;if(r){var o=Object(v["arrayFind"])(e.columns,(function(e){return e.property===r}));o&&(o.order=i,this.updateSort(o,r,i),this.commit("changeSortCondition",{init:n}))}},changeSortCondition:function(e,t){var r=e.sortingColumn,i=e.sortProp,n=e.sortOrder;null===n&&(e.sortingColumn=null,e.sortProp=null);var o={filter:!0};this.execQuery(o),t&&(t.silent||t.init)||this.table.$emit("sort-change",{column:r,prop:i,order:n}),this.updateTableScrollY()},filterChange:function(e,t){var r=t.column,i=t.values,n=t.silent,o=this.updateFilters(r,i);this.execQuery(),n||this.table.$emit("filter-change",o),this.updateTableScrollY()},toggleAllSelection:function(){this.toggleAllSelection()},rowSelectedChanged:function(e,t){this.toggleRowSelection(t),this.updateAllSelected()},setHoverRow:function(e,t){e.hoverRow=t},setCurrentRow:function(e,t){this.updateCurrentRow(t)}},hn.prototype.commit=function(e){var t=this.mutations;if(!t[e])throw new Error("Action not found: "+e);for(var r=arguments.length,i=Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];t[e].apply(this,[this.states].concat(i))},hn.prototype.updateTableScrollY=function(){ji.a.nextTick(this.table.updateScrollY)};var pn=hn;function fn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)throw new Error("Table is required.");var r=new pn;return r.table=e,r.toggleAllSelection=B()(10,r._toggleAllSelection),Object.keys(t).forEach((function(e){r.states[e]=t[e]})),r}function gn(e){var t={};return Object.keys(e).forEach((function(r){var i=e[r],n=void 0;"string"===typeof i?n=function(){return this.store.states[i]}:"function"===typeof i?n=function(){return i.call(this,this.store.states)}:console.error("invalid value type"),n&&(t[r]=n)})),t}var mn=r(30),_n=r.n(mn);function vn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var En=function(){function e(t){for(var r in vn(this,e),this.observers=[],this.table=null,this.store=null,this.columns=null,this.fit=!0,this.showHeader=!0,this.height=null,this.scrollX=!1,this.scrollY=!1,this.bodyWidth=null,this.fixedWidth=null,this.rightFixedWidth=null,this.tableHeight=null,this.headerHeight=44,this.appendHeight=0,this.footerHeight=44,this.viewportHeight=null,this.bodyHeight=null,this.fixedBodyHeight=null,this.gutterWidth=_n()(),t)t.hasOwnProperty(r)&&(this[r]=t[r]);if(!this.table)throw new Error("table is required for Table Layout");if(!this.store)throw new Error("store is required for Table Layout")}return e.prototype.updateScrollY=function(){var e=this.height;if(null===e)return!1;var t=this.table.bodyWrapper;if(this.table.$el&&t){var r=t.querySelector(".el-table__body"),i=this.scrollY,n=r.offsetHeight>this.bodyHeight;return this.scrollY=n,i!==n}return!1},e.prototype.setHeight=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"height";if(!ji.a.prototype.$isServer){var i=this.table.$el;if(e=tn(e),this.height=e,!i&&(e||0===e))return ji.a.nextTick((function(){return t.setHeight(e,r)}));"number"===typeof e?(i.style[r]=e+"px",this.updateElsHeight()):"string"===typeof e&&(i.style[r]=e,this.updateElsHeight())}},e.prototype.setMaxHeight=function(e){this.setHeight(e,"max-height")},e.prototype.getFlattenColumns=function(){var e=[],t=this.table.columns;return t.forEach((function(t){t.isColumnGroup?e.push.apply(e,t.columns):e.push(t)})),e},e.prototype.updateElsHeight=function(){var e=this;if(!this.table.$ready)return ji.a.nextTick((function(){return e.updateElsHeight()}));var t=this.table.$refs,r=t.headerWrapper,i=t.appendWrapper,n=t.footerWrapper;if(this.appendHeight=i?i.offsetHeight:0,!this.showHeader||r){var o=r?r.querySelector(".el-table__header tr"):null,s=this.headerDisplayNone(o),a=this.headerHeight=this.showHeader?r.offsetHeight:0;if(this.showHeader&&!s&&r.offsetWidth>0&&(this.table.columns||[]).length>0&&a<2)return ji.a.nextTick((function(){return e.updateElsHeight()}));var c=this.tableHeight=this.table.$el.clientHeight,l=this.footerHeight=n?n.offsetHeight:0;null!==this.height&&(this.bodyHeight=c-a-l+(n?1:0)),this.fixedBodyHeight=this.scrollX?this.bodyHeight-this.gutterWidth:this.bodyHeight;var u=!(this.store.states.data&&this.store.states.data.length);this.viewportHeight=this.scrollX?c-(u?0:this.gutterWidth):c,this.updateScrollY(),this.notifyObservers("scrollable")}},e.prototype.headerDisplayNone=function(e){if(!e)return!0;var t=e;while("DIV"!==t.tagName){if("none"===getComputedStyle(t).display)return!0;t=t.parentElement}return!1},e.prototype.updateColumnsWidth=function(){if(!ji.a.prototype.$isServer){var e=this.fit,t=this.table.$el.clientWidth,r=0,i=this.getFlattenColumns(),n=i.filter((function(e){return"number"!==typeof e.width}));if(i.forEach((function(e){"number"===typeof e.width&&e.realWidth&&(e.realWidth=null)})),n.length>0&&e){i.forEach((function(e){r+=e.width||e.minWidth||80}));var o=this.scrollY?this.gutterWidth:0;if(r<=t-o){this.scrollX=!1;var s=t-o-r;if(1===n.length)n[0].realWidth=(n[0].minWidth||80)+s;else{var a=n.reduce((function(e,t){return e+(t.minWidth||80)}),0),c=s/a,l=0;n.forEach((function(e,t){if(0!==t){var r=Math.floor((e.minWidth||80)*c);l+=r,e.realWidth=(e.minWidth||80)+r}})),n[0].realWidth=(n[0].minWidth||80)+s-l}}else this.scrollX=!0,n.forEach((function(e){e.realWidth=e.minWidth}));this.bodyWidth=Math.max(r,t),this.table.resizeState.width=this.bodyWidth}else i.forEach((function(e){e.width||e.minWidth?e.realWidth=e.width||e.minWidth:e.realWidth=80,r+=e.realWidth})),this.scrollX=r>t,this.bodyWidth=r;var u=this.store.states.fixedColumns;if(u.length>0){var d=0;u.forEach((function(e){d+=e.realWidth||e.width})),this.fixedWidth=d}var h=this.store.states.rightFixedColumns;if(h.length>0){var p=0;h.forEach((function(e){p+=e.realWidth||e.width})),this.rightFixedWidth=p}this.notifyObservers("columns")}},e.prototype.addObserver=function(e){this.observers.push(e)},e.prototype.removeObserver=function(e){var t=this.observers.indexOf(e);-1!==t&&this.observers.splice(t,1)},e.prototype.notifyObservers=function(e){var t=this,r=this.observers;r.forEach((function(r){switch(e){case"columns":r.onColumnsChange(t);break;case"scrollable":r.onScrollableChange(t);break;default:throw new Error("Table Layout don't have event "+e+".")}}))},e}(),An=En,yn={created:function(){this.tableLayout.addObserver(this)},destroyed:function(){this.tableLayout.removeObserver(this)},computed:{tableLayout:function(){var e=this.layout;if(!e&&this.table&&(e=this.table.layout),!e)throw new Error("Can not find table layout.");return e}},mounted:function(){this.onColumnsChange(this.tableLayout),this.onScrollableChange(this.tableLayout)},updated:function(){this.__updated__||(this.onColumnsChange(this.tableLayout),this.onScrollableChange(this.tableLayout),this.__updated__=!0)},methods:{onColumnsChange:function(e){var t=this.$el.querySelectorAll("colgroup > col");if(t.length){var r=e.getFlattenColumns(),i={};r.forEach((function(e){i[e.id]=e}));for(var n=0,o=t.length;n<o;n++){var s=t[n],a=s.getAttribute("name"),c=i[a];c&&s.setAttribute("width",c.realWidth||c.width)}}},onScrollableChange:function(e){for(var t=this.$el.querySelectorAll("colgroup > col[name=gutter]"),r=0,i=t.length;r<i;r++){var n=t[r];n.setAttribute("width",e.scrollY?e.gutterWidth:"0")}for(var o=this.$el.querySelectorAll("th.gutter"),s=0,a=o.length;s<a;s++){var c=o[s];c.style.width=e.scrollY?e.gutterWidth+"px":"0",c.style.display=e.scrollY?"":"none"}}}},Sn="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Tn={name:"ElTableBody",mixins:[yn],components:{ElCheckbox:Pi.a,ElTooltip:nt.a},props:{store:{required:!0},stripe:Boolean,context:{},rowClassName:[String,Function],rowStyle:[Object,Function],fixed:String,highlight:Boolean},render:function(e){var t=this,r=this.data||[];return e("table",{class:"el-table__body",attrs:{cellspacing:"0",cellpadding:"0",border:"0"}},[e("colgroup",[this.columns.map((function(t){return e("col",{attrs:{name:t.id},key:t.id})}))]),e("tbody",[r.reduce((function(e,r){return e.concat(t.wrappedRowRender(r,e.length))}),[]),e("el-tooltip",{attrs:{effect:this.table.tooltipEffect,placement:"top",content:this.tooltipContent},ref:"tooltip"})])])},computed:Cn({table:function(){return this.$parent}},gn({data:"data",columns:"columns",treeIndent:"indent",leftFixedLeafCount:"fixedLeafColumnsLength",rightFixedLeafCount:"rightFixedLeafColumnsLength",columnsCount:function(e){return e.columns.length},leftFixedCount:function(e){return e.fixedColumns.length},rightFixedCount:function(e){return e.rightFixedColumns.length},hasExpandColumn:function(e){return e.columns.some((function(e){var t=e.type;return"expand"===t}))}}),{firstDefaultColumnIndex:function(){return Object(v["arrayFindIndex"])(this.columns,(function(e){var t=e.type;return"default"===t}))}}),watch:{"store.states.hoverRow":function(e,t){var r=this;if(this.store.states.isComplex&&!this.$isServer){var i=window.requestAnimationFrame;i||(i=function(e){return setTimeout(e,16)}),i((function(){var i=r.$el.querySelectorAll(".el-table__row"),n=i[t],o=i[e];n&&Object(Ue["removeClass"])(n,"hover-row"),o&&Object(Ue["addClass"])(o,"hover-row")}))}}},data:function(){return{tooltipContent:""}},created:function(){this.activateTooltip=B()(50,(function(e){return e.handleShowPopper()}))},methods:{getKeyOfRow:function(e,t){var r=this.table.rowKey;return r?Yi(e,r):t},isColumnHidden:function(e){return!0===this.fixed||"left"===this.fixed?e>=this.leftFixedLeafCount:"right"===this.fixed?e<this.columnsCount-this.rightFixedLeafCount:e<this.leftFixedLeafCount||e>=this.columnsCount-this.rightFixedLeafCount},getSpan:function(e,t,r,i){var n=1,o=1,s=this.table.spanMethod;if("function"===typeof s){var a=s({row:e,column:t,rowIndex:r,columnIndex:i});Array.isArray(a)?(n=a[0],o=a[1]):"object"===("undefined"===typeof a?"undefined":Sn(a))&&(n=a.rowspan,o=a.colspan)}return{rowspan:n,colspan:o}},getRowStyle:function(e,t){var r=this.table.rowStyle;return"function"===typeof r?r.call(null,{row:e,rowIndex:t}):r||null},getRowClass:function(e,t){var r=["el-table__row"];this.table.highlightCurrentRow&&e===this.store.states.currentRow&&r.push("current-row"),this.stripe&&t%2===1&&r.push("el-table__row--striped");var i=this.table.rowClassName;return"string"===typeof i?r.push(i):"function"===typeof i&&r.push(i.call(null,{row:e,rowIndex:t})),this.store.states.expandRows.indexOf(e)>-1&&r.push("expanded"),r},getCellStyle:function(e,t,r,i){var n=this.table.cellStyle;return"function"===typeof n?n.call(null,{rowIndex:e,columnIndex:t,row:r,column:i}):n},getCellClass:function(e,t,r,i){var n=[i.id,i.align,i.className];this.isColumnHidden(t)&&n.push("is-hidden");var o=this.table.cellClassName;return"string"===typeof o?n.push(o):"function"===typeof o&&n.push(o.call(null,{rowIndex:e,columnIndex:t,row:r,column:i})),n.push("el-table__cell"),n.join(" ")},getColspanRealWidth:function(e,t,r){if(t<1)return e[r].realWidth;var i=e.map((function(e){var t=e.realWidth;return t})).slice(r,r+t);return i.reduce((function(e,t){return e+t}),-1)},handleCellMouseEnter:function(e,t){var r=this.table,i=Hi(e);if(i){var n=Zi(r,i),o=r.hoverState={cell:i,column:n,row:t};r.$emit("cell-mouse-enter",o.row,o.column,o.cell,e)}var s=e.target.querySelector(".cell");if(Object(Ue["hasClass"])(s,"el-tooltip")&&s.childNodes.length){var a=document.createRange();a.setStart(s,0),a.setEnd(s,s.childNodes.length);var c=a.getBoundingClientRect().width,l=(parseInt(Object(Ue["getStyle"])(s,"paddingLeft"),10)||0)+(parseInt(Object(Ue["getStyle"])(s,"paddingRight"),10)||0);if((c+l>s.offsetWidth||s.scrollWidth>s.offsetWidth)&&this.$refs.tooltip){var u=this.$refs.tooltip;this.tooltipContent=i.innerText||i.textContent,u.referenceElm=i,u.$refs.popper&&(u.$refs.popper.style.display="none"),u.doDestroy(),u.setExpectedState(!0),this.activateTooltip(u)}}},handleCellMouseLeave:function(e){var t=this.$refs.tooltip;t&&(t.setExpectedState(!1),t.handleClosePopper());var r=Hi(e);if(r){var i=this.table.hoverState||{};this.table.$emit("cell-mouse-leave",i.row,i.column,i.cell,e)}},handleMouseEnter:B()(30,(function(e){this.store.commit("setHoverRow",e)})),handleMouseLeave:B()(30,(function(){this.store.commit("setHoverRow",null)})),handleContextMenu:function(e,t){this.handleEvent(e,t,"contextmenu")},handleDoubleClick:function(e,t){this.handleEvent(e,t,"dblclick")},handleClick:function(e,t){this.store.commit("setCurrentRow",t),this.handleEvent(e,t,"click")},handleEvent:function(e,t,r){var i=this.table,n=Hi(e),o=void 0;n&&(o=Zi(i,n),o&&i.$emit("cell-"+r,t,o,n,e)),i.$emit("row-"+r,t,o,e)},rowRender:function(e,t,r){var i=this,n=this.$createElement,o=this.treeIndent,s=this.columns,a=this.firstDefaultColumnIndex,c=s.map((function(e,t){return i.isColumnHidden(t)})),l=this.getRowClass(e,t),u=!0;r&&(l.push("el-table__row--level-"+r.level),u=r.display);var d=u?null:{display:"none"};return n("tr",{style:[d,this.getRowStyle(e,t)],class:l,key:this.getKeyOfRow(e,t),on:{dblclick:function(t){return i.handleDoubleClick(t,e)},click:function(t){return i.handleClick(t,e)},contextmenu:function(t){return i.handleContextMenu(t,e)},mouseenter:function(e){return i.handleMouseEnter(t)},mouseleave:this.handleMouseLeave}},[s.map((function(l,u){var d=i.getSpan(e,l,t,u),h=d.rowspan,p=d.colspan;if(!h||!p)return null;var f=Cn({},l);f.realWidth=i.getColspanRealWidth(s,p,u);var g={store:i.store,_self:i.context||i.table.$vnode.context,column:f,row:e,$index:t};return u===a&&r&&(g.treeNode={indent:r.level*o,level:r.level},"boolean"===typeof r.expanded&&(g.treeNode.expanded=r.expanded,"loading"in r&&(g.treeNode.loading=r.loading),"noLazyChildren"in r&&(g.treeNode.noLazyChildren=r.noLazyChildren))),n("td",{style:i.getCellStyle(t,u,e,l),class:i.getCellClass(t,u,e,l),attrs:{rowspan:h,colspan:p},on:{mouseenter:function(t){return i.handleCellMouseEnter(t,e)},mouseleave:i.handleCellMouseLeave}},[l.renderCell.call(i._renderProxy,i.$createElement,g,c[u])])}))])},wrappedRowRender:function(e,t){var r=this,i=this.$createElement,n=this.store,o=n.isRowExpanded,s=n.assertRowKey,a=n.states,c=a.treeData,l=a.lazyTreeNodeMap,u=a.childrenColumnName,d=a.rowKey;if(this.hasExpandColumn&&o(e)){var h=this.table.renderExpanded,p=this.rowRender(e,t);return h?[[p,i("tr",{key:"expanded-row__"+p.key},[i("td",{attrs:{colspan:this.columnsCount},class:"el-table__cell el-table__expanded-cell"},[h(this.$createElement,{row:e,$index:t,store:this.store})])])]]:(console.error("[Element Error]renderExpanded is required."),p)}if(Object.keys(c).length){s();var f=Yi(e,d),g=c[f],m=null;g&&(m={expanded:g.expanded,level:g.level,display:!0},"boolean"===typeof g.lazy&&("boolean"===typeof g.loaded&&g.loaded&&(m.noLazyChildren=!(g.children&&g.children.length)),m.loading=g.loading));var _=[this.rowRender(e,t,m)];if(g){var v=0,E=function e(i,n){i&&i.length&&n&&i.forEach((function(i){var o={display:n.display&&n.expanded,level:n.level+1},s=Yi(i,d);if(void 0===s||null===s)throw new Error("for nested data item, row-key is required.");if(g=Cn({},c[s]),g&&(o.expanded=g.expanded,g.level=g.level||o.level,g.display=!(!g.expanded||!o.display),"boolean"===typeof g.lazy&&("boolean"===typeof g.loaded&&g.loaded&&(o.noLazyChildren=!(g.children&&g.children.length)),o.loading=g.loading)),v++,_.push(r.rowRender(i,t+v,o)),g){var a=l[s]||i[u];e(a,g)}}))};g.display=!0;var A=l[f]||e[u];E(A,g)}return _}return this.rowRender(e,t)}}},bn=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition",{attrs:{name:"el-zoom-in-top"}},[e.multiple?r("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.handleOutsideClick,expression:"handleOutsideClick"},{name:"show",rawName:"v-show",value:e.showPopper,expression:"showPopper"}],staticClass:"el-table-filter"},[r("div",{staticClass:"el-table-filter__content"},[r("el-scrollbar",{attrs:{"wrap-class":"el-table-filter__wrap"}},[r("el-checkbox-group",{staticClass:"el-table-filter__checkbox-group",model:{value:e.filteredValue,callback:function(t){e.filteredValue=t},expression:"filteredValue"}},e._l(e.filters,(function(t){return r("el-checkbox",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.text))])})),1)],1)],1),r("div",{staticClass:"el-table-filter__bottom"},[r("button",{class:{"is-disabled":0===e.filteredValue.length},attrs:{disabled:0===e.filteredValue.length},on:{click:e.handleConfirm}},[e._v(e._s(e.t("el.table.confirmFilter")))]),r("button",{on:{click:e.handleReset}},[e._v(e._s(e.t("el.table.resetFilter")))])])]):r("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.handleOutsideClick,expression:"handleOutsideClick"},{name:"show",rawName:"v-show",value:e.showPopper,expression:"showPopper"}],staticClass:"el-table-filter"},[r("ul",{staticClass:"el-table-filter__list"},[r("li",{staticClass:"el-table-filter__list-item",class:{"is-active":void 0===e.filterValue||null===e.filterValue},on:{click:function(t){e.handleSelect(null)}}},[e._v(e._s(e.t("el.table.clearFilter")))]),e._l(e.filters,(function(t){return r("li",{key:t.value,staticClass:"el-table-filter__list-item",class:{"is-active":e.isActive(t)},attrs:{label:t.value},on:{click:function(r){e.handleSelect(t.value)}}},[e._v(e._s(t.text))])}))],2)])])},In=[];bn._withStripped=!0;var Rn=[];!ji.a.prototype.$isServer&&document.addEventListener("click",(function(e){Rn.forEach((function(t){var r=e.target;t&&t.$el&&(r===t.$el||t.$el.contains(r)||t.handleOutsideClick&&t.handleOutsideClick(e))}))}));var wn={open:function(e){e&&Rn.push(e)},close:function(e){var t=Rn.indexOf(e);-1!==t&&Rn.splice(e,1)}},kn=r(31),On=r.n(kn),Nn={name:"ElTableFilterPanel",mixins:[H.a,_.a],directives:{Clickoutside:F.a},components:{ElCheckbox:Pi.a,ElCheckboxGroup:On.a,ElScrollbar:W.a},props:{placement:{type:String,default:"bottom-end"}},methods:{isActive:function(e){return e.value===this.filterValue},handleOutsideClick:function(){var e=this;setTimeout((function(){e.showPopper=!1}),16)},handleConfirm:function(){this.confirmFilter(this.filteredValue),this.handleOutsideClick()},handleReset:function(){this.filteredValue=[],this.confirmFilter(this.filteredValue),this.handleOutsideClick()},handleSelect:function(e){this.filterValue=e,"undefined"!==typeof e&&null!==e?this.confirmFilter(this.filteredValue):this.confirmFilter([]),this.handleOutsideClick()},confirmFilter:function(e){this.table.store.commit("filterChange",{column:this.column,values:e}),this.table.store.updateAllSelected()}},data:function(){return{table:null,cell:null,column:null}},computed:{filters:function(){return this.column&&this.column.filters},filterValue:{get:function(){return(this.column.filteredValue||[])[0]},set:function(e){this.filteredValue&&("undefined"!==typeof e&&null!==e?this.filteredValue.splice(0,1,e):this.filteredValue.splice(0,1))}},filteredValue:{get:function(){return this.column&&this.column.filteredValue||[]},set:function(e){this.column&&(this.column.filteredValue=e)}},multiple:function(){return!this.column||this.column.filterMultiple}},mounted:function(){var e=this;this.popperElm=this.$el,this.referenceElm=this.cell,this.table.bodyWrapper.addEventListener("scroll",(function(){e.updatePopper()})),this.$watch("showPopper",(function(t){e.column&&(e.column.filterOpened=t),t?wn.open(e):wn.close(e)}))},watch:{showPopper:function(e){!0===e&&parseInt(this.popperJS._popper.style.zIndex,10)<C["PopupManager"].zIndex&&(this.popperJS._popper.style.zIndex=C["PopupManager"].nextZIndex())}}},Ln=Nn,Pn=a(Ln,bn,In,!1,null,null,null);Pn.options.__file="packages/table/src/filter-panel.vue";var Dn=Pn.exports,Mn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},xn=function e(t){var r=[];return t.forEach((function(t){t.children?(r.push(t),r.push.apply(r,e(t.children))):r.push(t)})),r},Bn=function(e){var t=1,r=function e(r,i){if(i&&(r.level=i.level+1,t<r.level&&(t=r.level)),r.children){var n=0;r.children.forEach((function(t){e(t,r),n+=t.colSpan})),r.colSpan=n}else r.colSpan=1};e.forEach((function(e){e.level=1,r(e)}));for(var i=[],n=0;n<t;n++)i.push([]);var o=xn(e);return o.forEach((function(e){e.children?e.rowSpan=1:e.rowSpan=t-e.level+1,i[e.level-1].push(e)})),i},Un={name:"ElTableHeader",mixins:[yn],render:function(e){var t=this,r=this.store.states.originColumns,i=Bn(r,this.columns),n=i.length>1;return n&&(this.$parent.isGroup=!0),e("table",{class:"el-table__header",attrs:{cellspacing:"0",cellpadding:"0",border:"0"}},[e("colgroup",[this.columns.map((function(t){return e("col",{attrs:{name:t.id},key:t.id})})),this.hasGutter?e("col",{attrs:{name:"gutter"}}):""]),e("thead",{class:[{"is-group":n,"has-gutter":this.hasGutter}]},[this._l(i,(function(r,i){return e("tr",{style:t.getHeaderRowStyle(i),class:t.getHeaderRowClass(i)},[r.map((function(n,o){return e("th",{attrs:{colspan:n.colSpan,rowspan:n.rowSpan},on:{mousemove:function(e){return t.handleMouseMove(e,n)},mouseout:t.handleMouseOut,mousedown:function(e){return t.handleMouseDown(e,n)},click:function(e){return t.handleHeaderClick(e,n)},contextmenu:function(e){return t.handleHeaderContextMenu(e,n)}},style:t.getHeaderCellStyle(i,o,r,n),class:t.getHeaderCellClass(i,o,r,n),key:n.id},[e("div",{class:["cell",n.filteredValue&&n.filteredValue.length>0?"highlight":"",n.labelClassName]},[n.renderHeader?n.renderHeader.call(t._renderProxy,e,{column:n,$index:o,store:t.store,_self:t.$parent.$vnode.context}):n.label,n.sortable?e("span",{class:"caret-wrapper",on:{click:function(e){return t.handleSortClick(e,n)}}},[e("i",{class:"sort-caret ascending",on:{click:function(e){return t.handleSortClick(e,n,"ascending")}}}),e("i",{class:"sort-caret descending",on:{click:function(e){return t.handleSortClick(e,n,"descending")}}})]):"",n.filterable?e("span",{class:"el-table__column-filter-trigger",on:{click:function(e){return t.handleFilterClick(e,n)}}},[e("i",{class:["el-icon-arrow-down",n.filterOpened?"el-icon-arrow-up":""]})]):""])])})),t.hasGutter?e("th",{class:"el-table__cell gutter"}):""])}))])])},props:{fixed:String,store:{required:!0},border:Boolean,defaultSort:{type:Object,default:function(){return{prop:"",order:""}}}},components:{ElCheckbox:Pi.a},computed:Mn({table:function(){return this.$parent},hasGutter:function(){return!this.fixed&&this.tableLayout.gutterWidth}},gn({columns:"columns",isAllSelected:"isAllSelected",leftFixedLeafCount:"fixedLeafColumnsLength",rightFixedLeafCount:"rightFixedLeafColumnsLength",columnsCount:function(e){return e.columns.length},leftFixedCount:function(e){return e.fixedColumns.length},rightFixedCount:function(e){return e.rightFixedColumns.length}})),created:function(){this.filterPanels={}},mounted:function(){var e=this;this.$nextTick((function(){var t=e.defaultSort,r=t.prop,i=t.order,n=!0;e.store.commit("sort",{prop:r,order:i,init:n})}))},beforeDestroy:function(){var e=this.filterPanels;for(var t in e)e.hasOwnProperty(t)&&e[t]&&e[t].$destroy(!0)},methods:{isCellHidden:function(e,t){for(var r=0,i=0;i<e;i++)r+=t[i].colSpan;var n=r+t[e].colSpan-1;return!0===this.fixed||"left"===this.fixed?n>=this.leftFixedLeafCount:"right"===this.fixed?r<this.columnsCount-this.rightFixedLeafCount:n<this.leftFixedLeafCount||r>=this.columnsCount-this.rightFixedLeafCount},getHeaderRowStyle:function(e){var t=this.table.headerRowStyle;return"function"===typeof t?t.call(null,{rowIndex:e}):t},getHeaderRowClass:function(e){var t=[],r=this.table.headerRowClassName;return"string"===typeof r?t.push(r):"function"===typeof r&&t.push(r.call(null,{rowIndex:e})),t.join(" ")},getHeaderCellStyle:function(e,t,r,i){var n=this.table.headerCellStyle;return"function"===typeof n?n.call(null,{rowIndex:e,columnIndex:t,row:r,column:i}):n},getHeaderCellClass:function(e,t,r,i){var n=[i.id,i.order,i.headerAlign,i.className,i.labelClassName];0===e&&this.isCellHidden(t,r)&&n.push("is-hidden"),i.children||n.push("is-leaf"),i.sortable&&n.push("is-sortable");var o=this.table.headerCellClassName;return"string"===typeof o?n.push(o):"function"===typeof o&&n.push(o.call(null,{rowIndex:e,columnIndex:t,row:r,column:i})),n.push("el-table__cell"),n.join(" ")},toggleAllSelection:function(e){e.stopPropagation(),this.store.commit("toggleAllSelection")},handleFilterClick:function(e,t){e.stopPropagation();var r=e.target,i="TH"===r.tagName?r:r.parentNode;if(!Object(Ue["hasClass"])(i,"noclick")){i=i.querySelector(".el-table__column-filter-trigger")||i;var n=this.$parent,o=this.filterPanels[t.id];o&&t.filterOpened?o.showPopper=!1:(o||(o=new ji.a(Dn),this.filterPanels[t.id]=o,t.filterPlacement&&(o.placement=t.filterPlacement),o.table=n,o.cell=i,o.column=t,!this.$isServer&&o.$mount(document.createElement("div"))),setTimeout((function(){o.showPopper=!0}),16))}},handleHeaderClick:function(e,t){!t.filters&&t.sortable?this.handleSortClick(e,t):t.filterable&&!t.sortable&&this.handleFilterClick(e,t),this.$parent.$emit("header-click",t,e)},handleHeaderContextMenu:function(e,t){this.$parent.$emit("header-contextmenu",t,e)},handleMouseDown:function(e,t){var r=this;if(!this.$isServer&&!(t.children&&t.children.length>0)&&this.draggingColumn&&this.border){this.dragging=!0,this.$parent.resizeProxyVisible=!0;var i=this.$parent,n=i.$el,o=n.getBoundingClientRect().left,s=this.$el.querySelector("th."+t.id),a=s.getBoundingClientRect(),c=a.left-o+30;Object(Ue["addClass"])(s,"noclick"),this.dragState={startMouseLeft:e.clientX,startLeft:a.right-o,startColumnLeft:a.left-o,tableLeft:o};var l=i.$refs.resizeProxy;l.style.left=this.dragState.startLeft+"px",document.onselectstart=function(){return!1},document.ondragstart=function(){return!1};var u=function(e){var t=e.clientX-r.dragState.startMouseLeft,i=r.dragState.startLeft+t;l.style.left=Math.max(c,i)+"px"},d=function n(){if(r.dragging){var o=r.dragState,a=o.startColumnLeft,c=o.startLeft,d=parseInt(l.style.left,10),h=d-a;t.width=t.realWidth=h,i.$emit("header-dragend",t.width,c-a,t,e),r.store.scheduleLayout(),document.body.style.cursor="",r.dragging=!1,r.draggingColumn=null,r.dragState={},i.resizeProxyVisible=!1}document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",n),document.onselectstart=null,document.ondragstart=null,setTimeout((function(){Object(Ue["removeClass"])(s,"noclick")}),0)};document.addEventListener("mousemove",u),document.addEventListener("mouseup",d)}},handleMouseMove:function(e,t){if(!(t.children&&t.children.length>0)){var r=e.target;while(r&&"TH"!==r.tagName)r=r.parentNode;if(t&&t.resizable&&!this.dragging&&this.border){var i=r.getBoundingClientRect(),n=document.body.style;i.width>12&&i.right-e.pageX<8?(n.cursor="col-resize",Object(Ue["hasClass"])(r,"is-sortable")&&(r.style.cursor="col-resize"),this.draggingColumn=t):this.dragging||(n.cursor="",Object(Ue["hasClass"])(r,"is-sortable")&&(r.style.cursor="pointer"),this.draggingColumn=null)}}},handleMouseOut:function(){this.$isServer||(document.body.style.cursor="")},toggleOrder:function(e){var t=e.order,r=e.sortOrders;if(""===t)return r[0];var i=r.indexOf(t||null);return r[i>r.length-2?0:i+1]},handleSortClick:function(e,t,r){e.stopPropagation();var i=t.order===r?null:r||this.toggleOrder(t),n=e.target;while(n&&"TH"!==n.tagName)n=n.parentNode;if(n&&"TH"===n.tagName&&Object(Ue["hasClass"])(n,"noclick"))Object(Ue["removeClass"])(n,"noclick");else if(t.sortable){var o=this.store.states,s=o.sortProp,a=void 0,c=o.sortingColumn;(c!==t||c===t&&null===c.order)&&(c&&(c.order=null),o.sortingColumn=t,s=t.property),a=t.order=i||null,o.sortProp=s,o.sortOrder=a,this.store.commit("changeSortCondition")}}},data:function(){return{draggingColumn:null,dragging:!1,dragState:{}}}},Fn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Vn={name:"ElTableFooter",mixins:[yn],render:function(e){var t=this,r=[];return this.summaryMethod?r=this.summaryMethod({columns:this.columns,data:this.store.states.data}):this.columns.forEach((function(e,i){if(0!==i){var n=t.store.states.data.map((function(t){return Number(t[e.property])})),o=[],s=!0;n.forEach((function(e){if(!isNaN(e)){s=!1;var t=(""+e).split(".")[1];o.push(t?t.length:0)}}));var a=Math.max.apply(null,o);r[i]=s?"":n.reduce((function(e,t){var r=Number(t);return isNaN(r)?e:parseFloat((e+t).toFixed(Math.min(a,20)))}),0)}else r[i]=t.sumText})),e("table",{class:"el-table__footer",attrs:{cellspacing:"0",cellpadding:"0",border:"0"}},[e("colgroup",[this.columns.map((function(t){return e("col",{attrs:{name:t.id},key:t.id})})),this.hasGutter?e("col",{attrs:{name:"gutter"}}):""]),e("tbody",{class:[{"has-gutter":this.hasGutter}]},[e("tr",[this.columns.map((function(i,n){return e("td",{key:n,attrs:{colspan:i.colSpan,rowspan:i.rowSpan},class:[].concat(t.getRowClasses(i,n),["el-table__cell"])},[e("div",{class:["cell",i.labelClassName]},[r[n]])])})),this.hasGutter?e("th",{class:"el-table__cell gutter"}):""])])])},props:{fixed:String,store:{required:!0},summaryMethod:Function,sumText:String,border:Boolean,defaultSort:{type:Object,default:function(){return{prop:"",order:""}}}},computed:Fn({table:function(){return this.$parent},hasGutter:function(){return!this.fixed&&this.tableLayout.gutterWidth}},gn({columns:"columns",isAllSelected:"isAllSelected",leftFixedLeafCount:"fixedLeafColumnsLength",rightFixedLeafCount:"rightFixedLeafColumnsLength",columnsCount:function(e){return e.columns.length},leftFixedCount:function(e){return e.fixedColumns.length},rightFixedCount:function(e){return e.rightFixedColumns.length}})),methods:{isCellHidden:function(e,t,r){if(!0===this.fixed||"left"===this.fixed)return e>=this.leftFixedLeafCount;if("right"===this.fixed){for(var i=0,n=0;n<e;n++)i+=t[n].colSpan;return i<this.columnsCount-this.rightFixedLeafCount}return!(this.fixed||!r.fixed)||(e<this.leftFixedCount||e>=this.columnsCount-this.rightFixedCount)},getRowClasses:function(e,t){var r=[e.id,e.align,e.labelClassName];return e.className&&r.push(e.className),this.isCellHidden(t,this.columns,e)&&r.push("is-hidden"),e.children||r.push("is-leaf"),r}}},jn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Gn=1,Hn={name:"ElTable",mixins:[_.a,I.a],directives:{Mousewheel:Fi},props:{data:{type:Array,default:function(){return[]}},size:String,width:[String,Number],height:[String,Number],maxHeight:[String,Number],fit:{type:Boolean,default:!0},stripe:Boolean,border:Boolean,rowKey:[String,Function],context:{},showHeader:{type:Boolean,default:!0},showSummary:Boolean,sumText:String,summaryMethod:Function,rowClassName:[String,Function],rowStyle:[Object,Function],cellClassName:[String,Function],cellStyle:[Object,Function],headerRowClassName:[String,Function],headerRowStyle:[Object,Function],headerCellClassName:[String,Function],headerCellStyle:[Object,Function],highlightCurrentRow:Boolean,currentRowKey:[String,Number],emptyText:String,expandRowKeys:Array,defaultExpandAll:Boolean,defaultSort:Object,tooltipEffect:String,spanMethod:Function,selectOnIndeterminate:{type:Boolean,default:!0},indent:{type:Number,default:16},treeProps:{type:Object,default:function(){return{hasChildren:"hasChildren",children:"children"}}},lazy:Boolean,load:Function},components:{TableHeader:Un,TableFooter:Vn,TableBody:Tn,ElCheckbox:Pi.a},methods:{getMigratingConfig:function(){return{events:{expand:"expand is renamed to expand-change"}}},setCurrentRow:function(e){this.store.commit("setCurrentRow",e)},toggleRowSelection:function(e,t){this.store.toggleRowSelection(e,t,!1),this.store.updateAllSelected()},toggleRowExpansion:function(e,t){this.store.toggleRowExpansionAdapter(e,t)},clearSelection:function(){this.store.clearSelection()},clearFilter:function(e){this.store.clearFilter(e)},clearSort:function(){this.store.clearSort()},handleMouseLeave:function(){this.store.commit("setHoverRow",null),this.hoverState&&(this.hoverState=null)},updateScrollY:function(){var e=this.layout.updateScrollY();e&&(this.layout.notifyObservers("scrollable"),this.layout.updateColumnsWidth())},handleFixedMousewheel:function(e,t){var r=this.bodyWrapper;if(Math.abs(t.spinY)>0){var i=r.scrollTop;t.pixelY<0&&0!==i&&e.preventDefault(),t.pixelY>0&&r.scrollHeight-r.clientHeight>i&&e.preventDefault(),r.scrollTop+=Math.ceil(t.pixelY/5)}else r.scrollLeft+=Math.ceil(t.pixelX/5)},handleHeaderFooterMousewheel:function(e,t){var r=t.pixelX,i=t.pixelY;Math.abs(r)>=Math.abs(i)&&(this.bodyWrapper.scrollLeft+=t.pixelX/5)},syncPostion:Object(Di["throttle"])(20,(function(){var e=this.bodyWrapper,t=e.scrollLeft,r=e.scrollTop,i=e.offsetWidth,n=e.scrollWidth,o=this.$refs,s=o.headerWrapper,a=o.footerWrapper,c=o.fixedBodyWrapper,l=o.rightFixedBodyWrapper;s&&(s.scrollLeft=t),a&&(a.scrollLeft=t),c&&(c.scrollTop=r),l&&(l.scrollTop=r);var u=n-i-1;this.scrollPosition=t>=u?"right":0===t?"left":"middle"})),bindEvents:function(){this.bodyWrapper.addEventListener("scroll",this.syncPostion,{passive:!0}),this.fit&&Object(Xr["addResizeListener"])(this.$el,this.resizeListener)},unbindEvents:function(){this.bodyWrapper.removeEventListener("scroll",this.syncPostion,{passive:!0}),this.fit&&Object(Xr["removeResizeListener"])(this.$el,this.resizeListener)},resizeListener:function(){if(this.$ready){var e=!1,t=this.$el,r=this.resizeState,i=r.width,n=r.height,o=t.offsetWidth;i!==o&&(e=!0);var s=t.offsetHeight;(this.height||this.shouldUpdateHeight)&&n!==s&&(e=!0),e&&(this.resizeState.width=o,this.resizeState.height=s,this.doLayout())}},doLayout:function(){this.shouldUpdateHeight&&this.layout.updateElsHeight(),this.layout.updateColumnsWidth()},sort:function(e,t){this.store.commit("sort",{prop:e,order:t})},toggleAllSelection:function(){this.store.commit("toggleAllSelection")}},computed:jn({tableSize:function(){return this.size||(this.$ELEMENT||{}).size},bodyWrapper:function(){return this.$refs.bodyWrapper},shouldUpdateHeight:function(){return this.height||this.maxHeight||this.fixedColumns.length>0||this.rightFixedColumns.length>0},bodyWidth:function(){var e=this.layout,t=e.bodyWidth,r=e.scrollY,i=e.gutterWidth;return t?t-(r?i:0)+"px":""},bodyHeight:function(){var e=this.layout,t=e.headerHeight,r=void 0===t?0:t,i=e.bodyHeight,n=e.footerHeight,o=void 0===n?0:n;if(this.height)return{height:i?i+"px":""};if(this.maxHeight){var s=tn(this.maxHeight);if("number"===typeof s)return{"max-height":s-o-(this.showHeader?r:0)+"px"}}return{}},fixedBodyHeight:function(){if(this.height)return{height:this.layout.fixedBodyHeight?this.layout.fixedBodyHeight+"px":""};if(this.maxHeight){var e=tn(this.maxHeight);if("number"===typeof e)return e=this.layout.scrollX?e-this.layout.gutterWidth:e,this.showHeader&&(e-=this.layout.headerHeight),e-=this.layout.footerHeight,{"max-height":e+"px"}}return{}},fixedHeight:function(){return this.maxHeight?this.showSummary?{bottom:0}:{bottom:this.layout.scrollX&&this.data.length?this.layout.gutterWidth+"px":""}:this.showSummary?{height:this.layout.tableHeight?this.layout.tableHeight+"px":""}:{height:this.layout.viewportHeight?this.layout.viewportHeight+"px":""}},emptyBlockStyle:function(){if(this.data&&this.data.length)return null;var e="100%";return this.layout.appendHeight&&(e="calc(100% - "+this.layout.appendHeight+"px)"),{width:this.bodyWidth,height:e}}},gn({selection:"selection",columns:"columns",tableData:"data",fixedColumns:"fixedColumns",rightFixedColumns:"rightFixedColumns"})),watch:{height:{immediate:!0,handler:function(e){this.layout.setHeight(e)}},maxHeight:{immediate:!0,handler:function(e){this.layout.setMaxHeight(e)}},currentRowKey:{immediate:!0,handler:function(e){this.rowKey&&this.store.setCurrentRowKey(e)}},data:{immediate:!0,handler:function(e){this.store.commit("setData",e)}},expandRowKeys:{immediate:!0,handler:function(e){e&&this.store.setExpandRowKeysAdapter(e)}}},created:function(){var e=this;this.tableId="el-table_"+Gn++,this.debouncedUpdateLayout=Object(Di["debounce"])(50,(function(){return e.doLayout()}))},mounted:function(){var e=this;this.bindEvents(),this.store.updateColumns(),this.doLayout(),this.resizeState={width:this.$el.offsetWidth,height:this.$el.offsetHeight},this.store.states.columns.forEach((function(t){t.filteredValue&&t.filteredValue.length&&e.store.commit("filterChange",{column:t,values:t.filteredValue,silent:!0})})),this.$ready=!0},destroyed:function(){this.unbindEvents()},data:function(){var e=this.treeProps,t=e.hasChildren,r=void 0===t?"hasChildren":t,i=e.children,n=void 0===i?"children":i;this.store=fn(this,{rowKey:this.rowKey,defaultExpandAll:this.defaultExpandAll,selectOnIndeterminate:this.selectOnIndeterminate,indent:this.indent,lazy:this.lazy,lazyColumnIdentifier:r,childrenColumnName:n});var o=new An({store:this.store,table:this,fit:this.fit,showHeader:this.showHeader});return{layout:o,isHidden:!1,renderExpanded:null,resizeProxyVisible:!1,resizeState:{width:null,height:null},isGroup:!1,scrollPosition:"left"}}},Qn=Hn,Wn=a(Qn,Oi,Ni,!1,null,null,null);Wn.options.__file="packages/table/src/table.vue";var qn=Wn.exports;qn.install=function(e){e.component(qn.name,qn)};var zn=qn,Zn={default:{order:""},selection:{width:48,minWidth:48,realWidth:48,order:"",className:"el-table-column--selection"},expand:{width:48,minWidth:48,realWidth:48,order:""},index:{width:48,minWidth:48,realWidth:48,order:""}},Yn={selection:{renderHeader:function(e,t){var r=t.store;return e("el-checkbox",{attrs:{disabled:r.states.data&&0===r.states.data.length,indeterminate:r.states.selection.length>0&&!this.isAllSelected,value:this.isAllSelected},nativeOn:{click:this.toggleAllSelection}})},renderCell:function(e,t){var r=t.row,i=t.column,n=t.store,o=t.$index;return e("el-checkbox",{nativeOn:{click:function(e){return e.stopPropagation()}},attrs:{value:n.isSelected(r),disabled:!!i.selectable&&!i.selectable.call(null,r,o)},on:{input:function(){n.commit("rowSelectedChanged",r)}}})},sortable:!1,resizable:!1},index:{renderHeader:function(e,t){var r=t.column;return r.label||"#"},renderCell:function(e,t){var r=t.$index,i=t.column,n=r+1,o=i.index;return"number"===typeof o?n=r+o:"function"===typeof o&&(n=o(r)),e("div",[n])},sortable:!1},expand:{renderHeader:function(e,t){var r=t.column;return r.label||""},renderCell:function(e,t){var r=t.row,i=t.store,n=["el-table__expand-icon"];i.states.expandRows.indexOf(r)>-1&&n.push("el-table__expand-icon--expanded");var o=function(e){e.stopPropagation(),i.toggleRowExpansion(r)};return e("div",{class:n,on:{click:o}},[e("i",{class:"el-icon el-icon-arrow-right"})])},sortable:!1,resizable:!1,className:"el-table__expand-column"}};function Kn(e,t){var r=t.row,i=t.column,n=t.$index,o=i.property,s=o&&Object(v["getPropByPath"])(r,o).v;return i&&i.formatter?i.formatter(r,i,s,n):s}function $n(e,t){var r=t.row,i=t.treeNode,n=t.store;if(!i)return null;var o=[],s=function(e){e.stopPropagation(),n.loadOrToggle(r)};if(i.indent&&o.push(e("span",{class:"el-table__indent",style:{"padding-left":i.indent+"px"}})),"boolean"!==typeof i.expanded||i.noLazyChildren)o.push(e("span",{class:"el-table__placeholder"}));else{var a=["el-table__expand-icon",i.expanded?"el-table__expand-icon--expanded":""],c=["el-icon-arrow-right"];i.loading&&(c=["el-icon-loading"]),o.push(e("div",{class:a,on:{click:s}},[e("i",{class:c})]))}return o}var Jn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Xn=1,eo={name:"ElTableColumn",props:{type:{type:String,default:"default"},label:String,className:String,labelClassName:String,property:String,prop:String,width:{},minWidth:{},renderHeader:Function,sortable:{type:[Boolean,String],default:!1},sortMethod:Function,sortBy:[String,Function,Array],resizable:{type:Boolean,default:!0},columnKey:String,align:String,headerAlign:String,showTooltipWhenOverflow:Boolean,showOverflowTooltip:Boolean,fixed:[Boolean,String],formatter:Function,selectable:Function,reserveSelection:Boolean,filterMethod:Function,filteredValue:Array,filters:Array,filterPlacement:String,filterMultiple:{type:Boolean,default:!0},index:[Number,Function],sortOrders:{type:Array,default:function(){return["ascending","descending",null]},validator:function(e){return e.every((function(e){return["ascending","descending",null].indexOf(e)>-1}))}}},data:function(){return{isSubColumn:!1,columns:[]}},computed:{owner:function(){var e=this.$parent;while(e&&!e.tableId)e=e.$parent;return e},columnOrTableParent:function(){var e=this.$parent;while(e&&!e.tableId&&!e.columnId)e=e.$parent;return e},realWidth:function(){return Xi(this.width)},realMinWidth:function(){return en(this.minWidth)},realAlign:function(){return this.align?"is-"+this.align:null},realHeaderAlign:function(){return this.headerAlign?"is-"+this.headerAlign:this.realAlign}},methods:{getPropsData:function(){for(var e=this,t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];return r.reduce((function(t,r){return Array.isArray(r)&&r.forEach((function(r){t[r]=e[r]})),t}),{})},getColumnElIndex:function(e,t){return[].indexOf.call(e,t)},setColumnWidth:function(e){return this.realWidth&&(e.width=this.realWidth),this.realMinWidth&&(e.minWidth=this.realMinWidth),e.minWidth||(e.minWidth=80),e.realWidth=void 0===e.width?e.minWidth:e.width,e},setColumnForcedProps:function(e){var t=e.type,r=Yn[t]||{};return Object.keys(r).forEach((function(t){var i=r[t];void 0!==i&&(e[t]="className"===t?e[t]+" "+i:i)})),e},setColumnRenders:function(e){var t=this;this.$createElement;this.renderHeader?console.warn("[Element Warn][TableColumn]Comparing to render-header, scoped-slot header is easier to use. We recommend users to use scoped-slot header."):"selection"!==e.type&&(e.renderHeader=function(r,i){var n=t.$scopedSlots.header;return n?n(i):e.label});var r=e.renderCell;return"expand"===e.type?(e.renderCell=function(e,t){return e("div",{class:"cell"},[r(e,t)])},this.owner.renderExpanded=function(e,r){return t.$scopedSlots.default?t.$scopedSlots.default(r):t.$slots.default}):(r=r||Kn,e.renderCell=function(i,n){var o=null;o=t.$scopedSlots.default?t.$scopedSlots.default(n):r(i,n);var s=$n(i,n),a={class:"cell",style:{}};return e.showOverflowTooltip&&(a.class+=" el-tooltip",a.style={width:(n.column.realWidth||n.column.width)-1+"px"}),i("div",a,[s,o])}),e},registerNormalWatchers:function(){var e=this,t=["label","property","filters","filterMultiple","sortable","index","formatter","className","labelClassName","showOverflowTooltip"],r={prop:"property",realAlign:"align",realHeaderAlign:"headerAlign",realWidth:"width"},i=t.reduce((function(e,t){return e[t]=t,e}),r);Object.keys(i).forEach((function(t){var i=r[t];e.$watch(t,(function(t){e.columnConfig[i]=t}))}))},registerComplexWatchers:function(){var e=this,t=["fixed"],r={realWidth:"width",realMinWidth:"minWidth"},i=t.reduce((function(e,t){return e[t]=t,e}),r);Object.keys(i).forEach((function(t){var i=r[t];e.$watch(t,(function(t){e.columnConfig[i]=t;var r="fixed"===i;e.owner.store.scheduleLayout(r)}))}))}},components:{ElCheckbox:Pi.a},beforeCreate:function(){this.row={},this.column={},this.$index=0,this.columnId=""},created:function(){var e=this.columnOrTableParent;this.isSubColumn=this.owner!==e,this.columnId=(e.tableId||e.columnId)+"_column_"+Xn++;var t=this.type||"default",r=""===this.sortable||this.sortable,i=Jn({},Zn[t],{id:this.columnId,type:t,property:this.prop||this.property,align:this.realAlign,headerAlign:this.realHeaderAlign,showOverflowTooltip:this.showOverflowTooltip||this.showTooltipWhenOverflow,filterable:this.filters||this.filterMethod,filteredValue:[],filterPlacement:"",isColumnGroup:!1,filterOpened:!1,sortable:r,index:this.index}),n=["columnKey","label","className","labelClassName","type","renderHeader","formatter","fixed","resizable"],o=["sortMethod","sortBy","sortOrders"],s=["selectable","reserveSelection"],a=["filterMethod","filters","filterMultiple","filterOpened","filteredValue","filterPlacement"],c=this.getPropsData(n,o,s,a);c=Ji(i,c);var l=rn(this.setColumnRenders,this.setColumnWidth,this.setColumnForcedProps);c=l(c),this.columnConfig=c,this.registerNormalWatchers(),this.registerComplexWatchers()},mounted:function(){var e=this.owner,t=this.columnOrTableParent,r=this.isSubColumn?t.$el.children:t.$refs.hiddenColumns.children,i=this.getColumnElIndex(r,this.$el);e.store.commit("insertColumn",this.columnConfig,i,this.isSubColumn?t.columnConfig:null)},destroyed:function(){if(this.$parent){var e=this.$parent;this.owner.store.commit("removeColumn",this.columnConfig,this.isSubColumn?e.columnConfig:null)}},render:function(e){return e("div",this.$slots.default)},install:function(e){e.component(eo.name,eo)}},to=eo,ro=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.ranged?r("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.handleClose,expression:"handleClose"}],ref:"reference",staticClass:"el-date-editor el-range-editor el-input__inner",class:["el-date-editor--"+e.type,e.pickerSize?"el-range-editor--"+e.pickerSize:"",e.pickerDisabled?"is-disabled":"",e.pickerVisible?"is-active":""],on:{click:e.handleRangeClick,mouseenter:e.handleMouseEnter,mouseleave:function(t){e.showClose=!1},keydown:e.handleKeydown}},[r("i",{class:["el-input__icon","el-range__icon",e.triggerClass]}),r("input",e._b({staticClass:"el-range-input",attrs:{autocomplete:"off",placeholder:e.startPlaceholder,disabled:e.pickerDisabled,readonly:!e.editable||e.readonly,name:e.name&&e.name[0]},domProps:{value:e.displayValue&&e.displayValue[0]},on:{input:e.handleStartInput,change:e.handleStartChange,focus:e.handleFocus}},"input",e.firstInputId,!1)),e._t("range-separator",[r("span",{staticClass:"el-range-separator"},[e._v(e._s(e.rangeSeparator))])]),r("input",e._b({staticClass:"el-range-input",attrs:{autocomplete:"off",placeholder:e.endPlaceholder,disabled:e.pickerDisabled,readonly:!e.editable||e.readonly,name:e.name&&e.name[1]},domProps:{value:e.displayValue&&e.displayValue[1]},on:{input:e.handleEndInput,change:e.handleEndChange,focus:e.handleFocus}},"input",e.secondInputId,!1)),e.haveTrigger?r("i",{staticClass:"el-input__icon el-range__close-icon",class:[e.showClose?""+e.clearIcon:""],on:{click:e.handleClickIcon}}):e._e()],2):r("el-input",e._b({directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.handleClose,expression:"handleClose"}],ref:"reference",staticClass:"el-date-editor",class:"el-date-editor--"+e.type,attrs:{readonly:!e.editable||e.readonly||"dates"===e.type||"week"===e.type,disabled:e.pickerDisabled,size:e.pickerSize,name:e.name,placeholder:e.placeholder,value:e.displayValue,validateEvent:!1},on:{focus:e.handleFocus,input:function(t){return e.userInput=t},change:e.handleChange},nativeOn:{keydown:function(t){return e.handleKeydown(t)},mouseenter:function(t){return e.handleMouseEnter(t)},mouseleave:function(t){e.showClose=!1}}},"el-input",e.firstInputId,!1),[r("i",{staticClass:"el-input__icon",class:e.triggerClass,attrs:{slot:"prefix"},on:{click:e.handleFocus},slot:"prefix"}),e.haveTrigger?r("i",{staticClass:"el-input__icon",class:[e.showClose?""+e.clearIcon:""],attrs:{slot:"suffix"},on:{click:e.handleClickIcon},slot:"suffix"}):e._e()])},io=[];ro._withStripped=!0;var no=r(0),oo={props:{appendToBody:H.a.props.appendToBody,offset:H.a.props.offset,boundariesPadding:H.a.props.boundariesPadding,arrowOffset:H.a.props.arrowOffset},methods:H.a.methods,data:function(){return bt()({visibleArrow:!0},H.a.data)},beforeDestroy:H.a.beforeDestroy},so={date:"yyyy-MM-dd",month:"yyyy-MM",datetime:"yyyy-MM-dd HH:mm:ss",time:"HH:mm:ss",week:"yyyywWW",timerange:"HH:mm:ss",daterange:"yyyy-MM-dd",monthrange:"yyyy-MM",datetimerange:"yyyy-MM-dd HH:mm:ss",year:"yyyy"},ao=["date","datetime","time","time-select","week","month","year","daterange","monthrange","timerange","datetimerange","dates"],co=function(e,t){return"timestamp"===t?e.getTime():Object(no["formatDate"])(e,t)},lo=function(e,t){return"timestamp"===t?new Date(Number(e)):Object(no["parseDate"])(e,t)},uo=function(e,t){if(Array.isArray(e)&&2===e.length){var r=e[0],i=e[1];if(r&&i)return[co(r,t),co(i,t)]}return""},ho=function(e,t,r){if(Array.isArray(e)||(e=e.split(r)),2===e.length){var i=e[0],n=e[1];return[lo(i,t),lo(n,t)]}return[]},po={default:{formatter:function(e){return e?""+e:""},parser:function(e){return void 0===e||""===e?null:e}},week:{formatter:function(e,t){var r=Object(no["getWeekNumber"])(e),i=e.getMonth(),n=new Date(e);1===r&&11===i&&(n.setHours(0,0,0,0),n.setDate(n.getDate()+3-(n.getDay()+6)%7));var o=Object(no["formatDate"])(n,t);return o=/WW/.test(o)?o.replace(/WW/,r<10?"0"+r:r):o.replace(/W/,r),o},parser:function(e,t){return po.date.parser(e,t)}},date:{formatter:co,parser:lo},datetime:{formatter:co,parser:lo},daterange:{formatter:uo,parser:ho},monthrange:{formatter:uo,parser:ho},datetimerange:{formatter:uo,parser:ho},timerange:{formatter:uo,parser:ho},time:{formatter:co,parser:lo},month:{formatter:co,parser:lo},year:{formatter:co,parser:lo},number:{formatter:function(e){return e?""+e:""},parser:function(e){var t=Number(e);return isNaN(e)?null:t}},dates:{formatter:function(e,t){return e.map((function(e){return co(e,t)}))},parser:function(e,t){return("string"===typeof e?e.split(", "):e).map((function(e){return e instanceof Date?e:lo(e,t)}))}}},fo={left:"bottom-start",center:"bottom",right:"bottom-end"},go=function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"-";if(!e)return null;var n=(po[r]||po["default"]).parser,o=t||so[r];return n(e,o,i)},mo=function(e,t,r){if(!e)return null;var i=(po[r]||po["default"]).formatter,n=t||so[r];return i(e,n)},_o=function(e,t){var r=function(e,t){var r=e instanceof Date,i=t instanceof Date;return r&&i?e.getTime()===t.getTime():!r&&!i&&e===t},i=e instanceof Array,n=t instanceof Array;return i&&n?e.length===t.length&&e.every((function(e,i){return r(e,t[i])})):!i&&!n&&r(e,t)},vo=function(e){return"string"===typeof e||e instanceof String},Eo=function(e){return null===e||void 0===e||vo(e)||Array.isArray(e)&&2===e.length&&e.every(vo)},Ao={mixins:[w.a,oo],inject:{elForm:{default:""},elFormItem:{default:""}},props:{size:String,format:String,valueFormat:String,readonly:Boolean,placeholder:String,startPlaceholder:String,endPlaceholder:String,prefixIcon:String,clearIcon:{type:String,default:"el-icon-circle-close"},name:{default:"",validator:Eo},disabled:Boolean,clearable:{type:Boolean,default:!0},id:{default:"",validator:Eo},popperClass:String,editable:{type:Boolean,default:!0},align:{type:String,default:"left"},value:{},defaultValue:{},defaultTime:{},rangeSeparator:{default:"-"},pickerOptions:{},unlinkPanels:Boolean,validateEvent:{type:Boolean,default:!0}},components:{ElInput:g.a},directives:{Clickoutside:F.a},data:function(){return{pickerVisible:!1,showClose:!1,userInput:null,valueOnOpen:null,unwatchPickerOptions:null}},watch:{pickerVisible:function(e){this.readonly||this.pickerDisabled||(e?(this.showPicker(),this.valueOnOpen=Array.isArray(this.value)?[].concat(this.value):this.value):(this.hidePicker(),this.emitChange(this.value),this.userInput=null,this.validateEvent&&this.dispatch("ElFormItem","el.form.blur"),this.$emit("blur",this),this.blur()))},parsedValue:{immediate:!0,handler:function(e){this.picker&&(this.picker.value=e)}},defaultValue:function(e){this.picker&&(this.picker.defaultValue=e)},value:function(e,t){_o(e,t)||this.pickerVisible||!this.validateEvent||this.dispatch("ElFormItem","el.form.change",e)}},computed:{ranged:function(){return this.type.indexOf("range")>-1},reference:function(){var e=this.$refs.reference;return e.$el||e},refInput:function(){return this.reference?[].slice.call(this.reference.querySelectorAll("input")):[]},valueIsEmpty:function(){var e=this.value;if(Array.isArray(e)){for(var t=0,r=e.length;t<r;t++)if(e[t])return!1}else if(e)return!1;return!0},triggerClass:function(){return this.prefixIcon||(-1!==this.type.indexOf("time")?"el-icon-time":"el-icon-date")},selectionMode:function(){return"week"===this.type?"week":"month"===this.type?"month":"year"===this.type?"year":"dates"===this.type?"dates":"day"},haveTrigger:function(){return"undefined"!==typeof this.showTrigger?this.showTrigger:-1!==ao.indexOf(this.type)},displayValue:function(){var e=mo(this.parsedValue,this.format,this.type,this.rangeSeparator);return Array.isArray(this.userInput)?[this.userInput[0]||e&&e[0]||"",this.userInput[1]||e&&e[1]||""]:null!==this.userInput?this.userInput:e?"dates"===this.type?e.join(", "):e:""},parsedValue:function(){if(!this.value)return this.value;if("time-select"===this.type)return this.value;var e=Object(no["isDateObject"])(this.value)||Array.isArray(this.value)&&this.value.every(no["isDateObject"]);return e?this.value:this.valueFormat?go(this.value,this.valueFormat,this.type,this.rangeSeparator)||this.value:Array.isArray(this.value)?this.value.map((function(e){return new Date(e)})):new Date(this.value)},_elFormItemSize:function(){return(this.elFormItem||{}).elFormItemSize},pickerSize:function(){return this.size||this._elFormItemSize||(this.$ELEMENT||{}).size},pickerDisabled:function(){return this.disabled||(this.elForm||{}).disabled},firstInputId:function(){var e={},t=void 0;return t=this.ranged?this.id&&this.id[0]:this.id,t&&(e.id=t),e},secondInputId:function(){var e={},t=void 0;return this.ranged&&(t=this.id&&this.id[1]),t&&(e.id=t),e}},created:function(){this.popperOptions={boundariesPadding:0,gpuAcceleration:!1},this.placement=fo[this.align]||fo.left,this.$on("fieldReset",this.handleFieldReset)},methods:{focus:function(){this.ranged?this.handleFocus():this.$refs.reference.focus()},blur:function(){this.refInput.forEach((function(e){return e.blur()}))},parseValue:function(e){var t=Object(no["isDateObject"])(e)||Array.isArray(e)&&e.every(no["isDateObject"]);return this.valueFormat&&!t&&go(e,this.valueFormat,this.type,this.rangeSeparator)||e},formatToValue:function(e){var t=Object(no["isDateObject"])(e)||Array.isArray(e)&&e.every(no["isDateObject"]);return this.valueFormat&&t?mo(e,this.valueFormat,this.type,this.rangeSeparator):e},parseString:function(e){var t=Array.isArray(e)?this.type:this.type.replace("range","");return go(e,this.format,t)},formatToString:function(e){var t=Array.isArray(e)?this.type:this.type.replace("range","");return mo(e,this.format,t)},handleMouseEnter:function(){this.readonly||this.pickerDisabled||!this.valueIsEmpty&&this.clearable&&(this.showClose=!0)},handleChange:function(){if(this.userInput){var e=this.parseString(this.displayValue);e&&(this.picker.value=e,this.isValidValue(e)&&(this.emitInput(e),this.userInput=null))}""===this.userInput&&(this.emitInput(null),this.emitChange(null),this.userInput=null)},handleStartInput:function(e){this.userInput?this.userInput=[e.target.value,this.userInput[1]]:this.userInput=[e.target.value,null]},handleEndInput:function(e){this.userInput?this.userInput=[this.userInput[0],e.target.value]:this.userInput=[null,e.target.value]},handleStartChange:function(e){var t=this.parseString(this.userInput&&this.userInput[0]);if(t){this.userInput=[this.formatToString(t),this.displayValue[1]];var r=[t,this.picker.value&&this.picker.value[1]];this.picker.value=r,this.isValidValue(r)&&(this.emitInput(r),this.userInput=null)}},handleEndChange:function(e){var t=this.parseString(this.userInput&&this.userInput[1]);if(t){this.userInput=[this.displayValue[0],this.formatToString(t)];var r=[this.picker.value&&this.picker.value[0],t];this.picker.value=r,this.isValidValue(r)&&(this.emitInput(r),this.userInput=null)}},handleClickIcon:function(e){this.readonly||this.pickerDisabled||(this.showClose?(this.valueOnOpen=this.value,e.stopPropagation(),this.emitInput(null),this.emitChange(null),this.showClose=!1,this.picker&&"function"===typeof this.picker.handleClear&&this.picker.handleClear()):this.pickerVisible=!this.pickerVisible)},handleClose:function(){if(this.pickerVisible&&(this.pickerVisible=!1,"dates"===this.type)){var e=go(this.valueOnOpen,this.valueFormat,this.type,this.rangeSeparator)||this.valueOnOpen;this.emitInput(e)}},handleFieldReset:function(e){this.userInput=""===e?null:e},handleFocus:function(){var e=this.type;-1===ao.indexOf(e)||this.pickerVisible||(this.pickerVisible=!0),this.$emit("focus",this)},handleKeydown:function(e){var t=this,r=e.keyCode;return 27===r?(this.pickerVisible=!1,void e.stopPropagation()):9!==r?13===r?((""===this.userInput||this.isValidValue(this.parseString(this.displayValue)))&&(this.handleChange(),this.pickerVisible=this.picker.visible=!1,this.blur()),void e.stopPropagation()):void(this.userInput?e.stopPropagation():this.picker&&this.picker.handleKeydown&&this.picker.handleKeydown(e)):void(this.ranged?setTimeout((function(){-1===t.refInput.indexOf(document.activeElement)&&(t.pickerVisible=!1,t.blur(),e.stopPropagation())}),0):(this.handleChange(),this.pickerVisible=this.picker.visible=!1,this.blur(),e.stopPropagation()))},handleRangeClick:function(){var e=this.type;-1===ao.indexOf(e)||this.pickerVisible||(this.pickerVisible=!0),this.$emit("focus",this)},hidePicker:function(){this.picker&&(this.picker.resetView&&this.picker.resetView(),this.pickerVisible=this.picker.visible=!1,this.destroyPopper())},showPicker:function(){var e=this;this.$isServer||(this.picker||this.mountPicker(),this.pickerVisible=this.picker.visible=!0,this.updatePopper(),this.picker.value=this.parsedValue,this.picker.resetView&&this.picker.resetView(),this.$nextTick((function(){e.picker.adjustSpinners&&e.picker.adjustSpinners()})))},mountPicker:function(){var e=this;this.picker=new ji.a(this.panel).$mount(),this.picker.defaultValue=this.defaultValue,this.picker.defaultTime=this.defaultTime,this.picker.popperClass=this.popperClass,this.popperElm=this.picker.$el,this.picker.width=this.reference.getBoundingClientRect().width,this.picker.showTime="datetime"===this.type||"datetimerange"===this.type,this.picker.selectionMode=this.selectionMode,this.picker.unlinkPanels=this.unlinkPanels,this.picker.arrowControl=this.arrowControl||this.timeArrowControl||!1,this.$watch("format",(function(t){e.picker.format=t}));var t=function(){var t=e.pickerOptions;if(t&&t.selectableRange){var r=t.selectableRange,i=po.datetimerange.parser,n=so.timerange;r=Array.isArray(r)?r:[r],e.picker.selectableRange=r.map((function(t){return i(t,n,e.rangeSeparator)}))}for(var o in t)t.hasOwnProperty(o)&&"selectableRange"!==o&&(e.picker[o]=t[o]);e.format&&(e.picker.format=e.format)};t(),this.unwatchPickerOptions=this.$watch("pickerOptions",(function(){return t()}),{deep:!0}),this.$el.appendChild(this.picker.$el),this.picker.resetView&&this.picker.resetView(),this.picker.$on("dodestroy",this.doDestroy),this.picker.$on("pick",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.userInput=null,e.pickerVisible=e.picker.visible=r,e.emitInput(t),e.picker.resetView&&e.picker.resetView()})),this.picker.$on("select-range",(function(t,r,i){0!==e.refInput.length&&(i&&"min"!==i?"max"===i&&(e.refInput[1].setSelectionRange(t,r),e.refInput[1].focus()):(e.refInput[0].setSelectionRange(t,r),e.refInput[0].focus()))}))},unmountPicker:function(){this.picker&&(this.picker.$destroy(),this.picker.$off(),"function"===typeof this.unwatchPickerOptions&&this.unwatchPickerOptions(),this.picker.$el.parentNode.removeChild(this.picker.$el))},emitChange:function(e){_o(e,this.valueOnOpen)||(this.$emit("change",e),this.valueOnOpen=e,this.validateEvent&&this.dispatch("ElFormItem","el.form.change",e))},emitInput:function(e){var t=this.formatToValue(e);_o(this.value,t)||this.$emit("input",t)},isValidValue:function(e){return this.picker||this.mountPicker(),!this.picker.isValidValue||e&&this.picker.isValidValue(e)}}},yo=Ao,So=a(yo,ro,io,!1,null,null,null);So.options.__file="packages/date-picker/src/picker.vue";var Co=So.exports,To=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition",{attrs:{name:"el-zoom-in-top"},on:{"after-enter":e.handleEnter,"after-leave":e.handleLeave}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"el-picker-panel el-date-picker el-popper",class:[{"has-sidebar":e.$slots.sidebar||e.shortcuts,"has-time":e.showTime},e.popperClass]},[r("div",{staticClass:"el-picker-panel__body-wrapper"},[e._t("sidebar"),e.shortcuts?r("div",{staticClass:"el-picker-panel__sidebar"},e._l(e.shortcuts,(function(t,i){return r("button",{key:i,staticClass:"el-picker-panel__shortcut",attrs:{type:"button"},on:{click:function(r){e.handleShortcutClick(t)}}},[e._v(e._s(t.text))])})),0):e._e(),r("div",{staticClass:"el-picker-panel__body"},[e.showTime?r("div",{staticClass:"el-date-picker__time-header"},[r("span",{staticClass:"el-date-picker__editor-wrap"},[r("el-input",{attrs:{placeholder:e.t("el.datepicker.selectDate"),value:e.visibleDate,size:"small"},on:{input:function(t){return e.userInputDate=t},change:e.handleVisibleDateChange}})],1),r("span",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.handleTimePickClose,expression:"handleTimePickClose"}],staticClass:"el-date-picker__editor-wrap"},[r("el-input",{ref:"input",attrs:{placeholder:e.t("el.datepicker.selectTime"),value:e.visibleTime,size:"small"},on:{focus:function(t){e.timePickerVisible=!0},input:function(t){return e.userInputTime=t},change:e.handleVisibleTimeChange}}),r("time-picker",{ref:"timepicker",attrs:{"time-arrow-control":e.arrowControl,visible:e.timePickerVisible},on:{pick:e.handleTimePick,mounted:e.proxyTimePickerDataProperties}})],1)]):e._e(),r("div",{directives:[{name:"show",rawName:"v-show",value:"time"!==e.currentView,expression:"currentView !== 'time'"}],staticClass:"el-date-picker__header",class:{"el-date-picker__header--bordered":"year"===e.currentView||"month"===e.currentView}},[r("button",{staticClass:"el-picker-panel__icon-btn el-date-picker__prev-btn el-icon-d-arrow-left",attrs:{type:"button","aria-label":e.t("el.datepicker.prevYear")},on:{click:e.prevYear}}),r("button",{directives:[{name:"show",rawName:"v-show",value:"date"===e.currentView,expression:"currentView === 'date'"}],staticClass:"el-picker-panel__icon-btn el-date-picker__prev-btn el-icon-arrow-left",attrs:{type:"button","aria-label":e.t("el.datepicker.prevMonth")},on:{click:e.prevMonth}}),r("span",{staticClass:"el-date-picker__header-label",attrs:{role:"button"},on:{click:e.showYearPicker}},[e._v(e._s(e.yearLabel))]),r("span",{directives:[{name:"show",rawName:"v-show",value:"date"===e.currentView,expression:"currentView === 'date'"}],staticClass:"el-date-picker__header-label",class:{active:"month"===e.currentView},attrs:{role:"button"},on:{click:e.showMonthPicker}},[e._v(e._s(e.t("el.datepicker.month"+(e.month+1))))]),r("button",{staticClass:"el-picker-panel__icon-btn el-date-picker__next-btn el-icon-d-arrow-right",attrs:{type:"button","aria-label":e.t("el.datepicker.nextYear")},on:{click:e.nextYear}}),r("button",{directives:[{name:"show",rawName:"v-show",value:"date"===e.currentView,expression:"currentView === 'date'"}],staticClass:"el-picker-panel__icon-btn el-date-picker__next-btn el-icon-arrow-right",attrs:{type:"button","aria-label":e.t("el.datepicker.nextMonth")},on:{click:e.nextMonth}})]),r("div",{staticClass:"el-picker-panel__content"},[r("date-table",{directives:[{name:"show",rawName:"v-show",value:"date"===e.currentView,expression:"currentView === 'date'"}],attrs:{"selection-mode":e.selectionMode,"first-day-of-week":e.firstDayOfWeek,value:e.value,"default-value":e.defaultValue?new Date(e.defaultValue):null,date:e.date,"cell-class-name":e.cellClassName,"disabled-date":e.disabledDate},on:{pick:e.handleDatePick}}),r("year-table",{directives:[{name:"show",rawName:"v-show",value:"year"===e.currentView,expression:"currentView === 'year'"}],attrs:{value:e.value,"default-value":e.defaultValue?new Date(e.defaultValue):null,date:e.date,"disabled-date":e.disabledDate},on:{pick:e.handleYearPick}}),r("month-table",{directives:[{name:"show",rawName:"v-show",value:"month"===e.currentView,expression:"currentView === 'month'"}],attrs:{value:e.value,"default-value":e.defaultValue?new Date(e.defaultValue):null,date:e.date,"disabled-date":e.disabledDate},on:{pick:e.handleMonthPick}})],1)])],2),r("div",{directives:[{name:"show",rawName:"v-show",value:e.footerVisible&&"date"===e.currentView,expression:"footerVisible && currentView === 'date'"}],staticClass:"el-picker-panel__footer"},[r("el-button",{directives:[{name:"show",rawName:"v-show",value:"dates"!==e.selectionMode,expression:"selectionMode !== 'dates'"}],staticClass:"el-picker-panel__link-btn",attrs:{size:"mini",type:"text"},on:{click:e.changeToNow}},[e._v("\n        "+e._s(e.t("el.datepicker.now"))+"\n      ")]),r("el-button",{staticClass:"el-picker-panel__link-btn",attrs:{plain:"",size:"mini"},on:{click:e.confirm}},[e._v("\n        "+e._s(e.t("el.datepicker.confirm"))+"\n      ")])],1)])])},bo=[];To._withStripped=!0;var Io=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition",{attrs:{name:"el-zoom-in-top"},on:{"after-leave":function(t){e.$emit("dodestroy")}}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"el-time-panel el-popper",class:e.popperClass},[r("div",{staticClass:"el-time-panel__content",class:{"has-seconds":e.showSeconds}},[r("time-spinner",{ref:"spinner",attrs:{"arrow-control":e.useArrow,"show-seconds":e.showSeconds,"am-pm-mode":e.amPmMode,date:e.date},on:{change:e.handleChange,"select-range":e.setSelectionRange}})],1),r("div",{staticClass:"el-time-panel__footer"},[r("button",{staticClass:"el-time-panel__btn cancel",attrs:{type:"button"},on:{click:e.handleCancel}},[e._v(e._s(e.t("el.datepicker.cancel")))]),r("button",{staticClass:"el-time-panel__btn",class:{confirm:!e.disabled},attrs:{type:"button"},on:{click:function(t){e.handleConfirm()}}},[e._v(e._s(e.t("el.datepicker.confirm")))])])])])},Ro=[];Io._withStripped=!0;var wo=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-time-spinner",class:{"has-seconds":e.showSeconds}},[e.arrowControl?e._e():[r("el-scrollbar",{ref:"hours",staticClass:"el-time-spinner__wrapper",attrs:{"wrap-style":"max-height: inherit;","view-class":"el-time-spinner__list",noresize:"",tag:"ul"},nativeOn:{mouseenter:function(t){e.emitSelectRange("hours")},mousemove:function(t){e.adjustCurrentSpinner("hours")}}},e._l(e.hoursList,(function(t,i){return r("li",{key:i,staticClass:"el-time-spinner__item",class:{active:i===e.hours,disabled:t},on:{click:function(r){e.handleClick("hours",{value:i,disabled:t})}}},[e._v(e._s(("0"+(e.amPmMode?i%12||12:i)).slice(-2))+e._s(e.amPm(i)))])})),0),r("el-scrollbar",{ref:"minutes",staticClass:"el-time-spinner__wrapper",attrs:{"wrap-style":"max-height: inherit;","view-class":"el-time-spinner__list",noresize:"",tag:"ul"},nativeOn:{mouseenter:function(t){e.emitSelectRange("minutes")},mousemove:function(t){e.adjustCurrentSpinner("minutes")}}},e._l(e.minutesList,(function(t,i){return r("li",{key:i,staticClass:"el-time-spinner__item",class:{active:i===e.minutes,disabled:!t},on:{click:function(t){e.handleClick("minutes",{value:i,disabled:!1})}}},[e._v(e._s(("0"+i).slice(-2)))])})),0),r("el-scrollbar",{directives:[{name:"show",rawName:"v-show",value:e.showSeconds,expression:"showSeconds"}],ref:"seconds",staticClass:"el-time-spinner__wrapper",attrs:{"wrap-style":"max-height: inherit;","view-class":"el-time-spinner__list",noresize:"",tag:"ul"},nativeOn:{mouseenter:function(t){e.emitSelectRange("seconds")},mousemove:function(t){e.adjustCurrentSpinner("seconds")}}},e._l(60,(function(t,i){return r("li",{key:i,staticClass:"el-time-spinner__item",class:{active:i===e.seconds},on:{click:function(t){e.handleClick("seconds",{value:i,disabled:!1})}}},[e._v(e._s(("0"+i).slice(-2)))])})),0)],e.arrowControl?[r("div",{staticClass:"el-time-spinner__wrapper is-arrow",on:{mouseenter:function(t){e.emitSelectRange("hours")}}},[r("i",{directives:[{name:"repeat-click",rawName:"v-repeat-click",value:e.decrease,expression:"decrease"}],staticClass:"el-time-spinner__arrow el-icon-arrow-up"}),r("i",{directives:[{name:"repeat-click",rawName:"v-repeat-click",value:e.increase,expression:"increase"}],staticClass:"el-time-spinner__arrow el-icon-arrow-down"}),r("ul",{ref:"hours",staticClass:"el-time-spinner__list"},e._l(e.arrowHourList,(function(t,i){return r("li",{key:i,staticClass:"el-time-spinner__item",class:{active:t===e.hours,disabled:e.hoursList[t]}},[e._v(e._s(void 0===t?"":("0"+(e.amPmMode?t%12||12:t)).slice(-2)+e.amPm(t)))])})),0)]),r("div",{staticClass:"el-time-spinner__wrapper is-arrow",on:{mouseenter:function(t){e.emitSelectRange("minutes")}}},[r("i",{directives:[{name:"repeat-click",rawName:"v-repeat-click",value:e.decrease,expression:"decrease"}],staticClass:"el-time-spinner__arrow el-icon-arrow-up"}),r("i",{directives:[{name:"repeat-click",rawName:"v-repeat-click",value:e.increase,expression:"increase"}],staticClass:"el-time-spinner__arrow el-icon-arrow-down"}),r("ul",{ref:"minutes",staticClass:"el-time-spinner__list"},e._l(e.arrowMinuteList,(function(t,i){return r("li",{key:i,staticClass:"el-time-spinner__item",class:{active:t===e.minutes}},[e._v("\n          "+e._s(void 0===t?"":("0"+t).slice(-2))+"\n        ")])})),0)]),e.showSeconds?r("div",{staticClass:"el-time-spinner__wrapper is-arrow",on:{mouseenter:function(t){e.emitSelectRange("seconds")}}},[r("i",{directives:[{name:"repeat-click",rawName:"v-repeat-click",value:e.decrease,expression:"decrease"}],staticClass:"el-time-spinner__arrow el-icon-arrow-up"}),r("i",{directives:[{name:"repeat-click",rawName:"v-repeat-click",value:e.increase,expression:"increase"}],staticClass:"el-time-spinner__arrow el-icon-arrow-down"}),r("ul",{ref:"seconds",staticClass:"el-time-spinner__list"},e._l(e.arrowSecondList,(function(t,i){return r("li",{key:i,staticClass:"el-time-spinner__item",class:{active:t===e.seconds}},[e._v("\n          "+e._s(void 0===t?"":("0"+t).slice(-2))+"\n        ")])})),0)]):e._e()]:e._e()],2)},ko=[];wo._withStripped=!0;var Oo={components:{ElScrollbar:W.a},directives:{repeatClick:Dt},props:{date:{},defaultValue:{},showSeconds:{type:Boolean,default:!0},arrowControl:Boolean,amPmMode:{type:String,default:""}},computed:{hours:function(){return this.date.getHours()},minutes:function(){return this.date.getMinutes()},seconds:function(){return this.date.getSeconds()},hoursList:function(){return Object(no["getRangeHours"])(this.selectableRange)},minutesList:function(){return Object(no["getRangeMinutes"])(this.selectableRange,this.hours)},arrowHourList:function(){var e=this.hours;return[e>0?e-1:void 0,e,e<23?e+1:void 0]},arrowMinuteList:function(){var e=this.minutes;return[e>0?e-1:void 0,e,e<59?e+1:void 0]},arrowSecondList:function(){var e=this.seconds;return[e>0?e-1:void 0,e,e<59?e+1:void 0]}},data:function(){return{selectableRange:[],currentScrollbar:null}},mounted:function(){var e=this;this.$nextTick((function(){!e.arrowControl&&e.bindScrollEvent()}))},methods:{increase:function(){this.scrollDown(1)},decrease:function(){this.scrollDown(-1)},modifyDateField:function(e,t){switch(e){case"hours":this.$emit("change",Object(no["modifyTime"])(this.date,t,this.minutes,this.seconds));break;case"minutes":this.$emit("change",Object(no["modifyTime"])(this.date,this.hours,t,this.seconds));break;case"seconds":this.$emit("change",Object(no["modifyTime"])(this.date,this.hours,this.minutes,t));break}},handleClick:function(e,t){var r=t.value,i=t.disabled;i||(this.modifyDateField(e,r),this.emitSelectRange(e),this.adjustSpinner(e,r))},emitSelectRange:function(e){"hours"===e?this.$emit("select-range",0,2):"minutes"===e?this.$emit("select-range",3,5):"seconds"===e&&this.$emit("select-range",6,8),this.currentScrollbar=e},bindScrollEvent:function(){var e=this,t=function(t){e.$refs[t].wrap.onscroll=function(r){e.handleScroll(t,r)}};t("hours"),t("minutes"),t("seconds")},handleScroll:function(e){var t=Math.min(Math.round((this.$refs[e].wrap.scrollTop-(.5*this.scrollBarHeight(e)-10)/this.typeItemHeight(e)+3)/this.typeItemHeight(e)),"hours"===e?23:59);this.modifyDateField(e,t)},adjustSpinners:function(){this.adjustSpinner("hours",this.hours),this.adjustSpinner("minutes",this.minutes),this.adjustSpinner("seconds",this.seconds)},adjustCurrentSpinner:function(e){this.adjustSpinner(e,this[e])},adjustSpinner:function(e,t){if(!this.arrowControl){var r=this.$refs[e].wrap;r&&(r.scrollTop=Math.max(0,t*this.typeItemHeight(e)))}},scrollDown:function(e){var t=this;this.currentScrollbar||this.emitSelectRange("hours");var r=this.currentScrollbar,i=this.hoursList,n=this[r];if("hours"===this.currentScrollbar){var o=Math.abs(e);e=e>0?1:-1;var s=i.length;while(s--&&o)n=(n+e+i.length)%i.length,i[n]||o--;if(i[n])return}else n=(n+e+60)%60;this.modifyDateField(r,n),this.adjustSpinner(r,n),this.$nextTick((function(){return t.emitSelectRange(t.currentScrollbar)}))},amPm:function(e){var t="a"===this.amPmMode.toLowerCase();if(!t)return"";var r="A"===this.amPmMode,i=e<12?" am":" pm";return r&&(i=i.toUpperCase()),i},typeItemHeight:function(e){return this.$refs[e].$el.querySelector("li").offsetHeight},scrollBarHeight:function(e){return this.$refs[e].$el.offsetHeight}}},No=Oo,Lo=a(No,wo,ko,!1,null,null,null);Lo.options.__file="packages/date-picker/src/basic/time-spinner.vue";var Po=Lo.exports,Do={mixins:[_.a],components:{TimeSpinner:Po},props:{visible:Boolean,timeArrowControl:Boolean},watch:{visible:function(e){var t=this;e?(this.oldValue=this.value,this.$nextTick((function(){return t.$refs.spinner.emitSelectRange("hours")}))):this.needInitAdjust=!0},value:function(e){var t=this,r=void 0;e instanceof Date?r=Object(no["limitTimeRange"])(e,this.selectableRange,this.format):e||(r=this.defaultValue?new Date(this.defaultValue):new Date),this.date=r,this.visible&&this.needInitAdjust&&(this.$nextTick((function(e){return t.adjustSpinners()})),this.needInitAdjust=!1)},selectableRange:function(e){this.$refs.spinner.selectableRange=e},defaultValue:function(e){Object(no["isDate"])(this.value)||(this.date=e?new Date(e):new Date)}},data:function(){return{popperClass:"",format:"HH:mm:ss",value:"",defaultValue:null,date:new Date,oldValue:new Date,selectableRange:[],selectionRange:[0,2],disabled:!1,arrowControl:!1,needInitAdjust:!0}},computed:{showSeconds:function(){return-1!==(this.format||"").indexOf("ss")},useArrow:function(){return this.arrowControl||this.timeArrowControl||!1},amPmMode:function(){return-1!==(this.format||"").indexOf("A")?"A":-1!==(this.format||"").indexOf("a")?"a":""}},methods:{handleCancel:function(){this.$emit("pick",this.oldValue,!1)},handleChange:function(e){this.visible&&(this.date=Object(no["clearMilliseconds"])(e),this.isValidValue(this.date)&&this.$emit("pick",this.date,!0))},setSelectionRange:function(e,t){this.$emit("select-range",e,t),this.selectionRange=[e,t]},handleConfirm:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments[1];if(!t){var r=Object(no["clearMilliseconds"])(Object(no["limitTimeRange"])(this.date,this.selectableRange,this.format));this.$emit("pick",r,e,t)}},handleKeydown:function(e){var t=e.keyCode,r={38:-1,40:1,37:-1,39:1};if(37===t||39===t){var i=r[t];return this.changeSelectionRange(i),void e.preventDefault()}if(38===t||40===t){var n=r[t];return this.$refs.spinner.scrollDown(n),void e.preventDefault()}},isValidValue:function(e){return Object(no["timeWithinRange"])(e,this.selectableRange,this.format)},adjustSpinners:function(){return this.$refs.spinner.adjustSpinners()},changeSelectionRange:function(e){var t=[0,3].concat(this.showSeconds?[6]:[]),r=["hours","minutes"].concat(this.showSeconds?["seconds"]:[]),i=t.indexOf(this.selectionRange[0]),n=(i+e+t.length)%t.length;this.$refs.spinner.emitSelectRange(r[n])}},mounted:function(){var e=this;this.$nextTick((function(){return e.handleConfirm(!0,!0)})),this.$emit("mounted")}},Mo=Do,xo=a(Mo,Io,Ro,!1,null,null,null);xo.options.__file="packages/date-picker/src/panel/time.vue";var Bo=xo.exports,Uo=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("table",{staticClass:"el-year-table",on:{click:e.handleYearTableClick}},[r("tbody",[r("tr",[r("td",{staticClass:"available",class:e.getCellStyle(e.startYear+0)},[r("a",{staticClass:"cell"},[e._v(e._s(e.startYear))])]),r("td",{staticClass:"available",class:e.getCellStyle(e.startYear+1)},[r("a",{staticClass:"cell"},[e._v(e._s(e.startYear+1))])]),r("td",{staticClass:"available",class:e.getCellStyle(e.startYear+2)},[r("a",{staticClass:"cell"},[e._v(e._s(e.startYear+2))])]),r("td",{staticClass:"available",class:e.getCellStyle(e.startYear+3)},[r("a",{staticClass:"cell"},[e._v(e._s(e.startYear+3))])])]),r("tr",[r("td",{staticClass:"available",class:e.getCellStyle(e.startYear+4)},[r("a",{staticClass:"cell"},[e._v(e._s(e.startYear+4))])]),r("td",{staticClass:"available",class:e.getCellStyle(e.startYear+5)},[r("a",{staticClass:"cell"},[e._v(e._s(e.startYear+5))])]),r("td",{staticClass:"available",class:e.getCellStyle(e.startYear+6)},[r("a",{staticClass:"cell"},[e._v(e._s(e.startYear+6))])]),r("td",{staticClass:"available",class:e.getCellStyle(e.startYear+7)},[r("a",{staticClass:"cell"},[e._v(e._s(e.startYear+7))])])]),r("tr",[r("td",{staticClass:"available",class:e.getCellStyle(e.startYear+8)},[r("a",{staticClass:"cell"},[e._v(e._s(e.startYear+8))])]),r("td",{staticClass:"available",class:e.getCellStyle(e.startYear+9)},[r("a",{staticClass:"cell"},[e._v(e._s(e.startYear+9))])]),r("td"),r("td")])])])},Fo=[];Uo._withStripped=!0;var Vo=function(e){var t=Object(no["getDayCountOfYear"])(e),r=new Date(e,0,1);return Object(no["range"])(t).map((function(e){return Object(no["nextDate"])(r,e)}))},jo={props:{disabledDate:{},value:{},defaultValue:{validator:function(e){return null===e||e instanceof Date&&Object(no["isDate"])(e)}},date:{}},computed:{startYear:function(){return 10*Math.floor(this.date.getFullYear()/10)}},methods:{getCellStyle:function(e){var t={},r=new Date;return t.disabled="function"===typeof this.disabledDate&&Vo(e).every(this.disabledDate),t.current=Object(v["arrayFindIndex"])(Object(v["coerceTruthyValueToArray"])(this.value),(function(t){return t.getFullYear()===e}))>=0,t.today=r.getFullYear()===e,t.default=this.defaultValue&&this.defaultValue.getFullYear()===e,t},handleYearTableClick:function(e){var t=e.target;if("A"===t.tagName){if(Object(Ue["hasClass"])(t.parentNode,"disabled"))return;var r=t.textContent||t.innerText;this.$emit("pick",Number(r))}}}},Go=jo,Ho=a(Go,Uo,Fo,!1,null,null,null);Ho.options.__file="packages/date-picker/src/basic/year-table.vue";var Qo=Ho.exports,Wo=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("table",{staticClass:"el-month-table",on:{click:e.handleMonthTableClick,mousemove:e.handleMouseMove}},[r("tbody",e._l(e.rows,(function(t,i){return r("tr",{key:i},e._l(t,(function(t,i){return r("td",{key:i,class:e.getCellStyle(t)},[r("div",[r("a",{staticClass:"cell"},[e._v(e._s(e.t("el.datepicker.months."+e.months[t.text])))])])])})),0)})),0)])},qo=[];Wo._withStripped=!0;var zo=function(e,t){var r=Object(no["getDayCountOfMonth"])(e,t),i=new Date(e,t,1);return Object(no["range"])(r).map((function(e){return Object(no["nextDate"])(i,e)}))},Zo=function(e){return new Date(e.getFullYear(),e.getMonth())},Yo=function(e){return"number"===typeof e||"string"===typeof e?Zo(new Date(e)).getTime():e instanceof Date?Zo(e).getTime():NaN},Ko={props:{disabledDate:{},value:{},selectionMode:{default:"month"},minDate:{},maxDate:{},defaultValue:{validator:function(e){return null===e||Object(no["isDate"])(e)||Array.isArray(e)&&e.every(no["isDate"])}},date:{},rangeState:{default:function(){return{endDate:null,selecting:!1}}}},mixins:[_.a],watch:{"rangeState.endDate":function(e){this.markRange(this.minDate,e)},minDate:function(e,t){Yo(e)!==Yo(t)&&this.markRange(this.minDate,this.maxDate)},maxDate:function(e,t){Yo(e)!==Yo(t)&&this.markRange(this.minDate,this.maxDate)}},data:function(){return{months:["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],tableRows:[[],[],[]],lastRow:null,lastColumn:null}},methods:{cellMatchesDate:function(e,t){var r=new Date(t);return this.date.getFullYear()===r.getFullYear()&&Number(e.text)===r.getMonth()},getCellStyle:function(e){var t=this,r={},i=this.date.getFullYear(),n=new Date,o=e.text,s=this.defaultValue?Array.isArray(this.defaultValue)?this.defaultValue:[this.defaultValue]:[];return r.disabled="function"===typeof this.disabledDate&&zo(i,o).every(this.disabledDate),r.current=Object(v["arrayFindIndex"])(Object(v["coerceTruthyValueToArray"])(this.value),(function(e){return e.getFullYear()===i&&e.getMonth()===o}))>=0,r.today=n.getFullYear()===i&&n.getMonth()===o,r.default=s.some((function(r){return t.cellMatchesDate(e,r)})),e.inRange&&(r["in-range"]=!0,e.start&&(r["start-date"]=!0),e.end&&(r["end-date"]=!0)),r},getMonthOfCell:function(e){var t=this.date.getFullYear();return new Date(t,e,1)},markRange:function(e,t){e=Yo(e),t=Yo(t)||e;var r=[Math.min(e,t),Math.max(e,t)];e=r[0],t=r[1];for(var i=this.rows,n=0,o=i.length;n<o;n++)for(var s=i[n],a=0,c=s.length;a<c;a++){var l=s[a],u=4*n+a,d=new Date(this.date.getFullYear(),u).getTime();l.inRange=e&&d>=e&&d<=t,l.start=e&&d===e,l.end=t&&d===t}},handleMouseMove:function(e){if(this.rangeState.selecting){var t=e.target;if("A"===t.tagName&&(t=t.parentNode.parentNode),"DIV"===t.tagName&&(t=t.parentNode),"TD"===t.tagName){var r=t.parentNode.rowIndex,i=t.cellIndex;this.rows[r][i].disabled||r===this.lastRow&&i===this.lastColumn||(this.lastRow=r,this.lastColumn=i,this.$emit("changerange",{minDate:this.minDate,maxDate:this.maxDate,rangeState:{selecting:!0,endDate:this.getMonthOfCell(4*r+i)}}))}}},handleMonthTableClick:function(e){var t=e.target;if("A"===t.tagName&&(t=t.parentNode.parentNode),"DIV"===t.tagName&&(t=t.parentNode),"TD"===t.tagName&&!Object(Ue["hasClass"])(t,"disabled")){var r=t.cellIndex,i=t.parentNode.rowIndex,n=4*i+r,o=this.getMonthOfCell(n);"range"===this.selectionMode?this.rangeState.selecting?(o>=this.minDate?this.$emit("pick",{minDate:this.minDate,maxDate:o}):this.$emit("pick",{minDate:o,maxDate:this.minDate}),this.rangeState.selecting=!1):(this.$emit("pick",{minDate:o,maxDate:null}),this.rangeState.selecting=!0):this.$emit("pick",n)}}},computed:{rows:function(){for(var e=this,t=this.tableRows,r=this.disabledDate,i=[],n=Yo(new Date),o=0;o<3;o++)for(var s=t[o],a=function(t){var a=s[t];a||(a={row:o,column:t,type:"normal",inRange:!1,start:!1,end:!1}),a.type="normal";var c=4*o+t,l=new Date(e.date.getFullYear(),c).getTime();a.inRange=l>=Yo(e.minDate)&&l<=Yo(e.maxDate),a.start=e.minDate&&l===Yo(e.minDate),a.end=e.maxDate&&l===Yo(e.maxDate);var u=l===n;u&&(a.type="today"),a.text=c;var d=new Date(l);a.disabled="function"===typeof r&&r(d),a.selected=Object(v["arrayFind"])(i,(function(e){return e.getTime()===d.getTime()})),e.$set(s,t,a)},c=0;c<4;c++)a(c);return t}}},$o=Ko,Jo=a($o,Wo,qo,!1,null,null,null);Jo.options.__file="packages/date-picker/src/basic/month-table.vue";var Xo=Jo.exports,es=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("table",{staticClass:"el-date-table",class:{"is-week-mode":"week"===e.selectionMode},attrs:{cellspacing:"0",cellpadding:"0"},on:{click:e.handleClick,mousemove:e.handleMouseMove}},[r("tbody",[r("tr",[e.showWeekNumber?r("th",[e._v(e._s(e.t("el.datepicker.week")))]):e._e(),e._l(e.WEEKS,(function(t,i){return r("th",{key:i},[e._v(e._s(e.t("el.datepicker.weeks."+t)))])}))],2),e._l(e.rows,(function(t,i){return r("tr",{key:i,staticClass:"el-date-table__row",class:{current:e.isWeekActive(t[1])}},e._l(t,(function(t,i){return r("td",{key:i,class:e.getCellClasses(t)},[r("div",[r("span",[e._v("\n          "+e._s(t.text)+"\n        ")])])])})),0)}))],2)])},ts=[];es._withStripped=!0;var rs=["sun","mon","tue","wed","thu","fri","sat"],is=function(e){return"number"===typeof e||"string"===typeof e?Object(no["clearTime"])(new Date(e)).getTime():e instanceof Date?Object(no["clearTime"])(e).getTime():NaN},ns=function(e,t){var r="function"===typeof t?Object(v["arrayFindIndex"])(e,t):e.indexOf(t);return r>=0?[].concat(e.slice(0,r),e.slice(r+1)):e},os={mixins:[_.a],props:{firstDayOfWeek:{default:7,type:Number,validator:function(e){return e>=1&&e<=7}},value:{},defaultValue:{validator:function(e){return null===e||Object(no["isDate"])(e)||Array.isArray(e)&&e.every(no["isDate"])}},date:{},selectionMode:{default:"day"},showWeekNumber:{type:Boolean,default:!1},disabledDate:{},cellClassName:{},minDate:{},maxDate:{},rangeState:{default:function(){return{endDate:null,selecting:!1}}}},computed:{offsetDay:function(){var e=this.firstDayOfWeek;return e>3?7-e:-e},WEEKS:function(){var e=this.firstDayOfWeek;return rs.concat(rs).slice(e,e+7)},year:function(){return this.date.getFullYear()},month:function(){return this.date.getMonth()},startDate:function(){return Object(no["getStartDateOfMonth"])(this.year,this.month)},rows:function(){var e=this,t=new Date(this.year,this.month,1),r=Object(no["getFirstDayOfMonth"])(t),i=Object(no["getDayCountOfMonth"])(t.getFullYear(),t.getMonth()),n=Object(no["getDayCountOfMonth"])(t.getFullYear(),0===t.getMonth()?11:t.getMonth()-1);r=0===r?7:r;for(var o=this.offsetDay,s=this.tableRows,a=1,c=this.startDate,l=this.disabledDate,u=this.cellClassName,d="dates"===this.selectionMode?Object(v["coerceTruthyValueToArray"])(this.value):[],h=is(new Date),p=0;p<6;p++){var f=s[p];this.showWeekNumber&&(f[0]||(f[0]={type:"week",text:Object(no["getWeekNumber"])(Object(no["nextDate"])(c,7*p+1))}));for(var g=function(t){var s=f[e.showWeekNumber?t+1:t];s||(s={row:p,column:t,type:"normal",inRange:!1,start:!1,end:!1}),s.type="normal";var g=7*p+t,m=Object(no["nextDate"])(c,g-o).getTime();s.inRange=m>=is(e.minDate)&&m<=is(e.maxDate),s.start=e.minDate&&m===is(e.minDate),s.end=e.maxDate&&m===is(e.maxDate);var _=m===h;if(_&&(s.type="today"),p>=0&&p<=1){var E=r+o<0?7+r+o:r+o;t+7*p>=E?s.text=a++:(s.text=n-(E-t%7)+1+7*p,s.type="prev-month")}else a<=i?s.text=a++:(s.text=a++-i,s.type="next-month");var A=new Date(m);s.disabled="function"===typeof l&&l(A),s.selected=Object(v["arrayFind"])(d,(function(e){return e.getTime()===A.getTime()})),s.customClass="function"===typeof u&&u(A),e.$set(f,e.showWeekNumber?t+1:t,s)},m=0;m<7;m++)g(m);if("week"===this.selectionMode){var _=this.showWeekNumber?1:0,E=this.showWeekNumber?7:6,A=this.isWeekActive(f[_+1]);f[_].inRange=A,f[_].start=A,f[E].inRange=A,f[E].end=A}}return s}},watch:{"rangeState.endDate":function(e){this.markRange(this.minDate,e)},minDate:function(e,t){is(e)!==is(t)&&this.markRange(this.minDate,this.maxDate)},maxDate:function(e,t){is(e)!==is(t)&&this.markRange(this.minDate,this.maxDate)}},data:function(){return{tableRows:[[],[],[],[],[],[]],lastRow:null,lastColumn:null}},methods:{cellMatchesDate:function(e,t){var r=new Date(t);return this.year===r.getFullYear()&&this.month===r.getMonth()&&Number(e.text)===r.getDate()},getCellClasses:function(e){var t=this,r=this.selectionMode,i=this.defaultValue?Array.isArray(this.defaultValue)?this.defaultValue:[this.defaultValue]:[],n=[];return"normal"!==e.type&&"today"!==e.type||e.disabled?n.push(e.type):(n.push("available"),"today"===e.type&&n.push("today")),"normal"===e.type&&i.some((function(r){return t.cellMatchesDate(e,r)}))&&n.push("default"),"day"!==r||"normal"!==e.type&&"today"!==e.type||!this.cellMatchesDate(e,this.value)||n.push("current"),!e.inRange||"normal"!==e.type&&"today"!==e.type&&"week"!==this.selectionMode||(n.push("in-range"),e.start&&n.push("start-date"),e.end&&n.push("end-date")),e.disabled&&n.push("disabled"),e.selected&&n.push("selected"),e.customClass&&n.push(e.customClass),n.join(" ")},getDateOfCell:function(e,t){var r=7*e+(t-(this.showWeekNumber?1:0))-this.offsetDay;return Object(no["nextDate"])(this.startDate,r)},isWeekActive:function(e){if("week"!==this.selectionMode)return!1;var t=new Date(this.year,this.month,1),r=t.getFullYear(),i=t.getMonth();if("prev-month"===e.type&&(t.setMonth(0===i?11:i-1),t.setFullYear(0===i?r-1:r)),"next-month"===e.type&&(t.setMonth(11===i?0:i+1),t.setFullYear(11===i?r+1:r)),t.setDate(parseInt(e.text,10)),Object(no["isDate"])(this.value)){var n=(this.value.getDay()-this.firstDayOfWeek+7)%7-1,o=Object(no["prevDate"])(this.value,n);return o.getTime()===t.getTime()}return!1},markRange:function(e,t){e=is(e),t=is(t)||e;var r=[Math.min(e,t),Math.max(e,t)];e=r[0],t=r[1];for(var i=this.startDate,n=this.rows,o=0,s=n.length;o<s;o++)for(var a=n[o],c=0,l=a.length;c<l;c++)if(!this.showWeekNumber||0!==c){var u=a[c],d=7*o+c+(this.showWeekNumber?-1:0),h=Object(no["nextDate"])(i,d-this.offsetDay).getTime();u.inRange=e&&h>=e&&h<=t,u.start=e&&h===e,u.end=t&&h===t}},handleMouseMove:function(e){if(this.rangeState.selecting){var t=e.target;if("SPAN"===t.tagName&&(t=t.parentNode.parentNode),"DIV"===t.tagName&&(t=t.parentNode),"TD"===t.tagName){var r=t.parentNode.rowIndex-1,i=t.cellIndex;this.rows[r][i].disabled||r===this.lastRow&&i===this.lastColumn||(this.lastRow=r,this.lastColumn=i,this.$emit("changerange",{minDate:this.minDate,maxDate:this.maxDate,rangeState:{selecting:!0,endDate:this.getDateOfCell(r,i)}}))}}},handleClick:function(e){var t=e.target;if("SPAN"===t.tagName&&(t=t.parentNode.parentNode),"DIV"===t.tagName&&(t=t.parentNode),"TD"===t.tagName){var r=t.parentNode.rowIndex-1,i="week"===this.selectionMode?1:t.cellIndex,n=this.rows[r][i];if(!n.disabled&&"week"!==n.type){var o=this.getDateOfCell(r,i);if("range"===this.selectionMode)this.rangeState.selecting?(o>=this.minDate?this.$emit("pick",{minDate:this.minDate,maxDate:o}):this.$emit("pick",{minDate:o,maxDate:this.minDate}),this.rangeState.selecting=!1):(this.$emit("pick",{minDate:o,maxDate:null}),this.rangeState.selecting=!0);else if("day"===this.selectionMode)this.$emit("pick",o);else if("week"===this.selectionMode){var s=Object(no["getWeekNumber"])(o),a=o.getFullYear()+"w"+s;this.$emit("pick",{year:o.getFullYear(),week:s,value:a,date:o})}else if("dates"===this.selectionMode){var c=this.value||[],l=n.selected?ns(c,(function(e){return e.getTime()===o.getTime()})):[].concat(c,[o]);this.$emit("pick",l)}}}}}},ss=os,as=a(ss,es,ts,!1,null,null,null);as.options.__file="packages/date-picker/src/basic/date-table.vue";var cs=as.exports,ls={mixins:[_.a],directives:{Clickoutside:F.a},watch:{showTime:function(e){var t=this;e&&this.$nextTick((function(e){var r=t.$refs.input.$el;r&&(t.pickerWidth=r.getBoundingClientRect().width+10)}))},value:function(e){"dates"===this.selectionMode&&this.value||(Object(no["isDate"])(e)?this.date=new Date(e):this.date=this.getDefaultValue())},defaultValue:function(e){Object(no["isDate"])(this.value)||(this.date=e?new Date(e):new Date)},timePickerVisible:function(e){var t=this;e&&this.$nextTick((function(){return t.$refs.timepicker.adjustSpinners()}))},selectionMode:function(e){"month"===e?"year"===this.currentView&&"month"===this.currentView||(this.currentView="month"):"dates"===e&&(this.currentView="date")}},methods:{proxyTimePickerDataProperties:function(){var e=this,t=function(t){e.$refs.timepicker.format=t},r=function(t){e.$refs.timepicker.value=t},i=function(t){e.$refs.timepicker.date=t},n=function(t){e.$refs.timepicker.selectableRange=t};this.$watch("value",r),this.$watch("date",i),this.$watch("selectableRange",n),t(this.timeFormat),r(this.value),i(this.date),n(this.selectableRange)},handleClear:function(){this.date=this.getDefaultValue(),this.$emit("pick",null)},emit:function(e){for(var t=this,r=arguments.length,i=Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];if(e)if(Array.isArray(e)){var o=e.map((function(e){return t.showTime?Object(no["clearMilliseconds"])(e):Object(no["clearTime"])(e)}));this.$emit.apply(this,["pick",o].concat(i))}else this.$emit.apply(this,["pick",this.showTime?Object(no["clearMilliseconds"])(e):Object(no["clearTime"])(e)].concat(i));else this.$emit.apply(this,["pick",e].concat(i));this.userInputDate=null,this.userInputTime=null},showMonthPicker:function(){this.currentView="month"},showYearPicker:function(){this.currentView="year"},prevMonth:function(){this.date=Object(no["prevMonth"])(this.date)},nextMonth:function(){this.date=Object(no["nextMonth"])(this.date)},prevYear:function(){"year"===this.currentView?this.date=Object(no["prevYear"])(this.date,10):this.date=Object(no["prevYear"])(this.date)},nextYear:function(){"year"===this.currentView?this.date=Object(no["nextYear"])(this.date,10):this.date=Object(no["nextYear"])(this.date)},handleShortcutClick:function(e){e.onClick&&e.onClick(this)},handleTimePick:function(e,t,r){if(Object(no["isDate"])(e)){var i=this.value?Object(no["modifyTime"])(this.value,e.getHours(),e.getMinutes(),e.getSeconds()):Object(no["modifyWithTimeString"])(this.getDefaultValue(),this.defaultTime);this.date=i,this.emit(this.date,!0)}else this.emit(e,!0);r||(this.timePickerVisible=t)},handleTimePickClose:function(){this.timePickerVisible=!1},handleMonthPick:function(e){"month"===this.selectionMode?(this.date=Object(no["modifyDate"])(this.date,this.year,e,1),this.emit(this.date)):(this.date=Object(no["changeYearMonthAndClampDate"])(this.date,this.year,e),this.currentView="date")},handleDatePick:function(e){if("day"===this.selectionMode){var t=this.value?Object(no["modifyDate"])(this.value,e.getFullYear(),e.getMonth(),e.getDate()):Object(no["modifyWithTimeString"])(e,this.defaultTime);this.checkDateWithinRange(t)||(t=Object(no["modifyDate"])(this.selectableRange[0][0],e.getFullYear(),e.getMonth(),e.getDate())),this.date=t,this.emit(this.date,this.showTime)}else"week"===this.selectionMode?this.emit(e.date):"dates"===this.selectionMode&&this.emit(e,!0)},handleYearPick:function(e){"year"===this.selectionMode?(this.date=Object(no["modifyDate"])(this.date,e,0,1),this.emit(this.date)):(this.date=Object(no["changeYearMonthAndClampDate"])(this.date,e,this.month),this.currentView="month")},changeToNow:function(){this.disabledDate&&this.disabledDate(new Date)||!this.checkDateWithinRange(new Date)||(this.date=new Date,this.emit(this.date))},confirm:function(){if("dates"===this.selectionMode)this.emit(this.value);else{var e=this.value?this.value:Object(no["modifyWithTimeString"])(this.getDefaultValue(),this.defaultTime);this.date=new Date(e),this.emit(e)}},resetView:function(){"month"===this.selectionMode?this.currentView="month":"year"===this.selectionMode?this.currentView="year":this.currentView="date"},handleEnter:function(){document.body.addEventListener("keydown",this.handleKeydown)},handleLeave:function(){this.$emit("dodestroy"),document.body.removeEventListener("keydown",this.handleKeydown)},handleKeydown:function(e){var t=e.keyCode,r=[38,40,37,39];this.visible&&!this.timePickerVisible&&(-1!==r.indexOf(t)&&(this.handleKeyControl(t),e.stopPropagation(),e.preventDefault()),13===t&&null===this.userInputDate&&null===this.userInputTime&&this.emit(this.date,!1))},handleKeyControl:function(e){var t={year:{38:-4,40:4,37:-1,39:1,offset:function(e,t){return e.setFullYear(e.getFullYear()+t)}},month:{38:-4,40:4,37:-1,39:1,offset:function(e,t){return e.setMonth(e.getMonth()+t)}},week:{38:-1,40:1,37:-1,39:1,offset:function(e,t){return e.setDate(e.getDate()+7*t)}},day:{38:-7,40:7,37:-1,39:1,offset:function(e,t){return e.setDate(e.getDate()+t)}}},r=this.selectionMode,i=31536e6,n=this.date.getTime(),o=new Date(this.date.getTime());while(Math.abs(n-o.getTime())<=i){var s=t[r];if(s.offset(o,s[e]),"function"!==typeof this.disabledDate||!this.disabledDate(o)){this.date=o,this.$emit("pick",o,!0);break}}},handleVisibleTimeChange:function(e){var t=Object(no["parseDate"])(e,this.timeFormat);t&&this.checkDateWithinRange(t)&&(this.date=Object(no["modifyDate"])(t,this.year,this.month,this.monthDate),this.userInputTime=null,this.$refs.timepicker.value=this.date,this.timePickerVisible=!1,this.emit(this.date,!0))},handleVisibleDateChange:function(e){var t=Object(no["parseDate"])(e,this.dateFormat);if(t){if("function"===typeof this.disabledDate&&this.disabledDate(t))return;this.date=Object(no["modifyTime"])(t,this.date.getHours(),this.date.getMinutes(),this.date.getSeconds()),this.userInputDate=null,this.resetView(),this.emit(this.date,!0)}},isValidValue:function(e){return e&&!isNaN(e)&&("function"!==typeof this.disabledDate||!this.disabledDate(e))&&this.checkDateWithinRange(e)},getDefaultValue:function(){return this.defaultValue?new Date(this.defaultValue):new Date},checkDateWithinRange:function(e){return!(this.selectableRange.length>0)||Object(no["timeWithinRange"])(e,this.selectableRange,this.format||"HH:mm:ss")}},components:{TimePicker:Bo,YearTable:Qo,MonthTable:Xo,DateTable:cs,ElInput:g.a,ElButton:se.a},data:function(){return{popperClass:"",date:new Date,value:"",defaultValue:null,defaultTime:null,showTime:!1,selectionMode:"day",shortcuts:"",visible:!1,currentView:"date",disabledDate:"",cellClassName:"",selectableRange:[],firstDayOfWeek:7,showWeekNumber:!1,timePickerVisible:!1,format:"",arrowControl:!1,userInputDate:null,userInputTime:null}},computed:{year:function(){return this.date.getFullYear()},month:function(){return this.date.getMonth()},week:function(){return Object(no["getWeekNumber"])(this.date)},monthDate:function(){return this.date.getDate()},footerVisible:function(){return this.showTime||"dates"===this.selectionMode},visibleTime:function(){return null!==this.userInputTime?this.userInputTime:Object(no["formatDate"])(this.value||this.defaultValue,this.timeFormat)},visibleDate:function(){return null!==this.userInputDate?this.userInputDate:Object(no["formatDate"])(this.value||this.defaultValue,this.dateFormat)},yearLabel:function(){var e=this.t("el.datepicker.year");if("year"===this.currentView){var t=10*Math.floor(this.year/10);return e?t+" "+e+" - "+(t+9)+" "+e:t+" - "+(t+9)}return this.year+" "+e},timeFormat:function(){return this.format?Object(no["extractTimeFormat"])(this.format):"HH:mm:ss"},dateFormat:function(){return this.format?Object(no["extractDateFormat"])(this.format):"yyyy-MM-dd"}}},us=ls,ds=a(us,To,bo,!1,null,null,null);ds.options.__file="packages/date-picker/src/panel/date.vue";var hs=ds.exports,ps=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition",{attrs:{name:"el-zoom-in-top"},on:{"after-leave":function(t){e.$emit("dodestroy")}}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"el-picker-panel el-date-range-picker el-popper",class:[{"has-sidebar":e.$slots.sidebar||e.shortcuts,"has-time":e.showTime},e.popperClass]},[r("div",{staticClass:"el-picker-panel__body-wrapper"},[e._t("sidebar"),e.shortcuts?r("div",{staticClass:"el-picker-panel__sidebar"},e._l(e.shortcuts,(function(t,i){return r("button",{key:i,staticClass:"el-picker-panel__shortcut",attrs:{type:"button"},on:{click:function(r){e.handleShortcutClick(t)}}},[e._v(e._s(t.text))])})),0):e._e(),r("div",{staticClass:"el-picker-panel__body"},[e.showTime?r("div",{staticClass:"el-date-range-picker__time-header"},[r("span",{staticClass:"el-date-range-picker__editors-wrap"},[r("span",{staticClass:"el-date-range-picker__time-picker-wrap"},[r("el-input",{ref:"minInput",staticClass:"el-date-range-picker__editor",attrs:{size:"small",disabled:e.rangeState.selecting,placeholder:e.t("el.datepicker.startDate"),value:e.minVisibleDate},on:{input:function(t){return e.handleDateInput(t,"min")},change:function(t){return e.handleDateChange(t,"min")}}})],1),r("span",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.handleMinTimeClose,expression:"handleMinTimeClose"}],staticClass:"el-date-range-picker__time-picker-wrap"},[r("el-input",{staticClass:"el-date-range-picker__editor",attrs:{size:"small",disabled:e.rangeState.selecting,placeholder:e.t("el.datepicker.startTime"),value:e.minVisibleTime},on:{focus:function(t){e.minTimePickerVisible=!0},input:function(t){return e.handleTimeInput(t,"min")},change:function(t){return e.handleTimeChange(t,"min")}}}),r("time-picker",{ref:"minTimePicker",attrs:{"time-arrow-control":e.arrowControl,visible:e.minTimePickerVisible},on:{pick:e.handleMinTimePick,mounted:function(t){e.$refs.minTimePicker.format=e.timeFormat}}})],1)]),r("span",{staticClass:"el-icon-arrow-right"}),r("span",{staticClass:"el-date-range-picker__editors-wrap is-right"},[r("span",{staticClass:"el-date-range-picker__time-picker-wrap"},[r("el-input",{staticClass:"el-date-range-picker__editor",attrs:{size:"small",disabled:e.rangeState.selecting,placeholder:e.t("el.datepicker.endDate"),value:e.maxVisibleDate,readonly:!e.minDate},on:{input:function(t){return e.handleDateInput(t,"max")},change:function(t){return e.handleDateChange(t,"max")}}})],1),r("span",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.handleMaxTimeClose,expression:"handleMaxTimeClose"}],staticClass:"el-date-range-picker__time-picker-wrap"},[r("el-input",{staticClass:"el-date-range-picker__editor",attrs:{size:"small",disabled:e.rangeState.selecting,placeholder:e.t("el.datepicker.endTime"),value:e.maxVisibleTime,readonly:!e.minDate},on:{focus:function(t){e.minDate&&(e.maxTimePickerVisible=!0)},input:function(t){return e.handleTimeInput(t,"max")},change:function(t){return e.handleTimeChange(t,"max")}}}),r("time-picker",{ref:"maxTimePicker",attrs:{"time-arrow-control":e.arrowControl,visible:e.maxTimePickerVisible},on:{pick:e.handleMaxTimePick,mounted:function(t){e.$refs.maxTimePicker.format=e.timeFormat}}})],1)])]):e._e(),r("div",{staticClass:"el-picker-panel__content el-date-range-picker__content is-left"},[r("div",{staticClass:"el-date-range-picker__header"},[r("button",{staticClass:"el-picker-panel__icon-btn el-icon-d-arrow-left",attrs:{type:"button"},on:{click:e.leftPrevYear}}),r("button",{staticClass:"el-picker-panel__icon-btn el-icon-arrow-left",attrs:{type:"button"},on:{click:e.leftPrevMonth}}),e.unlinkPanels?r("button",{staticClass:"el-picker-panel__icon-btn el-icon-d-arrow-right",class:{"is-disabled":!e.enableYearArrow},attrs:{type:"button",disabled:!e.enableYearArrow},on:{click:e.leftNextYear}}):e._e(),e.unlinkPanels?r("button",{staticClass:"el-picker-panel__icon-btn el-icon-arrow-right",class:{"is-disabled":!e.enableMonthArrow},attrs:{type:"button",disabled:!e.enableMonthArrow},on:{click:e.leftNextMonth}}):e._e(),r("div",[e._v(e._s(e.leftLabel))])]),r("date-table",{attrs:{"selection-mode":"range",date:e.leftDate,"default-value":e.defaultValue,"min-date":e.minDate,"max-date":e.maxDate,"range-state":e.rangeState,"disabled-date":e.disabledDate,"cell-class-name":e.cellClassName,"first-day-of-week":e.firstDayOfWeek},on:{changerange:e.handleChangeRange,pick:e.handleRangePick}})],1),r("div",{staticClass:"el-picker-panel__content el-date-range-picker__content is-right"},[r("div",{staticClass:"el-date-range-picker__header"},[e.unlinkPanels?r("button",{staticClass:"el-picker-panel__icon-btn el-icon-d-arrow-left",class:{"is-disabled":!e.enableYearArrow},attrs:{type:"button",disabled:!e.enableYearArrow},on:{click:e.rightPrevYear}}):e._e(),e.unlinkPanels?r("button",{staticClass:"el-picker-panel__icon-btn el-icon-arrow-left",class:{"is-disabled":!e.enableMonthArrow},attrs:{type:"button",disabled:!e.enableMonthArrow},on:{click:e.rightPrevMonth}}):e._e(),r("button",{staticClass:"el-picker-panel__icon-btn el-icon-d-arrow-right",attrs:{type:"button"},on:{click:e.rightNextYear}}),r("button",{staticClass:"el-picker-panel__icon-btn el-icon-arrow-right",attrs:{type:"button"},on:{click:e.rightNextMonth}}),r("div",[e._v(e._s(e.rightLabel))])]),r("date-table",{attrs:{"selection-mode":"range",date:e.rightDate,"default-value":e.defaultValue,"min-date":e.minDate,"max-date":e.maxDate,"range-state":e.rangeState,"disabled-date":e.disabledDate,"cell-class-name":e.cellClassName,"first-day-of-week":e.firstDayOfWeek},on:{changerange:e.handleChangeRange,pick:e.handleRangePick}})],1)])],2),e.showTime?r("div",{staticClass:"el-picker-panel__footer"},[r("el-button",{staticClass:"el-picker-panel__link-btn",attrs:{size:"mini",type:"text"},on:{click:e.handleClear}},[e._v("\n        "+e._s(e.t("el.datepicker.clear"))+"\n      ")]),r("el-button",{staticClass:"el-picker-panel__link-btn",attrs:{plain:"",size:"mini",disabled:e.btnDisabled},on:{click:function(t){e.handleConfirm(!1)}}},[e._v("\n        "+e._s(e.t("el.datepicker.confirm"))+"\n      ")])],1):e._e()])])},fs=[];ps._withStripped=!0;var gs=function(e){return Array.isArray(e)?[new Date(e[0]),new Date(e[1])]:e?[new Date(e),Object(no["nextDate"])(new Date(e),1)]:[new Date,Object(no["nextDate"])(new Date,1)]},ms={mixins:[_.a],directives:{Clickoutside:F.a},computed:{btnDisabled:function(){return!(this.minDate&&this.maxDate&&!this.selecting&&this.isValidValue([this.minDate,this.maxDate]))},leftLabel:function(){return this.leftDate.getFullYear()+" "+this.t("el.datepicker.year")+" "+this.t("el.datepicker.month"+(this.leftDate.getMonth()+1))},rightLabel:function(){return this.rightDate.getFullYear()+" "+this.t("el.datepicker.year")+" "+this.t("el.datepicker.month"+(this.rightDate.getMonth()+1))},leftYear:function(){return this.leftDate.getFullYear()},leftMonth:function(){return this.leftDate.getMonth()},leftMonthDate:function(){return this.leftDate.getDate()},rightYear:function(){return this.rightDate.getFullYear()},rightMonth:function(){return this.rightDate.getMonth()},rightMonthDate:function(){return this.rightDate.getDate()},minVisibleDate:function(){return null!==this.dateUserInput.min?this.dateUserInput.min:this.minDate?Object(no["formatDate"])(this.minDate,this.dateFormat):""},maxVisibleDate:function(){return null!==this.dateUserInput.max?this.dateUserInput.max:this.maxDate||this.minDate?Object(no["formatDate"])(this.maxDate||this.minDate,this.dateFormat):""},minVisibleTime:function(){return null!==this.timeUserInput.min?this.timeUserInput.min:this.minDate?Object(no["formatDate"])(this.minDate,this.timeFormat):""},maxVisibleTime:function(){return null!==this.timeUserInput.max?this.timeUserInput.max:this.maxDate||this.minDate?Object(no["formatDate"])(this.maxDate||this.minDate,this.timeFormat):""},timeFormat:function(){return this.format?Object(no["extractTimeFormat"])(this.format):"HH:mm:ss"},dateFormat:function(){return this.format?Object(no["extractDateFormat"])(this.format):"yyyy-MM-dd"},enableMonthArrow:function(){var e=(this.leftMonth+1)%12,t=this.leftMonth+1>=12?1:0;return this.unlinkPanels&&new Date(this.leftYear+t,e)<new Date(this.rightYear,this.rightMonth)},enableYearArrow:function(){return this.unlinkPanels&&12*this.rightYear+this.rightMonth-(12*this.leftYear+this.leftMonth+1)>=12}},data:function(){return{popperClass:"",value:[],defaultValue:null,defaultTime:null,minDate:"",maxDate:"",leftDate:new Date,rightDate:Object(no["nextMonth"])(new Date),rangeState:{endDate:null,selecting:!1,row:null,column:null},showTime:!1,shortcuts:"",visible:"",disabledDate:"",cellClassName:"",firstDayOfWeek:7,minTimePickerVisible:!1,maxTimePickerVisible:!1,format:"",arrowControl:!1,unlinkPanels:!1,dateUserInput:{min:null,max:null},timeUserInput:{min:null,max:null}}},watch:{minDate:function(e){var t=this;this.dateUserInput.min=null,this.timeUserInput.min=null,this.$nextTick((function(){if(t.$refs.maxTimePicker&&t.maxDate&&t.maxDate<t.minDate){var e="HH:mm:ss";t.$refs.maxTimePicker.selectableRange=[[Object(no["parseDate"])(Object(no["formatDate"])(t.minDate,e),e),Object(no["parseDate"])("23:59:59",e)]]}})),e&&this.$refs.minTimePicker&&(this.$refs.minTimePicker.date=e,this.$refs.minTimePicker.value=e)},maxDate:function(e){this.dateUserInput.max=null,this.timeUserInput.max=null,e&&this.$refs.maxTimePicker&&(this.$refs.maxTimePicker.date=e,this.$refs.maxTimePicker.value=e)},minTimePickerVisible:function(e){var t=this;e&&this.$nextTick((function(){t.$refs.minTimePicker.date=t.minDate,t.$refs.minTimePicker.value=t.minDate,t.$refs.minTimePicker.adjustSpinners()}))},maxTimePickerVisible:function(e){var t=this;e&&this.$nextTick((function(){t.$refs.maxTimePicker.date=t.maxDate,t.$refs.maxTimePicker.value=t.maxDate,t.$refs.maxTimePicker.adjustSpinners()}))},value:function(e){if(e){if(Array.isArray(e))if(this.minDate=Object(no["isDate"])(e[0])?new Date(e[0]):null,this.maxDate=Object(no["isDate"])(e[1])?new Date(e[1]):null,this.minDate)if(this.leftDate=this.minDate,this.unlinkPanels&&this.maxDate){var t=this.minDate.getFullYear(),r=this.minDate.getMonth(),i=this.maxDate.getFullYear(),n=this.maxDate.getMonth();this.rightDate=t===i&&r===n?Object(no["nextMonth"])(this.maxDate):this.maxDate}else this.rightDate=Object(no["nextMonth"])(this.leftDate);else this.leftDate=gs(this.defaultValue)[0],this.rightDate=Object(no["nextMonth"])(this.leftDate)}else this.minDate=null,this.maxDate=null},defaultValue:function(e){if(!Array.isArray(this.value)){var t=gs(e),r=t[0],i=t[1];this.leftDate=r,this.rightDate=e&&e[1]&&this.unlinkPanels?i:Object(no["nextMonth"])(this.leftDate)}}},methods:{handleClear:function(){this.minDate=null,this.maxDate=null,this.leftDate=gs(this.defaultValue)[0],this.rightDate=Object(no["nextMonth"])(this.leftDate),this.$emit("pick",null)},handleChangeRange:function(e){this.minDate=e.minDate,this.maxDate=e.maxDate,this.rangeState=e.rangeState},handleDateInput:function(e,t){if(this.dateUserInput[t]=e,e.length===this.dateFormat.length){var r=Object(no["parseDate"])(e,this.dateFormat);if(r){if("function"===typeof this.disabledDate&&this.disabledDate(new Date(r)))return;"min"===t?(this.minDate=Object(no["modifyDate"])(this.minDate||new Date,r.getFullYear(),r.getMonth(),r.getDate()),this.leftDate=new Date(r),this.unlinkPanels||(this.rightDate=Object(no["nextMonth"])(this.leftDate))):(this.maxDate=Object(no["modifyDate"])(this.maxDate||new Date,r.getFullYear(),r.getMonth(),r.getDate()),this.rightDate=new Date(r),this.unlinkPanels||(this.leftDate=Object(no["prevMonth"])(r)))}}},handleDateChange:function(e,t){var r=Object(no["parseDate"])(e,this.dateFormat);r&&("min"===t?(this.minDate=Object(no["modifyDate"])(this.minDate,r.getFullYear(),r.getMonth(),r.getDate()),this.minDate>this.maxDate&&(this.maxDate=this.minDate)):(this.maxDate=Object(no["modifyDate"])(this.maxDate,r.getFullYear(),r.getMonth(),r.getDate()),this.maxDate<this.minDate&&(this.minDate=this.maxDate)))},handleTimeInput:function(e,t){var r=this;if(this.timeUserInput[t]=e,e.length===this.timeFormat.length){var i=Object(no["parseDate"])(e,this.timeFormat);i&&("min"===t?(this.minDate=Object(no["modifyTime"])(this.minDate,i.getHours(),i.getMinutes(),i.getSeconds()),this.$nextTick((function(e){return r.$refs.minTimePicker.adjustSpinners()}))):(this.maxDate=Object(no["modifyTime"])(this.maxDate,i.getHours(),i.getMinutes(),i.getSeconds()),this.$nextTick((function(e){return r.$refs.maxTimePicker.adjustSpinners()}))))}},handleTimeChange:function(e,t){var r=Object(no["parseDate"])(e,this.timeFormat);r&&("min"===t?(this.minDate=Object(no["modifyTime"])(this.minDate,r.getHours(),r.getMinutes(),r.getSeconds()),this.minDate>this.maxDate&&(this.maxDate=this.minDate),this.$refs.minTimePicker.value=this.minDate,this.minTimePickerVisible=!1):(this.maxDate=Object(no["modifyTime"])(this.maxDate,r.getHours(),r.getMinutes(),r.getSeconds()),this.maxDate<this.minDate&&(this.minDate=this.maxDate),this.$refs.maxTimePicker.value=this.minDate,this.maxTimePickerVisible=!1))},handleRangePick:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.defaultTime||[],n=Object(no["modifyWithTimeString"])(e.minDate,i[0]),o=Object(no["modifyWithTimeString"])(e.maxDate,i[1]);this.maxDate===o&&this.minDate===n||(this.onPick&&this.onPick(e),this.maxDate=o,this.minDate=n,setTimeout((function(){t.maxDate=o,t.minDate=n}),10),r&&!this.showTime&&this.handleConfirm())},handleShortcutClick:function(e){e.onClick&&e.onClick(this)},handleMinTimePick:function(e,t,r){this.minDate=this.minDate||new Date,e&&(this.minDate=Object(no["modifyTime"])(this.minDate,e.getHours(),e.getMinutes(),e.getSeconds())),r||(this.minTimePickerVisible=t),(!this.maxDate||this.maxDate&&this.maxDate.getTime()<this.minDate.getTime())&&(this.maxDate=new Date(this.minDate))},handleMinTimeClose:function(){this.minTimePickerVisible=!1},handleMaxTimePick:function(e,t,r){this.maxDate&&e&&(this.maxDate=Object(no["modifyTime"])(this.maxDate,e.getHours(),e.getMinutes(),e.getSeconds())),r||(this.maxTimePickerVisible=t),this.maxDate&&this.minDate&&this.minDate.getTime()>this.maxDate.getTime()&&(this.minDate=new Date(this.maxDate))},handleMaxTimeClose:function(){this.maxTimePickerVisible=!1},leftPrevYear:function(){this.leftDate=Object(no["prevYear"])(this.leftDate),this.unlinkPanels||(this.rightDate=Object(no["nextMonth"])(this.leftDate))},leftPrevMonth:function(){this.leftDate=Object(no["prevMonth"])(this.leftDate),this.unlinkPanels||(this.rightDate=Object(no["nextMonth"])(this.leftDate))},rightNextYear:function(){this.unlinkPanels?this.rightDate=Object(no["nextYear"])(this.rightDate):(this.leftDate=Object(no["nextYear"])(this.leftDate),this.rightDate=Object(no["nextMonth"])(this.leftDate))},rightNextMonth:function(){this.unlinkPanels?this.rightDate=Object(no["nextMonth"])(this.rightDate):(this.leftDate=Object(no["nextMonth"])(this.leftDate),this.rightDate=Object(no["nextMonth"])(this.leftDate))},leftNextYear:function(){this.leftDate=Object(no["nextYear"])(this.leftDate)},leftNextMonth:function(){this.leftDate=Object(no["nextMonth"])(this.leftDate)},rightPrevYear:function(){this.rightDate=Object(no["prevYear"])(this.rightDate)},rightPrevMonth:function(){this.rightDate=Object(no["prevMonth"])(this.rightDate)},handleConfirm:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isValidValue([this.minDate,this.maxDate])&&this.$emit("pick",[this.minDate,this.maxDate],e)},isValidValue:function(e){return Array.isArray(e)&&e&&e[0]&&e[1]&&Object(no["isDate"])(e[0])&&Object(no["isDate"])(e[1])&&e[0].getTime()<=e[1].getTime()&&("function"!==typeof this.disabledDate||!this.disabledDate(e[0])&&!this.disabledDate(e[1]))},resetView:function(){this.minDate&&null==this.maxDate&&(this.rangeState.selecting=!1),this.minDate=this.value&&Object(no["isDate"])(this.value[0])?new Date(this.value[0]):null,this.maxDate=this.value&&Object(no["isDate"])(this.value[0])?new Date(this.value[1]):null}},components:{TimePicker:Bo,DateTable:cs,ElInput:g.a,ElButton:se.a}},_s=ms,vs=a(_s,ps,fs,!1,null,null,null);vs.options.__file="packages/date-picker/src/panel/date-range.vue";var Es=vs.exports,As=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition",{attrs:{name:"el-zoom-in-top"},on:{"after-leave":function(t){e.$emit("dodestroy")}}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"el-picker-panel el-date-range-picker el-popper",class:[{"has-sidebar":e.$slots.sidebar||e.shortcuts},e.popperClass]},[r("div",{staticClass:"el-picker-panel__body-wrapper"},[e._t("sidebar"),e.shortcuts?r("div",{staticClass:"el-picker-panel__sidebar"},e._l(e.shortcuts,(function(t,i){return r("button",{key:i,staticClass:"el-picker-panel__shortcut",attrs:{type:"button"},on:{click:function(r){e.handleShortcutClick(t)}}},[e._v(e._s(t.text))])})),0):e._e(),r("div",{staticClass:"el-picker-panel__body"},[r("div",{staticClass:"el-picker-panel__content el-date-range-picker__content is-left"},[r("div",{staticClass:"el-date-range-picker__header"},[r("button",{staticClass:"el-picker-panel__icon-btn el-icon-d-arrow-left",attrs:{type:"button"},on:{click:e.leftPrevYear}}),e.unlinkPanels?r("button",{staticClass:"el-picker-panel__icon-btn el-icon-d-arrow-right",class:{"is-disabled":!e.enableYearArrow},attrs:{type:"button",disabled:!e.enableYearArrow},on:{click:e.leftNextYear}}):e._e(),r("div",[e._v(e._s(e.leftLabel))])]),r("month-table",{attrs:{"selection-mode":"range",date:e.leftDate,"default-value":e.defaultValue,"min-date":e.minDate,"max-date":e.maxDate,"range-state":e.rangeState,"disabled-date":e.disabledDate},on:{changerange:e.handleChangeRange,pick:e.handleRangePick}})],1),r("div",{staticClass:"el-picker-panel__content el-date-range-picker__content is-right"},[r("div",{staticClass:"el-date-range-picker__header"},[e.unlinkPanels?r("button",{staticClass:"el-picker-panel__icon-btn el-icon-d-arrow-left",class:{"is-disabled":!e.enableYearArrow},attrs:{type:"button",disabled:!e.enableYearArrow},on:{click:e.rightPrevYear}}):e._e(),r("button",{staticClass:"el-picker-panel__icon-btn el-icon-d-arrow-right",attrs:{type:"button"},on:{click:e.rightNextYear}}),r("div",[e._v(e._s(e.rightLabel))])]),r("month-table",{attrs:{"selection-mode":"range",date:e.rightDate,"default-value":e.defaultValue,"min-date":e.minDate,"max-date":e.maxDate,"range-state":e.rangeState,"disabled-date":e.disabledDate},on:{changerange:e.handleChangeRange,pick:e.handleRangePick}})],1)])],2)])])},ys=[];As._withStripped=!0;var Ss=function(e){return Array.isArray(e)?[new Date(e[0]),new Date(e[1])]:e?[new Date(e),Object(no["nextMonth"])(new Date(e))]:[new Date,Object(no["nextMonth"])(new Date)]},Cs={mixins:[_.a],directives:{Clickoutside:F.a},computed:{btnDisabled:function(){return!(this.minDate&&this.maxDate&&!this.selecting&&this.isValidValue([this.minDate,this.maxDate]))},leftLabel:function(){return this.leftDate.getFullYear()+" "+this.t("el.datepicker.year")},rightLabel:function(){return this.rightDate.getFullYear()+" "+this.t("el.datepicker.year")},leftYear:function(){return this.leftDate.getFullYear()},rightYear:function(){return this.rightDate.getFullYear()===this.leftDate.getFullYear()?this.leftDate.getFullYear()+1:this.rightDate.getFullYear()},enableYearArrow:function(){return this.unlinkPanels&&this.rightYear>this.leftYear+1}},data:function(){return{popperClass:"",value:[],defaultValue:null,defaultTime:null,minDate:"",maxDate:"",leftDate:new Date,rightDate:Object(no["nextYear"])(new Date),rangeState:{endDate:null,selecting:!1,row:null,column:null},shortcuts:"",visible:"",disabledDate:"",format:"",arrowControl:!1,unlinkPanels:!1}},watch:{value:function(e){if(e){if(Array.isArray(e))if(this.minDate=Object(no["isDate"])(e[0])?new Date(e[0]):null,this.maxDate=Object(no["isDate"])(e[1])?new Date(e[1]):null,this.minDate)if(this.leftDate=this.minDate,this.unlinkPanels&&this.maxDate){var t=this.minDate.getFullYear(),r=this.maxDate.getFullYear();this.rightDate=t===r?Object(no["nextYear"])(this.maxDate):this.maxDate}else this.rightDate=Object(no["nextYear"])(this.leftDate);else this.leftDate=Ss(this.defaultValue)[0],this.rightDate=Object(no["nextYear"])(this.leftDate)}else this.minDate=null,this.maxDate=null},defaultValue:function(e){if(!Array.isArray(this.value)){var t=Ss(e),r=t[0],i=t[1];this.leftDate=r,this.rightDate=e&&e[1]&&r.getFullYear()!==i.getFullYear()&&this.unlinkPanels?i:Object(no["nextYear"])(this.leftDate)}}},methods:{handleClear:function(){this.minDate=null,this.maxDate=null,this.leftDate=Ss(this.defaultValue)[0],this.rightDate=Object(no["nextYear"])(this.leftDate),this.$emit("pick",null)},handleChangeRange:function(e){this.minDate=e.minDate,this.maxDate=e.maxDate,this.rangeState=e.rangeState},handleRangePick:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.defaultTime||[],n=Object(no["modifyWithTimeString"])(e.minDate,i[0]),o=Object(no["modifyWithTimeString"])(e.maxDate,i[1]);this.maxDate===o&&this.minDate===n||(this.onPick&&this.onPick(e),this.maxDate=o,this.minDate=n,setTimeout((function(){t.maxDate=o,t.minDate=n}),10),r&&this.handleConfirm())},handleShortcutClick:function(e){e.onClick&&e.onClick(this)},leftPrevYear:function(){this.leftDate=Object(no["prevYear"])(this.leftDate),this.unlinkPanels||(this.rightDate=Object(no["prevYear"])(this.rightDate))},rightNextYear:function(){this.unlinkPanels||(this.leftDate=Object(no["nextYear"])(this.leftDate)),this.rightDate=Object(no["nextYear"])(this.rightDate)},leftNextYear:function(){this.leftDate=Object(no["nextYear"])(this.leftDate)},rightPrevYear:function(){this.rightDate=Object(no["prevYear"])(this.rightDate)},handleConfirm:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isValidValue([this.minDate,this.maxDate])&&this.$emit("pick",[this.minDate,this.maxDate],e)},isValidValue:function(e){return Array.isArray(e)&&e&&e[0]&&e[1]&&Object(no["isDate"])(e[0])&&Object(no["isDate"])(e[1])&&e[0].getTime()<=e[1].getTime()&&("function"!==typeof this.disabledDate||!this.disabledDate(e[0])&&!this.disabledDate(e[1]))},resetView:function(){this.minDate=this.value&&Object(no["isDate"])(this.value[0])?new Date(this.value[0]):null,this.maxDate=this.value&&Object(no["isDate"])(this.value[0])?new Date(this.value[1]):null}},components:{MonthTable:Xo,ElInput:g.a,ElButton:se.a}},Ts=Cs,bs=a(Ts,As,ys,!1,null,null,null);bs.options.__file="packages/date-picker/src/panel/month-range.vue";var Is=bs.exports,Rs=function(e){return"daterange"===e||"datetimerange"===e?Es:"monthrange"===e?Is:hs},ws={mixins:[Co],name:"ElDatePicker",props:{type:{type:String,default:"date"},timeArrowControl:Boolean},watch:{type:function(e){this.picker?(this.unmountPicker(),this.panel=Rs(e),this.mountPicker()):this.panel=Rs(e)}},created:function(){this.panel=Rs(this.type)},install:function(e){e.component(ws.name,ws)}},ks=ws,Os=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition",{attrs:{name:"el-zoom-in-top"},on:{"before-enter":e.handleMenuEnter,"after-leave":function(t){e.$emit("dodestroy")}}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],ref:"popper",staticClass:"el-picker-panel time-select el-popper",class:e.popperClass,style:{width:e.width+"px"}},[r("el-scrollbar",{attrs:{noresize:"","wrap-class":"el-picker-panel__content"}},e._l(e.items,(function(t){return r("div",{key:t.value,staticClass:"time-select-item",class:{selected:e.value===t.value,disabled:t.disabled,default:t.value===e.defaultValue},attrs:{disabled:t.disabled},on:{click:function(r){e.handleClick(t)}}},[e._v(e._s(t.value))])})),0)],1)])},Ns=[];Os._withStripped=!0;var Ls=function(e){var t=(e||"").split(":");if(t.length>=2){var r=parseInt(t[0],10),i=parseInt(t[1],10);return{hours:r,minutes:i}}return null},Ps=function(e,t){var r=Ls(e),i=Ls(t),n=r.minutes+60*r.hours,o=i.minutes+60*i.hours;return n===o?0:n>o?1:-1},Ds=function(e){return(e.hours<10?"0"+e.hours:e.hours)+":"+(e.minutes<10?"0"+e.minutes:e.minutes)},Ms=function(e,t){var r=Ls(e),i=Ls(t),n={hours:r.hours,minutes:r.minutes};return n.minutes+=i.minutes,n.hours+=i.hours,n.hours+=Math.floor(n.minutes/60),n.minutes=n.minutes%60,Ds(n)},xs={components:{ElScrollbar:W.a},watch:{value:function(e){var t=this;e&&this.$nextTick((function(){return t.scrollToOption()}))}},methods:{handleClick:function(e){e.disabled||this.$emit("pick",e.value)},handleClear:function(){this.$emit("pick",null)},scrollToOption:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".selected",t=this.$refs.popper.querySelector(".el-picker-panel__content");ti()(t,t.querySelector(e))},handleMenuEnter:function(){var e=this,t=-1!==this.items.map((function(e){return e.value})).indexOf(this.value),r=-1!==this.items.map((function(e){return e.value})).indexOf(this.defaultValue),i=(t?".selected":r&&".default")||".time-select-item:not(.disabled)";this.$nextTick((function(){return e.scrollToOption(i)}))},scrollDown:function(e){var t=this.items,r=t.length,i=t.length,n=t.map((function(e){return e.value})).indexOf(this.value);while(i--)if(n=(n+e+r)%r,!t[n].disabled)return void this.$emit("pick",t[n].value,!0)},isValidValue:function(e){return-1!==this.items.filter((function(e){return!e.disabled})).map((function(e){return e.value})).indexOf(e)},handleKeydown:function(e){var t=e.keyCode;if(38===t||40===t){var r={40:1,38:-1},i=r[t.toString()];return this.scrollDown(i),void e.stopPropagation()}}},data:function(){return{popperClass:"",start:"09:00",end:"18:00",step:"00:30",value:"",defaultValue:"",visible:!1,minTime:"",maxTime:"",width:0}},computed:{items:function(){var e=this.start,t=this.end,r=this.step,i=[];if(e&&t&&r){var n=e;while(Ps(n,t)<=0)i.push({value:n,disabled:Ps(n,this.minTime||"-1:-1")<=0||Ps(n,this.maxTime||"100:100")>=0}),n=Ms(n,r)}return i}}},Bs=xs,Us=a(Bs,Os,Ns,!1,null,null,null);Us.options.__file="packages/date-picker/src/panel/time-select.vue";var Fs=Us.exports,Vs={mixins:[Co],name:"ElTimeSelect",componentName:"ElTimeSelect",props:{type:{type:String,default:"time-select"}},beforeCreate:function(){this.panel=Fs},install:function(e){e.component(Vs.name,Vs)}},js=Vs,Gs=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition",{attrs:{name:"el-zoom-in-top"},on:{"after-leave":function(t){e.$emit("dodestroy")}}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"el-time-range-picker el-picker-panel el-popper",class:e.popperClass},[r("div",{staticClass:"el-time-range-picker__content"},[r("div",{staticClass:"el-time-range-picker__cell"},[r("div",{staticClass:"el-time-range-picker__header"},[e._v(e._s(e.t("el.datepicker.startTime")))]),r("div",{staticClass:"el-time-range-picker__body el-time-panel__content",class:{"has-seconds":e.showSeconds,"is-arrow":e.arrowControl}},[r("time-spinner",{ref:"minSpinner",attrs:{"show-seconds":e.showSeconds,"am-pm-mode":e.amPmMode,"arrow-control":e.arrowControl,date:e.minDate},on:{change:e.handleMinChange,"select-range":e.setMinSelectionRange}})],1)]),r("div",{staticClass:"el-time-range-picker__cell"},[r("div",{staticClass:"el-time-range-picker__header"},[e._v(e._s(e.t("el.datepicker.endTime")))]),r("div",{staticClass:"el-time-range-picker__body el-time-panel__content",class:{"has-seconds":e.showSeconds,"is-arrow":e.arrowControl}},[r("time-spinner",{ref:"maxSpinner",attrs:{"show-seconds":e.showSeconds,"am-pm-mode":e.amPmMode,"arrow-control":e.arrowControl,date:e.maxDate},on:{change:e.handleMaxChange,"select-range":e.setMaxSelectionRange}})],1)])]),r("div",{staticClass:"el-time-panel__footer"},[r("button",{staticClass:"el-time-panel__btn cancel",attrs:{type:"button"},on:{click:function(t){e.handleCancel()}}},[e._v(e._s(e.t("el.datepicker.cancel")))]),r("button",{staticClass:"el-time-panel__btn confirm",attrs:{type:"button",disabled:e.btnDisabled},on:{click:function(t){e.handleConfirm()}}},[e._v(e._s(e.t("el.datepicker.confirm")))])])])])},Hs=[];Gs._withStripped=!0;var Qs=Object(no["parseDate"])("00:00:00","HH:mm:ss"),Ws=Object(no["parseDate"])("23:59:59","HH:mm:ss"),qs=function(e){return Object(no["modifyDate"])(Qs,e.getFullYear(),e.getMonth(),e.getDate())},zs=function(e){return Object(no["modifyDate"])(Ws,e.getFullYear(),e.getMonth(),e.getDate())},Zs=function(e,t){return new Date(Math.min(e.getTime()+t,zs(e).getTime()))},Ys={mixins:[_.a],components:{TimeSpinner:Po},computed:{showSeconds:function(){return-1!==(this.format||"").indexOf("ss")},offset:function(){return this.showSeconds?11:8},spinner:function(){return this.selectionRange[0]<this.offset?this.$refs.minSpinner:this.$refs.maxSpinner},btnDisabled:function(){return this.minDate.getTime()>this.maxDate.getTime()},amPmMode:function(){return-1!==(this.format||"").indexOf("A")?"A":-1!==(this.format||"").indexOf("a")?"a":""}},data:function(){return{popperClass:"",minDate:new Date,maxDate:new Date,value:[],oldValue:[new Date,new Date],defaultValue:null,format:"HH:mm:ss",visible:!1,selectionRange:[0,2],arrowControl:!1}},watch:{value:function(e){Array.isArray(e)?(this.minDate=new Date(e[0]),this.maxDate=new Date(e[1])):Array.isArray(this.defaultValue)?(this.minDate=new Date(this.defaultValue[0]),this.maxDate=new Date(this.defaultValue[1])):this.defaultValue?(this.minDate=new Date(this.defaultValue),this.maxDate=Zs(new Date(this.defaultValue),36e5)):(this.minDate=new Date,this.maxDate=Zs(new Date,36e5))},visible:function(e){var t=this;e&&(this.oldValue=this.value,this.$nextTick((function(){return t.$refs.minSpinner.emitSelectRange("hours")})))}},methods:{handleClear:function(){this.$emit("pick",null)},handleCancel:function(){this.$emit("pick",this.oldValue)},handleMinChange:function(e){this.minDate=Object(no["clearMilliseconds"])(e),this.handleChange()},handleMaxChange:function(e){this.maxDate=Object(no["clearMilliseconds"])(e),this.handleChange()},handleChange:function(){this.isValidValue([this.minDate,this.maxDate])&&(this.$refs.minSpinner.selectableRange=[[qs(this.minDate),this.maxDate]],this.$refs.maxSpinner.selectableRange=[[this.minDate,zs(this.maxDate)]],this.$emit("pick",[this.minDate,this.maxDate],!0))},setMinSelectionRange:function(e,t){this.$emit("select-range",e,t,"min"),this.selectionRange=[e,t]},setMaxSelectionRange:function(e,t){this.$emit("select-range",e,t,"max"),this.selectionRange=[e+this.offset,t+this.offset]},handleConfirm:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.$refs.minSpinner.selectableRange,r=this.$refs.maxSpinner.selectableRange;this.minDate=Object(no["limitTimeRange"])(this.minDate,t,this.format),this.maxDate=Object(no["limitTimeRange"])(this.maxDate,r,this.format),this.$emit("pick",[this.minDate,this.maxDate],e)},adjustSpinners:function(){this.$refs.minSpinner.adjustSpinners(),this.$refs.maxSpinner.adjustSpinners()},changeSelectionRange:function(e){var t=this.showSeconds?[0,3,6,11,14,17]:[0,3,8,11],r=["hours","minutes"].concat(this.showSeconds?["seconds"]:[]),i=t.indexOf(this.selectionRange[0]),n=(i+e+t.length)%t.length,o=t.length/2;n<o?this.$refs.minSpinner.emitSelectRange(r[n]):this.$refs.maxSpinner.emitSelectRange(r[n-o])},isValidValue:function(e){return Array.isArray(e)&&Object(no["timeWithinRange"])(this.minDate,this.$refs.minSpinner.selectableRange)&&Object(no["timeWithinRange"])(this.maxDate,this.$refs.maxSpinner.selectableRange)},handleKeydown:function(e){var t=e.keyCode,r={38:-1,40:1,37:-1,39:1};if(37===t||39===t){var i=r[t];return this.changeSelectionRange(i),void e.preventDefault()}if(38===t||40===t){var n=r[t];return this.spinner.scrollDown(n),void e.preventDefault()}}}},Ks=Ys,$s=a(Ks,Gs,Hs,!1,null,null,null);$s.options.__file="packages/date-picker/src/panel/time-range.vue";var Js=$s.exports,Xs={mixins:[Co],name:"ElTimePicker",props:{isRange:Boolean,arrowControl:Boolean},data:function(){return{type:""}},watch:{isRange:function(e){this.picker?(this.unmountPicker(),this.type=e?"timerange":"time",this.panel=e?Js:Bo,this.mountPicker()):(this.type=e?"timerange":"time",this.panel=e?Js:Bo)}},created:function(){this.type=this.isRange?"timerange":"time",this.panel=this.isRange?Js:Bo},install:function(e){e.component(Xs.name,Xs)}},ea=Xs,ta=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("span",[r("transition",{attrs:{name:e.transition},on:{"after-enter":e.handleAfterEnter,"after-leave":e.handleAfterLeave}},[r("div",{directives:[{name:"show",rawName:"v-show",value:!e.disabled&&e.showPopper,expression:"!disabled && showPopper"}],ref:"popper",staticClass:"el-popover el-popper",class:[e.popperClass,e.content&&"el-popover--plain"],style:{width:e.width+"px"},attrs:{role:"tooltip",id:e.tooltipId,"aria-hidden":e.disabled||!e.showPopper?"true":"false"}},[e.title?r("div",{staticClass:"el-popover__title",domProps:{textContent:e._s(e.title)}}):e._e(),e._t("default",[e._v(e._s(e.content))])],2)]),r("span",{ref:"wrapper",staticClass:"el-popover__reference-wrapper"},[e._t("reference")],2)],1)},ra=[];ta._withStripped=!0;var ia={name:"ElPopover",mixins:[H.a],props:{trigger:{type:String,default:"click",validator:function(e){return["click","focus","hover","manual"].indexOf(e)>-1}},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:200},title:String,disabled:Boolean,content:String,reference:{},popperClass:String,width:{},visibleArrow:{default:!0},arrowOffset:{type:Number,default:0},transition:{type:String,default:"fade-in-linear"},tabindex:{type:Number,default:0}},computed:{tooltipId:function(){return"el-popover-"+Object(v["generateId"])()}},watch:{showPopper:function(e){this.disabled||(e?this.$emit("show"):this.$emit("hide"))}},mounted:function(){var e=this,t=this.referenceElm=this.reference||this.$refs.reference,r=this.popper||this.$refs.popper;!t&&this.$refs.wrapper.children&&(t=this.referenceElm=this.$refs.wrapper.children[0]),t&&(Object(Ue["addClass"])(t,"el-popover__reference"),t.setAttribute("aria-describedby",this.tooltipId),t.setAttribute("tabindex",this.tabindex),r.setAttribute("tabindex",0),"click"!==this.trigger&&(Object(Ue["on"])(t,"focusin",(function(){e.handleFocus();var r=t.__vue__;r&&"function"===typeof r.focus&&r.focus()})),Object(Ue["on"])(r,"focusin",this.handleFocus),Object(Ue["on"])(t,"focusout",this.handleBlur),Object(Ue["on"])(r,"focusout",this.handleBlur)),Object(Ue["on"])(t,"keydown",this.handleKeydown),Object(Ue["on"])(t,"click",this.handleClick)),"click"===this.trigger?(Object(Ue["on"])(t,"click",this.doToggle),Object(Ue["on"])(document,"click",this.handleDocumentClick)):"hover"===this.trigger?(Object(Ue["on"])(t,"mouseenter",this.handleMouseEnter),Object(Ue["on"])(r,"mouseenter",this.handleMouseEnter),Object(Ue["on"])(t,"mouseleave",this.handleMouseLeave),Object(Ue["on"])(r,"mouseleave",this.handleMouseLeave)):"focus"===this.trigger&&(this.tabindex<0&&console.warn("[Element Warn][Popover]a negative taindex means that the element cannot be focused by tab key"),t.querySelector("input, textarea")?(Object(Ue["on"])(t,"focusin",this.doShow),Object(Ue["on"])(t,"focusout",this.doClose)):(Object(Ue["on"])(t,"mousedown",this.doShow),Object(Ue["on"])(t,"mouseup",this.doClose)))},beforeDestroy:function(){this.cleanup()},deactivated:function(){this.cleanup()},methods:{doToggle:function(){this.showPopper=!this.showPopper},doShow:function(){this.showPopper=!0},doClose:function(){this.showPopper=!1},handleFocus:function(){Object(Ue["addClass"])(this.referenceElm,"focusing"),"click"!==this.trigger&&"focus"!==this.trigger||(this.showPopper=!0)},handleClick:function(){Object(Ue["removeClass"])(this.referenceElm,"focusing")},handleBlur:function(){Object(Ue["removeClass"])(this.referenceElm,"focusing"),"click"!==this.trigger&&"focus"!==this.trigger||(this.showPopper=!1)},handleMouseEnter:function(){var e=this;clearTimeout(this._timer),this.openDelay?this._timer=setTimeout((function(){e.showPopper=!0}),this.openDelay):this.showPopper=!0},handleKeydown:function(e){27===e.keyCode&&"manual"!==this.trigger&&this.doClose()},handleMouseLeave:function(){var e=this;clearTimeout(this._timer),this.closeDelay?this._timer=setTimeout((function(){e.showPopper=!1}),this.closeDelay):this.showPopper=!1},handleDocumentClick:function(e){var t=this.reference||this.$refs.reference,r=this.popper||this.$refs.popper;!t&&this.$refs.wrapper.children&&(t=this.referenceElm=this.$refs.wrapper.children[0]),this.$el&&t&&!this.$el.contains(e.target)&&!t.contains(e.target)&&r&&!r.contains(e.target)&&(this.showPopper=!1)},handleAfterEnter:function(){this.$emit("after-enter")},handleAfterLeave:function(){this.$emit("after-leave"),this.doDestroy()},cleanup:function(){(this.openDelay||this.closeDelay)&&clearTimeout(this._timer)}},destroyed:function(){var e=this.reference;Object(Ue["off"])(e,"click",this.doToggle),Object(Ue["off"])(e,"mouseup",this.doClose),Object(Ue["off"])(e,"mousedown",this.doShow),Object(Ue["off"])(e,"focusin",this.doShow),Object(Ue["off"])(e,"focusout",this.doClose),Object(Ue["off"])(e,"mousedown",this.doShow),Object(Ue["off"])(e,"mouseup",this.doClose),Object(Ue["off"])(e,"mouseleave",this.handleMouseLeave),Object(Ue["off"])(e,"mouseenter",this.handleMouseEnter),Object(Ue["off"])(document,"click",this.handleDocumentClick)}},na=ia,oa=a(na,ta,ra,!1,null,null,null);oa.options.__file="packages/popover/src/main.vue";var sa=oa.exports,aa=function(e,t,r){var i=t.expression?t.value:t.arg,n=r.context.$refs[i];n&&(Array.isArray(n)?n[0].$refs.reference=e:n.$refs.reference=e)},ca={bind:function(e,t,r){aa(e,t,r)},inserted:function(e,t,r){aa(e,t,r)}};ji.a.directive("popover",ca),sa.install=function(e){e.directive("popover",ca),e.component(sa.name,sa)},sa.directive=ca;var la=sa,ua={name:"ElTooltip",mixins:[H.a],props:{openDelay:{type:Number,default:0},disabled:Boolean,manual:Boolean,effect:{type:String,default:"dark"},arrowOffset:{type:Number,default:0},popperClass:String,content:String,visibleArrow:{default:!0},transition:{type:String,default:"el-fade-in-linear"},popperOptions:{default:function(){return{boundariesPadding:10,gpuAcceleration:!1}}},enterable:{type:Boolean,default:!0},hideAfter:{type:Number,default:0},tabindex:{type:Number,default:0}},data:function(){return{tooltipId:"el-tooltip-"+Object(v["generateId"])(),timeoutPending:null,focusing:!1}},beforeCreate:function(){var e=this;this.$isServer||(this.popperVM=new ji.a({data:{node:""},render:function(e){return this.node}}).$mount(),this.debounceClose=B()(200,(function(){return e.handleClosePopper()})))},render:function(e){var t=this;this.popperVM&&(this.popperVM.node=e("transition",{attrs:{name:this.transition},on:{afterLeave:this.doDestroy}},[e("div",{on:{mouseleave:function(){t.setExpectedState(!1),t.debounceClose()},mouseenter:function(){t.setExpectedState(!0)}},ref:"popper",attrs:{role:"tooltip",id:this.tooltipId,"aria-hidden":this.disabled||!this.showPopper?"true":"false"},directives:[{name:"show",value:!this.disabled&&this.showPopper}],class:["el-tooltip__popper","is-"+this.effect,this.popperClass]},[this.$slots.content||this.content])]));var r=this.getFirstElement();if(!r)return null;var i=r.data=r.data||{};return i.staticClass=this.addTooltipClass(i.staticClass),r},mounted:function(){var e=this;this.referenceElm=this.$el,1===this.$el.nodeType&&(this.$el.setAttribute("aria-describedby",this.tooltipId),this.$el.setAttribute("tabindex",this.tabindex),Object(Ue["on"])(this.referenceElm,"mouseenter",this.show),Object(Ue["on"])(this.referenceElm,"mouseleave",this.hide),Object(Ue["on"])(this.referenceElm,"focus",(function(){if(e.$slots.default&&e.$slots.default.length){var t=e.$slots.default[0].componentInstance;t&&t.focus?t.focus():e.handleFocus()}else e.handleFocus()})),Object(Ue["on"])(this.referenceElm,"blur",this.handleBlur),Object(Ue["on"])(this.referenceElm,"click",this.removeFocusing)),this.value&&this.popperVM&&this.popperVM.$nextTick((function(){e.value&&e.updatePopper()}))},watch:{focusing:function(e){e?Object(Ue["addClass"])(this.referenceElm,"focusing"):Object(Ue["removeClass"])(this.referenceElm,"focusing")}},methods:{show:function(){this.setExpectedState(!0),this.handleShowPopper()},hide:function(){this.setExpectedState(!1),this.debounceClose()},handleFocus:function(){this.focusing=!0,this.show()},handleBlur:function(){this.focusing=!1,this.hide()},removeFocusing:function(){this.focusing=!1},addTooltipClass:function(e){return e?"el-tooltip "+e.replace("el-tooltip",""):"el-tooltip"},handleShowPopper:function(){var e=this;this.expectedState&&!this.manual&&(clearTimeout(this.timeout),this.timeout=setTimeout((function(){e.showPopper=!0}),this.openDelay),this.hideAfter>0&&(this.timeoutPending=setTimeout((function(){e.showPopper=!1}),this.hideAfter)))},handleClosePopper:function(){this.enterable&&this.expectedState||this.manual||(clearTimeout(this.timeout),this.timeoutPending&&clearTimeout(this.timeoutPending),this.showPopper=!1,this.disabled&&this.doDestroy())},setExpectedState:function(e){!1===e&&clearTimeout(this.timeoutPending),this.expectedState=e},getFirstElement:function(){var e=this.$slots.default;if(!Array.isArray(e))return null;for(var t=null,r=0;r<e.length;r++)e[r]&&e[r].tag&&(t=e[r]);return t}},beforeDestroy:function(){this.popperVM&&this.popperVM.$destroy()},destroyed:function(){var e=this.referenceElm;1===e.nodeType&&(Object(Ue["off"])(e,"mouseenter",this.show),Object(Ue["off"])(e,"mouseleave",this.hide),Object(Ue["off"])(e,"focus",this.handleFocus),Object(Ue["off"])(e,"blur",this.handleBlur),Object(Ue["off"])(e,"click",this.removeFocusing))},install:function(e){e.component(ua.name,ua)}},da=ua,ha=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition",{attrs:{name:"msgbox-fade"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"el-message-box__wrapper",attrs:{tabindex:"-1",role:"dialog","aria-modal":"true","aria-label":e.title||"dialog"},on:{click:function(t){return t.target!==t.currentTarget?null:e.handleWrapperClick(t)}}},[r("div",{staticClass:"el-message-box",class:[e.customClass,e.center&&"el-message-box--center"]},[null!==e.title?r("div",{staticClass:"el-message-box__header"},[r("div",{staticClass:"el-message-box__title"},[e.icon&&e.center?r("div",{class:["el-message-box__status",e.icon]}):e._e(),r("span",[e._v(e._s(e.title))])]),e.showClose?r("button",{staticClass:"el-message-box__headerbtn",attrs:{type:"button","aria-label":"Close"},on:{click:function(t){e.handleAction(e.distinguishCancelAndClose?"close":"cancel")},keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.handleAction(e.distinguishCancelAndClose?"close":"cancel")}}},[r("i",{staticClass:"el-message-box__close el-icon-close"})]):e._e()]):e._e(),r("div",{staticClass:"el-message-box__content"},[r("div",{staticClass:"el-message-box__container"},[e.icon&&!e.center&&""!==e.message?r("div",{class:["el-message-box__status",e.icon]}):e._e(),""!==e.message?r("div",{staticClass:"el-message-box__message"},[e._t("default",[e.dangerouslyUseHTMLString?r("p",{domProps:{innerHTML:e._s(e.message)}}):r("p",[e._v(e._s(e.message))])])],2):e._e()]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.showInput,expression:"showInput"}],staticClass:"el-message-box__input"},[r("el-input",{ref:"input",attrs:{type:e.inputType,placeholder:e.inputPlaceholder},nativeOn:{keydown:function(t){return!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputEnter(t)}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}),r("div",{staticClass:"el-message-box__errormsg",style:{visibility:e.editorErrorMessage?"visible":"hidden"}},[e._v(e._s(e.editorErrorMessage))])],1)]),r("div",{staticClass:"el-message-box__btns"},[e.showCancelButton?r("el-button",{class:[e.cancelButtonClasses],attrs:{loading:e.cancelButtonLoading,round:e.roundButton,size:"small"},on:{keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.handleAction("cancel")}},nativeOn:{click:function(t){e.handleAction("cancel")}}},[e._v("\n          "+e._s(e.cancelButtonText||e.t("el.messagebox.cancel"))+"\n        ")]):e._e(),r("el-button",{directives:[{name:"show",rawName:"v-show",value:e.showConfirmButton,expression:"showConfirmButton"}],ref:"confirm",class:[e.confirmButtonClasses],attrs:{loading:e.confirmButtonLoading,round:e.roundButton,size:"small"},on:{keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.handleAction("confirm")}},nativeOn:{click:function(t){e.handleAction("confirm")}}},[e._v("\n          "+e._s(e.confirmButtonText||e.t("el.messagebox.confirm"))+"\n        ")])],1)])])])},pa=[];ha._withStripped=!0;var fa=r(12),ga=r.n(fa),ma=r(39),_a=r.n(ma),va=void 0,Ea={success:"success",info:"info",warning:"warning",error:"error"},Aa={mixins:[T.a,_.a],props:{modal:{default:!0},lockScroll:{default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{default:!0},closeOnPressEscape:{default:!0},closeOnHashChange:{default:!0},center:{default:!1,type:Boolean},roundButton:{default:!1,type:Boolean}},components:{ElInput:g.a,ElButton:se.a},computed:{icon:function(){var e=this.type,t=this.iconClass;return t||(e&&Ea[e]?"el-icon-"+Ea[e]:"")},confirmButtonClasses:function(){return"el-button--primary "+this.confirmButtonClass},cancelButtonClasses:function(){return""+this.cancelButtonClass}},methods:{getSafeClose:function(){var e=this,t=this.uid;return function(){e.$nextTick((function(){t===e.uid&&e.doClose()}))}},doClose:function(){var e=this;this.visible&&(this.visible=!1,this._closing=!0,this.onClose&&this.onClose(),va.closeDialog(),this.lockScroll&&setTimeout(this.restoreBodyStyle,200),this.opened=!1,this.doAfterClose(),setTimeout((function(){e.action&&e.callback(e.action,e)})))},handleWrapperClick:function(){this.closeOnClickModal&&this.handleAction(this.distinguishCancelAndClose?"close":"cancel")},handleInputEnter:function(){if("textarea"!==this.inputType)return this.handleAction("confirm")},handleAction:function(e){("prompt"!==this.$type||"confirm"!==e||this.validate())&&(this.action=e,"function"===typeof this.beforeClose?(this.close=this.getSafeClose(),this.beforeClose(e,this,this.close)):this.doClose())},validate:function(){if("prompt"===this.$type){var e=this.inputPattern;if(e&&!e.test(this.inputValue||""))return this.editorErrorMessage=this.inputErrorMessage||Object(fa["t"])("el.messagebox.error"),Object(Ue["addClass"])(this.getInputElement(),"invalid"),!1;var t=this.inputValidator;if("function"===typeof t){var r=t(this.inputValue);if(!1===r)return this.editorErrorMessage=this.inputErrorMessage||Object(fa["t"])("el.messagebox.error"),Object(Ue["addClass"])(this.getInputElement(),"invalid"),!1;if("string"===typeof r)return this.editorErrorMessage=r,Object(Ue["addClass"])(this.getInputElement(),"invalid"),!1}}return this.editorErrorMessage="",Object(Ue["removeClass"])(this.getInputElement(),"invalid"),!0},getFirstFocus:function(){var e=this.$el.querySelector(".el-message-box__btns .el-button"),t=this.$el.querySelector(".el-message-box__btns .el-message-box__title");return e||t},getInputElement:function(){var e=this.$refs.input.$refs;return e.input||e.textarea},handleClose:function(){this.handleAction("close")}},watch:{inputValue:{immediate:!0,handler:function(e){var t=this;this.$nextTick((function(r){"prompt"===t.$type&&null!==e&&t.validate()}))}},visible:function(e){var t=this;e&&(this.uid++,"alert"!==this.$type&&"confirm"!==this.$type||this.$nextTick((function(){t.$refs.confirm.$el.focus()})),this.focusAfterClosed=document.activeElement,va=new _a.a(this.$el,this.focusAfterClosed,this.getFirstFocus())),"prompt"===this.$type&&(e?setTimeout((function(){t.$refs.input&&t.$refs.input.$el&&t.getInputElement().focus()}),500):(this.editorErrorMessage="",Object(Ue["removeClass"])(this.getInputElement(),"invalid")))}},mounted:function(){var e=this;this.$nextTick((function(){e.closeOnHashChange&&window.addEventListener("hashchange",e.close)}))},beforeDestroy:function(){this.closeOnHashChange&&window.removeEventListener("hashchange",this.close),setTimeout((function(){va.closeDialog()}))},data:function(){return{uid:1,title:void 0,message:"",type:"",iconClass:"",customClass:"",showInput:!1,inputValue:null,inputPlaceholder:"",inputType:"text",inputPattern:null,inputValidator:null,inputErrorMessage:"",showConfirmButton:!0,showCancelButton:!1,action:"",confirmButtonText:"",cancelButtonText:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonClass:"",confirmButtonDisabled:!1,cancelButtonClass:"",editorErrorMessage:null,callback:null,dangerouslyUseHTMLString:!1,focusAfterClosed:null,isOnComposition:!1,distinguishCancelAndClose:!1}}},ya=Aa,Sa=a(ya,ha,pa,!1,null,null,null);Sa.options.__file="packages/message-box/src/main.vue";var Ca=Sa.exports,Ta=r(22),ba="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ia={title:null,message:"",type:"",iconClass:"",showInput:!1,showClose:!0,modalFade:!0,lockScroll:!0,closeOnClickModal:!0,closeOnPressEscape:!0,closeOnHashChange:!0,inputValue:null,inputPlaceholder:"",inputType:"text",inputPattern:null,inputValidator:null,inputErrorMessage:"",showConfirmButton:!0,showCancelButton:!1,confirmButtonPosition:"right",confirmButtonHighlight:!1,cancelButtonHighlight:!1,confirmButtonText:"",cancelButtonText:"",confirmButtonClass:"",cancelButtonClass:"",customClass:"",beforeClose:null,dangerouslyUseHTMLString:!1,center:!1,roundButton:!1,distinguishCancelAndClose:!1},Ra=ji.a.extend(Ca),wa=void 0,ka=void 0,Oa=[],Na=function(e){if(wa){var t=wa.callback;"function"===typeof t&&(ka.showInput?t(ka.inputValue,e):t(e)),wa.resolve&&("confirm"===e?ka.showInput?wa.resolve({value:ka.inputValue,action:e}):wa.resolve(e):!wa.reject||"cancel"!==e&&"close"!==e||wa.reject(e))}},La=function(){ka=new Ra({el:document.createElement("div")}),ka.callback=Na},Pa=function e(){if(ka||La(),ka.action="",(!ka.visible||ka.closeTimer)&&Oa.length>0){wa=Oa.shift();var t=wa.options;for(var r in t)t.hasOwnProperty(r)&&(ka[r]=t[r]);void 0===t.callback&&(ka.callback=Na);var i=ka.callback;ka.callback=function(t,r){i(t,r),e()},Object(Ta["isVNode"])(ka.message)?(ka.$slots.default=[ka.message],ka.message=null):delete ka.$slots.default,["modal","showClose","closeOnClickModal","closeOnPressEscape","closeOnHashChange"].forEach((function(e){void 0===ka[e]&&(ka[e]=!0)})),document.body.appendChild(ka.$el),ji.a.nextTick((function(){ka.visible=!0}))}},Da=function e(t,r){if(!ji.a.prototype.$isServer){if("string"===typeof t||Object(Ta["isVNode"])(t)?(t={message:t},"string"===typeof arguments[1]&&(t.title=arguments[1])):t.callback&&!r&&(r=t.callback),"undefined"!==typeof Promise)return new Promise((function(i,n){Oa.push({options:bt()({},Ia,e.defaults,t),callback:r,resolve:i,reject:n}),Pa()}));Oa.push({options:bt()({},Ia,e.defaults,t),callback:r}),Pa()}};Da.setDefaults=function(e){Da.defaults=e},Da.alert=function(e,t,r){return"object"===("undefined"===typeof t?"undefined":ba(t))?(r=t,t=""):void 0===t&&(t=""),Da(bt()({title:t,message:e,$type:"alert",closeOnPressEscape:!1,closeOnClickModal:!1},r))},Da.confirm=function(e,t,r){return"object"===("undefined"===typeof t?"undefined":ba(t))?(r=t,t=""):void 0===t&&(t=""),Da(bt()({title:t,message:e,$type:"confirm",showCancelButton:!0},r))},Da.prompt=function(e,t,r){return"object"===("undefined"===typeof t?"undefined":ba(t))?(r=t,t=""):void 0===t&&(t=""),Da(bt()({title:t,message:e,showCancelButton:!0,showInput:!0,$type:"prompt"},r))},Da.close=function(){ka.doClose(),ka.visible=!1,Oa=[],wa=null};var Ma=Da,xa=Ma,Ba=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-breadcrumb",attrs:{"aria-label":"Breadcrumb",role:"navigation"}},[e._t("default")],2)},Ua=[];Ba._withStripped=!0;var Fa={name:"ElBreadcrumb",props:{separator:{type:String,default:"/"},separatorClass:{type:String,default:""}},provide:function(){return{elBreadcrumb:this}},mounted:function(){var e=this.$el.querySelectorAll(".el-breadcrumb__item");e.length&&e[e.length-1].setAttribute("aria-current","page")}},Va=Fa,ja=a(Va,Ba,Ua,!1,null,null,null);ja.options.__file="packages/breadcrumb/src/breadcrumb.vue";var Ga=ja.exports;Ga.install=function(e){e.component(Ga.name,Ga)};var Ha=Ga,Qa=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("span",{staticClass:"el-breadcrumb__item"},[r("span",{ref:"link",class:["el-breadcrumb__inner",e.to?"is-link":""],attrs:{role:"link"}},[e._t("default")],2),e.separatorClass?r("i",{staticClass:"el-breadcrumb__separator",class:e.separatorClass}):r("span",{staticClass:"el-breadcrumb__separator",attrs:{role:"presentation"}},[e._v(e._s(e.separator))])])},Wa=[];Qa._withStripped=!0;var qa={name:"ElBreadcrumbItem",props:{to:{},replace:Boolean},data:function(){return{separator:"",separatorClass:""}},inject:["elBreadcrumb"],mounted:function(){var e=this;this.separator=this.elBreadcrumb.separator,this.separatorClass=this.elBreadcrumb.separatorClass;var t=this.$refs.link;t.setAttribute("role","link"),t.addEventListener("click",(function(t){var r=e.to,i=e.$router;r&&i&&(e.replace?i.replace(r):i.push(r))}))}},za=qa,Za=a(za,Qa,Wa,!1,null,null,null);Za.options.__file="packages/breadcrumb/src/breadcrumb-item.vue";var Ya=Za.exports;Ya.install=function(e){e.component(Ya.name,Ya)};var Ka=Ya,$a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("form",{staticClass:"el-form",class:[e.labelPosition?"el-form--label-"+e.labelPosition:"",{"el-form--inline":e.inline}]},[e._t("default")],2)},Ja=[];$a._withStripped=!0;var Xa={name:"ElForm",componentName:"ElForm",provide:function(){return{elForm:this}},props:{model:Object,rules:Object,labelPosition:String,labelWidth:String,labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},size:String,disabled:Boolean,validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:{type:Boolean,default:!1}},watch:{rules:function(){this.fields.forEach((function(e){e.removeValidateEvents(),e.addValidateEvents()})),this.validateOnRuleChange&&this.validate((function(){}))}},computed:{autoLabelWidth:function(){if(!this.potentialLabelWidthArr.length)return 0;var e=Math.max.apply(Math,this.potentialLabelWidthArr);return e?e+"px":""}},data:function(){return{fields:[],potentialLabelWidthArr:[]}},created:function(){var e=this;this.$on("el.form.addField",(function(t){t&&e.fields.push(t)})),this.$on("el.form.removeField",(function(t){t.prop&&e.fields.splice(e.fields.indexOf(t),1)}))},methods:{resetFields:function(){this.model?this.fields.forEach((function(e){e.resetField()})):console.warn("[Element Warn][Form]model is required for resetFields to work.")},clearValidate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.length?"string"===typeof e?this.fields.filter((function(t){return e===t.prop})):this.fields.filter((function(t){return e.indexOf(t.prop)>-1})):this.fields;t.forEach((function(e){e.clearValidate()}))},validate:function(e){var t=this;if(this.model){var r=void 0;"function"!==typeof e&&window.Promise&&(r=new window.Promise((function(t,r){e=function(e){e?t(e):r(e)}})));var i=!0,n=0;0===this.fields.length&&e&&e(!0);var o={};return this.fields.forEach((function(r){r.validate("",(function(r,s){r&&(i=!1),o=bt()({},o,s),"function"===typeof e&&++n===t.fields.length&&e(i,o)}))})),r||void 0}console.warn("[Element Warn][Form]model is required for validate to work!")},validateField:function(e,t){e=[].concat(e);var r=this.fields.filter((function(t){return-1!==e.indexOf(t.prop)}));r.length?r.forEach((function(e){e.validate("",t)})):console.warn("[Element Warn]please pass correct props!")},getLabelWidthIndex:function(e){var t=this.potentialLabelWidthArr.indexOf(e);if(-1===t)throw new Error("[ElementForm]unpected width ",e);return t},registerLabelWidth:function(e,t){if(e&&t){var r=this.getLabelWidthIndex(t);this.potentialLabelWidthArr.splice(r,1,e)}else e&&this.potentialLabelWidthArr.push(e)},deregisterLabelWidth:function(e){var t=this.getLabelWidthIndex(e);this.potentialLabelWidthArr.splice(t,1)}}},ec=Xa,tc=a(ec,$a,Ja,!1,null,null,null);tc.options.__file="packages/form/src/form.vue";var rc=tc.exports;rc.install=function(e){e.component(rc.name,rc)};var ic=rc,nc=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-form-item",class:[{"el-form-item--feedback":e.elForm&&e.elForm.statusIcon,"is-error":"error"===e.validateState,"is-validating":"validating"===e.validateState,"is-success":"success"===e.validateState,"is-required":e.isRequired||e.required,"is-no-asterisk":e.elForm&&e.elForm.hideRequiredAsterisk},e.sizeClass?"el-form-item--"+e.sizeClass:""]},[r("label-wrap",{attrs:{"is-auto-width":e.labelStyle&&"auto"===e.labelStyle.width,"update-all":"auto"===e.form.labelWidth}},[e.label||e.$slots.label?r("label",{staticClass:"el-form-item__label",style:e.labelStyle,attrs:{for:e.labelFor}},[e._t("label",[e._v(e._s(e.label+e.form.labelSuffix))])],2):e._e()]),r("div",{staticClass:"el-form-item__content",style:e.contentStyle},[e._t("default"),r("transition",{attrs:{name:"el-zoom-in-top"}},["error"===e.validateState&&e.showMessage&&e.form.showMessage?e._t("error",[r("div",{staticClass:"el-form-item__error",class:{"el-form-item__error--inline":"boolean"===typeof e.inlineMessage?e.inlineMessage:e.elForm&&e.elForm.inlineMessage||!1}},[e._v("\n          "+e._s(e.validateMessage)+"\n        ")])],{error:e.validateMessage}):e._e()],2)],2)],1)},oc=[];nc._withStripped=!0;var sc,ac,cc=r(40),lc=r.n(cc),uc={props:{isAutoWidth:Boolean,updateAll:Boolean},inject:["elForm","elFormItem"],render:function(){var e=arguments[0],t=this.$slots.default;if(!t)return null;if(this.isAutoWidth){var r=this.elForm.autoLabelWidth,i={};if(r&&"auto"!==r){var n=parseInt(r,10)-this.computedWidth;n&&(i.marginLeft=n+"px")}return e("div",{class:"el-form-item__label-wrap",style:i},[t])}return t[0]},methods:{getLabelWidth:function(){if(this.$el&&this.$el.firstElementChild){var e=window.getComputedStyle(this.$el.firstElementChild).width;return Math.ceil(parseFloat(e))}return 0},updateLabelWidth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"update";this.$slots.default&&this.isAutoWidth&&this.$el.firstElementChild&&("update"===e?this.computedWidth=this.getLabelWidth():"remove"===e&&this.elForm.deregisterLabelWidth(this.computedWidth))}},watch:{computedWidth:function(e,t){this.updateAll&&(this.elForm.registerLabelWidth(e,t),this.elFormItem.updateComputedLabelWidth(e))}},data:function(){return{computedWidth:0}},mounted:function(){this.updateLabelWidth("update")},updated:function(){this.updateLabelWidth("update")},beforeDestroy:function(){this.updateLabelWidth("remove")}},dc=uc,hc=a(dc,sc,ac,!1,null,null,null);hc.options.__file="packages/form/src/label-wrap.vue";var pc=hc.exports,fc={name:"ElFormItem",componentName:"ElFormItem",mixins:[w.a],provide:function(){return{elFormItem:this}},inject:["elForm"],props:{label:String,labelWidth:String,prop:String,required:{type:Boolean,default:void 0},rules:[Object,Array],error:String,validateStatus:String,for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:String},components:{LabelWrap:pc},watch:{error:{immediate:!0,handler:function(e){this.validateMessage=e,this.validateState=e?"error":""}},validateStatus:function(e){this.validateState=e}},computed:{labelFor:function(){return this.for||this.prop},labelStyle:function(){var e={};if("top"===this.form.labelPosition)return e;var t=this.labelWidth||this.form.labelWidth;return t&&(e.width=t),e},contentStyle:function(){var e={},t=this.label;if("top"===this.form.labelPosition||this.form.inline)return e;if(!t&&!this.labelWidth&&this.isNested)return e;var r=this.labelWidth||this.form.labelWidth;return"auto"===r?"auto"===this.labelWidth?e.marginLeft=this.computedLabelWidth:"auto"===this.form.labelWidth&&(e.marginLeft=this.elForm.autoLabelWidth):e.marginLeft=r,e},form:function(){var e=this.$parent,t=e.$options.componentName;while("ElForm"!==t)"ElFormItem"===t&&(this.isNested=!0),e=e.$parent,t=e.$options.componentName;return e},fieldValue:function(){var e=this.form.model;if(e&&this.prop){var t=this.prop;return-1!==t.indexOf(":")&&(t=t.replace(/:/,".")),Object(v["getPropByPath"])(e,t,!0).v}},isRequired:function(){var e=this.getRules(),t=!1;return e&&e.length&&e.every((function(e){return!e.required||(t=!0,!1)})),t},_formSize:function(){return this.elForm.size},elFormItemSize:function(){return this.size||this._formSize},sizeClass:function(){return this.elFormItemSize||(this.$ELEMENT||{}).size}},data:function(){return{validateState:"",validateMessage:"",validateDisabled:!1,validator:{},isNested:!1,computedLabelWidth:""}},methods:{validate:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v["noop"];this.validateDisabled=!1;var i=this.getFilteredRule(e);if((!i||0===i.length)&&void 0===this.required)return r(),!0;this.validateState="validating";var n={};i&&i.length>0&&i.forEach((function(e){delete e.trigger})),n[this.prop]=i;var o=new lc.a(n),s={};s[this.prop]=this.fieldValue,o.validate(s,{firstFields:!0},(function(e,i){t.validateState=e?"error":"success",t.validateMessage=e?e[0].message:"",r(t.validateMessage,i),t.elForm&&t.elForm.$emit("validate",t.prop,!e,t.validateMessage||null)}))},clearValidate:function(){this.validateState="",this.validateMessage="",this.validateDisabled=!1},resetField:function(){var e=this;this.validateState="",this.validateMessage="";var t=this.form.model,r=this.fieldValue,i=this.prop;-1!==i.indexOf(":")&&(i=i.replace(/:/,"."));var n=Object(v["getPropByPath"])(t,i,!0);this.validateDisabled=!0,Array.isArray(r)?n.o[n.k]=[].concat(this.initialValue):n.o[n.k]=this.initialValue,this.$nextTick((function(){e.validateDisabled=!1})),this.broadcast("ElTimeSelect","fieldReset",this.initialValue)},getRules:function(){var e=this.form.rules,t=this.rules,r=void 0!==this.required?{required:!!this.required}:[],i=Object(v["getPropByPath"])(e,this.prop||"");return e=e?i.o[this.prop||""]||i.v:[],[].concat(t||e||[]).concat(r)},getFilteredRule:function(e){var t=this.getRules();return t.filter((function(t){return!t.trigger||""===e||(Array.isArray(t.trigger)?t.trigger.indexOf(e)>-1:t.trigger===e)})).map((function(e){return bt()({},e)}))},onFieldBlur:function(){this.validate("blur")},onFieldChange:function(){this.validateDisabled?this.validateDisabled=!1:this.validate("change")},updateComputedLabelWidth:function(e){this.computedLabelWidth=e?e+"px":""},addValidateEvents:function(){var e=this.getRules();(e.length||void 0!==this.required)&&(this.$on("el.form.blur",this.onFieldBlur),this.$on("el.form.change",this.onFieldChange))},removeValidateEvents:function(){this.$off()}},mounted:function(){if(this.prop){this.dispatch("ElForm","el.form.addField",[this]);var e=this.fieldValue;Array.isArray(e)&&(e=[].concat(e)),Object.defineProperty(this,"initialValue",{value:e}),this.addValidateEvents()}},beforeDestroy:function(){this.dispatch("ElForm","el.form.removeField",[this])}},gc=fc,mc=a(gc,nc,oc,!1,null,null,null);mc.options.__file="packages/form/src/form-item.vue";var _c=mc.exports;_c.install=function(e){e.component(_c.name,_c)};var vc=_c,Ec=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-tabs__active-bar",class:"is-"+e.rootTabs.tabPosition,style:e.barStyle})},Ac=[];Ec._withStripped=!0;var yc={name:"TabBar",props:{tabs:Array},inject:["rootTabs"],computed:{barStyle:{get:function(){var e=this,t={},r=0,i=0,n=-1!==["top","bottom"].indexOf(this.rootTabs.tabPosition)?"width":"height",o="width"===n?"x":"y",s=function(e){return e.toLowerCase().replace(/( |^)[a-z]/g,(function(e){return e.toUpperCase()}))};this.tabs.every((function(t,o){var a=Object(v["arrayFind"])(e.$parent.$refs.tabs||[],(function(e){return e.id.replace("tab-","")===t.paneName}));if(!a)return!1;if(t.active){i=a["client"+s(n)];var c=window.getComputedStyle(a);return"width"===n&&e.tabs.length>1&&(i-=parseFloat(c.paddingLeft)+parseFloat(c.paddingRight)),"width"===n&&(r+=parseFloat(c.paddingLeft)),!1}return r+=a["client"+s(n)],!0}));var a="translate"+s(o)+"("+r+"px)";return t[n]=i+"px",t.transform=a,t.msTransform=a,t.webkitTransform=a,t}}}},Sc=yc,Cc=a(Sc,Ec,Ac,!1,null,null,null);Cc.options.__file="packages/tabs/src/tab-bar.vue";var Tc=Cc.exports;function bc(){}var Ic,Rc,wc=function(e){return e.toLowerCase().replace(/( |^)[a-z]/g,(function(e){return e.toUpperCase()}))},kc={name:"TabNav",components:{TabBar:Tc},inject:["rootTabs"],props:{panes:Array,currentName:String,editable:Boolean,onTabClick:{type:Function,default:bc},onTabRemove:{type:Function,default:bc},type:String,stretch:Boolean},data:function(){return{scrollable:!1,navOffset:0,isFocus:!1,focusable:!0}},computed:{navStyle:function(){var e=-1!==["top","bottom"].indexOf(this.rootTabs.tabPosition)?"X":"Y";return{transform:"translate"+e+"(-"+this.navOffset+"px)"}},sizeName:function(){return-1!==["top","bottom"].indexOf(this.rootTabs.tabPosition)?"width":"height"}},methods:{scrollPrev:function(){var e=this.$refs.navScroll["offset"+wc(this.sizeName)],t=this.navOffset;if(t){var r=t>e?t-e:0;this.navOffset=r}},scrollNext:function(){var e=this.$refs.nav["offset"+wc(this.sizeName)],t=this.$refs.navScroll["offset"+wc(this.sizeName)],r=this.navOffset;if(!(e-r<=t)){var i=e-r>2*t?r+t:e-t;this.navOffset=i}},scrollToActiveTab:function(){if(this.scrollable){var e=this.$refs.nav,t=this.$el.querySelector(".is-active");if(t){var r=this.$refs.navScroll,i=-1!==["top","bottom"].indexOf(this.rootTabs.tabPosition),n=t.getBoundingClientRect(),o=r.getBoundingClientRect(),s=i?e.offsetWidth-o.width:e.offsetHeight-o.height,a=this.navOffset,c=a;i?(n.left<o.left&&(c=a-(o.left-n.left)),n.right>o.right&&(c=a+n.right-o.right)):(n.top<o.top&&(c=a-(o.top-n.top)),n.bottom>o.bottom&&(c=a+(n.bottom-o.bottom))),c=Math.max(c,0),this.navOffset=Math.min(c,s)}}},update:function(){if(this.$refs.nav){var e=this.sizeName,t=this.$refs.nav["offset"+wc(e)],r=this.$refs.navScroll["offset"+wc(e)],i=this.navOffset;if(r<t){var n=this.navOffset;this.scrollable=this.scrollable||{},this.scrollable.prev=n,this.scrollable.next=n+r<t,t-n<r&&(this.navOffset=t-r)}else this.scrollable=!1,i>0&&(this.navOffset=0)}},changeTab:function(e){var t=e.keyCode,r=void 0,i=void 0,n=void 0;-1!==[37,38,39,40].indexOf(t)&&(n=e.currentTarget.querySelectorAll("[role=tab]"),i=Array.prototype.indexOf.call(n,e.target),r=37===t||38===t?0===i?n.length-1:i-1:i<n.length-1?i+1:0,n[r].focus(),n[r].click(),this.setFocus())},setFocus:function(){this.focusable&&(this.isFocus=!0)},removeFocus:function(){this.isFocus=!1},visibilityChangeHandler:function(){var e=this,t=document.visibilityState;"hidden"===t?this.focusable=!1:"visible"===t&&setTimeout((function(){e.focusable=!0}),50)},windowBlurHandler:function(){this.focusable=!1},windowFocusHandler:function(){var e=this;setTimeout((function(){e.focusable=!0}),50)}},updated:function(){this.update()},render:function(e){var t=this,r=this.type,i=this.panes,n=this.editable,o=this.stretch,s=this.onTabClick,a=this.onTabRemove,c=this.navStyle,l=this.scrollable,u=this.scrollNext,d=this.scrollPrev,h=this.changeTab,p=this.setFocus,f=this.removeFocus,g=l?[e("span",{class:["el-tabs__nav-prev",l.prev?"":"is-disabled"],on:{click:d}},[e("i",{class:"el-icon-arrow-left"})]),e("span",{class:["el-tabs__nav-next",l.next?"":"is-disabled"],on:{click:u}},[e("i",{class:"el-icon-arrow-right"})])]:null,m=this._l(i,(function(r,i){var o,c=r.name||r.index||i,l=r.isClosable||n;r.index=""+i;var u=l?e("span",{class:"el-icon-close",on:{click:function(e){a(r,e)}}}):null,d=r.$slots.label||r.label,h=r.active?0:-1;return e("div",{class:(o={"el-tabs__item":!0},o["is-"+t.rootTabs.tabPosition]=!0,o["is-active"]=r.active,o["is-disabled"]=r.disabled,o["is-closable"]=l,o["is-focus"]=t.isFocus,o),attrs:{id:"tab-"+c,"aria-controls":"pane-"+c,role:"tab","aria-selected":r.active,tabindex:h},key:"tab-"+c,ref:"tabs",refInFor:!0,on:{focus:function(){p()},blur:function(){f()},click:function(e){f(),s(r,c,e)},keydown:function(e){!l||46!==e.keyCode&&8!==e.keyCode||a(r,e)}}},[d,u])}));return e("div",{class:["el-tabs__nav-wrap",l?"is-scrollable":"","is-"+this.rootTabs.tabPosition]},[g,e("div",{class:["el-tabs__nav-scroll"],ref:"navScroll"},[e("div",{class:["el-tabs__nav","is-"+this.rootTabs.tabPosition,o&&-1!==["top","bottom"].indexOf(this.rootTabs.tabPosition)?"is-stretch":""],ref:"nav",style:c,attrs:{role:"tablist"},on:{keydown:h}},[r?null:e("tab-bar",{attrs:{tabs:i}}),m])])])},mounted:function(){var e=this;Object(Xr["addResizeListener"])(this.$el,this.update),document.addEventListener("visibilitychange",this.visibilityChangeHandler),window.addEventListener("blur",this.windowBlurHandler),window.addEventListener("focus",this.windowFocusHandler),setTimeout((function(){e.scrollToActiveTab()}),0)},beforeDestroy:function(){this.$el&&this.update&&Object(Xr["removeResizeListener"])(this.$el,this.update),document.removeEventListener("visibilitychange",this.visibilityChangeHandler),window.removeEventListener("blur",this.windowBlurHandler),window.removeEventListener("focus",this.windowFocusHandler)}},Oc=kc,Nc=a(Oc,Ic,Rc,!1,null,null,null);Nc.options.__file="packages/tabs/src/tab-nav.vue";var Lc,Pc,Dc=Nc.exports,Mc={name:"ElTabs",components:{TabNav:Dc},props:{type:String,activeName:String,closable:Boolean,addable:Boolean,value:{},editable:Boolean,tabPosition:{type:String,default:"top"},beforeLeave:Function,stretch:Boolean},provide:function(){return{rootTabs:this}},data:function(){return{currentName:this.value||this.activeName,panes:[]}},watch:{activeName:function(e){this.setCurrentName(e)},value:function(e){this.setCurrentName(e)},currentName:function(e){var t=this;this.$refs.nav&&this.$nextTick((function(){t.$refs.nav.$nextTick((function(e){t.$refs.nav.scrollToActiveTab()}))}))}},methods:{calcPaneInstances:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.$slots.default){var r=this.$slots.default.filter((function(e){return e.tag&&e.componentOptions&&"ElTabPane"===e.componentOptions.Ctor.options.name})),i=r.map((function(e){var t=e.componentInstance;return t})),n=!(i.length===this.panes.length&&i.every((function(t,r){return t===e.panes[r]})));(t||n)&&(this.panes=i)}else 0!==this.panes.length&&(this.panes=[])},handleTabClick:function(e,t,r){e.disabled||(this.setCurrentName(t),this.$emit("tab-click",e,r))},handleTabRemove:function(e,t){e.disabled||(t.stopPropagation(),this.$emit("edit",e.name,"remove"),this.$emit("tab-remove",e.name))},handleTabAdd:function(){this.$emit("edit",null,"add"),this.$emit("tab-add")},setCurrentName:function(e){var t=this,r=function(){t.currentName=e,t.$emit("input",e)};if(this.currentName!==e&&this.beforeLeave){var i=this.beforeLeave(e,this.currentName);i&&i.then?i.then((function(){r(),t.$refs.nav&&t.$refs.nav.removeFocus()}),(function(){})):!1!==i&&r()}else r()}},render:function(e){var t,r=this.type,i=this.handleTabClick,n=this.handleTabRemove,o=this.handleTabAdd,s=this.currentName,a=this.panes,c=this.editable,l=this.addable,u=this.tabPosition,d=this.stretch,h=c||l?e("span",{class:"el-tabs__new-tab",on:{click:o,keydown:function(e){13===e.keyCode&&o()}},attrs:{tabindex:"0"}},[e("i",{class:"el-icon-plus"})]):null,p={props:{currentName:s,onTabClick:i,onTabRemove:n,editable:c,type:r,panes:a,stretch:d},ref:"nav"},f=e("div",{class:["el-tabs__header","is-"+u]},[h,e("tab-nav",p)]),g=e("div",{class:"el-tabs__content"},[this.$slots.default]);return e("div",{class:(t={"el-tabs":!0,"el-tabs--card":"card"===r},t["el-tabs--"+u]=!0,t["el-tabs--border-card"]="border-card"===r,t)},["bottom"!==u?[f,g]:[g,f]])},created:function(){this.currentName||this.setCurrentName("0"),this.$on("tab-nav-update",this.calcPaneInstances.bind(null,!0))},mounted:function(){this.calcPaneInstances()},updated:function(){this.calcPaneInstances()}},xc=Mc,Bc=a(xc,Lc,Pc,!1,null,null,null);Bc.options.__file="packages/tabs/src/tabs.vue";var Uc=Bc.exports;Uc.install=function(e){e.component(Uc.name,Uc)};var Fc=Uc,Vc=function(){var e=this,t=e.$createElement,r=e._self._c||t;return!e.lazy||e.loaded||e.active?r("div",{directives:[{name:"show",rawName:"v-show",value:e.active,expression:"active"}],staticClass:"el-tab-pane",attrs:{role:"tabpanel","aria-hidden":!e.active,id:"pane-"+e.paneName,"aria-labelledby":"tab-"+e.paneName}},[e._t("default")],2):e._e()},jc=[];Vc._withStripped=!0;var Gc={name:"ElTabPane",componentName:"ElTabPane",props:{label:String,labelContent:Function,name:String,closable:Boolean,disabled:Boolean,lazy:Boolean},data:function(){return{index:null,loaded:!1}},computed:{isClosable:function(){return this.closable||this.$parent.closable},active:function(){var e=this.$parent.currentName===(this.name||this.index);return e&&(this.loaded=!0),e},paneName:function(){return this.name||this.index}},updated:function(){this.$parent.$emit("tab-nav-update")}},Hc=Gc,Qc=a(Hc,Vc,jc,!1,null,null,null);Qc.options.__file="packages/tabs/src/tab-pane.vue";var Wc=Qc.exports;Wc.install=function(e){e.component(Wc.name,Wc)};var qc,zc,Zc=Wc,Yc={name:"ElTag",props:{text:String,closable:Boolean,type:String,hit:Boolean,disableTransitions:Boolean,color:String,size:String,effect:{type:String,default:"light",validator:function(e){return-1!==["dark","light","plain"].indexOf(e)}}},methods:{handleClose:function(e){e.stopPropagation(),this.$emit("close",e)},handleClick:function(e){this.$emit("click",e)}},computed:{tagSize:function(){return this.size||(this.$ELEMENT||{}).size}},render:function(e){var t=this.type,r=this.tagSize,i=this.hit,n=this.effect,o=["el-tag",t?"el-tag--"+t:"",r?"el-tag--"+r:"",n?"el-tag--"+n:"",i&&"is-hit"],s=e("span",{class:o,style:{backgroundColor:this.color},on:{click:this.handleClick}},[this.$slots.default,this.closable&&e("i",{class:"el-tag__close el-icon-close",on:{click:this.handleClose}})]);return this.disableTransitions?s:e("transition",{attrs:{name:"el-zoom-in-center"}},[s])}},Kc=Yc,$c=a(Kc,qc,zc,!1,null,null,null);$c.options.__file="packages/tag/src/tag.vue";var Jc=$c.exports;Jc.install=function(e){e.component(Jc.name,Jc)};var Xc=Jc,el=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-tree",class:{"el-tree--highlight-current":e.highlightCurrent,"is-dragging":!!e.dragState.draggingNode,"is-drop-not-allow":!e.dragState.allowDrop,"is-drop-inner":"inner"===e.dragState.dropType},attrs:{role:"tree"}},[e._l(e.root.childNodes,(function(t){return r("el-tree-node",{key:e.getNodeKey(t),attrs:{node:t,props:e.props,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,"render-content":e.renderContent},on:{"node-expand":e.handleNodeExpand}})})),e.isEmpty?r("div",{staticClass:"el-tree__empty-block"},[r("span",{staticClass:"el-tree__empty-text"},[e._v(e._s(e.emptyText))])]):e._e(),r("div",{directives:[{name:"show",rawName:"v-show",value:e.dragState.showDropIndicator,expression:"dragState.showDropIndicator"}],ref:"dropIndicator",staticClass:"el-tree__drop-indicator"})],2)},tl=[];el._withStripped=!0;var rl="$treeNodeId",il=function(e,t){t&&!t[rl]&&Object.defineProperty(t,rl,{value:e.id,enumerable:!1,configurable:!1,writable:!1})},nl=function(e,t){return e?t[e]:t[rl]},ol=function(e,t){var r=e;while(r&&"BODY"!==r.tagName){if(r.__vue__&&r.__vue__.$options.name===t)return r.__vue__;r=r.parentNode}return null},sl=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();function al(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var cl=function(e){for(var t=!0,r=!0,i=!0,n=0,o=e.length;n<o;n++){var s=e[n];(!0!==s.checked||s.indeterminate)&&(t=!1,s.disabled||(i=!1)),(!1!==s.checked||s.indeterminate)&&(r=!1)}return{all:t,none:r,allWithoutDisable:i,half:!t&&!r}},ll=function e(t){if(0!==t.childNodes.length){var r=cl(t.childNodes),i=r.all,n=r.none,o=r.half;i?(t.checked=!0,t.indeterminate=!1):o?(t.checked=!1,t.indeterminate=!0):n&&(t.checked=!1,t.indeterminate=!1);var s=t.parent;s&&0!==s.level&&(t.store.checkStrictly||e(s))}},ul=function(e,t){var r=e.store.props,i=e.data||{},n=r[t];if("function"===typeof n)return n(i,e);if("string"===typeof n)return i[n];if("undefined"===typeof n){var o=i[t];return void 0===o?"":o}},dl=0,hl=function(){function e(t){for(var r in al(this,e),this.id=dl++,this.text=null,this.checked=!1,this.indeterminate=!1,this.data=null,this.expanded=!1,this.parent=null,this.visible=!0,this.isCurrent=!1,t)t.hasOwnProperty(r)&&(this[r]=t[r]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1);var i=this.store;if(!i)throw new Error("[Node]store is required!");i.registerNode(this);var n=i.props;if(n&&"undefined"!==typeof n.isLeaf){var o=ul(this,"isLeaf");"boolean"===typeof o&&(this.isLeafByUser=o)}if(!0!==i.lazy&&this.data?(this.setData(this.data),i.defaultExpandAll&&(this.expanded=!0)):this.level>0&&i.lazy&&i.defaultExpandAll&&this.expand(),Array.isArray(this.data)||il(this,this.data),this.data){var s=i.defaultExpandedKeys,a=i.key;a&&s&&-1!==s.indexOf(this.key)&&this.expand(null,i.autoExpandParent),a&&void 0!==i.currentNodeKey&&this.key===i.currentNodeKey&&(i.currentNode=this,i.currentNode.isCurrent=!0),i.lazy&&i._initDefaultCheckedNode(this),this.updateLeafState()}}return e.prototype.setData=function(e){Array.isArray(e)||il(this,e),this.data=e,this.childNodes=[];var t=void 0;t=0===this.level&&this.data instanceof Array?this.data:ul(this,"children")||[];for(var r=0,i=t.length;r<i;r++)this.insertChild({data:t[r]})},e.prototype.contains=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=function r(i){for(var n=i.childNodes||[],o=!1,s=0,a=n.length;s<a;s++){var c=n[s];if(c===e||t&&r(c)){o=!0;break}}return o};return r(this)},e.prototype.remove=function(){var e=this.parent;e&&e.removeChild(this)},e.prototype.insertChild=function(t,r,i){if(!t)throw new Error("insertChild error: child is required.");if(!(t instanceof e)){if(!i){var n=this.getChildren(!0)||[];-1===n.indexOf(t.data)&&("undefined"===typeof r||r<0?n.push(t.data):n.splice(r,0,t.data))}bt()(t,{parent:this,store:this.store}),t=new e(t)}t.level=this.level+1,"undefined"===typeof r||r<0?this.childNodes.push(t):this.childNodes.splice(r,0,t),this.updateLeafState()},e.prototype.insertBefore=function(e,t){var r=void 0;t&&(r=this.childNodes.indexOf(t)),this.insertChild(e,r)},e.prototype.insertAfter=function(e,t){var r=void 0;t&&(r=this.childNodes.indexOf(t),-1!==r&&(r+=1)),this.insertChild(e,r)},e.prototype.removeChild=function(e){var t=this.getChildren()||[],r=t.indexOf(e.data);r>-1&&t.splice(r,1);var i=this.childNodes.indexOf(e);i>-1&&(this.store&&this.store.deregisterNode(e),e.parent=null,this.childNodes.splice(i,1)),this.updateLeafState()},e.prototype.removeChildByData=function(e){for(var t=null,r=0;r<this.childNodes.length;r++)if(this.childNodes[r].data===e){t=this.childNodes[r];break}t&&this.removeChild(t)},e.prototype.expand=function(e,t){var r=this,i=function(){if(t){var i=r.parent;while(i.level>0)i.expanded=!0,i=i.parent}r.expanded=!0,e&&e()};this.shouldLoadData()?this.loadData((function(e){e instanceof Array&&(r.checked?r.setChecked(!0,!0):r.store.checkStrictly||ll(r),i())})):i()},e.prototype.doCreateChildren=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.forEach((function(e){t.insertChild(bt()({data:e},r),void 0,!0)}))},e.prototype.collapse=function(){this.expanded=!1},e.prototype.shouldLoadData=function(){return!0===this.store.lazy&&this.store.load&&!this.loaded},e.prototype.updateLeafState=function(){if(!0!==this.store.lazy||!0===this.loaded||"undefined"===typeof this.isLeafByUser){var e=this.childNodes;!this.store.lazy||!0===this.store.lazy&&!0===this.loaded?this.isLeaf=!e||0===e.length:this.isLeaf=!1}else this.isLeaf=this.isLeafByUser},e.prototype.setChecked=function(e,t,r,i){var n=this;if(this.indeterminate="half"===e,this.checked=!0===e,!this.store.checkStrictly){if(!this.shouldLoadData()||this.store.checkDescendants){var o=cl(this.childNodes),s=o.all,a=o.allWithoutDisable;this.isLeaf||s||!a||(this.checked=!1,e=!1);var c=function(){if(t){for(var r=n.childNodes,o=0,s=r.length;o<s;o++){var a=r[o];i=i||!1!==e;var c=a.disabled?a.checked:i;a.setChecked(c,t,!0,i)}var l=cl(r),u=l.half,d=l.all;d||(n.checked=d,n.indeterminate=u)}};if(this.shouldLoadData())return void this.loadData((function(){c(),ll(n)}),{checked:!1!==e});c()}var l=this.parent;l&&0!==l.level&&(r||ll(l))}},e.prototype.getChildren=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(0===this.level)return this.data;var t=this.data;if(!t)return null;var r=this.store.props,i="children";return r&&(i=r.children||"children"),void 0===t[i]&&(t[i]=null),e&&!t[i]&&(t[i]=[]),t[i]},e.prototype.updateChildren=function(){var e=this,t=this.getChildren()||[],r=this.childNodes.map((function(e){return e.data})),i={},n=[];t.forEach((function(e,t){var o=e[rl],s=!!o&&Object(v["arrayFindIndex"])(r,(function(e){return e[rl]===o}))>=0;s?i[o]={index:t,data:e}:n.push({index:t,data:e})})),this.store.lazy||r.forEach((function(t){i[t[rl]]||e.removeChildByData(t)})),n.forEach((function(t){var r=t.index,i=t.data;e.insertChild({data:i},r)})),this.updateLeafState()},e.prototype.loadData=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!0!==this.store.lazy||!this.store.load||this.loaded||this.loading&&!Object.keys(r).length)e&&e.call(this);else{this.loading=!0;var i=function(i){t.loaded=!0,t.loading=!1,t.childNodes=[],t.doCreateChildren(i,r),t.updateLeafState(),e&&e.call(t,i)};this.store.load(this,i)}},sl(e,[{key:"label",get:function(){return ul(this,"label")}},{key:"key",get:function(){var e=this.store.key;return this.data?this.data[e]:null}},{key:"disabled",get:function(){return ul(this,"disabled")}},{key:"nextSibling",get:function(){var e=this.parent;if(e){var t=e.childNodes.indexOf(this);if(t>-1)return e.childNodes[t+1]}return null}},{key:"previousSibling",get:function(){var e=this.parent;if(e){var t=e.childNodes.indexOf(this);if(t>-1)return t>0?e.childNodes[t-1]:null}return null}}]),e}(),pl=hl,fl="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function gl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var ml=function(){function e(t){var r=this;for(var i in gl(this,e),this.currentNode=null,this.currentNodeKey=null,t)t.hasOwnProperty(i)&&(this[i]=t[i]);if(this.nodesMap={},this.root=new pl({data:this.data,store:this}),this.lazy&&this.load){var n=this.load;n(this.root,(function(e){r.root.doCreateChildren(e),r._initDefaultCheckedNodes()}))}else this._initDefaultCheckedNodes()}return e.prototype.filter=function(e){var t=this.filterNodeMethod,r=this.lazy,i=function i(n){var o=n.root?n.root.childNodes:n.childNodes;if(o.forEach((function(r){r.visible=t.call(r,e,r.data,r),i(r)})),!n.visible&&o.length){var s=!0;s=!o.some((function(e){return e.visible})),n.root?n.root.visible=!1===s:n.visible=!1===s}e&&(!n.visible||n.isLeaf||r||n.expand())};i(this)},e.prototype.setData=function(e){var t=e!==this.root.data;t?(this.root.setData(e),this._initDefaultCheckedNodes()):this.root.updateChildren()},e.prototype.getNode=function(e){if(e instanceof pl)return e;var t="object"!==("undefined"===typeof e?"undefined":fl(e))?e:nl(this.key,e);return this.nodesMap[t]||null},e.prototype.insertBefore=function(e,t){var r=this.getNode(t);r.parent.insertBefore({data:e},r)},e.prototype.insertAfter=function(e,t){var r=this.getNode(t);r.parent.insertAfter({data:e},r)},e.prototype.remove=function(e){var t=this.getNode(e);t&&t.parent&&(t===this.currentNode&&(this.currentNode=null),t.parent.removeChild(t))},e.prototype.append=function(e,t){var r=t?this.getNode(t):this.root;r&&r.insertChild({data:e})},e.prototype._initDefaultCheckedNodes=function(){var e=this,t=this.defaultCheckedKeys||[],r=this.nodesMap;t.forEach((function(t){var i=r[t];i&&i.setChecked(!0,!e.checkStrictly)}))},e.prototype._initDefaultCheckedNode=function(e){var t=this.defaultCheckedKeys||[];-1!==t.indexOf(e.key)&&e.setChecked(!0,!this.checkStrictly)},e.prototype.setDefaultCheckedKey=function(e){e!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=e,this._initDefaultCheckedNodes())},e.prototype.registerNode=function(e){var t=this.key;if(t&&e&&e.data){var r=e.key;void 0!==r&&(this.nodesMap[e.key]=e)}},e.prototype.deregisterNode=function(e){var t=this,r=this.key;r&&e&&e.data&&(e.childNodes.forEach((function(e){t.deregisterNode(e)})),delete this.nodesMap[e.key])},e.prototype.getCheckedNodes=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[],i=function i(n){var o=n.root?n.root.childNodes:n.childNodes;o.forEach((function(n){(n.checked||t&&n.indeterminate)&&(!e||e&&n.isLeaf)&&r.push(n.data),i(n)}))};return i(this),r},e.prototype.getCheckedKeys=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.getCheckedNodes(t).map((function(t){return(t||{})[e.key]}))},e.prototype.getHalfCheckedNodes=function(){var e=[],t=function t(r){var i=r.root?r.root.childNodes:r.childNodes;i.forEach((function(r){r.indeterminate&&e.push(r.data),t(r)}))};return t(this),e},e.prototype.getHalfCheckedKeys=function(){var e=this;return this.getHalfCheckedNodes().map((function(t){return(t||{})[e.key]}))},e.prototype._getAllNodes=function(){var e=[],t=this.nodesMap;for(var r in t)t.hasOwnProperty(r)&&e.push(t[r]);return e},e.prototype.updateChildren=function(e,t){var r=this.nodesMap[e];if(r){for(var i=r.childNodes,n=i.length-1;n>=0;n--){var o=i[n];this.remove(o.data)}for(var s=0,a=t.length;s<a;s++){var c=t[s];this.append(c,r.data)}}},e.prototype._setCheckedKeys=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments[2],i=this._getAllNodes().sort((function(e,t){return t.level-e.level})),n=Object.create(null),o=Object.keys(r);i.forEach((function(e){return e.setChecked(!1,!1)}));for(var s=0,a=i.length;s<a;s++){var c=i[s],l=c.data[e].toString(),u=o.indexOf(l)>-1;if(u){var d=c.parent;while(d&&d.level>0)n[d.data[e]]=!0,d=d.parent;c.isLeaf||this.checkStrictly?c.setChecked(!0,!1):(c.setChecked(!0,!0),t&&function(){c.setChecked(!1,!1);var e=function e(t){var r=t.childNodes;r.forEach((function(t){t.isLeaf||t.setChecked(!1,!1),e(t)}))};e(c)}())}else c.checked&&!n[l]&&c.setChecked(!1,!1)}},e.prototype.setCheckedNodes=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.key,i={};e.forEach((function(e){i[(e||{})[r]]=!0})),this._setCheckedKeys(r,t,i)},e.prototype.setCheckedKeys=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.defaultCheckedKeys=e;var r=this.key,i={};e.forEach((function(e){i[e]=!0})),this._setCheckedKeys(r,t,i)},e.prototype.setDefaultExpandedKeys=function(e){var t=this;e=e||[],this.defaultExpandedKeys=e,e.forEach((function(e){var r=t.getNode(e);r&&r.expand(null,t.autoExpandParent)}))},e.prototype.setChecked=function(e,t,r){var i=this.getNode(e);i&&i.setChecked(!!t,r)},e.prototype.getCurrentNode=function(){return this.currentNode},e.prototype.setCurrentNode=function(e){var t=this.currentNode;t&&(t.isCurrent=!1),this.currentNode=e,this.currentNode.isCurrent=!0},e.prototype.setUserCurrentNode=function(e){var t=e[this.key],r=this.nodesMap[t];this.setCurrentNode(r)},e.prototype.setCurrentNodeKey=function(e){if(null===e||void 0===e)return this.currentNode&&(this.currentNode.isCurrent=!1),void(this.currentNode=null);var t=this.getNode(e);t&&this.setCurrentNode(t)},e}(),_l=ml,vl=function(){var e=this,t=this,r=t.$createElement,i=t._self._c||r;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.node.visible,expression:"node.visible"}],ref:"node",staticClass:"el-tree-node",class:{"is-expanded":t.expanded,"is-current":t.node.isCurrent,"is-hidden":!t.node.visible,"is-focusable":!t.node.disabled,"is-checked":!t.node.disabled&&t.node.checked},attrs:{role:"treeitem",tabindex:"-1","aria-expanded":t.expanded,"aria-disabled":t.node.disabled,"aria-checked":t.node.checked,draggable:t.tree.draggable},on:{click:function(e){return e.stopPropagation(),t.handleClick(e)},contextmenu:function(t){return e.handleContextMenu(t)},dragstart:function(e){return e.stopPropagation(),t.handleDragStart(e)},dragover:function(e){return e.stopPropagation(),t.handleDragOver(e)},dragend:function(e){return e.stopPropagation(),t.handleDragEnd(e)},drop:function(e){return e.stopPropagation(),t.handleDrop(e)}}},[i("div",{staticClass:"el-tree-node__content",style:{"padding-left":(t.node.level-1)*t.tree.indent+"px"}},[i("span",{class:[{"is-leaf":t.node.isLeaf,expanded:!t.node.isLeaf&&t.expanded},"el-tree-node__expand-icon",t.tree.iconClass?t.tree.iconClass:"el-icon-caret-right"],on:{click:function(e){return e.stopPropagation(),t.handleExpandIconClick(e)}}}),t.showCheckbox?i("el-checkbox",{attrs:{indeterminate:t.node.indeterminate,disabled:!!t.node.disabled},on:{change:t.handleCheckChange},nativeOn:{click:function(e){e.stopPropagation()}},model:{value:t.node.checked,callback:function(e){t.$set(t.node,"checked",e)},expression:"node.checked"}}):t._e(),t.node.loading?i("span",{staticClass:"el-tree-node__loading-icon el-icon-loading"}):t._e(),i("node-content",{attrs:{node:t.node}})],1),i("el-collapse-transition",[!t.renderAfterExpand||t.childNodeRendered?i("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}],staticClass:"el-tree-node__children",attrs:{role:"group","aria-expanded":t.expanded}},t._l(t.node.childNodes,(function(e){return i("el-tree-node",{key:t.getNodeKey(e),attrs:{"render-content":t.renderContent,"render-after-expand":t.renderAfterExpand,"show-checkbox":t.showCheckbox,node:e},on:{"node-expand":t.handleChildNodeExpand}})})),1):t._e()])],1)},El=[];vl._withStripped=!0;var Al={name:"ElTreeNode",componentName:"ElTreeNode",mixins:[w.a],props:{node:{default:function(){return{}}},props:{},renderContent:Function,renderAfterExpand:{type:Boolean,default:!0},showCheckbox:{type:Boolean,default:!1}},components:{ElCollapseTransition:ze.a,ElCheckbox:Pi.a,NodeContent:{props:{node:{required:!0}},render:function(e){var t=this.$parent,r=t.tree,i=this.node,n=i.data,o=i.store;return t.renderContent?t.renderContent.call(t._renderProxy,e,{_self:r.$vnode.context,node:i,data:n,store:o}):r.$scopedSlots.default?r.$scopedSlots.default({node:i,data:n}):e("span",{class:"el-tree-node__label"},[i.label])}}},data:function(){return{tree:null,expanded:!1,childNodeRendered:!1,oldChecked:null,oldIndeterminate:null}},watch:{"node.indeterminate":function(e){this.handleSelectChange(this.node.checked,e)},"node.checked":function(e){this.handleSelectChange(e,this.node.indeterminate)},"node.expanded":function(e){var t=this;this.$nextTick((function(){return t.expanded=e})),e&&(this.childNodeRendered=!0)}},methods:{getNodeKey:function(e){return nl(this.tree.nodeKey,e.data)},handleSelectChange:function(e,t){this.oldChecked!==e&&this.oldIndeterminate!==t&&this.tree.$emit("check-change",this.node.data,e,t),this.oldChecked=e,this.indeterminate=t},handleClick:function(){var e=this.tree.store;e.setCurrentNode(this.node),this.tree.$emit("current-change",e.currentNode?e.currentNode.data:null,e.currentNode),this.tree.currentNode=this,this.tree.expandOnClickNode&&this.handleExpandIconClick(),this.tree.checkOnClickNode&&!this.node.disabled&&this.handleCheckChange(null,{target:{checked:!this.node.checked}}),this.tree.$emit("node-click",this.node.data,this.node,this)},handleContextMenu:function(e){this.tree._events["node-contextmenu"]&&this.tree._events["node-contextmenu"].length>0&&(e.stopPropagation(),e.preventDefault()),this.tree.$emit("node-contextmenu",e,this.node.data,this.node,this)},handleExpandIconClick:function(){this.node.isLeaf||(this.expanded?(this.tree.$emit("node-collapse",this.node.data,this.node,this),this.node.collapse()):(this.node.expand(),this.$emit("node-expand",this.node.data,this.node,this)))},handleCheckChange:function(e,t){var r=this;this.node.setChecked(t.target.checked,!this.tree.checkStrictly),this.$nextTick((function(){var e=r.tree.store;r.tree.$emit("check",r.node.data,{checkedNodes:e.getCheckedNodes(),checkedKeys:e.getCheckedKeys(),halfCheckedNodes:e.getHalfCheckedNodes(),halfCheckedKeys:e.getHalfCheckedKeys()})}))},handleChildNodeExpand:function(e,t,r){this.broadcast("ElTreeNode","tree-node-expand",t),this.tree.$emit("node-expand",e,t,r)},handleDragStart:function(e){this.tree.draggable&&this.tree.$emit("tree-node-drag-start",e,this)},handleDragOver:function(e){this.tree.draggable&&(this.tree.$emit("tree-node-drag-over",e,this),e.preventDefault())},handleDrop:function(e){e.preventDefault()},handleDragEnd:function(e){this.tree.draggable&&this.tree.$emit("tree-node-drag-end",e,this)}},created:function(){var e=this,t=this.$parent;t.isTree?this.tree=t:this.tree=t.tree;var r=this.tree;r||console.warn("Can not find node's tree.");var i=r.props||{},n=i["children"]||"children";this.$watch("node.data."+n,(function(){e.node.updateChildren()})),this.node.expanded&&(this.expanded=!0,this.childNodeRendered=!0),this.tree.accordion&&this.$on("tree-node-expand",(function(t){e.node!==t&&e.node.collapse()}))}},yl=Al,Sl=a(yl,vl,El,!1,null,null,null);Sl.options.__file="packages/tree/src/tree-node.vue";var Cl=Sl.exports,Tl={name:"ElTree",mixins:[w.a],components:{ElTreeNode:Cl},data:function(){return{store:null,root:null,currentNode:null,treeItems:null,checkboxItems:[],dragState:{showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0}}},props:{data:{type:Array},emptyText:{type:String,default:function(){return Object(fa["t"])("el.tree.emptyText")}},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkDescendants:{type:Boolean,default:!1},autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:Function,showCheckbox:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrag:Function,allowDrop:Function,props:{default:function(){return{children:"children",label:"label",disabled:"disabled"}}},lazy:{type:Boolean,default:!1},highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},iconClass:String},computed:{children:{set:function(e){this.data=e},get:function(){return this.data}},treeItemArray:function(){return Array.prototype.slice.call(this.treeItems)},isEmpty:function(){var e=this.root.childNodes;return!e||0===e.length||e.every((function(e){var t=e.visible;return!t}))}},watch:{defaultCheckedKeys:function(e){this.store.setDefaultCheckedKey(e)},defaultExpandedKeys:function(e){this.store.defaultExpandedKeys=e,this.store.setDefaultExpandedKeys(e)},data:function(e){this.store.setData(e)},checkboxItems:function(e){Array.prototype.forEach.call(e,(function(e){e.setAttribute("tabindex",-1)}))},checkStrictly:function(e){this.store.checkStrictly=e}},methods:{filter:function(e){if(!this.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");this.store.filter(e)},getNodeKey:function(e){return nl(this.nodeKey,e.data)},getNodePath:function(e){if(!this.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");var t=this.store.getNode(e);if(!t)return[];var r=[t.data],i=t.parent;while(i&&i!==this.root)r.push(i.data),i=i.parent;return r.reverse()},getCheckedNodes:function(e,t){return this.store.getCheckedNodes(e,t)},getCheckedKeys:function(e){return this.store.getCheckedKeys(e)},getCurrentNode:function(){var e=this.store.getCurrentNode();return e?e.data:null},getCurrentKey:function(){if(!this.nodeKey)throw new Error("[Tree] nodeKey is required in getCurrentKey");var e=this.getCurrentNode();return e?e[this.nodeKey]:null},setCheckedNodes:function(e,t){if(!this.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");this.store.setCheckedNodes(e,t)},setCheckedKeys:function(e,t){if(!this.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");this.store.setCheckedKeys(e,t)},setChecked:function(e,t,r){this.store.setChecked(e,t,r)},getHalfCheckedNodes:function(){return this.store.getHalfCheckedNodes()},getHalfCheckedKeys:function(){return this.store.getHalfCheckedKeys()},setCurrentNode:function(e){if(!this.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");this.store.setUserCurrentNode(e)},setCurrentKey:function(e){if(!this.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");this.store.setCurrentNodeKey(e)},getNode:function(e){return this.store.getNode(e)},remove:function(e){this.store.remove(e)},append:function(e,t){this.store.append(e,t)},insertBefore:function(e,t){this.store.insertBefore(e,t)},insertAfter:function(e,t){this.store.insertAfter(e,t)},handleNodeExpand:function(e,t,r){this.broadcast("ElTreeNode","tree-node-expand",t),this.$emit("node-expand",e,t,r)},updateKeyChildren:function(e,t){if(!this.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");this.store.updateChildren(e,t)},initTabIndex:function(){this.treeItems=this.$el.querySelectorAll(".is-focusable[role=treeitem]"),this.checkboxItems=this.$el.querySelectorAll("input[type=checkbox]");var e=this.$el.querySelectorAll(".is-checked[role=treeitem]");e.length?e[0].setAttribute("tabindex",0):this.treeItems[0]&&this.treeItems[0].setAttribute("tabindex",0)},handleKeydown:function(e){var t=e.target;if(-1!==t.className.indexOf("el-tree-node")){var r=e.keyCode;this.treeItems=this.$el.querySelectorAll(".is-focusable[role=treeitem]");var i=this.treeItemArray.indexOf(t),n=void 0;[38,40].indexOf(r)>-1&&(e.preventDefault(),n=38===r?0!==i?i-1:0:i<this.treeItemArray.length-1?i+1:0,this.treeItemArray[n].focus()),[37,39].indexOf(r)>-1&&(e.preventDefault(),t.click());var o=t.querySelector('[type="checkbox"]');[13,32].indexOf(r)>-1&&o&&(e.preventDefault(),o.click())}}},created:function(){var e=this;this.isTree=!0,this.store=new _l({key:this.nodeKey,data:this.data,lazy:this.lazy,props:this.props,load:this.load,currentNodeKey:this.currentNodeKey,checkStrictly:this.checkStrictly,checkDescendants:this.checkDescendants,defaultCheckedKeys:this.defaultCheckedKeys,defaultExpandedKeys:this.defaultExpandedKeys,autoExpandParent:this.autoExpandParent,defaultExpandAll:this.defaultExpandAll,filterNodeMethod:this.filterNodeMethod}),this.root=this.store.root;var t=this.dragState;this.$on("tree-node-drag-start",(function(r,i){if("function"===typeof e.allowDrag&&!e.allowDrag(i.node))return r.preventDefault(),!1;r.dataTransfer.effectAllowed="move";try{r.dataTransfer.setData("text/plain","")}catch(n){}t.draggingNode=i,e.$emit("node-drag-start",i.node,r)})),this.$on("tree-node-drag-over",(function(r,i){var n=ol(r.target,"ElTreeNode"),o=t.dropNode;o&&o!==n&&Object(Ue["removeClass"])(o.$el,"is-drop-inner");var s=t.draggingNode;if(s&&n){var a=!0,c=!0,l=!0,u=!0;"function"===typeof e.allowDrop&&(a=e.allowDrop(s.node,n.node,"prev"),u=c=e.allowDrop(s.node,n.node,"inner"),l=e.allowDrop(s.node,n.node,"next")),r.dataTransfer.dropEffect=c?"move":"none",(a||c||l)&&o!==n&&(o&&e.$emit("node-drag-leave",s.node,o.node,r),e.$emit("node-drag-enter",s.node,n.node,r)),(a||c||l)&&(t.dropNode=n),n.node.nextSibling===s.node&&(l=!1),n.node.previousSibling===s.node&&(a=!1),n.node.contains(s.node,!1)&&(c=!1),(s.node===n.node||s.node.contains(n.node))&&(a=!1,c=!1,l=!1);var d=n.$el.getBoundingClientRect(),h=e.$el.getBoundingClientRect(),p=void 0,f=a?c?.25:l?.45:1:-1,g=l?c?.75:a?.55:0:1,m=-9999,_=r.clientY-d.top;p=_<d.height*f?"before":_>d.height*g?"after":c?"inner":"none";var v=n.$el.querySelector(".el-tree-node__expand-icon").getBoundingClientRect(),E=e.$refs.dropIndicator;"before"===p?m=v.top-h.top:"after"===p&&(m=v.bottom-h.top),E.style.top=m+"px",E.style.left=v.right-h.left+"px","inner"===p?Object(Ue["addClass"])(n.$el,"is-drop-inner"):Object(Ue["removeClass"])(n.$el,"is-drop-inner"),t.showDropIndicator="before"===p||"after"===p,t.allowDrop=t.showDropIndicator||u,t.dropType=p,e.$emit("node-drag-over",s.node,n.node,r)}})),this.$on("tree-node-drag-end",(function(r){var i=t.draggingNode,n=t.dropType,o=t.dropNode;if(r.preventDefault(),r.dataTransfer.dropEffect="move",i&&o){var s={data:i.node.data};"none"!==n&&i.node.remove(),"before"===n?o.node.parent.insertBefore(s,o.node):"after"===n?o.node.parent.insertAfter(s,o.node):"inner"===n&&o.node.insertChild(s),"none"!==n&&e.store.registerNode(s),Object(Ue["removeClass"])(o.$el,"is-drop-inner"),e.$emit("node-drag-end",i.node,o.node,n,r),"none"!==n&&e.$emit("node-drop",i.node,o.node,n,r)}i&&!o&&e.$emit("node-drag-end",i.node,null,n,r),t.showDropIndicator=!1,t.draggingNode=null,t.dropNode=null,t.allowDrop=!0}))},mounted:function(){this.initTabIndex(),this.$el.addEventListener("keydown",this.handleKeydown)},updated:function(){this.treeItems=this.$el.querySelectorAll("[role=treeitem]"),this.checkboxItems=this.$el.querySelectorAll("input[type=checkbox]")}},bl=Tl,Il=a(bl,el,tl,!1,null,null,null);Il.options.__file="packages/tree/src/tree.vue";var Rl=Il.exports;Rl.install=function(e){e.component(Rl.name,Rl)};var wl=Rl,kl=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition",{attrs:{name:"el-alert-fade"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"el-alert",class:[e.typeClass,e.center?"is-center":"","is-"+e.effect],attrs:{role:"alert"}},[e.showIcon?r("i",{staticClass:"el-alert__icon",class:[e.iconClass,e.isBigIcon]}):e._e(),r("div",{staticClass:"el-alert__content"},[e.title||e.$slots.title?r("span",{staticClass:"el-alert__title",class:[e.isBoldTitle]},[e._t("title",[e._v(e._s(e.title))])],2):e._e(),e.$slots.default&&!e.description?r("p",{staticClass:"el-alert__description"},[e._t("default")],2):e._e(),e.description&&!e.$slots.default?r("p",{staticClass:"el-alert__description"},[e._v(e._s(e.description))]):e._e(),r("i",{directives:[{name:"show",rawName:"v-show",value:e.closable,expression:"closable"}],staticClass:"el-alert__closebtn",class:{"is-customed":""!==e.closeText,"el-icon-close":""===e.closeText},on:{click:function(t){e.close()}}},[e._v(e._s(e.closeText))])])])])},Ol=[];kl._withStripped=!0;var Nl={success:"el-icon-success",warning:"el-icon-warning",error:"el-icon-error"},Ll={name:"ElAlert",props:{title:{type:String,default:""},description:{type:String,default:""},type:{type:String,default:"info"},closable:{type:Boolean,default:!0},closeText:{type:String,default:""},showIcon:Boolean,center:Boolean,effect:{type:String,default:"light",validator:function(e){return-1!==["light","dark"].indexOf(e)}}},data:function(){return{visible:!0}},methods:{close:function(){this.visible=!1,this.$emit("close")}},computed:{typeClass:function(){return"el-alert--"+this.type},iconClass:function(){return Nl[this.type]||"el-icon-info"},isBigIcon:function(){return this.description||this.$slots.default?"is-big":""},isBoldTitle:function(){return this.description||this.$slots.default?"is-bold":""}}},Pl=Ll,Dl=a(Pl,kl,Ol,!1,null,null,null);Dl.options.__file="packages/alert/src/main.vue";var Ml=Dl.exports;Ml.install=function(e){e.component(Ml.name,Ml)};var xl=Ml,Bl=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition",{attrs:{name:"el-notification-fade"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],class:["el-notification",e.customClass,e.horizontalClass],style:e.positionStyle,attrs:{role:"alert"},on:{mouseenter:function(t){e.clearTimer()},mouseleave:function(t){e.startTimer()},click:e.click}},[e.type||e.iconClass?r("i",{staticClass:"el-notification__icon",class:[e.typeClass,e.iconClass]}):e._e(),r("div",{staticClass:"el-notification__group",class:{"is-with-icon":e.typeClass||e.iconClass}},[r("h2",{staticClass:"el-notification__title",domProps:{textContent:e._s(e.title)}}),r("div",{directives:[{name:"show",rawName:"v-show",value:e.message,expression:"message"}],staticClass:"el-notification__content"},[e._t("default",[e.dangerouslyUseHTMLString?r("p",{domProps:{innerHTML:e._s(e.message)}}):r("p",[e._v(e._s(e.message))])])],2),e.showClose?r("div",{staticClass:"el-notification__closeBtn el-icon-close",on:{click:function(t){return t.stopPropagation(),e.close(t)}}}):e._e()])])])},Ul=[];Bl._withStripped=!0;var Fl={success:"success",info:"info",warning:"warning",error:"error"},Vl={data:function(){return{visible:!1,title:"",message:"",duration:4500,type:"",showClose:!0,customClass:"",iconClass:"",onClose:null,onClick:null,closed:!1,verticalOffset:0,timer:null,dangerouslyUseHTMLString:!1,position:"top-right"}},computed:{typeClass:function(){return this.type&&Fl[this.type]?"el-icon-"+Fl[this.type]:""},horizontalClass:function(){return this.position.indexOf("right")>-1?"right":"left"},verticalProperty:function(){return/^top-/.test(this.position)?"top":"bottom"},positionStyle:function(){var e;return e={},e[this.verticalProperty]=this.verticalOffset+"px",e}},watch:{closed:function(e){e&&(this.visible=!1,this.$el.addEventListener("transitionend",this.destroyElement))}},methods:{destroyElement:function(){this.$el.removeEventListener("transitionend",this.destroyElement),this.$destroy(!0),this.$el.parentNode.removeChild(this.$el)},click:function(){"function"===typeof this.onClick&&this.onClick()},close:function(){this.closed=!0,"function"===typeof this.onClose&&this.onClose()},clearTimer:function(){clearTimeout(this.timer)},startTimer:function(){var e=this;this.duration>0&&(this.timer=setTimeout((function(){e.closed||e.close()}),this.duration))},keydown:function(e){46===e.keyCode||8===e.keyCode?this.clearTimer():27===e.keyCode?this.closed||this.close():this.startTimer()}},mounted:function(){var e=this;this.duration>0&&(this.timer=setTimeout((function(){e.closed||e.close()}),this.duration)),document.addEventListener("keydown",this.keydown)},beforeDestroy:function(){document.removeEventListener("keydown",this.keydown)}},jl=Vl,Gl=a(jl,Bl,Ul,!1,null,null,null);Gl.options.__file="packages/notification/src/main.vue";var Hl=Gl.exports,Ql=ji.a.extend(Hl),Wl=void 0,ql=[],zl=1,Zl=function e(t){if(!ji.a.prototype.$isServer){t=bt()({},t);var r=t.onClose,i="notification_"+zl++,n=t.position||"top-right";t.onClose=function(){e.close(i,r)},Wl=new Ql({data:t}),Object(Ta["isVNode"])(t.message)&&(Wl.$slots.default=[t.message],t.message="REPLACED_BY_VNODE"),Wl.id=i,Wl.$mount(),document.body.appendChild(Wl.$el),Wl.visible=!0,Wl.dom=Wl.$el,Wl.dom.style.zIndex=C["PopupManager"].nextZIndex();var o=t.offset||0;return ql.filter((function(e){return e.position===n})).forEach((function(e){o+=e.$el.offsetHeight+16})),o+=16,Wl.verticalOffset=o,ql.push(Wl),Wl}};["success","warning","info","error"].forEach((function(e){Zl[e]=function(t){return("string"===typeof t||Object(Ta["isVNode"])(t))&&(t={message:t}),t.type=e,Zl(t)}})),Zl.close=function(e,t){var r=-1,i=ql.length,n=ql.filter((function(t,i){return t.id===e&&(r=i,!0)}))[0];if(n&&("function"===typeof t&&t(n),ql.splice(r,1),!(i<=1)))for(var o=n.position,s=n.dom.offsetHeight,a=r;a<i-1;a++)ql[a].position===o&&(ql[a].dom.style[n.verticalProperty]=parseInt(ql[a].dom.style[n.verticalProperty],10)-s-16+"px")},Zl.closeAll=function(){for(var e=ql.length-1;e>=0;e--)ql[e].close()};var Yl=Zl,Kl=Yl,$l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-slider",class:{"is-vertical":e.vertical,"el-slider--with-input":e.showInput},attrs:{role:"slider","aria-valuemin":e.min,"aria-valuemax":e.max,"aria-orientation":e.vertical?"vertical":"horizontal","aria-disabled":e.sliderDisabled}},[e.showInput&&!e.range?r("el-input-number",{ref:"input",staticClass:"el-slider__input",attrs:{step:e.step,disabled:e.sliderDisabled,controls:e.showInputControls,min:e.min,max:e.max,debounce:e.debounce,size:e.inputSize},on:{change:e.emitChange},model:{value:e.firstValue,callback:function(t){e.firstValue=t},expression:"firstValue"}}):e._e(),r("div",{ref:"slider",staticClass:"el-slider__runway",class:{"show-input":e.showInput,disabled:e.sliderDisabled},style:e.runwayStyle,on:{click:e.onSliderClick}},[r("div",{staticClass:"el-slider__bar",style:e.barStyle}),r("slider-button",{ref:"button1",attrs:{vertical:e.vertical,"tooltip-class":e.tooltipClass},model:{value:e.firstValue,callback:function(t){e.firstValue=t},expression:"firstValue"}}),e.range?r("slider-button",{ref:"button2",attrs:{vertical:e.vertical,"tooltip-class":e.tooltipClass},model:{value:e.secondValue,callback:function(t){e.secondValue=t},expression:"secondValue"}}):e._e(),e._l(e.stops,(function(t,i){return e.showStops?r("div",{key:i,staticClass:"el-slider__stop",style:e.getStopStyle(t)}):e._e()})),e.markList.length>0?[r("div",e._l(e.markList,(function(t,i){return r("div",{key:i,staticClass:"el-slider__stop el-slider__marks-stop",style:e.getStopStyle(t.position)})})),0),r("div",{staticClass:"el-slider__marks"},e._l(e.markList,(function(t,i){return r("slider-marker",{key:i,style:e.getStopStyle(t.position),attrs:{mark:t.mark}})})),1)]:e._e()],2)],1)},Jl=[];$l._withStripped=!0;var Xl=r(41),eu=r.n(Xl),tu=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"button",staticClass:"el-slider__button-wrapper",class:{hover:e.hovering,dragging:e.dragging},style:e.wrapperStyle,attrs:{tabindex:"0"},on:{mouseenter:e.handleMouseEnter,mouseleave:e.handleMouseLeave,mousedown:e.onButtonDown,touchstart:e.onButtonDown,focus:e.handleMouseEnter,blur:e.handleMouseLeave,keydown:[function(t){return!("button"in t)&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])||"button"in t&&0!==t.button?null:e.onLeftKeyDown(t)},function(t){return!("button"in t)&&e._k(t.keyCode,"right",39,t.key,["Right","ArrowRight"])||"button"in t&&2!==t.button?null:e.onRightKeyDown(t)},function(t){return!("button"in t)&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:(t.preventDefault(),e.onLeftKeyDown(t))},function(t){return!("button"in t)&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:(t.preventDefault(),e.onRightKeyDown(t))}]}},[r("el-tooltip",{ref:"tooltip",attrs:{placement:"top","popper-class":e.tooltipClass,disabled:!e.showTooltip}},[r("span",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.formatValue))]),r("div",{staticClass:"el-slider__button",class:{hover:e.hovering,dragging:e.dragging}})])],1)},ru=[];tu._withStripped=!0;var iu={name:"ElSliderButton",components:{ElTooltip:nt.a},props:{value:{type:Number,default:0},vertical:{type:Boolean,default:!1},tooltipClass:String},data:function(){return{hovering:!1,dragging:!1,isClick:!1,startX:0,currentX:0,startY:0,currentY:0,startPosition:0,newPosition:null,oldValue:this.value}},computed:{disabled:function(){return this.$parent.sliderDisabled},max:function(){return this.$parent.max},min:function(){return this.$parent.min},step:function(){return this.$parent.step},showTooltip:function(){return this.$parent.showTooltip},precision:function(){return this.$parent.precision},currentPosition:function(){return(this.value-this.min)/(this.max-this.min)*100+"%"},enableFormat:function(){return this.$parent.formatTooltip instanceof Function},formatValue:function(){return this.enableFormat&&this.$parent.formatTooltip(this.value)||this.value},wrapperStyle:function(){return this.vertical?{bottom:this.currentPosition}:{left:this.currentPosition}}},watch:{dragging:function(e){this.$parent.dragging=e}},methods:{displayTooltip:function(){this.$refs.tooltip&&(this.$refs.tooltip.showPopper=!0)},hideTooltip:function(){this.$refs.tooltip&&(this.$refs.tooltip.showPopper=!1)},handleMouseEnter:function(){this.hovering=!0,this.displayTooltip()},handleMouseLeave:function(){this.hovering=!1,this.hideTooltip()},onButtonDown:function(e){this.disabled||(e.preventDefault(),this.onDragStart(e),window.addEventListener("mousemove",this.onDragging),window.addEventListener("touchmove",this.onDragging),window.addEventListener("mouseup",this.onDragEnd),window.addEventListener("touchend",this.onDragEnd),window.addEventListener("contextmenu",this.onDragEnd))},onLeftKeyDown:function(){this.disabled||(this.newPosition=parseFloat(this.currentPosition)-this.step/(this.max-this.min)*100,this.setPosition(this.newPosition),this.$parent.emitChange())},onRightKeyDown:function(){this.disabled||(this.newPosition=parseFloat(this.currentPosition)+this.step/(this.max-this.min)*100,this.setPosition(this.newPosition),this.$parent.emitChange())},onDragStart:function(e){this.dragging=!0,this.isClick=!0,"touchstart"===e.type&&(e.clientY=e.touches[0].clientY,e.clientX=e.touches[0].clientX),this.vertical?this.startY=e.clientY:this.startX=e.clientX,this.startPosition=parseFloat(this.currentPosition),this.newPosition=this.startPosition},onDragging:function(e){if(this.dragging){this.isClick=!1,this.displayTooltip(),this.$parent.resetSize();var t=0;"touchmove"===e.type&&(e.clientY=e.touches[0].clientY,e.clientX=e.touches[0].clientX),this.vertical?(this.currentY=e.clientY,t=(this.startY-this.currentY)/this.$parent.sliderSize*100):(this.currentX=e.clientX,t=(this.currentX-this.startX)/this.$parent.sliderSize*100),this.newPosition=this.startPosition+t,this.setPosition(this.newPosition)}},onDragEnd:function(){var e=this;this.dragging&&(setTimeout((function(){e.dragging=!1,e.hideTooltip(),e.isClick||(e.setPosition(e.newPosition),e.$parent.emitChange())}),0),window.removeEventListener("mousemove",this.onDragging),window.removeEventListener("touchmove",this.onDragging),window.removeEventListener("mouseup",this.onDragEnd),window.removeEventListener("touchend",this.onDragEnd),window.removeEventListener("contextmenu",this.onDragEnd))},setPosition:function(e){var t=this;if(null!==e&&!isNaN(e)){e<0?e=0:e>100&&(e=100);var r=100/((this.max-this.min)/this.step),i=Math.round(e/r),n=i*r*(this.max-this.min)*.01+this.min;n=parseFloat(n.toFixed(this.precision)),this.$emit("input",n),this.$nextTick((function(){t.displayTooltip(),t.$refs.tooltip&&t.$refs.tooltip.updatePopper()})),this.dragging||this.value===this.oldValue||(this.oldValue=this.value)}}}},nu=iu,ou=a(nu,tu,ru,!1,null,null,null);ou.options.__file="packages/slider/src/button.vue";var su=ou.exports,au={name:"ElMarker",props:{mark:{type:[String,Object]}},render:function(){var e=arguments[0],t="string"===typeof this.mark?this.mark:this.mark.label;return e("div",{class:"el-slider__marks-text",style:this.mark.style||{}},[t])}},cu={name:"ElSlider",mixins:[w.a],inject:{elForm:{default:""}},props:{min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},value:{type:[Number,Array],default:0},showInput:{type:Boolean,default:!1},showInputControls:{type:Boolean,default:!0},inputSize:{type:String,default:"small"},showStops:{type:Boolean,default:!1},showTooltip:{type:Boolean,default:!0},formatTooltip:Function,disabled:{type:Boolean,default:!1},range:{type:Boolean,default:!1},vertical:{type:Boolean,default:!1},height:{type:String},debounce:{type:Number,default:300},label:{type:String},tooltipClass:String,marks:Object},components:{ElInputNumber:eu.a,SliderButton:su,SliderMarker:au},data:function(){return{firstValue:null,secondValue:null,oldValue:null,dragging:!1,sliderSize:1}},watch:{value:function(e,t){this.dragging||Array.isArray(e)&&Array.isArray(t)&&e.every((function(e,r){return e===t[r]}))||this.setValues()},dragging:function(e){e||this.setValues()},firstValue:function(e){this.range?this.$emit("input",[this.minValue,this.maxValue]):this.$emit("input",e)},secondValue:function(){this.range&&this.$emit("input",[this.minValue,this.maxValue])},min:function(){this.setValues()},max:function(){this.setValues()}},methods:{valueChanged:function(){var e=this;return this.range?![this.minValue,this.maxValue].every((function(t,r){return t===e.oldValue[r]})):this.value!==this.oldValue},setValues:function(){if(this.min>this.max)console.error("[Element Error][Slider]min should not be greater than max.");else{var e=this.value;this.range&&Array.isArray(e)?e[1]<this.min?this.$emit("input",[this.min,this.min]):e[0]>this.max?this.$emit("input",[this.max,this.max]):e[0]<this.min?this.$emit("input",[this.min,e[1]]):e[1]>this.max?this.$emit("input",[e[0],this.max]):(this.firstValue=e[0],this.secondValue=e[1],this.valueChanged()&&(this.dispatch("ElFormItem","el.form.change",[this.minValue,this.maxValue]),this.oldValue=e.slice())):this.range||"number"!==typeof e||isNaN(e)||(e<this.min?this.$emit("input",this.min):e>this.max?this.$emit("input",this.max):(this.firstValue=e,this.valueChanged()&&(this.dispatch("ElFormItem","el.form.change",e),this.oldValue=e)))}},setPosition:function(e){var t=this.min+e*(this.max-this.min)/100;if(this.range){var r=void 0;r=Math.abs(this.minValue-t)<Math.abs(this.maxValue-t)?this.firstValue<this.secondValue?"button1":"button2":this.firstValue>this.secondValue?"button1":"button2",this.$refs[r].setPosition(e)}else this.$refs.button1.setPosition(e)},onSliderClick:function(e){if(!this.sliderDisabled&&!this.dragging){if(this.resetSize(),this.vertical){var t=this.$refs.slider.getBoundingClientRect().bottom;this.setPosition((t-e.clientY)/this.sliderSize*100)}else{var r=this.$refs.slider.getBoundingClientRect().left;this.setPosition((e.clientX-r)/this.sliderSize*100)}this.emitChange()}},resetSize:function(){this.$refs.slider&&(this.sliderSize=this.$refs.slider["client"+(this.vertical?"Height":"Width")])},emitChange:function(){var e=this;this.$nextTick((function(){e.$emit("change",e.range?[e.minValue,e.maxValue]:e.value)}))},getStopStyle:function(e){return this.vertical?{bottom:e+"%"}:{left:e+"%"}}},computed:{stops:function(){var e=this;if(!this.showStops||this.min>this.max)return[];if(0===this.step)return[];for(var t=(this.max-this.min)/this.step,r=100*this.step/(this.max-this.min),i=[],n=1;n<t;n++)i.push(n*r);return this.range?i.filter((function(t){return t<100*(e.minValue-e.min)/(e.max-e.min)||t>100*(e.maxValue-e.min)/(e.max-e.min)})):i.filter((function(t){return t>100*(e.firstValue-e.min)/(e.max-e.min)}))},markList:function(){var e=this;if(!this.marks)return[];var t=Object.keys(this.marks);return t.map(parseFloat).sort((function(e,t){return e-t})).filter((function(t){return t<=e.max&&t>=e.min})).map((function(t){return{point:t,position:100*(t-e.min)/(e.max-e.min),mark:e.marks[t]}}))},minValue:function(){return Math.min(this.firstValue,this.secondValue)},maxValue:function(){return Math.max(this.firstValue,this.secondValue)},barSize:function(){return this.range?100*(this.maxValue-this.minValue)/(this.max-this.min)+"%":100*(this.firstValue-this.min)/(this.max-this.min)+"%"},barStart:function(){return this.range?100*(this.minValue-this.min)/(this.max-this.min)+"%":"0%"},precision:function(){var e=[this.min,this.max,this.step].map((function(e){var t=(""+e).split(".")[1];return t?t.length:0}));return Math.max.apply(null,e)},runwayStyle:function(){return this.vertical?{height:this.height}:{}},barStyle:function(){return this.vertical?{height:this.barSize,bottom:this.barStart}:{width:this.barSize,left:this.barStart}},sliderDisabled:function(){return this.disabled||(this.elForm||{}).disabled}},mounted:function(){var e=void 0;this.range?(Array.isArray(this.value)?(this.firstValue=Math.max(this.min,this.value[0]),this.secondValue=Math.min(this.max,this.value[1])):(this.firstValue=this.min,this.secondValue=this.max),this.oldValue=[this.firstValue,this.secondValue],e=this.firstValue+"-"+this.secondValue):("number"!==typeof this.value||isNaN(this.value)?this.firstValue=this.min:this.firstValue=Math.min(this.max,Math.max(this.min,this.value)),this.oldValue=this.firstValue,e=this.firstValue),this.$el.setAttribute("aria-valuetext",e),this.$el.setAttribute("aria-label",this.label?this.label:"slider between "+this.min+" and "+this.max),this.resetSize(),window.addEventListener("resize",this.resetSize)},beforeDestroy:function(){window.removeEventListener("resize",this.resetSize)}},lu=cu,uu=a(lu,$l,Jl,!1,null,null,null);uu.options.__file="packages/slider/src/main.vue";var du=uu.exports;du.install=function(e){e.component(du.name,du)};var hu=du,pu=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition",{attrs:{name:"el-loading-fade"},on:{"after-leave":e.handleAfterLeave}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"el-loading-mask",class:[e.customClass,{"is-fullscreen":e.fullscreen}],style:{backgroundColor:e.background||""}},[r("div",{staticClass:"el-loading-spinner"},[e.spinner?r("i",{class:e.spinner}):r("svg",{staticClass:"circular",attrs:{viewBox:"25 25 50 50"}},[r("circle",{staticClass:"path",attrs:{cx:"50",cy:"50",r:"20",fill:"none"}})]),e.text?r("p",{staticClass:"el-loading-text"},[e._v(e._s(e.text))]):e._e()])])])},fu=[];pu._withStripped=!0;var gu={data:function(){return{text:null,spinner:null,background:null,fullscreen:!0,visible:!1,customClass:""}},methods:{handleAfterLeave:function(){this.$emit("after-leave")},setText:function(e){this.text=e}}},mu=gu,_u=a(mu,pu,fu,!1,null,null,null);_u.options.__file="packages/loading/src/loading.vue";var vu=_u.exports,Eu=r(32),Au=r.n(Eu),yu=ji.a.extend(vu),Su={install:function(e){if(!e.prototype.$isServer){var t=function(t,i){i.value?e.nextTick((function(){i.modifiers.fullscreen?(t.originalPosition=Object(Ue["getStyle"])(document.body,"position"),t.originalOverflow=Object(Ue["getStyle"])(document.body,"overflow"),t.maskStyle.zIndex=C["PopupManager"].nextZIndex(),Object(Ue["addClass"])(t.mask,"is-fullscreen"),r(document.body,t,i)):(Object(Ue["removeClass"])(t.mask,"is-fullscreen"),i.modifiers.body?(t.originalPosition=Object(Ue["getStyle"])(document.body,"position"),["top","left"].forEach((function(e){var r="top"===e?"scrollTop":"scrollLeft";t.maskStyle[e]=t.getBoundingClientRect()[e]+document.body[r]+document.documentElement[r]-parseInt(Object(Ue["getStyle"])(document.body,"margin-"+e),10)+"px"})),["height","width"].forEach((function(e){t.maskStyle[e]=t.getBoundingClientRect()[e]+"px"})),r(document.body,t,i)):(t.originalPosition=Object(Ue["getStyle"])(t,"position"),r(t,t,i)))})):(Au()(t.instance,(function(e){if(t.instance.hiding){t.domVisible=!1;var r=i.modifiers.fullscreen||i.modifiers.body?document.body:t;Object(Ue["removeClass"])(r,"el-loading-parent--relative"),Object(Ue["removeClass"])(r,"el-loading-parent--hidden"),t.instance.hiding=!1}}),300,!0),t.instance.visible=!1,t.instance.hiding=!0)},r=function(t,r,i){r.domVisible||"none"===Object(Ue["getStyle"])(r,"display")||"hidden"===Object(Ue["getStyle"])(r,"visibility")?r.domVisible&&!0===r.instance.hiding&&(r.instance.visible=!0,r.instance.hiding=!1):(Object.keys(r.maskStyle).forEach((function(e){r.mask.style[e]=r.maskStyle[e]})),"absolute"!==r.originalPosition&&"fixed"!==r.originalPosition&&Object(Ue["addClass"])(t,"el-loading-parent--relative"),i.modifiers.fullscreen&&i.modifiers.lock&&Object(Ue["addClass"])(t,"el-loading-parent--hidden"),r.domVisible=!0,t.appendChild(r.mask),e.nextTick((function(){r.instance.hiding?r.instance.$emit("after-leave"):r.instance.visible=!0})),r.domInserted=!0)};e.directive("loading",{bind:function(e,r,i){var n=e.getAttribute("element-loading-text"),o=e.getAttribute("element-loading-spinner"),s=e.getAttribute("element-loading-background"),a=e.getAttribute("element-loading-custom-class"),c=i.context,l=new yu({el:document.createElement("div"),data:{text:c&&c[n]||n,spinner:c&&c[o]||o,background:c&&c[s]||s,customClass:c&&c[a]||a,fullscreen:!!r.modifiers.fullscreen}});e.instance=l,e.mask=l.$el,e.maskStyle={},r.value&&t(e,r)},update:function(e,r){e.instance.setText(e.getAttribute("element-loading-text")),r.oldValue!==r.value&&t(e,r)},unbind:function(e,r){e.domInserted&&(e.mask&&e.mask.parentNode&&e.mask.parentNode.removeChild(e.mask),t(e,{value:!1,modifiers:r.modifiers})),e.instance&&e.instance.$destroy()}})}}},Cu=Su,Tu=ji.a.extend(vu),bu={text:null,fullscreen:!0,body:!1,lock:!1,customClass:""},Iu=void 0;Tu.prototype.originalPosition="",Tu.prototype.originalOverflow="",Tu.prototype.close=function(){var e=this;this.fullscreen&&(Iu=void 0),Au()(this,(function(t){var r=e.fullscreen||e.body?document.body:e.target;Object(Ue["removeClass"])(r,"el-loading-parent--relative"),Object(Ue["removeClass"])(r,"el-loading-parent--hidden"),e.$el&&e.$el.parentNode&&e.$el.parentNode.removeChild(e.$el),e.$destroy()}),300),this.visible=!1};var Ru=function(e,t,r){var i={};e.fullscreen?(r.originalPosition=Object(Ue["getStyle"])(document.body,"position"),r.originalOverflow=Object(Ue["getStyle"])(document.body,"overflow"),i.zIndex=C["PopupManager"].nextZIndex()):e.body?(r.originalPosition=Object(Ue["getStyle"])(document.body,"position"),["top","left"].forEach((function(t){var r="top"===t?"scrollTop":"scrollLeft";i[t]=e.target.getBoundingClientRect()[t]+document.body[r]+document.documentElement[r]+"px"})),["height","width"].forEach((function(t){i[t]=e.target.getBoundingClientRect()[t]+"px"}))):r.originalPosition=Object(Ue["getStyle"])(t,"position"),Object.keys(i).forEach((function(e){r.$el.style[e]=i[e]}))},wu=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!ji.a.prototype.$isServer){if(e=bt()({},bu,e),"string"===typeof e.target&&(e.target=document.querySelector(e.target)),e.target=e.target||document.body,e.target!==document.body?e.fullscreen=!1:e.body=!0,e.fullscreen&&Iu)return Iu;var t=e.body?document.body:e.target,r=new Tu({el:document.createElement("div"),data:e});return Ru(e,t,r),"absolute"!==r.originalPosition&&"fixed"!==r.originalPosition&&Object(Ue["addClass"])(t,"el-loading-parent--relative"),e.fullscreen&&e.lock&&Object(Ue["addClass"])(t,"el-loading-parent--hidden"),t.appendChild(r.$el),ji.a.nextTick((function(){r.visible=!0})),e.fullscreen&&(Iu=r),r}},ku=wu,Ou={install:function(e){e.use(Cu),e.prototype.$loading=ku},directive:Cu,service:ku},Nu=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("i",{class:"el-icon-"+e.name})},Lu=[];Nu._withStripped=!0;var Pu={name:"ElIcon",props:{name:String}},Du=Pu,Mu=a(Du,Nu,Lu,!1,null,null,null);Mu.options.__file="packages/icon/src/icon.vue";var xu=Mu.exports;xu.install=function(e){e.component(xu.name,xu)};var Bu=xu,Uu={name:"ElRow",componentName:"ElRow",props:{tag:{type:String,default:"div"},gutter:Number,type:String,justify:{type:String,default:"start"},align:String},computed:{style:function(){var e={};return this.gutter&&(e.marginLeft="-"+this.gutter/2+"px",e.marginRight=e.marginLeft),e}},render:function(e){return e(this.tag,{class:["el-row","start"!==this.justify?"is-justify-"+this.justify:"",this.align?"is-align-"+this.align:"",{"el-row--flex":"flex"===this.type}],style:this.style},this.$slots.default)},install:function(e){e.component(Uu.name,Uu)}},Fu=Uu,Vu="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ju={name:"ElCol",props:{span:{type:Number,default:24},tag:{type:String,default:"div"},offset:Number,pull:Number,push:Number,xs:[Number,Object],sm:[Number,Object],md:[Number,Object],lg:[Number,Object],xl:[Number,Object]},computed:{gutter:function(){var e=this.$parent;while(e&&"ElRow"!==e.$options.componentName)e=e.$parent;return e?e.gutter:0}},render:function(e){var t=this,r=[],i={};return this.gutter&&(i.paddingLeft=this.gutter/2+"px",i.paddingRight=i.paddingLeft),["span","offset","pull","push"].forEach((function(e){(t[e]||0===t[e])&&r.push("span"!==e?"el-col-"+e+"-"+t[e]:"el-col-"+t[e])})),["xs","sm","md","lg","xl"].forEach((function(e){if("number"===typeof t[e])r.push("el-col-"+e+"-"+t[e]);else if("object"===Vu(t[e])){var i=t[e];Object.keys(i).forEach((function(t){r.push("span"!==t?"el-col-"+e+"-"+t+"-"+i[t]:"el-col-"+e+"-"+i[t])}))}})),e(this.tag,{class:["el-col",r],style:i},this.$slots.default)},install:function(e){e.component(ju.name,ju)}},Gu=ju,Hu=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition-group",{class:["el-upload-list","el-upload-list--"+e.listType,{"is-disabled":e.disabled}],attrs:{tag:"ul",name:"el-list"}},e._l(e.files,(function(t){return r("li",{key:t.uid,class:["el-upload-list__item","is-"+t.status,e.focusing?"focusing":""],attrs:{tabindex:"0"},on:{keydown:function(r){if(!("button"in r)&&e._k(r.keyCode,"delete",[8,46],r.key,["Backspace","Delete","Del"]))return null;!e.disabled&&e.$emit("remove",t)},focus:function(t){e.focusing=!0},blur:function(t){e.focusing=!1},click:function(t){e.focusing=!1}}},[e._t("default",["uploading"!==t.status&&["picture-card","picture"].indexOf(e.listType)>-1?r("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:t.url,alt:""}}):e._e(),r("a",{staticClass:"el-upload-list__item-name",on:{click:function(r){e.handleClick(t)}}},[r("i",{staticClass:"el-icon-document"}),e._v(e._s(t.name)+"\n      ")]),r("label",{staticClass:"el-upload-list__item-status-label"},[r("i",{class:{"el-icon-upload-success":!0,"el-icon-circle-check":"text"===e.listType,"el-icon-check":["picture-card","picture"].indexOf(e.listType)>-1}})]),e.disabled?e._e():r("i",{staticClass:"el-icon-close",on:{click:function(r){e.$emit("remove",t)}}}),e.disabled?e._e():r("i",{staticClass:"el-icon-close-tip"},[e._v(e._s(e.t("el.upload.deleteTip")))]),"uploading"===t.status?r("el-progress",{attrs:{type:"picture-card"===e.listType?"circle":"line","stroke-width":"picture-card"===e.listType?6:2,percentage:e.parsePercentage(t.percentage)}}):e._e(),"picture-card"===e.listType?r("span",{staticClass:"el-upload-list__item-actions"},[e.handlePreview&&"picture-card"===e.listType?r("span",{staticClass:"el-upload-list__item-preview",on:{click:function(r){e.handlePreview(t)}}},[r("i",{staticClass:"el-icon-zoom-in"})]):e._e(),e.disabled?e._e():r("span",{staticClass:"el-upload-list__item-delete",on:{click:function(r){e.$emit("remove",t)}}},[r("i",{staticClass:"el-icon-delete"})])]):e._e()],{file:t})],2)})),0)},Qu=[];Hu._withStripped=!0;var Wu=r(33),qu=r.n(Wu),zu={name:"ElUploadList",mixins:[_.a],data:function(){return{focusing:!1}},components:{ElProgress:qu.a},props:{files:{type:Array,default:function(){return[]}},disabled:{type:Boolean,default:!1},handlePreview:Function,listType:String},methods:{parsePercentage:function(e){return parseInt(e,10)},handleClick:function(e){this.handlePreview&&this.handlePreview(e)}}},Zu=zu,Yu=a(Zu,Hu,Qu,!1,null,null,null);Yu.options.__file="packages/upload/src/upload-list.vue";var Ku=Yu.exports,$u=r(24),Ju=r.n($u);function Xu(e,t,r){var i=void 0;i=r.response?""+(r.response.error||r.response):r.responseText?""+r.responseText:"fail to post "+e+" "+r.status;var n=new Error(i);return n.status=r.status,n.method="post",n.url=e,n}function ed(e){var t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch(r){return t}}function td(e){if("undefined"!==typeof XMLHttpRequest){var t=new XMLHttpRequest,r=e.action;t.upload&&(t.upload.onprogress=function(t){t.total>0&&(t.percent=t.loaded/t.total*100),e.onProgress(t)});var i=new FormData;e.data&&Object.keys(e.data).forEach((function(t){i.append(t,e.data[t])})),i.append(e.filename,e.file,e.file.name),t.onerror=function(t){e.onError(t)},t.onload=function(){if(t.status<200||t.status>=300)return e.onError(Xu(r,e,t));e.onSuccess(ed(t))},t.open("post",r,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);var n=e.headers||{};for(var o in n)n.hasOwnProperty(o)&&null!==n[o]&&t.setRequestHeader(o,n[o]);return t.send(i),t}}var rd=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-upload-dragger",class:{"is-dragover":e.dragover},on:{drop:function(t){return t.preventDefault(),e.onDrop(t)},dragover:function(t){return t.preventDefault(),e.onDragover(t)},dragleave:function(t){t.preventDefault(),e.dragover=!1}}},[e._t("default")],2)},id=[];rd._withStripped=!0;var nd={name:"ElUploadDrag",props:{disabled:Boolean},inject:{uploader:{default:""}},data:function(){return{dragover:!1}},methods:{onDragover:function(){this.disabled||(this.dragover=!0)},onDrop:function(e){if(!this.disabled&&this.uploader){var t=this.uploader.accept;this.dragover=!1,t?this.$emit("file",[].slice.call(e.dataTransfer.files).filter((function(e){var r=e.type,i=e.name,n=i.indexOf(".")>-1?"."+i.split(".").pop():"",o=r.replace(/\/.*$/,"");return t.split(",").map((function(e){return e.trim()})).filter((function(e){return e})).some((function(e){return/\..+$/.test(e)?n===e:/\/\*$/.test(e)?o===e.replace(/\/\*$/,""):!!/^[^\/]+\/[^\/]+$/.test(e)&&r===e}))}))):this.$emit("file",e.dataTransfer.files)}}}},od=nd,sd=a(od,rd,id,!1,null,null,null);sd.options.__file="packages/upload/src/upload-dragger.vue";var ad,cd,ld=sd.exports,ud={inject:["uploader"],components:{UploadDragger:ld},props:{type:String,action:{type:String,required:!0},name:{type:String,default:"file"},data:Object,headers:Object,withCredentials:Boolean,multiple:Boolean,accept:String,onStart:Function,onProgress:Function,onSuccess:Function,onError:Function,beforeUpload:Function,drag:Boolean,onPreview:{type:Function,default:function(){}},onRemove:{type:Function,default:function(){}},fileList:Array,autoUpload:Boolean,listType:String,httpRequest:{type:Function,default:td},disabled:Boolean,limit:Number,onExceed:Function},data:function(){return{mouseover:!1,reqs:{}}},methods:{isImage:function(e){return-1!==e.indexOf("image")},handleChange:function(e){var t=e.target.files;t&&this.uploadFiles(t)},uploadFiles:function(e){var t=this;if(this.limit&&this.fileList.length+e.length>this.limit)this.onExceed&&this.onExceed(e,this.fileList);else{var r=Array.prototype.slice.call(e);this.multiple||(r=r.slice(0,1)),0!==r.length&&r.forEach((function(e){t.onStart(e),t.autoUpload&&t.upload(e)}))}},upload:function(e){var t=this;if(this.$refs.input.value=null,!this.beforeUpload)return this.post(e);var r=this.beforeUpload(e);r&&r.then?r.then((function(r){var i=Object.prototype.toString.call(r);if("[object File]"===i||"[object Blob]"===i){for(var n in"[object Blob]"===i&&(r=new File([r],e.name,{type:e.type})),e)e.hasOwnProperty(n)&&(r[n]=e[n]);t.post(r)}else t.post(e)}),(function(){t.onRemove(null,e)})):!1!==r?this.post(e):this.onRemove(null,e)},abort:function(e){var t=this.reqs;if(e){var r=e;e.uid&&(r=e.uid),t[r]&&t[r].abort()}else Object.keys(t).forEach((function(e){t[e]&&t[e].abort(),delete t[e]}))},post:function(e){var t=this,r=e.uid,i={headers:this.headers,withCredentials:this.withCredentials,file:e,data:this.data,filename:this.name,action:this.action,onProgress:function(r){t.onProgress(r,e)},onSuccess:function(i){t.onSuccess(i,e),delete t.reqs[r]},onError:function(i){t.onError(i,e),delete t.reqs[r]}},n=this.httpRequest(i);this.reqs[r]=n,n&&n.then&&n.then(i.onSuccess,i.onError)},handleClick:function(){this.disabled||(this.$refs.input.value=null,this.$refs.input.click())},handleKeydown:function(e){e.target===e.currentTarget&&(13!==e.keyCode&&32!==e.keyCode||this.handleClick())}},render:function(e){var t=this.handleClick,r=this.drag,i=this.name,n=this.handleChange,o=this.multiple,s=this.accept,a=this.listType,c=this.uploadFiles,l=this.disabled,u=this.handleKeydown,d={class:{"el-upload":!0},on:{click:t,keydown:u}};return d.class["el-upload--"+a]=!0,e("div",Ju()([d,{attrs:{tabindex:"0"}}]),[r?e("upload-dragger",{attrs:{disabled:l},on:{file:c}},[this.$slots.default]):this.$slots.default,e("input",{class:"el-upload__input",attrs:{type:"file",name:i,multiple:o,accept:s},ref:"input",on:{change:n}})])}},dd=ud,hd=a(dd,ad,cd,!1,null,null,null);hd.options.__file="packages/upload/src/upload.vue";var pd=hd.exports;function fd(){}var gd,md,_d={name:"ElUpload",mixins:[I.a],components:{ElProgress:qu.a,UploadList:Ku,Upload:pd},provide:function(){return{uploader:this}},inject:{elForm:{default:""}},props:{action:{type:String,required:!0},headers:{type:Object,default:function(){return{}}},data:Object,multiple:Boolean,name:{type:String,default:"file"},drag:Boolean,dragger:Boolean,withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:String,type:{type:String,default:"select"},beforeUpload:Function,beforeRemove:Function,onRemove:{type:Function,default:fd},onChange:{type:Function,default:fd},onPreview:{type:Function},onSuccess:{type:Function,default:fd},onProgress:{type:Function,default:fd},onError:{type:Function,default:fd},fileList:{type:Array,default:function(){return[]}},autoUpload:{type:Boolean,default:!0},listType:{type:String,default:"text"},httpRequest:Function,disabled:Boolean,limit:Number,onExceed:{type:Function,default:fd}},data:function(){return{uploadFiles:[],dragOver:!1,draging:!1,tempIndex:1}},computed:{uploadDisabled:function(){return this.disabled||(this.elForm||{}).disabled}},watch:{listType:function(e){"picture-card"!==e&&"picture"!==e||(this.uploadFiles=this.uploadFiles.map((function(e){if(!e.url&&e.raw)try{e.url=URL.createObjectURL(e.raw)}catch(t){console.error("[Element Error][Upload]",t)}return e})))},fileList:{immediate:!0,handler:function(e){var t=this;this.uploadFiles=e.map((function(e){return e.uid=e.uid||Date.now()+t.tempIndex++,e.status=e.status||"success",e}))}}},methods:{handleStart:function(e){e.uid=Date.now()+this.tempIndex++;var t={status:"ready",name:e.name,size:e.size,percentage:0,uid:e.uid,raw:e};if("picture-card"===this.listType||"picture"===this.listType)try{t.url=URL.createObjectURL(e)}catch(r){return void console.error("[Element Error][Upload]",r)}this.uploadFiles.push(t),this.onChange(t,this.uploadFiles)},handleProgress:function(e,t){var r=this.getFile(t);this.onProgress(e,r,this.uploadFiles),r.status="uploading",r.percentage=e.percent||0},handleSuccess:function(e,t){var r=this.getFile(t);r&&(r.status="success",r.response=e,this.onSuccess(e,r,this.uploadFiles),this.onChange(r,this.uploadFiles))},handleError:function(e,t){var r=this.getFile(t),i=this.uploadFiles;r.status="fail",i.splice(i.indexOf(r),1),this.onError(e,r,this.uploadFiles),this.onChange(r,this.uploadFiles)},handleRemove:function(e,t){var r=this;t&&(e=this.getFile(t));var i=function(){r.abort(e);var t=r.uploadFiles;t.splice(t.indexOf(e),1),r.onRemove(e,t)};if(this.beforeRemove){if("function"===typeof this.beforeRemove){var n=this.beforeRemove(e,this.uploadFiles);n&&n.then?n.then((function(){i()}),fd):!1!==n&&i()}}else i()},getFile:function(e){var t=this.uploadFiles,r=void 0;return t.every((function(t){return r=e.uid===t.uid?t:null,!r})),r},abort:function(e){this.$refs["upload-inner"].abort(e)},clearFiles:function(){this.uploadFiles=[]},submit:function(){var e=this;this.uploadFiles.filter((function(e){return"ready"===e.status})).forEach((function(t){e.$refs["upload-inner"].upload(t.raw)}))},getMigratingConfig:function(){return{props:{"default-file-list":"default-file-list is renamed to file-list.","show-upload-list":"show-upload-list is renamed to show-file-list.","thumbnail-mode":"thumbnail-mode has been deprecated, you can implement the same effect according to this case: http://element.eleme.io/#/zh-CN/component/upload#yong-hu-tou-xiang-shang-chuan"}}}},beforeDestroy:function(){this.uploadFiles.forEach((function(e){e.url&&0===e.url.indexOf("blob:")&&URL.revokeObjectURL(e.url)}))},render:function(e){var t=this,r=void 0;this.showFileList&&(r=e(Ku,{attrs:{disabled:this.uploadDisabled,listType:this.listType,files:this.uploadFiles,handlePreview:this.onPreview},on:{remove:this.handleRemove}},[function(e){if(t.$scopedSlots.file)return t.$scopedSlots.file({file:e.file})}]));var i={props:{type:this.type,drag:this.drag,action:this.action,multiple:this.multiple,"before-upload":this.beforeUpload,"with-credentials":this.withCredentials,headers:this.headers,name:this.name,data:this.data,accept:this.accept,fileList:this.uploadFiles,autoUpload:this.autoUpload,listType:this.listType,disabled:this.uploadDisabled,limit:this.limit,"on-exceed":this.onExceed,"on-start":this.handleStart,"on-progress":this.handleProgress,"on-success":this.handleSuccess,"on-error":this.handleError,"on-preview":this.onPreview,"on-remove":this.handleRemove,"http-request":this.httpRequest},ref:"upload-inner"},n=this.$slots.trigger||this.$slots.default,o=e("upload",i,[n]);return e("div",["picture-card"===this.listType?r:"",this.$slots.trigger?[o,this.$slots.default]:o,this.$slots.tip,"picture-card"!==this.listType?r:""])}},vd=_d,Ed=a(vd,gd,md,!1,null,null,null);Ed.options.__file="packages/upload/src/index.vue";var Ad=Ed.exports;Ad.install=function(e){e.component(Ad.name,Ad)};var yd=Ad,Sd=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-progress",class:["el-progress--"+e.type,e.status?"is-"+e.status:"",{"el-progress--without-text":!e.showText,"el-progress--text-inside":e.textInside}],attrs:{role:"progressbar","aria-valuenow":e.percentage,"aria-valuemin":"0","aria-valuemax":"100"}},["line"===e.type?r("div",{staticClass:"el-progress-bar"},[r("div",{staticClass:"el-progress-bar__outer",style:{height:e.strokeWidth+"px"}},[r("div",{staticClass:"el-progress-bar__inner",style:e.barStyle},[e.showText&&e.textInside?r("div",{staticClass:"el-progress-bar__innerText"},[e._v(e._s(e.content))]):e._e()])])]):r("div",{staticClass:"el-progress-circle",style:{height:e.width+"px",width:e.width+"px"}},[r("svg",{attrs:{viewBox:"0 0 100 100"}},[r("path",{staticClass:"el-progress-circle__track",style:e.trailPathStyle,attrs:{d:e.trackPath,stroke:"#e5e9f2","stroke-width":e.relativeStrokeWidth,fill:"none"}}),r("path",{staticClass:"el-progress-circle__path",style:e.circlePathStyle,attrs:{d:e.trackPath,stroke:e.stroke,fill:"none","stroke-linecap":e.strokeLinecap,"stroke-width":e.percentage?e.relativeStrokeWidth:0}})])]),e.showText&&!e.textInside?r("div",{staticClass:"el-progress__text",style:{fontSize:e.progressTextSize+"px"}},[e.status?r("i",{class:e.iconClass}):[e._v(e._s(e.content))]],2):e._e()])},Cd=[];Sd._withStripped=!0;var Td={name:"ElProgress",props:{type:{type:String,default:"line",validator:function(e){return["line","circle","dashboard"].indexOf(e)>-1}},percentage:{type:Number,default:0,required:!0,validator:function(e){return e>=0&&e<=100}},status:{type:String,validator:function(e){return["success","exception","warning"].indexOf(e)>-1}},strokeWidth:{type:Number,default:6},strokeLinecap:{type:String,default:"round"},textInside:{type:Boolean,default:!1},width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:[String,Array,Function],default:""},format:Function},computed:{barStyle:function(){var e={};return e.width=this.percentage+"%",e.backgroundColor=this.getCurrentColor(this.percentage),e},relativeStrokeWidth:function(){return(this.strokeWidth/this.width*100).toFixed(1)},radius:function(){return"circle"===this.type||"dashboard"===this.type?parseInt(50-parseFloat(this.relativeStrokeWidth)/2,10):0},trackPath:function(){var e=this.radius,t="dashboard"===this.type;return"\n        M 50 50\n        m 0 "+(t?"":"-")+e+"\n        a "+e+" "+e+" 0 1 1 0 "+(t?"-":"")+2*e+"\n        a "+e+" "+e+" 0 1 1 0 "+(t?"":"-")+2*e+"\n        "},perimeter:function(){return 2*Math.PI*this.radius},rate:function(){return"dashboard"===this.type?.75:1},strokeDashoffset:function(){var e=-1*this.perimeter*(1-this.rate)/2;return e+"px"},trailPathStyle:function(){return{strokeDasharray:this.perimeter*this.rate+"px, "+this.perimeter+"px",strokeDashoffset:this.strokeDashoffset}},circlePathStyle:function(){return{strokeDasharray:this.perimeter*this.rate*(this.percentage/100)+"px, "+this.perimeter+"px",strokeDashoffset:this.strokeDashoffset,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease"}},stroke:function(){var e=void 0;if(this.color)e=this.getCurrentColor(this.percentage);else switch(this.status){case"success":e="#13ce66";break;case"exception":e="#ff4949";break;case"warning":e="#e6a23c";break;default:e="#20a0ff"}return e},iconClass:function(){return"warning"===this.status?"el-icon-warning":"line"===this.type?"success"===this.status?"el-icon-circle-check":"el-icon-circle-close":"success"===this.status?"el-icon-check":"el-icon-close"},progressTextSize:function(){return"line"===this.type?12+.4*this.strokeWidth:.111111*this.width+2},content:function(){return"function"===typeof this.format?this.format(this.percentage)||"":this.percentage+"%"}},methods:{getCurrentColor:function(e){return"function"===typeof this.color?this.color(e):"string"===typeof this.color?this.color:this.getLevelColor(e)},getLevelColor:function(e){for(var t=this.getColorArray().sort((function(e,t){return e.percentage-t.percentage})),r=0;r<t.length;r++)if(t[r].percentage>e)return t[r].color;return t[t.length-1].color},getColorArray:function(){var e=this.color,t=100/e.length;return e.map((function(e,r){return"string"===typeof e?{color:e,percentage:(r+1)*t}:e}))}}},bd=Td,Id=a(bd,Sd,Cd,!1,null,null,null);Id.options.__file="packages/progress/src/progress.vue";var Rd=Id.exports;Rd.install=function(e){e.component(Rd.name,Rd)};var wd=Rd,kd=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("span",{staticClass:"el-spinner"},[r("svg",{staticClass:"el-spinner-inner",style:{width:e.radius/2+"px",height:e.radius/2+"px"},attrs:{viewBox:"0 0 50 50"}},[r("circle",{staticClass:"path",attrs:{cx:"25",cy:"25",r:"20",fill:"none",stroke:e.strokeColor,"stroke-width":e.strokeWidth}})])])},Od=[];kd._withStripped=!0;var Nd={name:"ElSpinner",props:{type:String,radius:{type:Number,default:100},strokeWidth:{type:Number,default:5},strokeColor:{type:String,default:"#efefef"}}},Ld=Nd,Pd=a(Ld,kd,Od,!1,null,null,null);Pd.options.__file="packages/spinner/src/spinner.vue";var Dd=Pd.exports;Dd.install=function(e){e.component(Dd.name,Dd)};var Md=Dd,xd=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition",{attrs:{name:"el-message-fade"},on:{"after-leave":e.handleAfterLeave}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],class:["el-message",e.type&&!e.iconClass?"el-message--"+e.type:"",e.center?"is-center":"",e.showClose?"is-closable":"",e.customClass],style:e.positionStyle,attrs:{role:"alert"},on:{mouseenter:e.clearTimer,mouseleave:e.startTimer}},[e.iconClass?r("i",{class:e.iconClass}):r("i",{class:e.typeClass}),e._t("default",[e.dangerouslyUseHTMLString?r("p",{staticClass:"el-message__content",domProps:{innerHTML:e._s(e.message)}}):r("p",{staticClass:"el-message__content"},[e._v(e._s(e.message))])]),e.showClose?r("i",{staticClass:"el-message__closeBtn el-icon-close",on:{click:e.close}}):e._e()],2)])},Bd=[];xd._withStripped=!0;var Ud={success:"success",info:"info",warning:"warning",error:"error"},Fd={data:function(){return{visible:!1,message:"",duration:3e3,type:"info",iconClass:"",customClass:"",onClose:null,showClose:!1,closed:!1,verticalOffset:20,timer:null,dangerouslyUseHTMLString:!1,center:!1}},computed:{typeClass:function(){return this.type&&!this.iconClass?"el-message__icon el-icon-"+Ud[this.type]:""},positionStyle:function(){return{top:this.verticalOffset+"px"}}},watch:{closed:function(e){e&&(this.visible=!1)}},methods:{handleAfterLeave:function(){this.$destroy(!0),this.$el.parentNode.removeChild(this.$el)},close:function(){this.closed=!0,"function"===typeof this.onClose&&this.onClose(this)},clearTimer:function(){clearTimeout(this.timer)},startTimer:function(){var e=this;this.duration>0&&(this.timer=setTimeout((function(){e.closed||e.close()}),this.duration))},keydown:function(e){27===e.keyCode&&(this.closed||this.close())}},mounted:function(){this.startTimer(),document.addEventListener("keydown",this.keydown)},beforeDestroy:function(){document.removeEventListener("keydown",this.keydown)}},Vd=Fd,jd=a(Vd,xd,Bd,!1,null,null,null);jd.options.__file="packages/message/src/main.vue";var Gd=jd.exports,Hd=r(15),Qd=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Wd=ji.a.extend(Gd),qd=void 0,zd=[],Zd=1,Yd=function e(t){if(!ji.a.prototype.$isServer){t=t||{},"string"===typeof t&&(t={message:t});var r=t.onClose,i="message_"+Zd++;t.onClose=function(){e.close(i,r)},qd=new Wd({data:t}),qd.id=i,Object(Ta["isVNode"])(qd.message)&&(qd.$slots.default=[qd.message],qd.message=null),qd.$mount(),document.body.appendChild(qd.$el);var n=t.offset||20;return zd.forEach((function(e){n+=e.$el.offsetHeight+16})),qd.verticalOffset=n,qd.visible=!0,qd.$el.style.zIndex=C["PopupManager"].nextZIndex(),zd.push(qd),qd}};["success","warning","info","error"].forEach((function(e){Yd[e]=function(t){return Object(Hd["isObject"])(t)&&!Object(Ta["isVNode"])(t)?Yd(Qd({},t,{type:e})):Yd({type:e,message:t})}})),Yd.close=function(e,t){for(var r=zd.length,i=-1,n=void 0,o=0;o<r;o++)if(e===zd[o].id){n=zd[o].$el.offsetHeight,i=o,"function"===typeof t&&t(zd[o]),zd.splice(o,1);break}if(!(r<=1||-1===i||i>zd.length-1))for(var s=i;s<r-1;s++){var a=zd[s].$el;a.style["top"]=parseInt(a.style["top"],10)-n-16+"px"}},Yd.closeAll=function(){for(var e=zd.length-1;e>=0;e--)zd[e].close()};var Kd=Yd,$d=Kd,Jd=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-badge"},[e._t("default"),r("transition",{attrs:{name:"el-zoom-in-center"}},[r("sup",{directives:[{name:"show",rawName:"v-show",value:!e.hidden&&(e.content||0===e.content||e.isDot),expression:"!hidden && (content || content === 0 || isDot)"}],staticClass:"el-badge__content",class:["el-badge__content--"+e.type,{"is-fixed":e.$slots.default,"is-dot":e.isDot}],domProps:{textContent:e._s(e.content)}})])],2)},Xd=[];Jd._withStripped=!0;var eh={name:"ElBadge",props:{value:[String,Number],max:Number,isDot:Boolean,hidden:Boolean,type:{type:String,validator:function(e){return["primary","success","warning","info","danger"].indexOf(e)>-1}}},computed:{content:function(){if(!this.isDot){var e=this.value,t=this.max;return"number"===typeof e&&"number"===typeof t&&t<e?t+"+":e}}}},th=eh,rh=a(th,Jd,Xd,!1,null,null,null);rh.options.__file="packages/badge/src/main.vue";var ih=rh.exports;ih.install=function(e){e.component(ih.name,ih)};var nh=ih,oh=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-card",class:e.shadow?"is-"+e.shadow+"-shadow":"is-always-shadow"},[e.$slots.header||e.header?r("div",{staticClass:"el-card__header"},[e._t("header",[e._v(e._s(e.header))])],2):e._e(),r("div",{staticClass:"el-card__body",style:e.bodyStyle},[e._t("default")],2)])},sh=[];oh._withStripped=!0;var ah={name:"ElCard",props:{header:{},bodyStyle:{},shadow:{type:String}}},ch=ah,lh=a(ch,oh,sh,!1,null,null,null);lh.options.__file="packages/card/src/main.vue";var uh=lh.exports;uh.install=function(e){e.component(uh.name,uh)};var dh=uh,hh=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-rate",attrs:{role:"slider","aria-valuenow":e.currentValue,"aria-valuetext":e.text,"aria-valuemin":"0","aria-valuemax":e.max,tabindex:"0"},on:{keydown:e.handleKey}},[e._l(e.max,(function(t,i){return r("span",{key:i,staticClass:"el-rate__item",style:{cursor:e.rateDisabled?"auto":"pointer"},on:{mousemove:function(r){e.setCurrentValue(t,r)},mouseleave:e.resetCurrentValue,click:function(r){e.selectValue(t)}}},[r("i",{staticClass:"el-rate__icon",class:[e.classes[t-1],{hover:e.hoverIndex===t}],style:e.getIconStyle(t)},[e.showDecimalIcon(t)?r("i",{staticClass:"el-rate__decimal",class:e.decimalIconClass,style:e.decimalStyle}):e._e()])])})),e.showText||e.showScore?r("span",{staticClass:"el-rate__text",style:{color:e.textColor}},[e._v(e._s(e.text))]):e._e()],2)},ph=[];hh._withStripped=!0;var fh={name:"ElRate",mixins:[I.a],inject:{elForm:{default:""}},data:function(){return{pointerAtLeftHalf:!0,currentValue:this.value,hoverIndex:-1}},props:{value:{type:Number,default:0},lowThreshold:{type:Number,default:2},highThreshold:{type:Number,default:4},max:{type:Number,default:5},colors:{type:[Array,Object],default:function(){return["#F7BA2A","#F7BA2A","#F7BA2A"]}},voidColor:{type:String,default:"#C6D1DE"},disabledVoidColor:{type:String,default:"#EFF2F7"},iconClasses:{type:[Array,Object],default:function(){return["el-icon-star-on","el-icon-star-on","el-icon-star-on"]}},voidIconClass:{type:String,default:"el-icon-star-off"},disabledVoidIconClass:{type:String,default:"el-icon-star-on"},disabled:{type:Boolean,default:!1},allowHalf:{type:Boolean,default:!1},showText:{type:Boolean,default:!1},showScore:{type:Boolean,default:!1},textColor:{type:String,default:"#1f2d3d"},texts:{type:Array,default:function(){return["极差","失望","一般","满意","惊喜"]}},scoreTemplate:{type:String,default:"{value}"}},computed:{text:function(){var e="";return this.showScore?e=this.scoreTemplate.replace(/\{\s*value\s*\}/,this.rateDisabled?this.value:this.currentValue):this.showText&&(e=this.texts[Math.ceil(this.currentValue)-1]),e},decimalStyle:function(){var e="";return this.rateDisabled?e=this.valueDecimal+"%":this.allowHalf&&(e="50%"),{color:this.activeColor,width:e}},valueDecimal:function(){return 100*this.value-100*Math.floor(this.value)},classMap:function(){var e;return Array.isArray(this.iconClasses)?(e={},e[this.lowThreshold]=this.iconClasses[0],e[this.highThreshold]={value:this.iconClasses[1],excluded:!0},e[this.max]=this.iconClasses[2],e):this.iconClasses},decimalIconClass:function(){return this.getValueFromMap(this.value,this.classMap)},voidClass:function(){return this.rateDisabled?this.disabledVoidIconClass:this.voidIconClass},activeClass:function(){return this.getValueFromMap(this.currentValue,this.classMap)},colorMap:function(){var e;return Array.isArray(this.colors)?(e={},e[this.lowThreshold]=this.colors[0],e[this.highThreshold]={value:this.colors[1],excluded:!0},e[this.max]=this.colors[2],e):this.colors},activeColor:function(){return this.getValueFromMap(this.currentValue,this.colorMap)},classes:function(){var e=[],t=0,r=this.currentValue;for(this.allowHalf&&this.currentValue!==Math.floor(this.currentValue)&&r--;t<r;t++)e.push(this.activeClass);for(;t<this.max;t++)e.push(this.voidClass);return e},rateDisabled:function(){return this.disabled||(this.elForm||{}).disabled}},watch:{value:function(e){this.currentValue=e,this.pointerAtLeftHalf=this.value!==Math.floor(this.value)}},methods:{getMigratingConfig:function(){return{props:{"text-template":"text-template is renamed to score-template."}}},getValueFromMap:function(e,t){var r=Object.keys(t).filter((function(r){var i=t[r],n=!!Object(Hd["isObject"])(i)&&i.excluded;return n?e<r:e<=r})).sort((function(e,t){return e-t})),i=t[r[0]];return Object(Hd["isObject"])(i)?i.value:i||""},showDecimalIcon:function(e){var t=this.rateDisabled&&this.valueDecimal>0&&e-1<this.value&&e>this.value,r=this.allowHalf&&this.pointerAtLeftHalf&&e-.5<=this.currentValue&&e>this.currentValue;return t||r},getIconStyle:function(e){var t=this.rateDisabled?this.disabledVoidColor:this.voidColor;return{color:e<=this.currentValue?this.activeColor:t}},selectValue:function(e){this.rateDisabled||(this.allowHalf&&this.pointerAtLeftHalf?(this.$emit("input",this.currentValue),this.$emit("change",this.currentValue)):(this.$emit("input",e),this.$emit("change",e)))},handleKey:function(e){if(!this.rateDisabled){var t=this.currentValue,r=e.keyCode;38===r||39===r?(this.allowHalf?t+=.5:t+=1,e.stopPropagation(),e.preventDefault()):37!==r&&40!==r||(this.allowHalf?t-=.5:t-=1,e.stopPropagation(),e.preventDefault()),t=t<0?0:t,t=t>this.max?this.max:t,this.$emit("input",t),this.$emit("change",t)}},setCurrentValue:function(e,t){if(!this.rateDisabled){if(this.allowHalf){var r=t.target;Object(Ue["hasClass"])(r,"el-rate__item")&&(r=r.querySelector(".el-rate__icon")),Object(Ue["hasClass"])(r,"el-rate__decimal")&&(r=r.parentNode),this.pointerAtLeftHalf=2*t.offsetX<=r.clientWidth,this.currentValue=this.pointerAtLeftHalf?e-.5:e}else this.currentValue=e;this.hoverIndex=e}},resetCurrentValue:function(){this.rateDisabled||(this.allowHalf&&(this.pointerAtLeftHalf=this.value!==Math.floor(this.value)),this.currentValue=this.value,this.hoverIndex=-1)}},created:function(){this.value||this.$emit("input",0)}},gh=fh,mh=a(gh,hh,ph,!1,null,null,null);mh.options.__file="packages/rate/src/main.vue";var _h=mh.exports;_h.install=function(e){e.component(_h.name,_h)};var vh=_h,Eh=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-steps",class:[!e.simple&&"el-steps--"+e.direction,e.simple&&"el-steps--simple"]},[e._t("default")],2)},Ah=[];Eh._withStripped=!0;var yh={name:"ElSteps",mixins:[I.a],props:{space:[Number,String],active:Number,direction:{type:String,default:"horizontal"},alignCenter:Boolean,simple:Boolean,finishStatus:{type:String,default:"finish"},processStatus:{type:String,default:"process"}},data:function(){return{steps:[],stepOffset:0}},methods:{getMigratingConfig:function(){return{props:{center:"center is removed."}}}},watch:{active:function(e,t){this.$emit("change",e,t)},steps:function(e){e.forEach((function(e,t){e.index=t}))}}},Sh=yh,Ch=a(Sh,Eh,Ah,!1,null,null,null);Ch.options.__file="packages/steps/src/steps.vue";var Th=Ch.exports;Th.install=function(e){e.component(Th.name,Th)};var bh=Th,Ih=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-step",class:[!e.isSimple&&"is-"+e.$parent.direction,e.isSimple&&"is-simple",e.isLast&&!e.space&&!e.isCenter&&"is-flex",e.isCenter&&!e.isVertical&&!e.isSimple&&"is-center"],style:e.style},[r("div",{staticClass:"el-step__head",class:"is-"+e.currentStatus},[r("div",{staticClass:"el-step__line",style:e.isLast?"":{marginRight:e.$parent.stepOffset+"px"}},[r("i",{staticClass:"el-step__line-inner",style:e.lineStyle})]),r("div",{staticClass:"el-step__icon",class:"is-"+(e.icon?"icon":"text")},["success"!==e.currentStatus&&"error"!==e.currentStatus?e._t("icon",[e.icon?r("i",{staticClass:"el-step__icon-inner",class:[e.icon]}):e._e(),e.icon||e.isSimple?e._e():r("div",{staticClass:"el-step__icon-inner"},[e._v(e._s(e.index+1))])]):r("i",{staticClass:"el-step__icon-inner is-status",class:["el-icon-"+("success"===e.currentStatus?"check":"close")]})],2)]),r("div",{staticClass:"el-step__main"},[r("div",{ref:"title",staticClass:"el-step__title",class:["is-"+e.currentStatus]},[e._t("title",[e._v(e._s(e.title))])],2),e.isSimple?r("div",{staticClass:"el-step__arrow"}):r("div",{staticClass:"el-step__description",class:["is-"+e.currentStatus]},[e._t("description",[e._v(e._s(e.description))])],2)])])},Rh=[];Ih._withStripped=!0;var wh={name:"ElStep",props:{title:String,icon:String,description:String,status:String},data:function(){return{index:-1,lineStyle:{},internalStatus:""}},beforeCreate:function(){this.$parent.steps.push(this)},beforeDestroy:function(){var e=this.$parent.steps,t=e.indexOf(this);t>=0&&e.splice(t,1)},computed:{currentStatus:function(){return this.status||this.internalStatus},prevStatus:function(){var e=this.$parent.steps[this.index-1];return e?e.currentStatus:"wait"},isCenter:function(){return this.$parent.alignCenter},isVertical:function(){return"vertical"===this.$parent.direction},isSimple:function(){return this.$parent.simple},isLast:function(){var e=this.$parent;return e.steps[e.steps.length-1]===this},stepsCount:function(){return this.$parent.steps.length},space:function(){var e=this.isSimple,t=this.$parent.space;return e?"":t},style:function(){var e={},t=this.$parent,r=t.steps.length,i="number"===typeof this.space?this.space+"px":this.space?this.space:100/(r-(this.isCenter?0:1))+"%";return e.flexBasis=i,this.isVertical||(this.isLast?e.maxWidth=100/this.stepsCount+"%":e.marginRight=-this.$parent.stepOffset+"px"),e}},methods:{updateStatus:function(e){var t=this.$parent.$children[this.index-1];e>this.index?this.internalStatus=this.$parent.finishStatus:e===this.index&&"error"!==this.prevStatus?this.internalStatus=this.$parent.processStatus:this.internalStatus="wait",t&&t.calcProgress(this.internalStatus)},calcProgress:function(e){var t=100,r={};r.transitionDelay=150*this.index+"ms",e===this.$parent.processStatus?(this.currentStatus,t=0):"wait"===e&&(t=0,r.transitionDelay=-150*this.index+"ms"),r.borderWidth=t&&!this.isSimple?"1px":0,"vertical"===this.$parent.direction?r.height=t+"%":r.width=t+"%",this.lineStyle=r}},mounted:function(){var e=this,t=this.$watch("index",(function(r){e.$watch("$parent.active",e.updateStatus,{immediate:!0}),e.$watch("$parent.processStatus",(function(){var t=e.$parent.active;e.updateStatus(t)}),{immediate:!0}),t()}))}},kh=wh,Oh=a(kh,Ih,Rh,!1,null,null,null);Oh.options.__file="packages/steps/src/step.vue";var Nh=Oh.exports;Nh.install=function(e){e.component(Nh.name,Nh)};var Lh=Nh,Ph=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:e.carouselClasses,on:{mouseenter:function(t){return t.stopPropagation(),e.handleMouseEnter(t)},mouseleave:function(t){return t.stopPropagation(),e.handleMouseLeave(t)}}},[r("div",{staticClass:"el-carousel__container",style:{height:e.height}},[e.arrowDisplay?r("transition",{attrs:{name:"carousel-arrow-left"}},[r("button",{directives:[{name:"show",rawName:"v-show",value:("always"===e.arrow||e.hover)&&(e.loop||e.activeIndex>0),expression:"(arrow === 'always' || hover) && (loop || activeIndex > 0)"}],staticClass:"el-carousel__arrow el-carousel__arrow--left",attrs:{type:"button"},on:{mouseenter:function(t){e.handleButtonEnter("left")},mouseleave:e.handleButtonLeave,click:function(t){t.stopPropagation(),e.throttledArrowClick(e.activeIndex-1)}}},[r("i",{staticClass:"el-icon-arrow-left"})])]):e._e(),e.arrowDisplay?r("transition",{attrs:{name:"carousel-arrow-right"}},[r("button",{directives:[{name:"show",rawName:"v-show",value:("always"===e.arrow||e.hover)&&(e.loop||e.activeIndex<e.items.length-1),expression:"(arrow === 'always' || hover) && (loop || activeIndex < items.length - 1)"}],staticClass:"el-carousel__arrow el-carousel__arrow--right",attrs:{type:"button"},on:{mouseenter:function(t){e.handleButtonEnter("right")},mouseleave:e.handleButtonLeave,click:function(t){t.stopPropagation(),e.throttledArrowClick(e.activeIndex+1)}}},[r("i",{staticClass:"el-icon-arrow-right"})])]):e._e(),e._t("default")],2),"none"!==e.indicatorPosition?r("ul",{class:e.indicatorsClasses},e._l(e.items,(function(t,i){return r("li",{key:i,class:["el-carousel__indicator","el-carousel__indicator--"+e.direction,{"is-active":i===e.activeIndex}],on:{mouseenter:function(t){e.throttledIndicatorHover(i)},click:function(t){t.stopPropagation(),e.handleIndicatorClick(i)}}},[r("button",{staticClass:"el-carousel__button"},[e.hasLabel?r("span",[e._v(e._s(t.label))]):e._e()])])})),0):e._e()])},Dh=[];Ph._withStripped=!0;var Mh=r(25),xh=r.n(Mh),Bh={name:"ElCarousel",props:{initialIndex:{type:Number,default:0},height:String,trigger:{type:String,default:"hover"},autoplay:{type:Boolean,default:!0},interval:{type:Number,default:3e3},indicatorPosition:String,indicator:{type:Boolean,default:!0},arrow:{type:String,default:"hover"},type:String,loop:{type:Boolean,default:!0},direction:{type:String,default:"horizontal",validator:function(e){return-1!==["horizontal","vertical"].indexOf(e)}}},data:function(){return{items:[],activeIndex:-1,containerWidth:0,timer:null,hover:!1}},computed:{arrowDisplay:function(){return"never"!==this.arrow&&"vertical"!==this.direction},hasLabel:function(){return this.items.some((function(e){return e.label.toString().length>0}))},carouselClasses:function(){var e=["el-carousel","el-carousel--"+this.direction];return"card"===this.type&&e.push("el-carousel--card"),e},indicatorsClasses:function(){var e=["el-carousel__indicators","el-carousel__indicators--"+this.direction];return this.hasLabel&&e.push("el-carousel__indicators--labels"),"outside"!==this.indicatorPosition&&"card"!==this.type||e.push("el-carousel__indicators--outside"),e}},watch:{items:function(e){e.length>0&&this.setActiveItem(this.initialIndex)},activeIndex:function(e,t){this.resetItemPosition(t),t>-1&&this.$emit("change",e,t)},autoplay:function(e){e?this.startTimer():this.pauseTimer()},loop:function(){this.setActiveItem(this.activeIndex)},interval:function(){this.pauseTimer(),this.startTimer()}},methods:{handleMouseEnter:function(){this.hover=!0,this.pauseTimer()},handleMouseLeave:function(){this.hover=!1,this.startTimer()},itemInStage:function(e,t){var r=this.items.length;return t===r-1&&e.inStage&&this.items[0].active||e.inStage&&this.items[t+1]&&this.items[t+1].active?"left":!!(0===t&&e.inStage&&this.items[r-1].active||e.inStage&&this.items[t-1]&&this.items[t-1].active)&&"right"},handleButtonEnter:function(e){var t=this;"vertical"!==this.direction&&this.items.forEach((function(r,i){e===t.itemInStage(r,i)&&(r.hover=!0)}))},handleButtonLeave:function(){"vertical"!==this.direction&&this.items.forEach((function(e){e.hover=!1}))},updateItems:function(){this.items=this.$children.filter((function(e){return"ElCarouselItem"===e.$options.name}))},resetItemPosition:function(e){var t=this;this.items.forEach((function(r,i){r.translateItem(i,t.activeIndex,e)}))},playSlides:function(){this.activeIndex<this.items.length-1?this.activeIndex++:this.loop&&(this.activeIndex=0)},pauseTimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)},startTimer:function(){this.interval<=0||!this.autoplay||this.timer||(this.timer=setInterval(this.playSlides,this.interval))},resetTimer:function(){this.pauseTimer(),this.startTimer()},setActiveItem:function(e){if("string"===typeof e){var t=this.items.filter((function(t){return t.name===e}));t.length>0&&(e=this.items.indexOf(t[0]))}if(e=Number(e),isNaN(e)||e!==Math.floor(e))console.warn("[Element Warn][Carousel]index must be an integer.");else{var r=this.items.length,i=this.activeIndex;this.activeIndex=e<0?this.loop?r-1:0:e>=r?this.loop?0:r-1:e,i===this.activeIndex&&this.resetItemPosition(i),this.resetTimer()}},prev:function(){this.setActiveItem(this.activeIndex-1)},next:function(){this.setActiveItem(this.activeIndex+1)},handleIndicatorClick:function(e){this.activeIndex=e},handleIndicatorHover:function(e){"hover"===this.trigger&&e!==this.activeIndex&&(this.activeIndex=e)}},created:function(){var e=this;this.throttledArrowClick=xh()(300,!0,(function(t){e.setActiveItem(t)})),this.throttledIndicatorHover=xh()(300,(function(t){e.handleIndicatorHover(t)}))},mounted:function(){var e=this;this.updateItems(),this.$nextTick((function(){Object(Xr["addResizeListener"])(e.$el,e.resetItemPosition),e.initialIndex<e.items.length&&e.initialIndex>=0&&(e.activeIndex=e.initialIndex),e.startTimer()}))},beforeDestroy:function(){this.$el&&Object(Xr["removeResizeListener"])(this.$el,this.resetItemPosition),this.pauseTimer()}},Uh=Bh,Fh=a(Uh,Ph,Dh,!1,null,null,null);Fh.options.__file="packages/carousel/src/main.vue";var Vh=Fh.exports;Vh.install=function(e){e.component(Vh.name,Vh)};var jh=Vh,Gh={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}};function Hh(e){var t=e.move,r=e.size,i=e.bar,n={},o="translate"+i.axis+"("+t+"%)";return n[i.size]=r,n.transform=o,n.msTransform=o,n.webkitTransform=o,n}var Qh={name:"Bar",props:{vertical:Boolean,size:String,move:Number},computed:{bar:function(){return Gh[this.vertical?"vertical":"horizontal"]},wrap:function(){return this.$parent.wrap}},render:function(e){var t=this.size,r=this.move,i=this.bar;return e("div",{class:["el-scrollbar__bar","is-"+i.key],on:{mousedown:this.clickTrackHandler}},[e("div",{ref:"thumb",class:"el-scrollbar__thumb",on:{mousedown:this.clickThumbHandler},style:Hh({size:t,move:r,bar:i})})])},methods:{clickThumbHandler:function(e){e.ctrlKey||2===e.button||(this.startDrag(e),this[this.bar.axis]=e.currentTarget[this.bar.offset]-(e[this.bar.client]-e.currentTarget.getBoundingClientRect()[this.bar.direction]))},clickTrackHandler:function(e){var t=Math.abs(e.target.getBoundingClientRect()[this.bar.direction]-e[this.bar.client]),r=this.$refs.thumb[this.bar.offset]/2,i=100*(t-r)/this.$el[this.bar.offset];this.wrap[this.bar.scroll]=i*this.wrap[this.bar.scrollSize]/100},startDrag:function(e){e.stopImmediatePropagation(),this.cursorDown=!0,Object(Ue["on"])(document,"mousemove",this.mouseMoveDocumentHandler),Object(Ue["on"])(document,"mouseup",this.mouseUpDocumentHandler),document.onselectstart=function(){return!1}},mouseMoveDocumentHandler:function(e){if(!1!==this.cursorDown){var t=this[this.bar.axis];if(t){var r=-1*(this.$el.getBoundingClientRect()[this.bar.direction]-e[this.bar.client]),i=this.$refs.thumb[this.bar.offset]-t,n=100*(r-i)/this.$el[this.bar.offset];this.wrap[this.bar.scroll]=n*this.wrap[this.bar.scrollSize]/100}}},mouseUpDocumentHandler:function(e){this.cursorDown=!1,this[this.bar.axis]=0,Object(Ue["off"])(document,"mousemove",this.mouseMoveDocumentHandler),document.onselectstart=null}},destroyed:function(){Object(Ue["off"])(document,"mouseup",this.mouseUpDocumentHandler)}},Wh={name:"ElScrollbar",components:{Bar:Qh},props:{native:Boolean,wrapStyle:{},wrapClass:{},viewClass:{},viewStyle:{},noresize:Boolean,tag:{type:String,default:"div"}},data:function(){return{sizeWidth:"0",sizeHeight:"0",moveX:0,moveY:0}},computed:{wrap:function(){return this.$refs.wrap}},render:function(e){var t=_n()(),r=this.wrapStyle;if(t){var i="-"+t+"px",n="margin-bottom: "+i+"; margin-right: "+i+";";Array.isArray(this.wrapStyle)?(r=Object(v["toObject"])(this.wrapStyle),r.marginRight=r.marginBottom=i):"string"===typeof this.wrapStyle?r+=n:r=n}var o=e(this.tag,{class:["el-scrollbar__view",this.viewClass],style:this.viewStyle,ref:"resize"},this.$slots.default),s=e("div",{ref:"wrap",style:r,on:{scroll:this.handleScroll},class:[this.wrapClass,"el-scrollbar__wrap",t?"":"el-scrollbar__wrap--hidden-default"]},[[o]]),a=void 0;return a=this.native?[e("div",{ref:"wrap",class:[this.wrapClass,"el-scrollbar__wrap"],style:r},[[o]])]:[s,e(Qh,{attrs:{move:this.moveX,size:this.sizeWidth}}),e(Qh,{attrs:{vertical:!0,move:this.moveY,size:this.sizeHeight}})],e("div",{class:"el-scrollbar"},a)},methods:{handleScroll:function(){var e=this.wrap;this.moveY=100*e.scrollTop/e.clientHeight,this.moveX=100*e.scrollLeft/e.clientWidth},update:function(){var e=void 0,t=void 0,r=this.wrap;r&&(e=100*r.clientHeight/r.scrollHeight,t=100*r.clientWidth/r.scrollWidth,this.sizeHeight=e<100?e+"%":"",this.sizeWidth=t<100?t+"%":"")}},mounted:function(){this.native||(this.$nextTick(this.update),!this.noresize&&Object(Xr["addResizeListener"])(this.$refs.resize,this.update))},beforeDestroy:function(){this.native||!this.noresize&&Object(Xr["removeResizeListener"])(this.$refs.resize,this.update)},install:function(e){e.component(Wh.name,Wh)}},qh=Wh,zh=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"show",rawName:"v-show",value:e.ready,expression:"ready"}],staticClass:"el-carousel__item",class:{"is-active":e.active,"el-carousel__item--card":"card"===e.$parent.type,"is-in-stage":e.inStage,"is-hover":e.hover,"is-animating":e.animating},style:e.itemStyle,on:{click:e.handleItemClick}},["card"===e.$parent.type?r("div",{directives:[{name:"show",rawName:"v-show",value:!e.active,expression:"!active"}],staticClass:"el-carousel__mask"}):e._e(),e._t("default")],2)},Zh=[];zh._withStripped=!0;var Yh=.83,Kh={name:"ElCarouselItem",props:{name:String,label:{type:[String,Number],default:""}},data:function(){return{hover:!1,translate:0,scale:1,active:!1,ready:!1,inStage:!1,animating:!1}},methods:{processIndex:function(e,t,r){return 0===t&&e===r-1?-1:t===r-1&&0===e?r:e<t-1&&t-e>=r/2?r+1:e>t+1&&e-t>=r/2?-2:e},calcCardTranslate:function(e,t){var r=this.$parent.$el.offsetWidth;return this.inStage?r*((2-Yh)*(e-t)+1)/4:e<t?-(1+Yh)*r/4:(3+Yh)*r/4},calcTranslate:function(e,t,r){var i=this.$parent.$el[r?"offsetHeight":"offsetWidth"];return i*(e-t)},translateItem:function(e,t,r){var i=this.$parent.type,n=this.parentDirection,o=this.$parent.items.length;if("card"!==i&&void 0!==r&&(this.animating=e===t||e===r),e!==t&&o>2&&this.$parent.loop&&(e=this.processIndex(e,t,o)),"card"===i)"vertical"===n&&console.warn("[Element Warn][Carousel]vertical direction is not supported in card mode"),this.inStage=Math.round(Math.abs(e-t))<=1,this.active=e===t,this.translate=this.calcCardTranslate(e,t),this.scale=this.active?1:Yh;else{this.active=e===t;var s="vertical"===n;this.translate=this.calcTranslate(e,t,s),this.scale=1}this.ready=!0},handleItemClick:function(){var e=this.$parent;if(e&&"card"===e.type){var t=e.items.indexOf(this);e.setActiveItem(t)}}},computed:{parentDirection:function(){return this.$parent.direction},itemStyle:function(){var e="vertical"===this.parentDirection?"translateY":"translateX",t=e+"("+this.translate+"px) scale("+this.scale+")",r={transform:t};return Object(v["autoprefixer"])(r)}},created:function(){this.$parent&&this.$parent.updateItems()},destroyed:function(){this.$parent&&this.$parent.updateItems()}},$h=Kh,Jh=a($h,zh,Zh,!1,null,null,null);Jh.options.__file="packages/carousel/src/item.vue";var Xh=Jh.exports;Xh.install=function(e){e.component(Xh.name,Xh)};var ep=Xh,tp=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-collapse",attrs:{role:"tablist","aria-multiselectable":"true"}},[e._t("default")],2)},rp=[];tp._withStripped=!0;var ip={name:"ElCollapse",componentName:"ElCollapse",props:{accordion:Boolean,value:{type:[Array,String,Number],default:function(){return[]}}},data:function(){return{activeNames:[].concat(this.value)}},provide:function(){return{collapse:this}},watch:{value:function(e){this.activeNames=[].concat(e)}},methods:{setActiveNames:function(e){e=[].concat(e);var t=this.accordion?e[0]:e;this.activeNames=e,this.$emit("input",t),this.$emit("change",t)},handleItemClick:function(e){if(this.accordion)this.setActiveNames(!this.activeNames[0]&&0!==this.activeNames[0]||this.activeNames[0]!==e.name?e.name:"");else{var t=this.activeNames.slice(0),r=t.indexOf(e.name);r>-1?t.splice(r,1):t.push(e.name),this.setActiveNames(t)}}},created:function(){this.$on("item-click",this.handleItemClick)}},np=ip,op=a(np,tp,rp,!1,null,null,null);op.options.__file="packages/collapse/src/collapse.vue";var sp=op.exports;sp.install=function(e){e.component(sp.name,sp)};var ap=sp,cp=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-collapse-item",class:{"is-active":e.isActive,"is-disabled":e.disabled}},[r("div",{attrs:{role:"tab","aria-expanded":e.isActive,"aria-controls":"el-collapse-content-"+e.id,"aria-describedby":"el-collapse-content-"+e.id}},[r("div",{staticClass:"el-collapse-item__header",class:{focusing:e.focusing,"is-active":e.isActive},attrs:{role:"button",id:"el-collapse-head-"+e.id,tabindex:e.disabled?void 0:0},on:{click:e.handleHeaderClick,keyup:function(t){return!("button"in t)&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.stopPropagation(),e.handleEnterClick(t))},focus:e.handleFocus,blur:function(t){e.focusing=!1}}},[e._t("title",[e._v(e._s(e.title))]),r("i",{staticClass:"el-collapse-item__arrow el-icon-arrow-right",class:{"is-active":e.isActive}})],2)]),r("el-collapse-transition",[r("div",{directives:[{name:"show",rawName:"v-show",value:e.isActive,expression:"isActive"}],staticClass:"el-collapse-item__wrap",attrs:{role:"tabpanel","aria-hidden":!e.isActive,"aria-labelledby":"el-collapse-head-"+e.id,id:"el-collapse-content-"+e.id}},[r("div",{staticClass:"el-collapse-item__content"},[e._t("default")],2)])])],1)},lp=[];cp._withStripped=!0;var up={name:"ElCollapseItem",componentName:"ElCollapseItem",mixins:[w.a],components:{ElCollapseTransition:ze.a},data:function(){return{contentWrapStyle:{height:"auto",display:"block"},contentHeight:0,focusing:!1,isClick:!1,id:Object(v["generateId"])()}},inject:["collapse"],props:{title:String,name:{type:[String,Number],default:function(){return this._uid}},disabled:Boolean},computed:{isActive:function(){return this.collapse.activeNames.indexOf(this.name)>-1}},methods:{handleFocus:function(){var e=this;setTimeout((function(){e.isClick?e.isClick=!1:e.focusing=!0}),50)},handleHeaderClick:function(){this.disabled||(this.dispatch("ElCollapse","item-click",this),this.focusing=!1,this.isClick=!0)},handleEnterClick:function(){this.dispatch("ElCollapse","item-click",this)}}},dp=up,hp=a(dp,cp,lp,!1,null,null,null);hp.options.__file="packages/collapse/src/collapse-item.vue";var pp=hp.exports;pp.install=function(e){e.component(pp.name,pp)};var fp=pp,gp=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:function(){return e.toggleDropDownVisible(!1)},expression:"() => toggleDropDownVisible(false)"}],ref:"reference",class:["el-cascader",e.realSize&&"el-cascader--"+e.realSize,{"is-disabled":e.isDisabled}],on:{mouseenter:function(t){e.inputHover=!0},mouseleave:function(t){e.inputHover=!1},click:function(){return e.toggleDropDownVisible(!e.readonly||void 0)},keydown:e.handleKeyDown}},[r("el-input",{ref:"input",class:{"is-focus":e.dropDownVisible},attrs:{size:e.realSize,placeholder:e.placeholder,readonly:e.readonly,disabled:e.isDisabled,"validate-event":!1},on:{focus:e.handleFocus,blur:e.handleBlur,input:e.handleInput},model:{value:e.multiple?e.presentText:e.inputValue,callback:function(t){e.multiple?e.presentText:e.inputValue=t},expression:"multiple ? presentText : inputValue"}},[r("template",{slot:"suffix"},[e.clearBtnVisible?r("i",{key:"clear",staticClass:"el-input__icon el-icon-circle-close",on:{click:function(t){return t.stopPropagation(),e.handleClear(t)}}}):r("i",{key:"arrow-down",class:["el-input__icon","el-icon-arrow-down",e.dropDownVisible&&"is-reverse"],on:{click:function(t){t.stopPropagation(),e.toggleDropDownVisible()}}})])],2),e.multiple?r("div",{staticClass:"el-cascader__tags"},[e._l(e.presentTags,(function(t){return r("el-tag",{key:t.key,attrs:{type:"info",size:e.tagSize,hit:t.hitState,closable:t.closable,"disable-transitions":""},on:{close:function(r){e.deleteTag(t)}}},[r("span",[e._v(e._s(t.text))])])})),e.filterable&&!e.isDisabled?r("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.inputValue,expression:"inputValue",modifiers:{trim:!0}}],staticClass:"el-cascader__search-input",attrs:{type:"text",placeholder:e.presentTags.length?"":e.placeholder},domProps:{value:e.inputValue},on:{input:[function(t){t.target.composing||(e.inputValue=t.target.value.trim())},function(t){return e.handleInput(e.inputValue,t)}],click:function(t){t.stopPropagation(),e.toggleDropDownVisible(!0)},keydown:function(t){return!("button"in t)&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete","Del"])?null:e.handleDelete(t)},blur:function(t){e.$forceUpdate()}}}):e._e()],2):e._e(),r("transition",{attrs:{name:"el-zoom-in-top"},on:{"after-leave":e.handleDropdownLeave}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.dropDownVisible,expression:"dropDownVisible"}],ref:"popper",class:["el-popper","el-cascader__dropdown",e.popperClass]},[r("el-cascader-panel",{directives:[{name:"show",rawName:"v-show",value:!e.filtering,expression:"!filtering"}],ref:"panel",attrs:{options:e.options,props:e.config,border:!1,"render-label":e.$scopedSlots.default},on:{"expand-change":e.handleExpandChange,close:function(t){e.toggleDropDownVisible(!1)}},model:{value:e.checkedValue,callback:function(t){e.checkedValue=t},expression:"checkedValue"}}),e.filterable?r("el-scrollbar",{directives:[{name:"show",rawName:"v-show",value:e.filtering,expression:"filtering"}],ref:"suggestionPanel",staticClass:"el-cascader__suggestion-panel",attrs:{tag:"ul","view-class":"el-cascader__suggestion-list"},nativeOn:{keydown:function(t){return e.handleSuggestionKeyDown(t)}}},[e.suggestions.length?e._l(e.suggestions,(function(t,i){return r("li",{key:t.uid,class:["el-cascader__suggestion-item",t.checked&&"is-checked"],attrs:{tabindex:-1},on:{click:function(t){e.handleSuggestionClick(i)}}},[r("span",[e._v(e._s(t.text))]),t.checked?r("i",{staticClass:"el-icon-check"}):e._e()])})):e._t("empty",[r("li",{staticClass:"el-cascader__empty-text"},[e._v(e._s(e.t("el.cascader.noMatch")))])])],2):e._e()],1)])],1)},mp=[];gp._withStripped=!0;var _p=r(42),vp=r.n(_p),Ep=r(34),Ap=r.n(Ep),yp=Ap.a.keys,Sp={expandTrigger:{newProp:"expandTrigger",type:String},changeOnSelect:{newProp:"checkStrictly",type:Boolean},hoverThreshold:{newProp:"hoverThreshold",type:Number}},Cp={props:{placement:{type:String,default:"bottom-start"},appendToBody:H.a.props.appendToBody,visibleArrow:{type:Boolean,default:!0},arrowOffset:H.a.props.arrowOffset,offset:H.a.props.offset,boundariesPadding:H.a.props.boundariesPadding,popperOptions:H.a.props.popperOptions},methods:H.a.methods,data:H.a.data,beforeDestroy:H.a.beforeDestroy},Tp={medium:36,small:32,mini:28},bp={name:"ElCascader",directives:{Clickoutside:F.a},mixins:[Cp,w.a,_.a,I.a],inject:{elForm:{default:""},elFormItem:{default:""}},components:{ElInput:g.a,ElTag:Jr.a,ElScrollbar:W.a,ElCascaderPanel:vp.a},props:{value:{},options:Array,props:Object,size:String,placeholder:{type:String,default:function(){return Object(fa["t"])("el.cascader.placeholder")}},disabled:Boolean,clearable:Boolean,filterable:Boolean,filterMethod:Function,separator:{type:String,default:" / "},showAllLevels:{type:Boolean,default:!0},collapseTags:Boolean,debounce:{type:Number,default:300},beforeFilter:{type:Function,default:function(){return function(){}}},popperClass:String},data:function(){return{dropDownVisible:!1,checkedValue:this.value,inputHover:!1,inputValue:null,presentText:null,presentTags:[],checkedNodes:[],filtering:!1,suggestions:[],inputInitialHeight:0,pressDeleteCount:0}},computed:{realSize:function(){var e=(this.elFormItem||{}).elFormItemSize;return this.size||e||(this.$ELEMENT||{}).size},tagSize:function(){return["small","mini"].indexOf(this.realSize)>-1?"mini":"small"},isDisabled:function(){return this.disabled||(this.elForm||{}).disabled},config:function(){var e=this.props||{},t=this.$attrs;return Object.keys(Sp).forEach((function(r){var i=Sp[r],n=i.newProp,o=i.type,s=t[r]||t[Object(v["kebabCase"])(r)];Object(It["isDef"])(r)&&!Object(It["isDef"])(e[n])&&(o===Boolean&&""===s&&(s=!0),e[n]=s)})),e},multiple:function(){return this.config.multiple},leafOnly:function(){return!this.config.checkStrictly},readonly:function(){return!this.filterable||this.multiple},clearBtnVisible:function(){return!(!this.clearable||this.isDisabled||this.filtering||!this.inputHover)&&(this.multiple?!!this.checkedNodes.filter((function(e){return!e.isDisabled})).length:!!this.presentText)},panel:function(){return this.$refs.panel}},watch:{disabled:function(){this.computePresentContent()},value:function(e){Object(v["isEqual"])(e,this.checkedValue)||(this.checkedValue=e,this.computePresentContent())},checkedValue:function(e){var t=this.value,r=this.dropDownVisible,i=this.config,n=i.checkStrictly,o=i.multiple;Object(v["isEqual"])(e,t)&&!Object(Hd["isUndefined"])(t)||(this.computePresentContent(),o||n||!r||this.toggleDropDownVisible(!1),this.$emit("input",e),this.$emit("change",e),this.dispatch("ElFormItem","el.form.change",[e]))},options:{handler:function(){this.$nextTick(this.computePresentContent)},deep:!0},presentText:function(e){this.inputValue=e},presentTags:function(e,t){this.multiple&&(e.length||t.length)&&this.$nextTick(this.updateStyle)},filtering:function(e){this.$nextTick(this.updatePopper)}},mounted:function(){var e=this,t=this.$refs.input;t&&t.$el&&(this.inputInitialHeight=t.$el.offsetHeight||Tp[this.realSize]||40),this.isEmptyValue(this.value)||this.computePresentContent(),this.filterHandler=B()(this.debounce,(function(){var t=e.inputValue;if(t){var r=e.beforeFilter(t);r&&r.then?r.then(e.getSuggestions):!1!==r?e.getSuggestions():e.filtering=!1}else e.filtering=!1})),Object(Xr["addResizeListener"])(this.$el,this.updateStyle)},beforeDestroy:function(){Object(Xr["removeResizeListener"])(this.$el,this.updateStyle)},methods:{getMigratingConfig:function(){return{props:{"expand-trigger":"expand-trigger is removed, use `props.expandTrigger` instead.","change-on-select":"change-on-select is removed, use `props.checkStrictly` instead.","hover-threshold":"hover-threshold is removed, use `props.hoverThreshold` instead"},events:{"active-item-change":"active-item-change is renamed to expand-change"}}},toggleDropDownVisible:function(e){var t=this;if(!this.isDisabled){var r=this.dropDownVisible,i=this.$refs.input;e=Object(It["isDef"])(e)?e:!r,e!==r&&(this.dropDownVisible=e,e&&this.$nextTick((function(){t.updatePopper(),t.panel.scrollIntoView()})),i.$refs.input.setAttribute("aria-expanded",e),this.$emit("visible-change",e))}},handleDropdownLeave:function(){this.filtering=!1,this.inputValue=this.presentText,this.doDestroy()},handleKeyDown:function(e){switch(e.keyCode){case yp.enter:this.toggleDropDownVisible();break;case yp.down:this.toggleDropDownVisible(!0),this.focusFirstNode(),e.preventDefault();break;case yp.esc:case yp.tab:this.toggleDropDownVisible(!1);break}},handleFocus:function(e){this.$emit("focus",e)},handleBlur:function(e){this.$emit("blur",e)},handleInput:function(e,t){!this.dropDownVisible&&this.toggleDropDownVisible(!0),t&&t.isComposing||(e?this.filterHandler():this.filtering=!1)},handleClear:function(){this.presentText="",this.panel.clearCheckedNodes()},handleExpandChange:function(e){this.$nextTick(this.updatePopper.bind(this)),this.$emit("expand-change",e),this.$emit("active-item-change",e)},focusFirstNode:function(){var e=this;this.$nextTick((function(){var t=e.filtering,r=e.$refs,i=r.popper,n=r.suggestionPanel,o=null;if(t&&n)o=n.$el.querySelector(".el-cascader__suggestion-item");else{var s=i.querySelector(".el-cascader-menu");o=s.querySelector('.el-cascader-node[tabindex="-1"]')}o&&(o.focus(),!t&&o.click())}))},computePresentContent:function(){var e=this;this.$nextTick((function(){e.config.multiple?(e.computePresentTags(),e.presentText=e.presentTags.length?" ":null):e.computePresentText()}))},isEmptyValue:function(e){var t=this.multiple,r=this.panel.config.emitPath;return!(!t&&!r)&&Object(v["isEmpty"])(e)},computePresentText:function(){var e=this.checkedValue,t=this.config;if(!this.isEmptyValue(e)){var r=this.panel.getNodeByValue(e);if(r&&(t.checkStrictly||r.isLeaf))return void(this.presentText=r.getText(this.showAllLevels,this.separator))}this.presentText=null},computePresentTags:function(){var e=this.isDisabled,t=this.leafOnly,r=this.showAllLevels,i=this.separator,n=this.collapseTags,o=this.getCheckedNodes(t),s=[],a=function(t){return{node:t,key:t.uid,text:t.getText(r,i),hitState:!1,closable:!e&&!t.isDisabled}};if(o.length){var c=o[0],l=o.slice(1),u=l.length;s.push(a(c)),u&&(n?s.push({key:-1,text:"+ "+u,closable:!1}):l.forEach((function(e){return s.push(a(e))})))}this.checkedNodes=o,this.presentTags=s},getSuggestions:function(){var e=this,t=this.filterMethod;Object(Hd["isFunction"])(t)||(t=function(e,t){return e.text.includes(t)});var r=this.panel.getFlattedNodes(this.leafOnly).filter((function(r){return!r.isDisabled&&(r.text=r.getText(e.showAllLevels,e.separator)||"",t(r,e.inputValue))}));this.multiple?this.presentTags.forEach((function(e){e.hitState=!1})):r.forEach((function(t){t.checked=Object(v["isEqual"])(e.checkedValue,t.getValueByOption())})),this.filtering=!0,this.suggestions=r,this.$nextTick(this.updatePopper)},handleSuggestionKeyDown:function(e){var t=e.keyCode,r=e.target;switch(t){case yp.enter:r.click();break;case yp.up:var i=r.previousElementSibling;i&&i.focus();break;case yp.down:var n=r.nextElementSibling;n&&n.focus();break;case yp.esc:case yp.tab:this.toggleDropDownVisible(!1);break}},handleDelete:function(){var e=this.inputValue,t=this.pressDeleteCount,r=this.presentTags,i=r.length-1,n=r[i];this.pressDeleteCount=e?0:t+1,n&&this.pressDeleteCount&&(n.hitState?this.deleteTag(n):n.hitState=!0)},handleSuggestionClick:function(e){var t=this.multiple,r=this.suggestions[e];if(t){var i=r.checked;r.doCheck(!i),this.panel.calculateMultiCheckedValue()}else this.checkedValue=r.getValueByOption(),this.toggleDropDownVisible(!1)},deleteTag:function(e){var t=this.checkedValue,r=e.node.getValueByOption(),i=t.find((function(e){return Object(v["isEqual"])(e,r)}));this.checkedValue=t.filter((function(e){return!Object(v["isEqual"])(e,r)})),this.$emit("remove-tag",i)},updateStyle:function(){var e=this.$el,t=this.inputInitialHeight;if(!this.$isServer&&e){var r=this.$refs.suggestionPanel,i=e.querySelector(".el-input__inner");if(i){var n=e.querySelector(".el-cascader__tags"),o=null;if(r&&(o=r.$el)){var s=o.querySelector(".el-cascader__suggestion-list");s.style.minWidth=i.offsetWidth+"px"}if(n){var a=Math.round(n.getBoundingClientRect().height),c=Math.max(a+6,t)+"px";i.style.height=c,this.dropDownVisible&&this.updatePopper()}}}},getCheckedNodes:function(e){return this.panel.getCheckedNodes(e)}}},Ip=bp,Rp=a(Ip,gp,mp,!1,null,null,null);Rp.options.__file="packages/cascader/src/cascader.vue";var wp=Rp.exports;wp.install=function(e){e.component(wp.name,wp)};var kp=wp,Op=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.hide,expression:"hide"}],class:["el-color-picker",e.colorDisabled?"is-disabled":"",e.colorSize?"el-color-picker--"+e.colorSize:""]},[e.colorDisabled?r("div",{staticClass:"el-color-picker__mask"}):e._e(),r("div",{staticClass:"el-color-picker__trigger",on:{click:e.handleTrigger}},[r("span",{staticClass:"el-color-picker__color",class:{"is-alpha":e.showAlpha}},[r("span",{staticClass:"el-color-picker__color-inner",style:{backgroundColor:e.displayedColor}}),e.value||e.showPanelColor?e._e():r("span",{staticClass:"el-color-picker__empty el-icon-close"})]),r("span",{directives:[{name:"show",rawName:"v-show",value:e.value||e.showPanelColor,expression:"value || showPanelColor"}],staticClass:"el-color-picker__icon el-icon-arrow-down"})]),r("picker-dropdown",{ref:"dropdown",class:["el-color-picker__panel",e.popperClass||""],attrs:{color:e.color,"show-alpha":e.showAlpha,predefine:e.predefine},on:{pick:e.confirmValue,clear:e.clearValue},model:{value:e.showPicker,callback:function(t){e.showPicker=t},expression:"showPicker"}})],1)},Np=[];Op._withStripped=!0;var Lp="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function Pp(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Dp=function(e,t,r){return[e,t*r/((e=(2-t)*r)<1?e:2-e)||0,e/2]},Mp=function(e){return"string"===typeof e&&-1!==e.indexOf(".")&&1===parseFloat(e)},xp=function(e){return"string"===typeof e&&-1!==e.indexOf("%")},Bp=function(e,t){Mp(e)&&(e="100%");var r=xp(e);return e=Math.min(t,Math.max(0,parseFloat(e))),r&&(e=parseInt(e*t,10)/100),Math.abs(e-t)<1e-6?1:e%t/parseFloat(t)},Up={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},Fp=function(e){var t=e.r,r=e.g,i=e.b,n=function(e){e=Math.min(Math.round(e),255);var t=Math.floor(e/16),r=e%16;return""+(Up[t]||t)+(Up[r]||r)};return isNaN(t)||isNaN(r)||isNaN(i)?"":"#"+n(t)+n(r)+n(i)},Vp={A:10,B:11,C:12,D:13,E:14,F:15},jp=function(e){return 2===e.length?16*(Vp[e[0].toUpperCase()]||+e[0])+(Vp[e[1].toUpperCase()]||+e[1]):Vp[e[1].toUpperCase()]||+e[1]},Gp=function(e,t,r){t/=100,r/=100;var i=t,n=Math.max(r,.01),o=void 0,s=void 0;return r*=2,t*=r<=1?r:2-r,i*=n<=1?n:2-n,s=(r+t)/2,o=0===r?2*i/(n+i):2*t/(r+t),{h:e,s:100*o,v:100*s}},Hp=function(e,t,r){e=Bp(e,255),t=Bp(t,255),r=Bp(r,255);var i=Math.max(e,t,r),n=Math.min(e,t,r),o=void 0,s=void 0,a=i,c=i-n;if(s=0===i?0:c/i,i===n)o=0;else{switch(i){case e:o=(t-r)/c+(t<r?6:0);break;case t:o=(r-e)/c+2;break;case r:o=(e-t)/c+4;break}o/=6}return{h:360*o,s:100*s,v:100*a}},Qp=function(e,t,r){e=6*Bp(e,360),t=Bp(t,100),r=Bp(r,100);var i=Math.floor(e),n=e-i,o=r*(1-t),s=r*(1-n*t),a=r*(1-(1-n)*t),c=i%6,l=[r,s,o,o,a,r][c],u=[a,r,r,s,o,o][c],d=[o,o,a,r,r,s][c];return{r:Math.round(255*l),g:Math.round(255*u),b:Math.round(255*d)}},Wp=function(){function e(t){for(var r in Pp(this,e),this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this.enableAlpha=!1,this.format="hex",this.value="",t=t||{},t)t.hasOwnProperty(r)&&(this[r]=t[r]);this.doOnChange()}return e.prototype.set=function(e,t){if(1!==arguments.length||"object"!==("undefined"===typeof e?"undefined":Lp(e)))this["_"+e]=t,this.doOnChange();else for(var r in e)e.hasOwnProperty(r)&&this.set(r,e[r])},e.prototype.get=function(e){return this["_"+e]},e.prototype.toRgb=function(){return Qp(this._hue,this._saturation,this._value)},e.prototype.fromString=function(e){var t=this;if(!e)return this._hue=0,this._saturation=100,this._value=100,void this.doOnChange();var r=function(e,r,i){t._hue=Math.max(0,Math.min(360,e)),t._saturation=Math.max(0,Math.min(100,r)),t._value=Math.max(0,Math.min(100,i)),t.doOnChange()};if(-1!==e.indexOf("hsl")){var i=e.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter((function(e){return""!==e})).map((function(e,t){return t>2?parseFloat(e):parseInt(e,10)}));if(4===i.length?this._alpha=Math.floor(100*parseFloat(i[3])):3===i.length&&(this._alpha=100),i.length>=3){var n=Gp(i[0],i[1],i[2]),o=n.h,s=n.s,a=n.v;r(o,s,a)}}else if(-1!==e.indexOf("hsv")){var c=e.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter((function(e){return""!==e})).map((function(e,t){return t>2?parseFloat(e):parseInt(e,10)}));4===c.length?this._alpha=Math.floor(100*parseFloat(c[3])):3===c.length&&(this._alpha=100),c.length>=3&&r(c[0],c[1],c[2])}else if(-1!==e.indexOf("rgb")){var l=e.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter((function(e){return""!==e})).map((function(e,t){return t>2?parseFloat(e):parseInt(e,10)}));if(4===l.length?this._alpha=Math.floor(100*parseFloat(l[3])):3===l.length&&(this._alpha=100),l.length>=3){var u=Hp(l[0],l[1],l[2]),d=u.h,h=u.s,p=u.v;r(d,h,p)}}else if(-1!==e.indexOf("#")){var f=e.replace("#","").trim();if(!/^(?:[0-9a-fA-F]{3}){1,2}|[0-9a-fA-F]{8}$/.test(f))return;var g=void 0,m=void 0,_=void 0;3===f.length?(g=jp(f[0]+f[0]),m=jp(f[1]+f[1]),_=jp(f[2]+f[2])):6!==f.length&&8!==f.length||(g=jp(f.substring(0,2)),m=jp(f.substring(2,4)),_=jp(f.substring(4,6))),8===f.length?this._alpha=Math.floor(jp(f.substring(6))/255*100):3!==f.length&&6!==f.length||(this._alpha=100);var v=Hp(g,m,_),E=v.h,A=v.s,y=v.v;r(E,A,y)}},e.prototype.compare=function(e){return Math.abs(e._hue-this._hue)<2&&Math.abs(e._saturation-this._saturation)<1&&Math.abs(e._value-this._value)<1&&Math.abs(e._alpha-this._alpha)<1},e.prototype.doOnChange=function(){var e=this._hue,t=this._saturation,r=this._value,i=this._alpha,n=this.format;if(this.enableAlpha)switch(n){case"hsl":var o=Dp(e,t/100,r/100);this.value="hsla("+e+", "+Math.round(100*o[1])+"%, "+Math.round(100*o[2])+"%, "+i/100+")";break;case"hsv":this.value="hsva("+e+", "+Math.round(t)+"%, "+Math.round(r)+"%, "+i/100+")";break;default:var s=Qp(e,t,r),a=s.r,c=s.g,l=s.b;this.value="rgba("+a+", "+c+", "+l+", "+i/100+")"}else switch(n){case"hsl":var u=Dp(e,t/100,r/100);this.value="hsl("+e+", "+Math.round(100*u[1])+"%, "+Math.round(100*u[2])+"%)";break;case"hsv":this.value="hsv("+e+", "+Math.round(t)+"%, "+Math.round(r)+"%)";break;case"rgb":var d=Qp(e,t,r),h=d.r,p=d.g,f=d.b;this.value="rgb("+h+", "+p+", "+f+")";break;default:this.value=Fp(Qp(e,t,r))}},e}(),qp=Wp,zp=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition",{attrs:{name:"el-zoom-in-top"},on:{"after-leave":e.doDestroy}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.showPopper,expression:"showPopper"}],staticClass:"el-color-dropdown"},[r("div",{staticClass:"el-color-dropdown__main-wrapper"},[r("hue-slider",{ref:"hue",staticStyle:{float:"right"},attrs:{color:e.color,vertical:""}}),r("sv-panel",{ref:"sl",attrs:{color:e.color}})],1),e.showAlpha?r("alpha-slider",{ref:"alpha",attrs:{color:e.color}}):e._e(),e.predefine?r("predefine",{attrs:{color:e.color,colors:e.predefine}}):e._e(),r("div",{staticClass:"el-color-dropdown__btns"},[r("span",{staticClass:"el-color-dropdown__value"},[r("el-input",{attrs:{"validate-event":!1,size:"mini"},on:{blur:e.handleConfirm},nativeOn:{keyup:function(t){return!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleConfirm(t)}},model:{value:e.customInput,callback:function(t){e.customInput=t},expression:"customInput"}})],1),r("el-button",{staticClass:"el-color-dropdown__link-btn",attrs:{size:"mini",type:"text"},on:{click:function(t){e.$emit("clear")}}},[e._v("\n        "+e._s(e.t("el.colorpicker.clear"))+"\n      ")]),r("el-button",{staticClass:"el-color-dropdown__btn",attrs:{plain:"",size:"mini"},on:{click:e.confirmValue}},[e._v("\n        "+e._s(e.t("el.colorpicker.confirm"))+"\n      ")])],1)],1)])},Zp=[];zp._withStripped=!0;var Yp=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-color-svpanel",style:{backgroundColor:e.background}},[r("div",{staticClass:"el-color-svpanel__white"}),r("div",{staticClass:"el-color-svpanel__black"}),r("div",{staticClass:"el-color-svpanel__cursor",style:{top:e.cursorTop+"px",left:e.cursorLeft+"px"}},[r("div")])])},Kp=[];Yp._withStripped=!0;var $p=!1,Jp=function(e,t){if(!ji.a.prototype.$isServer){var r=function(e){t.drag&&t.drag(e)},i=function e(i){document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",e),document.onselectstart=null,document.ondragstart=null,$p=!1,t.end&&t.end(i)};e.addEventListener("mousedown",(function(e){$p||(document.onselectstart=function(){return!1},document.ondragstart=function(){return!1},document.addEventListener("mousemove",r),document.addEventListener("mouseup",i),$p=!0,t.start&&t.start(e))}))}},Xp={name:"el-sl-panel",props:{color:{required:!0}},computed:{colorValue:function(){var e=this.color.get("hue"),t=this.color.get("value");return{hue:e,value:t}}},watch:{colorValue:function(){this.update()}},methods:{update:function(){var e=this.color.get("saturation"),t=this.color.get("value"),r=this.$el,i=r.clientWidth,n=r.clientHeight;this.cursorLeft=e*i/100,this.cursorTop=(100-t)*n/100,this.background="hsl("+this.color.get("hue")+", 100%, 50%)"},handleDrag:function(e){var t=this.$el,r=t.getBoundingClientRect(),i=e.clientX-r.left,n=e.clientY-r.top;i=Math.max(0,i),i=Math.min(i,r.width),n=Math.max(0,n),n=Math.min(n,r.height),this.cursorLeft=i,this.cursorTop=n,this.color.set({saturation:i/r.width*100,value:100-n/r.height*100})}},mounted:function(){var e=this;Jp(this.$el,{drag:function(t){e.handleDrag(t)},end:function(t){e.handleDrag(t)}}),this.update()},data:function(){return{cursorTop:0,cursorLeft:0,background:"hsl(0, 100%, 50%)"}}},ef=Xp,tf=a(ef,Yp,Kp,!1,null,null,null);tf.options.__file="packages/color-picker/src/components/sv-panel.vue";var rf=tf.exports,nf=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-color-hue-slider",class:{"is-vertical":e.vertical}},[r("div",{ref:"bar",staticClass:"el-color-hue-slider__bar",on:{click:e.handleClick}}),r("div",{ref:"thumb",staticClass:"el-color-hue-slider__thumb",style:{left:e.thumbLeft+"px",top:e.thumbTop+"px"}})])},of=[];nf._withStripped=!0;var sf={name:"el-color-hue-slider",props:{color:{required:!0},vertical:Boolean},data:function(){return{thumbLeft:0,thumbTop:0}},computed:{hueValue:function(){var e=this.color.get("hue");return e}},watch:{hueValue:function(){this.update()}},methods:{handleClick:function(e){var t=this.$refs.thumb,r=e.target;r!==t&&this.handleDrag(e)},handleDrag:function(e){var t=this.$el.getBoundingClientRect(),r=this.$refs.thumb,i=void 0;if(this.vertical){var n=e.clientY-t.top;n=Math.min(n,t.height-r.offsetHeight/2),n=Math.max(r.offsetHeight/2,n),i=Math.round((n-r.offsetHeight/2)/(t.height-r.offsetHeight)*360)}else{var o=e.clientX-t.left;o=Math.min(o,t.width-r.offsetWidth/2),o=Math.max(r.offsetWidth/2,o),i=Math.round((o-r.offsetWidth/2)/(t.width-r.offsetWidth)*360)}this.color.set("hue",i)},getThumbLeft:function(){if(this.vertical)return 0;var e=this.$el,t=this.color.get("hue");if(!e)return 0;var r=this.$refs.thumb;return Math.round(t*(e.offsetWidth-r.offsetWidth/2)/360)},getThumbTop:function(){if(!this.vertical)return 0;var e=this.$el,t=this.color.get("hue");if(!e)return 0;var r=this.$refs.thumb;return Math.round(t*(e.offsetHeight-r.offsetHeight/2)/360)},update:function(){this.thumbLeft=this.getThumbLeft(),this.thumbTop=this.getThumbTop()}},mounted:function(){var e=this,t=this.$refs,r=t.bar,i=t.thumb,n={drag:function(t){e.handleDrag(t)},end:function(t){e.handleDrag(t)}};Jp(r,n),Jp(i,n),this.update()}},af=sf,cf=a(af,nf,of,!1,null,null,null);cf.options.__file="packages/color-picker/src/components/hue-slider.vue";var lf=cf.exports,uf=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-color-alpha-slider",class:{"is-vertical":e.vertical}},[r("div",{ref:"bar",staticClass:"el-color-alpha-slider__bar",style:{background:e.background},on:{click:e.handleClick}}),r("div",{ref:"thumb",staticClass:"el-color-alpha-slider__thumb",style:{left:e.thumbLeft+"px",top:e.thumbTop+"px"}})])},df=[];uf._withStripped=!0;var hf={name:"el-color-alpha-slider",props:{color:{required:!0},vertical:Boolean},watch:{"color._alpha":function(){this.update()},"color.value":function(){this.update()}},methods:{handleClick:function(e){var t=this.$refs.thumb,r=e.target;r!==t&&this.handleDrag(e)},handleDrag:function(e){var t=this.$el.getBoundingClientRect(),r=this.$refs.thumb;if(this.vertical){var i=e.clientY-t.top;i=Math.max(r.offsetHeight/2,i),i=Math.min(i,t.height-r.offsetHeight/2),this.color.set("alpha",Math.round((i-r.offsetHeight/2)/(t.height-r.offsetHeight)*100))}else{var n=e.clientX-t.left;n=Math.max(r.offsetWidth/2,n),n=Math.min(n,t.width-r.offsetWidth/2),this.color.set("alpha",Math.round((n-r.offsetWidth/2)/(t.width-r.offsetWidth)*100))}},getThumbLeft:function(){if(this.vertical)return 0;var e=this.$el,t=this.color._alpha;if(!e)return 0;var r=this.$refs.thumb;return Math.round(t*(e.offsetWidth-r.offsetWidth/2)/100)},getThumbTop:function(){if(!this.vertical)return 0;var e=this.$el,t=this.color._alpha;if(!e)return 0;var r=this.$refs.thumb;return Math.round(t*(e.offsetHeight-r.offsetHeight/2)/100)},getBackground:function(){if(this.color&&this.color.value){var e=this.color.toRgb(),t=e.r,r=e.g,i=e.b;return"linear-gradient(to right, rgba("+t+", "+r+", "+i+", 0) 0%, rgba("+t+", "+r+", "+i+", 1) 100%)"}return null},update:function(){this.thumbLeft=this.getThumbLeft(),this.thumbTop=this.getThumbTop(),this.background=this.getBackground()}},data:function(){return{thumbLeft:0,thumbTop:0,background:null}},mounted:function(){var e=this,t=this.$refs,r=t.bar,i=t.thumb,n={drag:function(t){e.handleDrag(t)},end:function(t){e.handleDrag(t)}};Jp(r,n),Jp(i,n),this.update()}},pf=hf,ff=a(pf,uf,df,!1,null,null,null);ff.options.__file="packages/color-picker/src/components/alpha-slider.vue";var gf=ff.exports,mf=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-color-predefine"},[r("div",{staticClass:"el-color-predefine__colors"},e._l(e.rgbaColors,(function(t,i){return r("div",{key:e.colors[i],staticClass:"el-color-predefine__color-selector",class:{selected:t.selected,"is-alpha":t._alpha<100},on:{click:function(t){e.handleSelect(i)}}},[r("div",{style:{"background-color":t.value}})])})),0)])},_f=[];mf._withStripped=!0;var vf={props:{colors:{type:Array,required:!0},color:{required:!0}},data:function(){return{rgbaColors:this.parseColors(this.colors,this.color)}},methods:{handleSelect:function(e){this.color.fromString(this.colors[e])},parseColors:function(e,t){return e.map((function(e){var r=new qp;return r.enableAlpha=!0,r.format="rgba",r.fromString(e),r.selected=r.value===t.value,r}))}},watch:{"$parent.currentColor":function(e){var t=new qp;t.fromString(e),this.rgbaColors.forEach((function(e){e.selected=t.compare(e)}))},colors:function(e){this.rgbaColors=this.parseColors(e,this.color)},color:function(e){this.rgbaColors=this.parseColors(this.colors,e)}}},Ef=vf,Af=a(Ef,mf,_f,!1,null,null,null);Af.options.__file="packages/color-picker/src/components/predefine.vue";var yf=Af.exports,Sf={name:"el-color-picker-dropdown",mixins:[H.a,_.a],components:{SvPanel:rf,HueSlider:lf,AlphaSlider:gf,ElInput:g.a,ElButton:se.a,Predefine:yf},props:{color:{required:!0},showAlpha:Boolean,predefine:Array},data:function(){return{customInput:""}},computed:{currentColor:function(){var e=this.$parent;return e.value||e.showPanelColor?e.color.value:""}},methods:{confirmValue:function(){this.$emit("pick")},handleConfirm:function(){this.color.fromString(this.customInput)}},mounted:function(){this.$parent.popperElm=this.popperElm=this.$el,this.referenceElm=this.$parent.$el},watch:{showPopper:function(e){var t=this;!0===e&&this.$nextTick((function(){var e=t.$refs,r=e.sl,i=e.hue,n=e.alpha;r&&r.update(),i&&i.update(),n&&n.update()}))},currentColor:{immediate:!0,handler:function(e){this.customInput=e}}}},Cf=Sf,Tf=a(Cf,zp,Zp,!1,null,null,null);Tf.options.__file="packages/color-picker/src/components/picker-dropdown.vue";var bf=Tf.exports,If={name:"ElColorPicker",mixins:[w.a],props:{value:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:String,popperClass:String,predefine:Array},inject:{elForm:{default:""},elFormItem:{default:""}},directives:{Clickoutside:F.a},computed:{displayedColor:function(){return this.value||this.showPanelColor?this.displayedRgb(this.color,this.showAlpha):"transparent"},_elFormItemSize:function(){return(this.elFormItem||{}).elFormItemSize},colorSize:function(){return this.size||this._elFormItemSize||(this.$ELEMENT||{}).size},colorDisabled:function(){return this.disabled||(this.elForm||{}).disabled}},watch:{value:function(e){e?e&&e!==this.color.value&&this.color.fromString(e):this.showPanelColor=!1},color:{deep:!0,handler:function(){this.showPanelColor=!0}},displayedColor:function(e){if(this.showPicker){var t=new qp({enableAlpha:this.showAlpha,format:this.colorFormat});t.fromString(this.value);var r=this.displayedRgb(t,this.showAlpha);e!==r&&this.$emit("active-change",e)}}},methods:{handleTrigger:function(){this.colorDisabled||(this.showPicker=!this.showPicker)},confirmValue:function(){var e=this.color.value;this.$emit("input",e),this.$emit("change",e),this.dispatch("ElFormItem","el.form.change",e),this.showPicker=!1},clearValue:function(){this.$emit("input",null),this.$emit("change",null),null!==this.value&&this.dispatch("ElFormItem","el.form.change",null),this.showPanelColor=!1,this.showPicker=!1,this.resetColor()},hide:function(){this.showPicker=!1,this.resetColor()},resetColor:function(){var e=this;this.$nextTick((function(t){e.value?e.color.fromString(e.value):e.showPanelColor=!1}))},displayedRgb:function(e,t){if(!(e instanceof qp))throw Error("color should be instance of Color Class");var r=e.toRgb(),i=r.r,n=r.g,o=r.b;return t?"rgba("+i+", "+n+", "+o+", "+e.get("alpha")/100+")":"rgb("+i+", "+n+", "+o+")"}},mounted:function(){var e=this.value;e&&this.color.fromString(e),this.popperElm=this.$refs.dropdown.$el},data:function(){var e=new qp({enableAlpha:this.showAlpha,format:this.colorFormat});return{color:e,showPicker:!1,showPanelColor:!1}},components:{PickerDropdown:bf}},Rf=If,wf=a(Rf,Op,Np,!1,null,null,null);wf.options.__file="packages/color-picker/src/main.vue";var kf=wf.exports;kf.install=function(e){e.component(kf.name,kf)};var Of=kf,Nf=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-transfer"},[r("transfer-panel",e._b({ref:"leftPanel",attrs:{data:e.sourceData,title:e.titles[0]||e.t("el.transfer.titles.0"),"default-checked":e.leftDefaultChecked,placeholder:e.filterPlaceholder||e.t("el.transfer.filterPlaceholder")},on:{"checked-change":e.onSourceCheckedChange}},"transfer-panel",e.$props,!1),[e._t("left-footer")],2),r("div",{staticClass:"el-transfer__buttons"},[r("el-button",{class:["el-transfer__button",e.hasButtonTexts?"is-with-texts":""],attrs:{type:"primary",disabled:0===e.rightChecked.length},nativeOn:{click:function(t){return e.addToLeft(t)}}},[r("i",{staticClass:"el-icon-arrow-left"}),void 0!==e.buttonTexts[0]?r("span",[e._v(e._s(e.buttonTexts[0]))]):e._e()]),r("el-button",{class:["el-transfer__button",e.hasButtonTexts?"is-with-texts":""],attrs:{type:"primary",disabled:0===e.leftChecked.length},nativeOn:{click:function(t){return e.addToRight(t)}}},[void 0!==e.buttonTexts[1]?r("span",[e._v(e._s(e.buttonTexts[1]))]):e._e(),r("i",{staticClass:"el-icon-arrow-right"})])],1),r("transfer-panel",e._b({ref:"rightPanel",attrs:{data:e.targetData,title:e.titles[1]||e.t("el.transfer.titles.1"),"default-checked":e.rightDefaultChecked,placeholder:e.filterPlaceholder||e.t("el.transfer.filterPlaceholder")},on:{"checked-change":e.onTargetCheckedChange}},"transfer-panel",e.$props,!1),[e._t("right-footer")],2)],1)},Lf=[];Nf._withStripped=!0;var Pf=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-transfer-panel"},[r("p",{staticClass:"el-transfer-panel__header"},[r("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleAllCheckedChange},model:{value:e.allChecked,callback:function(t){e.allChecked=t},expression:"allChecked"}},[e._v("\n      "+e._s(e.title)+"\n      "),r("span",[e._v(e._s(e.checkedSummary))])])],1),r("div",{class:["el-transfer-panel__body",e.hasFooter?"is-with-footer":""]},[e.filterable?r("el-input",{staticClass:"el-transfer-panel__filter",attrs:{size:"small",placeholder:e.placeholder},nativeOn:{mouseenter:function(t){e.inputHover=!0},mouseleave:function(t){e.inputHover=!1}},model:{value:e.query,callback:function(t){e.query=t},expression:"query"}},[r("i",{class:["el-input__icon","el-icon-"+e.inputIcon],attrs:{slot:"prefix"},on:{click:e.clearQuery},slot:"prefix"})]):e._e(),r("el-checkbox-group",{directives:[{name:"show",rawName:"v-show",value:!e.hasNoMatch&&e.data.length>0,expression:"!hasNoMatch && data.length > 0"}],staticClass:"el-transfer-panel__list",class:{"is-filterable":e.filterable},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},e._l(e.filteredData,(function(t){return r("el-checkbox",{key:t[e.keyProp],staticClass:"el-transfer-panel__item",attrs:{label:t[e.keyProp],disabled:t[e.disabledProp]}},[r("option-content",{attrs:{option:t}})],1)})),1),r("p",{directives:[{name:"show",rawName:"v-show",value:e.hasNoMatch,expression:"hasNoMatch"}],staticClass:"el-transfer-panel__empty"},[e._v(e._s(e.t("el.transfer.noMatch")))]),r("p",{directives:[{name:"show",rawName:"v-show",value:0===e.data.length&&!e.hasNoMatch,expression:"data.length === 0 && !hasNoMatch"}],staticClass:"el-transfer-panel__empty"},[e._v(e._s(e.t("el.transfer.noData")))])],1),e.hasFooter?r("p",{staticClass:"el-transfer-panel__footer"},[e._t("default")],2):e._e()])},Df=[];Pf._withStripped=!0;var Mf={mixins:[_.a],name:"ElTransferPanel",componentName:"ElTransferPanel",components:{ElCheckboxGroup:On.a,ElCheckbox:Pi.a,ElInput:g.a,OptionContent:{props:{option:Object},render:function(e){var t=function e(t){return"ElTransferPanel"===t.$options.componentName?t:t.$parent?e(t.$parent):t},r=t(this),i=r.$parent||r;return r.renderContent?r.renderContent(e,this.option):i.$scopedSlots.default?i.$scopedSlots.default({option:this.option}):e("span",[this.option[r.labelProp]||this.option[r.keyProp]])}}},props:{data:{type:Array,default:function(){return[]}},renderContent:Function,placeholder:String,title:String,filterable:Boolean,format:Object,filterMethod:Function,defaultChecked:Array,props:Object},data:function(){return{checked:[],allChecked:!1,query:"",inputHover:!1,checkChangeByUser:!0}},watch:{checked:function(e,t){if(this.updateAllChecked(),this.checkChangeByUser){var r=e.concat(t).filter((function(r){return-1===e.indexOf(r)||-1===t.indexOf(r)}));this.$emit("checked-change",e,r)}else this.$emit("checked-change",e),this.checkChangeByUser=!0},data:function(){var e=this,t=[],r=this.filteredData.map((function(t){return t[e.keyProp]}));this.checked.forEach((function(e){r.indexOf(e)>-1&&t.push(e)})),this.checkChangeByUser=!1,this.checked=t},checkableData:function(){this.updateAllChecked()},defaultChecked:{immediate:!0,handler:function(e,t){var r=this;if(!t||e.length!==t.length||!e.every((function(e){return t.indexOf(e)>-1}))){var i=[],n=this.checkableData.map((function(e){return e[r.keyProp]}));e.forEach((function(e){n.indexOf(e)>-1&&i.push(e)})),this.checkChangeByUser=!1,this.checked=i}}}},computed:{filteredData:function(){var e=this;return this.data.filter((function(t){if("function"===typeof e.filterMethod)return e.filterMethod(e.query,t);var r=t[e.labelProp]||t[e.keyProp].toString();return r.toLowerCase().indexOf(e.query.toLowerCase())>-1}))},checkableData:function(){var e=this;return this.filteredData.filter((function(t){return!t[e.disabledProp]}))},checkedSummary:function(){var e=this.checked.length,t=this.data.length,r=this.format,i=r.noChecked,n=r.hasChecked;return i&&n?e>0?n.replace(/\${checked}/g,e).replace(/\${total}/g,t):i.replace(/\${total}/g,t):e+"/"+t},isIndeterminate:function(){var e=this.checked.length;return e>0&&e<this.checkableData.length},hasNoMatch:function(){return this.query.length>0&&0===this.filteredData.length},inputIcon:function(){return this.query.length>0&&this.inputHover?"circle-close":"search"},labelProp:function(){return this.props.label||"label"},keyProp:function(){return this.props.key||"key"},disabledProp:function(){return this.props.disabled||"disabled"},hasFooter:function(){return!!this.$slots.default}},methods:{updateAllChecked:function(){var e=this,t=this.checkableData.map((function(t){return t[e.keyProp]}));this.allChecked=t.length>0&&t.every((function(t){return e.checked.indexOf(t)>-1}))},handleAllCheckedChange:function(e){var t=this;this.checked=e?this.checkableData.map((function(e){return e[t.keyProp]})):[]},clearQuery:function(){"circle-close"===this.inputIcon&&(this.query="")}}},xf=Mf,Bf=a(xf,Pf,Df,!1,null,null,null);Bf.options.__file="packages/transfer/src/transfer-panel.vue";var Uf=Bf.exports,Ff={name:"ElTransfer",mixins:[w.a,_.a,I.a],components:{TransferPanel:Uf,ElButton:se.a},props:{data:{type:Array,default:function(){return[]}},titles:{type:Array,default:function(){return[]}},buttonTexts:{type:Array,default:function(){return[]}},filterPlaceholder:{type:String,default:""},filterMethod:Function,leftDefaultChecked:{type:Array,default:function(){return[]}},rightDefaultChecked:{type:Array,default:function(){return[]}},renderContent:Function,value:{type:Array,default:function(){return[]}},format:{type:Object,default:function(){return{}}},filterable:Boolean,props:{type:Object,default:function(){return{label:"label",key:"key",disabled:"disabled"}}},targetOrder:{type:String,default:"original"}},data:function(){return{leftChecked:[],rightChecked:[]}},computed:{dataObj:function(){var e=this.props.key;return this.data.reduce((function(t,r){return(t[r[e]]=r)&&t}),{})},sourceData:function(){var e=this;return this.data.filter((function(t){return-1===e.value.indexOf(t[e.props.key])}))},targetData:function(){var e=this;return"original"===this.targetOrder?this.data.filter((function(t){return e.value.indexOf(t[e.props.key])>-1})):this.value.reduce((function(t,r){var i=e.dataObj[r];return i&&t.push(i),t}),[])},hasButtonTexts:function(){return 2===this.buttonTexts.length}},watch:{value:function(e){this.dispatch("ElFormItem","el.form.change",e)}},methods:{getMigratingConfig:function(){return{props:{"footer-format":"footer-format is renamed to format."}}},onSourceCheckedChange:function(e,t){this.leftChecked=e,void 0!==t&&this.$emit("left-check-change",e,t)},onTargetCheckedChange:function(e,t){this.rightChecked=e,void 0!==t&&this.$emit("right-check-change",e,t)},addToLeft:function(){var e=this.value.slice();this.rightChecked.forEach((function(t){var r=e.indexOf(t);r>-1&&e.splice(r,1)})),this.$emit("input",e),this.$emit("change",e,"left",this.rightChecked)},addToRight:function(){var e=this,t=this.value.slice(),r=[],i=this.props.key;this.data.forEach((function(t){var n=t[i];e.leftChecked.indexOf(n)>-1&&-1===e.value.indexOf(n)&&r.push(n)})),t="unshift"===this.targetOrder?r.concat(t):t.concat(r),this.$emit("input",t),this.$emit("change",t,"right",this.leftChecked)},clearQuery:function(e){"left"===e?this.$refs.leftPanel.query="":"right"===e&&(this.$refs.rightPanel.query="")}}},Vf=Ff,jf=a(Vf,Nf,Lf,!1,null,null,null);jf.options.__file="packages/transfer/src/main.vue";var Gf=jf.exports;Gf.install=function(e){e.component(Gf.name,Gf)};var Hf=Gf,Qf=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"el-container",class:{"is-vertical":e.isVertical}},[e._t("default")],2)},Wf=[];Qf._withStripped=!0;var qf={name:"ElContainer",componentName:"ElContainer",props:{direction:String},computed:{isVertical:function(){return"vertical"===this.direction||"horizontal"!==this.direction&&(!(!this.$slots||!this.$slots.default)&&this.$slots.default.some((function(e){var t=e.componentOptions&&e.componentOptions.tag;return"el-header"===t||"el-footer"===t})))}}},zf=qf,Zf=a(zf,Qf,Wf,!1,null,null,null);Zf.options.__file="packages/container/src/main.vue";var Yf=Zf.exports;Yf.install=function(e){e.component(Yf.name,Yf)};var Kf=Yf,$f=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("header",{staticClass:"el-header",style:{height:e.height}},[e._t("default")],2)},Jf=[];$f._withStripped=!0;var Xf={name:"ElHeader",componentName:"ElHeader",props:{height:{type:String,default:"60px"}}},eg=Xf,tg=a(eg,$f,Jf,!1,null,null,null);tg.options.__file="packages/header/src/main.vue";var rg=tg.exports;rg.install=function(e){e.component(rg.name,rg)};var ig=rg,ng=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("aside",{staticClass:"el-aside",style:{width:e.width}},[e._t("default")],2)},og=[];ng._withStripped=!0;var sg={name:"ElAside",componentName:"ElAside",props:{width:{type:String,default:"300px"}}},ag=sg,cg=a(ag,ng,og,!1,null,null,null);cg.options.__file="packages/aside/src/main.vue";var lg=cg.exports;lg.install=function(e){e.component(lg.name,lg)};var ug=lg,dg=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("main",{staticClass:"el-main"},[e._t("default")],2)},hg=[];dg._withStripped=!0;var pg={name:"ElMain",componentName:"ElMain"},fg=pg,gg=a(fg,dg,hg,!1,null,null,null);gg.options.__file="packages/main/src/main.vue";var mg=gg.exports;mg.install=function(e){e.component(mg.name,mg)};var _g=mg,vg=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("footer",{staticClass:"el-footer",style:{height:e.height}},[e._t("default")],2)},Eg=[];vg._withStripped=!0;var Ag={name:"ElFooter",componentName:"ElFooter",props:{height:{type:String,default:"60px"}}},yg=Ag,Sg=a(yg,vg,Eg,!1,null,null,null);Sg.options.__file="packages/footer/src/main.vue";var Cg=Sg.exports;Cg.install=function(e){e.component(Cg.name,Cg)};var Tg,bg,Ig=Cg,Rg={name:"ElTimeline",props:{reverse:{type:Boolean,default:!1}},provide:function(){return{timeline:this}},render:function(){var e=arguments[0],t=this.reverse,r={"el-timeline":!0,"is-reverse":t},i=this.$slots.default||[];return t&&(i=i.reverse()),e("ul",{class:r},[i])}},wg=Rg,kg=a(wg,Tg,bg,!1,null,null,null);kg.options.__file="packages/timeline/src/main.vue";var Og=kg.exports;Og.install=function(e){e.component(Og.name,Og)};var Ng=Og,Lg=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{staticClass:"el-timeline-item"},[r("div",{staticClass:"el-timeline-item__tail"}),e.$slots.dot?e._e():r("div",{staticClass:"el-timeline-item__node",class:["el-timeline-item__node--"+(e.size||""),"el-timeline-item__node--"+(e.type||"")],style:{backgroundColor:e.color}},[e.icon?r("i",{staticClass:"el-timeline-item__icon",class:e.icon}):e._e()]),e.$slots.dot?r("div",{staticClass:"el-timeline-item__dot"},[e._t("dot")],2):e._e(),r("div",{staticClass:"el-timeline-item__wrapper"},[e.hideTimestamp||"top"!==e.placement?e._e():r("div",{staticClass:"el-timeline-item__timestamp is-top"},[e._v("\n      "+e._s(e.timestamp)+"\n    ")]),r("div",{staticClass:"el-timeline-item__content"},[e._t("default")],2),e.hideTimestamp||"bottom"!==e.placement?e._e():r("div",{staticClass:"el-timeline-item__timestamp is-bottom"},[e._v("\n      "+e._s(e.timestamp)+"\n    ")])])])},Pg=[];Lg._withStripped=!0;var Dg={name:"ElTimelineItem",inject:["timeline"],props:{timestamp:String,hideTimestamp:{type:Boolean,default:!1},placement:{type:String,default:"bottom"},type:String,color:String,size:{type:String,default:"normal"},icon:String}},Mg=Dg,xg=a(Mg,Lg,Pg,!1,null,null,null);xg.options.__file="packages/timeline/src/item.vue";var Bg=xg.exports;Bg.install=function(e){e.component(Bg.name,Bg)};var Ug=Bg,Fg=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a",e._b({class:["el-link",e.type?"el-link--"+e.type:"",e.disabled&&"is-disabled",e.underline&&!e.disabled&&"is-underline"],attrs:{href:e.disabled?null:e.href},on:{click:e.handleClick}},"a",e.$attrs,!1),[e.icon?r("i",{class:e.icon}):e._e(),e.$slots.default?r("span",{staticClass:"el-link--inner"},[e._t("default")],2):e._e(),e.$slots.icon?[e.$slots.icon?e._t("icon"):e._e()]:e._e()],2)},Vg=[];Fg._withStripped=!0;var jg={name:"ElLink",props:{type:{type:String,default:"default"},underline:{type:Boolean,default:!0},disabled:Boolean,href:String,icon:String},methods:{handleClick:function(e){this.disabled||this.href||this.$emit("click",e)}}},Gg=jg,Hg=a(Gg,Fg,Vg,!1,null,null,null);Hg.options.__file="packages/link/src/main.vue";var Qg=Hg.exports;Qg.install=function(e){e.component(Qg.name,Qg)};var Wg=Qg,qg=function(e,t){var r=t._c;return r("div",t._g(t._b({class:[t.data.staticClass,"el-divider","el-divider--"+t.props.direction]},"div",t.data.attrs,!1),t.listeners),[t.slots().default&&"vertical"!==t.props.direction?r("div",{class:["el-divider__text","is-"+t.props.contentPosition]},[t._t("default")],2):t._e()])},zg=[];qg._withStripped=!0;var Zg={name:"ElDivider",props:{direction:{type:String,default:"horizontal",validator:function(e){return-1!==["horizontal","vertical"].indexOf(e)}},contentPosition:{type:String,default:"center",validator:function(e){return-1!==["left","center","right"].indexOf(e)}}}},Yg=Zg,Kg=a(Yg,qg,zg,!0,null,null,null);Kg.options.__file="packages/divider/src/main.vue";var $g=Kg.exports;$g.install=function(e){e.component($g.name,$g)};var Jg=$g,Xg=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-image"},[e.loading?e._t("placeholder",[r("div",{staticClass:"el-image__placeholder"})]):e.error?e._t("error",[r("div",{staticClass:"el-image__error"},[e._v(e._s(e.t("el.image.error")))])]):r("img",e._g(e._b({staticClass:"el-image__inner",class:{"el-image__inner--center":e.alignCenter,"el-image__preview":e.preview},style:e.imageStyle,attrs:{src:e.src},on:{click:e.clickHandler}},"img",e.$attrs,!1),e.$listeners)),e.preview?[e.showViewer?r("image-viewer",{attrs:{"z-index":e.zIndex,"initial-index":e.imageIndex,"on-close":e.closeViewer,"url-list":e.previewSrcList}}):e._e()]:e._e()],2)},em=[];Xg._withStripped=!0;var tm=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition",{attrs:{name:"viewer-fade"}},[r("div",{ref:"el-image-viewer__wrapper",staticClass:"el-image-viewer__wrapper",style:{"z-index":e.viewerZIndex},attrs:{tabindex:"-1"}},[r("div",{staticClass:"el-image-viewer__mask",on:{click:function(t){return t.target!==t.currentTarget?null:e.handleMaskClick(t)}}}),r("span",{staticClass:"el-image-viewer__btn el-image-viewer__close",on:{click:e.hide}},[r("i",{staticClass:"el-icon-close"})]),e.isSingle?e._e():[r("span",{staticClass:"el-image-viewer__btn el-image-viewer__prev",class:{"is-disabled":!e.infinite&&e.isFirst},on:{click:e.prev}},[r("i",{staticClass:"el-icon-arrow-left"})]),r("span",{staticClass:"el-image-viewer__btn el-image-viewer__next",class:{"is-disabled":!e.infinite&&e.isLast},on:{click:e.next}},[r("i",{staticClass:"el-icon-arrow-right"})])],r("div",{staticClass:"el-image-viewer__btn el-image-viewer__actions"},[r("div",{staticClass:"el-image-viewer__actions__inner"},[r("i",{staticClass:"el-icon-zoom-out",on:{click:function(t){e.handleActions("zoomOut")}}}),r("i",{staticClass:"el-icon-zoom-in",on:{click:function(t){e.handleActions("zoomIn")}}}),r("i",{staticClass:"el-image-viewer__actions__divider"}),r("i",{class:e.mode.icon,on:{click:e.toggleMode}}),r("i",{staticClass:"el-image-viewer__actions__divider"}),r("i",{staticClass:"el-icon-refresh-left",on:{click:function(t){e.handleActions("anticlocelise")}}}),r("i",{staticClass:"el-icon-refresh-right",on:{click:function(t){e.handleActions("clocelise")}}})])]),r("div",{staticClass:"el-image-viewer__canvas"},e._l(e.urlList,(function(t,i){return i===e.index?r("img",{key:t,ref:"img",refInFor:!0,staticClass:"el-image-viewer__img",style:e.imgStyle,attrs:{src:e.currentImg},on:{load:e.handleImgLoad,error:e.handleImgError,mousedown:e.handleMouseDown}}):e._e()})),0)],2)])},rm=[];tm._withStripped=!0;var im=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},nm={CONTAIN:{name:"contain",icon:"el-icon-full-screen"},ORIGINAL:{name:"original",icon:"el-icon-c-scale-to-original"}},om=Object(v["isFirefox"])()?"DOMMouseScroll":"mousewheel",sm={name:"elImageViewer",props:{urlList:{type:Array,default:function(){return[]}},zIndex:{type:Number,default:2e3},onSwitch:{type:Function,default:function(){}},onClose:{type:Function,default:function(){}},initialIndex:{type:Number,default:0},appendToBody:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0}},data:function(){return{index:this.initialIndex,isShow:!1,infinite:!0,loading:!1,mode:nm.CONTAIN,transform:{scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}},computed:{isSingle:function(){return this.urlList.length<=1},isFirst:function(){return 0===this.index},isLast:function(){return this.index===this.urlList.length-1},currentImg:function(){return this.urlList[this.index]},imgStyle:function(){var e=this.transform,t=e.scale,r=e.deg,i=e.offsetX,n=e.offsetY,o=e.enableTransition,s={transform:"scale("+t+") rotate("+r+"deg)",transition:o?"transform .3s":"","margin-left":i+"px","margin-top":n+"px"};return this.mode===nm.CONTAIN&&(s.maxWidth=s.maxHeight="100%"),s},viewerZIndex:function(){var e=C["PopupManager"].nextZIndex();return this.zIndex>e?this.zIndex:e}},watch:{index:{handler:function(e){this.reset(),this.onSwitch(e)}},currentImg:function(e){var t=this;this.$nextTick((function(e){var r=t.$refs.img[0];r.complete||(t.loading=!0)}))}},methods:{hide:function(){this.deviceSupportUninstall(),this.onClose()},deviceSupportInstall:function(){var e=this;this._keyDownHandler=function(t){t.stopPropagation();var r=t.keyCode;switch(r){case 27:e.hide();break;case 32:e.toggleMode();break;case 37:e.prev();break;case 38:e.handleActions("zoomIn");break;case 39:e.next();break;case 40:e.handleActions("zoomOut");break}},this._mouseWheelHandler=Object(v["rafThrottle"])((function(t){var r=t.wheelDelta?t.wheelDelta:-t.detail;r>0?e.handleActions("zoomIn",{zoomRate:.015,enableTransition:!1}):e.handleActions("zoomOut",{zoomRate:.015,enableTransition:!1})})),Object(Ue["on"])(document,"keydown",this._keyDownHandler),Object(Ue["on"])(document,om,this._mouseWheelHandler)},deviceSupportUninstall:function(){Object(Ue["off"])(document,"keydown",this._keyDownHandler),Object(Ue["off"])(document,om,this._mouseWheelHandler),this._keyDownHandler=null,this._mouseWheelHandler=null},handleImgLoad:function(e){this.loading=!1},handleImgError:function(e){this.loading=!1,e.target.alt="加载失败"},handleMouseDown:function(e){var t=this;if(!this.loading&&0===e.button){var r=this.transform,i=r.offsetX,n=r.offsetY,o=e.pageX,s=e.pageY;this._dragHandler=Object(v["rafThrottle"])((function(e){t.transform.offsetX=i+e.pageX-o,t.transform.offsetY=n+e.pageY-s})),Object(Ue["on"])(document,"mousemove",this._dragHandler),Object(Ue["on"])(document,"mouseup",(function(e){Object(Ue["off"])(document,"mousemove",t._dragHandler)})),e.preventDefault()}},handleMaskClick:function(){this.maskClosable&&this.hide()},reset:function(){this.transform={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}},toggleMode:function(){if(!this.loading){var e=Object.keys(nm),t=Object.values(nm),r=t.indexOf(this.mode),i=(r+1)%e.length;this.mode=nm[e[i]],this.reset()}},prev:function(){if(!this.isFirst||this.infinite){var e=this.urlList.length;this.index=(this.index-1+e)%e}},next:function(){if(!this.isLast||this.infinite){var e=this.urlList.length;this.index=(this.index+1)%e}},handleActions:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.loading){var r=im({zoomRate:.2,rotateDeg:90,enableTransition:!0},t),i=r.zoomRate,n=r.rotateDeg,o=r.enableTransition,s=this.transform;switch(e){case"zoomOut":s.scale>.2&&(s.scale=parseFloat((s.scale-i).toFixed(3)));break;case"zoomIn":s.scale=parseFloat((s.scale+i).toFixed(3));break;case"clocelise":s.deg+=n;break;case"anticlocelise":s.deg-=n;break}s.enableTransition=o}}},mounted:function(){this.deviceSupportInstall(),this.appendToBody&&document.body.appendChild(this.$el),this.$refs["el-image-viewer__wrapper"].focus()},destroyed:function(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}},am=sm,cm=a(am,tm,rm,!1,null,null,null);cm.options.__file="packages/image/src/image-viewer.vue";var lm=cm.exports,um=function(){return void 0!==document.documentElement.style.objectFit},dm={NONE:"none",CONTAIN:"contain",COVER:"cover",FILL:"fill",SCALE_DOWN:"scale-down"},hm="",pm={name:"ElImage",mixins:[_.a],inheritAttrs:!1,components:{ImageViewer:lm},props:{src:String,fit:String,lazy:Boolean,scrollContainer:{},previewSrcList:{type:Array,default:function(){return[]}},zIndex:{type:Number,default:2e3}},data:function(){return{loading:!0,error:!1,show:!this.lazy,imageWidth:0,imageHeight:0,showViewer:!1}},computed:{imageStyle:function(){var e=this.fit;return!this.$isServer&&e?um()?{"object-fit":e}:this.getImageStyle(e):{}},alignCenter:function(){return!this.$isServer&&!um()&&this.fit!==dm.FILL},preview:function(){var e=this.previewSrcList;return Array.isArray(e)&&e.length>0},imageIndex:function(){var e=0,t=this.previewSrcList.indexOf(this.src);return t>=0&&(e=t),e}},watch:{src:function(e){this.show&&this.loadImage()},show:function(e){e&&this.loadImage()}},mounted:function(){this.lazy?this.addLazyLoadListener():this.loadImage()},beforeDestroy:function(){this.lazy&&this.removeLazyLoadListener()},methods:{loadImage:function(){var e=this;if(!this.$isServer){this.loading=!0,this.error=!1;var t=new Image;t.onload=function(r){return e.handleLoad(r,t)},t.onerror=this.handleError.bind(this),Object.keys(this.$attrs).forEach((function(r){var i=e.$attrs[r];t.setAttribute(r,i)})),t.src=this.src}},handleLoad:function(e,t){this.imageWidth=t.width,this.imageHeight=t.height,this.loading=!1,this.error=!1},handleError:function(e){this.loading=!1,this.error=!0,this.$emit("error",e)},handleLazyLoad:function(){Object(Ue["isInContainer"])(this.$el,this._scrollContainer)&&(this.show=!0,this.removeLazyLoadListener())},addLazyLoadListener:function(){if(!this.$isServer){var e=this.scrollContainer,t=null;t=Object(Hd["isHtmlElement"])(e)?e:Object(Hd["isString"])(e)?document.querySelector(e):Object(Ue["getScrollContainer"])(this.$el),t&&(this._scrollContainer=t,this._lazyLoadHandler=xh()(200,this.handleLazyLoad),Object(Ue["on"])(t,"scroll",this._lazyLoadHandler),this.handleLazyLoad())}},removeLazyLoadListener:function(){var e=this._scrollContainer,t=this._lazyLoadHandler;!this.$isServer&&e&&t&&(Object(Ue["off"])(e,"scroll",t),this._scrollContainer=null,this._lazyLoadHandler=null)},getImageStyle:function(e){var t=this.imageWidth,r=this.imageHeight,i=this.$el,n=i.clientWidth,o=i.clientHeight;if(!t||!r||!n||!o)return{};var s=t/r,a=n/o;if(e===dm.SCALE_DOWN){var c=t<n&&r<o;e=c?dm.NONE:dm.CONTAIN}switch(e){case dm.NONE:return{width:"auto",height:"auto"};case dm.CONTAIN:return s<a?{width:"auto"}:{height:"auto"};case dm.COVER:return s<a?{height:"auto"}:{width:"auto"};default:return{}}},clickHandler:function(){this.preview&&(hm=document.body.style.overflow,document.body.style.overflow="hidden",this.showViewer=!0)},closeViewer:function(){document.body.style.overflow=hm,this.showViewer=!1}}},fm=pm,gm=a(fm,Xg,em,!1,null,null,null);gm.options.__file="packages/image/src/main.vue";var mm=gm.exports;mm.install=function(e){e.component(mm.name,mm)};var _m=mm,vm=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-calendar"},[r("div",{staticClass:"el-calendar__header"},[r("div",{staticClass:"el-calendar__title"},[e._v("\n      "+e._s(e.i18nDate)+"\n    ")]),0===e.validatedRange.length?r("div",{staticClass:"el-calendar__button-group"},[r("el-button-group",[r("el-button",{attrs:{type:"plain",size:"mini"},on:{click:function(t){e.selectDate("prev-month")}}},[e._v("\n          "+e._s(e.t("el.datepicker.prevMonth"))+"\n        ")]),r("el-button",{attrs:{type:"plain",size:"mini"},on:{click:function(t){e.selectDate("today")}}},[e._v("\n          "+e._s(e.t("el.datepicker.today"))+"\n        ")]),r("el-button",{attrs:{type:"plain",size:"mini"},on:{click:function(t){e.selectDate("next-month")}}},[e._v("\n          "+e._s(e.t("el.datepicker.nextMonth"))+"\n        ")])],1)],1):e._e()]),0===e.validatedRange.length?r("div",{key:"no-range",staticClass:"el-calendar__body"},[r("date-table",{attrs:{date:e.date,"selected-day":e.realSelectedDay,"first-day-of-week":e.realFirstDayOfWeek},on:{pick:e.pickDay}})],1):r("div",{key:"has-range",staticClass:"el-calendar__body"},e._l(e.validatedRange,(function(t,i){return r("date-table",{key:i,attrs:{date:t[0],"selected-day":e.realSelectedDay,range:t,"hide-header":0!==i,"first-day-of-week":e.realFirstDayOfWeek},on:{pick:e.pickDay}})})),1)])},Em=[];vm._withStripped=!0;var Am,ym,Sm=r(20),Cm=r.n(Sm),Tm={props:{selectedDay:String,range:{type:Array,validator:function(e){if(!e||!e.length)return!0;var t=e[0],r=e[1];return Object(no["validateRangeInOneMonth"])(t,r)}},date:Date,hideHeader:Boolean,firstDayOfWeek:Number},inject:["elCalendar"],methods:{toNestedArr:function(e){return Object(no["range"])(e.length/7).map((function(t,r){var i=7*r;return e.slice(i,i+7)}))},getFormateDate:function(e,t){if(!e||-1===["prev","current","next"].indexOf(t))throw new Error("invalid day or type");var r=this.curMonthDatePrefix;return"prev"===t?r=this.prevMonthDatePrefix:"next"===t&&(r=this.nextMonthDatePrefix),e=("00"+e).slice(-2),r+"-"+e},getCellClass:function(e){var t=e.text,r=e.type,i=[r];if("current"===r){var n=this.getFormateDate(t,r);n===this.selectedDay&&i.push("is-selected"),n===this.formatedToday&&i.push("is-today")}return i},pickDay:function(e){var t=e.text,r=e.type,i=this.getFormateDate(t,r);this.$emit("pick",i)},cellRenderProxy:function(e){var t=e.text,r=e.type,i=this.$createElement,n=this.elCalendar.$scopedSlots.dateCell;if(!n)return i("span",[t]);var o=this.getFormateDate(t,r),s=new Date(o),a={isSelected:this.selectedDay===o,type:r+"-month",day:o};return n({date:s,data:a})}},computed:{WEEK_DAYS:function(){return Object(no["getI18nSettings"])().dayNames},prevMonthDatePrefix:function(){var e=new Date(this.date.getTime());return e.setDate(0),Cm.a.format(e,"yyyy-MM")},curMonthDatePrefix:function(){return Cm.a.format(this.date,"yyyy-MM")},nextMonthDatePrefix:function(){var e=new Date(this.date.getFullYear(),this.date.getMonth()+1,1);return Cm.a.format(e,"yyyy-MM")},formatedToday:function(){return this.elCalendar.formatedToday},isInRange:function(){return this.range&&this.range.length},rows:function(){var e=[];if(this.isInRange){var t=this.range,r=t[0],i=t[1],n=Object(no["range"])(i.getDate()-r.getDate()+1).map((function(e,t){return{text:r.getDate()+t,type:"current"}})),o=n.length%7;o=0===o?0:7-o;var s=Object(no["range"])(o).map((function(e,t){return{text:t+1,type:"next"}}));e=n.concat(s)}else{var a=this.date,c=Object(no["getFirstDayOfMonth"])(a);c=0===c?7:c;var l="number"===typeof this.firstDayOfWeek?this.firstDayOfWeek:1,u=(7+c-l)%7,d=Object(no["getPrevMonthLastDays"])(a,u).map((function(e){return{text:e,type:"prev"}})),h=Object(no["getMonthDays"])(a).map((function(e){return{text:e,type:"current"}}));e=[].concat(d,h);var p=Object(no["range"])(42-e.length).map((function(e,t){return{text:t+1,type:"next"}}));e=e.concat(p)}return this.toNestedArr(e)},weekDays:function(){var e=this.firstDayOfWeek,t=this.WEEK_DAYS;return"number"!==typeof e||0===e?t.slice():t.slice(e).concat(t.slice(0,e))}},render:function(){var e=this,t=arguments[0],r=this.hideHeader?null:t("thead",[this.weekDays.map((function(e){return t("th",{key:e},[e])}))]);return t("table",{class:{"el-calendar-table":!0,"is-range":this.isInRange},attrs:{cellspacing:"0",cellpadding:"0"}},[r,t("tbody",[this.rows.map((function(r,i){return t("tr",{class:{"el-calendar-table__row":!0,"el-calendar-table__row--hide-border":0===i&&e.hideHeader},key:i},[r.map((function(r,i){return t("td",{key:i,class:e.getCellClass(r),on:{click:e.pickDay.bind(e,r)}},[t("div",{class:"el-calendar-day"},[e.cellRenderProxy(r)])])}))])}))])])}},bm=Tm,Im=a(bm,Am,ym,!1,null,null,null);Im.options.__file="packages/calendar/src/date-table.vue";var Rm=Im.exports,wm=["prev-month","today","next-month"],km=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Om=864e5,Nm={name:"ElCalendar",mixins:[_.a],components:{DateTable:Rm,ElButton:se.a,ElButtonGroup:ce.a},props:{value:[Date,String,Number],range:{type:Array,validator:function(e){return!Array.isArray(e)||2===e.length&&e.every((function(e){return"string"===typeof e||"number"===typeof e||e instanceof Date}))}},firstDayOfWeek:{type:Number,default:1}},provide:function(){return{elCalendar:this}},methods:{pickDay:function(e){this.realSelectedDay=e},selectDate:function(e){if(-1===wm.indexOf(e))throw new Error("invalid type "+e);var t="";t="prev-month"===e?this.prevMonthDatePrefix+"-01":"next-month"===e?this.nextMonthDatePrefix+"-01":this.formatedToday,t!==this.formatedDate&&this.pickDay(t)},toDate:function(e){if(!e)throw new Error("invalid val");return e instanceof Date?e:new Date(e)},rangeValidator:function(e,t){var r=this.realFirstDayOfWeek,i=t?r:0===r?6:r-1,n=(t?"start":"end")+" of range should be "+km[i]+".";return e.getDay()===i||(console.warn("[ElementCalendar]",n,"Invalid range will be ignored."),!1)}},computed:{prevMonthDatePrefix:function(){var e=new Date(this.date.getTime());return e.setDate(0),Cm.a.format(e,"yyyy-MM")},curMonthDatePrefix:function(){return Cm.a.format(this.date,"yyyy-MM")},nextMonthDatePrefix:function(){var e=new Date(this.date.getFullYear(),this.date.getMonth()+1,1);return Cm.a.format(e,"yyyy-MM")},formatedDate:function(){return Cm.a.format(this.date,"yyyy-MM-dd")},i18nDate:function(){var e=this.date.getFullYear(),t=this.date.getMonth()+1;return e+" "+this.t("el.datepicker.year")+" "+this.t("el.datepicker.month"+t)},formatedToday:function(){return Cm.a.format(this.now,"yyyy-MM-dd")},realSelectedDay:{get:function(){return this.value?this.formatedDate:this.selectedDay},set:function(e){this.selectedDay=e;var t=new Date(e);this.$emit("input",t)}},date:function(){if(this.value)return this.toDate(this.value);if(this.realSelectedDay){var e=this.selectedDay.split("-");return new Date(e[0],e[1]-1,e[2])}return this.validatedRange.length?this.validatedRange[0][0]:this.now},validatedRange:function(){var e=this,t=this.range;if(!t)return[];if(t=t.reduce((function(t,r,i){var n=e.toDate(r);return e.rangeValidator(n,0===i)&&(t=t.concat(n)),t}),[]),2===t.length){var r=t,i=r[0],n=r[1];if(i>n)return console.warn("[ElementCalendar]end time should be greater than start time"),[];if(Object(no["validateRangeInOneMonth"])(i,n))return[[i,n]];var o=[],s=new Date(i.getFullYear(),i.getMonth()+1,1),a=this.toDate(s.getTime()-Om);if(!Object(no["validateRangeInOneMonth"])(s,n))return console.warn("[ElementCalendar]start time and end time interval must not exceed two months"),[];o.push([i,a]);var c=this.realFirstDayOfWeek,l=s.getDay(),u=0;return l!==c&&(0===c?u=7-l:(u=c-l,u=u>0?u:7+u)),s=this.toDate(s.getTime()+u*Om),s.getDate()<n.getDate()&&o.push([s,n]),o}return[]},realFirstDayOfWeek:function(){return this.firstDayOfWeek<1||this.firstDayOfWeek>6?0:Math.floor(this.firstDayOfWeek)}},data:function(){return{selectedDay:"",now:new Date}}},Lm=Nm,Pm=a(Lm,vm,Em,!1,null,null,null);Pm.options.__file="packages/calendar/src/main.vue";var Dm=Pm.exports;Dm.install=function(e){e.component(Dm.name,Dm)};var Mm=Dm,xm=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition",{attrs:{name:"el-fade-in"}},[e.visible?r("div",{staticClass:"el-backtop",style:{right:e.styleRight,bottom:e.styleBottom},on:{click:function(t){return t.stopPropagation(),e.handleClick(t)}}},[e._t("default",[r("el-icon",{attrs:{name:"caret-top"}})])],2):e._e()])},Bm=[];xm._withStripped=!0;var Um=function(e){return Math.pow(e,3)},Fm=function(e){return e<.5?Um(2*e)/2:1-Um(2*(1-e))/2},Vm={name:"ElBacktop",props:{visibilityHeight:{type:Number,default:200},target:[String],right:{type:Number,default:40},bottom:{type:Number,default:40}},data:function(){return{el:null,container:null,visible:!1}},computed:{styleBottom:function(){return this.bottom+"px"},styleRight:function(){return this.right+"px"}},mounted:function(){this.init(),this.throttledScrollHandler=xh()(300,this.onScroll),this.container.addEventListener("scroll",this.throttledScrollHandler)},methods:{init:function(){if(this.container=document,this.el=document.documentElement,this.target){if(this.el=document.querySelector(this.target),!this.el)throw new Error("target is not existed: "+this.target);this.container=this.el}},onScroll:function(){var e=this.el.scrollTop;this.visible=e>=this.visibilityHeight},handleClick:function(e){this.scrollToTop(),this.$emit("click",e)},scrollToTop:function(){var e=this.el,t=Date.now(),r=e.scrollTop,i=window.requestAnimationFrame||function(e){return setTimeout(e,16)},n=function n(){var o=(Date.now()-t)/500;o<1?(e.scrollTop=r*(1-Fm(o)),i(n)):e.scrollTop=0};i(n)}},beforeDestroy:function(){this.container.removeEventListener("scroll",this.throttledScrollHandler)}},jm=Vm,Gm=a(jm,xm,Bm,!1,null,null,null);Gm.options.__file="packages/backtop/src/main.vue";var Hm=Gm.exports;Hm.install=function(e){e.component(Hm.name,Hm)};var Qm=Hm,Wm=function(e,t){if(e===window&&(e=document.documentElement),1!==e.nodeType)return[];var r=window.getComputedStyle(e,null);return t?r[t]:r},qm=function(e){return Object.keys(e||{}).map((function(t){return[t,e[t]]}))},zm=function(e,t){return e===window||e===document?document.documentElement[t]:e[t]},Zm=function(e){return zm(e,"offsetHeight")},Ym=function(e){return zm(e,"clientHeight")},Km="ElInfiniteScroll",$m={delay:{type:Number,default:200},distance:{type:Number,default:0},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},Jm=function(e,t){return Object(Hd["isHtmlElement"])(e)?qm($m).reduce((function(r,i){var n=i[0],o=i[1],s=o.type,a=o.default,c=e.getAttribute("infinite-scroll-"+n);switch(c=Object(Hd["isUndefined"])(t[c])?c:t[c],s){case Number:c=Number(c),c=Number.isNaN(c)?a:c;break;case Boolean:c=Object(Hd["isDefined"])(c)?"false"!==c&&Boolean(c):a;break;default:c=s(c)}return r[n]=c,r}),{}):{}},Xm=function(e){return e.getBoundingClientRect().top},e_=function(e){var t=this[Km],r=t.el,i=t.vm,n=t.container,o=t.observer,s=Jm(r,i),a=s.distance,c=s.disabled;if(!c){var l=n.getBoundingClientRect();if(l.width||l.height){var u=!1;if(n===r){var d=n.scrollTop+Ym(n);u=n.scrollHeight-d<=a}else{var h=Zm(r)+Xm(r)-Xm(n),p=Zm(n),f=Number.parseFloat(Wm(n,"borderBottomWidth"));u=h-p+f<=a}u&&Object(Hd["isFunction"])(e)?e.call(i):o&&(o.disconnect(),this[Km].observer=null)}}},t_={name:"InfiniteScroll",inserted:function(e,t,r){var i=t.value,n=r.context,o=Object(Ue["getScrollContainer"])(e,!0),s=Jm(e,n),a=s.delay,c=s.immediate,l=B()(a,e_.bind(e,i));if(e[Km]={el:e,vm:n,container:o,onScroll:l},o&&(o.addEventListener("scroll",l),c)){var u=e[Km].observer=new MutationObserver(l);u.observe(o,{childList:!0,subtree:!0}),l()}},unbind:function(e){var t=e[Km],r=t.container,i=t.onScroll;r&&r.removeEventListener("scroll",i)},install:function(e){e.directive(t_.name,t_)}},r_=t_,i_=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-page-header"},[r("div",{staticClass:"el-page-header__left",on:{click:function(t){e.$emit("back")}}},[r("i",{staticClass:"el-icon-back"}),r("div",{staticClass:"el-page-header__title"},[e._t("title",[e._v(e._s(e.title))])],2)]),r("div",{staticClass:"el-page-header__content"},[e._t("content",[e._v(e._s(e.content))])],2)])},n_=[];i_._withStripped=!0;var o_={name:"ElPageHeader",props:{title:{type:String,default:function(){return Object(fa["t"])("el.pageHeader.title")}},content:String}},s_=o_,a_=a(s_,i_,n_,!1,null,null,null);a_.options.__file="packages/page-header/src/main.vue";var c_=a_.exports;c_.install=function(e){e.component(c_.name,c_)};var l_=c_,u_=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:["el-cascader-panel",e.border&&"is-bordered"],on:{keydown:e.handleKeyDown}},e._l(e.menus,(function(e,t){return r("cascader-menu",{key:t,ref:"menu",refInFor:!0,attrs:{index:t,nodes:e}})})),1)},d_=[];u_._withStripped=!0;var h_,p_,f_=r(43),g_=r.n(f_),m_=function(e){return e.stopPropagation()},__={inject:["panel"],components:{ElCheckbox:Pi.a,ElRadio:g_.a},props:{node:{required:!0},nodeId:String},computed:{config:function(){return this.panel.config},isLeaf:function(){return this.node.isLeaf},isDisabled:function(){return this.node.isDisabled},checkedValue:function(){return this.panel.checkedValue},isChecked:function(){return this.node.isSameNode(this.checkedValue)},inActivePath:function(){return this.isInPath(this.panel.activePath)},inCheckedPath:function(){var e=this;return!!this.config.checkStrictly&&this.panel.checkedNodePaths.some((function(t){return e.isInPath(t)}))},value:function(){return this.node.getValueByOption()}},methods:{handleExpand:function(){var e=this,t=this.panel,r=this.node,i=this.isDisabled,n=this.config,o=n.multiple,s=n.checkStrictly;!s&&i||r.loading||(n.lazy&&!r.loaded?t.lazyLoad(r,(function(){var t=e.isLeaf;if(t||e.handleExpand(),o){var i=!!t&&r.checked;e.handleMultiCheckChange(i)}})):t.handleExpand(r))},handleCheckChange:function(){var e=this.panel,t=this.value,r=this.node;e.handleCheckChange(t),e.handleExpand(r)},handleMultiCheckChange:function(e){this.node.doCheck(e),this.panel.calculateMultiCheckedValue()},isInPath:function(e){var t=this.node,r=e[t.level-1]||{};return r.uid===t.uid},renderPrefix:function(e){var t=this.isLeaf,r=this.isChecked,i=this.config,n=i.checkStrictly,o=i.multiple;return o?this.renderCheckbox(e):n?this.renderRadio(e):t&&r?this.renderCheckIcon(e):null},renderPostfix:function(e){var t=this.node,r=this.isLeaf;return t.loading?this.renderLoadingIcon(e):r?null:this.renderExpandIcon(e)},renderCheckbox:function(e){var t=this.node,r=this.config,i=this.isDisabled,n={on:{change:this.handleMultiCheckChange},nativeOn:{}};return r.checkStrictly&&(n.nativeOn.click=m_),e("el-checkbox",Ju()([{attrs:{value:t.checked,indeterminate:t.indeterminate,disabled:i}},n]))},renderRadio:function(e){var t=this.checkedValue,r=this.value,i=this.isDisabled;return Object(v["isEqual"])(r,t)&&(r=t),e("el-radio",{attrs:{value:t,label:r,disabled:i},on:{change:this.handleCheckChange},nativeOn:{click:m_}},[e("span")])},renderCheckIcon:function(e){return e("i",{class:"el-icon-check el-cascader-node__prefix"})},renderLoadingIcon:function(e){return e("i",{class:"el-icon-loading el-cascader-node__postfix"})},renderExpandIcon:function(e){return e("i",{class:"el-icon-arrow-right el-cascader-node__postfix"})},renderContent:function(e){var t=this.panel,r=this.node,i=t.renderLabelFn,n=i?i({node:r,data:r.data}):null;return e("span",{class:"el-cascader-node__label"},[n||r.label])}},render:function(e){var t=this,r=this.inActivePath,i=this.inCheckedPath,n=this.isChecked,o=this.isLeaf,s=this.isDisabled,a=this.config,c=this.nodeId,l=a.expandTrigger,u=a.checkStrictly,d=a.multiple,h=!u&&s,p={on:{}};return"click"===l?p.on.click=this.handleExpand:(p.on.mouseenter=function(e){t.handleExpand(),t.$emit("expand",e)},p.on.focus=function(e){t.handleExpand(),t.$emit("expand",e)}),!o||s||u||d||(p.on.click=this.handleCheckChange),e("li",Ju()([{attrs:{role:"menuitem",id:c,"aria-expanded":r,tabindex:h?null:-1},class:{"el-cascader-node":!0,"is-selectable":u,"in-active-path":r,"in-checked-path":i,"is-active":n,"is-disabled":h}},p]),[this.renderPrefix(e),this.renderContent(e),this.renderPostfix(e)])}},v_=__,E_=a(v_,h_,p_,!1,null,null,null);E_.options.__file="packages/cascader-panel/src/cascader-node.vue";var A_,y_,S_=E_.exports,C_={name:"ElCascaderMenu",mixins:[_.a],inject:["panel"],components:{ElScrollbar:W.a,CascaderNode:S_},props:{nodes:{type:Array,required:!0},index:Number},data:function(){return{activeNode:null,hoverTimer:null,id:Object(v["generateId"])()}},computed:{isEmpty:function(){return!this.nodes.length},menuId:function(){return"cascader-menu-"+this.id+"-"+this.index}},methods:{handleExpand:function(e){this.activeNode=e.target},handleMouseMove:function(e){var t=this.activeNode,r=this.hoverTimer,i=this.$refs.hoverZone;if(t&&i)if(t.contains(e.target)){clearTimeout(r);var n=this.$el.getBoundingClientRect(),o=n.left,s=e.clientX-o,a=this.$el,c=a.offsetWidth,l=a.offsetHeight,u=t.offsetTop,d=u+t.offsetHeight;i.innerHTML='\n          <path style="pointer-events: auto;" fill="transparent" d="M'+s+" "+u+" L"+c+" 0 V"+u+' Z" />\n          <path style="pointer-events: auto;" fill="transparent" d="M'+s+" "+d+" L"+c+" "+l+" V"+d+' Z" />\n        '}else r||(this.hoverTimer=setTimeout(this.clearHoverZone,this.panel.config.hoverThreshold))},clearHoverZone:function(){var e=this.$refs.hoverZone;e&&(e.innerHTML="")},renderEmptyText:function(e){return e("div",{class:"el-cascader-menu__empty-text"},[this.t("el.cascader.noData")])},renderNodeList:function(e){var t=this.menuId,r=this.panel.isHoverMenu,i={on:{}};r&&(i.on.expand=this.handleExpand);var n=this.nodes.map((function(r,n){var o=r.hasChildren;return e("cascader-node",Ju()([{key:r.uid,attrs:{node:r,"node-id":t+"-"+n,"aria-haspopup":o,"aria-owns":o?t:null}},i]))}));return[].concat(n,[r?e("svg",{ref:"hoverZone",class:"el-cascader-menu__hover-zone"}):null])}},render:function(e){var t=this.isEmpty,r=this.menuId,i={nativeOn:{}};return this.panel.isHoverMenu&&(i.nativeOn.mousemove=this.handleMouseMove),e("el-scrollbar",Ju()([{attrs:{tag:"ul",role:"menu",id:r,"wrap-class":"el-cascader-menu__wrap","view-class":{"el-cascader-menu__list":!0,"is-empty":t}},class:"el-cascader-menu"},i]),[t?this.renderEmptyText(e):this.renderNodeList(e)])}},T_=C_,b_=a(T_,A_,y_,!1,null,null,null);b_.options.__file="packages/cascader-panel/src/cascader-menu.vue";var I_=b_.exports,R_=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();function w_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var k_=0,O_=function(){function e(t,r,i){w_(this,e),this.data=t,this.config=r,this.parent=i||null,this.level=this.parent?this.parent.level+1:1,this.uid=k_++,this.initState(),this.initChildren()}return e.prototype.initState=function(){var e=this.config,t=e.value,r=e.label;this.value=this.data[t],this.label=this.data[r],this.pathNodes=this.calculatePathNodes(),this.path=this.pathNodes.map((function(e){return e.value})),this.pathLabels=this.pathNodes.map((function(e){return e.label})),this.loading=!1,this.loaded=!1},e.prototype.initChildren=function(){var t=this,r=this.config,i=r.children,n=this.data[i];this.hasChildren=Array.isArray(n),this.children=(n||[]).map((function(i){return new e(i,r,t)}))},e.prototype.calculatePathNodes=function(){var e=[this],t=this.parent;while(t)e.unshift(t),t=t.parent;return e},e.prototype.getPath=function(){return this.path},e.prototype.getValue=function(){return this.value},e.prototype.getValueByOption=function(){return this.config.emitPath?this.getPath():this.getValue()},e.prototype.getText=function(e,t){return e?this.pathLabels.join(t):this.label},e.prototype.isSameNode=function(e){var t=this.getValueByOption();return this.config.multiple&&Array.isArray(e)?e.some((function(e){return Object(v["isEqual"])(e,t)})):Object(v["isEqual"])(e,t)},e.prototype.broadcast=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];var n="onParent"+Object(v["capitalize"])(e);this.children.forEach((function(t){t&&(t.broadcast.apply(t,[e].concat(r)),t[n]&&t[n].apply(t,r))}))},e.prototype.emit=function(e){var t=this.parent,r="onChild"+Object(v["capitalize"])(e);if(t){for(var i=arguments.length,n=Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];t[r]&&t[r].apply(t,n),t.emit.apply(t,[e].concat(n))}},e.prototype.onParentCheck=function(e){this.isDisabled||this.setCheckState(e)},e.prototype.onChildCheck=function(){var e=this.children,t=e.filter((function(e){return!e.isDisabled})),r=!!t.length&&t.every((function(e){return e.checked}));this.setCheckState(r)},e.prototype.setCheckState=function(e){var t=this.children.length,r=this.children.reduce((function(e,t){var r=t.checked?1:t.indeterminate?.5:0;return e+r}),0);this.checked=e,this.indeterminate=r!==t&&r>0},e.prototype.syncCheckState=function(e){var t=this.getValueByOption(),r=this.isSameNode(e,t);this.doCheck(r)},e.prototype.doCheck=function(e){this.checked!==e&&(this.config.checkStrictly?this.checked=e:(this.broadcast("check",e),this.setCheckState(e),this.emit("check")))},R_(e,[{key:"isDisabled",get:function(){var e=this.data,t=this.parent,r=this.config,i=r.disabled,n=r.checkStrictly;return e[i]||!n&&t&&t.isDisabled}},{key:"isLeaf",get:function(){var e=this.data,t=this.loaded,r=this.hasChildren,i=this.children,n=this.config,o=n.lazy,s=n.leaf;if(o){var a=Object(It["isDef"])(e[s])?e[s]:!!t&&!i.length;return this.hasChildren=!a,a}return!r}}]),e}(),N_=O_;function L_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var P_=function e(t,r){return t.reduce((function(t,i){return i.isLeaf?t.push(i):(!r&&t.push(i),t=t.concat(e(i.children,r))),t}),[])},D_=function(){function e(t,r){L_(this,e),this.config=r,this.initNodes(t)}return e.prototype.initNodes=function(e){var t=this;e=Object(v["coerceTruthyValueToArray"])(e),this.nodes=e.map((function(e){return new N_(e,t.config)})),this.flattedNodes=this.getFlattedNodes(!1,!1),this.leafNodes=this.getFlattedNodes(!0,!1)},e.prototype.appendNode=function(e,t){var r=new N_(e,this.config,t),i=t?t.children:this.nodes;i.push(r)},e.prototype.appendNodes=function(e,t){var r=this;e=Object(v["coerceTruthyValueToArray"])(e),e.forEach((function(e){return r.appendNode(e,t)}))},e.prototype.getNodes=function(){return this.nodes},e.prototype.getFlattedNodes=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e?this.leafNodes:this.flattedNodes;return t?r:P_(this.nodes,e)},e.prototype.getNodeByValue=function(e){var t=this.getFlattedNodes(!1,!this.config.lazy).filter((function(t){return Object(v["valueEquals"])(t.path,e)||t.value===e}));return t&&t.length?t[0]:null},e}(),M_=D_,x_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},B_=Ap.a.keys,U_={expandTrigger:"click",multiple:!1,checkStrictly:!1,emitPath:!0,lazy:!1,lazyLoad:v["noop"],value:"value",label:"label",children:"children",leaf:"leaf",disabled:"disabled",hoverThreshold:500},F_=function(e){return!e.getAttribute("aria-owns")},V_=function(e,t){var r=e.parentNode;if(r){var i=r.querySelectorAll('.el-cascader-node[tabindex="-1"]'),n=Array.prototype.indexOf.call(i,e);return i[n+t]||null}return null},j_=function(e,t){if(e){var r=e.id.split("-");return Number(r[r.length-2])}},G_=function(e){e&&(e.focus(),!F_(e)&&e.click())},H_=function(e){if(e){var t=e.querySelector("input");t?t.click():F_(e)&&e.click()}},Q_={name:"ElCascaderPanel",components:{CascaderMenu:I_},props:{value:{},options:Array,props:Object,border:{type:Boolean,default:!0},renderLabel:Function},provide:function(){return{panel:this}},data:function(){return{checkedValue:null,checkedNodePaths:[],store:[],menus:[],activePath:[],loadCount:0}},computed:{config:function(){return bt()(x_({},U_),this.props||{})},multiple:function(){return this.config.multiple},checkStrictly:function(){return this.config.checkStrictly},leafOnly:function(){return!this.checkStrictly},isHoverMenu:function(){return"hover"===this.config.expandTrigger},renderLabelFn:function(){return this.renderLabel||this.$scopedSlots.default}},watch:{options:{handler:function(){this.initStore()},immediate:!0,deep:!0},value:function(){this.syncCheckedValue(),this.checkStrictly&&this.calculateCheckedNodePaths()},checkedValue:function(e){Object(v["isEqual"])(e,this.value)||(this.checkStrictly&&this.calculateCheckedNodePaths(),this.$emit("input",e),this.$emit("change",e))}},mounted:function(){this.isEmptyValue(this.value)||this.syncCheckedValue()},methods:{initStore:function(){var e=this.config,t=this.options;e.lazy&&Object(v["isEmpty"])(t)?this.lazyLoad():(this.store=new M_(t,e),this.menus=[this.store.getNodes()],this.syncMenuState())},syncCheckedValue:function(){var e=this.value,t=this.checkedValue;Object(v["isEqual"])(e,t)||(this.activePath=[],this.checkedValue=e,this.syncMenuState())},syncMenuState:function(){var e=this.multiple,t=this.checkStrictly;this.syncActivePath(),e&&this.syncMultiCheckState(),t&&this.calculateCheckedNodePaths(),this.$nextTick(this.scrollIntoView)},syncMultiCheckState:function(){var e=this,t=this.getFlattedNodes(this.leafOnly);t.forEach((function(t){t.syncCheckState(e.checkedValue)}))},isEmptyValue:function(e){var t=this.multiple,r=this.config,i=r.emitPath;return!(!t&&!i)&&Object(v["isEmpty"])(e)},syncActivePath:function(){var e=this,t=this.store,r=this.multiple,i=this.activePath,n=this.checkedValue;if(Object(v["isEmpty"])(i))if(this.isEmptyValue(n))this.activePath=[],this.menus=[t.getNodes()];else{var o=r?n[0]:n,s=this.getNodeByValue(o)||{},a=(s.pathNodes||[]).slice(0,-1);this.expandNodes(a)}else{var c=i.map((function(t){return e.getNodeByValue(t.getValue())}));this.expandNodes(c)}},expandNodes:function(e){var t=this;e.forEach((function(e){return t.handleExpand(e,!0)}))},calculateCheckedNodePaths:function(){var e=this,t=this.checkedValue,r=this.multiple,i=r?Object(v["coerceTruthyValueToArray"])(t):[t];this.checkedNodePaths=i.map((function(t){var r=e.getNodeByValue(t);return r?r.pathNodes:[]}))},handleKeyDown:function(e){var t=e.target,r=e.keyCode;switch(r){case B_.up:var i=V_(t,-1);G_(i);break;case B_.down:var n=V_(t,1);G_(n);break;case B_.left:var o=this.$refs.menu[j_(t)-1];if(o){var s=o.$el.querySelector('.el-cascader-node[aria-expanded="true"]');G_(s)}break;case B_.right:var a=this.$refs.menu[j_(t)+1];if(a){var c=a.$el.querySelector('.el-cascader-node[tabindex="-1"]');G_(c)}break;case B_.enter:H_(t);break;case B_.esc:case B_.tab:this.$emit("close");break;default:return}},handleExpand:function(e,t){var r=this.activePath,i=e.level,n=r.slice(0,i-1),o=this.menus.slice(0,i);if(e.isLeaf||(n.push(e),o.push(e.children)),this.activePath=n,this.menus=o,!t){var s=n.map((function(e){return e.getValue()})),a=r.map((function(e){return e.getValue()}));Object(v["valueEquals"])(s,a)||(this.$emit("active-item-change",s),this.$emit("expand-change",s))}},handleCheckChange:function(e){this.checkedValue=e},lazyLoad:function(e,t){var r=this,i=this.config;e||(e=e||{root:!0,level:0},this.store=new M_([],i),this.menus=[this.store.getNodes()]),e.loading=!0;var n=function(i){var n=e.root?null:e;if(i&&i.length&&r.store.appendNodes(i,n),e.loading=!1,e.loaded=!0,Array.isArray(r.checkedValue)){var o=r.checkedValue[r.loadCount++],s=r.config.value,a=r.config.leaf;if(Array.isArray(i)&&i.filter((function(e){return e[s]===o})).length>0){var c=r.store.getNodeByValue(o);c.data[a]||r.lazyLoad(c,(function(){r.handleExpand(c)})),r.loadCount===r.checkedValue.length&&r.$parent.computePresentText()}}t&&t(i)};i.lazyLoad(e,n)},calculateMultiCheckedValue:function(){this.checkedValue=this.getCheckedNodes(this.leafOnly).map((function(e){return e.getValueByOption()}))},scrollIntoView:function(){if(!this.$isServer){var e=this.$refs.menu||[];e.forEach((function(e){var t=e.$el;if(t){var r=t.querySelector(".el-scrollbar__wrap"),i=t.querySelector(".el-cascader-node.is-active")||t.querySelector(".el-cascader-node.in-active-path");ti()(r,i)}}))}},getNodeByValue:function(e){return this.store.getNodeByValue(e)},getFlattedNodes:function(e){var t=!this.config.lazy;return this.store.getFlattedNodes(e,t)},getCheckedNodes:function(e){var t=this.checkedValue,r=this.multiple;if(r){var i=this.getFlattedNodes(e);return i.filter((function(e){return e.checked}))}return this.isEmptyValue(t)?[]:[this.getNodeByValue(t)]},clearCheckedNodes:function(){var e=this.config,t=this.leafOnly,r=e.multiple,i=e.emitPath;r?(this.getCheckedNodes(t).filter((function(e){return!e.isDisabled})).forEach((function(e){return e.doCheck(!1)})),this.calculateMultiCheckedValue()):this.checkedValue=i?[]:null}}},W_=Q_,q_=a(W_,u_,d_,!1,null,null,null);q_.options.__file="packages/cascader-panel/src/cascader-panel.vue";var z_=q_.exports;z_.install=function(e){e.component(z_.name,z_)};var Z_,Y_,K_=z_,$_={name:"ElAvatar",props:{size:{type:[Number,String],validator:function(e){return"string"===typeof e?["large","medium","small"].includes(e):"number"===typeof e}},shape:{type:String,default:"circle",validator:function(e){return["circle","square"].includes(e)}},icon:String,src:String,alt:String,srcSet:String,error:Function,fit:{type:String,default:"cover"}},data:function(){return{isImageExist:!0}},computed:{avatarClass:function(){var e=this.size,t=this.icon,r=this.shape,i=["el-avatar"];return e&&"string"===typeof e&&i.push("el-avatar--"+e),t&&i.push("el-avatar--icon"),r&&i.push("el-avatar--"+r),i.join(" ")}},methods:{handleError:function(){var e=this.error,t=e?e():void 0;!1!==t&&(this.isImageExist=!1)},renderAvatar:function(){var e=this.$createElement,t=this.icon,r=this.src,i=this.alt,n=this.isImageExist,o=this.srcSet,s=this.fit;return n&&r?e("img",{attrs:{src:r,alt:i,srcSet:o},on:{error:this.handleError},style:{"object-fit":s}}):t?e("i",{class:t}):this.$slots.default}},render:function(){var e=arguments[0],t=this.avatarClass,r=this.size,i="number"===typeof r?{height:r+"px",width:r+"px",lineHeight:r+"px"}:{};return e("span",{class:t,style:i},[this.renderAvatar()])}},J_=$_,X_=a(J_,Z_,Y_,!1,null,null,null);X_.options.__file="packages/avatar/src/main.vue";var ev=X_.exports;ev.install=function(e){e.component(ev.name,ev)};var tv=ev,rv=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition",{attrs:{name:"el-drawer-fade"},on:{"after-enter":e.afterEnter,"after-leave":e.afterLeave}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"el-drawer__wrapper",attrs:{tabindex:"-1"}},[r("div",{staticClass:"el-drawer__container",class:e.visible&&"el-drawer__open",attrs:{role:"document",tabindex:"-1"},on:{click:function(t){return t.target!==t.currentTarget?null:e.handleWrapperClick(t)}}},[r("div",{ref:"drawer",staticClass:"el-drawer",class:[e.direction,e.customClass],style:e.isHorizontal?"width: "+e.drawerSize:"height: "+e.drawerSize,attrs:{"aria-modal":"true","aria-labelledby":"el-drawer__title","aria-label":e.title,role:"dialog",tabindex:"-1"}},[e.withHeader?r("header",{staticClass:"el-drawer__header",attrs:{id:"el-drawer__title"}},[e._t("title",[r("span",{attrs:{role:"heading",title:e.title}},[e._v(e._s(e.title))])]),e.showClose?r("button",{staticClass:"el-drawer__close-btn",attrs:{"aria-label":"close "+(e.title||"drawer"),type:"button"},on:{click:e.closeDrawer}},[r("i",{staticClass:"el-dialog__close el-icon el-icon-close"})]):e._e()],2):e._e(),e.rendered?r("section",{staticClass:"el-drawer__body"},[e._t("default")],2):e._e()])])])])},iv=[];rv._withStripped=!0;var nv={name:"ElDrawer",mixins:[T.a,w.a],props:{appendToBody:{type:Boolean,default:!1},beforeClose:{type:Function},customClass:{type:String,default:""},closeOnPressEscape:{type:Boolean,default:!0},destroyOnClose:{type:Boolean,default:!1},modal:{type:Boolean,default:!0},direction:{type:String,default:"rtl",validator:function(e){return-1!==["ltr","rtl","ttb","btt"].indexOf(e)}},modalAppendToBody:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},size:{type:[Number,String],default:"30%"},title:{type:String,default:""},visible:{type:Boolean},wrapperClosable:{type:Boolean,default:!0},withHeader:{type:Boolean,default:!0}},computed:{isHorizontal:function(){return"rtl"===this.direction||"ltr"===this.direction},drawerSize:function(){return"number"===typeof this.size?this.size+"px":this.size}},data:function(){return{closed:!1,prevActiveElement:null}},watch:{visible:function(e){var t=this;e?(this.closed=!1,this.$emit("open"),this.appendToBody&&document.body.appendChild(this.$el),this.prevActiveElement=document.activeElement):(this.closed||(this.$emit("close"),!0===this.destroyOnClose&&(this.rendered=!1)),this.$nextTick((function(){t.prevActiveElement&&t.prevActiveElement.focus()})))}},methods:{afterEnter:function(){this.$emit("opened")},afterLeave:function(){this.$emit("closed")},hide:function(e){!1!==e&&(this.$emit("update:visible",!1),this.$emit("close"),!0===this.destroyOnClose&&(this.rendered=!1),this.closed=!0)},handleWrapperClick:function(){this.wrapperClosable&&this.closeDrawer()},closeDrawer:function(){"function"===typeof this.beforeClose?this.beforeClose(this.hide):this.hide()},handleClose:function(){this.closeDrawer()}},mounted:function(){this.visible&&(this.rendered=!0,this.open(),this.appendToBody&&document.body.appendChild(this.$el))},destroyed:function(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}},ov=nv,sv=a(ov,rv,iv,!1,null,null,null);sv.options.__file="packages/drawer/src/main.vue";var av=sv.exports;av.install=function(e){e.component(av.name,av)};var cv=av,lv=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-popover",e._b({attrs:{trigger:"click"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},"el-popover",e.$attrs,!1),[r("div",{staticClass:"el-popconfirm"},[r("p",{staticClass:"el-popconfirm__main"},[e.hideIcon?e._e():r("i",{staticClass:"el-popconfirm__icon",class:e.icon,style:{color:e.iconColor}}),e._v("\n      "+e._s(e.title)+"\n    ")]),r("div",{staticClass:"el-popconfirm__action"},[r("el-button",{attrs:{size:"mini",type:e.cancelButtonType},on:{click:e.cancel}},[e._v("\n        "+e._s(e.displayCancelButtonText)+"\n      ")]),r("el-button",{attrs:{size:"mini",type:e.confirmButtonType},on:{click:e.confirm}},[e._v("\n        "+e._s(e.displayConfirmButtonText)+"\n      ")])],1)]),e._t("reference",null,{slot:"reference"})],2)},uv=[];lv._withStripped=!0;var dv=r(44),hv=r.n(dv),pv={name:"ElPopconfirm",props:{title:{type:String},confirmButtonText:{type:String},cancelButtonText:{type:String},confirmButtonType:{type:String,default:"primary"},cancelButtonType:{type:String,default:"text"},icon:{type:String,default:"el-icon-question"},iconColor:{type:String,default:"#f90"},hideIcon:{type:Boolean,default:!1}},components:{ElPopover:hv.a,ElButton:se.a},data:function(){return{visible:!1}},computed:{displayConfirmButtonText:function(){return this.confirmButtonText||Object(fa["t"])("el.popconfirm.confirmButtonText")},displayCancelButtonText:function(){return this.cancelButtonText||Object(fa["t"])("el.popconfirm.cancelButtonText")}},methods:{confirm:function(){this.visible=!1,this.$emit("confirm")},cancel:function(){this.visible=!1,this.$emit("cancel")}}},fv=pv,gv=a(fv,lv,uv,!1,null,null,null);gv.options.__file="packages/popconfirm/src/main.vue";var mv=gv.exports;mv.install=function(e){e.component(mv.name,mv)};var _v=mv,vv=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.uiLoading?[r("div",e._b({class:["el-skeleton",e.animated?"is-animated":""]},"div",e.$attrs,!1),[e._l(e.count,(function(t){return[e.loading?e._t("template",e._l(e.rows,(function(i){return r("el-skeleton-item",{key:t+"-"+i,class:{"el-skeleton__paragraph":1!==i,"is-first":1===i,"is-last":i===e.rows&&e.rows>1},attrs:{variant:"p"}})}))):e._e()]}))],2)]:[e._t("default",null,null,e.$attrs)]],2)},Ev=[];vv._withStripped=!0;var Av={name:"ElSkeleton",props:{animated:{type:Boolean,default:!1},count:{type:Number,default:1},rows:{type:Number,default:4},loading:{type:Boolean,default:!0},throttle:{type:Number,default:0}},watch:{loading:{handler:function(e){var t=this;this.throttle<=0?this.uiLoading=e:e?(clearTimeout(this.timeoutHandle),this.timeoutHandle=setTimeout((function(){t.uiLoading=t.loading}),this.throttle)):this.uiLoading=e},immediate:!0}},data:function(){return{uiLoading:this.throttle<=0&&this.loading}}},yv=Av,Sv=a(yv,vv,Ev,!1,null,null,null);Sv.options.__file="packages/skeleton/src/index.vue";var Cv=Sv.exports;Cv.install=function(e){e.component(Cv.name,Cv)};var Tv=Cv,bv=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:["el-skeleton__item","el-skeleton__"+e.variant]},["image"===e.variant?r("img-placeholder"):e._e()],1)},Iv=[];bv._withStripped=!0;var Rv=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("svg",{attrs:{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"}},[r("path",{attrs:{d:"M64 896V128h896v768H64z m64-128l192-192 116.352 116.352L640 448l256 307.2V192H128v576z m224-480a96 96 0 1 1-0.064 192.064A96 96 0 0 1 352 288z"}})])},wv=[];Rv._withStripped=!0;var kv={name:"ImgPlaceholder"},Ov=kv,Nv=a(Ov,Rv,wv,!1,null,null,null);Nv.options.__file="packages/skeleton/src/img-placeholder.vue";var Lv,Pv=Nv.exports,Dv={name:"ElSkeletonItem",props:{variant:{type:String,default:"text"}},components:(Lv={},Lv[Pv.name]=Pv,Lv)},Mv=Dv,xv=a(Mv,bv,Iv,!1,null,null,null);xv.options.__file="packages/skeleton/src/item.vue";var Bv=xv.exports;Bv.install=function(e){e.component(Bv.name,Bv)};var Uv=Bv,Fv=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-empty"},[r("div",{staticClass:"el-empty__image",style:e.imageStyle},[e.image?r("img",{attrs:{src:e.image,ondragstart:"return false"}}):e._t("image",[r("img-empty")])],2),r("div",{staticClass:"el-empty__description"},[e.$slots.description?e._t("description"):r("p",[e._v(e._s(e.emptyDescription))])],2),e.$slots.default?r("div",{staticClass:"el-empty__bottom"},[e._t("default")],2):e._e()])},Vv=[];Fv._withStripped=!0;var jv=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("svg",{attrs:{viewBox:"0 0 79 86",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}},[r("defs",[r("linearGradient",{attrs:{id:"linearGradient-1-"+e.id,x1:"38.8503086%",y1:"0%",x2:"61.1496914%",y2:"100%"}},[r("stop",{attrs:{"stop-color":"#FCFCFD",offset:"0%"}}),r("stop",{attrs:{"stop-color":"#EEEFF3",offset:"100%"}})],1),r("linearGradient",{attrs:{id:"linearGradient-2-"+e.id,x1:"0%",y1:"9.5%",x2:"100%",y2:"90.5%"}},[r("stop",{attrs:{"stop-color":"#FCFCFD",offset:"0%"}}),r("stop",{attrs:{"stop-color":"#E9EBEF",offset:"100%"}})],1),r("rect",{attrs:{id:"path-3-"+e.id,x:"0",y:"0",width:"17",height:"36"}})],1),r("g",{attrs:{id:"Illustrations",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"}},[r("g",{attrs:{id:"B-type",transform:"translate(-1268.000000, -535.000000)"}},[r("g",{attrs:{id:"Group-2",transform:"translate(1268.000000, 535.000000)"}},[r("path",{attrs:{id:"Oval-Copy-2",d:"M39.5,86 C61.3152476,86 79,83.9106622 79,81.3333333 C79,78.7560045 57.3152476,78 35.5,78 C13.6847524,78 0,78.7560045 0,81.3333333 C0,83.9106622 17.6847524,86 39.5,86 Z",fill:"#F7F8FC"}}),r("polygon",{attrs:{id:"Rectangle-Copy-14",fill:"#E5E7E9",transform:"translate(27.500000, 51.500000) scale(1, -1) translate(-27.500000, -51.500000) ",points:"13 58 53 58 42 45 2 45"}}),r("g",{attrs:{id:"Group-Copy",transform:"translate(34.500000, 31.500000) scale(-1, 1) rotate(-25.000000) translate(-34.500000, -31.500000) translate(7.000000, 10.000000)"}},[r("polygon",{attrs:{id:"Rectangle-Copy-10",fill:"#E5E7E9",transform:"translate(11.500000, 5.000000) scale(1, -1) translate(-11.500000, -5.000000) ",points:"2.84078316e-14 3 18 3 23 7 5 7"}}),r("polygon",{attrs:{id:"Rectangle-Copy-11",fill:"#EDEEF2",points:"-3.69149156e-15 7 38 7 38 43 -3.69149156e-15 43"}}),r("rect",{attrs:{id:"Rectangle-Copy-12",fill:"url(#linearGradient-1-"+e.id+")",transform:"translate(46.500000, 25.000000) scale(-1, 1) translate(-46.500000, -25.000000) ",x:"38",y:"7",width:"17",height:"36"}}),r("polygon",{attrs:{id:"Rectangle-Copy-13",fill:"#F8F9FB",transform:"translate(39.500000, 3.500000) scale(-1, 1) translate(-39.500000, -3.500000) ",points:"24 7 41 7 55 -3.63806207e-12 38 -3.63806207e-12"}})]),r("rect",{attrs:{id:"Rectangle-Copy-15",fill:"url(#linearGradient-2-"+e.id+")",x:"13",y:"45",width:"40",height:"36"}}),r("g",{attrs:{id:"Rectangle-Copy-17",transform:"translate(53.000000, 45.000000)"}},[r("mask",{attrs:{id:"mask-4-"+e.id,fill:"white"}},[r("use",{attrs:{"xlink:href":"#path-3-"+e.id}})]),r("use",{attrs:{id:"Mask",fill:"#E0E3E9",transform:"translate(8.500000, 18.000000) scale(-1, 1) translate(-8.500000, -18.000000) ","xlink:href":"#path-3-"+e.id}}),r("polygon",{attrs:{id:"Rectangle-Copy",fill:"#D5D7DE",mask:"url(#mask-4-"+e.id+")",transform:"translate(12.000000, 9.000000) scale(-1, 1) translate(-12.000000, -9.000000) ",points:"7 0 24 0 20 18 -1.70530257e-13 16"}})]),r("polygon",{attrs:{id:"Rectangle-Copy-18",fill:"#F8F9FB",transform:"translate(66.000000, 51.500000) scale(-1, 1) translate(-66.000000, -51.500000) ",points:"62 45 79 45 70 58 53 58"}})])])])])},Gv=[];jv._withStripped=!0;var Hv=0,Qv={name:"ImgEmpty",data:function(){return{id:++Hv}}},Wv=Qv,qv=a(Wv,jv,Gv,!1,null,null,null);qv.options.__file="packages/empty/src/img-empty.vue";var zv,Zv=qv.exports,Yv={name:"ElEmpty",components:(zv={},zv[Zv.name]=Zv,zv),props:{image:{type:String,default:""},imageSize:Number,description:{type:String,default:""}},computed:{emptyDescription:function(){return this.description||Object(fa["t"])("el.empty.description")},imageStyle:function(){return{width:this.imageSize?this.imageSize+"px":""}}}},Kv=Yv,$v=a(Kv,Fv,Vv,!1,null,null,null);$v.options.__file="packages/empty/src/index.vue";var Jv=$v.exports;Jv.install=function(e){e.component(Jv.name,Jv)};var Xv,eE=Jv,tE=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},rE={name:"ElDescriptionsRow",props:{row:{type:Array}},inject:["elDescriptions"],render:function(e){var t=this.elDescriptions,r=(this.row||[]).map((function(e){return tE({},e,{label:e.slots.label||e.props.label},["labelClassName","contentClassName","labelStyle","contentStyle"].reduce((function(r,i){return r[i]=e.props[i]||t[i],r}),{}))}));return"vertical"===t.direction?e("tbody",[e("tr",{class:"el-descriptions-row"},[r.map((function(r){var i;return e("th",{class:(i={"el-descriptions-item__cell":!0,"el-descriptions-item__label":!0,"has-colon":!t.border&&t.colon,"is-bordered-label":t.border},i[r.labelClassName]=!0,i),style:r.labelStyle,attrs:{colSpan:r.props.span}},[r.label])}))]),e("tr",{class:"el-descriptions-row"},[r.map((function(t){return e("td",{class:["el-descriptions-item__cell","el-descriptions-item__content",t.contentClassName],style:t.contentStyle,attrs:{colSpan:t.props.span}},[t.slots.default])}))])]):t.border?e("tbody",[e("tr",{class:"el-descriptions-row"},[r.map((function(r){var i;return[e("th",{class:(i={"el-descriptions-item__cell":!0,"el-descriptions-item__label":!0,"is-bordered-label":t.border},i[r.labelClassName]=!0,i),style:r.labelStyle,attrs:{colSpan:"1"}},[r.label]),e("td",{class:["el-descriptions-item__cell","el-descriptions-item__content",r.contentClassName],style:r.contentStyle,attrs:{colSpan:2*r.props.span-1}},[r.slots.default])]}))])]):e("tbody",[e("tr",{class:"el-descriptions-row"},[r.map((function(r){var i;return e("td",{class:"el-descriptions-item el-descriptions-item__cell",attrs:{colSpan:r.props.span}},[e("div",{class:"el-descriptions-item__container"},[e("span",{class:(i={"el-descriptions-item__label":!0,"has-colon":t.colon},i[r.labelClassName]=!0,i),style:r.labelStyle},[r.props.label]),e("span",{class:["el-descriptions-item__content",r.contentClassName],style:r.contentStyle},[r.slots.default])])])}))])])}},iE=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},nE={name:"ElDescriptions",components:(Xv={},Xv[rE.name]=rE,Xv),props:{border:{type:Boolean,default:!1},column:{type:Number,default:3},direction:{type:String,default:"horizontal"},size:{type:String},title:{type:String,default:""},extra:{type:String,default:""},labelStyle:{type:Object},contentStyle:{type:Object},labelClassName:{type:String,default:""},contentClassName:{type:String,default:""},colon:{type:Boolean,default:!0}},computed:{descriptionsSize:function(){return this.size||(this.$ELEMENT||{}).size}},provide:function(){return{elDescriptions:this}},methods:{getOptionProps:function(e){if(e.componentOptions){var t=e.componentOptions,r=t.propsData,i=void 0===r?{}:r,n=t.Ctor,o=void 0===n?{}:n,s=(o.options||{}).props||{},a={};for(var c in s){var l=s[c],u=l.default;void 0!==u&&(a[c]=Object(Hd["isFunction"])(u)?u.call(e):u)}return iE({},a,i)}return{}},getSlots:function(e){var t=this,r=e.componentOptions||{},i=e.children||r.children||[],n={};return i.forEach((function(e){if(!t.isEmptyElement(e)){var r=e.data&&e.data.slot||"default";n[r]=n[r]||[],"template"===e.tag?n[r].push(e.children):n[r].push(e)}})),iE({},n)},isEmptyElement:function(e){return!(e.tag||e.text&&""!==e.text.trim())},filledNode:function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return e.props||(e.props={}),t>r&&(e.props.span=r),i&&(e.props.span=r),e},getRows:function(){var e=this,t=(this.$slots.default||[]).filter((function(e){return e.tag&&e.componentOptions&&"ElDescriptionsItem"===e.componentOptions.Ctor.options.name})),r=t.map((function(t){return{props:e.getOptionProps(t),slots:e.getSlots(t),vnode:t}})),i=[],n=[],o=this.column;return r.forEach((function(r,s){var a=r.props.span||1;if(s===t.length-1)return n.push(e.filledNode(r,a,o,!0)),void i.push(n);a<o?(o-=a,n.push(r)):(n.push(e.filledNode(r,a,o)),i.push(n),o=e.column,n=[])})),i}},render:function(){var e=arguments[0],t=this.title,r=this.extra,i=this.border,n=this.descriptionsSize,o=this.$slots,s=this.getRows();return e("div",{class:"el-descriptions"},[t||r||o.title||o.extra?e("div",{class:"el-descriptions__header"},[e("div",{class:"el-descriptions__title"},[o.title?o.title:t]),e("div",{class:"el-descriptions__extra"},[o.extra?o.extra:r])]):null,e("div",{class:"el-descriptions__body"},[e("table",{class:["el-descriptions__table",{"is-bordered":i},n?"el-descriptions--"+n:""]},[s.map((function(t){return e(rE,{attrs:{row:t}})}))])])])},install:function(e){e.component(nE.name,nE)}},oE=nE,sE={name:"ElDescriptionsItem",props:{label:{type:String,default:""},span:{type:Number,default:1},contentClassName:{type:String,default:""},contentStyle:{type:Object},labelClassName:{type:String,default:""},labelStyle:{type:Object}},render:function(){return null},install:function(e){e.component(sE.name,sE)}},aE=sE,cE=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-result"},[r("div",{staticClass:"el-result__icon"},[e._t("icon",[r(e.iconElement,{tag:"component",class:e.iconElement})])],2),e.title||e.$slots.title?r("div",{staticClass:"el-result__title"},[e._t("title",[r("p",[e._v(e._s(e.title))])])],2):e._e(),e.subTitle||e.$slots.subTitle?r("div",{staticClass:"el-result__subtitle"},[e._t("subTitle",[r("p",[e._v(e._s(e.subTitle))])])],2):e._e(),e.$slots.extra?r("div",{staticClass:"el-result__extra"},[e._t("extra")],2):e._e()])},lE=[];cE._withStripped=!0;var uE=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("svg",{attrs:{viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"}},[r("path",{attrs:{d:"M24,4 C35.045695,4 44,12.954305 44,24 C44,35.045695 35.045695,44 24,44 C12.954305,44 4,35.045695 4,24 C4,12.954305 12.954305,4 24,4 Z M34.5548098,16.4485711 C33.9612228,15.8504763 32.9988282,15.8504763 32.4052412,16.4485711 L32.4052412,16.4485711 L21.413757,27.5805811 L21.413757,27.5805811 L21.4034642,27.590855 C21.0097542,27.9781674 20.3766105,27.9729811 19.9892981,27.5792711 L19.9892981,27.5792711 L15.5947588,23.1121428 C15.0011718,22.514048 14.0387772,22.514048 13.4451902,23.1121428 C12.8516033,23.7102376 12.8516033,24.6799409 13.4451902,25.2780357 L13.4451902,25.2780357 L19.6260786,31.5514289 C20.2196656,32.1495237 21.1820602,32.1495237 21.7756472,31.5514289 L21.7756472,31.5514289 L34.5548098,18.614464 C35.1483967,18.0163692 35.1483967,17.0466659 34.5548098,16.4485711 Z"}})])},dE=[];uE._withStripped=!0;var hE={name:"IconSuccess"},pE=hE,fE=a(pE,uE,dE,!1,null,null,null);fE.options.__file="packages/result/src/icon-success.vue";var gE=fE.exports,mE=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("svg",{attrs:{viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"}},[r("path",{attrs:{d:"M24,4 C35.045695,4 44,12.954305 44,24 C44,35.045695 35.045695,44 24,44 C12.954305,44 4,35.045695 4,24 C4,12.954305 12.954305,4 24,4 Z M32.57818,15.42182 C32.0157534,14.8593933 31.1038797,14.8593933 30.541453,15.42182 L30.541453,15.42182 L24.0006789,21.9625941 L17.458547,15.42182 C16.8961203,14.8593933 15.9842466,14.8593933 15.42182,15.42182 C14.8593933,15.9842466 14.8593933,16.8961203 15.42182,17.458547 L15.42182,17.458547 L21.9639519,23.9993211 L15.42182,30.541453 C14.8593933,31.1038797 14.8593933,32.0157534 15.42182,32.57818 C15.9842466,33.1406067 16.8961203,33.1406067 17.458547,32.57818 L17.458547,32.57818 L24.0006789,26.0360481 L30.541453,32.57818 C31.1038797,33.1406067 32.0157534,33.1406067 32.57818,32.57818 C33.1406067,32.0157534 33.1406067,31.1038797 32.57818,30.541453 L32.57818,30.541453 L26.0374059,23.9993211 L32.57818,17.458547 C33.1406067,16.8961203 33.1406067,15.9842466 32.57818,15.42182 Z"}})])},_E=[];mE._withStripped=!0;var vE={name:"IconError"},EE=vE,AE=a(EE,mE,_E,!1,null,null,null);AE.options.__file="packages/result/src/icon-error.vue";var yE=AE.exports,SE=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("svg",{attrs:{viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"}},[r("path",{attrs:{d:"M24,4 C35.045695,4 44,12.954305 44,24 C44,35.045695 35.045695,44 24,44 C12.954305,44 4,35.045695 4,24 C4,12.954305 12.954305,4 24,4 Z M24,31 C22.8954305,31 22,31.8954305 22,33 C22,34.1045695 22.8954305,35 24,35 C25.1045695,35 26,34.1045695 26,33 C26,31.8954305 25.1045695,31 24,31 Z M24,14 C23.1715729,14 22.5,14.6715729 22.5,15.5 L22.5,15.5 L22.5,27.5 C22.5,28.3284271 23.1715729,29 24,29 C24.8284271,29 25.5,28.3284271 25.5,27.5 L25.5,27.5 L25.5,15.5 C25.5,14.6715729 24.8284271,14 24,14 Z"}})])},CE=[];SE._withStripped=!0;var TE={name:"IconWarning"},bE=TE,IE=a(bE,SE,CE,!1,null,null,null);IE.options.__file="packages/result/src/icon-warning.vue";var RE=IE.exports,wE=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("svg",{attrs:{viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"}},[r("path",{attrs:{d:"M24,4 C35.045695,4 44,12.954305 44,24 C44,35.045695 35.045695,44 24,44 C12.954305,44 4,35.045695 4,24 C4,12.954305 12.954305,4 24,4 Z M24,19 L21,19 C20.1715729,19 19.5,19.6715729 19.5,20.5 C19.5,21.3284271 20.1715729,22 21,22 L21,22 L22.5,22 L22.5,31 L21,31 C20.1715729,31 19.5,31.6715729 19.5,32.5 C19.5,33.3284271 20.1715729,34 21,34 L21,34 L27,34 C27.8284271,34 28.5,33.3284271 28.5,32.5 C28.5,31.6715729 27.8284271,31 27,31 L27,31 L25.5,31 L25.5,20.5 C25.5,19.6715729 24.8284271,19 24,19 L24,19 Z M24,13 C22.8954305,13 22,13.8954305 22,15 C22,16.1045695 22.8954305,17 24,17 C25.1045695,17 26,16.1045695 26,15 C26,13.8954305 25.1045695,13 24,13 Z"}})])},kE=[];wE._withStripped=!0;var OE={name:"IconInfo"},NE=OE,LE=a(NE,wE,kE,!1,null,null,null);LE.options.__file="packages/result/src/icon-info.vue";var PE,DE=LE.exports,ME={success:"icon-success",warning:"icon-warning",error:"icon-error",info:"icon-info"},xE={name:"ElResult",components:(PE={},PE[gE.name]=gE,PE[yE.name]=yE,PE[RE.name]=RE,PE[DE.name]=DE,PE),props:{title:{type:String,default:""},subTitle:{type:String,default:""},icon:{type:String,default:"info"}},computed:{iconElement:function(){var e=this.icon;return e&&ME[e]?ME[e]:"icon-info"}}},BE=xE,UE=a(BE,cE,lE,!1,null,null,null);UE.options.__file="packages/result/src/index.vue";var FE=UE.exports;FE.install=function(e){e.component(FE.name,FE)};var VE=FE,jE=[A,P,ne,pe,Ae,Re,We,et,lt,mt,Nt,Ft,qt,er,ar,fr,yr,wr,Mr,ai,ci,gi,Si,ki,zn,to,ks,js,ea,la,da,Ha,Ka,ic,vc,Fc,Zc,Xc,wl,xl,hu,Bu,Fu,Gu,yd,wd,Md,nh,dh,vh,bh,Lh,jh,qh,ep,ap,fp,kp,Of,Hf,Kf,ig,ug,_g,Ig,Ng,Ug,Wg,Jg,_m,Mm,Qm,l_,K_,tv,cv,_v,Tv,Uv,eE,oE,aE,VE,ze.a],GE=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ga.a.use(t.locale),ga.a.i18n(t.i18n),jE.forEach((function(t){e.component(t.name,t)})),e.use(r_),e.use(Ou.directive),e.prototype.$ELEMENT={size:t.size||"",zIndex:t.zIndex||2e3},e.prototype.$loading=Ou.service,e.prototype.$msgbox=xa,e.prototype.$alert=xa.alert,e.prototype.$confirm=xa.confirm,e.prototype.$prompt=xa.prompt,e.prototype.$notify=Kl,e.prototype.$message=$d};"undefined"!==typeof window&&window.Vue&&GE(window.Vue);t["default"]={version:"2.15.6",locale:ga.a.use,i18n:ga.a.i18n,install:GE,CollapseTransition:ze.a,Loading:Ou,Pagination:A,Dialog:P,Autocomplete:ne,Dropdown:pe,DropdownMenu:Ae,DropdownItem:Re,Menu:We,Submenu:et,MenuItem:lt,MenuItemGroup:mt,Input:Nt,InputNumber:Ft,Radio:qt,RadioGroup:er,RadioButton:ar,Checkbox:fr,CheckboxButton:yr,CheckboxGroup:wr,Switch:Mr,Select:ai,Option:ci,OptionGroup:gi,Button:Si,ButtonGroup:ki,Table:zn,TableColumn:to,DatePicker:ks,TimeSelect:js,TimePicker:ea,Popover:la,Tooltip:da,MessageBox:xa,Breadcrumb:Ha,BreadcrumbItem:Ka,Form:ic,FormItem:vc,Tabs:Fc,TabPane:Zc,Tag:Xc,Tree:wl,Alert:xl,Notification:Kl,Slider:hu,Icon:Bu,Row:Fu,Col:Gu,Upload:yd,Progress:wd,Spinner:Md,Message:$d,Badge:nh,Card:dh,Rate:vh,Steps:bh,Step:Lh,Carousel:jh,Scrollbar:qh,CarouselItem:ep,Collapse:ap,CollapseItem:fp,Cascader:kp,ColorPicker:Of,Transfer:Hf,Container:Kf,Header:ig,Aside:ug,Main:_g,Footer:Ig,Timeline:Ng,TimelineItem:Ug,Link:Wg,Divider:Jg,Image:_m,Calendar:Mm,Backtop:Qm,InfiniteScroll:r_,PageHeader:l_,CascaderPanel:K_,Avatar:tv,Drawer:cv,Popconfirm:_v,Skeleton:Tv,SkeletonItem:Uv,Empty:eE,Descriptions:oE,DescriptionsItem:aE,Result:VE}}])["default"]},"5cc6":function(e,t,r){var i=r("74e8");i("Uint8",(function(e){return function(t,r,i){return e(this,t,r,i)}}))},"5cce":function(e,t){e.exports={version:"0.24.0"}},"5e77":function(e,t,r){var i=r("83ab"),n=r("1a2d"),o=Function.prototype,s=i&&Object.getOwnPropertyDescriptor,a=n(o,"name"),c=a&&"something"===function(){}.name,l=a&&(!i||i&&s(o,"name").configurable);e.exports={EXISTS:a,PROPER:c,CONFIGURABLE:l}},"5f02":function(e,t,r){"use strict";e.exports=function(e){return"object"===typeof e&&!0===e.isAxiosError}},"5f96":function(e,t,r){"use strict";var i=r("ebb5"),n=r("e330"),o=i.aTypedArray,s=i.exportTypedArrayMethod,a=n([].join);s("join",(function(e){return a(o(this),e)}))},"5fb2":function(e,t,r){"use strict";var i=r("da84"),n=r("e330"),o=2147483647,s=36,a=1,c=26,l=38,u=700,d=72,h=128,p="-",f=/[^\0-\u007E]/,g=/[.\u3002\uFF0E\uFF61]/g,m="Overflow: input needs wider integers to process",_=s-a,v=i.RangeError,E=n(g.exec),A=Math.floor,y=String.fromCharCode,S=n("".charCodeAt),C=n([].join),T=n([].push),b=n("".replace),I=n("".split),R=n("".toLowerCase),w=function(e){var t=[],r=0,i=e.length;while(r<i){var n=S(e,r++);if(n>=55296&&n<=56319&&r<i){var o=S(e,r++);56320==(64512&o)?T(t,((1023&n)<<10)+(1023&o)+65536):(T(t,n),r--)}else T(t,n)}return t},k=function(e){return e+22+75*(e<26)},O=function(e,t,r){var i=0;e=r?A(e/u):e>>1,e+=A(e/t);while(e>_*c>>1)e=A(e/_),i+=s;return A(i+(_+1)*e/(e+l))},N=function(e){var t=[];e=w(e);var r,i,n=e.length,l=h,u=0,f=d;for(r=0;r<e.length;r++)i=e[r],i<128&&T(t,y(i));var g=t.length,_=g;g&&T(t,p);while(_<n){var E=o;for(r=0;r<e.length;r++)i=e[r],i>=l&&i<E&&(E=i);var S=_+1;if(E-l>A((o-u)/S))throw v(m);for(u+=(E-l)*S,l=E,r=0;r<e.length;r++){if(i=e[r],i<l&&++u>o)throw v(m);if(i==l){var b=u,I=s;while(1){var R=I<=f?a:I>=f+c?c:I-f;if(b<R)break;var N=b-R,L=s-R;T(t,y(k(R+N%L))),b=A(N/L),I+=s}T(t,y(k(b))),f=O(u,S,_==g),u=0,_++}}u++,l++}return C(t,"")};e.exports=function(e){var t,r,i=[],n=I(b(R(e),g,"."),".");for(t=0;t<n.length;t++)r=n[t],T(i,E(f,r)?"xn--"+N(r):r);return C(i,".")}},"605d":function(e,t,r){var i=r("c6b6"),n=r("da84");e.exports="process"==i(n.process)},6069:function(e,t){e.exports="object"==typeof window},"60bd":function(e,t,r){"use strict";var i=r("da84"),n=r("d039"),o=r("e330"),s=r("ebb5"),a=r("e260"),c=r("b622"),l=c("iterator"),u=i.Uint8Array,d=o(a.values),h=o(a.keys),p=o(a.entries),f=s.aTypedArray,g=s.exportTypedArrayMethod,m=u&&u.prototype,_=!n((function(){m[l].call([1])})),v=!!m&&m.values&&m[l]===m.values&&"values"===m.values.name,E=function(){return d(f(this))};g("entries",(function(){return p(f(this))}),_),g("keys",(function(){return h(f(this))}),_),g("values",E,_||!v,{name:"values"}),g(l,E,_||!v,{name:"values"})},"60da":function(e,t,r){"use strict";var i=r("83ab"),n=r("e330"),o=r("c65b"),s=r("d039"),a=r("df75"),c=r("7418"),l=r("d1e7"),u=r("7b0b"),d=r("44ad"),h=Object.assign,p=Object.defineProperty,f=n([].concat);e.exports=!h||s((function(){if(i&&1!==h({b:1},h(p({},"a",{enumerable:!0,get:function(){p(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach((function(e){t[e]=e})),7!=h({},e)[r]||a(h({},t)).join("")!=n}))?function(e,t){var r=u(e),n=arguments.length,s=1,h=c.f,p=l.f;while(n>s){var g,m=d(arguments[s++]),_=h?f(a(m),h(m)):a(m),v=_.length,E=0;while(v>E)g=_[E++],i&&!o(p,m,g)||(r[g]=m[g])}return r}:h},6167:function(e,t,r){"use strict";var i,n;"function"===typeof Symbol&&Symbol.iterator;(function(o,s){i=s,n="function"===typeof i?i.call(t,r,t,e):i,void 0===n||(e.exports=n)})(0,(function(){var e=window,t={placement:"bottom",gpuAcceleration:!0,offset:0,boundariesElement:"viewport",boundariesPadding:5,preventOverflowOrder:["left","right","top","bottom"],flipBehavior:"flip",arrowElement:"[x-arrow]",arrowOffset:0,modifiers:["shift","offset","preventOverflow","keepTogether","arrow","flip","applyStyle"],modifiersIgnored:[],forceAbsolute:!1};function r(e,r,i){this._reference=e.jquery?e[0]:e,this.state={};var n="undefined"===typeof r||null===r,o=r&&"[object Object]"===Object.prototype.toString.call(r);return this._popper=n||o?this.parse(o?r:{}):r.jquery?r[0]:r,this._options=Object.assign({},t,i),this._options.modifiers=this._options.modifiers.map(function(e){if(-1===this._options.modifiersIgnored.indexOf(e))return"applyStyle"===e&&this._popper.setAttribute("x-placement",this._options.placement),this.modifiers[e]||e}.bind(this)),this.state.position=this._getPosition(this._popper,this._reference),d(this._popper,{position:this.state.position,top:0}),this.update(),this._setupEventListeners(),this}function i(t){var r=t.style.display,i=t.style.visibility;t.style.display="block",t.style.visibility="hidden";t.offsetWidth;var n=e.getComputedStyle(t),o=parseFloat(n.marginTop)+parseFloat(n.marginBottom),s=parseFloat(n.marginLeft)+parseFloat(n.marginRight),a={width:t.offsetWidth+s,height:t.offsetHeight+o};return t.style.display=r,t.style.visibility=i,a}function n(e){var t={left:"right",right:"left",bottom:"top",top:"bottom"};return e.replace(/left|right|bottom|top/g,(function(e){return t[e]}))}function o(e){var t=Object.assign({},e);return t.right=t.left+t.width,t.bottom=t.top+t.height,t}function s(e,t){var r,i=0;for(r in e){if(e[r]===t)return i;i++}return null}function a(t,r){var i=e.getComputedStyle(t,null);return i[r]}function c(t){var r=t.offsetParent;return r!==e.document.body&&r?r:e.document.documentElement}function l(t){var r=t.parentNode;return r?r===e.document?e.document.body.scrollTop||e.document.body.scrollLeft?e.document.body:e.document.documentElement:-1!==["scroll","auto"].indexOf(a(r,"overflow"))||-1!==["scroll","auto"].indexOf(a(r,"overflow-x"))||-1!==["scroll","auto"].indexOf(a(r,"overflow-y"))?r:l(t.parentNode):t}function u(t){return t!==e.document.body&&("fixed"===a(t,"position")||(t.parentNode?u(t.parentNode):t))}function d(e,t){function r(e){return""!==e&&!isNaN(parseFloat(e))&&isFinite(e)}Object.keys(t).forEach((function(i){var n="";-1!==["width","height","top","right","bottom","left"].indexOf(i)&&r(t[i])&&(n="px"),e.style[i]=t[i]+n}))}function h(e){var t={};return e&&"[object Function]"===t.toString.call(e)}function p(e){var t={width:e.offsetWidth,height:e.offsetHeight,left:e.offsetLeft,top:e.offsetTop};return t.right=t.left+t.width,t.bottom=t.top+t.height,t}function f(e){var t=e.getBoundingClientRect(),r=-1!=navigator.userAgent.indexOf("MSIE"),i=r&&"HTML"===e.tagName?-e.scrollTop:t.top;return{left:t.left,top:i,right:t.right,bottom:t.bottom,width:t.right-t.left,height:t.bottom-i}}function g(e,t,r){var i=f(e),n=f(t);if(r){var o=l(t);n.top+=o.scrollTop,n.bottom+=o.scrollTop,n.left+=o.scrollLeft,n.right+=o.scrollLeft}var s={top:i.top-n.top,left:i.left-n.left,bottom:i.top-n.top+i.height,right:i.left-n.left+i.width,width:i.width,height:i.height};return s}function m(t){for(var r=["","ms","webkit","moz","o"],i=0;i<r.length;i++){var n=r[i]?r[i]+t.charAt(0).toUpperCase()+t.slice(1):t;if("undefined"!==typeof e.document.body.style[n])return n}return null}return r.prototype.destroy=function(){return this._popper.removeAttribute("x-placement"),this._popper.style.left="",this._popper.style.position="",this._popper.style.top="",this._popper.style[m("transform")]="",this._removeEventListeners(),this._options.removeOnDestroy&&this._popper.remove(),this},r.prototype.update=function(){var e={instance:this,styles:{}};e.placement=this._options.placement,e._originalPlacement=this._options.placement,e.offsets=this._getOffsets(this._popper,this._reference,e.placement),e.boundaries=this._getBoundaries(e,this._options.boundariesPadding,this._options.boundariesElement),e=this.runModifiers(e,this._options.modifiers),"function"===typeof this.state.updateCallback&&this.state.updateCallback(e)},r.prototype.onCreate=function(e){return e(this),this},r.prototype.onUpdate=function(e){return this.state.updateCallback=e,this},r.prototype.parse=function(t){var r={tagName:"div",classNames:["popper"],attributes:[],parent:e.document.body,content:"",contentType:"text",arrowTagName:"div",arrowClassNames:["popper__arrow"],arrowAttributes:["x-arrow"]};t=Object.assign({},r,t);var i=e.document,n=i.createElement(t.tagName);if(a(n,t.classNames),c(n,t.attributes),"node"===t.contentType?n.appendChild(t.content.jquery?t.content[0]:t.content):"html"===t.contentType?n.innerHTML=t.content:n.textContent=t.content,t.arrowTagName){var o=i.createElement(t.arrowTagName);a(o,t.arrowClassNames),c(o,t.arrowAttributes),n.appendChild(o)}var s=t.parent.jquery?t.parent[0]:t.parent;if("string"===typeof s){if(s=i.querySelectorAll(t.parent),s.length>1&&console.warn("WARNING: the given `parent` query("+t.parent+") matched more than one element, the first one will be used"),0===s.length)throw"ERROR: the given `parent` doesn't exists!";s=s[0]}return s.length>1&&s instanceof Element===!1&&(console.warn("WARNING: you have passed as parent a list of elements, the first one will be used"),s=s[0]),s.appendChild(n),n;function a(e,t){t.forEach((function(t){e.classList.add(t)}))}function c(e,t){t.forEach((function(t){e.setAttribute(t.split(":")[0],t.split(":")[1]||"")}))}},r.prototype._getPosition=function(e,t){var r=c(t);if(this._options.forceAbsolute)return"absolute";var i=u(t,r);return i?"fixed":"absolute"},r.prototype._getOffsets=function(e,t,r){r=r.split("-")[0];var n={};n.position=this.state.position;var o="fixed"===n.position,s=g(t,c(e),o),a=i(e);return-1!==["right","left"].indexOf(r)?(n.top=s.top+s.height/2-a.height/2,n.left="left"===r?s.left-a.width:s.right):(n.left=s.left+s.width/2-a.width/2,n.top="top"===r?s.top-a.height:s.bottom),n.width=a.width,n.height=a.height,{popper:n,reference:s}},r.prototype._setupEventListeners=function(){if(this.state.updateBound=this.update.bind(this),e.addEventListener("resize",this.state.updateBound),"window"!==this._options.boundariesElement){var t=l(this._reference);t!==e.document.body&&t!==e.document.documentElement||(t=e),t.addEventListener("scroll",this.state.updateBound),this.state.scrollTarget=t}},r.prototype._removeEventListeners=function(){e.removeEventListener("resize",this.state.updateBound),"window"!==this._options.boundariesElement&&this.state.scrollTarget&&(this.state.scrollTarget.removeEventListener("scroll",this.state.updateBound),this.state.scrollTarget=null),this.state.updateBound=null},r.prototype._getBoundaries=function(t,r,i){var n,o,s={};if("window"===i){var a=e.document.body,u=e.document.documentElement;o=Math.max(a.scrollHeight,a.offsetHeight,u.clientHeight,u.scrollHeight,u.offsetHeight),n=Math.max(a.scrollWidth,a.offsetWidth,u.clientWidth,u.scrollWidth,u.offsetWidth),s={top:0,right:n,bottom:o,left:0}}else if("viewport"===i){var d=c(this._popper),h=l(this._popper),f=p(d),g=function(e){return e==document.body?Math.max(document.documentElement.scrollTop,document.body.scrollTop):e.scrollTop},m=function(e){return e==document.body?Math.max(document.documentElement.scrollLeft,document.body.scrollLeft):e.scrollLeft},_="fixed"===t.offsets.popper.position?0:g(h),v="fixed"===t.offsets.popper.position?0:m(h);s={top:0-(f.top-_),right:e.document.documentElement.clientWidth-(f.left-v),bottom:e.document.documentElement.clientHeight-(f.top-_),left:0-(f.left-v)}}else s=c(this._popper)===i?{top:0,left:0,right:i.clientWidth,bottom:i.clientHeight}:p(i);return s.left+=r,s.right-=r,s.top=s.top+r,s.bottom=s.bottom-r,s},r.prototype.runModifiers=function(e,t,r){var i=t.slice();return void 0!==r&&(i=this._options.modifiers.slice(0,s(this._options.modifiers,r))),i.forEach(function(t){h(t)&&(e=t.call(this,e))}.bind(this)),e},r.prototype.isModifierRequired=function(e,t){var r=s(this._options.modifiers,e);return!!this._options.modifiers.slice(0,r).filter((function(e){return e===t})).length},r.prototype.modifiers={},r.prototype.modifiers.applyStyle=function(e){var t,r={position:e.offsets.popper.position},i=Math.round(e.offsets.popper.left),n=Math.round(e.offsets.popper.top);return this._options.gpuAcceleration&&(t=m("transform"))?(r[t]="translate3d("+i+"px, "+n+"px, 0)",r.top=0,r.left=0):(r.left=i,r.top=n),Object.assign(r,e.styles),d(this._popper,r),this._popper.setAttribute("x-placement",e.placement),this.isModifierRequired(this.modifiers.applyStyle,this.modifiers.arrow)&&e.offsets.arrow&&d(e.arrowElement,e.offsets.arrow),e},r.prototype.modifiers.shift=function(e){var t=e.placement,r=t.split("-")[0],i=t.split("-")[1];if(i){var n=e.offsets.reference,s=o(e.offsets.popper),a={y:{start:{top:n.top},end:{top:n.top+n.height-s.height}},x:{start:{left:n.left},end:{left:n.left+n.width-s.width}}},c=-1!==["bottom","top"].indexOf(r)?"x":"y";e.offsets.popper=Object.assign(s,a[c][i])}return e},r.prototype.modifiers.preventOverflow=function(e){var t=this._options.preventOverflowOrder,r=o(e.offsets.popper),i={left:function(){var t=r.left;return r.left<e.boundaries.left&&(t=Math.max(r.left,e.boundaries.left)),{left:t}},right:function(){var t=r.left;return r.right>e.boundaries.right&&(t=Math.min(r.left,e.boundaries.right-r.width)),{left:t}},top:function(){var t=r.top;return r.top<e.boundaries.top&&(t=Math.max(r.top,e.boundaries.top)),{top:t}},bottom:function(){var t=r.top;return r.bottom>e.boundaries.bottom&&(t=Math.min(r.top,e.boundaries.bottom-r.height)),{top:t}}};return t.forEach((function(t){e.offsets.popper=Object.assign(r,i[t]())})),e},r.prototype.modifiers.keepTogether=function(e){var t=o(e.offsets.popper),r=e.offsets.reference,i=Math.floor;return t.right<i(r.left)&&(e.offsets.popper.left=i(r.left)-t.width),t.left>i(r.right)&&(e.offsets.popper.left=i(r.right)),t.bottom<i(r.top)&&(e.offsets.popper.top=i(r.top)-t.height),t.top>i(r.bottom)&&(e.offsets.popper.top=i(r.bottom)),e},r.prototype.modifiers.flip=function(e){if(!this.isModifierRequired(this.modifiers.flip,this.modifiers.preventOverflow))return console.warn("WARNING: preventOverflow modifier is required by flip modifier in order to work, be sure to include it before flip!"),e;if(e.flipped&&e.placement===e._originalPlacement)return e;var t=e.placement.split("-")[0],r=n(t),i=e.placement.split("-")[1]||"",s=[];return s="flip"===this._options.flipBehavior?[t,r]:this._options.flipBehavior,s.forEach(function(a,c){if(t===a&&s.length!==c+1){t=e.placement.split("-")[0],r=n(t);var l=o(e.offsets.popper),u=-1!==["right","bottom"].indexOf(t);(u&&Math.floor(e.offsets.reference[t])>Math.floor(l[r])||!u&&Math.floor(e.offsets.reference[t])<Math.floor(l[r]))&&(e.flipped=!0,e.placement=s[c+1],i&&(e.placement+="-"+i),e.offsets.popper=this._getOffsets(this._popper,this._reference,e.placement).popper,e=this.runModifiers(e,this._options.modifiers,this._flip))}}.bind(this)),e},r.prototype.modifiers.offset=function(e){var t=this._options.offset,r=e.offsets.popper;return-1!==e.placement.indexOf("left")?r.top-=t:-1!==e.placement.indexOf("right")?r.top+=t:-1!==e.placement.indexOf("top")?r.left-=t:-1!==e.placement.indexOf("bottom")&&(r.left+=t),e},r.prototype.modifiers.arrow=function(e){var t=this._options.arrowElement,r=this._options.arrowOffset;if("string"===typeof t&&(t=this._popper.querySelector(t)),!t)return e;if(!this._popper.contains(t))return console.warn("WARNING: `arrowElement` must be child of its popper element!"),e;if(!this.isModifierRequired(this.modifiers.arrow,this.modifiers.keepTogether))return console.warn("WARNING: keepTogether modifier is required by arrow modifier in order to work, be sure to include it before arrow!"),e;var n={},s=e.placement.split("-")[0],a=o(e.offsets.popper),c=e.offsets.reference,l=-1!==["left","right"].indexOf(s),u=l?"height":"width",d=l?"top":"left",h=l?"left":"top",p=l?"bottom":"right",f=i(t)[u];c[p]-f<a[d]&&(e.offsets.popper[d]-=a[d]-(c[p]-f)),c[d]+f>a[p]&&(e.offsets.popper[d]+=c[d]+f-a[p]);var g=c[d]+(r||c[u]/2-f/2),m=g-a[d];return m=Math.max(Math.min(a[u]-f-8,m),8),n[d]=m,n[h]="",e.offsets.arrow=n,e.arrowElement=t,e},Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(void 0===e||null===e)throw new TypeError("Cannot convert first argument to object");for(var t=Object(e),r=1;r<arguments.length;r++){var i=arguments[r];if(void 0!==i&&null!==i){i=Object(i);for(var n=Object.keys(i),o=0,s=n.length;o<s;o++){var a=n[o],c=Object.getOwnPropertyDescriptor(i,a);void 0!==c&&c.enumerable&&(t[a]=i[a])}}}return t}}),r}))},"621a":function(e,t,r){"use strict";var i=r("da84"),n=r("e330"),o=r("83ab"),s=r("a981"),a=r("5e77"),c=r("9112"),l=r("e2cc"),u=r("d039"),d=r("19aa"),h=r("5926"),p=r("50c4"),f=r("0b25"),g=r("77a7"),m=r("e163"),_=r("d2bb"),v=r("241c").f,E=r("9bf2").f,A=r("81d5"),y=r("4dae"),S=r("d44e"),C=r("69f3"),T=a.PROPER,b=a.CONFIGURABLE,I=C.get,R=C.set,w="ArrayBuffer",k="DataView",O="prototype",N="Wrong length",L="Wrong index",P=i[w],D=P,M=D&&D[O],x=i[k],B=x&&x[O],U=Object.prototype,F=i.Array,V=i.RangeError,j=n(A),G=n([].reverse),H=g.pack,Q=g.unpack,W=function(e){return[255&e]},q=function(e){return[255&e,e>>8&255]},z=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},Z=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},Y=function(e){return H(e,23,4)},K=function(e){return H(e,52,8)},$=function(e,t){E(e[O],t,{get:function(){return I(this)[t]}})},J=function(e,t,r,i){var n=f(r),o=I(e);if(n+t>o.byteLength)throw V(L);var s=I(o.buffer).bytes,a=n+o.byteOffset,c=y(s,a,a+t);return i?c:G(c)},X=function(e,t,r,i,n,o){var s=f(r),a=I(e);if(s+t>a.byteLength)throw V(L);for(var c=I(a.buffer).bytes,l=s+a.byteOffset,u=i(+n),d=0;d<t;d++)c[l+d]=u[o?d:t-d-1]};if(s){var ee=T&&P.name!==w;if(u((function(){P(1)}))&&u((function(){new P(-1)}))&&!u((function(){return new P,new P(1.5),new P(NaN),ee&&!b})))ee&&b&&c(P,"name",w);else{D=function(e){return d(this,M),new P(f(e))},D[O]=M;for(var te,re=v(P),ie=0;re.length>ie;)(te=re[ie++])in D||c(D,te,P[te]);M.constructor=D}_&&m(B)!==U&&_(B,U);var ne=new x(new D(2)),oe=n(B.setInt8);ne.setInt8(0,2147483648),ne.setInt8(1,2147483649),!ne.getInt8(0)&&ne.getInt8(1)||l(B,{setInt8:function(e,t){oe(this,e,t<<24>>24)},setUint8:function(e,t){oe(this,e,t<<24>>24)}},{unsafe:!0})}else D=function(e){d(this,M);var t=f(e);R(this,{bytes:j(F(t),0),byteLength:t}),o||(this.byteLength=t)},M=D[O],x=function(e,t,r){d(this,B),d(e,M);var i=I(e).byteLength,n=h(t);if(n<0||n>i)throw V("Wrong offset");if(r=void 0===r?i-n:p(r),n+r>i)throw V(N);R(this,{buffer:e,byteLength:r,byteOffset:n}),o||(this.buffer=e,this.byteLength=r,this.byteOffset=n)},B=x[O],o&&($(D,"byteLength"),$(x,"buffer"),$(x,"byteLength"),$(x,"byteOffset")),l(B,{getInt8:function(e){return J(this,1,e)[0]<<24>>24},getUint8:function(e){return J(this,1,e)[0]},getInt16:function(e){var t=J(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=J(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return Z(J(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return Z(J(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return Q(J(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return Q(J(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){X(this,1,e,W,t)},setUint8:function(e,t){X(this,1,e,W,t)},setInt16:function(e,t){X(this,2,e,q,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){X(this,2,e,q,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){X(this,4,e,z,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){X(this,4,e,z,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){X(this,4,e,Y,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){X(this,8,e,K,t,arguments.length>2?arguments[2]:void 0)}});S(D,w),S(x,k),e.exports={ArrayBuffer:D,DataView:x}},6438:function(e,t,r){var i=r("03d6"),n=r("9742").concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,n)}},"649e":function(e,t,r){"use strict";var i=r("ebb5"),n=r("b727").some,o=i.aTypedArray,s=i.exportTypedArrayMethod;s("some",(function(e){return n(o(this),e,arguments.length>1?arguments[1]:void 0)}))},6547:function(e,t,r){var i=r("e330"),n=r("5926"),o=r("577e"),s=r("1d80"),a=i("".charAt),c=i("".charCodeAt),l=i("".slice),u=function(e){return function(t,r){var i,u,d=o(s(t)),h=n(r),p=d.length;return h<0||h>=p?e?"":void 0:(i=c(d,h),i<55296||i>56319||h+1===p||(u=c(d,h+1))<56320||u>57343?e?a(d,h):i:e?l(d,h,h+2):u-56320+(i-55296<<10)+65536)}};e.exports={codeAt:u(!1),charAt:u(!0)}},"658f":function(e,t,r){r("6858");for(var i=r("ef08"),n=r("051b"),o=r("8a0d"),s=r("cc15")("toStringTag"),a="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),c=0;c<a.length;c++){var l=a[c],u=i[l],d=u&&u.prototype;d&&!d[s]&&n(d,s,l),o[l]=o.Array}},"65f0":function(e,t,r){var i=r("0b42");e.exports=function(e,t){return new(i(e))(0===t?0:t)}},6858:function(e,t,r){"use strict";var i=r("2f9a"),n=r("ea34"),o=r("8a0d"),s=r("6ca1");e.exports=r("393a")(Array,"Array",(function(e,t){this._t=s(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,n(1)):n(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},"68ee":function(e,t,r){var i=r("e330"),n=r("d039"),o=r("1626"),s=r("f5df"),a=r("d066"),c=r("8925"),l=function(){},u=[],d=a("Reflect","construct"),h=/^\s*(?:class|function)\b/,p=i(h.exec),f=!h.exec(l),g=function(e){if(!o(e))return!1;try{return d(l,u,e),!0}catch(t){return!1}},m=function(e){if(!o(e))return!1;switch(s(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return f||!!p(h,c(e))}catch(t){return!0}};m.sham=!0,e.exports=!d||n((function(){var e;return g(g.call)||!g(Object)||!g((function(){e=!0}))||e}))?m:g},"693d":function(e,t,r){"use strict";var i=r("ef08"),n=r("9c0e"),o=r("0bad"),s=r("512c"),a=r("ba01"),c=r("e34a").KEY,l=r("4b8b"),u=r("b367"),d=r("92f0"),h=r("8b1a"),p=r("cc15"),f=r("fcd4"),g=r("e198"),m=r("0ae2"),_=r("4ebc"),v=r("77e9"),E=r("7a41"),A=r("0983"),y=r("6ca1"),S=r("3397"),C=r("10db"),T=r("6f4f"),b=r("1836"),I=r("4d20"),R=r("fed5"),w=r("1a14"),k=r("9876"),O=I.f,N=w.f,L=b.f,P=i.Symbol,D=i.JSON,M=D&&D.stringify,x="prototype",B=p("_hidden"),U=p("toPrimitive"),F={}.propertyIsEnumerable,V=u("symbol-registry"),j=u("symbols"),G=u("op-symbols"),H=Object[x],Q="function"==typeof P&&!!R.f,W=i.QObject,q=!W||!W[x]||!W[x].findChild,z=o&&l((function(){return 7!=T(N({},"a",{get:function(){return N(this,"a",{value:7}).a}})).a}))?function(e,t,r){var i=O(H,t);i&&delete H[t],N(e,t,r),i&&e!==H&&N(H,t,i)}:N,Z=function(e){var t=j[e]=T(P[x]);return t._k=e,t},Y=Q&&"symbol"==typeof P.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof P},K=function(e,t,r){return e===H&&K(G,t,r),v(e),t=S(t,!0),v(r),n(j,t)?(r.enumerable?(n(e,B)&&e[B][t]&&(e[B][t]=!1),r=T(r,{enumerable:C(0,!1)})):(n(e,B)||N(e,B,C(1,{})),e[B][t]=!0),z(e,t,r)):N(e,t,r)},$=function(e,t){v(e);var r,i=m(t=y(t)),n=0,o=i.length;while(o>n)K(e,r=i[n++],t[r]);return e},J=function(e,t){return void 0===t?T(e):$(T(e),t)},X=function(e){var t=F.call(this,e=S(e,!0));return!(this===H&&n(j,e)&&!n(G,e))&&(!(t||!n(this,e)||!n(j,e)||n(this,B)&&this[B][e])||t)},ee=function(e,t){if(e=y(e),t=S(t,!0),e!==H||!n(j,t)||n(G,t)){var r=O(e,t);return!r||!n(j,t)||n(e,B)&&e[B][t]||(r.enumerable=!0),r}},te=function(e){var t,r=L(y(e)),i=[],o=0;while(r.length>o)n(j,t=r[o++])||t==B||t==c||i.push(t);return i},re=function(e){var t,r=e===H,i=L(r?G:y(e)),o=[],s=0;while(i.length>s)!n(j,t=i[s++])||r&&!n(H,t)||o.push(j[t]);return o};Q||(P=function(){if(this instanceof P)throw TypeError("Symbol is not a constructor!");var e=h(arguments.length>0?arguments[0]:void 0),t=function(r){this===H&&t.call(G,r),n(this,B)&&n(this[B],e)&&(this[B][e]=!1),z(this,e,C(1,r))};return o&&q&&z(H,e,{configurable:!0,set:t}),Z(e)},a(P[x],"toString",(function(){return this._k})),I.f=ee,w.f=K,r("6438").f=b.f=te,r("1917").f=X,R.f=re,o&&!r("e444")&&a(H,"propertyIsEnumerable",X,!0),f.f=function(e){return Z(p(e))}),s(s.G+s.W+s.F*!Q,{Symbol:P});for(var ie="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;ie.length>ne;)p(ie[ne++]);for(var oe=k(p.store),se=0;oe.length>se;)g(oe[se++]);s(s.S+s.F*!Q,"Symbol",{for:function(e){return n(V,e+="")?V[e]:V[e]=P(e)},keyFor:function(e){if(!Y(e))throw TypeError(e+" is not a symbol!");for(var t in V)if(V[t]===e)return t},useSetter:function(){q=!0},useSimple:function(){q=!1}}),s(s.S+s.F*!Q,"Object",{create:J,defineProperty:K,defineProperties:$,getOwnPropertyDescriptor:ee,getOwnPropertyNames:te,getOwnPropertySymbols:re});var ae=l((function(){R.f(1)}));s(s.S+s.F*ae,"Object",{getOwnPropertySymbols:function(e){return R.f(A(e))}}),D&&s(s.S+s.F*(!Q||l((function(){var e=P();return"[null]"!=M([e])||"{}"!=M({a:e})||"{}"!=M(Object(e))}))),"JSON",{stringify:function(e){var t,r,i=[e],n=1;while(arguments.length>n)i.push(arguments[n++]);if(r=t=i[1],(E(t)||void 0!==e)&&!Y(e))return _(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!Y(t))return t}),i[1]=t,M.apply(D,i)}}),P[x][U]||r("051b")(P[x],U,P[x].valueOf),d(P,"Symbol"),d(Math,"Math",!0),d(i.JSON,"JSON",!0)},"69f3":function(e,t,r){var i,n,o,s=r("7f9a"),a=r("da84"),c=r("e330"),l=r("861d"),u=r("9112"),d=r("1a2d"),h=r("c6cd"),p=r("f772"),f=r("d012"),g="Object already initialized",m=a.TypeError,_=a.WeakMap,v=function(e){return o(e)?n(e):i(e,{})},E=function(e){return function(t){var r;if(!l(t)||(r=n(t)).type!==e)throw m("Incompatible receiver, "+e+" required");return r}};if(s||h.state){var A=h.state||(h.state=new _),y=c(A.get),S=c(A.has),C=c(A.set);i=function(e,t){if(S(A,e))throw new m(g);return t.facade=e,C(A,e,t),t},n=function(e){return y(A,e)||{}},o=function(e){return S(A,e)}}else{var T=p("state");f[T]=!0,i=function(e,t){if(d(e,T))throw new m(g);return t.facade=e,u(e,T,t),t},n=function(e){return d(e,T)?e[T]:{}},o=function(e){return d(e,T)}}e.exports={set:i,get:n,has:o,enforce:v,getterFor:E}},"6ac9":function(e,t,r){e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=79)}({0:function(e,t,r){"use strict";function i(e,t,r,i,n,o,s,a){var c,l="function"===typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=r,l._compiled=!0),i&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),s?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},l._ssrRegister=c):n&&(c=a?function(){n.call(this,this.$root.$options.shadowRoot)}:n),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(e,t){return c.call(t),u(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,c):[c]}return{exports:e,options:l}}r.d(t,"a",(function(){return i}))},2:function(e,t){e.exports=r("5924")},3:function(e,t){e.exports=r("8122")},5:function(e,t){e.exports=r("e974")},7:function(e,t){e.exports=r("2b0e")},79:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("span",[r("transition",{attrs:{name:e.transition},on:{"after-enter":e.handleAfterEnter,"after-leave":e.handleAfterLeave}},[r("div",{directives:[{name:"show",rawName:"v-show",value:!e.disabled&&e.showPopper,expression:"!disabled && showPopper"}],ref:"popper",staticClass:"el-popover el-popper",class:[e.popperClass,e.content&&"el-popover--plain"],style:{width:e.width+"px"},attrs:{role:"tooltip",id:e.tooltipId,"aria-hidden":e.disabled||!e.showPopper?"true":"false"}},[e.title?r("div",{staticClass:"el-popover__title",domProps:{textContent:e._s(e.title)}}):e._e(),e._t("default",[e._v(e._s(e.content))])],2)]),r("span",{ref:"wrapper",staticClass:"el-popover__reference-wrapper"},[e._t("reference")],2)],1)},n=[];i._withStripped=!0;var o=r(5),s=r.n(o),a=r(2),c=r(3),l={name:"ElPopover",mixins:[s.a],props:{trigger:{type:String,default:"click",validator:function(e){return["click","focus","hover","manual"].indexOf(e)>-1}},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:200},title:String,disabled:Boolean,content:String,reference:{},popperClass:String,width:{},visibleArrow:{default:!0},arrowOffset:{type:Number,default:0},transition:{type:String,default:"fade-in-linear"},tabindex:{type:Number,default:0}},computed:{tooltipId:function(){return"el-popover-"+Object(c["generateId"])()}},watch:{showPopper:function(e){this.disabled||(e?this.$emit("show"):this.$emit("hide"))}},mounted:function(){var e=this,t=this.referenceElm=this.reference||this.$refs.reference,r=this.popper||this.$refs.popper;!t&&this.$refs.wrapper.children&&(t=this.referenceElm=this.$refs.wrapper.children[0]),t&&(Object(a["addClass"])(t,"el-popover__reference"),t.setAttribute("aria-describedby",this.tooltipId),t.setAttribute("tabindex",this.tabindex),r.setAttribute("tabindex",0),"click"!==this.trigger&&(Object(a["on"])(t,"focusin",(function(){e.handleFocus();var r=t.__vue__;r&&"function"===typeof r.focus&&r.focus()})),Object(a["on"])(r,"focusin",this.handleFocus),Object(a["on"])(t,"focusout",this.handleBlur),Object(a["on"])(r,"focusout",this.handleBlur)),Object(a["on"])(t,"keydown",this.handleKeydown),Object(a["on"])(t,"click",this.handleClick)),"click"===this.trigger?(Object(a["on"])(t,"click",this.doToggle),Object(a["on"])(document,"click",this.handleDocumentClick)):"hover"===this.trigger?(Object(a["on"])(t,"mouseenter",this.handleMouseEnter),Object(a["on"])(r,"mouseenter",this.handleMouseEnter),Object(a["on"])(t,"mouseleave",this.handleMouseLeave),Object(a["on"])(r,"mouseleave",this.handleMouseLeave)):"focus"===this.trigger&&(this.tabindex<0&&console.warn("[Element Warn][Popover]a negative taindex means that the element cannot be focused by tab key"),t.querySelector("input, textarea")?(Object(a["on"])(t,"focusin",this.doShow),Object(a["on"])(t,"focusout",this.doClose)):(Object(a["on"])(t,"mousedown",this.doShow),Object(a["on"])(t,"mouseup",this.doClose)))},beforeDestroy:function(){this.cleanup()},deactivated:function(){this.cleanup()},methods:{doToggle:function(){this.showPopper=!this.showPopper},doShow:function(){this.showPopper=!0},doClose:function(){this.showPopper=!1},handleFocus:function(){Object(a["addClass"])(this.referenceElm,"focusing"),"click"!==this.trigger&&"focus"!==this.trigger||(this.showPopper=!0)},handleClick:function(){Object(a["removeClass"])(this.referenceElm,"focusing")},handleBlur:function(){Object(a["removeClass"])(this.referenceElm,"focusing"),"click"!==this.trigger&&"focus"!==this.trigger||(this.showPopper=!1)},handleMouseEnter:function(){var e=this;clearTimeout(this._timer),this.openDelay?this._timer=setTimeout((function(){e.showPopper=!0}),this.openDelay):this.showPopper=!0},handleKeydown:function(e){27===e.keyCode&&"manual"!==this.trigger&&this.doClose()},handleMouseLeave:function(){var e=this;clearTimeout(this._timer),this.closeDelay?this._timer=setTimeout((function(){e.showPopper=!1}),this.closeDelay):this.showPopper=!1},handleDocumentClick:function(e){var t=this.reference||this.$refs.reference,r=this.popper||this.$refs.popper;!t&&this.$refs.wrapper.children&&(t=this.referenceElm=this.$refs.wrapper.children[0]),this.$el&&t&&!this.$el.contains(e.target)&&!t.contains(e.target)&&r&&!r.contains(e.target)&&(this.showPopper=!1)},handleAfterEnter:function(){this.$emit("after-enter")},handleAfterLeave:function(){this.$emit("after-leave"),this.doDestroy()},cleanup:function(){(this.openDelay||this.closeDelay)&&clearTimeout(this._timer)}},destroyed:function(){var e=this.reference;Object(a["off"])(e,"click",this.doToggle),Object(a["off"])(e,"mouseup",this.doClose),Object(a["off"])(e,"mousedown",this.doShow),Object(a["off"])(e,"focusin",this.doShow),Object(a["off"])(e,"focusout",this.doClose),Object(a["off"])(e,"mousedown",this.doShow),Object(a["off"])(e,"mouseup",this.doClose),Object(a["off"])(e,"mouseleave",this.handleMouseLeave),Object(a["off"])(e,"mouseenter",this.handleMouseEnter),Object(a["off"])(document,"click",this.handleDocumentClick)}},u=l,d=r(0),h=Object(d["a"])(u,i,n,!1,null,null,null);h.options.__file="packages/popover/src/main.vue";var p=h.exports,f=function(e,t,r){var i=t.expression?t.value:t.arg,n=r.context.$refs[i];n&&(Array.isArray(n)?n[0].$refs.reference=e:n.$refs.reference=e)},g={bind:function(e,t,r){f(e,t,r)},inserted:function(e,t,r){f(e,t,r)}},m=r(7),_=r.n(m);_.a.directive("popover",g),p.install=function(e){e.directive("popover",g),e.component(p.name,p)},p.directive=g;t["default"]=p}})},"6b7c":function(e,t,r){"use strict";t.__esModule=!0;var i=r("4897");t.default={methods:{t:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return i.t.apply(this,t)}}}},"6c57":function(e,t,r){var i=r("23e7"),n=r("da84");i({global:!0},{globalThis:n})},"6ca1":function(e,t,r){var i=r("9fbb"),n=r("c901");e.exports=function(e){return i(n(e))}},"6dd8":function(e,t,r){"use strict";r.r(t),function(e){var r=function(){if("undefined"!==typeof Map)return Map;function e(e,t){var r=-1;return e.some((function(e,i){return e[0]===t&&(r=i,!0)})),r}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var r=e(this.__entries__,t),i=this.__entries__[r];return i&&i[1]},t.prototype.set=function(t,r){var i=e(this.__entries__,t);~i?this.__entries__[i][1]=r:this.__entries__.push([t,r])},t.prototype.delete=function(t){var r=this.__entries__,i=e(r,t);~i&&r.splice(i,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var r=0,i=this.__entries__;r<i.length;r++){var n=i[r];e.call(t,n[1],n[0])}},t}()}(),i="undefined"!==typeof window&&"undefined"!==typeof document&&window.document===document,n=function(){return"undefined"!==typeof e&&e.Math===Math?e:"undefined"!==typeof self&&self.Math===Math?self:"undefined"!==typeof window&&window.Math===Math?window:Function("return this")()}(),o=function(){return"function"===typeof requestAnimationFrame?requestAnimationFrame.bind(n):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)}}(),s=2;function a(e,t){var r=!1,i=!1,n=0;function a(){r&&(r=!1,e()),i&&l()}function c(){o(a)}function l(){var e=Date.now();if(r){if(e-n<s)return;i=!0}else r=!0,i=!1,setTimeout(c,t);n=e}return l}var c=20,l=["top","right","bottom","left","width","height","size","weight"],u="undefined"!==typeof MutationObserver,d=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=a(this.refresh.bind(this),c)}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,r=t.indexOf(e);~r&&t.splice(r,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){i&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),u?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){i&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,r=void 0===t?"":t,i=l.some((function(e){return!!~r.indexOf(e)}));i&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),h=function(e,t){for(var r=0,i=Object.keys(t);r<i.length;r++){var n=i[r];Object.defineProperty(e,n,{value:t[n],enumerable:!1,writable:!1,configurable:!0})}return e},p=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView;return t||n},f=T(0,0,0,0);function g(e){return parseFloat(e)||0}function m(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.reduce((function(t,r){var i=e["border-"+r+"-width"];return t+g(i)}),0)}function _(e){for(var t=["top","right","bottom","left"],r={},i=0,n=t;i<n.length;i++){var o=n[i],s=e["padding-"+o];r[o]=g(s)}return r}function v(e){var t=e.getBBox();return T(0,0,t.width,t.height)}function E(e){var t=e.clientWidth,r=e.clientHeight;if(!t&&!r)return f;var i=p(e).getComputedStyle(e),n=_(i),o=n.left+n.right,s=n.top+n.bottom,a=g(i.width),c=g(i.height);if("border-box"===i.boxSizing&&(Math.round(a+o)!==t&&(a-=m(i,"left","right")+o),Math.round(c+s)!==r&&(c-=m(i,"top","bottom")+s)),!y(e)){var l=Math.round(a+o)-t,u=Math.round(c+s)-r;1!==Math.abs(l)&&(a-=l),1!==Math.abs(u)&&(c-=u)}return T(n.left,n.top,a,c)}var A=function(){return"undefined"!==typeof SVGGraphicsElement?function(e){return e instanceof p(e).SVGGraphicsElement}:function(e){return e instanceof p(e).SVGElement&&"function"===typeof e.getBBox}}();function y(e){return e===p(e).document.documentElement}function S(e){return i?A(e)?v(e):E(e):f}function C(e){var t=e.x,r=e.y,i=e.width,n=e.height,o="undefined"!==typeof DOMRectReadOnly?DOMRectReadOnly:Object,s=Object.create(o.prototype);return h(s,{x:t,y:r,width:i,height:n,top:r,right:t+i,bottom:n+r,left:t}),s}function T(e,t,r,i){return{x:e,y:t,width:r,height:i}}var b=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=T(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=S(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),I=function(){function e(e,t){var r=C(t);h(this,{target:e,contentRect:r})}return e}(),R=function(){function e(e,t,i){if(this.activeObservations_=[],this.observations_=new r,"function"!==typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=i}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!==typeof Element&&Element instanceof Object){if(!(e instanceof p(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new b(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!==typeof Element&&Element instanceof Object){if(!(e instanceof p(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new I(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),w="undefined"!==typeof WeakMap?new WeakMap:new r,k=function(){function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var r=d.getInstance(),i=new R(t,r,this);w.set(this,i)}return e}();["observe","unobserve","disconnect"].forEach((function(e){k.prototype[e]=function(){var t;return(t=w.get(this))[e].apply(t,arguments)}}));var O=function(){return"undefined"!==typeof n.ResizeObserver?n.ResizeObserver:k}();t["default"]=O}.call(this,r("c8ba"))},"6eeb":function(e,t,r){var i=r("da84"),n=r("1626"),o=r("1a2d"),s=r("9112"),a=r("ce4e"),c=r("8925"),l=r("69f3"),u=r("5e77").CONFIGURABLE,d=l.get,h=l.enforce,p=String(String).split("String");(e.exports=function(e,t,r,c){var l,d=!!c&&!!c.unsafe,f=!!c&&!!c.enumerable,g=!!c&&!!c.noTargetGet,m=c&&void 0!==c.name?c.name:t;n(r)&&("Symbol("===String(m).slice(0,7)&&(m="["+String(m).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!o(r,"name")||u&&r.name!==m)&&s(r,"name",m),l=h(r),l.source||(l.source=p.join("string"==typeof m?m:""))),e!==i?(d?!g&&e[t]&&(f=!0):delete e[t],f?e[t]=r:s(e,t,r)):f?e[t]=r:a(t,r)})(Function.prototype,"toString",(function(){return n(this)&&d(this).source||c(this)}))},"6f4f":function(e,t,r){var i=r("77e9"),n=r("85e7"),o=r("9742"),s=r("5a94")("IE_PROTO"),a=function(){},c="prototype",l=function(){var e,t=r("05f5")("iframe"),i=o.length,n="<",s=">";t.style.display="none",r("9141").appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write(n+"script"+s+"document.F=Object"+n+"/script"+s),e.close(),l=e.F;while(i--)delete l[c][o[i]];return l()};e.exports=Object.create||function(e,t){var r;return null!==e?(a[c]=i(e),r=new a,a[c]=null,r[s]=e):r=l(),void 0===t?r:n(r,t)}},"6f53":function(e,t,r){var i=r("83ab"),n=r("e330"),o=r("df75"),s=r("fc6a"),a=r("d1e7").f,c=n(a),l=n([].push),u=function(e){return function(t){var r,n=s(t),a=o(n),u=a.length,d=0,h=[];while(u>d)r=a[d++],i&&!c(n,r)||l(h,e?[r,n[r]]:n[r]);return h}};e.exports={entries:u(!0),values:u(!1)}},7037:function(e,t,r){function i(t){return e.exports=i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports["default"]=e.exports,i(t)}r("a4d3"),r("e01a"),r("d3b7"),r("d28b"),r("3ca3"),r("ddb0"),e.exports=i,e.exports.__esModule=!0,e.exports["default"]=e.exports},7039:function(e,t,r){var i=r("23e7"),n=r("d039"),o=r("057f").f,s=n((function(){return!Object.getOwnPropertyNames(1)}));i({target:"Object",stat:!0,forced:s},{getOwnPropertyNames:o})},7156:function(e,t,r){var i=r("1626"),n=r("861d"),o=r("d2bb");e.exports=function(e,t,r){var s,a;return o&&i(s=t.constructor)&&s!==r&&n(a=s.prototype)&&a!==r.prototype&&o(e,a),e}},"722f":function(e,t,r){"use strict";t.__esModule=!0;var i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=r("e452"),o=s(n);function s(e){return e&&e.__esModule?e:{default:e}}var a,c=c||{};c.Dialog=function(e,t,r){var n=this;if(this.dialogNode=e,null===this.dialogNode||"dialog"!==this.dialogNode.getAttribute("role"))throw new Error("Dialog() requires a DOM element with ARIA role of dialog.");"string"===typeof t?this.focusAfterClosed=document.getElementById(t):"object"===("undefined"===typeof t?"undefined":i(t))?this.focusAfterClosed=t:this.focusAfterClosed=null,"string"===typeof r?this.focusFirst=document.getElementById(r):"object"===("undefined"===typeof r?"undefined":i(r))?this.focusFirst=r:this.focusFirst=null,this.focusFirst?this.focusFirst.focus():o.default.focusFirstDescendant(this.dialogNode),this.lastFocus=document.activeElement,a=function(e){n.trapFocus(e)},this.addListeners()},c.Dialog.prototype.addListeners=function(){document.addEventListener("focus",a,!0)},c.Dialog.prototype.removeListeners=function(){document.removeEventListener("focus",a,!0)},c.Dialog.prototype.closeDialog=function(){var e=this;this.removeListeners(),this.focusAfterClosed&&setTimeout((function(){e.focusAfterClosed.focus()}))},c.Dialog.prototype.trapFocus=function(e){o.default.IgnoreUtilFocusChanges||(this.dialogNode.contains(e.target)?this.lastFocus=e.target:(o.default.focusFirstDescendant(this.dialogNode),this.lastFocus===document.activeElement&&o.default.focusLastDescendant(this.dialogNode),this.lastFocus=document.activeElement))},t.default=c.Dialog},"72f7":function(e,t,r){"use strict";var i=r("ebb5").exportTypedArrayMethod,n=r("d039"),o=r("da84"),s=r("e330"),a=o.Uint8Array,c=a&&a.prototype||{},l=[].toString,u=s([].join);n((function(){l.call({})}))&&(l=function(){return u(this)});var d=c.toString!=l;i("toString",l,d)},"735e":function(e,t,r){"use strict";var i=r("ebb5"),n=r("c65b"),o=r("81d5"),s=i.aTypedArray,a=i.exportTypedArrayMethod;a("fill",(function(e){var t=arguments.length;return n(o,s(this),e,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)}))},7418:function(e,t){t.f=Object.getOwnPropertySymbols},"746f":function(e,t,r){var i=r("428f"),n=r("1a2d"),o=r("e538"),s=r("9bf2").f;e.exports=function(e){var t=i.Symbol||(i.Symbol={});n(t,e)||s(t,e,{value:o.f(e)})}},"74e8":function(e,t,r){"use strict";var i=r("23e7"),n=r("da84"),o=r("c65b"),s=r("83ab"),a=r("8aa7"),c=r("ebb5"),l=r("621a"),u=r("19aa"),d=r("5c6c"),h=r("9112"),p=r("eac5"),f=r("50c4"),g=r("0b25"),m=r("182d"),_=r("a04b"),v=r("1a2d"),E=r("f5df"),A=r("861d"),y=r("d9b5"),S=r("7c73"),C=r("3a9b"),T=r("d2bb"),b=r("241c").f,I=r("a078"),R=r("b727").forEach,w=r("2626"),k=r("9bf2"),O=r("06cf"),N=r("69f3"),L=r("7156"),P=N.get,D=N.set,M=k.f,x=O.f,B=Math.round,U=n.RangeError,F=l.ArrayBuffer,V=F.prototype,j=l.DataView,G=c.NATIVE_ARRAY_BUFFER_VIEWS,H=c.TYPED_ARRAY_CONSTRUCTOR,Q=c.TYPED_ARRAY_TAG,W=c.TypedArray,q=c.TypedArrayPrototype,z=c.aTypedArrayConstructor,Z=c.isTypedArray,Y="BYTES_PER_ELEMENT",K="Wrong length",$=function(e,t){z(e);var r=0,i=t.length,n=new e(i);while(i>r)n[r]=t[r++];return n},J=function(e,t){M(e,t,{get:function(){return P(this)[t]}})},X=function(e){var t;return C(V,e)||"ArrayBuffer"==(t=E(e))||"SharedArrayBuffer"==t},ee=function(e,t){return Z(e)&&!y(t)&&t in e&&p(+t)&&t>=0},te=function(e,t){return t=_(t),ee(e,t)?d(2,e[t]):x(e,t)},re=function(e,t,r){return t=_(t),!(ee(e,t)&&A(r)&&v(r,"value"))||v(r,"get")||v(r,"set")||r.configurable||v(r,"writable")&&!r.writable||v(r,"enumerable")&&!r.enumerable?M(e,t,r):(e[t]=r.value,e)};s?(G||(O.f=te,k.f=re,J(q,"buffer"),J(q,"byteOffset"),J(q,"byteLength"),J(q,"length")),i({target:"Object",stat:!0,forced:!G},{getOwnPropertyDescriptor:te,defineProperty:re}),e.exports=function(e,t,r){var s=e.match(/\d+$/)[0]/8,c=e+(r?"Clamped":"")+"Array",l="get"+e,d="set"+e,p=n[c],_=p,v=_&&_.prototype,E={},y=function(e,t){var r=P(e);return r.view[l](t*s+r.byteOffset,!0)},C=function(e,t,i){var n=P(e);r&&(i=(i=B(i))<0?0:i>255?255:255&i),n.view[d](t*s+n.byteOffset,i,!0)},k=function(e,t){M(e,t,{get:function(){return y(this,t)},set:function(e){return C(this,t,e)},enumerable:!0})};G?a&&(_=t((function(e,t,r,i){return u(e,v),L(function(){return A(t)?X(t)?void 0!==i?new p(t,m(r,s),i):void 0!==r?new p(t,m(r,s)):new p(t):Z(t)?$(_,t):o(I,_,t):new p(g(t))}(),e,_)})),T&&T(_,W),R(b(p),(function(e){e in _||h(_,e,p[e])})),_.prototype=v):(_=t((function(e,t,r,i){u(e,v);var n,a,c,l=0,d=0;if(A(t)){if(!X(t))return Z(t)?$(_,t):o(I,_,t);n=t,d=m(r,s);var h=t.byteLength;if(void 0===i){if(h%s)throw U(K);if(a=h-d,a<0)throw U(K)}else if(a=f(i)*s,a+d>h)throw U(K);c=a/s}else c=g(t),a=c*s,n=new F(a);D(e,{buffer:n,byteOffset:d,byteLength:a,length:c,view:new j(n)});while(l<c)k(e,l++)})),T&&T(_,W),v=_.prototype=S(q)),v.constructor!==_&&h(v,"constructor",_),h(v,H,_),Q&&h(v,Q,c),E[c]=_,i({global:!0,forced:_!=p,sham:!G},E),Y in _||h(_,Y,s),Y in v||h(v,Y,s),w(c)}):e.exports=function(){}},"77a7":function(e,t,r){var i=r("da84"),n=i.Array,o=Math.abs,s=Math.pow,a=Math.floor,c=Math.log,l=Math.LN2,u=function(e,t,r){var i,u,d,h=n(r),p=8*r-t-1,f=(1<<p)-1,g=f>>1,m=23===t?s(2,-24)-s(2,-77):0,_=e<0||0===e&&1/e<0?1:0,v=0;e=o(e),e!=e||e===1/0?(u=e!=e?1:0,i=f):(i=a(c(e)/l),d=s(2,-i),e*d<1&&(i--,d*=2),e+=i+g>=1?m/d:m*s(2,1-g),e*d>=2&&(i++,d/=2),i+g>=f?(u=0,i=f):i+g>=1?(u=(e*d-1)*s(2,t),i+=g):(u=e*s(2,g-1)*s(2,t),i=0));while(t>=8)h[v++]=255&u,u/=256,t-=8;i=i<<t|u,p+=t;while(p>0)h[v++]=255&i,i/=256,p-=8;return h[--v]|=128*_,h},d=function(e,t){var r,i=e.length,n=8*i-t-1,o=(1<<n)-1,a=o>>1,c=n-7,l=i-1,u=e[l--],d=127&u;u>>=7;while(c>0)d=256*d+e[l--],c-=8;r=d&(1<<-c)-1,d>>=-c,c+=t;while(c>0)r=256*r+e[l--],c-=8;if(0===d)d=1-a;else{if(d===o)return r?NaN:u?-1/0:1/0;r+=s(2,t),d-=a}return(u?-1:1)*r*s(2,d-t)};e.exports={pack:u,unpack:d}},"77e9":function(e,t,r){var i=r("7a41");e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},7839:function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"785a":function(e,t,r){var i=r("cc12"),n=i("span").classList,o=n&&n.constructor&&n.constructor.prototype;e.exports=o===Object.prototype?void 0:o},"7a41":function(e,t){e.exports=function(e){return"object"===typeof e?null!==e:"function"===typeof e}},"7a77":function(e,t,r){"use strict";function i(e){this.message=e}i.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},i.prototype.__CANCEL__=!0,e.exports=i},"7aac":function(e,t,r){"use strict";var i=r("c532");e.exports=i.isStandardBrowserEnv()?function(){return{write:function(e,t,r,n,o,s){var a=[];a.push(e+"="+encodeURIComponent(t)),i.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),i.isString(n)&&a.push("path="+n),i.isString(o)&&a.push("domain="+o),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},"7b0b":function(e,t,r){var i=r("da84"),n=r("1d80"),o=i.Object;e.exports=function(e){return o(n(e))}},"7b3e":function(e,t,r){"use strict";var i,n=r("a3de");
/**
 * Checks if an event is supported in the current execution environment.
 *
 * NOTE: This will not work correctly for non-generic events such as `change`,
 * `reset`, `load`, `error`, and `select`.
 *
 * Borrows from Modernizr.
 *
 * @param {string} eventNameSuffix Event name, e.g. "click".
 * @param {?boolean} capture Check if the capture phase is supported.
 * @return {boolean} True if the event is supported.
 * @internal
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 */
function o(e,t){if(!n.canUseDOM||t&&!("addEventListener"in document))return!1;var r="on"+e,o=r in document;if(!o){var s=document.createElement("div");s.setAttribute(r,"return;"),o="function"===typeof s[r]}return!o&&i&&"wheel"===e&&(o=document.implementation.hasFeature("Events.wheel","3.0")),o}n.canUseDOM&&(i=document.implementation&&document.implementation.hasFeature&&!0!==document.implementation.hasFeature("","")),e.exports=o},"7c73":function(e,t,r){var i,n=r("825a"),o=r("37e8"),s=r("7839"),a=r("d012"),c=r("1be4"),l=r("cc12"),u=r("f772"),d=">",h="<",p="prototype",f="script",g=u("IE_PROTO"),m=function(){},_=function(e){return h+f+d+e+h+"/"+f+d},v=function(e){e.write(_("")),e.close();var t=e.parentWindow.Object;return e=null,t},E=function(){var e,t=l("iframe"),r="java"+f+":";return t.style.display="none",c.appendChild(t),t.src=String(r),e=t.contentWindow.document,e.open(),e.write(_("document.F=Object")),e.close(),e.F},A=function(){try{i=new ActiveXObject("htmlfile")}catch(t){}A="undefined"!=typeof document?document.domain&&i?v(i):E():v(i);var e=s.length;while(e--)delete A[p][s[e]];return A()};a[g]=!0,e.exports=Object.create||function(e,t){var r;return null!==e?(m[p]=n(e),r=new m,m[p]=null,r[g]=e):r=A(),void 0===t?r:o.f(r,t)}},"7db0":function(e,t,r){"use strict";var i=r("23e7"),n=r("b727").find,o=r("44d2"),s="find",a=!0;s in[]&&Array(1)[s]((function(){a=!1})),i({target:"Array",proto:!0,forced:a},{find:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),o(s)},"7dd0":function(e,t,r){"use strict";var i=r("23e7"),n=r("c65b"),o=r("c430"),s=r("5e77"),a=r("1626"),c=r("9ed3"),l=r("e163"),u=r("d2bb"),d=r("d44e"),h=r("9112"),p=r("6eeb"),f=r("b622"),g=r("3f8c"),m=r("ae93"),_=s.PROPER,v=s.CONFIGURABLE,E=m.IteratorPrototype,A=m.BUGGY_SAFARI_ITERATORS,y=f("iterator"),S="keys",C="values",T="entries",b=function(){return this};e.exports=function(e,t,r,s,f,m,I){c(r,t,s);var R,w,k,O=function(e){if(e===f&&M)return M;if(!A&&e in P)return P[e];switch(e){case S:return function(){return new r(this,e)};case C:return function(){return new r(this,e)};case T:return function(){return new r(this,e)}}return function(){return new r(this)}},N=t+" Iterator",L=!1,P=e.prototype,D=P[y]||P["@@iterator"]||f&&P[f],M=!A&&D||O(f),x="Array"==t&&P.entries||D;if(x&&(R=l(x.call(new e)),R!==Object.prototype&&R.next&&(o||l(R)===E||(u?u(R,E):a(R[y])||p(R,y,b)),d(R,N,!0,!0),o&&(g[N]=b))),_&&f==C&&D&&D.name!==C&&(!o&&v?h(P,"name",C):(L=!0,M=function(){return n(D,this)})),f)if(w={values:O(C),keys:m?M:O(S),entries:O(T)},I)for(k in w)(A||L||!(k in P))&&p(P,k,w[k]);else i({target:t,proto:!0,forced:A||L},w);return o&&!I||P[y]===M||p(P,y,M,{name:f}),g[t]=M,w}},"7f4d":function(e,t,r){"use strict";t.__esModule=!0,t.default=function(e){for(var t=1,r=arguments.length;t<r;t++){var i=arguments[t]||{};for(var n in i)if(i.hasOwnProperty(n)){var o=i[n];void 0!==o&&(e[n]=o)}}return e}},"7f9a":function(e,t,r){var i=r("da84"),n=r("1626"),o=r("8925"),s=i.WeakMap;e.exports=n(s)&&/native code/.test(o(s))},"7fc1":function(e,t,r){e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=126)}({0:function(e,t,r){"use strict";function i(e,t,r,i,n,o,s,a){var c,l="function"===typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=r,l._compiled=!0),i&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),s?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},l._ssrRegister=c):n&&(c=a?function(){n.call(this,this.$root.$options.shadowRoot)}:n),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(e,t){return c.call(t),u(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,c):[c]}return{exports:e,options:l}}r.d(t,"a",(function(){return i}))},126:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-checkbox-group",attrs:{role:"group","aria-label":"checkbox-group"}},[e._t("default")],2)},n=[];i._withStripped=!0;var o=r(4),s=r.n(o),a={name:"ElCheckboxGroup",componentName:"ElCheckboxGroup",mixins:[s.a],inject:{elFormItem:{default:""}},props:{value:{},disabled:Boolean,min:Number,max:Number,size:String,fill:String,textColor:String},computed:{_elFormItemSize:function(){return(this.elFormItem||{}).elFormItemSize},checkboxGroupSize:function(){return this.size||this._elFormItemSize||(this.$ELEMENT||{}).size}},watch:{value:function(e){this.dispatch("ElFormItem","el.form.change",[e])}}},c=a,l=r(0),u=Object(l["a"])(c,i,n,!1,null,null,null);u.options.__file="packages/checkbox/src/checkbox-group.vue";var d=u.exports;d.install=function(e){e.component(d.name,d)};t["default"]=d},4:function(e,t){e.exports=r("d010")}})},8119:function(e,t,r){r("693d"),r("dfe5"),r("301c"),r("4e71"),e.exports=r("5524").Symbol},8122:function(e,t,r){"use strict";t.__esModule=!0,t.isEmpty=t.isEqual=t.arrayEquals=t.looseEqual=t.capitalize=t.kebabCase=t.autoprefixer=t.isFirefox=t.isEdge=t.isIE=t.coerceTruthyValueToArray=t.arrayFind=t.arrayFindIndex=t.escapeRegexpString=t.valueEquals=t.generateId=t.getValueByPath=void 0;var i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.noop=l,t.hasOwn=u,t.toObject=h,t.getPropByPath=p,t.rafThrottle=v,t.objToArray=E;var n=r("2b0e"),o=a(n),s=r("a742");function a(e){return e&&e.__esModule?e:{default:e}}var c=Object.prototype.hasOwnProperty;function l(){}function u(e,t){return c.call(e,t)}function d(e,t){for(var r in t)e[r]=t[r];return e}function h(e){for(var t={},r=0;r<e.length;r++)e[r]&&d(t,e[r]);return t}t.getValueByPath=function(e,t){t=t||"";for(var r=t.split("."),i=e,n=null,o=0,s=r.length;o<s;o++){var a=r[o];if(!i)break;if(o===s-1){n=i[a];break}i=i[a]}return n};function p(e,t,r){var i=e;t=t.replace(/\[(\w+)\]/g,".$1"),t=t.replace(/^\./,"");for(var n=t.split("."),o=0,s=n.length;o<s-1;++o){if(!i&&!r)break;var a=n[o];if(!(a in i)){if(r)throw new Error("please transfer a valid prop path to form item!");break}i=i[a]}return{o:i,k:n[o],v:i?i[n[o]]:null}}t.generateId=function(){return Math.floor(1e4*Math.random())},t.valueEquals=function(e,t){if(e===t)return!0;if(!(e instanceof Array))return!1;if(!(t instanceof Array))return!1;if(e.length!==t.length)return!1;for(var r=0;r!==e.length;++r)if(e[r]!==t[r])return!1;return!0},t.escapeRegexpString=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return String(e).replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")};var f=t.arrayFindIndex=function(e,t){for(var r=0;r!==e.length;++r)if(t(e[r]))return r;return-1},g=(t.arrayFind=function(e,t){var r=f(e,t);return-1!==r?e[r]:void 0},t.coerceTruthyValueToArray=function(e){return Array.isArray(e)?e:e?[e]:[]},t.isIE=function(){return!o.default.prototype.$isServer&&!isNaN(Number(document.documentMode))},t.isEdge=function(){return!o.default.prototype.$isServer&&navigator.userAgent.indexOf("Edge")>-1},t.isFirefox=function(){return!o.default.prototype.$isServer&&!!window.navigator.userAgent.match(/firefox/i)},t.autoprefixer=function(e){if("object"!==("undefined"===typeof e?"undefined":i(e)))return e;var t=["transform","transition","animation"],r=["ms-","webkit-"];return t.forEach((function(t){var i=e[t];t&&i&&r.forEach((function(r){e[r+t]=i}))})),e},t.kebabCase=function(e){var t=/([^-])([A-Z])/g;return e.replace(t,"$1-$2").replace(t,"$1-$2").toLowerCase()},t.capitalize=function(e){return(0,s.isString)(e)?e.charAt(0).toUpperCase()+e.slice(1):e},t.looseEqual=function(e,t){var r=(0,s.isObject)(e),i=(0,s.isObject)(t);return r&&i?JSON.stringify(e)===JSON.stringify(t):!r&&!i&&String(e)===String(t)}),m=t.arrayEquals=function(e,t){if(e=e||[],t=t||[],e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!g(e[r],t[r]))return!1;return!0},_=(t.isEqual=function(e,t){return Array.isArray(e)&&Array.isArray(t)?m(e,t):g(e,t)},t.isEmpty=function(e){if(null==e)return!0;if("boolean"===typeof e)return!1;if("number"===typeof e)return!e;if(e instanceof Error)return""===e.message;switch(Object.prototype.toString.call(e)){case"[object String]":case"[object Array]":return!e.length;case"[object File]":case"[object Map]":case"[object Set]":return!e.size;case"[object Object]":return!Object.keys(e).length}return!1});function v(e){var t=!1;return function(){for(var r=this,i=arguments.length,n=Array(i),o=0;o<i;o++)n[o]=arguments[o];t||(t=!0,window.requestAnimationFrame((function(i){e.apply(r,n),t=!1})))}}function E(e){return Array.isArray(e)?e:_(e)?[]:[e]}},"81d5":function(e,t,r){"use strict";var i=r("7b0b"),n=r("23cb"),o=r("07fa");e.exports=function(e){var t=i(this),r=o(t),s=arguments.length,a=n(s>1?arguments[1]:void 0,r),c=s>2?arguments[2]:void 0,l=void 0===c?r:n(c,r);while(l>a)t[a++]=e;return t}},"825a":function(e,t,r){var i=r("da84"),n=r("861d"),o=i.String,s=i.TypeError;e.exports=function(e){if(n(e))return e;throw s(o(e)+" is not an object")}},"82f8":function(e,t,r){"use strict";var i=r("ebb5"),n=r("4d64").includes,o=i.aTypedArray,s=i.exportTypedArrayMethod;s("includes",(function(e){return n(o(this),e,arguments.length>1?arguments[1]:void 0)}))},"83ab":function(e,t,r){var i=r("d039");e.exports=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},"83b9":function(e,t,r){"use strict";var i=r("d925"),n=r("e683");e.exports=function(e,t){return e&&!i(t)?n(e,t):t}},8418:function(e,t,r){"use strict";var i=r("a04b"),n=r("9bf2"),o=r("5c6c");e.exports=function(e,t,r){var s=i(t);s in e?n.f(e,s,o(0,r)):e[s]=r}},"845f":function(e,t,r){e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=87)}({0:function(e,t,r){"use strict";function i(e,t,r,i,n,o,s,a){var c,l="function"===typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=r,l._compiled=!0),i&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),s?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},l._ssrRegister=c):n&&(c=a?function(){n.call(this,this.$root.$options.shadowRoot)}:n),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(e,t){return c.call(t),u(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,c):[c]}return{exports:e,options:l}}r.d(t,"a",(function(){return i}))},87:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-button-group"},[e._t("default")],2)},n=[];i._withStripped=!0;var o={name:"ElButtonGroup"},s=o,a=r(0),c=Object(a["a"])(s,i,n,!1,null,null,null);c.options.__file="packages/button/src/button-group.vue";var l=c.exports;l.install=function(e){e.component(l.name,l)};t["default"]=l}})},"848b":function(e,t,r){"use strict";var i=r("5cce").version,n={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){n[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}}));var o={};function s(e,t,r){if("object"!==typeof e)throw new TypeError("options must be an object");var i=Object.keys(e),n=i.length;while(n-- >0){var o=i[n],s=t[o];if(s){var a=e[o],c=void 0===a||s(a,o,e);if(!0!==c)throw new TypeError("option "+o+" must be "+c)}else if(!0!==r)throw Error("Unknown option "+o)}}n.transitional=function(e,t,r){function n(e,t){return"[Axios v"+i+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return function(r,i,s){if(!1===e)throw new Error(n(i," has been removed"+(t?" in "+t:"")));return t&&!o[i]&&(o[i]=!0,console.warn(n(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,i,s)}},e.exports={assertOptions:s,validators:n}},"84c3":function(e,t,r){var i=r("74e8");i("Uint16",(function(e){return function(t,r,i){return e(this,t,r,i)}}))},"85e7":function(e,t,r){var i=r("1a14"),n=r("77e9"),o=r("9876");e.exports=r("0bad")?Object.defineProperties:function(e,t){n(e);var r,s=o(t),a=s.length,c=0;while(a>c)i.f(e,r=s[c++],t[r]);return e}},"861d":function(e,t,r){var i=r("1626");e.exports=function(e){return"object"==typeof e?null!==e:i(e)}},8925:function(e,t,r){var i=r("e330"),n=r("1626"),o=r("c6cd"),s=i(Function.toString);n(o.inspectSource)||(o.inspectSource=function(e){return s(e)}),e.exports=o.inspectSource},"8a0d":function(e,t){e.exports={}},"8a59":function(e,t,r){var i=r("74e8");i("Uint8",(function(e){return function(t,r,i){return e(this,t,r,i)}}),!0)},"8aa5":function(e,t,r){"use strict";var i=r("6547").charAt;e.exports=function(e,t,r){return t+(r?i(e,t).length:1)}},"8aa7":function(e,t,r){var i=r("da84"),n=r("d039"),o=r("1c7e"),s=r("ebb5").NATIVE_ARRAY_BUFFER_VIEWS,a=i.ArrayBuffer,c=i.Int8Array;e.exports=!s||!n((function(){c(1)}))||!n((function(){new c(-1)}))||!o((function(e){new c,new c(null),new c(1.5),new c(e)}),!0)||n((function(){return 1!==new c(new a(2),1,void 0).length}))},"8b09":function(e,t,r){var i=r("74e8");i("Int16",(function(e){return function(t,r,i){return e(this,t,r,i)}}))},"8b1a":function(e,t){var r=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+i).toString(36))}},"8bbc":function(e,t,r){e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=130)}({0:function(e,t,r){"use strict";function i(e,t,r,i,n,o,s,a){var c,l="function"===typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=r,l._compiled=!0),i&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),s?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},l._ssrRegister=c):n&&(c=a?function(){n.call(this,this.$root.$options.shadowRoot)}:n),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(e,t){return c.call(t),u(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,c):[c]}return{exports:e,options:l}}r.d(t,"a",(function(){return i}))},130:function(e,t,r){"use strict";r.r(t);var i,n,o={name:"ElTag",props:{text:String,closable:Boolean,type:String,hit:Boolean,disableTransitions:Boolean,color:String,size:String,effect:{type:String,default:"light",validator:function(e){return-1!==["dark","light","plain"].indexOf(e)}}},methods:{handleClose:function(e){e.stopPropagation(),this.$emit("close",e)},handleClick:function(e){this.$emit("click",e)}},computed:{tagSize:function(){return this.size||(this.$ELEMENT||{}).size}},render:function(e){var t=this.type,r=this.tagSize,i=this.hit,n=this.effect,o=["el-tag",t?"el-tag--"+t:"",r?"el-tag--"+r:"",n?"el-tag--"+n:"",i&&"is-hit"],s=e("span",{class:o,style:{backgroundColor:this.color},on:{click:this.handleClick}},[this.$slots.default,this.closable&&e("i",{class:"el-tag__close el-icon-close",on:{click:this.handleClose}})]);return this.disableTransitions?s:e("transition",{attrs:{name:"el-zoom-in-center"}},[s])}},s=o,a=r(0),c=Object(a["a"])(s,i,n,!1,null,null,null);c.options.__file="packages/tag/src/tag.vue";var l=c.exports;l.install=function(e){e.component(l.name,l)};t["default"]=l}})},"8c4f":function(e,t,r){"use strict";
/*!
  * vue-router v3.5.3
  * (c) 2021 Evan You
  * @license MIT
  */function i(e,t){for(var r in t)e[r]=t[r];return e}var n=/[!'()*]/g,o=function(e){return"%"+e.charCodeAt(0).toString(16)},s=/%2C/g,a=function(e){return encodeURIComponent(e).replace(n,o).replace(s,",")};function c(e){try{return decodeURIComponent(e)}catch(t){0}return e}function l(e,t,r){void 0===t&&(t={});var i,n=r||d;try{i=n(e||"")}catch(a){i={}}for(var o in t){var s=t[o];i[o]=Array.isArray(s)?s.map(u):u(s)}return i}var u=function(e){return null==e||"object"===typeof e?e:String(e)};function d(e){var t={};return e=e.trim().replace(/^(\?|#|&)/,""),e?(e.split("&").forEach((function(e){var r=e.replace(/\+/g," ").split("="),i=c(r.shift()),n=r.length>0?c(r.join("=")):null;void 0===t[i]?t[i]=n:Array.isArray(t[i])?t[i].push(n):t[i]=[t[i],n]})),t):t}function h(e){var t=e?Object.keys(e).map((function(t){var r=e[t];if(void 0===r)return"";if(null===r)return a(t);if(Array.isArray(r)){var i=[];return r.forEach((function(e){void 0!==e&&(null===e?i.push(a(t)):i.push(a(t)+"="+a(e)))})),i.join("&")}return a(t)+"="+a(r)})).filter((function(e){return e.length>0})).join("&"):null;return t?"?"+t:""}var p=/\/?$/;function f(e,t,r,i){var n=i&&i.options.stringifyQuery,o=t.query||{};try{o=g(o)}catch(a){}var s={name:t.name||e&&e.name,meta:e&&e.meta||{},path:t.path||"/",hash:t.hash||"",query:o,params:t.params||{},fullPath:v(t,n),matched:e?_(e):[]};return r&&(s.redirectedFrom=v(r,n)),Object.freeze(s)}function g(e){if(Array.isArray(e))return e.map(g);if(e&&"object"===typeof e){var t={};for(var r in e)t[r]=g(e[r]);return t}return e}var m=f(null,{path:"/"});function _(e){var t=[];while(e)t.unshift(e),e=e.parent;return t}function v(e,t){var r=e.path,i=e.query;void 0===i&&(i={});var n=e.hash;void 0===n&&(n="");var o=t||h;return(r||"/")+o(i)+n}function E(e,t,r){return t===m?e===t:!!t&&(e.path&&t.path?e.path.replace(p,"")===t.path.replace(p,"")&&(r||e.hash===t.hash&&A(e.query,t.query)):!(!e.name||!t.name)&&(e.name===t.name&&(r||e.hash===t.hash&&A(e.query,t.query)&&A(e.params,t.params))))}function A(e,t){if(void 0===e&&(e={}),void 0===t&&(t={}),!e||!t)return e===t;var r=Object.keys(e).sort(),i=Object.keys(t).sort();return r.length===i.length&&r.every((function(r,n){var o=e[r],s=i[n];if(s!==r)return!1;var a=t[r];return null==o||null==a?o===a:"object"===typeof o&&"object"===typeof a?A(o,a):String(o)===String(a)}))}function y(e,t){return 0===e.path.replace(p,"/").indexOf(t.path.replace(p,"/"))&&(!t.hash||e.hash===t.hash)&&S(e.query,t.query)}function S(e,t){for(var r in t)if(!(r in e))return!1;return!0}function C(e){for(var t=0;t<e.matched.length;t++){var r=e.matched[t];for(var i in r.instances){var n=r.instances[i],o=r.enteredCbs[i];if(n&&o){delete r.enteredCbs[i];for(var s=0;s<o.length;s++)n._isBeingDestroyed||o[s](n)}}}}var T={name:"RouterView",functional:!0,props:{name:{type:String,default:"default"}},render:function(e,t){var r=t.props,n=t.children,o=t.parent,s=t.data;s.routerView=!0;var a=o.$createElement,c=r.name,l=o.$route,u=o._routerViewCache||(o._routerViewCache={}),d=0,h=!1;while(o&&o._routerRoot!==o){var p=o.$vnode?o.$vnode.data:{};p.routerView&&d++,p.keepAlive&&o._directInactive&&o._inactive&&(h=!0),o=o.$parent}if(s.routerViewDepth=d,h){var f=u[c],g=f&&f.component;return g?(f.configProps&&b(g,s,f.route,f.configProps),a(g,s,n)):a()}var m=l.matched[d],_=m&&m.components[c];if(!m||!_)return u[c]=null,a();u[c]={component:_},s.registerRouteInstance=function(e,t){var r=m.instances[c];(t&&r!==e||!t&&r===e)&&(m.instances[c]=t)},(s.hook||(s.hook={})).prepatch=function(e,t){m.instances[c]=t.componentInstance},s.hook.init=function(e){e.data.keepAlive&&e.componentInstance&&e.componentInstance!==m.instances[c]&&(m.instances[c]=e.componentInstance),C(l)};var v=m.props&&m.props[c];return v&&(i(u[c],{route:l,configProps:v}),b(_,s,l,v)),a(_,s,n)}};function b(e,t,r,n){var o=t.props=I(r,n);if(o){o=t.props=i({},o);var s=t.attrs=t.attrs||{};for(var a in o)e.props&&a in e.props||(s[a]=o[a],delete o[a])}}function I(e,t){switch(typeof t){case"undefined":return;case"object":return t;case"function":return t(e);case"boolean":return t?e.params:void 0;default:0}}function R(e,t,r){var i=e.charAt(0);if("/"===i)return e;if("?"===i||"#"===i)return t+e;var n=t.split("/");r&&n[n.length-1]||n.pop();for(var o=e.replace(/^\//,"").split("/"),s=0;s<o.length;s++){var a=o[s];".."===a?n.pop():"."!==a&&n.push(a)}return""!==n[0]&&n.unshift(""),n.join("/")}function w(e){var t="",r="",i=e.indexOf("#");i>=0&&(t=e.slice(i),e=e.slice(0,i));var n=e.indexOf("?");return n>=0&&(r=e.slice(n+1),e=e.slice(0,n)),{path:e,query:r,hash:t}}function k(e){return e.replace(/\/+/g,"/")}var O=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)},N=K,L=B,P=U,D=j,M=Y,x=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function B(e,t){var r,i=[],n=0,o=0,s="",a=t&&t.delimiter||"/";while(null!=(r=x.exec(e))){var c=r[0],l=r[1],u=r.index;if(s+=e.slice(o,u),o=u+c.length,l)s+=l[1];else{var d=e[o],h=r[2],p=r[3],f=r[4],g=r[5],m=r[6],_=r[7];s&&(i.push(s),s="");var v=null!=h&&null!=d&&d!==h,E="+"===m||"*"===m,A="?"===m||"*"===m,y=r[2]||a,S=f||g;i.push({name:p||n++,prefix:h||"",delimiter:y,optional:A,repeat:E,partial:v,asterisk:!!_,pattern:S?H(S):_?".*":"[^"+G(y)+"]+?"})}}return o<e.length&&(s+=e.substr(o)),s&&i.push(s),i}function U(e,t){return j(B(e,t),t)}function F(e){return encodeURI(e).replace(/[\/?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}function V(e){return encodeURI(e).replace(/[?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}function j(e,t){for(var r=new Array(e.length),i=0;i<e.length;i++)"object"===typeof e[i]&&(r[i]=new RegExp("^(?:"+e[i].pattern+")$",W(t)));return function(t,i){for(var n="",o=t||{},s=i||{},a=s.pretty?F:encodeURIComponent,c=0;c<e.length;c++){var l=e[c];if("string"!==typeof l){var u,d=o[l.name];if(null==d){if(l.optional){l.partial&&(n+=l.prefix);continue}throw new TypeError('Expected "'+l.name+'" to be defined')}if(O(d)){if(!l.repeat)throw new TypeError('Expected "'+l.name+'" to not repeat, but received `'+JSON.stringify(d)+"`");if(0===d.length){if(l.optional)continue;throw new TypeError('Expected "'+l.name+'" to not be empty')}for(var h=0;h<d.length;h++){if(u=a(d[h]),!r[c].test(u))throw new TypeError('Expected all "'+l.name+'" to match "'+l.pattern+'", but received `'+JSON.stringify(u)+"`");n+=(0===h?l.prefix:l.delimiter)+u}}else{if(u=l.asterisk?V(d):a(d),!r[c].test(u))throw new TypeError('Expected "'+l.name+'" to match "'+l.pattern+'", but received "'+u+'"');n+=l.prefix+u}}else n+=l}return n}}function G(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function H(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function Q(e,t){return e.keys=t,e}function W(e){return e&&e.sensitive?"":"i"}function q(e,t){var r=e.source.match(/\((?!\?)/g);if(r)for(var i=0;i<r.length;i++)t.push({name:i,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return Q(e,t)}function z(e,t,r){for(var i=[],n=0;n<e.length;n++)i.push(K(e[n],t,r).source);var o=new RegExp("(?:"+i.join("|")+")",W(r));return Q(o,t)}function Z(e,t,r){return Y(B(e,r),t,r)}function Y(e,t,r){O(t)||(r=t||r,t=[]),r=r||{};for(var i=r.strict,n=!1!==r.end,o="",s=0;s<e.length;s++){var a=e[s];if("string"===typeof a)o+=G(a);else{var c=G(a.prefix),l="(?:"+a.pattern+")";t.push(a),a.repeat&&(l+="(?:"+c+l+")*"),l=a.optional?a.partial?c+"("+l+")?":"(?:"+c+"("+l+"))?":c+"("+l+")",o+=l}}var u=G(r.delimiter||"/"),d=o.slice(-u.length)===u;return i||(o=(d?o.slice(0,-u.length):o)+"(?:"+u+"(?=$))?"),o+=n?"$":i&&d?"":"(?="+u+"|$)",Q(new RegExp("^"+o,W(r)),t)}function K(e,t,r){return O(t)||(r=t||r,t=[]),r=r||{},e instanceof RegExp?q(e,t):O(e)?z(e,t,r):Z(e,t,r)}N.parse=L,N.compile=P,N.tokensToFunction=D,N.tokensToRegExp=M;var $=Object.create(null);function J(e,t,r){t=t||{};try{var i=$[e]||($[e]=N.compile(e));return"string"===typeof t.pathMatch&&(t[0]=t.pathMatch),i(t,{pretty:!0})}catch(n){return""}finally{delete t[0]}}function X(e,t,r,n){var o="string"===typeof e?{path:e}:e;if(o._normalized)return o;if(o.name){o=i({},e);var s=o.params;return s&&"object"===typeof s&&(o.params=i({},s)),o}if(!o.path&&o.params&&t){o=i({},o),o._normalized=!0;var a=i(i({},t.params),o.params);if(t.name)o.name=t.name,o.params=a;else if(t.matched.length){var c=t.matched[t.matched.length-1].path;o.path=J(c,a,"path "+t.path)}else 0;return o}var u=w(o.path||""),d=t&&t.path||"/",h=u.path?R(u.path,d,r||o.append):d,p=l(u.query,o.query,n&&n.options.parseQuery),f=o.hash||u.hash;return f&&"#"!==f.charAt(0)&&(f="#"+f),{_normalized:!0,path:h,query:p,hash:f}}var ee,te=[String,Object],re=[String,Array],ie=function(){},ne={name:"RouterLink",props:{to:{type:te,required:!0},tag:{type:String,default:"a"},custom:Boolean,exact:Boolean,exactPath:Boolean,append:Boolean,replace:Boolean,activeClass:String,exactActiveClass:String,ariaCurrentValue:{type:String,default:"page"},event:{type:re,default:"click"}},render:function(e){var t=this,r=this.$router,n=this.$route,o=r.resolve(this.to,n,this.append),s=o.location,a=o.route,c=o.href,l={},u=r.options.linkActiveClass,d=r.options.linkExactActiveClass,h=null==u?"router-link-active":u,p=null==d?"router-link-exact-active":d,g=null==this.activeClass?h:this.activeClass,m=null==this.exactActiveClass?p:this.exactActiveClass,_=a.redirectedFrom?f(null,X(a.redirectedFrom),null,r):a;l[m]=E(n,_,this.exactPath),l[g]=this.exact||this.exactPath?l[m]:y(n,_);var v=l[m]?this.ariaCurrentValue:null,A=function(e){oe(e)&&(t.replace?r.replace(s,ie):r.push(s,ie))},S={click:oe};Array.isArray(this.event)?this.event.forEach((function(e){S[e]=A})):S[this.event]=A;var C={class:l},T=!this.$scopedSlots.$hasNormal&&this.$scopedSlots.default&&this.$scopedSlots.default({href:c,route:a,navigate:A,isActive:l[g],isExactActive:l[m]});if(T){if(1===T.length)return T[0];if(T.length>1||!T.length)return 0===T.length?e():e("span",{},T)}if("a"===this.tag)C.on=S,C.attrs={href:c,"aria-current":v};else{var b=se(this.$slots.default);if(b){b.isStatic=!1;var I=b.data=i({},b.data);for(var R in I.on=I.on||{},I.on){var w=I.on[R];R in S&&(I.on[R]=Array.isArray(w)?w:[w])}for(var k in S)k in I.on?I.on[k].push(S[k]):I.on[k]=A;var O=b.data.attrs=i({},b.data.attrs);O.href=c,O["aria-current"]=v}else C.on=S}return e(this.tag,C,this.$slots.default)}};function oe(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&(void 0===e.button||0===e.button)){if(e.currentTarget&&e.currentTarget.getAttribute){var t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function se(e){if(e)for(var t,r=0;r<e.length;r++){if(t=e[r],"a"===t.tag)return t;if(t.children&&(t=se(t.children)))return t}}function ae(e){if(!ae.installed||ee!==e){ae.installed=!0,ee=e;var t=function(e){return void 0!==e},r=function(e,r){var i=e.$options._parentVnode;t(i)&&t(i=i.data)&&t(i=i.registerRouteInstance)&&i(e,r)};e.mixin({beforeCreate:function(){t(this.$options.router)?(this._routerRoot=this,this._router=this.$options.router,this._router.init(this),e.util.defineReactive(this,"_route",this._router.history.current)):this._routerRoot=this.$parent&&this.$parent._routerRoot||this,r(this,this)},destroyed:function(){r(this)}}),Object.defineProperty(e.prototype,"$router",{get:function(){return this._routerRoot._router}}),Object.defineProperty(e.prototype,"$route",{get:function(){return this._routerRoot._route}}),e.component("RouterView",T),e.component("RouterLink",ne);var i=e.config.optionMergeStrategies;i.beforeRouteEnter=i.beforeRouteLeave=i.beforeRouteUpdate=i.created}}var ce="undefined"!==typeof window;function le(e,t,r,i,n){var o=t||[],s=r||Object.create(null),a=i||Object.create(null);e.forEach((function(e){ue(o,s,a,e,n)}));for(var c=0,l=o.length;c<l;c++)"*"===o[c]&&(o.push(o.splice(c,1)[0]),l--,c--);return{pathList:o,pathMap:s,nameMap:a}}function ue(e,t,r,i,n,o){var s=i.path,a=i.name;var c=i.pathToRegexpOptions||{},l=he(s,n,c.strict);"boolean"===typeof i.caseSensitive&&(c.sensitive=i.caseSensitive);var u={path:l,regex:de(l,c),components:i.components||{default:i.component},alias:i.alias?"string"===typeof i.alias?[i.alias]:i.alias:[],instances:{},enteredCbs:{},name:a,parent:n,matchAs:o,redirect:i.redirect,beforeEnter:i.beforeEnter,meta:i.meta||{},props:null==i.props?{}:i.components?i.props:{default:i.props}};if(i.children&&i.children.forEach((function(i){var n=o?k(o+"/"+i.path):void 0;ue(e,t,r,i,u,n)})),t[u.path]||(e.push(u.path),t[u.path]=u),void 0!==i.alias)for(var d=Array.isArray(i.alias)?i.alias:[i.alias],h=0;h<d.length;++h){var p=d[h];0;var f={path:p,children:i.children};ue(e,t,r,f,n,u.path||"/")}a&&(r[a]||(r[a]=u))}function de(e,t){var r=N(e,[],t);return r}function he(e,t,r){return r||(e=e.replace(/\/$/,"")),"/"===e[0]||null==t?e:k(t.path+"/"+e)}function pe(e,t){var r=le(e),i=r.pathList,n=r.pathMap,o=r.nameMap;function s(e){le(e,i,n,o)}function a(e,t){var r="object"!==typeof e?o[e]:void 0;le([t||e],i,n,o,r),r&&r.alias.length&&le(r.alias.map((function(e){return{path:e,children:[t]}})),i,n,o,r)}function c(){return i.map((function(e){return n[e]}))}function l(e,r,s){var a=X(e,r,!1,t),c=a.name;if(c){var l=o[c];if(!l)return h(null,a);var u=l.regex.keys.filter((function(e){return!e.optional})).map((function(e){return e.name}));if("object"!==typeof a.params&&(a.params={}),r&&"object"===typeof r.params)for(var d in r.params)!(d in a.params)&&u.indexOf(d)>-1&&(a.params[d]=r.params[d]);return a.path=J(l.path,a.params,'named route "'+c+'"'),h(l,a,s)}if(a.path){a.params={};for(var p=0;p<i.length;p++){var f=i[p],g=n[f];if(fe(g.regex,a.path,a.params))return h(g,a,s)}}return h(null,a)}function u(e,r){var i=e.redirect,n="function"===typeof i?i(f(e,r,null,t)):i;if("string"===typeof n&&(n={path:n}),!n||"object"!==typeof n)return h(null,r);var s=n,a=s.name,c=s.path,u=r.query,d=r.hash,p=r.params;if(u=s.hasOwnProperty("query")?s.query:u,d=s.hasOwnProperty("hash")?s.hash:d,p=s.hasOwnProperty("params")?s.params:p,a){o[a];return l({_normalized:!0,name:a,query:u,hash:d,params:p},void 0,r)}if(c){var g=ge(c,e),m=J(g,p,'redirect route with path "'+g+'"');return l({_normalized:!0,path:m,query:u,hash:d},void 0,r)}return h(null,r)}function d(e,t,r){var i=J(r,t.params,'aliased route with path "'+r+'"'),n=l({_normalized:!0,path:i});if(n){var o=n.matched,s=o[o.length-1];return t.params=n.params,h(s,t)}return h(null,t)}function h(e,r,i){return e&&e.redirect?u(e,i||r):e&&e.matchAs?d(e,r,e.matchAs):f(e,r,i,t)}return{match:l,addRoute:a,getRoutes:c,addRoutes:s}}function fe(e,t,r){var i=t.match(e);if(!i)return!1;if(!r)return!0;for(var n=1,o=i.length;n<o;++n){var s=e.keys[n-1];s&&(r[s.name||"pathMatch"]="string"===typeof i[n]?c(i[n]):i[n])}return!0}function ge(e,t){return R(e,t.parent?t.parent.path:"/",!0)}var me=ce&&window.performance&&window.performance.now?window.performance:Date;function _e(){return me.now().toFixed(3)}var ve=_e();function Ee(){return ve}function Ae(e){return ve=e}var ye=Object.create(null);function Se(){"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual");var e=window.location.protocol+"//"+window.location.host,t=window.location.href.replace(e,""),r=i({},window.history.state);return r.key=Ee(),window.history.replaceState(r,"",t),window.addEventListener("popstate",be),function(){window.removeEventListener("popstate",be)}}function Ce(e,t,r,i){if(e.app){var n=e.options.scrollBehavior;n&&e.app.$nextTick((function(){var o=Ie(),s=n.call(e,t,r,i?o:null);s&&("function"===typeof s.then?s.then((function(e){Pe(e,o)})).catch((function(e){0})):Pe(s,o))}))}}function Te(){var e=Ee();e&&(ye[e]={x:window.pageXOffset,y:window.pageYOffset})}function be(e){Te(),e.state&&e.state.key&&Ae(e.state.key)}function Ie(){var e=Ee();if(e)return ye[e]}function Re(e,t){var r=document.documentElement,i=r.getBoundingClientRect(),n=e.getBoundingClientRect();return{x:n.left-i.left-t.x,y:n.top-i.top-t.y}}function we(e){return Ne(e.x)||Ne(e.y)}function ke(e){return{x:Ne(e.x)?e.x:window.pageXOffset,y:Ne(e.y)?e.y:window.pageYOffset}}function Oe(e){return{x:Ne(e.x)?e.x:0,y:Ne(e.y)?e.y:0}}function Ne(e){return"number"===typeof e}var Le=/^#\d/;function Pe(e,t){var r="object"===typeof e;if(r&&"string"===typeof e.selector){var i=Le.test(e.selector)?document.getElementById(e.selector.slice(1)):document.querySelector(e.selector);if(i){var n=e.offset&&"object"===typeof e.offset?e.offset:{};n=Oe(n),t=Re(i,n)}else we(e)&&(t=ke(e))}else r&&we(e)&&(t=ke(e));t&&("scrollBehavior"in document.documentElement.style?window.scrollTo({left:t.x,top:t.y,behavior:e.behavior}):window.scrollTo(t.x,t.y))}var De=ce&&function(){var e=window.navigator.userAgent;return(-1===e.indexOf("Android 2.")&&-1===e.indexOf("Android 4.0")||-1===e.indexOf("Mobile Safari")||-1!==e.indexOf("Chrome")||-1!==e.indexOf("Windows Phone"))&&(window.history&&"function"===typeof window.history.pushState)}();function Me(e,t){Te();var r=window.history;try{if(t){var n=i({},r.state);n.key=Ee(),r.replaceState(n,"",e)}else r.pushState({key:Ae(_e())},"",e)}catch(o){window.location[t?"replace":"assign"](e)}}function xe(e){Me(e,!0)}function Be(e,t,r){var i=function(n){n>=e.length?r():e[n]?t(e[n],(function(){i(n+1)})):i(n+1)};i(0)}var Ue={redirected:2,aborted:4,cancelled:8,duplicated:16};function Fe(e,t){return He(e,t,Ue.redirected,'Redirected when going from "'+e.fullPath+'" to "'+We(t)+'" via a navigation guard.')}function Ve(e,t){var r=He(e,t,Ue.duplicated,'Avoided redundant navigation to current location: "'+e.fullPath+'".');return r.name="NavigationDuplicated",r}function je(e,t){return He(e,t,Ue.cancelled,'Navigation cancelled from "'+e.fullPath+'" to "'+t.fullPath+'" with a new navigation.')}function Ge(e,t){return He(e,t,Ue.aborted,'Navigation aborted from "'+e.fullPath+'" to "'+t.fullPath+'" via a navigation guard.')}function He(e,t,r,i){var n=new Error(i);return n._isRouter=!0,n.from=e,n.to=t,n.type=r,n}var Qe=["params","query","hash"];function We(e){if("string"===typeof e)return e;if("path"in e)return e.path;var t={};return Qe.forEach((function(r){r in e&&(t[r]=e[r])})),JSON.stringify(t,null,2)}function qe(e){return Object.prototype.toString.call(e).indexOf("Error")>-1}function ze(e,t){return qe(e)&&e._isRouter&&(null==t||e.type===t)}function Ze(e){return function(t,r,i){var n=!1,o=0,s=null;Ye(e,(function(e,t,r,a){if("function"===typeof e&&void 0===e.cid){n=!0,o++;var c,l=Xe((function(t){Je(t)&&(t=t.default),e.resolved="function"===typeof t?t:ee.extend(t),r.components[a]=t,o--,o<=0&&i()})),u=Xe((function(e){var t="Failed to resolve async component "+a+": "+e;s||(s=qe(e)?e:new Error(t),i(s))}));try{c=e(l,u)}catch(h){u(h)}if(c)if("function"===typeof c.then)c.then(l,u);else{var d=c.component;d&&"function"===typeof d.then&&d.then(l,u)}}})),n||i()}}function Ye(e,t){return Ke(e.map((function(e){return Object.keys(e.components).map((function(r){return t(e.components[r],e.instances[r],e,r)}))})))}function Ke(e){return Array.prototype.concat.apply([],e)}var $e="function"===typeof Symbol&&"symbol"===typeof Symbol.toStringTag;function Je(e){return e.__esModule||$e&&"Module"===e[Symbol.toStringTag]}function Xe(e){var t=!1;return function(){var r=[],i=arguments.length;while(i--)r[i]=arguments[i];if(!t)return t=!0,e.apply(this,r)}}var et=function(e,t){this.router=e,this.base=tt(t),this.current=m,this.pending=null,this.ready=!1,this.readyCbs=[],this.readyErrorCbs=[],this.errorCbs=[],this.listeners=[]};function tt(e){if(!e)if(ce){var t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^https?:\/\/[^\/]+/,"")}else e="/";return"/"!==e.charAt(0)&&(e="/"+e),e.replace(/\/$/,"")}function rt(e,t){var r,i=Math.max(e.length,t.length);for(r=0;r<i;r++)if(e[r]!==t[r])break;return{updated:t.slice(0,r),activated:t.slice(r),deactivated:e.slice(r)}}function it(e,t,r,i){var n=Ye(e,(function(e,i,n,o){var s=nt(e,t);if(s)return Array.isArray(s)?s.map((function(e){return r(e,i,n,o)})):r(s,i,n,o)}));return Ke(i?n.reverse():n)}function nt(e,t){return"function"!==typeof e&&(e=ee.extend(e)),e.options[t]}function ot(e){return it(e,"beforeRouteLeave",at,!0)}function st(e){return it(e,"beforeRouteUpdate",at)}function at(e,t){if(t)return function(){return e.apply(t,arguments)}}function ct(e){return it(e,"beforeRouteEnter",(function(e,t,r,i){return lt(e,r,i)}))}function lt(e,t,r){return function(i,n,o){return e(i,n,(function(e){"function"===typeof e&&(t.enteredCbs[r]||(t.enteredCbs[r]=[]),t.enteredCbs[r].push(e)),o(e)}))}}et.prototype.listen=function(e){this.cb=e},et.prototype.onReady=function(e,t){this.ready?e():(this.readyCbs.push(e),t&&this.readyErrorCbs.push(t))},et.prototype.onError=function(e){this.errorCbs.push(e)},et.prototype.transitionTo=function(e,t,r){var i,n=this;try{i=this.router.match(e,this.current)}catch(s){throw this.errorCbs.forEach((function(e){e(s)})),s}var o=this.current;this.confirmTransition(i,(function(){n.updateRoute(i),t&&t(i),n.ensureURL(),n.router.afterHooks.forEach((function(e){e&&e(i,o)})),n.ready||(n.ready=!0,n.readyCbs.forEach((function(e){e(i)})))}),(function(e){r&&r(e),e&&!n.ready&&(ze(e,Ue.redirected)&&o===m||(n.ready=!0,n.readyErrorCbs.forEach((function(t){t(e)}))))}))},et.prototype.confirmTransition=function(e,t,r){var i=this,n=this.current;this.pending=e;var o=function(e){!ze(e)&&qe(e)&&(i.errorCbs.length?i.errorCbs.forEach((function(t){t(e)})):console.error(e)),r&&r(e)},s=e.matched.length-1,a=n.matched.length-1;if(E(e,n)&&s===a&&e.matched[s]===n.matched[a])return this.ensureURL(),e.hash&&Ce(this.router,n,e,!1),o(Ve(n,e));var c=rt(this.current.matched,e.matched),l=c.updated,u=c.deactivated,d=c.activated,h=[].concat(ot(u),this.router.beforeHooks,st(l),d.map((function(e){return e.beforeEnter})),Ze(d)),p=function(t,r){if(i.pending!==e)return o(je(n,e));try{t(e,n,(function(t){!1===t?(i.ensureURL(!0),o(Ge(n,e))):qe(t)?(i.ensureURL(!0),o(t)):"string"===typeof t||"object"===typeof t&&("string"===typeof t.path||"string"===typeof t.name)?(o(Fe(n,e)),"object"===typeof t&&t.replace?i.replace(t):i.push(t)):r(t)}))}catch(s){o(s)}};Be(h,p,(function(){var r=ct(d),s=r.concat(i.router.resolveHooks);Be(s,p,(function(){if(i.pending!==e)return o(je(n,e));i.pending=null,t(e),i.router.app&&i.router.app.$nextTick((function(){C(e)}))}))}))},et.prototype.updateRoute=function(e){this.current=e,this.cb&&this.cb(e)},et.prototype.setupListeners=function(){},et.prototype.teardown=function(){this.listeners.forEach((function(e){e()})),this.listeners=[],this.current=m,this.pending=null};var ut=function(e){function t(t,r){e.call(this,t,r),this._startLocation=dt(this.base)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.setupListeners=function(){var e=this;if(!(this.listeners.length>0)){var t=this.router,r=t.options.scrollBehavior,i=De&&r;i&&this.listeners.push(Se());var n=function(){var r=e.current,n=dt(e.base);e.current===m&&n===e._startLocation||e.transitionTo(n,(function(e){i&&Ce(t,e,r,!0)}))};window.addEventListener("popstate",n),this.listeners.push((function(){window.removeEventListener("popstate",n)}))}},t.prototype.go=function(e){window.history.go(e)},t.prototype.push=function(e,t,r){var i=this,n=this,o=n.current;this.transitionTo(e,(function(e){Me(k(i.base+e.fullPath)),Ce(i.router,e,o,!1),t&&t(e)}),r)},t.prototype.replace=function(e,t,r){var i=this,n=this,o=n.current;this.transitionTo(e,(function(e){xe(k(i.base+e.fullPath)),Ce(i.router,e,o,!1),t&&t(e)}),r)},t.prototype.ensureURL=function(e){if(dt(this.base)!==this.current.fullPath){var t=k(this.base+this.current.fullPath);e?Me(t):xe(t)}},t.prototype.getCurrentLocation=function(){return dt(this.base)},t}(et);function dt(e){var t=window.location.pathname,r=t.toLowerCase(),i=e.toLowerCase();return!e||r!==i&&0!==r.indexOf(k(i+"/"))||(t=t.slice(e.length)),(t||"/")+window.location.search+window.location.hash}var ht=function(e){function t(t,r,i){e.call(this,t,r),i&&pt(this.base)||ft()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.setupListeners=function(){var e=this;if(!(this.listeners.length>0)){var t=this.router,r=t.options.scrollBehavior,i=De&&r;i&&this.listeners.push(Se());var n=function(){var t=e.current;ft()&&e.transitionTo(gt(),(function(r){i&&Ce(e.router,r,t,!0),De||vt(r.fullPath)}))},o=De?"popstate":"hashchange";window.addEventListener(o,n),this.listeners.push((function(){window.removeEventListener(o,n)}))}},t.prototype.push=function(e,t,r){var i=this,n=this,o=n.current;this.transitionTo(e,(function(e){_t(e.fullPath),Ce(i.router,e,o,!1),t&&t(e)}),r)},t.prototype.replace=function(e,t,r){var i=this,n=this,o=n.current;this.transitionTo(e,(function(e){vt(e.fullPath),Ce(i.router,e,o,!1),t&&t(e)}),r)},t.prototype.go=function(e){window.history.go(e)},t.prototype.ensureURL=function(e){var t=this.current.fullPath;gt()!==t&&(e?_t(t):vt(t))},t.prototype.getCurrentLocation=function(){return gt()},t}(et);function pt(e){var t=dt(e);if(!/^\/#/.test(t))return window.location.replace(k(e+"/#"+t)),!0}function ft(){var e=gt();return"/"===e.charAt(0)||(vt("/"+e),!1)}function gt(){var e=window.location.href,t=e.indexOf("#");return t<0?"":(e=e.slice(t+1),e)}function mt(e){var t=window.location.href,r=t.indexOf("#"),i=r>=0?t.slice(0,r):t;return i+"#"+e}function _t(e){De?Me(mt(e)):window.location.hash=e}function vt(e){De?xe(mt(e)):window.location.replace(mt(e))}var Et=function(e){function t(t,r){e.call(this,t,r),this.stack=[],this.index=-1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.push=function(e,t,r){var i=this;this.transitionTo(e,(function(e){i.stack=i.stack.slice(0,i.index+1).concat(e),i.index++,t&&t(e)}),r)},t.prototype.replace=function(e,t,r){var i=this;this.transitionTo(e,(function(e){i.stack=i.stack.slice(0,i.index).concat(e),t&&t(e)}),r)},t.prototype.go=function(e){var t=this,r=this.index+e;if(!(r<0||r>=this.stack.length)){var i=this.stack[r];this.confirmTransition(i,(function(){var e=t.current;t.index=r,t.updateRoute(i),t.router.afterHooks.forEach((function(t){t&&t(i,e)}))}),(function(e){ze(e,Ue.duplicated)&&(t.index=r)}))}},t.prototype.getCurrentLocation=function(){var e=this.stack[this.stack.length-1];return e?e.fullPath:"/"},t.prototype.ensureURL=function(){},t}(et),At=function(e){void 0===e&&(e={}),this.app=null,this.apps=[],this.options=e,this.beforeHooks=[],this.resolveHooks=[],this.afterHooks=[],this.matcher=pe(e.routes||[],this);var t=e.mode||"hash";switch(this.fallback="history"===t&&!De&&!1!==e.fallback,this.fallback&&(t="hash"),ce||(t="abstract"),this.mode=t,t){case"history":this.history=new ut(this,e.base);break;case"hash":this.history=new ht(this,e.base,this.fallback);break;case"abstract":this.history=new Et(this,e.base);break;default:0}},yt={currentRoute:{configurable:!0}};function St(e,t){return e.push(t),function(){var r=e.indexOf(t);r>-1&&e.splice(r,1)}}function Ct(e,t,r){var i="hash"===r?"#"+t:t;return e?k(e+"/"+i):i}At.prototype.match=function(e,t,r){return this.matcher.match(e,t,r)},yt.currentRoute.get=function(){return this.history&&this.history.current},At.prototype.init=function(e){var t=this;if(this.apps.push(e),e.$once("hook:destroyed",(function(){var r=t.apps.indexOf(e);r>-1&&t.apps.splice(r,1),t.app===e&&(t.app=t.apps[0]||null),t.app||t.history.teardown()})),!this.app){this.app=e;var r=this.history;if(r instanceof ut||r instanceof ht){var i=function(e){var i=r.current,n=t.options.scrollBehavior,o=De&&n;o&&"fullPath"in e&&Ce(t,e,i,!1)},n=function(e){r.setupListeners(),i(e)};r.transitionTo(r.getCurrentLocation(),n,n)}r.listen((function(e){t.apps.forEach((function(t){t._route=e}))}))}},At.prototype.beforeEach=function(e){return St(this.beforeHooks,e)},At.prototype.beforeResolve=function(e){return St(this.resolveHooks,e)},At.prototype.afterEach=function(e){return St(this.afterHooks,e)},At.prototype.onReady=function(e,t){this.history.onReady(e,t)},At.prototype.onError=function(e){this.history.onError(e)},At.prototype.push=function(e,t,r){var i=this;if(!t&&!r&&"undefined"!==typeof Promise)return new Promise((function(t,r){i.history.push(e,t,r)}));this.history.push(e,t,r)},At.prototype.replace=function(e,t,r){var i=this;if(!t&&!r&&"undefined"!==typeof Promise)return new Promise((function(t,r){i.history.replace(e,t,r)}));this.history.replace(e,t,r)},At.prototype.go=function(e){this.history.go(e)},At.prototype.back=function(){this.go(-1)},At.prototype.forward=function(){this.go(1)},At.prototype.getMatchedComponents=function(e){var t=e?e.matched?e:this.resolve(e).route:this.currentRoute;return t?[].concat.apply([],t.matched.map((function(e){return Object.keys(e.components).map((function(t){return e.components[t]}))}))):[]},At.prototype.resolve=function(e,t,r){t=t||this.history.current;var i=X(e,t,r,this),n=this.match(i,t),o=n.redirectedFrom||n.fullPath,s=this.history.base,a=Ct(s,o,this.mode);return{location:i,route:n,href:a,normalizedTo:i,resolved:n}},At.prototype.getRoutes=function(){return this.matcher.getRoutes()},At.prototype.addRoute=function(e,t){this.matcher.addRoute(e,t),this.history.current!==m&&this.history.transitionTo(this.history.getCurrentLocation())},At.prototype.addRoutes=function(e){this.matcher.addRoutes(e),this.history.current!==m&&this.history.transitionTo(this.history.getCurrentLocation())},Object.defineProperties(At.prototype,yt),At.install=ae,At.version="3.5.3",At.isNavigationFailure=ze,At.NavigationFailureType=Ue,At.START_LOCATION=m,ce&&window.Vue&&window.Vue.use(At),t["a"]=At},"8df4":function(e,t,r){"use strict";var i=r("7a77");function n(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;this.promise.then((function(e){if(r._listeners){var t,i=r._listeners.length;for(t=0;t<i;t++)r._listeners[t](e);r._listeners=null}})),this.promise.then=function(e){var t,i=new Promise((function(e){r.subscribe(e),t=e})).then(e);return i.cancel=function(){r.unsubscribe(t)},i},e((function(e){r.reason||(r.reason=new i(e),t(r.reason))}))}n.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},n.prototype.subscribe=function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]},n.prototype.unsubscribe=function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}},n.source=function(){var e,t=new n((function(t){e=t}));return{token:t,cancel:e}},e.exports=n},"8eb7":function(e,t){var r,i,n,o,s,a,c,l,u,d,h,p,f,g,m,_=!1;function v(){if(!_){_=!0;var e=navigator.userAgent,t=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(e),v=/(Mac OS X)|(Windows)|(Linux)/.exec(e);if(p=/\b(iPhone|iP[ao]d)/.exec(e),f=/\b(iP[ao]d)/.exec(e),d=/Android/i.exec(e),g=/FBAN\/\w+;/i.exec(e),m=/Mobile/i.exec(e),h=!!/Win64/.exec(e),t){r=t[1]?parseFloat(t[1]):t[5]?parseFloat(t[5]):NaN,r&&document&&document.documentMode&&(r=document.documentMode);var E=/(?:Trident\/(\d+.\d+))/.exec(e);a=E?parseFloat(E[1])+4:r,i=t[2]?parseFloat(t[2]):NaN,n=t[3]?parseFloat(t[3]):NaN,o=t[4]?parseFloat(t[4]):NaN,o?(t=/(?:Chrome\/(\d+\.\d+))/.exec(e),s=t&&t[1]?parseFloat(t[1]):NaN):s=NaN}else r=i=n=s=o=NaN;if(v){if(v[1]){var A=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(e);c=!A||parseFloat(A[1].replace("_","."))}else c=!1;l=!!v[2],u=!!v[3]}else c=l=u=!1}}var E={ie:function(){return v()||r},ieCompatibilityMode:function(){return v()||a>r},ie64:function(){return E.ie()&&h},firefox:function(){return v()||i},opera:function(){return v()||n},webkit:function(){return v()||o},safari:function(){return E.webkit()},chrome:function(){return v()||s},windows:function(){return v()||l},osx:function(){return v()||c},linux:function(){return v()||u},iphone:function(){return v()||p},mobile:function(){return v()||p||f||d||m},nativeApp:function(){return v()||g},android:function(){return v()||d},ipad:function(){return v()||f}};e.exports=E},"907a":function(e,t,r){"use strict";var i=r("ebb5"),n=r("07fa"),o=r("5926"),s=i.aTypedArray,a=i.exportTypedArrayMethod;a("at",(function(e){var t=s(this),r=n(t),i=o(e),a=i>=0?i:r+i;return a<0||a>=r?void 0:t[a]}))},"90e3":function(e,t,r){var i=r("e330"),n=0,o=Math.random(),s=i(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+s(++n+o,36)}},9112:function(e,t,r){var i=r("83ab"),n=r("9bf2"),o=r("5c6c");e.exports=i?function(e,t,r){return n.f(e,t,o(1,r))}:function(e,t,r){return e[t]=r,e}},9141:function(e,t,r){var i=r("ef08").document;e.exports=i&&i.documentElement},9263:function(e,t,r){"use strict";var i=r("c65b"),n=r("e330"),o=r("577e"),s=r("ad6d"),a=r("9f7f"),c=r("5692"),l=r("7c73"),u=r("69f3").get,d=r("fce3"),h=r("107c"),p=c("native-string-replace",String.prototype.replace),f=RegExp.prototype.exec,g=f,m=n("".charAt),_=n("".indexOf),v=n("".replace),E=n("".slice),A=function(){var e=/a/,t=/b*/g;return i(f,e,"a"),i(f,t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),y=a.BROKEN_CARET,S=void 0!==/()??/.exec("")[1],C=A||S||y||d||h;C&&(g=function(e){var t,r,n,a,c,d,h,C=this,T=u(C),b=o(e),I=T.raw;if(I)return I.lastIndex=C.lastIndex,t=i(g,I,b),C.lastIndex=I.lastIndex,t;var R=T.groups,w=y&&C.sticky,k=i(s,C),O=C.source,N=0,L=b;if(w&&(k=v(k,"y",""),-1===_(k,"g")&&(k+="g"),L=E(b,C.lastIndex),C.lastIndex>0&&(!C.multiline||C.multiline&&"\n"!==m(b,C.lastIndex-1))&&(O="(?: "+O+")",L=" "+L,N++),r=new RegExp("^(?:"+O+")",k)),S&&(r=new RegExp("^"+O+"$(?!\\s)",k)),A&&(n=C.lastIndex),a=i(f,w?r:C,L),w?a?(a.input=E(a.input,N),a[0]=E(a[0],N),a.index=C.lastIndex,C.lastIndex+=a[0].length):C.lastIndex=0:A&&a&&(C.lastIndex=C.global?a.index+a[0].length:n),S&&a&&a.length>1&&i(p,a[0],r,(function(){for(c=1;c<arguments.length-2;c++)void 0===arguments[c]&&(a[c]=void 0)})),a&&R)for(a.groups=d=l(null),c=0;c<R.length;c++)h=R[c],d[h[0]]=a[h[1]];return a}),e.exports=g},"92f0":function(e,t,r){var i=r("1a14").f,n=r("9c0e"),o=r("cc15")("toStringTag");e.exports=function(e,t,r){e&&!n(e=r?e:e.prototype,o)&&i(e,o,{configurable:!0,value:t})}},"92fa":function(e,t){var r=/^(attrs|props|on|nativeOn|class|style|hook)$/;function i(e,t){return function(){e&&e.apply(this,arguments),t&&t.apply(this,arguments)}}e.exports=function(e){return e.reduce((function(e,t){var n,o,s,a,c;for(s in t)if(n=e[s],o=t[s],n&&r.test(s))if("class"===s&&("string"===typeof n&&(c=n,e[s]=n={},n[c]=!0),"string"===typeof o&&(c=o,t[s]=o={},o[c]=!0)),"on"===s||"nativeOn"===s||"hook"===s)for(a in o)n[a]=i(n[a],o[a]);else if(Array.isArray(n))e[s]=n.concat(o);else if(Array.isArray(o))e[s]=[n].concat(o);else for(a in o)n[a]=o[a];else e[s]=t[s];return e}),{})}},"94ca":function(e,t,r){var i=r("d039"),n=r("1626"),o=/#|\.prototype\./,s=function(e,t){var r=c[a(e)];return r==u||r!=l&&(n(t)?i(t):!!t)},a=s.normalize=function(e){return String(e).replace(o,".").toLowerCase()},c=s.data={},l=s.NATIVE="N",u=s.POLYFILL="P";e.exports=s},9619:function(e,t,r){var i=r("597f"),n=r("0e15");e.exports={throttle:i,debounce:n}},"96cf":function(e,t,r){var i=function(e){"use strict";var t,r=Object.prototype,i=r.hasOwnProperty,n="function"===typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",s=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(L){c=function(e,t,r){return e[t]=r}}function l(e,t,r,i){var n=t&&t.prototype instanceof m?t:m,o=Object.create(n.prototype),s=new k(i||[]);return o._invoke=b(e,r,s),o}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(L){return{type:"throw",arg:L}}}e.wrap=l;var d="suspendedStart",h="suspendedYield",p="executing",f="completed",g={};function m(){}function _(){}function v(){}var E={};c(E,o,(function(){return this}));var A=Object.getPrototypeOf,y=A&&A(A(O([])));y&&y!==r&&i.call(y,o)&&(E=y);var S=v.prototype=m.prototype=Object.create(E);function C(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){function r(n,o,s,a){var c=u(e[n],e,o);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"===typeof d&&i.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,s,a)}),(function(e){r("throw",e,s,a)})):t.resolve(d).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,a)}))}a(c.arg)}var n;function o(e,i){function o(){return new t((function(t,n){r(e,i,t,n)}))}return n=n?n.then(o,o):o()}this._invoke=o}function b(e,t,r){var i=d;return function(n,o){if(i===p)throw new Error("Generator is already running");if(i===f){if("throw"===n)throw o;return N()}r.method=n,r.arg=o;while(1){var s=r.delegate;if(s){var a=I(s,r);if(a){if(a===g)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=f,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=u(e,t,r);if("normal"===c.type){if(i=r.done?f:h,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=f,r.method="throw",r.arg=c.arg)}}}function I(e,r){var i=e.iterator[r.method];if(i===t){if(r.delegate=null,"throw"===r.method){if(e.iterator["return"]&&(r.method="return",r.arg=t,I(e,r),"throw"===r.method))return g;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var n=u(i,e.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,g;var o=n.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function R(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(R,this),this.reset(!0)}function O(e){if(e){var r=e[o];if(r)return r.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var n=-1,s=function r(){while(++n<e.length)if(i.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}return{next:N}}function N(){return{value:t,done:!0}}return _.prototype=v,c(S,"constructor",v),c(v,"constructor",_),_.displayName=c(v,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,c(e,a,"GeneratorFunction")),e.prototype=Object.create(S),e},e.awrap=function(e){return{__await:e}},C(T.prototype),c(T.prototype,s,(function(){return this})),e.AsyncIterator=T,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var s=new T(l(t,r,i,n),o);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},C(S),c(S,a,"Generator"),c(S,o,(function(){return this})),c(S,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){while(t.length){var i=t.pop();if(i in e)return r.value=i,r.done=!1,r}return r.done=!0,r}},e.values=O,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(w),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(i,n){return a.type="throw",a.arg=e,r.next=i,n&&(r.method="next",r.arg=t),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),w(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var i=r.completion;if("throw"===i.type){var n=i.arg;w(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,i){return this.delegate={iterator:O(e),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=t),g}},e}(e.exports);try{regeneratorRuntime=i}catch(n){"object"===typeof globalThis?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}},9742:function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},9861:function(e,t,r){"use strict";r("e260");var i=r("23e7"),n=r("da84"),o=r("d066"),s=r("c65b"),a=r("e330"),c=r("0d3b"),l=r("6eeb"),u=r("e2cc"),d=r("d44e"),h=r("9ed3"),p=r("69f3"),f=r("19aa"),g=r("1626"),m=r("1a2d"),_=r("0366"),v=r("f5df"),E=r("825a"),A=r("861d"),y=r("577e"),S=r("7c73"),C=r("5c6c"),T=r("9a1f"),b=r("35a1"),I=r("d6d6"),R=r("b622"),w=r("addb"),k=R("iterator"),O="URLSearchParams",N=O+"Iterator",L=p.set,P=p.getterFor(O),D=p.getterFor(N),M=o("fetch"),x=o("Request"),B=o("Headers"),U=x&&x.prototype,F=B&&B.prototype,V=n.RegExp,j=n.TypeError,G=n.decodeURIComponent,H=n.encodeURIComponent,Q=a("".charAt),W=a([].join),q=a([].push),z=a("".replace),Z=a([].shift),Y=a([].splice),K=a("".split),$=a("".slice),J=/\+/g,X=Array(4),ee=function(e){return X[e-1]||(X[e-1]=V("((?:%[\\da-f]{2}){"+e+"})","gi"))},te=function(e){try{return G(e)}catch(t){return e}},re=function(e){var t=z(e,J," "),r=4;try{return G(t)}catch(i){while(r)t=z(t,ee(r--),te);return t}},ie=/[!'()~]|%20/g,ne={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},oe=function(e){return ne[e]},se=function(e){return z(H(e),ie,oe)},ae=h((function(e,t){L(this,{type:N,iterator:T(P(e).entries),kind:t})}),"Iterator",(function(){var e=D(this),t=e.kind,r=e.iterator.next(),i=r.value;return r.done||(r.value="keys"===t?i.key:"values"===t?i.value:[i.key,i.value]),r}),!0),ce=function(e){this.entries=[],this.url=null,void 0!==e&&(A(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===Q(e,0)?$(e,1):e:y(e)))};ce.prototype={type:O,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,r,i,n,o,a,c,l=b(e);if(l){t=T(e,l),r=t.next;while(!(i=s(r,t)).done){if(n=T(E(i.value)),o=n.next,(a=s(o,n)).done||(c=s(o,n)).done||!s(o,n).done)throw j("Expected sequence with length 2");q(this.entries,{key:y(a.value),value:y(c.value)})}}else for(var u in e)m(e,u)&&q(this.entries,{key:u,value:y(e[u])})},parseQuery:function(e){if(e){var t,r,i=K(e,"&"),n=0;while(n<i.length)t=i[n++],t.length&&(r=K(t,"="),q(this.entries,{key:re(Z(r)),value:re(W(r,"="))}))}},serialize:function(){var e,t=this.entries,r=[],i=0;while(i<t.length)e=t[i++],q(r,se(e.key)+"="+se(e.value));return W(r,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var le=function(){f(this,ue);var e=arguments.length>0?arguments[0]:void 0;L(this,new ce(e))},ue=le.prototype;if(u(ue,{append:function(e,t){I(arguments.length,2);var r=P(this);q(r.entries,{key:y(e),value:y(t)}),r.updateURL()},delete:function(e){I(arguments.length,1);var t=P(this),r=t.entries,i=y(e),n=0;while(n<r.length)r[n].key===i?Y(r,n,1):n++;t.updateURL()},get:function(e){I(arguments.length,1);for(var t=P(this).entries,r=y(e),i=0;i<t.length;i++)if(t[i].key===r)return t[i].value;return null},getAll:function(e){I(arguments.length,1);for(var t=P(this).entries,r=y(e),i=[],n=0;n<t.length;n++)t[n].key===r&&q(i,t[n].value);return i},has:function(e){I(arguments.length,1);var t=P(this).entries,r=y(e),i=0;while(i<t.length)if(t[i++].key===r)return!0;return!1},set:function(e,t){I(arguments.length,1);for(var r,i=P(this),n=i.entries,o=!1,s=y(e),a=y(t),c=0;c<n.length;c++)r=n[c],r.key===s&&(o?Y(n,c--,1):(o=!0,r.value=a));o||q(n,{key:s,value:a}),i.updateURL()},sort:function(){var e=P(this);w(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){var t,r=P(this).entries,i=_(e,arguments.length>1?arguments[1]:void 0),n=0;while(n<r.length)t=r[n++],i(t.value,t.key,this)},keys:function(){return new ae(this,"keys")},values:function(){return new ae(this,"values")},entries:function(){return new ae(this,"entries")}},{enumerable:!0}),l(ue,k,ue.entries,{name:"entries"}),l(ue,"toString",(function(){return P(this).serialize()}),{enumerable:!0}),d(le,O),i({global:!0,forced:!c},{URLSearchParams:le}),!c&&g(B)){var de=a(F.has),he=a(F.set),pe=function(e){if(A(e)){var t,r=e.body;if(v(r)===O)return t=e.headers?new B(e.headers):new B,de(t,"content-type")||he(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),S(e,{body:C(0,y(r)),headers:C(0,t)})}return e};if(g(M)&&i({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return M(e,arguments.length>1?pe(arguments[1]):{})}}),g(x)){var fe=function(e){return f(this,U),new x(e,arguments.length>1?pe(arguments[1]):{})};U.constructor=fe,fe.prototype=U,i({global:!0,forced:!0},{Request:fe})}}e.exports={URLSearchParams:le,getState:P}},9876:function(e,t,r){var i=r("03d6"),n=r("9742");e.exports=Object.keys||function(e){return i(e,n)}},"99af":function(e,t,r){"use strict";var i=r("23e7"),n=r("da84"),o=r("d039"),s=r("e8b5"),a=r("861d"),c=r("7b0b"),l=r("07fa"),u=r("8418"),d=r("65f0"),h=r("1dde"),p=r("b622"),f=r("2d00"),g=p("isConcatSpreadable"),m=9007199254740991,_="Maximum allowed index exceeded",v=n.TypeError,E=f>=51||!o((function(){var e=[];return e[g]=!1,e.concat()[0]!==e})),A=h("concat"),y=function(e){if(!a(e))return!1;var t=e[g];return void 0!==t?!!t:s(e)},S=!E||!A;i({target:"Array",proto:!0,forced:S},{concat:function(e){var t,r,i,n,o,s=c(this),a=d(s,0),h=0;for(t=-1,i=arguments.length;t<i;t++)if(o=-1===t?s:arguments[t],y(o)){if(n=l(o),h+n>m)throw v(_);for(r=0;r<n;r++,h++)r in o&&u(a,h,o[r])}else{if(h>=m)throw v(_);u(a,h++,o)}return a.length=h,a}})},"9a1f":function(e,t,r){var i=r("da84"),n=r("c65b"),o=r("59ed"),s=r("825a"),a=r("0d51"),c=r("35a1"),l=i.TypeError;e.exports=function(e,t){var r=arguments.length<2?c(e):t;if(o(r))return s(n(r,e));throw l(a(e)+" is not iterable")}},"9a8c":function(e,t,r){"use strict";var i=r("e330"),n=r("ebb5"),o=r("145e"),s=i(o),a=n.aTypedArray,c=n.exportTypedArrayMethod;c("copyWithin",(function(e,t){return s(a(this),e,t,arguments.length>2?arguments[2]:void 0)}))},"9ab4":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));function i(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s}},"9afc":function(e,t,r){"use strict";var i=function(e){return n(e)&&!o(e)};function n(e){return!!e&&"object"===typeof e}function o(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||c(e)}var s="function"===typeof Symbol&&Symbol.for,a=s?Symbol.for("react.element"):60103;function c(e){return e.$$typeof===a}function l(e){return Array.isArray(e)?[]:{}}function u(e,t){var r=t&&!0===t.clone;return r&&i(e)?p(l(e),e,t):e}function d(e,t,r){var n=e.slice();return t.forEach((function(t,o){"undefined"===typeof n[o]?n[o]=u(t,r):i(t)?n[o]=p(e[o],t,r):-1===e.indexOf(t)&&n.push(u(t,r))})),n}function h(e,t,r){var n={};return i(e)&&Object.keys(e).forEach((function(t){n[t]=u(e[t],r)})),Object.keys(t).forEach((function(o){i(t[o])&&e[o]?n[o]=p(e[o],t[o],r):n[o]=u(t[o],r)})),n}function p(e,t,r){var i=Array.isArray(t),n=Array.isArray(e),o=r||{arrayMerge:d},s=i===n;if(s){if(i){var a=o.arrayMerge||d;return a(e,t,r)}return h(e,t,r)}return u(t,r)}p.all=function(e,t){if(!Array.isArray(e)||e.length<2)throw new Error("first argument should be an array with at least two elements");return e.reduce((function(e,r){return p(e,r,t)}))};var f=p;e.exports=f},"9bdd":function(e,t,r){var i=r("825a"),n=r("2a62");e.exports=function(e,t,r,o){try{return o?t(i(r)[0],r[1]):t(r)}catch(s){n(e,"throw",s)}}},"9bf2":function(e,t,r){var i=r("da84"),n=r("83ab"),o=r("0cfb"),s=r("aed9"),a=r("825a"),c=r("a04b"),l=i.TypeError,u=Object.defineProperty,d=Object.getOwnPropertyDescriptor,h="enumerable",p="configurable",f="writable";t.f=n?s?function(e,t,r){if(a(e),t=c(t),a(r),"function"===typeof e&&"prototype"===t&&"value"in r&&f in r&&!r[f]){var i=d(e,t);i&&i[f]&&(e[t]=r.value,r={configurable:p in r?r[p]:i[p],enumerable:h in r?r[h]:i[h],writable:!1})}return u(e,t,r)}:u:function(e,t,r){if(a(e),t=c(t),a(r),o)try{return u(e,t,r)}catch(i){}if("get"in r||"set"in r)throw l("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},"9c0c":function(e,t,r){var i=r("1609");e.exports=function(e,t,r){if(i(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,i){return e.call(t,r,i)};case 3:return function(r,i,n){return e.call(t,r,i,n)}}return function(){return e.apply(t,arguments)}}},"9c0e":function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},"9d11":function(e,t,r){var i=r("fc5e"),n=Math.max,o=Math.min;e.exports=function(e,t){return e=i(e),e<0?n(e+t,0):o(e,t)}},"9d7e":function(e,t,r){"use strict";t.__esModule=!0;var i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=function(e){function t(e){for(var t=arguments.length,r=Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];return 1===r.length&&"object"===i(r[0])&&(r=r[0]),r&&r.hasOwnProperty||(r={}),e.replace(o,(function(t,i,o,s){var a=void 0;return"{"===e[s-1]&&"}"===e[s+t.length]?o:(a=(0,n.hasOwn)(r,o)?r[o]:null,null===a||void 0===a?"":a)}))}return t};var n=r("8122"),o=/(%|)\{([0-9a-zA-Z_]+)\}/g},"9ed3":function(e,t,r){"use strict";var i=r("ae93").IteratorPrototype,n=r("7c73"),o=r("5c6c"),s=r("d44e"),a=r("3f8c"),c=function(){return this};e.exports=function(e,t,r,l){var u=t+" Iterator";return e.prototype=n(i,{next:o(+!l,r)}),s(e,u,!1,!0),a[u]=c,e}},"9f7f":function(e,t,r){var i=r("d039"),n=r("da84"),o=n.RegExp,s=i((function(){var e=o("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),a=s||i((function(){return!o("a","y").sticky})),c=s||i((function(){var e=o("^r","gy");return e.lastIndex=2,null!=e.exec("str")}));e.exports={BROKEN_CARET:c,MISSED_STICKY:a,UNSUPPORTED_Y:s}},"9fbb":function(e,t,r){var i=r("4d88");e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)}},a04b:function(e,t,r){var i=r("c04e"),n=r("d9b5");e.exports=function(e){var t=i(e,"string");return n(t)?t:t+""}},a078:function(e,t,r){var i=r("0366"),n=r("c65b"),o=r("5087"),s=r("7b0b"),a=r("07fa"),c=r("9a1f"),l=r("35a1"),u=r("e95a"),d=r("ebb5").aTypedArrayConstructor;e.exports=function(e){var t,r,h,p,f,g,m=o(this),_=s(e),v=arguments.length,E=v>1?arguments[1]:void 0,A=void 0!==E,y=l(_);if(y&&!u(y)){f=c(_,y),g=f.next,_=[];while(!(p=n(g,f)).done)_.push(p.value)}for(A&&v>2&&(E=i(E,arguments[2])),r=a(_),h=new(d(m))(r),t=0;r>t;t++)h[t]=A?E(_[t],t):_[t];return h}},a15b:function(e,t,r){"use strict";var i=r("23e7"),n=r("e330"),o=r("44ad"),s=r("fc6a"),a=r("a640"),c=n([].join),l=o!=Object,u=a("join",",");i({target:"Array",proto:!0,forced:l||!u},{join:function(e){return c(s(this),void 0===e?",":e)}})},a15e:function(e,t,r){"use strict";r.r(t);var i=r("41b2"),n=r.n(i),o=r("1098"),s=r.n(o),a=/%[sdj%]/g,c=function(){};function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=1,n=t[0],o=t.length;if("function"===typeof n)return n.apply(null,t.slice(1));if("string"===typeof n){for(var s=String(n).replace(a,(function(e){if("%%"===e)return"%";if(i>=o)return e;switch(e){case"%s":return String(t[i++]);case"%d":return Number(t[i++]);case"%j":try{return JSON.stringify(t[i++])}catch(r){return"[Circular]"}break;default:return e}})),c=t[i];i<o;c=t[++i])s+=" "+c;return s}return n}function u(e){return"string"===e||"url"===e||"hex"===e||"email"===e||"pattern"===e}function d(e,t){return void 0===e||null===e||(!("array"!==t||!Array.isArray(e)||e.length)||!(!u(t)||"string"!==typeof e||e))}function h(e,t,r){var i=[],n=0,o=e.length;function s(e){i.push.apply(i,e),n++,n===o&&r(i)}e.forEach((function(e){t(e,s)}))}function p(e,t,r){var i=0,n=e.length;function o(s){if(s&&s.length)r(s);else{var a=i;i+=1,a<n?t(e[a],o):r([])}}o([])}function f(e){var t=[];return Object.keys(e).forEach((function(r){t.push.apply(t,e[r])})),t}function g(e,t,r,i){if(t.first){var n=f(e);return p(n,r,i)}var o=t.firstFields||[];!0===o&&(o=Object.keys(e));var s=Object.keys(e),a=s.length,c=0,l=[],u=function(e){l.push.apply(l,e),c++,c===a&&i(l)};s.forEach((function(t){var i=e[t];-1!==o.indexOf(t)?p(i,r,u):h(i,r,u)}))}function m(e){return function(t){return t&&t.message?(t.field=t.field||e.fullField,t):{message:t,field:t.field||e.fullField}}}function _(e,t){if(t)for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];"object"===("undefined"===typeof i?"undefined":s()(i))&&"object"===s()(e[r])?e[r]=n()({},e[r],i):e[r]=i}return e}function v(e,t,r,i,n,o){!e.required||r.hasOwnProperty(e.field)&&!d(t,o||e.type)||i.push(l(n.messages.required,e.fullField))}var E=v;function A(e,t,r,i,n){(/^\s+$/.test(t)||""===t)&&i.push(l(n.messages.whitespace,e.fullField))}var y=A,S={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,url:new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://|//)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i"),hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},C={integer:function(e){return C.number(e)&&parseInt(e,10)===e},float:function(e){return C.number(e)&&!C.integer(e)},array:function(e){return Array.isArray(e)},regexp:function(e){if(e instanceof RegExp)return!0;try{return!!new RegExp(e)}catch(t){return!1}},date:function(e){return"function"===typeof e.getTime&&"function"===typeof e.getMonth&&"function"===typeof e.getYear},number:function(e){return!isNaN(e)&&"number"===typeof e},object:function(e){return"object"===("undefined"===typeof e?"undefined":s()(e))&&!C.array(e)},method:function(e){return"function"===typeof e},email:function(e){return"string"===typeof e&&!!e.match(S.email)&&e.length<255},url:function(e){return"string"===typeof e&&!!e.match(S.url)},hex:function(e){return"string"===typeof e&&!!e.match(S.hex)}};function T(e,t,r,i,n){if(e.required&&void 0===t)E(e,t,r,i,n);else{var o=["integer","float","array","regexp","object","method","email","number","date","url","hex"],a=e.type;o.indexOf(a)>-1?C[a](t)||i.push(l(n.messages.types[a],e.fullField,e.type)):a&&("undefined"===typeof t?"undefined":s()(t))!==e.type&&i.push(l(n.messages.types[a],e.fullField,e.type))}}var b=T;function I(e,t,r,i,n){var o="number"===typeof e.len,s="number"===typeof e.min,a="number"===typeof e.max,c=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,u=t,d=null,h="number"===typeof t,p="string"===typeof t,f=Array.isArray(t);if(h?d="number":p?d="string":f&&(d="array"),!d)return!1;f&&(u=t.length),p&&(u=t.replace(c,"_").length),o?u!==e.len&&i.push(l(n.messages[d].len,e.fullField,e.len)):s&&!a&&u<e.min?i.push(l(n.messages[d].min,e.fullField,e.min)):a&&!s&&u>e.max?i.push(l(n.messages[d].max,e.fullField,e.max)):s&&a&&(u<e.min||u>e.max)&&i.push(l(n.messages[d].range,e.fullField,e.min,e.max))}var R=I,w="enum";function k(e,t,r,i,n){e[w]=Array.isArray(e[w])?e[w]:[],-1===e[w].indexOf(t)&&i.push(l(n.messages[w],e.fullField,e[w].join(", ")))}var O=k;function N(e,t,r,i,n){if(e.pattern)if(e.pattern instanceof RegExp)e.pattern.lastIndex=0,e.pattern.test(t)||i.push(l(n.messages.pattern.mismatch,e.fullField,t,e.pattern));else if("string"===typeof e.pattern){var o=new RegExp(e.pattern);o.test(t)||i.push(l(n.messages.pattern.mismatch,e.fullField,t,e.pattern))}}var L=N,P={required:E,whitespace:y,type:b,range:R,enum:O,pattern:L};function D(e,t,r,i,n){var o=[],s=e.required||!e.required&&i.hasOwnProperty(e.field);if(s){if(d(t,"string")&&!e.required)return r();P.required(e,t,i,o,n,"string"),d(t,"string")||(P.type(e,t,i,o,n),P.range(e,t,i,o,n),P.pattern(e,t,i,o,n),!0===e.whitespace&&P.whitespace(e,t,i,o,n))}r(o)}var M=D;function x(e,t,r,i,n){var o=[],s=e.required||!e.required&&i.hasOwnProperty(e.field);if(s){if(d(t)&&!e.required)return r();P.required(e,t,i,o,n),void 0!==t&&P.type(e,t,i,o,n)}r(o)}var B=x;function U(e,t,r,i,n){var o=[],s=e.required||!e.required&&i.hasOwnProperty(e.field);if(s){if(d(t)&&!e.required)return r();P.required(e,t,i,o,n),void 0!==t&&(P.type(e,t,i,o,n),P.range(e,t,i,o,n))}r(o)}var F=U;function V(e,t,r,i,n){var o=[],s=e.required||!e.required&&i.hasOwnProperty(e.field);if(s){if(d(t)&&!e.required)return r();P.required(e,t,i,o,n),void 0!==t&&P.type(e,t,i,o,n)}r(o)}var j=V;function G(e,t,r,i,n){var o=[],s=e.required||!e.required&&i.hasOwnProperty(e.field);if(s){if(d(t)&&!e.required)return r();P.required(e,t,i,o,n),d(t)||P.type(e,t,i,o,n)}r(o)}var H=G;function Q(e,t,r,i,n){var o=[],s=e.required||!e.required&&i.hasOwnProperty(e.field);if(s){if(d(t)&&!e.required)return r();P.required(e,t,i,o,n),void 0!==t&&(P.type(e,t,i,o,n),P.range(e,t,i,o,n))}r(o)}var W=Q;function q(e,t,r,i,n){var o=[],s=e.required||!e.required&&i.hasOwnProperty(e.field);if(s){if(d(t)&&!e.required)return r();P.required(e,t,i,o,n),void 0!==t&&(P.type(e,t,i,o,n),P.range(e,t,i,o,n))}r(o)}var z=q;function Z(e,t,r,i,n){var o=[],s=e.required||!e.required&&i.hasOwnProperty(e.field);if(s){if(d(t,"array")&&!e.required)return r();P.required(e,t,i,o,n,"array"),d(t,"array")||(P.type(e,t,i,o,n),P.range(e,t,i,o,n))}r(o)}var Y=Z;function K(e,t,r,i,n){var o=[],s=e.required||!e.required&&i.hasOwnProperty(e.field);if(s){if(d(t)&&!e.required)return r();P.required(e,t,i,o,n),void 0!==t&&P.type(e,t,i,o,n)}r(o)}var $=K,J="enum";function X(e,t,r,i,n){var o=[],s=e.required||!e.required&&i.hasOwnProperty(e.field);if(s){if(d(t)&&!e.required)return r();P.required(e,t,i,o,n),t&&P[J](e,t,i,o,n)}r(o)}var ee=X;function te(e,t,r,i,n){var o=[],s=e.required||!e.required&&i.hasOwnProperty(e.field);if(s){if(d(t,"string")&&!e.required)return r();P.required(e,t,i,o,n),d(t,"string")||P.pattern(e,t,i,o,n)}r(o)}var re=te;function ie(e,t,r,i,n){var o=[],s=e.required||!e.required&&i.hasOwnProperty(e.field);if(s){if(d(t)&&!e.required)return r();if(P.required(e,t,i,o,n),!d(t)){var a=void 0;a="number"===typeof t?new Date(t):t,P.type(e,a,i,o,n),a&&P.range(e,a.getTime(),i,o,n)}}r(o)}var ne=ie;function oe(e,t,r,i,n){var o=[],a=Array.isArray(t)?"array":"undefined"===typeof t?"undefined":s()(t);P.required(e,t,i,o,n,a),r(o)}var se=oe;function ae(e,t,r,i,n){var o=e.type,s=[],a=e.required||!e.required&&i.hasOwnProperty(e.field);if(a){if(d(t,o)&&!e.required)return r();P.required(e,t,i,s,n,o),d(t,o)||P.type(e,t,i,s,n)}r(s)}var ce=ae,le={string:M,method:B,number:F,boolean:j,regexp:H,integer:W,float:z,array:Y,object:$,enum:ee,pattern:re,date:ne,url:ce,hex:ce,email:ce,required:se};function ue(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var e=JSON.parse(JSON.stringify(this));return e.clone=this.clone,e}}}var de=ue();function he(e){this.rules=null,this._messages=de,this.define(e)}he.prototype={messages:function(e){return e&&(this._messages=_(ue(),e)),this._messages},define:function(e){if(!e)throw new Error("Cannot configure a schema with no rules");if("object"!==("undefined"===typeof e?"undefined":s()(e))||Array.isArray(e))throw new Error("Rules must be an object");this.rules={};var t=void 0,r=void 0;for(t in e)e.hasOwnProperty(t)&&(r=e[t],this.rules[t]=Array.isArray(r)?r:[r])},validate:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments[2],o=e,a=r,u=i;if("function"===typeof a&&(u=a,a={}),this.rules&&0!==Object.keys(this.rules).length){if(a.messages){var d=this.messages();d===de&&(d=ue()),_(d,a.messages),a.messages=d}else a.messages=this.messages();var h=void 0,p=void 0,f={},v=a.keys||Object.keys(this.rules);v.forEach((function(r){h=t.rules[r],p=o[r],h.forEach((function(i){var s=i;"function"===typeof s.transform&&(o===e&&(o=n()({},o)),p=o[r]=s.transform(p)),s="function"===typeof s?{validator:s}:n()({},s),s.validator=t.getValidationMethod(s),s.field=r,s.fullField=s.fullField||r,s.type=t.getType(s),s.validator&&(f[r]=f[r]||[],f[r].push({rule:s,value:p,source:o,field:r}))}))}));var E={};g(f,a,(function(e,t){var r=e.rule,i=("object"===r.type||"array"===r.type)&&("object"===s()(r.fields)||"object"===s()(r.defaultField));function o(e,t){return n()({},t,{fullField:r.fullField+"."+e})}function u(){var s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],u=s;if(Array.isArray(u)||(u=[u]),u.length&&c("async-validator:",u),u.length&&r.message&&(u=[].concat(r.message)),u=u.map(m(r)),a.first&&u.length)return E[r.field]=1,t(u);if(i){if(r.required&&!e.value)return u=r.message?[].concat(r.message).map(m(r)):a.error?[a.error(r,l(a.messages.required,r.field))]:[],t(u);var d={};if(r.defaultField)for(var h in e.value)e.value.hasOwnProperty(h)&&(d[h]=r.defaultField);for(var p in d=n()({},d,e.rule.fields),d)if(d.hasOwnProperty(p)){var f=Array.isArray(d[p])?d[p]:[d[p]];d[p]=f.map(o.bind(null,p))}var g=new he(d);g.messages(a.messages),e.rule.options&&(e.rule.options.messages=a.messages,e.rule.options.error=a.error),g.validate(e.value,e.rule.options||a,(function(e){t(e&&e.length?u.concat(e):e)}))}else t(u)}i=i&&(r.required||!r.required&&e.value),r.field=e.field;var d=r.validator(r,e.value,u,e.source,a);d&&d.then&&d.then((function(){return u()}),(function(e){return u(e)}))}),(function(e){A(e)}))}else u&&u();function A(e){var t=void 0,r=void 0,i=[],n={};function o(e){Array.isArray(e)?i=i.concat.apply(i,e):i.push(e)}for(t=0;t<e.length;t++)o(e[t]);if(i.length)for(t=0;t<i.length;t++)r=i[t].field,n[r]=n[r]||[],n[r].push(i[t]);else i=null,n=null;u(i,n)}},getType:function(e){if(void 0===e.type&&e.pattern instanceof RegExp&&(e.type="pattern"),"function"!==typeof e.validator&&e.type&&!le.hasOwnProperty(e.type))throw new Error(l("Unknown rule type %s",e.type));return e.type||"string"},getValidationMethod:function(e){if("function"===typeof e.validator)return e.validator;var t=Object.keys(e),r=t.indexOf("message");return-1!==r&&t.splice(r,1),1===t.length&&"required"===t[0]?le.required:le[this.getType(e)]||!1}},he.register=function(e,t){if("function"!==typeof t)throw new Error("Cannot register a validator by type, validator is not a function");le[e]=t},he.messages=de;t["default"]=he},a3de:function(e,t,r){"use strict";var i=!("undefined"===typeof window||!window.document||!window.document.createElement),n={canUseDOM:i,canUseWorkers:"undefined"!==typeof Worker,canUseEventListeners:i&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:i&&!!window.screen,isInWorker:!i};e.exports=n},a434:function(e,t,r){"use strict";var i=r("23e7"),n=r("da84"),o=r("23cb"),s=r("5926"),a=r("07fa"),c=r("7b0b"),l=r("65f0"),u=r("8418"),d=r("1dde"),h=d("splice"),p=n.TypeError,f=Math.max,g=Math.min,m=9007199254740991,_="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!h},{splice:function(e,t){var r,i,n,d,h,v,E=c(this),A=a(E),y=o(e,A),S=arguments.length;if(0===S?r=i=0:1===S?(r=0,i=A-y):(r=S-2,i=g(f(s(t),0),A-y)),A+r-i>m)throw p(_);for(n=l(E,i),d=0;d<i;d++)h=y+d,h in E&&u(n,d,E[h]);if(n.length=i,r<i){for(d=y;d<A-i;d++)h=d+i,v=d+r,h in E?E[v]=E[h]:delete E[v];for(d=A;d>A-i+r;d--)delete E[d-1]}else if(r>i)for(d=A-i;d>y;d--)h=d+i-1,v=d+r-1,h in E?E[v]=E[h]:delete E[v];for(d=0;d<r;d++)E[d+y]=arguments[d+2];return E.length=A-i+r,n}})},a4b4:function(e,t,r){var i=r("342f");e.exports=/web0s(?!.*chrome)/i.test(i)},a4d3:function(e,t,r){"use strict";var i=r("23e7"),n=r("da84"),o=r("d066"),s=r("2ba4"),a=r("c65b"),c=r("e330"),l=r("c430"),u=r("83ab"),d=r("4930"),h=r("d039"),p=r("1a2d"),f=r("e8b5"),g=r("1626"),m=r("861d"),_=r("3a9b"),v=r("d9b5"),E=r("825a"),A=r("7b0b"),y=r("fc6a"),S=r("a04b"),C=r("577e"),T=r("5c6c"),b=r("7c73"),I=r("df75"),R=r("241c"),w=r("057f"),k=r("7418"),O=r("06cf"),N=r("9bf2"),L=r("37e8"),P=r("d1e7"),D=r("f36a"),M=r("6eeb"),x=r("5692"),B=r("f772"),U=r("d012"),F=r("90e3"),V=r("b622"),j=r("e538"),G=r("746f"),H=r("d44e"),Q=r("69f3"),W=r("b727").forEach,q=B("hidden"),z="Symbol",Z="prototype",Y=V("toPrimitive"),K=Q.set,$=Q.getterFor(z),J=Object[Z],X=n.Symbol,ee=X&&X[Z],te=n.TypeError,re=n.QObject,ie=o("JSON","stringify"),ne=O.f,oe=N.f,se=w.f,ae=P.f,ce=c([].push),le=x("symbols"),ue=x("op-symbols"),de=x("string-to-symbol-registry"),he=x("symbol-to-string-registry"),pe=x("wks"),fe=!re||!re[Z]||!re[Z].findChild,ge=u&&h((function(){return 7!=b(oe({},"a",{get:function(){return oe(this,"a",{value:7}).a}})).a}))?function(e,t,r){var i=ne(J,t);i&&delete J[t],oe(e,t,r),i&&e!==J&&oe(J,t,i)}:oe,me=function(e,t){var r=le[e]=b(ee);return K(r,{type:z,tag:e,description:t}),u||(r.description=t),r},_e=function(e,t,r){e===J&&_e(ue,t,r),E(e);var i=S(t);return E(r),p(le,i)?(r.enumerable?(p(e,q)&&e[q][i]&&(e[q][i]=!1),r=b(r,{enumerable:T(0,!1)})):(p(e,q)||oe(e,q,T(1,{})),e[q][i]=!0),ge(e,i,r)):oe(e,i,r)},ve=function(e,t){E(e);var r=y(t),i=I(r).concat(Ce(r));return W(i,(function(t){u&&!a(Ae,r,t)||_e(e,t,r[t])})),e},Ee=function(e,t){return void 0===t?b(e):ve(b(e),t)},Ae=function(e){var t=S(e),r=a(ae,this,t);return!(this===J&&p(le,t)&&!p(ue,t))&&(!(r||!p(this,t)||!p(le,t)||p(this,q)&&this[q][t])||r)},ye=function(e,t){var r=y(e),i=S(t);if(r!==J||!p(le,i)||p(ue,i)){var n=ne(r,i);return!n||!p(le,i)||p(r,q)&&r[q][i]||(n.enumerable=!0),n}},Se=function(e){var t=se(y(e)),r=[];return W(t,(function(e){p(le,e)||p(U,e)||ce(r,e)})),r},Ce=function(e){var t=e===J,r=se(t?ue:y(e)),i=[];return W(r,(function(e){!p(le,e)||t&&!p(J,e)||ce(i,le[e])})),i};if(d||(X=function(){if(_(ee,this))throw te("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?C(arguments[0]):void 0,t=F(e),r=function(e){this===J&&a(r,ue,e),p(this,q)&&p(this[q],t)&&(this[q][t]=!1),ge(this,t,T(1,e))};return u&&fe&&ge(J,t,{configurable:!0,set:r}),me(t,e)},ee=X[Z],M(ee,"toString",(function(){return $(this).tag})),M(X,"withoutSetter",(function(e){return me(F(e),e)})),P.f=Ae,N.f=_e,L.f=ve,O.f=ye,R.f=w.f=Se,k.f=Ce,j.f=function(e){return me(V(e),e)},u&&(oe(ee,"description",{configurable:!0,get:function(){return $(this).description}}),l||M(J,"propertyIsEnumerable",Ae,{unsafe:!0}))),i({global:!0,wrap:!0,forced:!d,sham:!d},{Symbol:X}),W(I(pe),(function(e){G(e)})),i({target:z,stat:!0,forced:!d},{for:function(e){var t=C(e);if(p(de,t))return de[t];var r=X(t);return de[t]=r,he[r]=t,r},keyFor:function(e){if(!v(e))throw te(e+" is not a symbol");if(p(he,e))return he[e]},useSetter:function(){fe=!0},useSimple:function(){fe=!1}}),i({target:"Object",stat:!0,forced:!d,sham:!u},{create:Ee,defineProperty:_e,defineProperties:ve,getOwnPropertyDescriptor:ye}),i({target:"Object",stat:!0,forced:!d},{getOwnPropertyNames:Se,getOwnPropertySymbols:Ce}),i({target:"Object",stat:!0,forced:h((function(){k.f(1)}))},{getOwnPropertySymbols:function(e){return k.f(A(e))}}),ie){var Te=!d||h((function(){var e=X();return"[null]"!=ie([e])||"{}"!=ie({a:e})||"{}"!=ie(Object(e))}));i({target:"JSON",stat:!0,forced:Te},{stringify:function(e,t,r){var i=D(arguments),n=t;if((m(t)||void 0!==e)&&!v(e))return f(t)||(t=function(e,t){if(g(n)&&(t=a(n,this,e,t)),!v(t))return t}),i[1]=t,s(ie,null,i)}})}if(!ee[Y]){var be=ee.valueOf;M(ee,Y,(function(e){return a(be,this)}))}H(X,z),U[q]=!0},a640:function(e,t,r){"use strict";var i=r("d039");e.exports=function(e,t){var r=[][e];return!!r&&i((function(){r.call(null,t||function(){throw 1},1)}))}},a742:function(e,t,r){"use strict";t.__esModule=!0,t.isDefined=t.isUndefined=t.isFunction=void 0;var i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.isString=a,t.isObject=c,t.isHtmlElement=l;var n=r("2b0e"),o=s(n);function s(e){return e&&e.__esModule?e:{default:e}}function a(e){return"[object String]"===Object.prototype.toString.call(e)}function c(e){return"[object Object]"===Object.prototype.toString.call(e)}function l(e){return e&&e.nodeType===Node.ELEMENT_NODE}var u=function(e){var t={};return e&&"[object Function]"===t.toString.call(e)};"object"===("undefined"===typeof Int8Array?"undefined":i(Int8Array))||!o.default.prototype.$isServer&&"function"===typeof document.childNodes||(t.isFunction=u=function(e){return"function"===typeof e||!1}),t.isFunction=u;t.isUndefined=function(e){return void 0===e},t.isDefined=function(e){return void 0!==e&&null!==e}},a79d:function(e,t,r){"use strict";var i=r("23e7"),n=r("c430"),o=r("fea9"),s=r("d039"),a=r("d066"),c=r("1626"),l=r("4840"),u=r("cdf9"),d=r("6eeb"),h=!!o&&s((function(){o.prototype["finally"].call({then:function(){}},(function(){}))}));if(i({target:"Promise",proto:!0,real:!0,forced:h},{finally:function(e){var t=l(this,a("Promise")),r=c(e);return this.then(r?function(r){return u(t,e()).then((function(){return r}))}:e,r?function(r){return u(t,e()).then((function(){throw r}))}:e)}}),!n&&c(o)){var p=a("Promise").prototype["finally"];o.prototype["finally"]!==p&&d(o.prototype,"finally",p,{unsafe:!0})}},a975:function(e,t,r){"use strict";var i=r("ebb5"),n=r("b727").every,o=i.aTypedArray,s=i.exportTypedArrayMethod;s("every",(function(e){return n(o(this),e,arguments.length>1?arguments[1]:void 0)}))},a981:function(e,t){e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},a9e3:function(e,t,r){"use strict";var i=r("83ab"),n=r("da84"),o=r("e330"),s=r("94ca"),a=r("6eeb"),c=r("1a2d"),l=r("7156"),u=r("3a9b"),d=r("d9b5"),h=r("c04e"),p=r("d039"),f=r("241c").f,g=r("06cf").f,m=r("9bf2").f,_=r("408a"),v=r("58a8").trim,E="Number",A=n[E],y=A.prototype,S=n.TypeError,C=o("".slice),T=o("".charCodeAt),b=function(e){var t=h(e,"number");return"bigint"==typeof t?t:I(t)},I=function(e){var t,r,i,n,o,s,a,c,l=h(e,"number");if(d(l))throw S("Cannot convert a Symbol value to a number");if("string"==typeof l&&l.length>2)if(l=v(l),t=T(l,0),43===t||45===t){if(r=T(l,2),88===r||120===r)return NaN}else if(48===t){switch(T(l,1)){case 66:case 98:i=2,n=49;break;case 79:case 111:i=8,n=55;break;default:return+l}for(o=C(l,2),s=o.length,a=0;a<s;a++)if(c=T(o,a),c<48||c>n)return NaN;return parseInt(o,i)}return+l};if(s(E,!A(" 0o1")||!A("0b1")||A("+0x1"))){for(var R,w=function(e){var t=arguments.length<1?0:A(b(e)),r=this;return u(y,r)&&p((function(){_(r)}))?l(Object(t),r,w):t},k=i?f(A):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),O=0;k.length>O;O++)c(A,R=k[O])&&!c(w,R)&&m(w,R,g(A,R));w.prototype=y,y.constructor=w,a(n,E,w)}},ab13:function(e,t,r){var i=r("b622"),n=i("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[n]=!1,"/./"[e](t)}catch(i){}}return!1}},ab36:function(e,t,r){var i=r("861d"),n=r("9112");e.exports=function(e,t){i(t)&&"cause"in t&&n(e,"cause",t.cause)}},ac1f:function(e,t,r){"use strict";var i=r("23e7"),n=r("9263");i({target:"RegExp",proto:!0,forced:/./.exec!==n},{exec:n})},ad6d:function(e,t,r){"use strict";var i=r("825a");e.exports=function(){var e=i(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},addb:function(e,t,r){var i=r("4dae"),n=Math.floor,o=function(e,t){var r=e.length,c=n(r/2);return r<8?s(e,t):a(e,o(i(e,0,c),t),o(i(e,c),t),t)},s=function(e,t){var r,i,n=e.length,o=1;while(o<n){i=o,r=e[o];while(i&&t(e[i-1],r)>0)e[i]=e[--i];i!==o++&&(e[i]=r)}return e},a=function(e,t,r,i){var n=t.length,o=r.length,s=0,a=0;while(s<n||a<o)e[s+a]=s<n&&a<o?i(t[s],r[a])<=0?t[s++]:r[a++]:s<n?t[s++]:r[a++];return e};e.exports=o},ae93:function(e,t,r){"use strict";var i,n,o,s=r("d039"),a=r("1626"),c=r("7c73"),l=r("e163"),u=r("6eeb"),d=r("b622"),h=r("c430"),p=d("iterator"),f=!1;[].keys&&(o=[].keys(),"next"in o?(n=l(l(o)),n!==Object.prototype&&(i=n)):f=!0);var g=void 0==i||s((function(){var e={};return i[p].call(e)!==e}));g?i={}:h&&(i=c(i)),a(i[p])||u(i,p,(function(){return this})),e.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:f}},aed9:function(e,t,r){var i=r("83ab"),n=r("d039");e.exports=i&&n((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},b041:function(e,t,r){"use strict";var i=r("00ee"),n=r("f5df");e.exports=i?{}.toString:function(){return"[object "+n(this)+"]"}},b0c0:function(e,t,r){var i=r("83ab"),n=r("5e77").EXISTS,o=r("e330"),s=r("9bf2").f,a=Function.prototype,c=o(a.toString),l=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,u=o(l.exec),d="name";i&&!n&&s(a,d,{configurable:!0,get:function(){try{return u(l,c(this))[1]}catch(e){return""}}})},b367:function(e,t,r){var i=r("5524"),n=r("ef08"),o="__core-js_shared__",s=n[o]||(n[o]={});(e.exports=function(e,t){return s[e]||(s[e]=void 0!==t?t:{})})("versions",[]).push({version:i.version,mode:r("e444")?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},b39a:function(e,t,r){"use strict";var i=r("da84"),n=r("2ba4"),o=r("ebb5"),s=r("d039"),a=r("f36a"),c=i.Int8Array,l=o.aTypedArray,u=o.exportTypedArrayMethod,d=[].toLocaleString,h=!!c&&s((function(){d.call(new c(1))})),p=s((function(){return[1,2].toLocaleString()!=new c([1,2]).toLocaleString()}))||!s((function(){c.prototype.toLocaleString.call([1,2])}));u("toLocaleString",(function(){return n(d,h?a(l(this)):l(this),a(arguments))}),p)},b50d:function(e,t,r){"use strict";var i=r("c532"),n=r("467f"),o=r("7aac"),s=r("30b5"),a=r("83b9"),c=r("c345"),l=r("3934"),u=r("2d83"),d=r("2444"),h=r("7a77");e.exports=function(e){return new Promise((function(t,r){var p,f=e.data,g=e.headers,m=e.responseType;function _(){e.cancelToken&&e.cancelToken.unsubscribe(p),e.signal&&e.signal.removeEventListener("abort",p)}i.isFormData(f)&&delete g["Content-Type"];var v=new XMLHttpRequest;if(e.auth){var E=e.auth.username||"",A=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";g.Authorization="Basic "+btoa(E+":"+A)}var y=a(e.baseURL,e.url);function S(){if(v){var i="getAllResponseHeaders"in v?c(v.getAllResponseHeaders()):null,o=m&&"text"!==m&&"json"!==m?v.response:v.responseText,s={data:o,status:v.status,statusText:v.statusText,headers:i,config:e,request:v};n((function(e){t(e),_()}),(function(e){r(e),_()}),s),v=null}}if(v.open(e.method.toUpperCase(),s(y,e.params,e.paramsSerializer),!0),v.timeout=e.timeout,"onloadend"in v?v.onloadend=S:v.onreadystatechange=function(){v&&4===v.readyState&&(0!==v.status||v.responseURL&&0===v.responseURL.indexOf("file:"))&&setTimeout(S)},v.onabort=function(){v&&(r(u("Request aborted",e,"ECONNABORTED",v)),v=null)},v.onerror=function(){r(u("Network Error",e,null,v)),v=null},v.ontimeout=function(){var t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",i=e.transitional||d.transitional;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),r(u(t,e,i.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",v)),v=null},i.isStandardBrowserEnv()){var C=(e.withCredentials||l(y))&&e.xsrfCookieName?o.read(e.xsrfCookieName):void 0;C&&(g[e.xsrfHeaderName]=C)}"setRequestHeader"in v&&i.forEach(g,(function(e,t){"undefined"===typeof f&&"content-type"===t.toLowerCase()?delete g[t]:v.setRequestHeader(t,e)})),i.isUndefined(e.withCredentials)||(v.withCredentials=!!e.withCredentials),m&&"json"!==m&&(v.responseType=e.responseType),"function"===typeof e.onDownloadProgress&&v.addEventListener("progress",e.onDownloadProgress),"function"===typeof e.onUploadProgress&&v.upload&&v.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(p=function(e){v&&(r(!e||e&&e.type?new h("canceled"):e),v.abort(),v=null)},e.cancelToken&&e.cancelToken.subscribe(p),e.signal&&(e.signal.aborted?p():e.signal.addEventListener("abort",p))),f||(f=null),v.send(f)}))}},b575:function(e,t,r){var i,n,o,s,a,c,l,u,d=r("da84"),h=r("0366"),p=r("06cf").f,f=r("2cf4").set,g=r("1cdc"),m=r("d4c3"),_=r("a4b4"),v=r("605d"),E=d.MutationObserver||d.WebKitMutationObserver,A=d.document,y=d.process,S=d.Promise,C=p(d,"queueMicrotask"),T=C&&C.value;T||(i=function(){var e,t;v&&(e=y.domain)&&e.exit();while(n){t=n.fn,n=n.next;try{t()}catch(r){throw n?s():o=void 0,r}}o=void 0,e&&e.enter()},g||v||_||!E||!A?!m&&S&&S.resolve?(l=S.resolve(void 0),l.constructor=S,u=h(l.then,l),s=function(){u(i)}):v?s=function(){y.nextTick(i)}:(f=h(f,d),s=function(){f(i)}):(a=!0,c=A.createTextNode(""),new E(i).observe(c,{characterData:!0}),s=function(){c.data=a=!a})),e.exports=T||function(e){var t={fn:e,next:void 0};o&&(o.next=t),n||(n=t,s()),o=t}},b622:function(e,t,r){var i=r("da84"),n=r("5692"),o=r("1a2d"),s=r("90e3"),a=r("4930"),c=r("fdbf"),l=n("wks"),u=i.Symbol,d=u&&u["for"],h=c?u:u&&u.withoutSetter||s;e.exports=function(e){if(!o(l,e)||!a&&"string"!=typeof l[e]){var t="Symbol."+e;a&&o(u,e)?l[e]=u[e]:l[e]=c&&d?d(t):h(t)}return l[e]}},b64b:function(e,t,r){var i=r("23e7"),n=r("7b0b"),o=r("df75"),s=r("d039"),a=s((function(){o(1)}));i({target:"Object",stat:!0,forced:a},{keys:function(e){return o(n(e))}})},b6b7:function(e,t,r){var i=r("ebb5"),n=r("4840"),o=i.TYPED_ARRAY_CONSTRUCTOR,s=i.aTypedArrayConstructor;e.exports=function(e){return s(n(e,e[o]))}},b727:function(e,t,r){var i=r("0366"),n=r("e330"),o=r("44ad"),s=r("7b0b"),a=r("07fa"),c=r("65f0"),l=n([].push),u=function(e){var t=1==e,r=2==e,n=3==e,u=4==e,d=6==e,h=7==e,p=5==e||d;return function(f,g,m,_){for(var v,E,A=s(f),y=o(A),S=i(g,m),C=a(y),T=0,b=_||c,I=t?b(f,C):r||h?b(f,0):void 0;C>T;T++)if((p||T in y)&&(v=y[T],E=S(v,T,A),e))if(t)I[T]=E;else if(E)switch(e){case 3:return!0;case 5:return v;case 6:return T;case 2:l(I,v)}else switch(e){case 4:return!1;case 7:l(I,v)}return d?-1:n||u?u:I}};e.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterReject:u(7)}},b980:function(e,t,r){var i=r("d039"),n=r("5c6c");e.exports=!i((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",n(1,7)),7!==e.stack)}))},b9c7:function(e,t,r){r("e507"),e.exports=r("5524").Object.assign},ba01:function(e,t,r){e.exports=r("051b")},bb2f:function(e,t,r){var i=r("d039");e.exports=!i((function(){return Object.isExtensible(Object.preventExtensions({}))}))},bc3a:function(e,t,r){e.exports=r("cee4")},bee2:function(e,t,r){"use strict";function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}r.d(t,"a",(function(){return n}))},bf19:function(e,t,r){"use strict";var i=r("23e7"),n=r("c65b");i({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return n(URL.prototype.toString,this)}})},c04e:function(e,t,r){var i=r("da84"),n=r("c65b"),o=r("861d"),s=r("d9b5"),a=r("dc4a"),c=r("485a"),l=r("b622"),u=i.TypeError,d=l("toPrimitive");e.exports=function(e,t){if(!o(e)||s(e))return e;var r,i=a(e,d);if(i){if(void 0===t&&(t="default"),r=n(i,e,t),!o(r)||s(r))return r;throw u("Can't convert object to primitive value")}return void 0===t&&(t="number"),c(e,t)}},c098:function(e,t,r){e.exports=r("d4af")},c19f:function(e,t,r){"use strict";var i=r("23e7"),n=r("da84"),o=r("621a"),s=r("2626"),a="ArrayBuffer",c=o[a],l=n[a];i({global:!0,forced:l!==c},{ArrayBuffer:c}),s(a)},c1ac:function(e,t,r){"use strict";var i=r("ebb5"),n=r("b727").filter,o=r("1448"),s=i.aTypedArray,a=i.exportTypedArrayMethod;a("filter",(function(e){var t=n(s(this),e,arguments.length>1?arguments[1]:void 0);return o(this,t)}))},c284:function(e,t,r){e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=90)}({0:function(e,t,r){"use strict";function i(e,t,r,i,n,o,s,a){var c,l="function"===typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=r,l._compiled=!0),i&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),s?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},l._ssrRegister=c):n&&(c=a?function(){n.call(this,this.$root.$options.shadowRoot)}:n),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(e,t){return c.call(t),u(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,c):[c]}return{exports:e,options:l}}r.d(t,"a",(function(){return i}))},90:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-progress",class:["el-progress--"+e.type,e.status?"is-"+e.status:"",{"el-progress--without-text":!e.showText,"el-progress--text-inside":e.textInside}],attrs:{role:"progressbar","aria-valuenow":e.percentage,"aria-valuemin":"0","aria-valuemax":"100"}},["line"===e.type?r("div",{staticClass:"el-progress-bar"},[r("div",{staticClass:"el-progress-bar__outer",style:{height:e.strokeWidth+"px"}},[r("div",{staticClass:"el-progress-bar__inner",style:e.barStyle},[e.showText&&e.textInside?r("div",{staticClass:"el-progress-bar__innerText"},[e._v(e._s(e.content))]):e._e()])])]):r("div",{staticClass:"el-progress-circle",style:{height:e.width+"px",width:e.width+"px"}},[r("svg",{attrs:{viewBox:"0 0 100 100"}},[r("path",{staticClass:"el-progress-circle__track",style:e.trailPathStyle,attrs:{d:e.trackPath,stroke:"#e5e9f2","stroke-width":e.relativeStrokeWidth,fill:"none"}}),r("path",{staticClass:"el-progress-circle__path",style:e.circlePathStyle,attrs:{d:e.trackPath,stroke:e.stroke,fill:"none","stroke-linecap":e.strokeLinecap,"stroke-width":e.percentage?e.relativeStrokeWidth:0}})])]),e.showText&&!e.textInside?r("div",{staticClass:"el-progress__text",style:{fontSize:e.progressTextSize+"px"}},[e.status?r("i",{class:e.iconClass}):[e._v(e._s(e.content))]],2):e._e()])},n=[];i._withStripped=!0;var o={name:"ElProgress",props:{type:{type:String,default:"line",validator:function(e){return["line","circle","dashboard"].indexOf(e)>-1}},percentage:{type:Number,default:0,required:!0,validator:function(e){return e>=0&&e<=100}},status:{type:String,validator:function(e){return["success","exception","warning"].indexOf(e)>-1}},strokeWidth:{type:Number,default:6},strokeLinecap:{type:String,default:"round"},textInside:{type:Boolean,default:!1},width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:[String,Array,Function],default:""},format:Function},computed:{barStyle:function(){var e={};return e.width=this.percentage+"%",e.backgroundColor=this.getCurrentColor(this.percentage),e},relativeStrokeWidth:function(){return(this.strokeWidth/this.width*100).toFixed(1)},radius:function(){return"circle"===this.type||"dashboard"===this.type?parseInt(50-parseFloat(this.relativeStrokeWidth)/2,10):0},trackPath:function(){var e=this.radius,t="dashboard"===this.type;return"\n        M 50 50\n        m 0 "+(t?"":"-")+e+"\n        a "+e+" "+e+" 0 1 1 0 "+(t?"-":"")+2*e+"\n        a "+e+" "+e+" 0 1 1 0 "+(t?"":"-")+2*e+"\n        "},perimeter:function(){return 2*Math.PI*this.radius},rate:function(){return"dashboard"===this.type?.75:1},strokeDashoffset:function(){var e=-1*this.perimeter*(1-this.rate)/2;return e+"px"},trailPathStyle:function(){return{strokeDasharray:this.perimeter*this.rate+"px, "+this.perimeter+"px",strokeDashoffset:this.strokeDashoffset}},circlePathStyle:function(){return{strokeDasharray:this.perimeter*this.rate*(this.percentage/100)+"px, "+this.perimeter+"px",strokeDashoffset:this.strokeDashoffset,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease"}},stroke:function(){var e=void 0;if(this.color)e=this.getCurrentColor(this.percentage);else switch(this.status){case"success":e="#13ce66";break;case"exception":e="#ff4949";break;case"warning":e="#e6a23c";break;default:e="#20a0ff"}return e},iconClass:function(){return"warning"===this.status?"el-icon-warning":"line"===this.type?"success"===this.status?"el-icon-circle-check":"el-icon-circle-close":"success"===this.status?"el-icon-check":"el-icon-close"},progressTextSize:function(){return"line"===this.type?12+.4*this.strokeWidth:.111111*this.width+2},content:function(){return"function"===typeof this.format?this.format(this.percentage)||"":this.percentage+"%"}},methods:{getCurrentColor:function(e){return"function"===typeof this.color?this.color(e):"string"===typeof this.color?this.color:this.getLevelColor(e)},getLevelColor:function(e){for(var t=this.getColorArray().sort((function(e,t){return e.percentage-t.percentage})),r=0;r<t.length;r++)if(t[r].percentage>e)return t[r].color;return t[t.length-1].color},getColorArray:function(){var e=this.color,t=100/e.length;return e.map((function(e,r){return"string"===typeof e?{color:e,percentage:(r+1)*t}:e}))}}},s=o,a=r(0),c=Object(a["a"])(s,i,n,!1,null,null,null);c.options.__file="packages/progress/src/progress.vue";var l=c.exports;l.install=function(e){e.component(l.name,l)};t["default"]=l}})},c345:function(e,t,r){"use strict";var i=r("c532"),n=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,o,s={};return e?(i.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=i.trim(e.substr(0,o)).toLowerCase(),r=i.trim(e.substr(o+1)),t){if(s[t]&&n.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([r]):s[t]?s[t]+", "+r:r}})),s):s}},c401:function(e,t,r){"use strict";var i=r("c532"),n=r("2444");e.exports=function(e,t,r){var o=this||n;return i.forEach(r,(function(r){e=r.call(o,e,t)})),e}},c430:function(e,t){e.exports=!1},c532:function(e,t,r){"use strict";var i=r("1d2b"),n=Object.prototype.toString;function o(e){return"[object Array]"===n.call(e)}function s(e){return"undefined"===typeof e}function a(e){return null!==e&&!s(e)&&null!==e.constructor&&!s(e.constructor)&&"function"===typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function c(e){return"[object ArrayBuffer]"===n.call(e)}function l(e){return"undefined"!==typeof FormData&&e instanceof FormData}function u(e){var t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer,t}function d(e){return"string"===typeof e}function h(e){return"number"===typeof e}function p(e){return null!==e&&"object"===typeof e}function f(e){if("[object Object]"!==n.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function g(e){return"[object Date]"===n.call(e)}function m(e){return"[object File]"===n.call(e)}function _(e){return"[object Blob]"===n.call(e)}function v(e){return"[object Function]"===n.call(e)}function E(e){return p(e)&&v(e.pipe)}function A(e){return"undefined"!==typeof URLSearchParams&&e instanceof URLSearchParams}function y(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function S(){return("undefined"===typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!==typeof window&&"undefined"!==typeof document)}function C(e,t){if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),o(e))for(var r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.call(null,e[n],n,e)}function T(){var e={};function t(t,r){f(e[r])&&f(t)?e[r]=T(e[r],t):f(t)?e[r]=T({},t):o(t)?e[r]=t.slice():e[r]=t}for(var r=0,i=arguments.length;r<i;r++)C(arguments[r],t);return e}function b(e,t,r){return C(t,(function(t,n){e[n]=r&&"function"===typeof t?i(t,r):t})),e}function I(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}e.exports={isArray:o,isArrayBuffer:c,isBuffer:a,isFormData:l,isArrayBufferView:u,isString:d,isNumber:h,isObject:p,isPlainObject:f,isUndefined:s,isDate:g,isFile:m,isBlob:_,isFunction:v,isStream:E,isURLSearchParams:A,isStandardBrowserEnv:S,forEach:C,merge:T,extend:b,trim:y,stripBOM:I}},c56a:function(e,t,r){"use strict";t.__esModule=!0,t.default=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:300,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!e||!t)throw new Error("instance & callback is required");var n=!1,o=function(){n||(n=!0,t&&t.apply(null,arguments))};i?e.$once("after-leave",o):e.$on("after-leave",o),setTimeout((function(){o()}),r+100)}},c607:function(e,t,r){var i=r("da84"),n=r("83ab"),o=r("fce3"),s=r("c6b6"),a=r("9bf2").f,c=r("69f3").get,l=RegExp.prototype,u=i.TypeError;n&&o&&a(l,"dotAll",{configurable:!0,get:function(){if(this!==l){if("RegExp"===s(this))return!!c(this).dotAll;throw u("Incompatible receiver, RegExp required")}}})},c65b:function(e,t,r){var i=r("40d5"),n=Function.prototype.call;e.exports=i?n.bind(n):function(){return n.apply(n,arguments)}},c6b6:function(e,t,r){var i=r("e330"),n=i({}.toString),o=i("".slice);e.exports=function(e){return o(n(e),8,-1)}},c6cd:function(e,t,r){var i=r("da84"),n=r("ce4e"),o="__core-js_shared__",s=i[o]||n(o,{});e.exports=s},c770:function(e,t,r){var i=r("e330"),n=i("".replace),o=function(e){return String(Error(e).stack)}("zxcasd"),s=/\n\s*at [^:]*:[^\n]*/,a=s.test(o);e.exports=function(e,t){if(a&&"string"==typeof e)while(t--)e=n(e,s,"");return e}},c8af:function(e,t,r){"use strict";var i=r("c532");e.exports=function(e,t){i.forEach(e,(function(r,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[i])}))}},c8ba:function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(i){"object"===typeof window&&(r=window)}e.exports=r},c8d2:function(e,t,r){var i=r("5e77").PROPER,n=r("d039"),o=r("5899"),s="​᠎";e.exports=function(e){return n((function(){return!!o[e]()||s[e]()!==s||i&&o[e].name!==e}))}},c901:function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},ca84:function(e,t,r){var i=r("e330"),n=r("1a2d"),o=r("fc6a"),s=r("4d64").indexOf,a=r("d012"),c=i([].push);e.exports=function(e,t){var r,i=o(e),l=0,u=[];for(r in i)!n(a,r)&&n(i,r)&&c(u,r);while(t.length>l)n(i,r=t[l++])&&(~s(u,r)||c(u,r));return u}},ca91:function(e,t,r){"use strict";var i=r("ebb5"),n=r("d58f").left,o=i.aTypedArray,s=i.exportTypedArrayMethod;s("reduce",(function(e){var t=arguments.length;return n(o(this),e,t,t>1?arguments[1]:void 0)}))},caad:function(e,t,r){"use strict";var i=r("23e7"),n=r("4d64").includes,o=r("44d2");i({target:"Array",proto:!0},{includes:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),o("includes")},cb29:function(e,t,r){var i=r("23e7"),n=r("81d5"),o=r("44d2");i({target:"Array",proto:!0},{fill:n}),o("fill")},cc12:function(e,t,r){var i=r("da84"),n=r("861d"),o=i.document,s=n(o)&&n(o.createElement);e.exports=function(e){return s?o.createElement(e):{}}},cc15:function(e,t,r){var i=r("b367")("wks"),n=r("8b1a"),o=r("ef08").Symbol,s="function"==typeof o,a=e.exports=function(e){return i[e]||(i[e]=s&&o[e]||(s?o:n)("Symbol."+e))};a.store=i},cca6:function(e,t,r){var i=r("23e7"),n=r("60da");i({target:"Object",stat:!0,forced:Object.assign!==n},{assign:n})},cd26:function(e,t,r){"use strict";var i=r("ebb5"),n=i.aTypedArray,o=i.exportTypedArrayMethod,s=Math.floor;o("reverse",(function(){var e,t=this,r=n(t).length,i=s(r/2),o=0;while(o<i)e=t[o],t[o++]=t[--r],t[r]=e;return t}))},cdf9:function(e,t,r){var i=r("825a"),n=r("861d"),o=r("f069");e.exports=function(e,t){if(i(e),n(t)&&t.constructor===e)return t;var r=o.f(e),s=r.resolve;return s(t),r.promise}},ce4e:function(e,t,r){var i=r("da84"),n=Object.defineProperty;e.exports=function(e,t){try{n(i,e,{value:t,configurable:!0,writable:!0})}catch(r){i[e]=t}return t}},ce7a:function(e,t,r){var i=r("9c0e"),n=r("0983"),o=r("5a94")("IE_PROTO"),s=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=n(e),i(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?s:null}},cee4:function(e,t,r){"use strict";var i=r("c532"),n=r("1d2b"),o=r("0a06"),s=r("4a7b"),a=r("2444");function c(e){var t=new o(e),r=n(o.prototype.request,t);return i.extend(r,o.prototype,t),i.extend(r,t),r.create=function(t){return c(s(e,t))},r}var l=c(a);l.Axios=o,l.Cancel=r("7a77"),l.CancelToken=r("8df4"),l.isCancel=r("2e67"),l.VERSION=r("5cce").version,l.all=function(e){return Promise.all(e)},l.spread=r("0df6"),l.isAxiosError=r("5f02"),e.exports=l,e.exports.default=l},cfc3:function(e,t,r){var i=r("74e8");i("Float32",(function(e){return function(t,r,i){return e(this,t,r,i)}}))},d010:function(e,t,r){"use strict";function i(e,t,r){this.$children.forEach((function(n){var o=n.$options.componentName;o===e?n.$emit.apply(n,[t].concat(r)):i.apply(n,[e,t].concat([r]))}))}t.__esModule=!0,t.default={methods:{dispatch:function(e,t,r){var i=this.$parent||this.$root,n=i.$options.componentName;while(i&&(!n||n!==e))i=i.$parent,i&&(n=i.$options.componentName);i&&i.$emit.apply(i,[t].concat(r))},broadcast:function(e,t,r){i.call(this,e,t,r)}}}},d012:function(e,t){e.exports={}},d039:function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},d066:function(e,t,r){var i=r("da84"),n=r("1626"),o=function(e){return n(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?o(i[e]):i[e]&&i[e][t]}},d139:function(e,t,r){"use strict";var i=r("ebb5"),n=r("b727").find,o=i.aTypedArray,s=i.exportTypedArrayMethod;s("find",(function(e){return n(o(this),e,arguments.length>1?arguments[1]:void 0)}))},d16a:function(e,t,r){var i=r("fc5e"),n=Math.min;e.exports=function(e){return e>0?n(i(e),9007199254740991):0}},d1e7:function(e,t,r){"use strict";var i={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,o=n&&!i.call({1:2},1);t.f=o?function(e){var t=n(this,e);return!!t&&t.enumerable}:i},d28b:function(e,t,r){var i=r("746f");i("iterator")},d2b2:function(e,t,r){!function(t,r){e.exports=r()}("undefined"!=typeof self&&self,(function(){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=19)}([function(e,t,r){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.createZegoWebSocket=t.LoggerStateCenter=t.ZegoDataReport=t.ZegoLogger=t.MODULE_TIPS=t.LinkedList=t.ListNode=t.getReportSeq=t.getSeq=t.REPORT_ACTION=t.E_CLIENT_TYPE=t.SERVER_ERROR_CODE=t.ENUM_STREAM_UPDATE_CMD=t.MINIUM_HEARTBEAT_INTERVAL=t.ENUM_NETWORK_STATE=t.ENUM_RUN_STATE=t.MAX_MIX_TASK_ID_LENGTH=t.MAX_ROOM_ID_LENGTH=t.MAX_USER_NAME_LENGTH=t.MAX_USER_ID_LENGTH=t.MAX_STREAM_ID_LENGTH=t.MAX_TRY_HEARTBEAT_COUNT=t.SEND_MSG_TIMEOUT=t.SEND_MSG_RESET=t.MAX_TRY_CONNECT_COUNT=t.ENUM_CONNECT_STATE=t.ENUM_SCREEM_RESOLUTION_TYPE=t.ENUM_RESOLUTION_TYPE=t.ENUM_SIGNAL_STATE=t.ERROR_CODES=t.ENUM_REMOTE_TYPE=t.LOG_LEVEL=t.ENUM_LOG_LEVEL=t.ROOMVERSION=t.PROTO_VERSION=void 0,t.PROTO_VERSION="1.12.0",t.ROOMVERSION="V1",function(e){e[e.debug=0]="debug",e[e.info=1]="info",e[e.warn=2]="warn",e[e.error=3]="error",e[e.report=99]="report",e[e.disable=100]="disable"}(t.ENUM_LOG_LEVEL||(t.ENUM_LOG_LEVEL={})),t.LOG_LEVEL={debug:0,info:1,warn:2,error:3,report:99,disable:100},function(e){e[e.disable=0]="disable",e[e.websocket=1]="websocket",e[e.https=2]="https"}(t.ENUM_REMOTE_TYPE||(t.ENUM_REMOTE_TYPE={})),t.ERROR_CODES={ROOM_SESSION_ID_ERR:1000000152},function(e){e[e.disconnected=0]="disconnected",e[e.connecting=1]="connecting",e[e.connected=2]="connected"}(t.ENUM_SIGNAL_STATE||(t.ENUM_SIGNAL_STATE={})),t.ENUM_RESOLUTION_TYPE={LOW:{width:320,height:240,frameRate:15,bitRate:300},MEDIUM:{width:640,height:480,frameRate:15,bitRate:800},HIGH:{width:1280,height:720,frameRate:20,bitRate:1500}},t.ENUM_SCREEM_RESOLUTION_TYPE={LOW:{frameRate:20,bitRate:800},MEDIUM:{frameRate:15,bitRate:1200},HIGH:{frameRate:5,bitRate:2e3}},t.ENUM_CONNECT_STATE={disconnect:0,connecting:1,connected:2},t.MAX_TRY_CONNECT_COUNT=1,t.SEND_MSG_RESET=2,t.SEND_MSG_TIMEOUT=1,t.MAX_TRY_HEARTBEAT_COUNT=5,t.MAX_STREAM_ID_LENGTH=256,t.MAX_USER_ID_LENGTH=64,t.MAX_USER_NAME_LENGTH=256,t.MAX_ROOM_ID_LENGTH=128,t.MAX_MIX_TASK_ID_LENGTH=256,function(e){e[e.logout=0]="logout",e[e.trylogin=1]="trylogin",e[e.login=2]="login"}(t.ENUM_RUN_STATE||(t.ENUM_RUN_STATE={})),function(e){e[e.offline=0]="offline",e[e.online=1]="online"}(t.ENUM_NETWORK_STATE||(t.ENUM_NETWORK_STATE={})),t.MINIUM_HEARTBEAT_INTERVAL=3e3,t.ENUM_STREAM_UPDATE_CMD={added:12001,deleted:12002,updated:12003},t.SERVER_ERROR_CODE=1e4,function(e){e[e.ClientType_None=0]="ClientType_None",e[e.ClientType_H5=1]="ClientType_H5",e[e.ClientType_SmallProgram=2]="ClientType_SmallProgram",e[e.ClientType_Webrtc=3]="ClientType_Webrtc"}(t.E_CLIENT_TYPE||(t.E_CLIENT_TYPE={})),t.REPORT_ACTION={eventStart:"eventStart",eventEndWithMsgInfo:"eventEndWithMsgInfo",addEventMsg:"addEventMsg",addEvent:"addEvent",eventEnd:"eventEnd",addMsgInfo:"addMsgInfo"},t.getSeq=(i=1,function(){return i++}),t.getReportSeq=function(){var e=1;return function(){return e++}}();var n=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this.next=null,this.prev=null,this._id=e,this._data=t}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id?this._id:null},set:function(e){this._id=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!1,configurable:!0}),e.prototype.hasNext=function(){return this.next&&this.next.id},e.prototype.hasPrev=function(){return this.prev&&this.prev.id},e}();t.ListNode=n;var o=function(){function e(){this.start=new n,this.end=new n,this._idCounter=0,this._numNodes=0,this.start.next=this.end,this.start.prev=null,this.end.prev=this.start,this.end.next=null}return e.prototype.insertBefore=function(e,t){var r=new n(this._idCounter,t);return r.next=e,r.prev=e.prev,e.prev&&(e.prev.next=r),e.prev=r,++this._idCounter,++this._numNodes,r},e.prototype.addLast=function(e){return this.insertBefore(this.end,e)},e.prototype.add=function(e){return this.addLast(e)},e.prototype.getFirst=function(){return 0===this._numNodes?null:this.start.next},e.prototype.getLast=function(){return 0===this._numNodes?null:this.end.prev},e.prototype.size=function(){return this._numNodes},e.prototype.getFromFirst=function(e){var t=0,r=this.start.next;if(e>=0)for(;t<e&&null!==r;)r=r.next,++t;else r=null;if(null===r)throw"Index out of bounds.";return r},e.prototype.get=function(e){return 0===e?this.getFirst():e===this._numNodes-1?this.getLast():this.getFromFirst(e)},e.prototype.remove=function(e){return e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),--this._numNodes,e},e.prototype.removeFirst=function(){var e=null;return this._numNodes>0&&this.start.next&&(e=this.remove(this.start.next)),e},e.prototype.removeLast=function(){var e=null;return this._numNodes>0&&this.end.prev&&(e=this.remove(this.end.prev)),e},e.prototype.removeAll=function(){this.start.next=this.end,this.end.prev=this.start,this._numNodes=0,this._idCounter=0},e.prototype.each=function(e){for(var t=this.start;t.hasNext();)e(t=t.next)},e.prototype.find=function(e){for(var t=this.start,r=!1,i=null;t.hasNext()&&!r;)e(t=t.next)&&(i=t,r=!0);return i},e.prototype.map=function(e){for(var t=this.start,r=[];t.hasNext();)e(t=t.next)&&r.push(t);return r},e.prototype.push=function(e){return this.addLast(e)},e.prototype.unshift=function(e){this._numNodes>0?this.insertBefore(this.start.next,e):this.insertBefore(this.end,e)},e.prototype.pop=function(){return this.removeLast()},e.prototype.shift=function(){return this.removeFirst()},e}();t.LinkedList=o,t.MODULE_TIPS={MESSAGE:"未引入消息模块"};var s=r(21);Object.defineProperty(t,"ZegoLogger",{enumerable:!0,get:function(){return s.ZegoLogger}}),Object.defineProperty(t,"ZegoDataReport",{enumerable:!0,get:function(){return s.ZegoDataReport}}),Object.defineProperty(t,"LoggerStateCenter",{enumerable:!0,get:function(){return s.LoggerStateCenter}}),Object.defineProperty(t,"createZegoWebSocket",{enumerable:!0,get:function(){return s.createZegoWebSocket}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCodeList=void 0,t.errorCodeList={SERVER:{code:0,msg:"liverooom cmd error"},SUCCESS:{code:0,msg:"success."},INIT:{code:2000000001,msg:"init sdk wrong"},NOT_LOGIN:{code:1000002,msg:"not login"},NETWORK_BROKEN:{code:1000017,msg:"network is broken"},INPUT_PARAM:{code:1100001,msg:"input parm error."},TIMEOUT:{code:1100002,msg:"network timeout."},SOCKET_CLOSE:{code:1100003,msg:"socket close"},INIT_SDK_WRONG:{code:1101e3,msg:"init sdk wrong"},USER_ID_NULL:{code:1002005,msg:"user ID is empty"},USER_ID_INVALID_CHARACTER:{code:1002006,msg:"user ID contains illegal characters"},USER_ID_TOO_LONG:{code:1002007,msg:"user ID is too long"},USER_NAME_NULL:{code:1002008,msg:"username is empty"},USER_NAME_TOO_LONG:{code:1002010,msg:"username is too long"},ROOM_ID_NULL:{code:1002011,msg:"room ID is empty"},ROOM_ID_INVALID_CHARACTER:{code:1002012,msg:"room ID contains illegal characters"},ROOM_ID_TOO_LONG:{code:1002013,msg:"room ID is too long"},ROOM_NOT_EXIST:{code:1002014,msg:"room not exist"},LOGIN_TIMEOUT:{code:1002031,msg:"login timeout"},ROOM_MAX_USER_COUNT:{code:1002034,msg:"users logging into the room exceeds the maximum number"},MULTIPLE_LOGIN_KICKOUT:{code:1002050,msg:"kickout may be the same user ID login other"},NETWORK_RECOVERY:{code:1002051,msg:"network recovery"},ROOM_RETRY_TIMEOUT:{code:1002053,msg:"network is broken and login fail."},MANUAL_KICKOUT:{code:1002055,msg:"server has sent a signal to kick out"},REPEATEDLY_LOGIN:{code:1002056,msg:"user repeatedly login"},REPEATEDLY_ENTER_ROOM:{code:1002057,msg:"user repeatedly enter room"},ALREADY_LOGIN:{code:1002058,msg:"user already logged in"},ROOM_INNER_ERROR:{code:1002099,msg:"room inner error"},HEARTBEAT_TIMEOUT:{code:1102001,msg:"heartbeat timeout."},PARSE_JSON_ERROR:{code:1102011,msg:"parse json error."},LOGIN_PROCESSING:{code:1102012,msg:"login is processing."},LIVEROMM_REQUEST_ERROR:{code:1102013,msg:"liveroom request error."},ZPUSH_REQUEST_FAIL:{code:1102014,msg:"zpush request fail."},LOGIN_STATE_WRONG:{code:1102015,msg:"user login state is wrong."},TOKEN_ERROR:{code:1102016,msg:"token error"},DIAPATCH_ERROR:{code:1102017,msg:"dispatch error"},TOKEN_EXPIRED:{code:1102018,msg:"token expired"},SUBCMD_ERROR:{code:1102019,msg:"subcmd error."},ZEGO_AUTH_ERROR:{code:1102020,msg:"zego auth error."},BIZ_CHANNEL_ERROR:{code:1102021,msg:"biz channel error."}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClientUtil=void 0;var i=r(22),n=r(0),o=r(1),s=function(){function e(){}return e.checkConfigParam=function(e,t,r){return e&&"number"==typeof e&&this.checkInteger(e)?!(!t||"string"!=typeof t&&!Array.isArray(t)||""==t)||(r.error("ccp.0 server must be string or string array and not empty"),!1):(r.error("ccp.0 appid must be positive integer number and not empty"),!1)},e.checkPriConfigParam=function(e,t,r,i,n){return e&&"number"==typeof e&&this.checkInteger(e)?t&&"string"==typeof t?"object"!=typeof r||"string"!=typeof r.deviceID?(n.error("ccp.0 deviceID must be string and not empty"),!1):1===i||0===i||(n.error("ccp.0 anType must be 0 or 1"),!1):(n.error("ccp.0 dispatchServer must be string and not empty"),!1):(n.error("ccp.0 appid must be positive integer number and not empty"),!1)},e.checkIllegalCharacters=function(e){return/^([0-9a-zA-Z#!$%&()`'+-;<=.>@^_~,\\*])+$/.test(e)&&/^[^:/]*$/g.test(e)},e.isUrl=function(e){return!!(e.startsWith("rtmp://")||e.startsWith("https://")&&e.endsWith(".flv")||e.startsWith("https://")&&e.endsWith(".m3u8"))},e.registerCallback=function(e,t,r){var i,n;t.success&&(i=t.success,r[e+"SuccessCallback"]=i),t.error&&(n=t.error,r[e+"ErrorCallback"]=n)},e.actionErrorCallback=function(e,t){return t[e+"ErrorCallback"]},e.actionSuccessCallback=function(e,t){return t[e+"SuccessCallback"]},e.logReportCallback=function(t,r,i,n){e.registerCallback(t,{success:function(t,n){for(var o=[],s=2;s<arguments.length;s++)o[s-2]=arguments[s];e.dataReportEvent(r,i,t,n,o)}},n)},e.proxyRes=function(t,r,i,n){return{interResolve:function(e){t.uploadReport(r),i(e)},interReject:function(i,o){var s;void 0===o&&(o=""),(s=i.code<2e9&&i.code>1e9?e.decodeServerError(i.code,i.msg):{code:i.code,message:i.msg})&&t.addMsgInfo(r,{error:s.code,message:s.message+o}),t.uploadReport(r),n({errorCode:i.code})}}},e.getServerError=function(e){var t={1:"parse json error.",1001:"login is processing.",1002:"liveroom request error.",1003:"zpush connect fail.",1004:"zpush handshake fail.",1005:"zpush login fail.",1006:"user login state is wrong.",1007:"got no zpush addr",1008:"token error",1009:"dispatch error",1010:"token expired",1011:"token format error",2002:"biz channel error",1e9:"liveroom cmd error, code:",1000002001:"need relogin",1000002002:"third token auth error",1000002003:"token nonce type should be int64",1000002004:"token appid type  should be uint32",1000002005:"token timeout type should be int64",1000002006:"token user_id type should be string",1000002007:"token room_id type should be string",1000002008:"token format error",1000002009:"token privilege type should be map",1000002010:"token expire_time type should be int64",1000002011:"token user_id type should be string",1000002012:"token not exist",1000002013:"token update error",1000002014:"token not need to check"};if(0===e)return o.errorCodeList.SUCCESS;var r=o.errorCodeList.ROOM_INNER_ERROR;if(r.code=e,e>1e9){var i=t[e];r.msg=i?"liveroom cmd error, code: "+e+", message: "+i:t[1e9]+e}else r.msg=t[e]?t[e]+" code:"+e:"unknown error code:"+e;return r},e.unregisterCallback=function(e,t){delete t[e+"SuccessCallback"],delete t[e+"ErrorCallback"]},e.decodeServerError=function(e,t){var r={code:-1,message:"server error"};return r.code=e>1e9?e-1e9+52e6:e+2002e6,t&&(r.message=t),r},e.getLiveRoomError=function(e){return e>1e9?{1105:"ROOM_MAX_USER_COUNT",1012:"PUBLISHER_ERROR_REPETITIVE_PUBLISH_STREAM",2002:"TOKEN_ERROR",2003:"ROOM_ERROR_LOGIN_TIMEOUT",2010:"TOKEN_ERROR"}[e-1e9]||"":{1:"PARSE_JSON_ERROR",1001:"LOGIN_PROCESSING",1002:"LIVEROMM_REQUEST_ERROR",1003:"ZPUSH_REQUEST_FAIL",1004:"ZPUSH_REQUEST_FAIL",1005:"ZPUSH_REQUEST_FAIL",1006:"LOGIN_STATE_WRONG",1007:"ZPUSH_REQUEST_FAIL",1008:"TOKEN_ERROR",1009:"DIAPATCH_ERROR",1010:"TOKEN_EXPIRED",1011:"TOKEN_ERROR",1012:"SUBCMD_ERROR",1101:"ZEGO_AUTH_ERROR",2001:"BIZ_CHANNEL_ERROR",2002:"BIZ_CHANNEL_ERROR"}[e]||"ROOM_INNER_ERROR"},e.getKickoutError=function(e){var t={code:e,message:"kickout reason = "+e};switch(e){case 1:t.code=63000001,t.message="zpush multiple login kickout",t.name="MULTIPLE_LOGIN_KICKOUT";break;case 2:t.code=63000002,t.message="zpush manual kickout",t.name="MANUAL_KICKOUT";break;case 3:t.code=63000003,t.message="kickout reason = "+e;break;case 4:t.code=63000004,t.message="zpush multiple login kickout",t.name="MULTIPLE_LOGIN_KICKOUT";break;case 5:t.code=63000005,t.message="zpush token expired",t.name="TOKEN_EXPIRED";break;default:t.code=e,t.message="kickout reason = "+e}return t},e.dataReportEvent=function(e,t,r,i,n){switch(r){case"eventStart":e.eventStart(t,i);break;case"eventEndWithMsgInfo":e.eventEndWithMsgInfo(t,i,n[0]);break;case"addEventMsg":e.addEventMsg(t,i,n[0],n[1]);break;case"addEvent":e.addEvent(t,i);break;case"eventEnd":e.eventEnd(t,i);break;case"addMsgInfo":e.addMsgInfo(t,n[0])}},e.isKeepTryLogin=function(e){switch(e){case 1002:case 1003:return!0;default:return!1}},e.mergeUserList=function(e,t,r,i){e.debug("msl.0 call");var n,o=[],s=[];r||(r=[]);for(var a=0;a<r.length;a++){n=!1;for(var c=0;c<t.length;c++)if(r[a].userID===t[c].userID){n=!0;break}n||o.push(r[a])}for(var l=0;l<t.length;l++){n=!1;for(var u=0;u<r.length;u++)if(t[l].userID===r[u].userID){n=!0;break}n||s.push(t[l])}for(t.splice(0),a=0;a<r.length;a++)t.push(t[a]);i(o,s),e.debug("msl.0 call success")},e.checkInteger=function(e,t){return 0==t?"number"==typeof e&&e%1==0&&e>=0:"number"==typeof e&&e%1==0&&e>0},e.checkValidNumber=function(e,t,r){return t=t||1,r=r||1e4,"number"==typeof e&&e%1==0&&e>=t&&e<=r},e.generateRandumNumber=function(e){return parseInt(Math.random()*(e+1)+"",10)},e.uuid=function(e,t){var r,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=[];if(t=t||i.length,e)for(r=0;r<e;r++)n[r]=i[0|Math.random()*t];else{var o=void 0;for(n[8]=n[13]=n[18]=n[23]="-",n[14]="4",r=0;r<36;r++)n[r]||(o=0|16*Math.random(),n[r]=i[19==r?3&o|8:o])}return n.join("")},e.compareVersion=function(e,t){e=e.split("."),t=t.split(".");for(var r=Math.max(e.length,t.length);e.length<r;)e.push("0");for(;t.length<r;)t.push("0");for(var i=0;i<r;i++){var n=parseInt(e[i]),o=parseInt(t[i]);if(n>o)return 1;if(n<o)return-1}return 0},e.getBrowser=function(){var e=window.navigator.userAgent,t=null!=window.ActiveXObject&&-1!=e.indexOf("MSIE"),r=-1!=e.indexOf("Firefox"),i=null!=window.opr,n=e.indexOf("Chrome")&&window.chrome,o=-1!=e.indexOf("Safari")&&-1!=e.indexOf("Version");return t?"IE":r?"Firefox":i?"Opera":n?"Chrome":o?"Safari":"Unkown"},e.isTestEnv=function(e){return-1!=e.indexOf("wss://wssliveroom-test.zego.im/ws")||-1!=e.indexOf("wss://test2-wsliveroom-api.zego.im/ws")||-1!=e.indexOf("wss://wsliveroom-test.zegocloud.com/ws")||-1!=e.indexOf("wss://wsliveroom-test.zego.im/ws")||-1!=e.indexOf("wss://webliveroom-test.zego.im/ws")||-1!=e.indexOf("wss://webliveroom-test-bak.zego.im/ws")||-1!=e.indexOf("wss://webliveroom-hk-test.zegocloud.com/ws")||-1!=e.indexOf("wss://webliveroom-hk-test-bak.zegocloud.com/ws")},e.getLogLevel=function(e){return n.LOG_LEVEL[e]},e.getUint64=function(e,t,r){var i=r.getUint32(e,t),n=r.getUint32(e+4,t),o=t?i+Math.pow(2,32)*n:Math.pow(2,32)*i+n;return Number.isSafeInteger(o)||console.warn(o,"exceeds MAX_SAFE_INTEGER. Precision may be lost"),o},e.decodeTokenExpire=function(t){try{var r=Uint8Array.from(i.Base64.base64decode(t),(function(e){return e.charCodeAt(0)})),n=new DataView(r.buffer),o=void 0;return o="function"==typeof n.getBigInt64?n.getBigUint64(0):e.getUint64(0,!1,n),Number(o>0?o:n.getBigUint64(0,!0))}catch(e){console.error("token error")}return-1},e}();t.ClientUtil=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZEGO_RTM_ACTION=void 0,function(e){e.ZEGOEXPRESSWEBRTM_CONSTRUCTOR="zm.0",e.ZEGOEXPRESSWEBRTM_BIND_WINDOW_LISTENER="zm.wl",e.ZEGOEXPRESSWEBRTM_SET_LOG_CONFIG="zm.slf",e.ZEGOEXPRESSWEBRTM_SET_DEBUG_VERBOSE="zm.sdv",e.ZEGOEXPRESSWEBRTM_LOGIN_ROOM="zm.lg",e.ZEGOEXPRESSWEBRTM_LOGOUT_ROOM="zm.lo",e.ZEGOEXPRESSWEBRTM_SET_CLOUD_SETTING_URLS="zm.scsu",e.ZEGOEXPRESSWEBRTM_ON="zm.on",e.ZEGOEXPRESSWEBRTM_OFF="zm.off",e.ZEGOEXPRESSWEBRTM_RENEWTOKEN="zm.rntk",e.ZEGOEXPRESSWEBRTM_RESETTOKENTIMER="zm.rstt",e.ZEGOEXPRESSWEBRTM_ENABLE_MULTI_ROOM="zm.emr",e.ZEGOEXPRESSWEBRTM_SEND_PB="zm.spb",e.ZEGOEXPRESSWEBRTM_GET_HEADER="zm.gh",e.ROOM_LOGIN_ROOM="zm.rm.lg",e.ROOM_TRY_LOGIN="zm.rm.tl",e.ROOM_OPEN_HANDLER="zm.rm.op",e.ROOM_HANDLE_LOGINRSP="zm.rm.lgr",e.ROOM_CLOSEHANDLER="zm.rm.clh",e.ROOM_LOGOUT="zm.rm.lo",e.ROOM_RESET_ROOM="zm.rm.rr",e.ROOM_DISCONNECT="zm.rm.dcn",e.ROOM_KICK_OUT="zm.rm.kco",e.ROOM_STATUS_CALLBACK="zm.rm.scb",e.ROOM_RESETTOKEN_TIMER="zm.rm.rst",e.HEARTBEAT_START="zm.hb.st",e.HEARTBEAT_HEARTBEAT_RSP="zm.hb.rsp",e.HEARTBEAT_RESET="zm.hb.rst",e.SERVICE_PUSH="zm.sv.ps",e.SERVICE_SEND="zm.sv.sd",e.USER_LOGIN_RSP="zm.us.lgr",e.USER_FETCH_USER="zm.us.ftu",e.USER_FETCH_USER_RSP="zm.us.urp",e.USER_USER_PUSH="zm.us.uph",e.USER_MERGE_SEQ="zm.us.mg",e.USER_MERGE_TIMEOUT="zm.us.mto",e.USER_MERGE="zm.us.mg",e.USER_HB_PATCH="zm.us.pt",e.STATE_ACTION="zm.st.at",e.ON_LISTENER="ON_LISTENER"}(t.ZEGO_RTM_ACTION||(t.ZEGO_RTM_ACTION={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoRTMLogEvent=void 0;var i=r(1),n=function(e){return e};t.ZegoRTMLogEvent={kZegoTaskInitSetting:{event:"/sdk/init",error:{kInvalidParamError:i.errorCodeList.INPUT_PARAM},system_info:navigator?navigator.appVersion:""},kZegoTaskSetDebug:{event:"/sdk/set_debug",debug:n},kZegoTaskSetLog:{event:"/sdk/set_log_config",error:{kInvalidParamError:i.errorCodeList.INPUT_PARAM},log_level:function(e){return e},remote_log_level:n,log_url:n},kZegoTaskLoginRoom:{event:"/sdk/login",user_update:n,max_member_count:n,message:n,token:n,error:{ROOM_ID_NULL:i.errorCodeList.ROOM_ID_NULL,INPUT_PARAM:i.errorCodeList.INPUT_PARAM,ROOM_ID_TOO_LONG:i.errorCodeList.ROOM_ID_TOO_LONG,ROOM_ID_INVALID_CHARACTER:i.errorCodeList.ROOM_ID_INVALID_CHARACTER,USER_ID_NULL:i.errorCodeList.USER_ID_NULL,USER_ID_TOO_LONG:i.errorCodeList.USER_ID_TOO_LONG,USER_ID_INVALID_CHARACTER:i.errorCodeList.USER_ID_INVALID_CHARACTER,USER_NAME_NULL:i.errorCodeList.USER_NAME_NULL,USER_NAME_TOO_LONG:i.errorCodeList.USER_NAME_TOO_LONG,REPEATEDLY_LOGIN:i.errorCodeList.REPEATEDLY_LOGIN,LOGIN_TIMEOUT:i.errorCodeList.LOGIN_TIMEOUT,INNER_ERROR:i.errorCodeList.ROOM_INNER_ERROR,NETWORK_BROKEN:i.errorCodeList.NETWORK_BROKEN},subEvent:{create_socket:{event:"create_socket",server:n,try_cnt:n},liveroom_login:{event:"liveroom_login",server:n,respond_info:n}}},kZegoTaskReNewToken:{event:"/sdk/reNewToken",error:{INPUT_PARAM:i.errorCodeList.INPUT_PARAM,NOT_LOGIN:i.errorCodeList.NOT_LOGIN}},kZegoTaskLogoutRoom:{event:"/sdk/logout",error:{INPUT_PARAM:i.errorCodeList.INPUT_PARAM,ROOM_NOT_EXIST:i.errorCodeList.ROOM_NOT_EXIST}},kZegoTaskReLoginRoom:{event:"/sdk/relogin",error:{ROOM_ID_NULL:i.errorCodeList.ROOM_ID_NULL,ROOM_DISCONNECT:i.errorCodeList.NETWORK_BROKEN},subEvent:{create_socket:{event:"create_socket",server:n,try_cnt:n},liveroom_login:{event:"liveroom_login",server:n,respond_info:n}}},kZegoTaskKickout:{event:"/sdk/kickout",user_id:n,error:{}},kZegoTaskRoomKickout:{event:"/sdk/room_kickout",user_id:n,room_id:n,message:n},kZegoTaskLiveRoomHB:{event:"/liveroom/hb",room_sid:n,error:{NOT_LOGIN:i.errorCodeList.NOT_LOGIN,HB_TIMEOUT:i.errorCodeList.TIMEOUT}},kZegoTaskLiveRoomGetUserUpdateInfo:{event:"/liveroom/get_user_update_info",user_update_type:n},kZegoListener:{event:"/sdk/listener"},kZegoEnableMultiRoom:{event:"sdk/enable_multi_room",error:{kInvalidParamError:i.errorCodeList.INPUT_PARAM,kAlreadyLoginError:i.errorCodeList.ALREADY_LOGIN}},kZegoTaskCloudSettingCache:{event:"/cloud_setting/cache"},kZegoTaskCloudSettingRefresh:{event:"/cloud_setting/refresh"},kZegoTaskCloudSettingRequest:{event:"/cloud_setting/request"}}},,,,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeartBeatHandler=void 0;var i=r(0),n=r(2),o=r(1),s=r(3),a=r(4),c=3,l=function(){function e(e,t,r,i,n){this.logger=e,this.stateCenter=t,this.dataReport=r,this.service=i,this.room=n,this.tryHeartbeatCount=0,this.heartbeatTimer=null,this.loginHeartbeatTimer=null,this.initCount=0}return e.prototype.init=function(e){var t,r=this;if("PRIVATE"==this.stateCenter.type){t=e.body.hb_interval<i.MINIUM_HEARTBEAT_INTERVAL?i.MINIUM_HEARTBEAT_INTERVAL:e.body.hb_interval;var n=e.body.hb_timeout||4e4;c=n/t+1}else t=e.body.hearbeat_interval<i.MINIUM_HEARTBEAT_INTERVAL?i.MINIUM_HEARTBEAT_INTERVAL:e.body.hearbeat_interval;this.tryHeartbeatCount=0,this.heartbeatTimer&&clearTimeout(this.heartbeatTimer),this.loginHeartbeatTimer=setTimeout((function(){r.start(t)}),t),this.initCount++},e.prototype.start=function(e){var t=this;this.logger.info(s.ZEGO_RTM_ACTION.HEARTBEAT_START+" call");var r=i.getReportSeq();if(this.dataReport.newReport(r,a.ZegoRTMLogEvent.kZegoTaskLiveRoomHB.event),this.dataReport.addMsgInfo(r,{room_sid:a.ZegoRTMLogEvent.kZegoTaskLiveRoomHB.room_sid(this.room.sessionID)}),!this.room.isLogin())return this.logger.error(s.ZEGO_RTM_ACTION.HEARTBEAT_START+" state error"),this.dataReport.addMsgInfo(r,{error:a.ZegoRTMLogEvent.kZegoTaskLiveRoomHB.error.NOT_LOGIN.code,message:a.ZegoRTMLogEvent.kZegoTaskLiveRoomHB.error.NOT_LOGIN.msg}),void this.dataReport.uploadReport(r);if(++this.tryHeartbeatCount>c)return this.logger.error(s.ZEGO_RTM_ACTION.HEARTBEAT_START+" come to try limit"),this.dataReport.addMsgInfo(r,{error:a.ZegoRTMLogEvent.kZegoTaskLiveRoomHB.error.HB_TIMEOUT.code,message:a.ZegoRTMLogEvent.kZegoTaskLiveRoomHB.error.HB_TIMEOUT.msg}),this.dataReport.uploadReport(r),void this.hbLogout(o.errorCodeList.HEARTBEAT_TIMEOUT);var l=function(e){var i="PRIVATE"==t.stateCenter.type?e.body&&e.body.code:e.body&&e.body.err_code;if(e.header&&e.body){if(0!==i){var s=n.ClientUtil.decodeServerError(e.body.err_code||e.body.code,e.body.err_message||e.body.message);t.dataReport.addMsgInfo(r,{error:s.code,message:s.message+e.body.err_code})}}else t.dataReport.addMsgInfo(r,{error:e.code>0?e.code:o.errorCodeList.ROOM_INNER_ERROR.code,message:e.msg?e.msg:o.errorCodeList.ROOM_INNER_ERROR});t.dataReport.uploadReport(r),"PRIVATE"==t.stateCenter.type?t.handlePrivateHeartbeatRsp(e):t.handleHeartbeatRsp(e)};this.service.heartBeat(l,l,this.room.sessionID,this.room.roomID,this.room.roomSessionID),this.heartbeatInterval=e;var u=this.heartbeatInterval;this.initCount>=2?(u=Math.round(Math.random()*(this.heartbeatInterval+1)),this.initCount=1):u=this.heartbeatInterval,this.heartbeatTimer=setTimeout((function(){t.start(t.heartbeatInterval)}),u),this.logger.info(s.ZEGO_RTM_ACTION.HEARTBEAT_START+" call success")},e.prototype.handleHeartbeatRsp=function(e){return e.body&&e.body.err_code&&0!==e.body.err_code?(this.logger.error(s.ZEGO_RTM_ACTION.HEARTBEAT_HEARTBEAT_RSP+" disconnect, server error=",e.body.err_code),e.body.err_code==i.ERROR_CODES.ROOM_SESSION_ID_ERR?void this.hbLogout(o.errorCodeList.HEARTBEAT_TIMEOUT):void this.hbLogout(n.ClientUtil.getServerError(e.body.err_code))):e.header&&e.body?(this.tryHeartbeatCount=0,this.heartbeatInterval=e.body.hearbeat_interval,this.heartbeatInterval<i.MINIUM_HEARTBEAT_INTERVAL&&(this.heartbeatInterval=i.MINIUM_HEARTBEAT_INTERVAL),this.heartbeatRspNotiFy(e),void this.logger.info(s.ZEGO_RTM_ACTION.HEARTBEAT_HEARTBEAT_RSP+" call success")):(this.logger.error(s.ZEGO_RTM_ACTION.HEARTBEAT_HEARTBEAT_RSP+" disconnect, error=",JSON.stringify(e)),void this.hbLogout(e))},e.prototype.handlePrivateHeartbeatRsp=function(e){if(0!==e.body.code)return this.logger.error(s.ZEGO_RTM_ACTION.HEARTBEAT_HEARTBEAT_RSP+" disconnect, server error=",e.body.code),e.body.code==i.ERROR_CODES.ROOM_SESSION_ID_ERR?void this.hbLogout(o.errorCodeList.HEARTBEAT_TIMEOUT):void this.hbLogout(n.ClientUtil.getServerError(e.body.code));this.tryHeartbeatCount=0,this.heartbeatInterval=e.body.hb_interval,this.heartbeatInterval<i.MINIUM_HEARTBEAT_INTERVAL&&(this.heartbeatInterval=i.MINIUM_HEARTBEAT_INTERVAL),this.heartbeatRspNotiFy(e),this.logger.info(s.ZEGO_RTM_ACTION.HEARTBEAT_HEARTBEAT_RSP+" call success")},e.prototype.heartbeatRspNotiFy=function(e){},e.prototype.hbLogout=function(e){},e.prototype.resetHeartbeat=function(){clearTimeout(this.heartbeatTimer),this.heartbeatTimer=null,clearTimeout(this.loginHeartbeatTimer),this.loginHeartbeatTimer=null,this.tryHeartbeatCount=0,this.initCount=0,this.logger.info(s.ZEGO_RTM_ACTION.HEARTBEAT_RESET+" call success")},e}();t.HeartBeatHandler=l},function(e,t,r){"use strict";var i=this&&this.__spreadArray||function(e,t){for(var r=0,i=t.length,n=e.length;r<i;r++,n++)e[n]=t[r];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.UserHandler=void 0;var n=r(0),o=r(2),s=r(3),a=r(4),c=function(){function e(e,t,r,i,n){this.logger=e,this.stateCenter=t,this.dataReport=r,this.service=i,this.room=n,this.userQuerying=!1,this.userTempList=[],this.userSeq=0,this.minUserSeq=0,this.userList=[],this.userSeqMergeMap=null,this.userListInterval=3e4,this.userListMergeInterval=5e3,this.anchor_info={anchor_id:"",anchor_id_name:"",anchor_nick_name:""}}return e.prototype.loginRsp=function(e,t){this.anchor_info=e.body.anchor_info||this.anchor_info,this.userListInterval=e.body.userlist_interval||this.userListInterval,this.userListMergeInterval=e.body.userlist_merge_timeout||this.userListMergeInterval,e.body.anchor_info&&(this.stateCenter.actionListener("getAnchorInfo",e.body.anchor_info.anchor_id_name,e.body.anchor_info.anchor_nick_name),this.stateCenter.actionListener("_getAnchorInfo",e.body.anchor_info.anchor_id_name,e.body.anchor_info.anchor_nick_name)),e.body.online_count&&this.stateCenter.actionListener("roomOnlineUserCountUpdate",this.room.roomID,e.body.online_count),this.logger.info(s.ZEGO_RTM_ACTION.USER_LOGIN_RSP+"  userStateUpdate "+this.stateCenter.userStateUpdate),this.stateCenter.userStateUpdate&&this.fetchUserList(t)},e.prototype.patchUserList=function(e){var t=this;e.body.server_user_seq!==this.userSeq&&this.stateCenter.userStateUpdate&&!this.userSeqMergeMap&&(this.logger.info(s.ZEGO_RTM_ACTION.USER_HB_PATCH+" call update user "+this.userSeq+" server "+e.body.server_user_seq),this.userSeqMergeTimer&&clearTimeout(this.userSeqMergeTimer),this.userSeqMergeTimer=setTimeout((function(){t.handleMergeTimeout()}),this.userListMergeInterval)),this.minUserSeq=e.body.server_user_seq,null!=e.body.online_count&&0!=e.body.online_count&&this.stateCenter.actionListener("roomOnlineUserCountUpdate",this.room.roomID,e.body.online_count)},e.prototype.resetUserHandler=function(){this.userQuerying=!1,this.lastUserQueryTime=0,this.userTempList=[],this.userSeq=0,this.minUserSeq=0,this.userList=void 0,this.userSeqMergeMap={},this.userSeqMergeTimer=void 0,this.userQueryTimer=void 0,this.userListInterval=3e4,this.userListMergeInterval=5e3,this.anchor_info={anchor_id:"",anchor_id_name:"",anchor_nick_name:""}},e.prototype.fetchUserList=function(e){this.userQuerying?this.logger.warn(s.ZEGO_RTM_ACTION.USER_FETCH_USER+" is already querying"):(this.userQuerying=!0,this.userTempList=[],this.fetchUserListWithPage(0,e||0),this.logger.info(s.ZEGO_RTM_ACTION.USER_FETCH_USER+" the first time call"))},e.prototype.fetchUserListWithPage=function(e,t){var r,i=this,o=function(e){"PRIVATE"==i.stateCenter.type?i.handleFetchUserListPrivateRsp(e):i.handleFetchUserListRsp(e,t)};r="PRIVATE"==this.stateCenter.type?{room_header:{room_id:this.room.roomID,room_sid:this.room.roomSid,room_user_session_id:this.room.roomSessionID},mark:"0"}:{user_index:e,sort_type:0},"V1"===n.ROOMVERSION?this.service.fetchUserList(r,o,o,this.room.sessionID,this.room.roomID,this.room.roomSessionID):this.service.fetchUserListV2({marker:0===e?"":e+"",mode:0,limit:100},o,o,this.room.sessionID,this.room.roomID,this.room.roomSessionID)},e.prototype.handleFetchUserListRsp=function(e,t){var r=this;if(e.body&&0!=e.body.err_code)return this.userQuerying=!1,this.lastUserQueryTime=Date.now()+this.userListInterval,void this.logger.info(s.ZEGO_RTM_ACTION.USER_FETCH_USER_RSP+" fetch error "+e.body.err_code);if(!e.header||!e.body)return this.userQuerying=!1,this.lastUserQueryTime=Date.now()+this.userListInterval,void this.logger.info(s.ZEGO_RTM_ACTION.USER_FETCH_USER_RSP+" fetch error "+e);if(this.stateCenter.userStateUpdate){this.userTempList=i(i([],this.userTempList),e.body.user_baseinfos);var a=e.body.ret_user_index;if(a!=e.body.server_user_index)return this.logger.info(s.ZEGO_RTM_ACTION.USER_FETCH_USER_RSP+" fetch another page"),void this.fetchUserListWithPage(a+1,t);this.userSeq=e.body.server_user_seq;for(var c=[],l=[],u=0;u<this.userTempList.length;u++){var d={userID:this.userTempList[u].id_name,userName:this.userTempList[u].nick_name,role:this.userTempList[u].role};c.push(d),l.push({idName:this.userTempList[u].id_name,nickName:this.userTempList[u].nick_name,role:this.userTempList[u].role})}this.stateCenter.actionListener("_getTotalUserList",this.room.roomID,l),t==n.ENUM_RUN_STATE.login?(this.userList&&o.ClientUtil.mergeUserList(this.logger,this.userList,c,(function(e,t){0!==e.length&&r.onUserStateUpdate(r.room.roomID,"ADD",e),0!==t.length&&r.onUserStateUpdate(r.room.roomID,"DELETE",t)})),this.userList=c):(this.userList=c,0!==c.length&&this.onUserStateUpdate(this.room.roomID,"ADD",c)),this.userQuerying=!1,this.lastUserQueryTime=Date.now()+this.userListInterval,this.userTempList=[],this.logger.info(s.ZEGO_RTM_ACTION.USER_FETCH_USER_RSP+" call success user_list "+c+" count "+c.length)}},e.prototype.handlePushUserStateUpdateMsg=function(e){if(this.logger.info(s.ZEGO_RTM_ACTION.USER_USER_PUSH+" call"),this.stateCenter.userStateUpdate)if(this.userSeq!==e.body.user_list_seq)if(this.userSeq+e.body.user_actions.length===e.body.user_list_seq){this.userSeq=e.body.user_list_seq;var t,r,i=[];if("PRIVATE"==this.stateCenter.type){t=0,r=1;for(var n=0;n<e.body.user_actions.length;n++){var o={action:e.body.user_actions[n].action,idName:e.body.user_actions[n].user_id,nickName:e.body.user_actions[n].user_name,role:e.body.user_actions[n].role,loginTime:e.body.user_actions[n].login_time};i.push(o)}}else{for(t=1,r=2,n=0;n<e.body.user_actions.length;n++)o={action:e.body.user_actions[n].Action,idName:e.body.user_actions[n].IdName,nickName:e.body.user_actions[n].NickName,role:e.body.user_actions[n].Role,loginTime:e.body.user_actions[n].LoginTime},i.push(o);this.stateCenter.actionListener("_userStateUpdate",e.body.room_id,i)}var a=[],c=[];i.forEach((function(e){e.action==t?a.push({userID:e.idName,userName:e.nickName,role:e.role}):e.action==r&&c.push({userID:e.idName,userName:e.nickName,role:e.role})})),this.userList&&(this.userList=this.userList.concat(a).filter((function(e){return!c.some((function(t){return t.userID==e.userID}))}))),0!==a.length&&this.onUserStateUpdate(e.body.room_id||e.body.room_pushheader.room_id,"ADD",a),0!==c.length&&this.onUserStateUpdate(e.body.room_id||e.body.room_pushheader.room_id,"DELETE",c),this.logger.info(s.ZEGO_RTM_ACTION.USER_USER_PUSH+" call success")}else this.mergeUserByUserSeq(e.body.user_list_seq,e.body.user_actions);else this.logger.warn(s.ZEGO_RTM_ACTION.USER_USER_PUSH+" user_list_seq is the same with local seq");else this.logger.info(s.ZEGO_RTM_ACTION.USER_USER_PUSH+" userStateUpdate is false")},e.prototype.onUserStateUpdate=function(e,t,r){var i=this,o=n.getReportSeq();this.dataReport.newReport(o,a.ZegoRTMLogEvent.kZegoTaskLiveRoomGetUserUpdateInfo.event);var s=r.filter((function(e){return e.userID!==i.stateCenter.idName}));0!=s.length&&("PRIVATE"!==this.stateCenter.type&&(s=s.map((function(e){return{userID:e.userID,userName:e.userName}}))),this.stateCenter.actionListener("roomUserUpdate",e,t,s),this.dataReport.addMsgInfo(o,{user_update_type:"ADD"==t?a.ZegoRTMLogEvent.kZegoTaskLiveRoomGetUserUpdateInfo.user_update_type("added"):a.ZegoRTMLogEvent.kZegoTaskLiveRoomGetUserUpdateInfo.user_update_type("deleted")}),this.dataReport.uploadReport(o))},e.prototype.mergeUserByUserSeq=function(e,t){var r=this;this.userSeqMergeMap||(this.logger.warn(s.ZEGO_RTM_ACTION.USER_MERGE_SEQ+" new merge userlist "+this.userSeq+" server "+e),this.userSeqMergeMap={},this.userSeqMergeTimer&&clearTimeout(this.userSeqMergeTimer),this.userSeqMergeTimer=setTimeout((function(){r.handleMergeTimeout()}),this.userListMergeInterval)),this.userSeqMergeMap[e]=t,this.logger.warn(s.ZEGO_RTM_ACTION.USER_MERGE_SEQ+"  merge userlist "+this.userSeq+" server "+e+" userlist "+t.length)},e.prototype.mergeUser=function(e){var t=this;this.logger.info(s.ZEGO_RTM_ACTION.USER_MERGE+" merge userlist "+this.userSeq+" userSeqList "+e.join(",")),this.userSeq=e[e.length-1],this.lastUserQueryTime=Date.now()+this.userListInterval;var r={};e.forEach((function(e){t.userSeqMergeMap&&t.userSeqMergeMap[e].forEach((function(e){r[e.IdName]=e}))})),this.userSeqMergeMap=null;var i=Object.values(r).map((function(e){return{action:e.Action,idName:e.IdName,nickName:e.NickName,role:e.Role,loginTime:e.LoginTime?String(e.LoginTime):""}}));i.sort((function(e,t){return e.loginTime.localeCompare(t.loginTime)}));var n=[],o=[];i.forEach((function(e){1==e.action?n.push({userID:e.idName,userName:e.nickName,role:e.role}):2==e.action&&o.push({userID:e.idName,userName:e.nickName,role:e.role})})),this.userList=this.userList&&this.userList.concat(n).filter((function(e){return!o.some((function(t){return t.userID==e.userID}))})),0!==n.length&&this.onUserStateUpdate(this.room.roomID,"ADD",n),0!==o.length&&this.onUserStateUpdate(this.room.roomID,"DELETE",o),this.stateCenter.actionListener("_userStateUpdate",this.room.roomID,i)},e.prototype.handleMergeTimeout=function(){var e=this,t=Object.keys(this.userSeqMergeMap).map((function(e){return+e})).sort((function(e,t){return e-t}));if(t[t.length-1]-t[0]+1===t.length||t[t.length-1]>=this.minUserSeq)this.mergeUser(t);else{this.userSeqMergeMap=null;var r=this.lastUserQueryTime-Date.now();this.logger.info(s.ZEGO_RTM_ACTION.USER_MERGE_TIMEOUT+"  fetch merge userlist "+this.userSeq+" userSeqList "+t.join(",")+" wait "+r),r>0?(this.userQueryTimer&&clearTimeout(this.userQueryTimer),this.userQueryTimer=setTimeout((function(){e.fetchUserList()}),r)):this.fetchUserList()}},e.prototype.loginPrivateRsp=function(e){this.logger.info(s.ZEGO_RTM_ACTION.USER_FETCH_USER," userStateUpdate "+this.stateCenter.userStateUpdate),this.stateCenter.userStateUpdate&&this.fetchUserList()},e.prototype.handleFetchUserListPrivateRsp=function(e){if(this.logger.debug(s.ZEGO_RTM_ACTION.USER_FETCH_USER+" call"),e.body.code&&0!==e.body.code)return this.userQuerying=!1,void this.logger.info(s.ZEGO_RTM_ACTION.USER_FETCH_USER+" fetch error "+e.body.code+" "+e.body.message);if(this.stateCenter.userStateUpdate){this.userTempList=i(i([],this.userTempList),e.body.users),this.userSeq=e.body.userlist_seq,this.logger.info(s.ZEGO_RTM_ACTION.USER_FETCH_USER+" set user Seq "+this.userSeq);for(var t=[],r=0;r<this.userTempList.length;r++){var n={userID:this.userTempList[r].user_id,userName:this.userTempList[r].user_name,role:this.userTempList[r].role};t.push(n)}this.userQuerying=!1,this.onUserStateUpdate(this.room.roomID,"ADD",t),this.userTempList=[],this.logger.info(s.ZEGO_RTM_ACTION.USER_FETCH_USER+" call success user_list "+t+" count "+t.length)}},e}();t.UserHandler=c},function(e,t,r){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},n=this&&this.__spreadArray||function(e,t){for(var r=0,i=t.length,n=e.length;r<i;r++,n++)e[n]=t[r];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.LiveRoomService=void 0;var o=r(0),s=r(12),a=r(3),c=r(1),l=function(){function e(e,t,r){this.stateCenter=e,this.logger=t,this.rtm=r,this.service=new s.ZegoSocketService(this.stateCenter.ENV),this.cmdSeq=0,this.responseRouters={}}return e.prototype.checkResponse=function(e){return e.header.appid!==this.stateCenter.appid||e.header.user_id!==this.stateCenter.userid},e.prototype.handleSendCommandMsgRsp=function(e){var t=this,r=this.service.sendCommandMap[e.header.seq];if(null!=r){var i=r._data;delete this.service.sendCommandMap[e.header.seq],this.service.sendCommandList.remove(r),0===e.body.err_code?setTimeout((function(){i&&null!=i.success&&i.success(e,t.cmdSeq)}),0):setTimeout((function(){i&&null!=i.error&&i.error(e,t.cmdSeq)}),0)}},e.prototype.onPush=function(){var e=this;this.service.onMessage=function(t){t instanceof ArrayBuffer?e.stateCenter.actionListener("_protobufResponse",t):t.header?(0!==t.body.err_code?t.body.err_message&&e.logger.error(a.ZEGO_RTM_ACTION.SERVICE_PUSH+" cmd="+t.header.cmd+", err_code="+t.body.err_code+", err_message="+t.body.err_message+" "):e.logger.info(a.ZEGO_RTM_ACTION.SERVICE_PUSH+" cmd="+t.header.cmd+", msg="+JSON.stringify(t)+" "),["login","logout"].indexOf(t.header.cmd)>-1?e.handleSendCommandMsgRsp(t):e.checkResponse(t)?e.logger.error(a.ZEGO_RTM_ACTION.SERVICE_PUSH+"  check session fail."):(e.logger.info(a.ZEGO_RTM_ACTION.SERVICE_PUSH+" cmd="+t.header.cmd+",function="+!!e.responseRouters[t.header.cmd]),e.handleSendCommandMsgRsp(t),e.responseRouters[t.header.cmd]&&e.responseRouters[t.header.cmd](t,e.cmdSeq))):e.logger.error(a.ZEGO_RTM_ACTION.SERVICE_PUSH+" msg type error ")}},e.prototype.handlePushKickout=function(e){var t,r,i,o;if(void 0===(null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.protocol)||1===(null===(r=null==e?void 0:e.body)||void 0===r?void 0:r.protocol))n([],this.stateCenter.roomModulesList).forEach((function(t){return t.roomHandler.handlePushKickout(e,!0)}));else{var s=null===(i=null==e?void 0:e.header)||void 0===i?void 0:i.room_id,c=this.stateCenter.roomModulesList.find((function(e){return e.roomID==s}));if(!c)return void this.logger.error(a.ZEGO_RTM_ACTION.SERVICE_PUSH+" room no found ignore "+JSON.stringify(null===(o=e.header)||void 0===o?void 0:o.room_id));c.roomHandler.handlePushKickout(e)}},e.prototype.handlePushCustomMsg=function(e){},e.prototype.handlePushRoomMsg=function(e){},e.prototype.handlePushUserStateUpdateMsg=function(e){var t,r=null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id,i=this.stateCenter.roomModulesList.find((function(e){return e.roomID==r}));i?i.userHandler.handlePushUserStateUpdateMsg(e):this.logger.error(a.ZEGO_RTM_ACTION.SERVICE_PUSH+" room no found ignore "+JSON.stringify(e))},e.prototype.handlePushMergeMsg=function(e){},e.prototype.handlePushTransMsg=function(e){},e.prototype.handleBigImMsgRsp=function(e){},e.prototype.handlePushSignalMsg=function(e){},e.prototype.handlePushTokenExpire=function(e){this.stateCenter.actionListener("_tokenExpired",e)},e.prototype.closeHandler=function(e){this.service.closeHandler(e)},e.prototype.openHandler=function(e){this.service.openHandler(e)},e.prototype.errorHandler=function(e){this.service.errorHandler(e)},e.prototype.getHeader=function(e,t,r,i){return{Protocol:"V1"===o.ROOMVERSION?"req":"req_v2",cmd:e,appid:this.stateCenter.appid,seq:++this.cmdSeq,user_id:this.stateCenter.userid,session_id:t||"",room_id:r||"",room_session_id:i||"",biz_version:this.stateCenter.bizVersion||""}},e.prototype.startCheck=function(){this.service.startCheck()},e.prototype.stopCheck=function(){this.service.stopCheck()},e.prototype.isDisConnect=function(){return!this.service||this.service.isDisConnect()},e.prototype.createSocket=function(e){var t=this;this.service.createSocket(e),this.responseRouters=i(i({},this.responseRouters),{push_kickout:function(e){t.handlePushKickout(e)},push_custommsg:function(e){t.handlePushCustomMsg(e)},push_im_chat:function(e){t.handlePushRoomMsg(e)},push_userlist_update:function(e){t.handlePushUserStateUpdateMsg(e)},push_merge_message:function(e){t.handlePushMergeMsg(e)},push_trans:function(e){t.handlePushTransMsg(e)},push_signal:function(e){t.handlePushSignalMsg(e)},push_token_expire:function(e){t.handlePushTokenExpire(e)}})},e.prototype.closeSocket=function(){this.service.closeSocket()},e.prototype.sendMessage=function(e,t,r,i,n,o){var s,l,u;if(this.service.isDisConnect())return this.logger.error(a.ZEGO_RTM_ACTION.SERVICE_SEND+" socket is disconnect"),i(c.errorCodeList.SOCKET_CLOSE),0;var d=(null==o?void 0:o.roomID)?o.roomID:null===(s=this.stateCenter.roomModulesList[0])||void 0===s?void 0:s.roomID,h=(null==o?void 0:o.roomSessionID)?o.roomSessionID:null===(l=this.stateCenter.roomModulesList[0])||void 0===l?void 0:l.roomSessionID,p=(null==o?void 0:o.sessionID)?o.sessionID:null===(u=this.stateCenter.roomModulesList[0])||void 0===u?void 0:u.sessionID,f=n||this.getHeader(e,p,d,h);return this.logger.info(a.ZEGO_RTM_ACTION.SERVICE_SEND+" sendMsg:"+JSON.stringify({header:f,body:t})),this.service.sendMessage(f,t,r,i)},e.prototype.on=function(e,t){this.responseRouters[e]=t},e.prototype.login=function(e,t,r){var i=this.getHeader(e.isMulti?"enter":"login",e.sessionID,e.roomID,e.roomSessionID),n={id_name:this.stateCenter.idName,nick_name:this.stateCenter.nickName,role:this.stateCenter.role,token:e.token,version:this.stateCenter.sdKVersion,room_name:e.roomID,user_state_flag:this.stateCenter.userStateUpdate?1:0,room_create_flag:this.stateCenter.roomCreateFlag,client_type:0===this.stateCenter.ENV?o.E_CLIENT_TYPE.ClientType_Webrtc:o.E_CLIENT_TYPE.ClientType_SmallProgram,third_token:e.thirdToken,user_count_limit:this.stateCenter.maxMemberCount,relate_service:this.stateCenter.relateService.join()||"",login_logic:this.stateCenter.isMultiRoom?3:1,proto_format:this.stateCenter.protoFormat};return this.sendMessage("",n,t,r,i)},e.prototype.logout=function(e,t,r){var i=e.isMulti?"quit":"logout",n={reserve:0};return"logout"==i&&(n.login_logic=this.stateCenter.isMultiRoom?3:1),this.sendMessage(i,n,t,r,void 0,{sessionID:e.sessionID,roomID:e.roomID,roomSessionID:e.roomSessionID})},e.prototype.heartBeat=function(e,t,r,i,n){return this.sendMessage("hb",{reserve:0},e,t,void 0,{sessionID:r,roomID:i,roomSessionID:n})},e.prototype.fetchUserList=function(e,t,r,i,n,o){return this.sendMessage("user_list",e,t,r,void 0,{sessionID:i,roomID:n,roomSessionID:o})},e.prototype.fetchUserListV2=function(e,t,r,i,n,o){return this.sendMessage("user_list_v2",e,t,r,void 0,{sessionID:i,roomID:n,roomSessionID:o})},e.prototype.fetchReliableMessage=function(e,t,r,i,n,o){return this.sendMessage("trans_fetch",e,t,r,void 0,{sessionID:i,roomID:n,roomSessionID:o})},e.prototype.sendReliableMessage=function(e,t,r,i,n,o){return this.sendMessage("trans",e,t,r,void 0,{sessionID:i,roomID:n,roomSessionID:o})},e.prototype.sendRoomMsg=function(e,t,r,i,n,o){return this.sendMessage("im_chat",e,t,r,void 0,{sessionID:i,roomID:n,roomSessionID:o})},e.prototype.sendCustomCommand=function(e,t,r,i,n,o){return this.sendMessage("custommsg",e,t,r,void 0,{sessionID:i,roomID:n,roomSessionID:o})},e.prototype.sendBigRoomMessage=function(e,t,r,i,n,o){return this.sendMessage("bigim_chat",e,t,r,void 0,{sessionID:i,roomID:n,roomSessionID:o})},e.prototype.sendRelayMessage=function(e,t,r,i,n,o){return this.sendMessage("relay",e,t,r,void 0,{sessionID:i,roomID:n,roomSessionID:o})},e.prototype.sendSignalCmd=function(e,t,r,i,n,o){return this.sendMessage("signal",e,t,r,void 0,{sessionID:i,roomID:n,roomSessionID:o})},e.prototype.sendPB=function(e){return this.service.isDisConnect()||this.stateCenter.networkState==o.ENUM_NETWORK_STATE.offline?(this.logger.error(a.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_PB+" socket is disconnected"),!1):this.service.sendPB(e)},e}();t.LiveRoomService=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoSocketService=void 0;var i=r(0),n=r(1),o=function(){function e(e){this.socket=null,this.sendCommandList=new i.LinkedList,this.sendCommandMap={},this.sendDataCheckOnceCount=100,this.sendDataDropTimeout=1e4,this.sendDataCheckInterval=2e3,this.ENV=e}return e.prototype.createSocket=function(e){this.socket=i.createZegoWebSocket(e,this.ENV%2)},e.prototype.closeSocket=function(){this.socket&&(this.socket.onclose=null,this.socket.onerror=null,this.socket.close(),this.socket=null)},e.prototype.isDisConnect=function(){return!this.socket||1!==this.socket.readyState},e.prototype.sendMessage=function(e,t,r,i,n){void 0===r&&(r=null),void 0===i&&(i=null),void 0===n&&(n={timeOut:6e3});var o={header:e,body:t},s={data:o,seq:e.seq,deleted:!1,sendTime:Date.parse(new Date+""),timeOut:n.timeOut,success:r,error:i},a=this.sendCommandList.push(s);return this.sendCommandMap[s.seq]=a,this.socket&&this.socket.send(JSON.stringify(o)),e.seq},e.prototype.sendPB=function(e){return this.socket&&this.socket.send(e),!0},e.prototype.checkSendMessageList=function(e){for(var t=e.getFirst();null!=t;)e.remove(t),t._data&&t._data.error&&setTimeout((function(){t&&t._data&&t._data.error&&t._data.error(n.errorCodeList.TIMEOUT,t._data.data.header.seq,t._data.data.body.custom_msg)}),0),t=e.getFirst()},e.prototype.checkMessageListTimeout=function(e,t){for(var r=e.getFirst(),i=Date.parse(new Date+""),o=0;!(null==r||r._data&&r._data.sendTime+r._data.timeOut>i||(r._data&&delete t[r._data.data.header.seq],e.remove(r),r._data&&null==r._data.error||r._data&&r._data.sendTime+this.sendDataDropTimeout<i||setTimeout((function(){r&&r._data&&r._data.error&&r._data.error(n.errorCodeList.TIMEOUT,r._data.data.header.seq,r._data.data.body.custom_msg)}),0),++o>=this.sendDataCheckOnceCount));)r=e.getFirst()},e.prototype.startCheck=function(){var e=this;this.checkMessageListTimeout(this.sendCommandList,this.sendCommandMap),this.sendDataCheckTimer=setTimeout((function(){e.startCheck()}),this.sendDataCheckInterval)},e.prototype.stopCheck=function(){this.checkSendMessageList(this.sendCommandList),clearTimeout(this.sendDataCheckTimer)},e.prototype.openHandler=function(e){var t=this;this.socket&&(this.socket.onopen=function(r){t.socket.binaryType="arraybuffer",t.responseHandler(),e(r)})},e.prototype.responseHandler=function(){var e=this;this.socket&&(this.socket.onmessage=function(t){var r="string"==typeof t.data?JSON.parse(t.data):t.data;e.onMessage(r)})},e.prototype.closeHandler=function(e){this.socket&&(this.socket.onclose=function(t){e(t)})},e.prototype.errorHandler=function(e){this.socket&&(this.socket.onerror=e)},e.prototype.onMessage=function(e){},e}();t.ZegoSocketService=o},,,,,,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoExpressWebRTM=t.ZegoDataReport=t.ZegoLogger=t.getSeq=t.getReportSeq=t.ZegoExpressWebRTMEngine=void 0;var i=r(20);Object.defineProperty(t,"ZegoExpressWebRTM",{enumerable:!0,get:function(){return i.ZegoExpressWebRTM}});var n=r(33),o=r(0),s=function(){function e(t,r,s){void 0===s&&(s=0),this.logger=new o.ZegoLogger(s),this.dataReport=new o.ZegoDataReport(this.logger),this.cloudSetting=new n.ZegoSetting,this.zegoWebRTM=new i.ZegoExpressWebRTM(t,r,this.logger,this.dataReport,this.cloudSetting,e.version,s)}return e.prototype.enableMultiRoom=function(e){return this.zegoWebRTM.enableMultiRoom(e)},e.prototype.loginRoom=function(e,t,r,i){return this.zegoWebRTM.loginRoom(e,t,r,i)},e.prototype.logoutRoom=function(e){return this.zegoWebRTM.logoutRoom(e)},e.prototype.renewToken=function(e,t){return this.zegoWebRTM.renewToken(e,t)},e.prototype.sendBarrageMessage=function(e,t){return this.zegoWebRTM.sendBarrageMessage(e,t)},e.prototype.sendBroadcastMessage=function(e,t){return this.zegoWebRTM.sendBroadcastMessage(e,t)},e.prototype.sendCustomCommand=function(e,t,r){return this.zegoWebRTM.sendCustomCommand(e,t,r)},e.prototype.setRoomExtraInfo=function(e,t,r){return this.zegoWebRTM.setRoomExtraInfo(e,t,r)},e.prototype.setLogConfig=function(e){return this.zegoWebRTM.setLogConfig(e)},e.prototype.setDebugVerbose=function(e){return this.zegoWebRTM.setDebugVerbose(e)},e.prototype.on=function(e,t){return this.zegoWebRTM.on(e,t)},e.prototype.getVersion=function(){return this.zegoWebRTM.getVersion()},e.prototype.off=function(e,t){return this.zegoWebRTM.off(e,t)},e.prototype.loginHall=function(e,t,r){return this.zegoWebRTM.loginHall(e,t,r)},e.prototype.logoutHall=function(){return this.zegoWebRTM.logoutHall()},e.prototype.enterRoom=function(e,t){return this.zegoWebRTM.enterRoom(e,t)},e.prototype.leaveRoom=function(){return this.zegoWebRTM.leaveRoom()},e.use=function(e){i.ZegoExpressWebRTM.use(e)},e.version=o.PROTO_VERSION,e}();t.ZegoExpressWebRTMEngine=s;var a=r(0);Object.defineProperty(t,"getReportSeq",{enumerable:!0,get:function(){return a.getReportSeq}}),Object.defineProperty(t,"getSeq",{enumerable:!0,get:function(){return a.getSeq}}),Object.defineProperty(t,"ZegoLogger",{enumerable:!0,get:function(){return a.ZegoLogger}}),Object.defineProperty(t,"ZegoDataReport",{enumerable:!0,get:function(){return a.ZegoDataReport}})},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(n=s.trys,!((n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},o=this&&this.__spreadArray||function(e,t){for(var r=0,i=t.length,n=e.length;r<i;r++,n++)e[n]=t[r];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoExpressWebRTM=void 0;var s=r(0),a=r(1),c=r(2),l=r(0),u=r(23),d=r(24),h=r(26),p=r(27),f=r(28),g=r(30),m=r(3),_=r(4),v=r(11),E=r(31),A=r(32),y=function(){function e(e,t,r,i,n,o,a){var d=this;this.logger=r,this.dataReport=i,this.cloudSetting=n,this.version=o,this.stateCenter=new p.StateCenter(this.logger,this.dataReport),this.stateCenter.ENV=a,this.getReportSeq=l.getReportSeq,this.getSeq=s.getSeq,this.proxyRes=c.ClientUtil.proxyRes,this.actionSuccessCallback=c.ClientUtil.actionSuccessCallback,this.actionErrorCallback=c.ClientUtil.actionErrorCallback,this.getServerError=c.ClientUtil.getServerError,this.generateRandumNumber=c.ClientUtil.generateRandumNumber,this.unregisterCallback=c.ClientUtil.unregisterCallback,this.logReportCallback=c.ClientUtil.logReportCallback,this.registerCallback=c.ClientUtil.registerCallback;var h=l.getReportSeq();if(this.dataReport.newReport(h),(0==a||1==a)&&this.setDebug(t),c.ClientUtil.checkConfigParam(e,t,this.logger)){if(this.stateCenter.appid=e,this.stateCenter.configOK=!0,this.stateCenter.sdKVersion=this.version,0==a||1==a){this.stateCenter.settingConfig=new A.ZegoSettingConfig,this.cloudSetting.setLog(this.logger),this.cloudSetting.init({product:u.CLOUD_SETTING.product,appID:e,urls:u.CLOUD_SETTING.URL,pollingFreq:u.CLOUD_SETTING.POLLING_FREQ,env:a,pollingNotify:function(e,t){d.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_CONSTRUCTOR," setting file changed "+e+" "+JSON.stringify(t)),d.stateCenter.actionListener("_cloudSettingNotify",e,t)},reportNotify:this.cloudReportNotify.bind(this),online:!this.stateCenter.testEnvironment});var f="";0===a?f="rtc":1===a&&(f="xcx"),this.cloudSetting.setEnvVariable("environment",f);var y=this.cloudSetting.getSettingCache(u.INIT),S=this.cloudSetting.getSettingCache(u.ROOM_BASIC);Promise.all([y,S]).then((function(e){var t=null==e?void 0:e[0];d.stateCenter.settingConfig.setSetting(null==t?void 0:t.setting);var r=d.stateCenter.settingConfig.getSetting("remote_log_level",!0);r&&(d.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_CONSTRUCTOR+"  setting remote_log_level "+r),d.logger.setRemoteLogLevel(r));var i=null==e?void 0:e[1];d.stateCenter.settingConfig.setSetting(null==i?void 0:i.setting);var n=l.getReportSeq();d.dataReport.newReport(n,_.ZegoRTMLogEvent.kZegoTaskCloudSettingCache.event),d.dataReport.addMsgInfo(n,{files:[{name:u.INIT,content:null==t?void 0:t.setting,versions:null==t?void 0:t.versions},{name:u.ROOM_BASIC,content:null==i?void 0:i.setting,versions:null==i?void 0:i.versions}]}),d.dataReport.uploadReport(n)})).catch((function(e){d.logger.warn(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_CONSTRUCTOR+"  initConfig "+JSON.stringify(e))})),"string"==typeof t?(this.stateCenter.server=t,this.stateCenter.serverBak=t):Array.isArray(t)&&t.length>0&&(this.stateCenter.server=t[0],this.stateCenter.serverBak=t[1]||t[0]),this.service=new v.LiveRoomService(this.stateCenter,this.logger,this)}else 2!=a&&3!=a||(this.service=new E.LiveRoomPrivateService(this.stateCenter,this.logger,this),this.module=new g.LiveRoomModules(this.stateCenter,this.logger,this.dataReport,this.service,this),this.stateCenter.priModules=this.module,this.module._dispatchServer=t,this.stateCenter.type="PRIVATE");if(0==a||2==a)this.bindWindowListener(),this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_CONSTRUCTOR+"  "+navigator.appVersion),this.stateCenter.networkState=navigator?navigator.onLine?s.ENUM_NETWORK_STATE.online:s.ENUM_NETWORK_STATE.offline:s.ENUM_NETWORK_STATE.online,this.dataReport.addMsgInfo(h,{system_info:_.ZegoRTMLogEvent.kZegoTaskInitSetting.system_info});else if(1==a||3==a){this.bindWxListener();try{var C=wx.getSystemInfoSync(),T={brand:C.brand,model:C.model,system:C.system,platform:C.platform,version:C.version,SDKVersion:C.SDKVersion};this.dataReport.addMsgInfo(h,{system_info:T})}catch(e){this.logger.warn(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_CONSTRUCTOR+" get system info error")}}this.logger.setSessionInfo(this.stateCenter.appid,"","","","",this.version)}else this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_CONSTRUCTOR+" init sdk error"),this.dataReport.addMsgInfo(h,_.ZegoRTMLogEvent.kZegoTaskInitSetting.error.kInvalidParamError);this.dataReport.uploadReport(h,_.ZegoRTMLogEvent.kZegoTaskInitSetting.event)}return Object.defineProperty(e.prototype,"modules",{get:function(){return{service:this.service}},enumerable:!1,configurable:!0}),e.prototype.bindWindowListener=function(){var e=this,t=navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i),r=c.ClientUtil.getBrowser(),i=t?"pagehide":"Firefox"===r?"beforeunload":"unload";window.addEventListener(i,(function(){e.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_BIND_WINDOW_LISTENER+" "+i),"PUBLIC"===e.stateCenter.type?e.logoutRoom():e.leaveRoom(),e.logoutRoom()})),window.addEventListener("offline",(function(){e.netOffLineHandle()})),window.addEventListener("online",(function(){e.netOnLineHandle()}))},e.prototype.bindWxListener=function(){var e=this;wx.onNetworkStatusChange((function(t){t.isConnected?e.netOnLineHandle():e.netOffLineHandle()}))},e.prototype.netOnLineHandle=function(){var e=this;this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_BIND_WINDOW_LISTENER+"network is online"),this.stateCenter.networkState=s.ENUM_NETWORK_STATE.online,this.stateCenter.roomModulesList.forEach((function(t){t.roomTryHandler&&e.service.isDisConnect()?t.roomTryHandler.active():t.roomTryHandler&&(t.roomTryHandler.stopMaxTime(),t.roomHandler.roomStateHandle("CONNECTED",{code:0,msg:""}))}))},e.prototype.netOffLineHandle=function(){this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_BIND_WINDOW_LISTENER+" network is broken"),this.stateCenter.networkState=s.ENUM_NETWORK_STATE.offline,this.stateCenter.roomModulesList.forEach((function(e){e.roomTryHandler&&(e.roomTryHandler.invalid(),e.roomTryHandler.onactive=function(t,r){e.roomHandler.disconnectedHandle(r)},e.roomTryHandler.startMaxTime(),e.roomHandler.roomStateHandle("CONNECTING",a.errorCodeList.NETWORK_BROKEN))}))},e.prototype.setLogConfig=function(e){this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SET_LOG_CONFIG+" call");var t=l.getReportSeq();if(this.dataReport.newReport(t),e.logLevel&&["debug","info","warn","error","report","disable"].includes(e.logLevel)&&(this.logger.setLogLevel(e.logLevel),this.dataReport.addMsgInfo(t,{log_level:_.ZegoRTMLogEvent.kZegoTaskSetLog.log_level(e.logLevel)})),e.remoteLogLevel&&["debug","info","warn","error","report","disable"].includes(e.remoteLogLevel)&&this.dataReport.addMsgInfo(t,{remote_log_level:_.ZegoRTMLogEvent.kZegoTaskSetLog.remote_log_level(e.remoteLogLevel)}),"string"==typeof e.logURL&&(e.logURL.startsWith("wss://")||e.logURL.startsWith("https://")))this.logger.setLogServer(e.logURL),this.dataReport.addMsgInfo(t,{log_url:_.ZegoRTMLogEvent.kZegoTaskSetLog.log_url(e.logURL)}),this.dataReport.uploadReport(t,_.ZegoRTMLogEvent.kZegoTaskSetLog.event);else if(e.logURL)return this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SET_LOG_CONFIG+"log url must be a wss or https url"),this.dataReport.addMsgInfo(t,_.ZegoRTMLogEvent.kZegoTaskSetLog.error.kInvalidParamError),this.dataReport.uploadReport(t,_.ZegoRTMLogEvent.kZegoTaskSetLog.event),!1;return this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SET_LOG_CONFIG+" call success"),!0},e.prototype.setDebugVerbose=function(e){var t=l.getReportSeq();this.dataReport.newReport(t),"boolean"==typeof e&&(this.stateCenter.debug=e,this.stateCenter.debugCustom=!0,this.dataReport.addMsgInfo(t,{debug:_.ZegoRTMLogEvent.kZegoTaskSetDebug.debug(e?"true":"false")})),this.dataReport.uploadReport(t,_.ZegoRTMLogEvent.kZegoTaskSetDebug.event),this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SET_DEBUG_VERBOSE+" call success")},e.prototype.setDebug=function(e){"string"==typeof e&&e.indexOf("wss")>-1?this.stateCenter.debug=c.ClientUtil.isTestEnv(e):Array.isArray(e)&&e.length>0&&e.every((function(e){return"string"==typeof e&&e.indexOf("wss")>-1}))?this.stateCenter.debug=c.ClientUtil.isTestEnv(e[0])||c.ClientUtil.isTestEnv(e[1]):this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_CONSTRUCTOR+" server wrong"),this.stateCenter.testEnvironment=this.stateCenter.debug},e.prototype.renewToken=function(e,t){var r,i=this,n=l.getReportSeq();if(this.dataReport.newReport(n),void 0!==t&&("string"!=typeof t||""==t))return this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_RENEWTOKEN+" roomID must be string and no empty"),!1;var o=this.getRoomModules(t)||this.stateCenter.roomModulesList[0];return o?"string"==typeof e&&o.roomTryHandler?(e===o.roomTryHandler.token?this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_RENEWTOKEN+" token has not changed"):(null===(r=o.roomTryHandler)||void 0===r||r.renewLocalToken(e),this.service.sendMessage("renew_token",{token:e},(function(t){var r,n;null===(r=o.roomTryHandler)||void 0===r||r.renewLocalToken(e,null===(n=null==t?void 0:t.body)||void 0===n?void 0:n.token_remain_time),i.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_RENEWTOKEN+" "+JSON.stringify(t))}),(function(e){i.logger.warn(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_RENEWTOKEN+" "+JSON.stringify(e))}),void 0,{sessionID:o.sessionID,roomID:t,roomSessionID:o.roomSessionID}),this.cloudSetting.setToken(e)),this.dataReport.uploadReport(n,_.ZegoRTMLogEvent.kZegoTaskReNewToken.event),!0):"string"!=typeof e||o.roomTryHandler?(this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_RENEWTOKEN+" token must be string and not empty"),this.dataReport.addMsgInfo(n,{error:_.ZegoRTMLogEvent.kZegoTaskReNewToken.error.INPUT_PARAM.code,message:_.ZegoRTMLogEvent.kZegoTaskReNewToken.error.INPUT_PARAM.msg+" param token error"}),this.dataReport.uploadReport(n,_.ZegoRTMLogEvent.kZegoTaskReNewToken.event),!1):(this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_RENEWTOKEN+" calling must after loginRoom"),this.dataReport.addMsgInfo(n,{error:_.ZegoRTMLogEvent.kZegoTaskReNewToken.error.NOT_LOGIN.code,message:_.ZegoRTMLogEvent.kZegoTaskReNewToken.error.NOT_LOGIN.msg}),this.dataReport.uploadReport(n,_.ZegoRTMLogEvent.kZegoTaskReNewToken.event),!1):(this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_RENEWTOKEN+" calling must after loginRoom"),this.dataReport.addMsgInfo(n,{error:_.ZegoRTMLogEvent.kZegoTaskReNewToken.error.NOT_LOGIN.code,message:_.ZegoRTMLogEvent.kZegoTaskReNewToken.error.NOT_LOGIN.msg}),this.dataReport.uploadReport(n,_.ZegoRTMLogEvent.kZegoTaskReNewToken.event),!1)},e.prototype.setCloudSettingURLs=function(e){var t=this;this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SET_CLOUD_SETTING_URLS+" call "),Array.isArray(e)&&e.length>0&&e.every((function(e){return"string"==typeof e&&e.indexOf("http")>-1}))&&this.cloudSetting.init({product:u.CLOUD_SETTING.product,appID:this.stateCenter.appid,urls:e,pollingFreq:u.CLOUD_SETTING.POLLING_FREQ,env:this.stateCenter.ENV,pollingNotify:function(e,r){t.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SET_CLOUD_SETTING_URLS," setting file changed "+e+" "+JSON.stringify(r)),t.stateCenter.actionListener("_cloudSettingNotify",e,r)},reportNotify:this.cloudReportNotify.bind(this),online:!this.stateCenter.testEnvironment})},e.prototype.loginRoom=function(e,t,r,a){var c=this;return new Promise((function(l,u){return i(c,void 0,void 0,(function(){var i,c,p,g,v,E,A=this;return n(this,(function(n){switch(n.label){case 0:return 1!==this.stateCenter.ENV?[3,2]:[4,new Promise((function(e){wx.getNetworkType({success:function(t){A.stateCenter.networkState="none"===t.networkType?s.ENUM_NETWORK_STATE.offline:s.ENUM_NETWORK_STATE.online,e()},fail:function(t){A.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_CONSTRUCTOR+" network "+JSON.stringify(t)),A.stateCenter.networkState=s.ENUM_NETWORK_STATE.online,e()}})}))];case 1:n.sent(),n.label=2;case 2:return i=this.loginReport(l,u,t,a),c=i.interResolve,p=i.interReject,!(a=a||{}).maxMemberCount&&(a.maxMemberCount=0),(g=h.checkParams({roomID:{order:0,value:e,rules:[{name:h.RULE_PARAM_NAME.NOT_EMPTY,error:_.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.ROOM_ID_NULL},{name:h.RULE_PARAM_NAME.TYPE_STRING,error:_.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.INPUT_PARAM,extMsg:"roomID must be string"},{name:h.RULE_PARAM_NAME.MAX_LENGTH_128,error:_.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.ROOM_ID_TOO_LONG},{name:h.RULE_PARAM_NAME.ILLEGAL_CHARACTERS,error:_.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.ROOM_ID_INVALID_CHARACTER}]},token:{order:1,value:t,rules:[{name:h.RULE_PARAM_NAME.NOT_EMPTY,error:_.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.INPUT_PARAM},{name:h.RULE_PARAM_NAME.TYPE_STRING,error:_.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.INPUT_PARAM}]},user:{order:2,value:r,rules:[{name:h.RULE_PARAM_NAME.NOT_EMPTY,error:_.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.INPUT_PARAM,extMsg:" param user error."},{name:h.RULE_PARAM_NAME.TYPE_OBJECT,error:_.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.INPUT_PARAM,extMsg:" param user error."}]},"user.userID":{order:3,value:r.userID,rules:[{name:h.RULE_PARAM_NAME.NOT_EMPTY,error:_.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.USER_ID_NULL,extMsg:" param user error."},{name:h.RULE_PARAM_NAME.TYPE_STRING,error:_.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.INPUT_PARAM,extMsg:" param userID error."},{name:h.RULE_PARAM_NAME.MAX_LENGTH_100,error:_.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.USER_ID_TOO_LONG},{name:h.RULE_PARAM_NAME.ILLEGAL_CHARACTERS,error:_.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.USER_ID_INVALID_CHARACTER}]},"user.userName":{order:4,value:r.userName,rules:[{name:h.RULE_PARAM_NAME.TYPE_STRING,error:_.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.INPUT_PARAM,extMsg:" userName must be string."},{name:h.RULE_PARAM_NAME.MAX_LENGTH_256,error:_.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.USER_NAME_TOO_LONG}]},config:{order:5,value:a,rules:[]},"config.maxMemberCount":{order:6,value:a.maxMemberCount,rules:[{name:h.RULE_PARAM_NAME.TYPE_INTEGER,error:_.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.INPUT_PARAM,extMsg:" maxMemberCount must be integer number."}]}},{action:m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_LOGIN_ROOM,logger:this.logger}))!==h.RULE_SUCCESS?(p(g.error,g.extMsg),[2]):(this.cloudSetting.setUserID(r.userID),this.cloudSetting.setToken(t),this.cloudSetting.activePolling(),this.stateCenter.onListener("roomLoginResponse",(function(e){A.stateCenter.settingFetched||(A.getCloudSetting(),A.stateCenter.actionListener("_settingCanFetch"),A.stateCenter.settingFetched=!0)})),(v=this.getRoomModules(e))?(p(_.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.REPEATEDLY_LOGIN),[2]):(v=new f.LiveRoomModules(e,this.stateCenter,this.logger,this.dataReport,this.service,this),this.stateCenter.roomModulesList.length>0&&1==this.stateCenter.isMultiRoom?v.isMulti=!0:o([],this.stateCenter.roomModulesList).forEach((function(e){return e.roomHandler.logout()})),this.stateCenter.roomModulesList.push(v),v.roomTryHandler||(v.roomTryHandler=new d.RetryRoomHandler(this.logger,this.stateCenter,v)),E=this.stateCenter.settingConfig.getSetting("room_server",!0),Array.isArray(E)&&E.length>0&&(this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_LOGIN_ROOM," setting room_server "+E),this.stateCenter.server=E[0],this.stateCenter.serverBak=E[1]||E[0]),v.roomTryHandler.init(this.stateCenter.roomRetryTime),v.roomTryHandler.initRoom(v.roomHandler,e,t,r,this.stateCenter.server,this.stateCenter.serverBak,a),v.roomTryHandler.setLoginRoomCallback(c,p),v.roomTryHandler.active(!0),this.stateCenter.setMultiRoom=!0,[2]))}}))}))}))},e.prototype.getCloudSetting=function(){var e=this;this.cloudSetting.fetchMultiSetting([u.INIT,u.ROOM_BASIC]).then((function(t){var r;e.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_LOGIN_ROOM," settingConfig "+JSON.stringify(t)),e.stateCenter.settingConfig.setSetting(null===(r=null==t?void 0:t[u.INIT])||void 0===r?void 0:r.setting,["remote_log_level"]);var i=e.stateCenter.settingConfig.getSetting("remote_log_level",!0);i&&(e.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_LOGIN_ROOM+"  setting remote_log_level "+i),e.logger.setRemoteLogLevel(i))})).catch((function(t){e.logger.warn(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_LOGIN_ROOM," settingConfig "+JSON.stringify(t))})),this.stateCenter.onListener("_cloudSettingNotify",(function(t,r){var i=l.getReportSeq();e.dataReport.newReport(i,_.ZegoRTMLogEvent.kZegoTaskCloudSettingRefresh.event);var n=e.cloudSetting.getEnvVariables();if(e.dataReport.addMsgInfo(i,{params:n,files:[{name:t,content:r.setting,versions:r.versions}]}),e.dataReport.uploadReport(i),t===u.INIT){e.stateCenter.settingConfig.setSetting(null==r?void 0:r.setting,["remote_log_level"]);var o=e.stateCenter.settingConfig.getSetting("remote_log_level");o&&(e.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_LOGIN_ROOM," setting remote_log_level "+o),e.logger.setRemoteLogLevel(o))}}))},e.prototype.cloudReportNotify=function(e,t,r){if("request_start"===t){var i=l.getReportSeq();this.dataReport.newReport(i,_.ZegoRTMLogEvent.kZegoTaskCloudSettingRequest.event),this.stateCenter.settingConfig.requestList[e]=i}else if("request_end"===t){var n=this.stateCenter.settingConfig.requestList[e];n&&(this.dataReport.addMsgInfo(n,{request_detail:null==r?void 0:r.reportData,files:null==r?void 0:r.files,error:null==r?void 0:r.code,request_params:null==r?void 0:r.params}),this.dataReport.uploadReport(n))}},e.prototype.loginReport=function(e,t,r,i){var n=this;0!==this.stateCenter.reportSeqList.login&&(this.dataReport.uploadReport(this.stateCenter.reportSeqList.login),this.stateCenter.reportSeqList.login=0,c.ClientUtil.unregisterCallback(_.ZegoRTMLogEvent.kZegoTaskLoginRoom.event,this.stateCenter.reportList));var o=l.getReportSeq();this.stateCenter.reportSeqList.login=o,this.dataReport.newReport(o,_.ZegoRTMLogEvent.kZegoTaskLoginRoom.event);var s=this.cloudSetting.getEnvVariable("deviceid");return this.dataReport.addMsgInfo(o,{deviceid:s}),"string"==typeof r&&this.dataReport.addMsgInfo(o,{token:_.ZegoRTMLogEvent.kZegoTaskLoginRoom.token(r),isMulti:this.stateCenter.isMultiRoom}),i&&(i.userUpdate&&"boolean"==typeof i.userUpdate&&this.dataReport.addMsgInfo(o,{user_update:_.ZegoRTMLogEvent.kZegoTaskLoginRoom.user_update(i.userUpdate+"")}),i.maxMemberCount&&"number"==typeof i.maxMemberCount&&this.dataReport.addMsgInfo(o,{max_member_count:_.ZegoRTMLogEvent.kZegoTaskLoginRoom.max_member_count(i.maxMemberCount+"")})),c.ClientUtil.logReportCallback(_.ZegoRTMLogEvent.kZegoTaskLoginRoom.event,this.dataReport,o,this.stateCenter.reportList),{interResolve:function(t){n.dataReport.uploadReport(o),n.stateCenter.reportSeqList.login=0,c.ClientUtil.unregisterCallback(_.ZegoRTMLogEvent.kZegoTaskLoginRoom.event,n.stateCenter.reportList),e(t)},interReject:function(e,r){var i,s;void 0===r&&(r=""),e.code<2e9&&e.code>1e9||e.code<1e6?(i=c.ClientUtil.decodeServerError(e.code,e.msg),s=c.ClientUtil.getLiveRoomError(e.code)):i={code:e.code,message:e.msg},i&&n.dataReport.addMsgInfo(o,{error:i.code,message:i.message+r}),n.dataReport.uploadReport(o),n.stateCenter.reportSeqList.login=0,c.ClientUtil.unregisterCallback(_.ZegoRTMLogEvent.kZegoTaskLoginRoom.event,n.stateCenter.reportList),s&&a.errorCodeList[s]&&(e.code=a.errorCodeList[s].code),e.code&&e.msg&&""!==r?t({code:e.code,msg:e.msg+r}):t(e)}}},e.prototype.logoutRoom=function(e){var t=l.getReportSeq();if(this.dataReport.newReport(t),this.dataReport.addMsgInfo(t,{roomid:e,isMulti:this.stateCenter.isMultiRoom}),void 0===e)o([],this.stateCenter.roomModulesList).forEach((function(e){return e.roomHandler.logout(!0)})),this.cloudSetting.uninit();else{if("string"!=typeof e||""==e)return this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_LOGOUT_ROOM+" roomID must be string and not empty"),this.dataReport.addMsgInfo(t,{error:_.ZegoRTMLogEvent.kZegoTaskLogoutRoom.error.INPUT_PARAM.code,message:_.ZegoRTMLogEvent.kZegoTaskLogoutRoom.error.INPUT_PARAM.msg+" param roomID error"}),void this.dataReport.uploadReport(t,_.ZegoRTMLogEvent.kZegoTaskLogoutRoom.event);var r=this.getRoomModules(e);r?(r.roomHandler.logout(),0===this.stateCenter.roomModulesList.length&&this.cloudSetting.uninit(),this.dataReport.uploadReport(t,_.ZegoRTMLogEvent.kZegoTaskLogoutRoom.event)):(this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_LOGOUT_ROOM+" room not exist"),this.dataReport.addMsgInfo(t,{error:_.ZegoRTMLogEvent.kZegoTaskLogoutRoom.error.ROOM_NOT_EXIST.code,message:_.ZegoRTMLogEvent.kZegoTaskLogoutRoom.error.ROOM_NOT_EXIST.msg}),this.dataReport.uploadReport(t,_.ZegoRTMLogEvent.kZegoTaskLogoutRoom.event))}},e.prototype.loginHall=function(e,t,r){var o=this;return new Promise((function(e,t){return i(o,void 0,void 0,(function(){return n(this,(function(e){return[2]}))}))}))},e.prototype.loginHallReport=function(e,t,r,i){},e.prototype.logoutHall=function(){},e.prototype.enterRoom=function(e,t){return new Promise((function(e,t){console.error(s.MODULE_TIPS.MESSAGE),t()}))},e.prototype.leaveRoom=function(){return new Promise((function(e,t){console.error(s.MODULE_TIPS.MESSAGE),t()}))},e.prototype.sendCustomCommand=function(e,t,r){return new Promise((function(e,t){console.error(s.MODULE_TIPS.MESSAGE),t()}))},e.prototype._sendCustomCommand=function(e,t,r){return new Promise((function(e,t){console.error(s.MODULE_TIPS.MESSAGE),t()}))},e.prototype.sendBroadcastMessage=function(e,t){return new Promise((function(e,t){console.error(s.MODULE_TIPS.MESSAGE),t()}))},e.prototype._sendBroadcastMessage=function(e,t,r,i){return void 0===r&&(r=1),void 0===i&&(i=1),new Promise((function(e,t){console.error(s.MODULE_TIPS.MESSAGE),t()}))},e.prototype.setRoomExtraInfo=function(e,t,r){return new Promise((function(e,t){console.error(s.MODULE_TIPS.MESSAGE),t()}))},e.prototype._setRoomExtraInfo=function(e,t,r){return new Promise((function(e,t){console.error(s.MODULE_TIPS.MESSAGE),t()}))},e.prototype.sendBarrageMessage=function(e,t){return new Promise((function(e,t){console.error(s.MODULE_TIPS.MESSAGE),t()}))},e.prototype._sendBarrageMessage=function(e,t,r,i){return void 0===r&&(r=1),void 0===i&&(i=1),new Promise((function(e,t){console.error(s.MODULE_TIPS.MESSAGE),t()}))},e.prototype.sendRelayMessage=function(e,t,r,i,n){console.error(s.MODULE_TIPS.MESSAGE)},e.prototype.requestJoinLive=function(e,t,r,i,n){return console.error(s.MODULE_TIPS.MESSAGE),!1},e.prototype.inviteJoinLive=function(e,t,r,i,n){return console.error(s.MODULE_TIPS.MESSAGE),!1},e.prototype.endJoinLive=function(e,t,r,i){return console.error(s.MODULE_TIPS.MESSAGE),!1},e.prototype.respondJoinLive=function(e,t,r,i,n){return console.error(s.MODULE_TIPS.MESSAGE),!1},e.prototype.getVersion=function(){return this.version},e.prototype.setSdkBizVersion=function(e){"string"==typeof e&&""!==e&&(this.stateCenter.bizVersion=e)},e.prototype.on=function(e,t){return this.stateCenter.listenerList[e]?"function"!=typeof t?(this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_ON+" listener callBack must be funciton"),!1):(-1==this.stateCenter.listenerList[e].indexOf(t)&&this.stateCenter.listenerList[e].push(t),!0):(this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_ON+" event "+e+" no found"),!1)},e.prototype.off=function(e,t){if(!this.stateCenter.listenerList[e])return this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_OFF+" listener no found"),!1;var r=this.stateCenter.listenerList[e];return t?r.splice(r.indexOf(t),1):this.stateCenter.listenerList[e]=[],!0},e.prototype._on=function(e,t){return this.stateCenter.listenerList[e]?"function"!=typeof t?(this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_ON+" listener callBack must be funciton"),!1):(-1==this.stateCenter.listenerList[e].indexOf(t)&&this.stateCenter.listenerList[e].push(t),!0):(this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_ON+" event "+e+" no found"),!1)},e.prototype._off=function(e,t){if(!this.stateCenter.listenerList[e])return this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_OFF+" listener no found"),!1;var r=this.stateCenter.listenerList[e];return t?r.splice(r.indexOf(t),1):this.stateCenter.listenerList[e]=[],!0},e.prototype.isTestEnvironment=function(){return this.stateCenter.testEnvironment},e.prototype.isLogin=function(e){var t=this.getRoomModules(e)||this.stateCenter.roomModulesList[0];return!!t&&t.isLogin()},e.prototype.getMultiRoom=function(){return this.stateCenter.isMultiRoom},e.prototype.getAppID=function(){return this.stateCenter.appid},e.prototype.getUserID=function(){return this.stateCenter.idName},e.prototype.getToken=function(e){return(this.getRoomModules(e)||this.stateCenter.roomModulesList[0]).token},e.prototype.getAnType=function(){return this.module.anType},e.prototype.getRoomSid=function(){return this.module.roomSid},e.prototype.setRoomCreateFlag=function(e){this.stateCenter.roomCreateFlag=e},e.prototype.setRole=function(e){this.stateCenter.role=e},e.prototype.getSessionId=function(e){var t=this.getRoomModules(e)||this.stateCenter.roomModulesList[0];return t?t.sessionID:"0"},e.prototype.getRoomSessionID=function(e){var t=this.getRoomModules(e)||this.stateCenter.roomModulesList[0];return t?t.roomSessionID:"0"},e.prototype.enableMultiRoom=function(e){var t=l.getReportSeq();return this.dataReport.newReport(t,_.ZegoRTMLogEvent.kZegoEnableMultiRoom.event),this.dataReport.addMsgInfo(t,{isMulti:e}),"boolean"!=typeof e?(this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_ENABLE_MULTI_ROOM+" param must be boolean"),this.dataReport.uploadReport(t,void 0,_.ZegoRTMLogEvent.kZegoEnableMultiRoom.error.kAlreadyLoginError),!1):this.stateCenter.roomModulesList.length>0||this.stateCenter.setMultiRoom?(this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_ENABLE_MULTI_ROOM+" multi room can only be set once before first login"),this.dataReport.uploadReport(t,void 0,_.ZegoRTMLogEvent.kZegoEnableMultiRoom.error.kAlreadyLoginError),!1):(this.dataReport.uploadReport(t),this.stateCenter.isMultiRoom=e,this.stateCenter.setMultiRoom=!0,!0)},e.prototype.getRoomModules=function(e){return this.stateCenter.roomModulesList.find((function(t){return t.roomID==e}))},e.prototype.dispatchBodyData=function(){return{seq:1,timestamp:(new Date).getTime,app_id:this.stateCenter.appid,user_id:this.stateCenter.idName,user_name:this.stateCenter.nickName,net_type:2,device_id:this.module.deviceID,login_token:this.module.hallToken,an_type:this.module.anType}},e.use=function(t){switch(t.type){case"message":t.install(e,f.LiveRoomModules,v.LiveRoomService,g.LiveRoomModules,E.LiveRoomPrivateService);break;case"live":t.install(e,f.LiveRoomModules,v.LiveRoomService);break;case"privates":t.install(e,g.LiveRoomModules,E.LiveRoomPrivateService)}},e.prototype.resetRoomTokenTimer=function(e,t){var r=this.getRoomModules(e)||this.stateCenter.roomModulesList[0];r&&t&&t>0&&r.roomHandler.resetTokenTimer(1e3*t-this.stateCenter.local_time_deviation)},e.prototype.setProtoFormat=function(e){if(void 0===e&&(e="json"),!["json","pb"].includes(e))throw new Error("Failed to execute 'setProtoFormat': Arguments 'format' must be 'json' or 'pb'.");this.stateCenter.protoFormat=e},e.prototype.setSdkLoginRelateService=function(e){Array.isArray(e)&&e.every((function(e){return"string"==typeof e}))&&(this.stateCenter.relateService=e)},e.prototype.sendMessageByService=function(e,t,r,i,n,o){return this.service.sendMessage(e,t,r,i,n,o)},e.prototype.getHeader=function(e){var t=this.stateCenter.roomModulesList[0];if(t&&t.isLogin()){var r=t.roomID,i=t.sessionID,n=t.roomSessionID;return this.service.getHeader(e,i,r,n)}this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_GET_HEADER+" room no found or no login")},e.prototype.sendPB=function(e){return e instanceof Uint8Array?this.service.sendPB(e):(this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_PB+" type error"),!1)},e.prototype.onPushBizChannel=function(e){e&&this.service.on("push_biz_channel",e)},e.prototype.getRoomID=function(){return this.stateCenter.roomid},e.prototype.getServerTimeOffset=function(){return this.stateCenter.serverTimeOffset},e}();t.ZegoExpressWebRTM=y},function(e,t,r){"undefined"!=typeof self&&self,e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.E_CLIENT_TYPE=t.ENUM_LOG_LEVEL=t.ENUM_REMOTE_TYPE=t.ZEGO_ENV=t.ZEGO_BROWSER_TYPE=void 0,function(e){e[e.IE=0]="IE",e[e.FIREFOX=1]="FIREFOX",e[e.CHROME=2]="CHROME",e[e.SAFARI=3]="SAFARI",e[e.OPERA=4]="OPERA",e[e.WEIXIN=5]="WEIXIN",e[e.WEIXINMINI=6]="WEIXINMINI",e[e.UNKOWN=7]="UNKOWN"}(t.ZEGO_BROWSER_TYPE||(t.ZEGO_BROWSER_TYPE={})),function(e){e[e.BROWSER=0]="BROWSER",e[e.WEIXINMINI=1]="WEIXINMINI"}(t.ZEGO_ENV||(t.ZEGO_ENV={})),function(e){e[e.DISABLE=0]="DISABLE",e[e.WEBSOCKET=1]="WEBSOCKET",e[e.HTTPS=2]="HTTPS"}(t.ENUM_REMOTE_TYPE||(t.ENUM_REMOTE_TYPE={})),t.ENUM_LOG_LEVEL={DEBUG:0,INFO:1,WARN:2,ERROR:3,REPORT:99,DISABLE:100,debug:0,info:1,warn:2,error:3,report:99,disable:100},function(e){e[e.ClientType_None=0]="ClientType_None",e[e.ClientType_H5=1]="ClientType_H5",e[e.ClientType_SmallPragram=2]="ClientType_SmallPragram",e[e.ClientType_Webrtc=3]="ClientType_Webrtc"}(t.E_CLIENT_TYPE||(t.E_CLIENT_TYPE={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerStateCenter=void 0;var i=function(){function e(){this._testEnvironment=!0,this._ENV=0,this._debug=!0}return e.getInstance=function(){return e.instance||(e.instance=new e,e.instance.init()),e.instance},e.prototype.init=function(){},Object.defineProperty(e.prototype,"testEnvironment",{get:function(){return this._testEnvironment},set:function(e){this._testEnvironment=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ENV",{get:function(){return this._ENV},set:function(e){this._ENV=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"debug",{get:function(){return this._debug},set:function(e){this._debug=e},enumerable:!1,configurable:!0}),e.instance=new e,e}();t.LoggerStateCenter=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createZegoWebSocket=t.ZegoWeiXinMiniWebSocket=void 0;var i=r(0),n=function(){function e(e,t){this.url=e,this.readyState=3,this._websocket=wx.connectSocket({url:e}),this.init()}return e.prototype.init=function(){var e=this;this._websocket&&(this.readyState=0,this._websocket.onOpen((function(t){e.readyState=e._websocket.readyState,"function"==typeof e.onopen&&(e.onopen(t),e._websocket.onClose((function(t){e.readyState=e._websocket.readyState,"function"==typeof e.onclose&&e.onclose(t)})),e._websocket.onMessage((function(t){"function"==typeof e.onmessage&&e.onmessage(t)})))})),this._websocket.onError((function(t){e.readyState=e._websocket.readyState,"function"==typeof e.onerror&&e.onerror(t)})))},e.prototype.onopen=function(e){},e.prototype.onerror=function(e){},e.prototype.onclose=function(e){},e.prototype.onmessage=function(e){},e.prototype.send=function(e){this._websocket&&this._websocket.send({data:e})},e.prototype.close=function(){this._websocket&&this._websocket.close()},e}();t.ZegoWeiXinMiniWebSocket=n,t.createZegoWebSocket=function(e,t){return t%2===i.ZEGO_ENV.BROWSER?new WebSocket(e):new n(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerStateCenter=t.createZegoWebSocket=t.ZegoDataReport=t.ZegoLogger=void 0;var i=r(1);Object.defineProperty(t,"LoggerStateCenter",{enumerable:!0,get:function(){return i.LoggerStateCenter}});var n=r(2);Object.defineProperty(t,"createZegoWebSocket",{enumerable:!0,get:function(){return n.createZegoWebSocket}});var o=r(4);Object.defineProperty(t,"ZegoDataReport",{enumerable:!0,get:function(){return o.ZegoDataReport}});var s=r(5);Object.defineProperty(t,"ZegoLogger",{enumerable:!0,get:function(){return s.ZegoLogger}})},function(e,t,r){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoDataReport=void 0;var n=function(){function e(e){this.dataStatistics={},this.logger=e}return e.prototype.newReport=function(e,t){this.dataStatistics[e]={event_time:Date.now(),time_consumed:0,seq:e,error:0,message:"success",event:t,events:[]}},e.prototype.addMsgExt=function(e,t){this.dataStatistics[e]?this.dataStatistics[e].msg_ext=t:console.warn(e+" not exist")},e.prototype.addMsgInfo=function(e,t){this.dataStatistics[e]?Object.assign(this.dataStatistics[e],t):console.warn(e+" not exist")},e.prototype.eventStart=function(e,t){this.dataStatistics[e]?null!=this.dataStatistics[e].events?this.dataStatistics[e].events.push({event:t,event_time:Date.now(),time_consumed:0}):this.logger.warn("zd.es.0 no events"):this.logger.warn("zd.es.0 no seq match")},e.prototype.eventEnd=function(e,t,r){if(this.dataStatistics[e]){var i=this.dataStatistics[e].events;if(i&&0!==i.length){for(var n=i.length-1;n>=0;n--)if(i[n].event==t&&0==i[n].time_consumed){i[n].time_consumed=Date.now()-i[n].event_time;break}}else this.logger.info("zd.ee.0 no events")}else this.logger.info("zd.ee.0 no seq match")},e.prototype.eventEndWithMsg=function(e,t,r){if(this.dataStatistics[e]){var n=this.dataStatistics[e].events;if(n){for(var o=n.length-1;o>=0;o--)if(n[o].event==t&&0==n[o].time_consumed){n[o].time_consumed=Date.now()-n[o].event_time,null==n[o].msg_ext&&(n[o].msg_ext={}),n[o].msg_ext=i({},r);break}}else this.logger.warn("zd.ee.0 no events")}else this.logger.warn("zd.ee.0 no seq match")},e.prototype.eventEndWithMsgInfo=function(e,t,r){if(this.dataStatistics[e]){var i=this.dataStatistics[e].events;if(i){for(var n=i.length-1;n>=0;n--)if(i[n].event==t&&0==i[n].time_consumed){i[n].time_consumed=Date.now()-i[n].event_time,Object.assign(i[n],r);break}}else this.logger.warn("zd.ee.0 no events")}else this.logger.warn("zd.ee.0 no seq match")},e.prototype.addEventInfo=function(e,t,r,i){if(this.dataStatistics[e]){var n=this.dataStatistics[e].events;if(null!=n){for(var o=n.length-1;o>=0;o--)if(n[o].event==t&&null!=n[o].time_consumed){null==n[o].msg_ext?n[o].msg_ext={}:n[o].msg_ext&&(n[o].msg_ext[r]=i);break}}else this.logger.warn("zd.aei.0 no events")}else this.logger.warn("zd.aei.0 no seq match")},e.prototype.addEventMsg=function(e,t,r,i){if(this.dataStatistics[e]){var n=this.dataStatistics[e].events;if(null!=n){for(var o=n.length-1;o>=0;o--)if(n[o].event==t){n[o][r]=i;break}}else this.logger.warn("zd.aem.0 no events")}else this.logger.warn("zd.aem.0 no seq match")},e.prototype.addEvent=function(e,t,r){this.dataStatistics[e]?this.dataStatistics[e].events&&(r?this.dataStatistics[e].events.push({event:t,event_time:Date.now(),msg_ext:r}):this.dataStatistics[e].events.push({event:t,event_time:Date.now()})):this.logger.warn("zd.ae.0 no seq match")},e.prototype.uploadReport=function(e,t,r,i){var n=this.dataStatistics[e];null!=n&&(t&&(n.event=t),n.time_consumed=Date.now()-n.event_time,r&&this.addMsgInfo(e,{error:r.code,message:r.message||r.msg+" "+(i||"")}),this.logger.report(n),delete this.dataStatistics[e])},e}();t.ZegoDataReport=n},function(e,t,r){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoLogger=void 0;var n=r(0),o=r(2),s=r(1),a=r(6),c=function(){function e(e){this.logLevel=n.ENUM_LOG_LEVEL.INFO,this.logRemoteLevel=0,this.websocket=null,this.logUploadTimer=null,this.logUploadInterval=1e4,this.logCache=[],this.logCacheSend=[],this.logCacheMax=100,this.existUserID=!1,this.stateCenter=s.LoggerStateCenter.getInstance(),this.env=e}return e.prototype.setLogLevel=function(e){var t=n.ENUM_LOG_LEVEL[e];return void 0!==t&&(this.logLevel=t,!0)},e.prototype.setRemoteLogLevel=function(e){var t=n.ENUM_LOG_LEVEL[e];return void 0!==t&&(this.logRemoteLevel=t,!0)},e.prototype.setSessionInfo=function(e,t,r,i,n,o){this.appid=e,this.roomid=t,this.sessionid=r,this.userid=i,this.userName=n,this.version=o},e.prototype.report=function(e){var t=this.logReportParamList(n.ENUM_LOG_LEVEL.REPORT,e);this.logLevel!==n.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=n.ENUM_LOG_LEVEL.REPORT&&console.debug(t),this.RemoteLog(n.ENUM_LOG_LEVEL.REPORT,t,!0)},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.logParamList(n.ENUM_LOG_LEVEL.DEBUG,e.join(""));this.logLevel!==n.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=n.ENUM_LOG_LEVEL.DEBUG&&console.debug(r),this.log(n.ENUM_LOG_LEVEL.DEBUG,r)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.logParamList(n.ENUM_LOG_LEVEL.INFO,e.join(""));this.logLevel!==n.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=n.ENUM_LOG_LEVEL.INFO&&console.info(r),this.log(n.ENUM_LOG_LEVEL.INFO,r)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.logParamList(n.ENUM_LOG_LEVEL.WARN,e.join(""));this.logLevel!==n.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=n.ENUM_LOG_LEVEL.WARN&&console.warn(r),this.log(n.ENUM_LOG_LEVEL.WARN,r)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.logParamList(n.ENUM_LOG_LEVEL.ERROR,e.join(""));this.logLevel!==n.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=n.ENUM_LOG_LEVEL.ERROR&&(console.error(r),window?this.stateCenter.debug&&window.alert(e.join("").substr(e.join("").indexOf(" ")+1,4500)):wx&&this.stateCenter.debug&&wx.showModal({title:"",content:e.join("").substr(e.join("").indexOf(" ")+1,4500)})),this.log(n.ENUM_LOG_LEVEL.ERROR,r)},e.prototype.log=function(e,t){this.logRemoteLevel!==n.ENUM_LOG_LEVEL.DISABLE&&this.logRemoteLevel<=e&&this.RemoteLog(e,t)},e.prototype.setLogServer=function(e){try{return e.startsWith("wss:")?(this.logType=n.ENUM_REMOTE_TYPE.WEBSOCKET,this.openWebSocketLogServer(e)):e.startsWith("https:")?(this.logType=n.ENUM_REMOTE_TYPE.HTTPS,this.openHttpsLogServer(e)):this.logType=n.ENUM_REMOTE_TYPE.DISABLE,!0}catch(e){return this.error(JSON.stringify(e)),!1}},e.prototype.stopLogServer=function(){this.logType==n.ENUM_REMOTE_TYPE.WEBSOCKET?this.stopWebSocketServer():this.logType==n.ENUM_REMOTE_TYPE.HTTPS&&(this.SendHttpsLog(),this.stopHttpsServer()),this.logType=n.ENUM_REMOTE_TYPE.DISABLE},e.prototype.stopWebSocketServer=function(){this.websocket&&(this.websocket.onclose=null,this.websocket.onerror=null,this.websocket.close(),this.websocket=null)},e.prototype.openHttpsLogServer=function(e){var t=this;this.url=e,e&&(this.stopHttpsServer(),this.logUploadTimer||(this.logUploadTimer=setInterval((function(){t.SendHttpsLog()}),this.logUploadInterval)))},e.prototype.stopHttpsServer=function(){this.logUploadTimer&&(clearInterval(this.logUploadTimer),this.logUploadTimer=null)},e.prototype.RemoteLog=function(e,t,r){if(void 0===r&&(r=!1),""!=this.url)if(this.logType==n.ENUM_REMOTE_TYPE.WEBSOCKET)this.RemoteWebSocketLog(e,t);else if(this.logType==n.ENUM_REMOTE_TYPE.HTTPS)this.RemoteHttpsLog(e,t,r);else if(this.logLevel!==n.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=e)for(this.logCacheSend.push(t);this.logCacheSend.length>this.logCacheMax;)this.logCacheSend.shift()},e.prototype.RemoteWebSocketLog=function(e,t){if("string"==typeof t&&t.length>4e3)console.info("log over maximum, ignore");else if(null==this.websocket||2==this.websocket.readyState||3==this.websocket.readyState){var r=this.url;this.url="",this.setLogServer(r),this.logCacheSend.length<this.logCacheMax&&this.logCacheSend.push(t)}else if(0==this.websocket.readyState)this.logCacheSend.length<this.logCacheMax&&this.logCacheSend.push(t);else if(1==this.websocket.readyState)if(this.logCacheSend.length>0){for(var n="",o=0;o<this.logCacheSend.length;o++){(n+this.logCacheSend[o]).length>4e3&&(this.websocket.send(n),n="");var s=JSON.parse(this.logCacheSend[o]);s=i(i({},s),{userid:s.userid||this.userid,roomid:s.roomid||this.roomid,userName:s.roomid||this.userName}),n=n+JSON.stringify(s)+"\n"}t=n+t,this.logCacheSend=[],this.websocket.send(t)}else this.websocket.send(t);else console.warn("wrong socket state:"+this.websocket.readyState),this.logCacheSend.length<this.logCacheMax&&this.logCacheSend.push(t)},e.prototype.RemoteHttpsLog=function(e,t,r){this.logCacheSend.push(t),(this.logCacheSend.length>=this.logCacheMax||!0===r)&&this.SendHttpsLog()},e.prototype.logParamList=function(e,t){var r=a.getCurrentTime(),i=[t.substr(0,t.indexOf(" "))||t,t.substr(t.indexOf(" ")+1,4500)||t],n={time:r,level:e,action:i[0],content:i[1],appid:this.appid,roomid:this.roomid,userid:this.userid,userName:this.userName,sessionid:this.sessionid};return JSON.stringify(n)},e.prototype.logReportParamList=function(e,t){var r=a.getCurrentTime();return t=i(i({},t),{time:r,level:e,console:this.env%2===n.ZEGO_ENV.BROWSER?"rtc":"xcx",appid:this.appid,room_id:this.roomid,roomid:this.roomid,userid:this.userid,id_name:this.userid,userName:this.userName,sessionid:this.sessionid,sdk_version:this.version,test_environment:this.stateCenter.testEnvironment,version:this.version,event_id:this.appid+"_"+this.userid+"_"+t.event_time+"_"+t.seq}),JSON.stringify(t)},e.prototype.openWebSocketLogServer=function(e){if(this.url!=e){if(this.url=e,!e)return;this.stopWebSocketServer(),this.websocket=o.createZegoWebSocket(e,this.env),this.websocket.onopen=function(){},this.websocket.onclose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.warn("onclose   websocket error:",e)},this.websocket.onmessage=function(){},this.websocket.onerror=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.warn("open log websocket error:",e)}}},e.prototype.SendHttpsLog=function(){0!=this.logCacheSend.length&&(this.env%2===n.ZEGO_ENV.BROWSER?this.SendHttpsLogWeb():this.SendHttpsLogWeChatMini())},e.prototype.SendHttpsLogWeb=function(){var e=this,t=this.logCacheSend.join("\n"),r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==r.readyState)if(200==r.status){if(0==r.responseText.length)return;try{var t=JSON.parse(r.responseText).interval;"number"==typeof t&&e.logUploadInterval!==t&&(e.timeInterval=t,e.openHttpsLogServer(e.url))}catch(e){console.log("send result failed "+e)}}else console.log("send failed "+r.status)},r.open("POST",this.url,!0),0==this.env?r.send(t):2==this.env&&(r.setRequestHeader("content-type","application/json"),r.send(JSON.stringify({user_id:this.userid,log:t}))),this.logCacheSend=[]},e.prototype.SendHttpsLogWeChatMini=function(){var e=this;!this.existUserID&&this.userid&&this.logCacheSend.forEach((function(t){Array.isArray(t)&&t.forEach((function(r,i){var n=JSON.parse(r);n&&""==JSON.parse(r).userid?(n.userid=e.userid,n.id_name=e.userid,t[i]=JSON.stringify(n)):e.existUserID=!0}))}));var t=this.logCacheSend.join("\n"),r=1==this.env?t:JSON.stringify({user_id:this.userid,log:t});wx.request({url:this.url,data:r,method:"POST",success:function(t){if(0!=t.data.length){var r=t&&t.data&&t.data.interval;"number"==typeof r&&e.logUploadInterval!==r&&(e.timeInterval=r,e.openHttpsLogServer(e.url))}},fail:function(e){console.log("send failed "+e.statusCode)}}),this.logCacheSend=[]},e}();t.ZegoLogger=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrentTime=t.getCurrentEnv=t.getBrowser=void 0;var i=r(0);t.getBrowser=function(){var e=window.navigator.userAgent,t=null!=window.ActiveXObject&&-1!=e.indexOf("MSIE"),r=-1!=e.indexOf("Firefox"),n=null!=window.opr,o=e.indexOf("Chrome")&&window.chrome,s=-1!=e.indexOf("Safari")&&-1!=e.indexOf("Version"),a=e.toLowerCase().match(/MicroMessenger/i)&&"micromessenger"===e.toLowerCase().match(/MicroMessenger/i)[0];return t?i.ZEGO_BROWSER_TYPE.IE:r?i.ZEGO_BROWSER_TYPE.FIREFOX:n?i.ZEGO_BROWSER_TYPE.OPERA:o?i.ZEGO_BROWSER_TYPE.CHROME:s?i.ZEGO_BROWSER_TYPE.SAFARI:a?i.ZEGO_BROWSER_TYPE.WEIXIN:i.ZEGO_BROWSER_TYPE.UNKOWN},t.getCurrentEnv=function(){var e=window.navigator.userAgent;return new Promise((function(t){-1==e.indexOf("MicroMessage")?t(i.ZEGO_ENV.BROWSER):wx.miniProgram.getEnv((function(e){e.miniprogram}))}))};var n=["00","01","02","03","04","05","06","07","08","09"];t.getCurrentTime=function(){var e=new Date;return[e.getFullYear()+"/",(n[e.getMonth()+1]||e.getMonth()+1)+"/",(n[e.getDate()]||e.getDate())+" ",(n[e.getHours()]||e.getHours())+":",(n[e.getMinutes()]||e.getMinutes())+":",n[e.getSeconds()]||e.getSeconds(),"."+e.getTime()%1e3].join("")}}])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Base64=void 0;var i=function(){function e(){}return e.base64encode=function(t){var r,i,n,o,s,a;for(n=t.length,i=0,r="";i<n;){if(o=255&t.charCodeAt(i++),i==n){r+=e.base64EncodeChars.charAt(o>>2),r+=e.base64EncodeChars.charAt((3&o)<<4),r+="==";break}if(s=t.charCodeAt(i++),i==n){r+=e.base64EncodeChars.charAt(o>>2),r+=e.base64EncodeChars.charAt((3&o)<<4|(240&s)>>4),r+=e.base64EncodeChars.charAt((15&s)<<2),r+="=";break}a=t.charCodeAt(i++),r+=e.base64EncodeChars.charAt(o>>2),r+=e.base64EncodeChars.charAt((3&o)<<4|(240&s)>>4),r+=e.base64EncodeChars.charAt((15&s)<<2|(192&a)>>6),r+=e.base64EncodeChars.charAt(63&a)}return r},e.base64decode=function(t){var r,i,n,o,s,a,c;for(a=t.length,s=0,c="";s<a;){do{r=e.base64DecodeChars[255&t.charCodeAt(s++)]}while(s<a&&-1==r);if(-1==r)break;do{i=e.base64DecodeChars[255&t.charCodeAt(s++)]}while(s<a&&-1==i);if(-1==i)break;c+=String.fromCharCode(r<<2|(48&i)>>4);do{if(61==(n=255&t.charCodeAt(s++)))return c;n=e.base64DecodeChars[n]}while(s<a&&-1==n);if(-1==n)break;c+=String.fromCharCode((15&i)<<4|(60&n)>>2);do{if(61==(o=255&t.charCodeAt(s++)))return c;o=e.base64DecodeChars[o]}while(s<a&&-1==o);if(-1==o)break;c+=String.fromCharCode((3&n)<<6|o)}return c},e.utf16to8=function(e){var t,r,i,n;for(t="",i=e.length,r=0;r<i;r++)(n=e.charCodeAt(r))>=1&&n<=127?t+=e.charAt(r):n>2047?(t+=String.fromCharCode(224|n>>12&15),t+=String.fromCharCode(128|n>>6&63),t+=String.fromCharCode(128|n>>0&63)):(t+=String.fromCharCode(192|n>>6&31),t+=String.fromCharCode(128|n>>0&63));return t},e.utf8to16=function(e){var t,r,i,n,o,s;for(t="",i=e.length,r=0;r<i;)switch((n=e.charCodeAt(r++))>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t+=e.charAt(r-1);break;case 12:case 13:o=e.charCodeAt(r++),t+=String.fromCharCode((31&n)<<6|63&o);break;case 14:o=e.charCodeAt(r++),s=e.charCodeAt(r++),t+=String.fromCharCode((15&n)<<12|(63&o)<<6|(63&s)<<0)}return t},e.base64EncodeChars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e.base64DecodeChars=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1],e}();t.Base64=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROOM_BASIC=t.INIT=t.CLOUD_SETTING=void 0,t.CLOUD_SETTING={product:"Web_SDK",URL:["https://cloud-setting-api.zego.im/cloud-setting/get","https://cloud-setting-api.zegocloud.com/cloud-setting/get"],POLLING_FREQ:300,ONLINE:!1},t.INIT="init",t.ROOM_BASIC="room"},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.RetryRoomHandler=void 0;var o=r(25),s=r(0),a=r(3),c=r(1),l=r(2),u=function(e){function t(t,r,i){var n=e.call(this,t,r)||this;return n.logger=t,n.stateCenter=r,n.room=i,n.loginRoomCallback={},n}return n(t,e),t.prototype.renewLocalToken=function(e,t){this.token=e,this.room.token=this.token;var r=(new Date).getTime(),i=void 0;t&&"number"==typeof t?i=1e3*t:"03"===e.substr(0,2)&&(i=1e3*l.ClientUtil.decodeTokenExpire(e.substr(2))-r),i&&this.roomHandler.resetTokenTimer(i-this.stateCenter.local_time_deviation),this.stateCenter.actionListener("_tokenRenewed",e,this.room.roomID)},t.prototype.initRoom=function(e,t,r,i,n,o,s){this.roomHandler=e,this.roomID=t,this.renewLocalToken(r),this.user=i,this.server=n,this.serverBak=o||n,this.config=s},t.prototype.active=function(e){var t=this;if(this.logger.info(a.ZEGO_RTM_ACTION.ROOM_LOGIN_ROOM+" retry call"),this.roomHandler.setRunState(s.ENUM_RUN_STATE.trylogin),this.room.isMulti&&this.room.service.isDisConnect())this.logger.info(a.ZEGO_RTM_ACTION.ROOM_LOGIN_ROOM+" service is disconnected, multi room stop retry");else if(this.stateCenter.networkState!=s.ENUM_NETWORK_STATE.offline)if(this.retryTimer)this.logger.info(a.ZEGO_RTM_ACTION.ROOM_LOGIN_ROOM+" has actived, ignore");else if(this.isOverTime)this.logger.info(a.ZEGO_RTM_ACTION.ROOM_LOGIN_ROOM+" retry over time, stop retry");else{if(1==this.retryActiveCount)this.retryActiveInterval=Math.floor(Math.random()*(1-this.RETRY_START_TIME_INTERVAL)+this.RETRY_START_TIME_INTERVAL);else{var r=Math.pow(2,Math.round(this.retryActiveCount/this.RETRY_CONTINUE_COUNT+1));this.retryActiveInterval=r>this.RETRY_MAX_TIME_INTERVAL?this.RETRY_MAX_TIME_INTERVAL:r}this.retryTimer=setTimeout((function(){t.roomHandler.login(t.retryActiveCount%2==1?t.server:t.serverBak,t.roomID,t.token,t.user,t.config,(function(e){t.handleLoginFinish(e)}),(function(e,r){t.handleLoginFinish(!1,e,r)})),t.retryTimer&&clearTimeout(t.retryTimer),t.retryTimer=null,t.retryActiveCount++}),e?0:1e3*this.retryActiveInterval)}else this.logger.info(a.ZEGO_RTM_ACTION.ROOM_LOGIN_ROOM+" network is broken, stop retry")},t.prototype.startMaxTime=function(){var e=this;this.maxTimer||(this.maxTimer=setTimeout((function(){e.logger.info(a.ZEGO_RTM_ACTION.ROOM_LOGIN_ROOM+" over max time "+e.RETRY_MAX_TIME+"s, stop retry"),e.isOverTime=!0,e.roomHandler.resetRoom(),e.stopMaxTime(),e.invalid(),e.onactive(!1,c.errorCodeList.LOGIN_TIMEOUT),e.loginRoomCallback.fail&&(e.loginRoomCallback.fail(c.errorCodeList.LOGIN_TIMEOUT),e.loginRoomCallback.fail=void 0)}),1e3*this.RETRY_MAX_TIME))},t.prototype.stopMaxTime=function(){this.maxTimer&&clearTimeout(this.maxTimer),this.maxTimer=null},t.prototype.onactive=function(e,t){},t.prototype.handleError=function(e,t){if(this.RETRY_MAX_TIME<3)return!1;if(t){var r=e.code+"";return!["1000002002","1000005030","1000005035","1010","1011","1013","1014","1015","1016","1017","1018","1019","1020","1021","1023"].includes(r)&&(!!["1100040001","1100040100"].includes(r)||this.room.lastRunState==s.ENUM_RUN_STATE.login&&(this.room.sessionID="",this.invalid(),!0))}return!0},t.prototype.setLoginRoomCallback=function(e,t){this.loginRoomCallback.success=e,this.loginRoomCallback.fail=t},t.prototype.handleLoginFinish=function(e,t,r){t?this.handleError(t,r)?(!this.maxTimer&&this.startMaxTime(),this.active()):(this.roomHandler.resetRoom(),this.stopMaxTime(),this.invalid(),this.onactive(e,t),this.loginRoomCallback.fail&&(this.loginRoomCallback.fail(t),this.loginRoomCallback.fail=void 0)):(this.stopMaxTime(),this.invalid(),this.onactive(e,{code:0,msg:""}),this.loginRoomCallback.success&&(this.loginRoomCallback.success(e),this.loginRoomCallback.fail=void 0))},t}(o.TryHandler);t.RetryRoomHandler=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TryHandler=void 0;var i=function(){function e(e,t){this.logger=e,this.stateCenter=t,this.RETRY_MAX_TIME=300,this.RETRY_START_TIME_INTERVAL=4,this.RETRY_CONTINUE_COUNT=2,this.RETRY_MAX_TIME_INTERVAL=32,this.retryTimer=null,this.maxTimer=null,this.retryStartTime=0,this.retryActiveCount=1,this.isOverTime=!1}return e.prototype.init=function(e,t,r,i){this.invalid(),this.stopMaxTime(),this.isOverTime=!1,"number"==typeof e&&e<3600&&(this.RETRY_MAX_TIME=e),"number"==typeof t&&(this.RETRY_START_TIME_INTERVAL=t),"number"==typeof r&&(this.RETRY_CONTINUE_COUNT=r),"number"==typeof i&&(this.RETRY_MAX_TIME_INTERVAL=i)},e.prototype.invalid=function(){this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=null,this.retryStartTime=0,this.retryActiveCount=1},e}();t.TryHandler=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkParams=t.RULE_SUCCESS=t.RULE_PARAM_NAME=void 0;var i,n=r(2);!function(e){e.NOT_EMPTY="NOT_EMPTY",e.ILLEGAL_CHARACTERS="ILLEGAL_CHARACTERS",e.TYPE_STRING="TYPE_STRING",e.TYPE_INTEGER="TYPE_INTEGER",e.TYPE_OBJECT="TYPE_OBJECT",e.MAX_LENGTH_10="MAX_LENGTH_10",e.MAX_LENGTH_64="MAX_LENGTH_64",e.MAX_LENGTH_100="MAX_LENGTH_100",e.MAX_LENGTH_128="MAX_LENGTH_128",e.MAX_LENGTH_256="MAX_LENGTH_256",e.MAX_LENGTH_1024="MAX_LENGTH_1024"}(i=t.RULE_PARAM_NAME||(t.RULE_PARAM_NAME={})),t.RULE_SUCCESS={error:{code:0,msg:"suc"}};var o={NOT_EMPTY:function(e,r,i,n,o){return void 0===r||""===r||null===r?(n.error(i+" "+e+" is empty"),o):t.RULE_SUCCESS},ILLEGAL_CHARACTERS:function(e,r,i,o,s){return n.ClientUtil.checkIllegalCharacters(r)?t.RULE_SUCCESS:(o.error(i+" "+e+" contains illegal characters"),s)},TYPE_STRING:function(e,r,i,n,o){return"string"!=typeof r?(n.error(i+" "+e+" must be string"),o):t.RULE_SUCCESS},TYPE_INTEGER:function(e,r,i,o,s){return n.ClientUtil.checkInteger(r,!1)?t.RULE_SUCCESS:(o.error(i+" "+e+"  must be integer number"),s)},TYPE_OBJECT:function(e,r,i,n,o){return r&&"object"==typeof r?t.RULE_SUCCESS:(n.error(i+" "+e+"  must be object"),o)},MAX_LENGTH_10:function(e,r,i,n,o){return r.length>10?(n.error(i+" "+e+" is too long"),o):t.RULE_SUCCESS},MAX_LENGTH_64:function(e,r,i,n,o){return r.length>64?(n.error(i+" "+e+" is too long"),o):t.RULE_SUCCESS},MAX_LENGTH_100:function(e,r,i,n,o){return r.length>100?(n.error(i+" "+e+" is too long"),o):t.RULE_SUCCESS},MAX_LENGTH_128:function(e,r,i,n,o){return r.length>128?(n.error(i+" "+e+" is too long"),o):t.RULE_SUCCESS},MAX_LENGTH_256:function(e,r,i,n,o){return r.length>256?(n.error(i+" "+e+" is too long"),o):t.RULE_SUCCESS},MAX_LENGTH_1024:function(e,r,i,n,o){return r.length>1024?(n.error(i+" "+e+" is too long"),o):t.RULE_SUCCESS}};t.checkParams=function(e,r){var n=[],s={};for(var a in e)s[e[a].order]=e[a],e[a].key=a;for(var c in s)n.push(s[c]);for(var l=0;l<n.length;l++)for(var u=n[l].rules,d=0;d<u.length;d++){var h={key:n[l].key,value:n[l].value,action:r.action,logger:r.logger},p=h.key,f=h.value,g=h.action,m=h.logger,_=u[d].name?""+u[d].name:"";if((void 0===f&&_===i.NOT_EMPTY||void 0!==f)&&o[_]){var v=o[_](p,f,g,m,u[d]);if(v!=t.RULE_SUCCESS)return v}}return t.RULE_SUCCESS}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StateCenter=void 0;var i=r(0),n=r(3),o=r(4),s=function(){function e(e,t){this.logger=e,this.dataReport=t,this._debug=!1,this._testEnvironment=!1,this._env=0,this.type="PUBLIC",this.debugCustom=!1,this.configOK=!1,this.role=2,this.relateService=[],this.maxMemberCount=0,this.roomCreateFlag=1,this.local_time_deviation=0,this.callbackList={},this.listenerList={roomUserUpdate:[],roomOnlineUserCountUpdate:[],getAnchorInfo:[],_getAnchorInfo:[],IMRecvCustomCommand:[],IMRecvBroadcastMessage:[],recvReliableMessage:[],roomExtraInfoUpdate:[],IMRecvBarrageMessage:[],recvJoinLiveRequest:[],recvInviteJoinLiveRequest:[],recvEndJoinLiveCommand:[],roomLoginResponse:[],HBResponse:[],roomStateUpdate:[],_roomStateUpdate:[],_getTotalUserList:[],_userStateUpdate:[],_recvBigRoomMessage:[],_recvRoomMsg:[],_kickout:[],tokenWillExpire:[],_tokenExpired:[],hallStateUpdate:[],_hallStateUpdate:[],roomTokenWillExpire:[],_tokenRenewed:[],_protobufResponse:[],_cloudSettingNotify:[],_settingCanFetch:[]},this.reportList={},this.reportSeqList={login:0,relogin:0},this.networkState=i.ENUM_NETWORK_STATE.offline,this.roomRetryTime=300,this.roomModulesList=[],this.isMultiRoom=!1,this.setMultiRoom=!1,this.protoFormat="json",this.settingFetched=!1,this._sdkVersion="unknown"}return Object.defineProperty(e.prototype,"debug",{get:function(){return this._debug},set:function(e){this._debug=e,i.LoggerStateCenter.getInstance().debug=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"testEnvironment",{get:function(){return this._testEnvironment},set:function(e){this._testEnvironment=e,i.LoggerStateCenter.getInstance().testEnvironment=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ENV",{get:function(){return this._env},set:function(e){this._env=e,i.LoggerStateCenter.getInstance().ENV=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roomid",{get:function(){return this.roomModulesList[0]?this.roomModulesList[0].roomID:""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverTimeOffset",{get:function(){return this.roomModulesList[0]?this.roomModulesList[0].messageHandler.serverTimeOffset:0},enumerable:!1,configurable:!0}),e.prototype.getRequestId=function(){return this.idName+"-"+i.getSeq()},e.prototype.actionListener=function(e){for(var t=this,r=[],s=1;s<arguments.length;s++)r[s-1]=arguments[s];if(this.listenerList[e]){var a=i.getReportSeq();this.dataReport.newReport(a,o.ZegoRTMLogEvent.kZegoListener.event),this.dataReport.addMsgInfo(a,{listener:e,params:r}),this.dataReport.uploadReport(a)}this.listenerList[e]&&this.listenerList[e].forEach((function(i){try{i.apply(void 0,r)}catch(r){t.logger.error(n.ZEGO_RTM_ACTION.STATE_ACTION+" ",e," ",JSON.stringify(r))}}))},e.prototype.onListener=function(e,t){return this.listenerList[e]?"function"!=typeof t?(this.logger.error(n.ZEGO_RTM_ACTION.ON_LISTENER+" listener callBack must be funciton"),!1):(-1==this.listenerList[e].indexOf(t)&&this.listenerList[e].push(t),!0):(this.logger.error(n.ZEGO_RTM_ACTION.ON_LISTENER+" event "+e+" no found"),!1)},Object.defineProperty(e.prototype,"sdKVersion",{get:function(){return this._sdkVersion},set:function(e){this._sdkVersion=e},enumerable:!1,configurable:!0}),e}();t.StateCenter=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LiveRoomModules=void 0;var i=r(0),n=r(9),o=r(29),s=r(10),a=r(2),c=r(1),l=function(){function e(e,t,r,a,c,l){this.roomID=e,this.stateCenter=t,this.logger=r,this.dataReport=a,this.service=c,this.rtm=l,this.runState=i.ENUM_RUN_STATE.logout,this.lastRunState=i.ENUM_RUN_STATE.logout,this.lastRoomState="DISCONNECTED",this.roomState="DISCONNECTED",this.roomSessionID="0",this.sessionID="0",this.isMulti=!1,this.token="",this.thirdToken="",this.roomHandler=new o.RoomHandler(this.logger,this.stateCenter,this.dataReport,this.service,this),this.heartBeatHandler=new n.HeartBeatHandler(this.logger,this.stateCenter,this.dataReport,this.service,this),this.userHandler=new s.UserHandler(this.logger,this.stateCenter,this.dataReport,this.service,this),this.initMessageHandler(),this.initLiveHandler(),this.init()}return e.prototype.initMessageHandler=function(){},e.prototype.initLiveHandler=function(){},e.prototype.init=function(){this.bindHeatBeatHandler(),this.bindRoomHandler(),this.bindMessageHandler(),this.bindLiveHandler()},e.prototype.bindHeatBeatHandler=function(){var e=this;this.heartBeatHandler.hbLogout=function(t){e.roomHandler.handleHbLogout(t)},this.heartBeatHandler.heartbeatRspNotiFy=function(t){e.messageHandler&&e.messageHandler.loginRsp(t),e.userHandler.patchUserList(t),e.HBResponse(t)}},e.prototype.bindRoomHandler=function(){var e=this;this.roomHandler.loginSuccessCallBack=function(t,r){e.heartBeatHandler.init(r),e.service.startCheck(),e.userHandler.loginRsp(r,t),e.messageHandler&&e.messageHandler.loginRsp(r),e.isMulti||e.handleMultiRoom(),e.roomLoginResponse(r)},this.roomHandler.resetRoomCallBack=function(){e.heartBeatHandler.resetHeartbeat(),e.liveHandler&&e.liveHandler.resetLiveHandler(),e.messageHandler&&e.messageHandler.resetMessageInfo(),e.userHandler.resetUserHandler(),e.roomTryHandler&&(e.roomTryHandler.invalid(),e.roomTryHandler.stopMaxTime(),e.roomTryHandler=void 0)}},e.prototype.bindUserHandler=function(){},e.prototype.bindMessageHandler=function(){},e.prototype.bindLiveHandler=function(){},e.prototype.HBResponse=function(e){this.stateCenter.actionListener("HBResponse",e)},e.prototype.roomLoginResponse=function(e){this.stateCenter.actionListener("roomLoginResponse",e)},e.prototype.handleMultiRoom=function(){this.stateCenter.roomModulesList.forEach((function(e){e.runState!==i.ENUM_RUN_STATE.login&&e.roomTryHandler&&1==e.isMulti&&(e.roomTryHandler.onactive=function(t,r){if(r&&0!==r.code){if(0!==r.code){var i=a.ClientUtil.getLiveRoomError(r.code);i&&c.errorCodeList[i]&&(r=c.errorCodeList[i])}e.roomHandler.roomStateHandle("DISCONNECTED",r,r.msg)}else e.roomHandler.roomStateHandle("CONNECTED",r)},e.roomTryHandler.startMaxTime(),e.roomTryHandler.active())}))},e.prototype.isLogin=function(){return this.runState===i.ENUM_RUN_STATE.login},e}();t.LiveRoomModules=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RoomHandler=void 0;var i=r(0),n=r(2),o=r(3),s=r(1),a=r(4),c=function(){function e(e,t,r,i,n){this.logger=e,this.stateCenter=t,this.dataReport=r,this.service=i,this.room=n,this.tryLoginTimer=null,this.tryLoginCount=0,this.tryLoginInterval=1e4,this.tokenTimer=null,this.beforeExpire=30,this.loginCallback={}}return e.prototype.resetTokenTimer=function(e){var t=this;e=(e=(e-=3e4)<0?0:e)>2147483648?2147483648:e,this.logger.info(o.ZEGO_RTM_ACTION.ROOM_RESETTOKEN_TIMER+"  call: "+e),this.tokenTimer&&clearTimeout(this.tokenTimer),this.tokenTimer=setTimeout((function(){t.stateCenter.actionListener("tokenWillExpire",t.room.roomID),t.stateCenter.actionListener("roomTokenWillExpire",t.room.roomID)}),e)},e.prototype.stopTokenTimer=function(){this.tokenTimer&&clearTimeout(this.tokenTimer),this.tokenTimer=null},e.prototype.setRunState=function(e){this.room.runState!==e&&(this.room.lastRunState=this.room.runState,this.room.runState=e)},e.prototype.resetTryLogin=function(){this.tryLoginTimer&&clearTimeout(this.tryLoginTimer),this.tryLoginTimer=null},e.prototype.resetRoom=function(e){var t=this;if(this.logger.info(o.ZEGO_RTM_ACTION.ROOM_RESET_ROOM+" call"),this.stateCenter.roomModulesList.length>1&&!e&&(this.room.isMulti=!0),this.resetTryLogin(),"0"!==this.room.sessionID&&this.room.runState!==i.ENUM_RUN_STATE.logout&&!this.service.isDisConnect()){var r=function(e){t.handleLogoutRsp(e)};this.service.logout(this.room,r,r)}this.setRunState(i.ENUM_RUN_STATE.logout),this.room.sessionID="",this.room.roomSessionID="",this.room.isMulti||(this.stateCenter.userid="",this.logger.setSessionInfo(this.stateCenter.appid,this.room.roomID,this.room.sessionID,this.stateCenter.idName,this.stateCenter.nickName,this.stateCenter.sdKVersion),this.service.closeSocket()),this.resetRoomCallBack(),this.stateCenter.roomModulesList=this.stateCenter.roomModulesList.filter((function(e){return e!==t.room}));var n=this.stateCenter.roomModulesList[0];n&&(n.isMulti=!1,n.runState!==i.ENUM_RUN_STATE.login&&n.roomTryHandler&&(n.roomTryHandler.startMaxTime(),n.roomTryHandler.active())),this.logger.info(o.ZEGO_RTM_ACTION.ROOM_RESET_ROOM+" call success")},e.prototype.resetRoomCallBack=function(){},e.prototype.loginSuccessCallBack=function(e,t){},e.prototype.handlePushKickout=function(e,t){var r=this;if(this.logger.info(o.ZEGO_RTM_ACTION.ROOM_KICK_OUT+"  call "+JSON.stringify(e)),this.room.sessionID===e.header.session_id){var c=i.getReportSeq();this.dataReport.newReport(c,a.ZegoRTMLogEvent.kZegoTaskKickout.event),this.dataReport.addMsgInfo(c,{user_id:a.ZegoRTMLogEvent.kZegoTaskKickout.user_id(this.stateCenter.idName)});var l=n.ClientUtil.getKickoutError(e.body.reason);this.dataReport.addMsgInfo(c,{error:l.code,message:l.message}),this.dataReport.uploadReport(c);var u=this.room.roomTryHandler;if(u)if(u.onactive=function(e,t){r.disconnectedHandle(t),r.stateCenter.actionListener("_kickout",t)},e.body.need_relogin&&1==e.body.need_relogin)this.room.sessionID="",u.startMaxTime(),u.active();else{this.setRunState(i.ENUM_RUN_STATE.logout),this.resetRoom(t);var d={};e&&e.body.custom_reason?d.custom_kickout_message=e.body.custom_reason:l.name&&s.errorCodeList[l.name]&&(d.custom_kickout_message=s.errorCodeList[l.name].msg+"; kickout reason: "+e.body.reason),l.name&&s.errorCodeList[l.name]?this.disconnectedHandle(s.errorCodeList[l.name],JSON.stringify(d)):this.disconnectedHandle(s.errorCodeList.ROOM_INNER_ERROR,JSON.stringify(d)),this.stateCenter.actionListener("_kickout",{code:s.errorCodeList.MANUAL_KICKOUT.code,msg:s.errorCodeList.MANUAL_KICKOUT.msg+e.body.reason})}else this.logger.info(o.ZEGO_RTM_ACTION.ROOM_KICK_OUT+" try handler no found")}else this.logger.info(o.ZEGO_RTM_ACTION.ROOM_KICK_OUT+" session id wrong, ignore")},e.prototype.handleHbLogout=function(e){var t=this,r=this.room.roomTryHandler;r&&(r.onactive=function(e,r){t.disconnectedHandle(r)},[s.errorCodeList.HEARTBEAT_TIMEOUT,s.errorCodeList.SOCKET_CLOSE,s.errorCodeList.TIMEOUT].includes(e)||e.msg.endsWith("1000002001")||e.msg.endsWith("1000000152")||e.msg.endsWith("1000000105")?(r.startMaxTime(),r.active()):(r.stopMaxTime(),r.invalid(),this.resetRoom(),this.disconnectedHandle(e)))},e.prototype.onDisconnect=function(e){var t=this;if(this.logger.error(o.ZEGO_RTM_ACTION.ROOM_DISCONNECT+" "+e.msg),"string"==typeof e.code&&"Error.Network"===e.code)this.dataReport.addMsgInfo(this.stateCenter.reportSeqList.relogin,{error:a.ZegoRTMLogEvent.kZegoTaskReLoginRoom.error.ROOM_DISCONNECT.code,message:a.ZegoRTMLogEvent.kZegoTaskReLoginRoom.error.ROOM_DISCONNECT.msg});else if("number"==typeof e.code){var r=void 0;(r=e.code<2e9&&e.code>1e9||e.code<1e6?n.ClientUtil.decodeServerError(e.code,e.msg):{code:e.code,message:e.msg})&&this.dataReport.addMsgInfo(this.stateCenter.reportSeqList.relogin,{error:r.code,message:r.message})}this.dataReport.uploadReport(this.stateCenter.reportSeqList.relogin),this.stateCenter.reportSeqList.relogin=0,n.ClientUtil.unregisterCallback(a.ZegoRTMLogEvent.kZegoTaskReLoginRoom.event,this.stateCenter.reportList);var i=this.room.roomTryHandler;i?(i.onactive=function(e,r){r&&0!==r.code?t.roomStateHandle("DISCONNECTED",r):t.roomStateHandle("CONNECTED",r)},i.startMaxTime(),i.active()):this.logger.error(o.ZEGO_RTM_ACTION.ROOM_DISCONNECT+" try handler no found")},e.prototype.onConnecting=function(e){this.roomStateHandle("CONNECTING",e)},e.prototype.disconnectedHandle=function(e,t){e&&0!==e.code?(this.stopTokenTimer(),this.roomStateHandle("DISCONNECTED",e,t)):this.roomStateHandle("CONNECTED",e,t)},e.prototype.roomStateHandle=function(e,t,r){this.logger.info(o.ZEGO_RTM_ACTION.ROOM_STATUS_CALLBACK+" "+e+" "+JSON.stringify(t)),this.room.lastRoomState=this.room.roomState,this.room.roomState=e,this.room.roomState!==this.room.lastRoomState&&(this.stateCenter.actionListener("_roomStateUpdate",this.room.roomID,e,t?t.code:0,r),this.stateCenter.actionListener("roomStateUpdate",this.room.roomID,e,t?t.code:0,r))},e.prototype.login=function(e,t,r,c,l,u,d){if(this.logger.info(o.ZEGO_RTM_ACTION.ROOM_LOGIN_ROOM+" call:",t,r),!this.room.isMulti&&this.logger.setSessionInfo(this.stateCenter.appid,t,"",c.userID,"",this.stateCenter.sdKVersion),l&&(l.userUpdate&&"boolean"==typeof l.userUpdate&&(this.stateCenter.userStateUpdate=l.userUpdate),l.maxMemberCount&&"number"==typeof l.maxMemberCount&&(this.stateCenter.maxMemberCount=l.maxMemberCount)),!this.stateCenter.configOK)return this.logger.error(o.ZEGO_RTM_ACTION.ROOM_LOGIN_ROOM+" init sdk wrong"),void d(s.errorCodeList.INIT);if(this.room.runState!==i.ENUM_RUN_STATE.trylogin&&this.setRunState(i.ENUM_RUN_STATE.trylogin),this.room.roomID=t,this.room.token=r,this.room.thirdToken=r,this.stateCenter.idName=c.userID,this.stateCenter.nickName=c.userName||c.userID,this.loginCallback.success=u,this.loginCallback.fail=d,0===this.stateCenter.reportSeqList.login){var h=i.getReportSeq();this.stateCenter.reportSeqList.relogin=h,this.dataReport.newReport(h,a.ZegoRTMLogEvent.kZegoTaskReLoginRoom.event),this.dataReport.addMsgInfo(h,{server:e}),n.ClientUtil.logReportCallback(a.ZegoRTMLogEvent.kZegoTaskReLoginRoom.event,this.dataReport,h,this.stateCenter.reportList)}this.resetTryLogin(),this.onConnecting({code:0,msg:""}),this.tryLogin(e),this.logger.info(o.ZEGO_RTM_ACTION.ROOM_LOGIN_ROOM+" call success")},e.prototype.tryLogin=function(e){var t=this;if(this.room.runState===i.ENUM_RUN_STATE.trylogin){var r=0!==this.stateCenter.reportSeqList.login?a.ZegoRTMLogEvent.kZegoTaskLoginRoom.event:a.ZegoRTMLogEvent.kZegoTaskReLoginRoom.event;if(this.service.isDisConnect())try{this.service.closeSocket(),this.logger.debug(o.ZEGO_RTM_ACTION.ROOM_TRY_LOGIN+" new websocket"),n.ClientUtil.actionSuccessCallback(r,this.stateCenter.reportList)&&(this.tryLoginCount>1&&n.ClientUtil.actionSuccessCallback(r,this.stateCenter.reportList)(i.REPORT_ACTION.eventEnd,a.ZegoRTMLogEvent.kZegoTaskLoginRoom.subEvent.create_socket.event),n.ClientUtil.actionSuccessCallback(r,this.stateCenter.reportList)(i.REPORT_ACTION.eventStart,a.ZegoRTMLogEvent.kZegoTaskLoginRoom.subEvent.create_socket.event),n.ClientUtil.actionSuccessCallback(r,this.stateCenter.reportList)(i.REPORT_ACTION.addEventMsg,a.ZegoRTMLogEvent.kZegoTaskLoginRoom.subEvent.create_socket.event,a.ZegoRTMLogEvent.kZegoTaskLoginRoom.subEvent.create_socket.server("server"),e)),this.service.createSocket(e),this.service.openHandler((function(){t.openHandler()})),this.service.closeHandler((function(e){t.logger.error(o.ZEGO_RTM_ACTION.ROOM_TRY_LOGIN+" close "+JSON.stringify(e.code?e.code:e)),t.service.closeSocket(),t.closeHandler(e)})),this.service.errorHandler((function(e){t.logger.error(o.ZEGO_RTM_ACTION.ROOM_TRY_LOGIN+" error "+JSON.stringify(e.code?e.code:e)),t.service.closeSocket(),t.closeHandler(e)}))}catch(e){this.logger.error(o.ZEGO_RTM_ACTION.ROOM_TRY_LOGIN+"  websocket err:"+JSON.stringify(e))}else{this.logger.info(o.ZEGO_RTM_ACTION.ROOM_TRY_LOGIN+" use current websocket and sent login"),n.ClientUtil.actionSuccessCallback(r,this.stateCenter.reportList)&&n.ClientUtil.actionSuccessCallback(r,this.stateCenter.reportList)(i.REPORT_ACTION.eventStart,a.ZegoRTMLogEvent.kZegoTaskLoginRoom.subEvent.liveroom_login.event);var s=function(e,r){t.handleLoginRsp(e,r)};this.service.login(this.room,s,s)}this.tryLoginTimer=setTimeout((function(){t.logger.info(o.ZEGO_RTM_ACTION.ROOM_TRY_LOGIN+" over time no response, login timeout"),t.loginCallback.fail&&t.loginCallback.fail(a.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.LOGIN_TIMEOUT)}),this.tryLoginInterval),this.logger.info(o.ZEGO_RTM_ACTION.ROOM_TRY_LOGIN+" call success")}else this.logger.error("zb.rh.tl state error")},e.prototype.openHandler=function(){var e=this;this.logger.info(o.ZEGO_RTM_ACTION.ROOM_OPEN_HANDLER+" websocket.onpen call");var t=0!==this.stateCenter.reportSeqList.login?a.ZegoRTMLogEvent.kZegoTaskLoginRoom.event:a.ZegoRTMLogEvent.kZegoTaskReLoginRoom.event;n.ClientUtil.actionSuccessCallback(t,this.stateCenter.reportList)&&n.ClientUtil.actionSuccessCallback(t,this.stateCenter.reportList)(i.REPORT_ACTION.eventEndWithMsgInfo,a.ZegoRTMLogEvent.kZegoTaskLoginRoom.subEvent.create_socket.event,{try_cnt:this.tryLoginCount}),this.service.onPush(),n.ClientUtil.actionSuccessCallback(t,this.stateCenter.reportList)&&n.ClientUtil.actionSuccessCallback(t,this.stateCenter.reportList)(i.REPORT_ACTION.eventStart,a.ZegoRTMLogEvent.kZegoTaskLoginRoom.subEvent.liveroom_login.event);var r=function(t,r){e.handleLoginRsp(t,r)};this.service.login(this.room,r,r)},e.prototype.handleLoginRsp=function(e,t){var r=0!==this.stateCenter.reportSeqList.login?a.ZegoRTMLogEvent.kZegoTaskLoginRoom.event:a.ZegoRTMLogEvent.kZegoTaskReLoginRoom.event;if(n.ClientUtil.actionSuccessCallback(r,this.stateCenter.reportList)&&n.ClientUtil.actionSuccessCallback(r,this.stateCenter.reportList)(i.REPORT_ACTION.eventEndWithMsgInfo,a.ZegoRTMLogEvent.kZegoTaskLoginRoom.subEvent.liveroom_login.event),this.room.runState===i.ENUM_RUN_STATE.trylogin)if(e.header&&e.body){if(e.header.seq!==t&&0==this.room.isMulti)return void this.logger.error(o.ZEGO_RTM_ACTION.ROOM_HANDLE_LOGINRSP+" in wrong seq, local=",t+"",",recv=",e.header.seq);0!==e.body.err_code?(this.logger.error(o.ZEGO_RTM_ACTION.ROOM_HANDLE_LOGINRSP+" server error=",e.body.err_code),this.handleLoginFail(e)):(this.logger.info(o.ZEGO_RTM_ACTION.ROOM_HANDLE_LOGINRSP+" call success."),this.handleLoginSuccess(e))}else this.logger.error(o.ZEGO_RTM_ACTION.ROOM_HANDLE_LOGINRSP+" "+JSON.stringify(e)),this.handleLoginFail(e);else this.logger.error(o.ZEGO_RTM_ACTION.ROOM_HANDLE_LOGINRSP+" state error")},e.prototype.handleLoginFail=function(e){this.resetTryLogin();var t=a.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.INNER_ERROR;e.header&&e.body?t=n.ClientUtil.getServerError(e.body.err_code):e.code&&e.msg&&(t=e),this.loginCallback.fail&&this.loginCallback.fail(t,!0)},e.prototype.handleLoginSuccess=function(e){var t,r={},o=this.room.lastRunState;if(this.setRunState(i.ENUM_RUN_STATE.login),this.stateCenter.userid=e.body.user_id,this.room.sessionID=e.body.session_id,this.room.roomSessionID=e.body.room_session_id,e.body.ret_timestamp&&"03"===this.room.token.substr(0,2)){var s=(new Date).getTime(),c=s-e.body.ret_timestamp;this.stateCenter.local_time_deviation=c<5e3?0:c;var l=(null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.token_remain_time)?1e3*e.body.token_remain_time:1e3*n.ClientUtil.decodeTokenExpire(this.room.token.substr(2))-s;this.resetTokenTimer(l-this.stateCenter.local_time_deviation)}if(!this.room.isMulti&&this.logger.setSessionInfo(this.stateCenter.appid,this.room.roomID,this.room.sessionID,this.stateCenter.idName,this.stateCenter.nickName,this.stateCenter.sdKVersion),e.body.config_info){var u=this.stateCenter.settingConfig.getSetting("remote_log_level",!0)||e.body.config_info.log_level;this.logger.setRemoteLogLevel(u),r.log_level=u,""==e.body.config_info.log_url||this.logger.url||(this.logger.setLogServer(e.body.config_info.log_url),r.log_url=e.body.config_info.log_url)}e.body.cluster_env&&1===e.body.cluster_env&&(this.stateCenter.testEnvironment=!0,r.test_environment="true",!this.stateCenter.debugCustom&&(this.stateCenter.debug=!0));var d=0!==this.stateCenter.reportSeqList.login?a.ZegoRTMLogEvent.kZegoTaskLoginRoom.event:a.ZegoRTMLogEvent.kZegoTaskReLoginRoom.event;n.ClientUtil.actionSuccessCallback(d,this.stateCenter.reportList)&&n.ClientUtil.actionSuccessCallback(d,this.stateCenter.reportList)(i.REPORT_ACTION.addEventMsg,a.ZegoRTMLogEvent.kZegoTaskLoginRoom.subEvent.liveroom_login.event,a.ZegoRTMLogEvent.kZegoTaskLoginRoom.subEvent.liveroom_login.respond_info("respond_info"),r),this.resetTryLogin(),this.loginSuccessCallBack(o,e),this.loginCallback.success&&this.loginCallback.success(!0),this.roomStateHandle("CONNECTED",{code:0,msg:""})},e.prototype.closeHandler=function(e){this.logger.error(o.ZEGO_RTM_ACTION.ROOM_CLOSEHANDLER+" room websocket close "+JSON.stringify(e.code?e.code:e)),this.room.runState!==i.ENUM_RUN_STATE.logout?this.room.runState===i.ENUM_RUN_STATE.trylogin?(this.resetTryLogin(),this.loginCallback.fail&&this.loginCallback.fail(1006==e.code?a.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.LOGIN_TIMEOUT:e)):this.room.runState===i.ENUM_RUN_STATE.login&&(this.logger.info(o.ZEGO_RTM_ACTION.ROOM_CLOSEHANDLER+" is called because of network broken"),this.resetTryLogin(),this.onDisconnect(a.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.NETWORK_BROKEN)):this.logger.info(o.ZEGO_RTM_ACTION.ROOM_CLOSEHANDLER+" onclose logout flow call websocket.close")},e.prototype.logout=function(e){this.logger.info(o.ZEGO_RTM_ACTION.ROOM_LOGOUT+" call"),this.room.runState!==i.ENUM_RUN_STATE.logout?(this.resetRoom(e),this.roomStateHandle("DISCONNECTED",{code:0,msg:""}),this.stopTokenTimer(),this.logger.info(o.ZEGO_RTM_ACTION.ROOM_LOGOUT+" call success")):this.logger.warn("zb.rh.lo at logout")},e.prototype.handleLogoutRsp=function(e){this.logger.info(o.ZEGO_RTM_ACTION.ROOM_LOGOUT+" result=",e.body&&e.body.err_code?e.body.err_code:"-1")},e}();t.RoomHandler=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LiveRoomModules=void 0;var i=r(0),n=r(9),o=r(10),s=function(){function e(e,t,r,s,a){this.stateCenter=e,this.logger=t,this.dataReport=r,this.service=s,this.rtm=a,this.roomID="",this._dispatchServer="",this.deviceID="",this.deviceType="",this.anType=0,this.sessionExpire="",this.pri_roomID="",this.roomSid="0",this.roomFlag=1,this.timeStamp=0,this.netType=2,this.userSeq=0,this.hallRunState=i.ENUM_RUN_STATE.logout,this.hallToken="",this.roomSessionID="",this.lastHallRunState=i.ENUM_RUN_STATE.logout,this.runRoomState=i.ENUM_RUN_STATE.logout,this.lastRunRoomState=i.ENUM_RUN_STATE.logout,this.lastHallState="DISCONNECTED",this.hallState="DISCONNECTED",this.lastRoomState="DISCONNECTED",this.roomState="DISCONNECTED",this.sessionID="",this.initHandler(),this.heartBeatHandler=new n.HeartBeatHandler(this.logger,this.stateCenter,this.dataReport,this.service,this),this.userHandler=new o.UserHandler(this.logger,this.stateCenter,this.dataReport,this.service,this),this.initMessageHandler(),this.init()}return e.prototype.initMessageHandler=function(){},e.prototype.initHandler=function(){},e.prototype.init=function(){this.bindSocketHandler(),this.bindHeatBeatHandler(),this.bindMessageHandler(),this.bindLiveHandler()},e.prototype.bindSocketHandler=function(){var e=this;this.service.handlePushUserStateUpdateMsg=function(t){e.userHandler.handlePushUserStateUpdateMsg(t)}},e.prototype.bindHeatBeatHandler=function(){var e=this;this.heartBeatHandler.hbLogout=function(e){},this.heartBeatHandler.heartbeatRspNotiFy=function(t){e.HBResponse(t)}},e.prototype.bindHallHandler=function(){},e.prototype.bindUserHandler=function(){},e.prototype.bindMessageHandler=function(){},e.prototype.bindLiveHandler=function(){},e.prototype.bindRoomHandler=function(){},e.prototype.handleHbLogout=function(e){},e.prototype.HBResponse=function(e){this.stateCenter.actionListener("HBResponse",e)},e.prototype.roomLoginResponse=function(e){this.stateCenter.actionListener("roomLoginResponse",e)},e.prototype.isLogin=function(){return this.hallRunState===i.ENUM_RUN_STATE.login},e}();t.LiveRoomModules=s},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.LiveRoomPrivateService=void 0;var o=r(12),s=r(0),a=function(e){function t(t,r,i){var n=e.call(this,t,r,i)||this;return n.stateCenter=t,n.logger=r,n.service=new o.ZegoSocketService(n.stateCenter.ENV),n.cmdSeq=0,n.responseRouters={},n}return n(t,e),t.prototype.checkResponse=function(e){return e.header.app_id!==this.stateCenter.appid||e.header.user_uid!==this.stateCenter.userid||this.stateCenter.priModules.hallRunState!==s.ENUM_RUN_STATE.login},t.prototype.handleHallKickout=function(e){},t.prototype.handlePushKickout=function(e){},t.prototype.handlePushCustomMsg=function(e){},t.prototype.handlePushRoomMsg=function(e){},t.prototype.handlePushUserStateUpdateMsg=function(e){},t.prototype.handlePushMergeMsg=function(e){},t.prototype.handlePushTransMsg=function(e){},t.prototype.handleBigImMsgRsp=function(e){},t.prototype.handlePushSignalMsg=function(e){},t.prototype.closeHandler=function(e){this.service.closeHandler(e)},t.prototype.openHandler=function(e){this.service.openHandler(e)},t.prototype.errorHandler=function(e){this.service.errorHandler(e)},t.prototype.getHeader=function(e){return{cmd:e,seq:++this.cmdSeq,timestamp:Math.ceil((new Date).getTime()/1e3)+"",app_id:this.stateCenter.appid,user_uid:this.stateCenter.userid||"0",session_id:this.stateCenter.priModules.sessionID||"0"}},t.prototype.startCheck=function(){this.service.startCheck()},t.prototype.stopCheck=function(){this.service.stopCheck()},t.prototype.isDisConnect=function(){return!this.service||this.service.isDisConnect()},t.prototype.closeSocket=function(){this.service.closeSocket()},t.prototype.on=function(e,t){this.responseRouters[e]=t},t}(r(11).LiveRoomService);t.LiveRoomPrivateService=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoSettingConfig=void 0;var i=function(){function e(){this.defaultSetting={remote_log_level:"info"},this.requestList={},this.setting=JSON.parse(JSON.stringify(this.defaultSetting))}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.setSetting=function(e,t){var r=Array.isArray(t)&&t.length>0;for(var i in e)for(var n in e[i])if(!n.endsWith("_ctrlmode")){if(r&&-1==t.indexOf(n))continue;var o=e[i][n+"_ctrlmode"];1===o||2===o?this.setting[n]=e[i][n]:this.defaultSetting[n]&&(this.setting[n]=this.defaultSetting[n]),"number"==typeof o&&(this.setting[n+"_ctrlmode"]=e[i][n+"_ctrlmode"])}},e.prototype.getSetting=function(e,t){return void 0===t&&(t=!1),t?2==this.setting[e+"_ctrlmode"]?this.setting[e]:void 0:this.setting[e]},e}();t.ZegoSettingConfig=i},function(e,t,r){"undefined"!=typeof self&&self,e.exports=function(e){return i={},t.m=r=[function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZEGO_SETTING_ACTION=void 0,(t=t.ZEGO_SETTING_ACTION||(t.ZEGO_SETTING_ACTION={})).CONSTRUCTOR="zs.0",t.SETTING_INIT="zs.ii.0",t.SETTING_FETCH_SETTING="zs.fs.0",t.SETTING__FETCH_SETTING="zs.fs.1",t.SETTING_GET_CLOUD_SETTING="zs.gcs.0",t.SETTING_POLLING_SETTING="zs.ps.0",t.SETTINGCACHEHANDLER_GET_CACHE_SETTING="zs.sch.gcs.0",t.SETTINGCACHEHANDLER_STORE_SETTING="zs.sch.ss.0",t.SETTINGFETCHHANDLER_FETCHSETTING="zs.sfh.fs.0"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorList=void 0,t.errorList={NOT_INIT:{code:1001,msg:"not init"},FILE_REQUEST_FAIL:{code:1002,msg:"fetch request fail"},INFLATE_DATA_FAIL:{code:1003,msg:"inflate fail"},MULTI_FILE_NOT_EXIST:{code:1004,msg:"get multi file fail"}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateUUID=t.checkValidNumber=t.analyzeKey=t.getCurrentTime=t.getBrowser=void 0,t.getBrowser=function(){var e=window.navigator.userAgent,t=null!=window.ActiveXObject&&-1!=e.indexOf("MSIE"),r=-1!=e.indexOf("Firefox"),i=null!=window.opr,n=e.indexOf("Chrome")&&window.chrome,o=-1!=e.indexOf("Safari")&&-1!=e.indexOf("Version");return e=e.toLowerCase().match(/MicroMessenger/i)&&"micromessenger"===e.toLowerCase().match(/MicroMessenger/i)[0],t?"IE":r?"FIREFOX":i?"OPERA":n?"CHROME":o?"SAFARI":e?"WEIXIN":"UNKOWN"};var i=["00","01","02","03","04","05","06","07","08","09"];t.getCurrentTime=function(){var e=new Date;return[e.getFullYear()+"/",(i[e.getMonth()+1]||e.getMonth()+1)+"/",(i[e.getDate()]||e.getDate())+" ",(i[e.getHours()]||e.getHours())+":",(i[e.getMinutes()]||e.getMinutes())+":",i[e.getSeconds()]||e.getSeconds(),"."+e.getTime()%1e3].join("")},t.analyzeKey=function(e){return e=e.split("_"),{level:Number(e[0]),timestamp:e[1],seq:e[2]}},t.checkValidNumber=function(e,t,r){return t=t||1,r=r||1e4,"number"==typeof e&&e%1==0&&t<=e&&e<=r},t.generateUUID=function(e){if(0===(e=void 0===e?0:e)?r=localStorage.getItem("z_deviceID"):wx.getStorageSync("z_deviceID"),r)return r;var t=(new Date).getTime(),r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var r=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?r:3&r|8).toString(36)}));return 0===e?localStorage.setItem("z_deviceID",r):wx.setStorageSync("z_deviceID",r),r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoSetting=void 0;var i=r(4);Object.defineProperty(t,"ZegoSetting",{enumerable:!0,get:function(){return i.ZegoSetting}})},function(e,t,r){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},n=this&&this.__awaiter||function(e,t,r,i){return new(r=r||Promise)((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,i,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},s={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&s[0]?i.return:s[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,s[1])).done)return n;switch(i=0,(s=n?[2&s[0],n.value]:s)[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(6===s[0]&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],i=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoSetting=void 0;var s=r(5),a=r(6),c=r(10),l=r(0),u=r(12),d=r(1),h=r(2);function p(){this.fileList=[],this.publicEnvVariable={},this.proEnvVariable={},this.pollingTimer=null,this.inited=!1,this.log=new s.ZegoLog}Object.defineProperty(p.prototype,"envVariable",{get:function(){return Object.assign({},this.publicEnvVariable,this.proEnvVariable)},enumerable:!1,configurable:!0}),p.prototype.init=function(e){var t=this;return h.checkValidNumber(e.pollingFreq)?(this.options=Object.assign({},u.INIT_CONFIG,e),this.getPublicEnvVariable(),this.settingFetchHandler=new c.SettingFetchHandler(this.options,this.log),this.settingFetchHandler.setDataReport(this.options.reportNotify),e=Math.round(60*Math.random()),this.log.info(l.ZEGO_SETTING_ACTION.SETTING_INIT+" delay "+e),this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=null),this.delayTimer=setTimeout((function(){t.pollingSetting(1e3*t.options.pollingFreq)}),1e3*e),this.settingCacheHandler=new a.SettingCacheHandler("setting_"+(this.options.online?"online_":"test_")+this.options.product+"_"+this.options.appID,this.log,this.options.env),this.inited=!0):(this.log.error(l.ZEGO_SETTING_ACTION.SETTING_INIT+" pollingFreq must be integer number"),!1)},p.prototype.uninit=function(){this.pollingTimer&&(clearTimeout(this.pollingTimer),this.pollingTimer=null)},p.prototype.setEnvVariable=function(e,t){this.proEnvVariable[e]=String(t)},p.prototype.getEnvVariable=function(e){return this.envVariable[e]},p.prototype.setEnvVariables=function(e){var t=this;Object.keys(e).forEach((function(r){"string"!=typeof e[r]&&"number"!=typeof e[r]&&t.log.error("zs.sev env "+r+" type error"),t.proEnvVariable[r]=String(e[r])}))},p.prototype.getEnvVariables=function(){return this.envVariable},p.prototype.enablePolling=function(e,t){var r=this;t?t.forEach((function(t){var i=r.fileList.find((function(e){return e.fileName===t}));i&&(i.needPolling=e)})):this.fileList.forEach((function(t){return t.needPolling=e}))},p.prototype.setToken=function(e){this.token=e},p.prototype.setUserID=function(e){this.userID=e},p.prototype.getSettingCache=function(e){return n(this,void 0,void 0,(function(){var t,r,i;return o(this,(function(n){switch(n.label){case 0:return this.inited?(t=this.fileList.find((function(t){return t.fileName===e})))?[2,Promise.resolve({setting:t.setting,versions:t.versions})]:[3,1]:[2,Promise.reject(d.errorList.NOT_INIT)];case 1:return r=this._getFileName(e),[4,this.settingCacheHandler.getCacheSetting(r)];case 2:return(r=n.sent())&&(this.fileList.find((function(t){return t.fileName===e}))||this.fileList.push({fileName:e,fetchedTime:0,needPolling:!1,setting:r.setting,versions:r.versions}),i={setting:r.setting,versions:r.versions}),[2,Promise.resolve(i)]}}))}))},p.prototype.fetchSetting=function(e,t,r){return void 0===t&&(t={}),void 0===r&&(r=!0),this.log.info(l.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" call "+e),this.inited?(this.activePolling(),0<Object.keys(t).length?(this.log.info(l.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" get file with params"),this._getCloudSetting(e,i(i({},this.envVariable),t))):(t=this.fileList.find((function(t){return t.fileName===e})))?(this.log.info(l.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" file exist"),(new Date).getTime()-t.fetchedTime<1e3*this.options.pollingFreq?(this.log.info(l.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" fetch time interval in freq"),t.needPolling=r,Promise.resolve({setting:t.setting,versions:t.versions})):this._fetchSetting(e,t,r)):(this.log.info(l.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" file not found"),this._fetchSetting(e,t,r))):Promise.reject(d.errorList.NOT_INIT)},p.prototype.fetchMultiSetting=function(e,t,r){var s=this;return void 0===t&&(t={}),void 0===r&&(r=!0),this.inited?(this.activePolling(),0<Object.keys(t).length?(this.log.info(l.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" get file with params"),this._getCloudSetting(e,i(i({},this.envVariable),t))):new Promise((function(t,i){var a={},c=[];if(e.forEach((function(e){return n(s,void 0,void 0,(function(){var t;return o(this,(function(r){return(t=this.fileList.find((function(t){return t.fileName===e})))&&(new Date).getTime()-t.fetchedTime<1e3*this.options.pollingFreq?(this.log.info(l.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" fetch time interval in freq"),a[e]={setting:t.setting,versions:t.versions}):c.push(e),[2]}))}))})),!(0<c.length))return t(a);s._getCloudSetting(c,s.envVariable).then((function(e){return s.handleFetchFiles(e,r),Object.assign(a,e),t(a)})).catch((function(e){c.forEach((function(e){return n(s,void 0,void 0,(function(){var t;return o(this,(function(i){switch(i.label){case 0:return(t=this.fileList.find((function(t){return t.fileName==e})))?t.fetchedTime=(new Date).getTime():this.fileList.find((function(t){return t.fileName===e}))||this.fileList.push({fileName:e,fetchedTime:(new Date).getTime(),needPolling:r,setting:{},versions:{}}),[4,this.settingCacheHandler.getCacheSetting(e)];case 1:return t=i.sent(),a[e]={setting:t.setting,versions:t.versions},[2]}}))}))})),0<Object.keys(a).length?t(a):i(e)}))}))):Promise.reject(d.errorList.NOT_INIT)},p.prototype.setLog=function(e){this.log=e},p.prototype._getCloudSetting=function(e,t){var r=this;return new Promise((function(i,s){return n(r,void 0,void 0,(function(){var r,n,a,c,u;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),a=e instanceof Array,[4,this.settingFetchHandler.fetchSetting(a?e:[e],t,this.token,this.userID)];case 1:return r=o.sent(),a?(n={},e.forEach((function(e){var t,i;0==(null===(t=r[e])||void 0===t?void 0:t.code)&&void 0!==(null===(i=r[e])||void 0===i?void 0:i.data)&&(n[e]={setting:null===(i=r[e])||void 0===i?void 0:i.data,versions:null===(e=r[e])||void 0===e?void 0:e.versions})})),0<Object.keys(n).length?i(n):s(d.errorList.MULTI_FILE_NOT_EXIST)):0===(null===(a=r[e])||void 0===a?void 0:a.code)&&null!==(c=r[e])&&void 0!==c&&c.data?i({setting:null===(c=r[e])||void 0===c?void 0:c.data,versions:null===(c=r[e])||void 0===c?void 0:c.versions}):s({code:null===(u=r[e])||void 0===u?void 0:u.code,msg:null===(u=r[e])||void 0===u?void 0:u.message}),[3,3];case 2:return u=o.sent(),s(u),this.log.info(l.ZEGO_SETTING_ACTION.SETTING_GET_CLOUD_SETTING+" fail"),[3,3];case 3:return[2]}}))}))}))},p.prototype.handleFetchFiles=function(e,t){var r=this;Object.keys(e).forEach((function(i){var n=r.fileList.find((function(e){return e.fileName==i}));n?(n.fetchedTime=(new Date).getTime(),n.setting=e[i].setting,n.versions=e[i].versions,n.needPolling=t):r.fileList.find((function(e){return e.fileName===i}))||r.fileList.push({fileName:i,fetchedTime:(new Date).getTime(),needPolling:t,setting:e[i].setting,versions:e[i].versions}),n=r._getFileName(i),r.settingCacheHandler.storeSetting(n,e[i])}))},p.prototype._fetchSetting=function(e,t,r){var i=this;return new Promise((function(s,a){i.log.info(l.ZEGO_SETTING_ACTION.SETTING__FETCH_SETTING+" call"),i._getCloudSetting(e,i.envVariable).then((function(n){t?(t.fetchedTime=(new Date).getTime(),t.setting=n.setting,t.versions=n.versions,t.needPolling=r):i.fileList.find((function(t){return t.fileName===e}))||i.fileList.push({fileName:e,fetchedTime:(new Date).getTime(),needPolling:r,setting:n.setting,versions:n.versions});var o=i._getFileName(e);i.settingCacheHandler.storeSetting(o,n),s(n),i.log.info(l.ZEGO_SETTING_ACTION.SETTING__FETCH_SETTING+" call suc")})).catch((function(c){return n(i,void 0,void 0,(function(){var i;return o(this,(function(n){switch(n.label){case 0:t?t.fetchedTime=(new Date).getTime():this.fileList.find((function(t){return t.fileName===e}))||this.fileList.push({fileName:e,fetchedTime:(new Date).getTime(),needPolling:r,setting:{},versions:{}}),i=this._getFileName(e),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.settingCacheHandler.getCacheSetting(i)];case 2:return i=n.sent(),s(i),[3,4];case 3:return n.sent(),a(c),[3,4];case 4:return this.log.info(l.ZEGO_SETTING_ACTION.SETTING__FETCH_SETTING+" setting not contain or fetch file fail"),[2]}}))}))}))}))},p.prototype.getPublicEnvVariable=function(){var e;0==this.options.env?(this.publicEnvVariable.userAgent=navigator.userAgent,this.publicEnvVariable.platform=navigator.platform,this.publicEnvVariable.browser=h.getBrowser(),this.publicEnvVariable.deviceid=h.generateUUID()):1==this.options.env&&(e=wx.getSystemInfoSync(),this.publicEnvVariable.brand=e.brand,this.publicEnvVariable.model=e.model,this.publicEnvVariable.system=e.system,this.publicEnvVariable.platform=e.platform,this.publicEnvVariable.wechatVersion=e.version,this.publicEnvVariable.wechatSDKVersion=e.SDKVersion,this.publicEnvVariable.deviceid=h.generateUUID(this.options.env))},p.prototype.pollingSetting=function(e){return n(this,void 0,void 0,(function(){var t,r,i,s=this;return o(this,(function(a){switch(a.label){case 0:if(this.log.info(l.ZEGO_SETTING_ACTION.SETTING_POLLING_SETTING+" call "+e),t=[],this.fileList.forEach((function(e){e.fileName,e.needPolling&&t.push(e.fileName)})),!(0<t.length))return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.settingFetchHandler.fetchSetting(t,this.envVariable,this.token,this.userID)];case 2:return r=a.sent(),this.fileList.forEach((function(e){return n(s,void 0,void 0,(function(){var t,i,n,s;return o(this,(function(o){switch(o.label){case 0:return e.fetchedTime=(new Date).getTime(),t=this._getFileName(e.fileName),r[e.fileName]&&0===r[e.fileName].code&&r[e.fileName].data?(i=JSON.stringify(r[e.fileName].data),n=JSON.stringify(e.setting),s={setting:r[e.fileName].data,versions:null===(s=r[e.fileName])||void 0===s?void 0:s.versions},n!==i&&(this.log.info(l.ZEGO_SETTING_ACTION.SETTING_POLLING_SETTING+" "+e.fileName+" setting changed"),e.setting=s.setting,e.versions=s.versions,this.options.pollingNotify(e.fileName,s)),[4,this.settingCacheHandler.getCacheSetting(t)]):[3,2];case 1:n=o.sent(),i=JSON.stringify(n),n=JSON.stringify(s),i!==n&&this.settingCacheHandler.storeSetting(t,s),o.label=2;case 2:return[2]}}))}))})),[3,4];case 3:return i=a.sent(),this.log.error(l.ZEGO_SETTING_ACTION.SETTING_POLLING_SETTING+" fetch fail "+JSON.stringify(i)),[3,4];case 4:return[3,6];case 5:this.log.info(l.ZEGO_SETTING_ACTION.SETTING_POLLING_SETTING+" polling no file"),a.label=6;case 6:return this.pollingTimer&&clearTimeout(this.pollingTimer),this.pollingTimer=setTimeout((function(){s.pollingSetting(e)}),e),[2]}}))}))},p.prototype._getFileName=function(e){return e},p.prototype.activePolling=function(){this.pollingTimer||this.pollingSetting(1e3*this.options.pollingFreq)},r=p,t.ZegoSetting=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoLog=void 0;var i=(n.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.join(" ")},n.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.join(" ")},n.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.join(" ")},n.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.join(" ")},n.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.join(" ")},n);function n(){}t.ZegoLog=i},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r=r||Promise)((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},s={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&s[0]?i.return:s[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,s[1])).done)return n;switch(i=0,(s=n?[2&s[0],n.value]:s)[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(6===s[0]&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],i=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.SettingCacheHandler=void 0;var o=r(0),s=r(7);function a(e,t,r){void 0===r&&(r=0),this.storeName=e,this.log=t,this.store=s.createZegoStore(e,r)}a.prototype.getCacheSetting=function(e){return i(this,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:return this.log.info(o.ZEGO_SETTING_ACTION.SETTINGCACHEHANDLER_GET_CACHE_SETTING+" call"),[4,this.store.getItem(e)];case 1:return[2,t.sent()||""]}}))}))},a.prototype.storeSetting=function(e,t){return i(this,void 0,void 0,(function(){return n(this,(function(r){switch(r.label){case 0:return this.log.info(o.ZEGO_SETTING_ACTION.SETTINGCACHEHANDLER_STORE_SETTING+" call"),[4,this.store.setItem(e,t)];case 1:return r.sent(),[2]}}))}))},r=a,t.SettingCacheHandler=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createZegoStore=t.ZegoWechatMiniStore=void 0;var i=r(8),n=r(9),o=(s.prototype.getItem=function(e){var t=this;return new Promise((function(r,i){try{r(wx.getStorageSync(t.keyPrefix+e))}catch(r){i(r)}}))},s.prototype.setItem=function(e,t){var r=this;return new Promise((function(i,n){try{wx.setStorageSync(r.keyPrefix+e,t),i()}catch(i){n(i)}}))},s.prototype.removeItem=function(e){var t=this;return new Promise((function(r,i){try{r(wx.removeStorageSync(t.keyPrefix+e))}catch(r){i(r)}}))},s.prototype.clear=function(){return new Promise((function(e,t){try{wx.clearStorageSync(),e()}catch(e){t(e)}}))},s.prototype.keys=function(){var e=this;return new Promise((function(t,r){try{var i=wx.getStorageInfoSync().keys,n=[];i.forEach((function(t){0==t.indexOf(e.keyPrefix)&&n.push(t.replace(e.keyPrefix,""))})),n.sort(),t(n)}catch(t){r(t)}}))},s);function s(e){this.storeName=e,this.keyPrefix=e+"/",this.storeName}t.ZegoWechatMiniStore=o,t.createZegoStore=function(e,t){return t===n.ZEGO_ENV.BROWSER?i.createInstance({name:e}):new o(e)}},function(t,r){t.exports=e},function(e,t,r){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SOCKET_DISCONNECT=t.ENUM_REMOTE_TYPE=t.ZEGO_BROWSER_TYPE=t.ZEGO_ENV=t.PROTO_VERSION=void 0,t.PROTO_VERSION="1.0.2",(i=t.ZEGO_ENV||(t.ZEGO_ENV={}))[i.BROWSER=0]="BROWSER",i[i.WEIXINMINI=1]="WEIXINMINI",(i=t.ZEGO_BROWSER_TYPE||(t.ZEGO_BROWSER_TYPE={}))[i.IE=0]="IE",i[i.FIREFOX=1]="FIREFOX",i[i.CHROME=2]="CHROME",i[i.SAFARI=3]="SAFARI",i[i.OPERA=4]="OPERA",i[i.WEIXIN=5]="WEIXIN",i[i.WEIXINMINI=6]="WEIXINMINI",i[i.UNKOWN=7]="UNKOWN",(i=t.ENUM_REMOTE_TYPE||(t.ENUM_REMOTE_TYPE={}))[i.DISABLE=0]="DISABLE",i[i.WEBSOCKET=1]="WEBSOCKET",i[i.HTTPS=2]="HTTPS",t.SOCKET_DISCONNECT=-1},function(e,t,r){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.SettingFetchHandler=void 0;var n=r(0),o=r(11),s=r(2);function a(e,t){this.options=e,this.log=t,this.seq=0}a.prototype.setOptions=function(e){this.options=e},a.prototype.setDataReport=function(e){this.reportFunc=e},a.prototype.fetchSetting=function(e,t,r,a){var c=this;return new Promise((function(l,u){var d={product:c.options.product,files:e,param:i(i({},t),{deviceid:void 0}),appid:c.options.appID,token:r,id_name:a,timestamp:(new Date).getTime(),biztype:0,deviceid:t.deviceid||s.generateUUID(c.options.env),compress:!1,mode:c.options.online?"online":"test"},h=c.seq++;c.reportFunc&&c.reportFunc(h,"request_start"),o.fetch(c.options.urls,d,c.options.env||0).then((function(e){var t,r=e.code,i=(e.msg,e.data);e=e.reportData,c.log.info(n.ZEGO_SETTING_ACTION.SETTINGFETCHHANDLER_FETCHSETTING+" "+r),i&&(t=[],Object.keys(i).forEach((function(e){t.push({name:e,error:i[e].code})}))),c.reportFunc&&c.reportFunc(h,"request_end",{code:r,reportData:e,params:d,files:t}),l(i)})).catch((function(e){var t=e.code,r=e.msg;e.data,e=e.reportData,c.log.warn(n.ZEGO_SETTING_ACTION.SETTINGFETCHHANDLER_FETCHSETTING+" "+t),c.reportFunc&&c.reportFunc(h,"request_end",{code:t,params:d,reportData:e}),u({code:t,msg:r})}))}))},r=a,t.SettingFetchHandler=r},function(e,t,r){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.fetch=void 0;var n=r(1);t.fetch=function e(t,r,o,s,a,c){return void 0===s&&(s=5),void 0===a&&(a=0),void 0===c&&(c=[]),new Promise((function(l,u){a=a||(new Date).getTime();var d,h,p,f=(new Date).getTime();0===o?(d=new XMLHttpRequest,h=t[(s+1)%2]||t[0],d.open("post",h),1==r.compress&&(d.responseType="arraybuffer"),d.ontimeout=function(){},d.onreadystatechange=function(){var p,g,m,_;4==d.readyState&&(200<=d.status&&d.status<300||304==d.status?(m=void 0,1==r.compress||(m=d.responseText),_=(new Date).getTime()-f,p=(g=JSON.parse(m)).code,m=g.message,g=g.data,c.push({timestamp:f,url:h,error:p,duration:_}),0===p?l({code:p,msg:m,data:g,reportData:c}):u({code:p,msg:m,reportData:c})):(m=(new Date).getTime()-f,c.push({timestamp:f,url:h,error:d.status,duration:m}),_=(new Date).getTime()-a,0<s&&_<8e3?e(t,r,o,--s,a,c).then((function(e){l(e)})).catch((function(e){u(e)})):u(i(i({},n.errorList.FILE_REQUEST_FAIL),{reportData:c}))))},d.timeout=8e3,d.send(JSON.stringify(r))):(p=t[(s+1)%2]||t[0],wx.request({url:p,data:r,method:"POST",success:function(d){var h=(m=d.data).code,g=m.message,m=m.data;void 0!==h?0===h?l({code:h,msg:g,data:m,reportData:c}):u({code:h,msg:g,reportData:c}):(g=(new Date).getTime()-f,c.push({timestamp:f,url:p,error:n.errorList.FILE_REQUEST_FAIL.code,msg:d.data,duration:g}),0<s?e(t,r,o,--s,a,c).then((function(e){l(e)})).catch((function(e){u(e)})):u(i(i({},n.errorList.FILE_REQUEST_FAIL),{reportData:c})))},fail:function(d){var h=(new Date).getTime()-f;c.push({timestamp:f,url:p,error:n.errorList.FILE_REQUEST_FAIL.code,msg:d.errMsg,duration:h}),0<s?e(t,r,o,--s,a,c).then((function(e){l(e)})).catch((function(e){u(e)})):u(i(i({},n.errorList.FILE_REQUEST_FAIL),{reportData:c}))}}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.INIT_CONFIG=void 0,t.INIT_CONFIG={env:0}}],t.c=i,t.d=function(e,r,i){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var n in e)t.d(i,n,function(t){return e[t]}.bind(null,n));return i},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=3);function t(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return r[e].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r,i}(r(34))},function(e,t,r){(function(t){e.exports=function e(t,r,i){function n(s,a){if(!r[s]){if(!t[s]){if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[s]={exports:{}};t[s][0].call(l.exports,(function(e){var r=t[s][1][e];return n(r||e)}),l,l.exports,e,t,r,i)}return r[s].exports}for(var o=!1,s=0;s<i.length;s++)n(i[s]);return n}({1:[function(e,r,i){(function(e){"use strict";var t,i,n=e.MutationObserver||e.WebKitMutationObserver;if(n){var o=0,s=new n(u),a=e.document.createTextNode("");s.observe(a,{characterData:!0}),t=function(){a.data=o=++o%2}}else if(e.setImmediate||void 0===e.MessageChannel)t="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var c=new e.MessageChannel;c.port1.onmessage=u,t=function(){c.port2.postMessage(0)}}var l=[];function u(){var e,t;i=!0;for(var r=l.length;r;){for(t=l,l=[],e=-1;++e<r;)t[e]();r=l.length}i=!1}r.exports=function(e){1!==l.push(e)||i||t()}}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,r){"use strict";var i=e(1);function n(){}var o={},s=["REJECTED"],a=["FULFILLED"],c=["PENDING"];function l(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,e!==n&&p(this,e)}function u(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function d(e,t,r){i((function(){var i;try{i=t(r)}catch(t){return o.reject(e,t)}i===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,i)}))}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function p(e,t){var r=!1;function i(t){r||(r=!0,o.reject(e,t))}function n(t){r||(r=!0,o.resolve(e,t))}var s=f((function(){t(n,i)}));"error"===s.status&&i(s.value)}function f(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}t.exports=l,l.prototype.catch=function(e){return this.then(null,e)},l.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===s)return this;var r=new this.constructor(n);return this.state!==c?d(r,this.state===a?e:t,this.outcome):this.queue.push(new u(r,e,t)),r},u.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){o.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},o.resolve=function(e,t){var r=f(h,t);if("error"===r.status)return o.reject(e,r.value);var i=r.value;if(i)p(e,i);else{e.state=a,e.outcome=t;for(var n=-1,s=e.queue.length;++n<s;)e.queue[n].callFulfilled(t)}return e},o.reject=function(e,t){e.state=s,e.outcome=t;for(var r=-1,i=e.queue.length;++r<i;)e.queue[r].callRejected(t);return e},l.resolve=function(e){return e instanceof this?e:o.resolve(new this(n),e)},l.reject=function(e){var t=new this(n);return o.reject(t,e)},l.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,i=!1;if(!r)return this.resolve([]);for(var s=new Array(r),a=0,c=-1,l=new this(n);++c<r;)u(e[c],c);return l;function u(e,n){t.resolve(e).then((function(e){s[n]=e,++a!==r||i||(i=!0,o.resolve(l,s))}),(function(e){i||(i=!0,o.reject(l,e))}))}},l.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,i=!1;if(!r)return this.resolve([]);for(var s,a=-1,c=new this(n);++a<r;)s=e[a],t.resolve(s).then((function(e){i||(i=!0,o.resolve(c,e))}),(function(e){i||(i=!0,o.reject(c,e))}));return c}},{1:1}],3:[function(e,r,i){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();function o(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(n){if("TypeError"!==n.name)throw n;for(var r=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),i=0;i<e.length;i+=1)r.append(e[i]);return r.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var s=Promise;function a(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function c(e,t,r){"function"==typeof t&&e.then(t),"function"==typeof r&&e.catch(r)}function l(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function u(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var d=void 0,h={},p=Object.prototype.toString;function f(e){return"boolean"==typeof d?s.resolve(d):function(e){return new s((function(t){var r=e.transaction("local-forage-detect-blob-support","readwrite"),i=o([""]);r.objectStore("local-forage-detect-blob-support").put(i,"key"),r.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},r.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),r=navigator.userAgent.match(/Edge\//);t(r||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}(e).then((function(e){return d=e}))}function g(e){var t=h[e.name],r={};r.promise=new s((function(e,t){r.resolve=e,r.reject=t})),t.deferredOperations.push(r),t.dbReady?t.dbReady=t.dbReady.then((function(){return r.promise})):t.dbReady=r.promise}function m(e){var t=h[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function _(e,t){var r=h[e.name].deferredOperations.pop();if(r)return r.reject(t),r.promise}function v(e,t){return new s((function(r,i){if(h[e.name]=h[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!t)return r(e.db);g(e),e.db.close()}var o=[e.name];t&&o.push(e.version);var s=n.open.apply(n,o);t&&(s.onupgradeneeded=function(t){var r=s.result;try{r.createObjectStore(e.storeName),t.oldVersion<=1&&r.createObjectStore("local-forage-detect-blob-support")}catch(r){if("ConstraintError"!==r.name)throw r;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),s.onerror=function(e){e.preventDefault(),i(s.error)},s.onsuccess=function(){r(s.result),m(e)}}))}function E(e){return v(e,!1)}function A(e){return v(e,!0)}function y(e,t){if(!e.db)return!0;var r=!e.db.objectStoreNames.contains(e.storeName),i=e.version<e.db.version,n=e.version>e.db.version;if(i&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),n||r){if(r){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function S(e){return o([function(e){for(var t=e.length,r=new ArrayBuffer(t),i=new Uint8Array(r),n=0;n<t;n++)i[n]=e.charCodeAt(n);return r}(atob(e.data))],{type:e.type})}function C(e){return e&&e.__local_forage_encoded_blob}function T(e){var t=this,r=t._initReady().then((function(){var e=h[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return c(r,e,e),r}function b(e,t,r,i){void 0===i&&(i=1);try{var n=e.db.transaction(e.storeName,t);r(null,n)}catch(n){if(i>0&&(!e.db||"InvalidStateError"===n.name||"NotFoundError"===n.name))return s.resolve().then((function(){if(!e.db||"NotFoundError"===n.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),A(e)})).then((function(){return function(e){g(e);for(var t=h[e.name],r=t.forages,i=0;i<r.length;i++){var n=r[i];n._dbInfo.db&&(n._dbInfo.db.close(),n._dbInfo.db=null)}return e.db=null,E(e).then((function(t){return e.db=t,y(e)?A(e):t})).then((function(i){e.db=t.db=i;for(var n=0;n<r.length;n++)r[n]._dbInfo.db=i})).catch((function(t){throw _(e,t),t}))}(e).then((function(){b(e,t,r,i-1)}))})).catch(r);r(n)}}var I={_driver:"asyncStorage",_initStorage:function(e){var t=this,r={db:null};if(e)for(var i in e)r[i]=e[i];var n=h[r.name];n||(n={forages:[],db:null,dbReady:null,deferredOperations:[]},h[r.name]=n),n.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=T);var o=[];function a(){return s.resolve()}for(var c=0;c<n.forages.length;c++){var l=n.forages[c];l!==t&&o.push(l._initReady().catch(a))}var u=n.forages.slice(0);return s.all(o).then((function(){return r.db=n.db,E(r)})).then((function(e){return r.db=e,y(r,t._defaultConfig.version)?A(r):e})).then((function(e){r.db=n.db=e,t._dbInfo=r;for(var i=0;i<u.length;i++){var o=u[i];o!==t&&(o._dbInfo.db=r.db,o._dbInfo.version=r.version)}}))},_support:function(){try{if(!n||!n.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:function(e,t){var r=this,i=new s((function(t,i){r.ready().then((function(){b(r._dbInfo,"readonly",(function(n,o){if(n)return i(n);try{var s=o.objectStore(r._dbInfo.storeName).openCursor(),a=1;s.onsuccess=function(){var r=s.result;if(r){var i=r.value;C(i)&&(i=S(i));var n=e(i,r.key,a++);void 0!==n?t(n):r.continue()}else t()},s.onerror=function(){i(s.error)}}catch(e){i(e)}}))})).catch(i)}));return a(i,t),i},getItem:function(e,t){var r=this;e=l(e);var i=new s((function(t,i){r.ready().then((function(){b(r._dbInfo,"readonly",(function(n,o){if(n)return i(n);try{var s=o.objectStore(r._dbInfo.storeName).get(e);s.onsuccess=function(){var e=s.result;void 0===e&&(e=null),C(e)&&(e=S(e)),t(e)},s.onerror=function(){i(s.error)}}catch(e){i(e)}}))})).catch(i)}));return a(i,t),i},setItem:function(e,t,r){var i=this;e=l(e);var n=new s((function(r,n){var o;i.ready().then((function(){return o=i._dbInfo,"[object Blob]"===p.call(t)?f(o.db).then((function(e){return e?t:(r=t,new s((function(e,t){var i=new FileReader;i.onerror=t,i.onloadend=function(t){var i=btoa(t.target.result||"");e({__local_forage_encoded_blob:!0,data:i,type:r.type})},i.readAsBinaryString(r)})));var r})):t})).then((function(t){b(i._dbInfo,"readwrite",(function(o,s){if(o)return n(o);try{var a=s.objectStore(i._dbInfo.storeName);null===t&&(t=void 0);var c=a.put(t,e);s.oncomplete=function(){void 0===t&&(t=null),r(t)},s.onabort=s.onerror=function(){var e=c.error?c.error:c.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return a(n,r),n},removeItem:function(e,t){var r=this;e=l(e);var i=new s((function(t,i){r.ready().then((function(){b(r._dbInfo,"readwrite",(function(n,o){if(n)return i(n);try{var s=o.objectStore(r._dbInfo.storeName).delete(e);o.oncomplete=function(){t()},o.onerror=function(){i(s.error)},o.onabort=function(){var e=s.error?s.error:s.transaction.error;i(e)}}catch(e){i(e)}}))})).catch(i)}));return a(i,t),i},clear:function(e){var t=this,r=new s((function(e,r){t.ready().then((function(){b(t._dbInfo,"readwrite",(function(i,n){if(i)return r(i);try{var o=n.objectStore(t._dbInfo.storeName).clear();n.oncomplete=function(){e()},n.onabort=n.onerror=function(){var e=o.error?o.error:o.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return a(r,e),r},length:function(e){var t=this,r=new s((function(e,r){t.ready().then((function(){b(t._dbInfo,"readonly",(function(i,n){if(i)return r(i);try{var o=n.objectStore(t._dbInfo.storeName).count();o.onsuccess=function(){e(o.result)},o.onerror=function(){r(o.error)}}catch(e){r(e)}}))})).catch(r)}));return a(r,e),r},key:function(e,t){var r=this,i=new s((function(t,i){e<0?t(null):r.ready().then((function(){b(r._dbInfo,"readonly",(function(n,o){if(n)return i(n);try{var s=o.objectStore(r._dbInfo.storeName),a=!1,c=s.openKeyCursor();c.onsuccess=function(){var r=c.result;r?0===e||a?t(r.key):(a=!0,r.advance(e)):t(null)},c.onerror=function(){i(c.error)}}catch(e){i(e)}}))})).catch(i)}));return a(i,t),i},keys:function(e){var t=this,r=new s((function(e,r){t.ready().then((function(){b(t._dbInfo,"readonly",(function(i,n){if(i)return r(i);try{var o=n.objectStore(t._dbInfo.storeName).openKeyCursor(),s=[];o.onsuccess=function(){var t=o.result;t?(s.push(t.key),t.continue()):e(s)},o.onerror=function(){r(o.error)}}catch(e){r(e)}}))})).catch(r)}));return a(r,e),r},dropInstance:function(e,t){t=u.apply(this,arguments);var r=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var i,o=this;if(e.name){var c=e.name===r.name&&o._dbInfo.db,l=c?s.resolve(o._dbInfo.db):E(e).then((function(t){var r=h[e.name],i=r.forages;r.db=t;for(var n=0;n<i.length;n++)i[n]._dbInfo.db=t;return t}));i=e.storeName?l.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var r=t.version+1;g(e);var i=h[e.name],o=i.forages;t.close();for(var a=0;a<o.length;a++){var c=o[a];c._dbInfo.db=null,c._dbInfo.version=r}return new s((function(t,i){var o=n.open(e.name,r);o.onerror=function(e){o.result.close(),i(e)},o.onupgradeneeded=function(){o.result.deleteObjectStore(e.storeName)},o.onsuccess=function(){var e=o.result;e.close(),t(e)}})).then((function(e){i.db=e;for(var t=0;t<o.length;t++){var r=o[t];r._dbInfo.db=e,m(r._dbInfo)}})).catch((function(t){throw(_(e,t)||s.resolve()).catch((function(){})),t}))}})):l.then((function(t){g(e);var r=h[e.name],i=r.forages;t.close();for(var o=0;o<i.length;o++)i[o]._dbInfo.db=null;return new s((function(t,r){var i=n.deleteDatabase(e.name);i.onerror=i.onblocked=function(e){var t=i.result;t&&t.close(),r(e)},i.onsuccess=function(){var e=i.result;e&&e.close(),t(e)}})).then((function(e){r.db=e;for(var t=0;t<i.length;t++)m(i[t]._dbInfo)})).catch((function(t){throw(_(e,t)||s.resolve()).catch((function(){})),t}))}))}else i=s.reject("Invalid arguments");return a(i,t),i}},R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",w=/^~~local_forage_type~([^~]+)~/,k="__lfsc__:".length,O=k+"arbf".length,N=Object.prototype.toString;function L(e){var t,r,i,n,o,s=.75*e.length,a=e.length,c=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var l=new ArrayBuffer(s),u=new Uint8Array(l);for(t=0;t<a;t+=4)r=R.indexOf(e[t]),i=R.indexOf(e[t+1]),n=R.indexOf(e[t+2]),o=R.indexOf(e[t+3]),u[c++]=r<<2|i>>4,u[c++]=(15&i)<<4|n>>2,u[c++]=(3&n)<<6|63&o;return l}function P(e){var t,r=new Uint8Array(e),i="";for(t=0;t<r.length;t+=3)i+=R[r[t]>>2],i+=R[(3&r[t])<<4|r[t+1]>>4],i+=R[(15&r[t+1])<<2|r[t+2]>>6],i+=R[63&r[t+2]];return r.length%3==2?i=i.substring(0,i.length-1)+"=":r.length%3==1&&(i=i.substring(0,i.length-2)+"=="),i}var D={serialize:function(e,t){var r="";if(e&&(r=N.call(e)),e&&("[object ArrayBuffer]"===r||e.buffer&&"[object ArrayBuffer]"===N.call(e.buffer))){var i,n="__lfsc__:";e instanceof ArrayBuffer?(i=e,n+="arbf"):(i=e.buffer,"[object Int8Array]"===r?n+="si08":"[object Uint8Array]"===r?n+="ui08":"[object Uint8ClampedArray]"===r?n+="uic8":"[object Int16Array]"===r?n+="si16":"[object Uint16Array]"===r?n+="ur16":"[object Int32Array]"===r?n+="si32":"[object Uint32Array]"===r?n+="ui32":"[object Float32Array]"===r?n+="fl32":"[object Float64Array]"===r?n+="fl64":t(new Error("Failed to get type for BinaryArray"))),t(n+P(i))}else if("[object Blob]"===r){var o=new FileReader;o.onload=function(){var r="~~local_forage_type~"+e.type+"~"+P(this.result);t("__lfsc__:blob"+r)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(r){console.error("Couldn't convert value into a JSON string: ",e),t(null,r)}},deserialize:function(e){if("__lfsc__:"!==e.substring(0,k))return JSON.parse(e);var t,r=e.substring(O),i=e.substring(k,O);if("blob"===i&&w.test(r)){var n=r.match(w);t=n[1],r=r.substring(n[0].length)}var s=L(r);switch(i){case"arbf":return s;case"blob":return o([s],{type:t});case"si08":return new Int8Array(s);case"ui08":return new Uint8Array(s);case"uic8":return new Uint8ClampedArray(s);case"si16":return new Int16Array(s);case"ur16":return new Uint16Array(s);case"si32":return new Int32Array(s);case"ui32":return new Uint32Array(s);case"fl32":return new Float32Array(s);case"fl64":return new Float64Array(s);default:throw new Error("Unkown type: "+i)}},stringToBuffer:L,bufferToString:P};function M(e,t,r,i){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],r,i)}function x(e,t,r,i,n,o){e.executeSql(r,i,n,(function(e,s){s.code===s.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,a){a.rows.length?o(e,s):M(e,t,(function(){e.executeSql(r,i,n,o)}),o)}),o):o(e,s)}),o)}function B(e,t,r,i){var n=this;e=l(e);var o=new s((function(o,s){n.ready().then((function(){void 0===t&&(t=null);var a=t,c=n._dbInfo;c.serializer.serialize(t,(function(t,l){l?s(l):c.db.transaction((function(r){x(r,c,"INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){o(a)}),(function(e,t){s(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(i>0)return void o(B.apply(n,[e,a,r,i-1]));s(t)}}))}))})).catch(s)}));return a(o,r),o}function U(e){return new s((function(t,r){e.transaction((function(i){i.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(r,i){for(var n=[],o=0;o<i.rows.length;o++)n.push(i.rows.item(o).name);t({db:e,storeNames:n})}),(function(e,t){r(t)}))}),(function(e){r(e)}))}))}var F={_driver:"webSQLStorage",_initStorage:function(e){var t=this,r={db:null};if(e)for(var i in e)r[i]="string"!=typeof e[i]?e[i].toString():e[i];var n=new s((function(e,i){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(e){return i(e)}r.db.transaction((function(n){M(n,r,(function(){t._dbInfo=r,e()}),(function(e,t){i(t)}))}),i)}));return r.serializer=D,n},_support:"function"==typeof openDatabase,iterate:function(e,t){var r=this,i=new s((function(t,i){r.ready().then((function(){var n=r._dbInfo;n.db.transaction((function(r){x(r,n,"SELECT * FROM "+n.storeName,[],(function(r,i){for(var o=i.rows,s=o.length,a=0;a<s;a++){var c=o.item(a),l=c.value;if(l&&(l=n.serializer.deserialize(l)),void 0!==(l=e(l,c.key,a+1)))return void t(l)}t()}),(function(e,t){i(t)}))}))})).catch(i)}));return a(i,t),i},getItem:function(e,t){var r=this;e=l(e);var i=new s((function(t,i){r.ready().then((function(){var n=r._dbInfo;n.db.transaction((function(r){x(r,n,"SELECT * FROM "+n.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,r){var i=r.rows.length?r.rows.item(0).value:null;i&&(i=n.serializer.deserialize(i)),t(i)}),(function(e,t){i(t)}))}))})).catch(i)}));return a(i,t),i},setItem:function(e,t,r){return B.apply(this,[e,t,r,1])},removeItem:function(e,t){var r=this;e=l(e);var i=new s((function(t,i){r.ready().then((function(){var n=r._dbInfo;n.db.transaction((function(r){x(r,n,"DELETE FROM "+n.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){i(t)}))}))})).catch(i)}));return a(i,t),i},clear:function(e){var t=this,r=new s((function(e,r){t.ready().then((function(){var i=t._dbInfo;i.db.transaction((function(t){x(t,i,"DELETE FROM "+i.storeName,[],(function(){e()}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,e),r},length:function(e){var t=this,r=new s((function(e,r){t.ready().then((function(){var i=t._dbInfo;i.db.transaction((function(t){x(t,i,"SELECT COUNT(key) as c FROM "+i.storeName,[],(function(t,r){var i=r.rows.item(0).c;e(i)}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,e),r},key:function(e,t){var r=this,i=new s((function(t,i){r.ready().then((function(){var n=r._dbInfo;n.db.transaction((function(r){x(r,n,"SELECT key FROM "+n.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,r){var i=r.rows.length?r.rows.item(0).key:null;t(i)}),(function(e,t){i(t)}))}))})).catch(i)}));return a(i,t),i},keys:function(e){var t=this,r=new s((function(e,r){t.ready().then((function(){var i=t._dbInfo;i.db.transaction((function(t){x(t,i,"SELECT key FROM "+i.storeName,[],(function(t,r){for(var i=[],n=0;n<r.rows.length;n++)i.push(r.rows.item(n).key);e(i)}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,e),r},dropInstance:function(e,t){t=u.apply(this,arguments);var r=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var i,n=this;return a(i=e.name?new s((function(t){var i;i=e.name===r.name?n._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:i,storeNames:[e.storeName]}):t(U(i))})).then((function(e){return new s((function(t,r){e.db.transaction((function(i){function n(e){return new s((function(t,r){i.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){r(t)}))}))}for(var o=[],a=0,c=e.storeNames.length;a<c;a++)o.push(n(e.storeNames[a]));s.all(o).then((function(){t()})).catch((function(e){r(e)}))}),(function(e){r(e)}))}))})):s.reject("Invalid arguments"),t),i}};function V(e,t){var r=e.name+"/";return e.storeName!==t.storeName&&(r+=e.storeName+"/"),r}function j(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(e){return!0}}()||localStorage.length>0}var G={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var r in e)t[r]=e[r];return t.keyPrefix=V(e,this._defaultConfig),j()?(this._dbInfo=t,t.serializer=D,s.resolve()):s.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(e,t){var r=this,i=r.ready().then((function(){for(var t=r._dbInfo,i=t.keyPrefix,n=i.length,o=localStorage.length,s=1,a=0;a<o;a++){var c=localStorage.key(a);if(0===c.indexOf(i)){var l=localStorage.getItem(c);if(l&&(l=t.serializer.deserialize(l)),void 0!==(l=e(l,c.substring(n),s++)))return l}}}));return a(i,t),i},getItem:function(e,t){var r=this;e=l(e);var i=r.ready().then((function(){var t=r._dbInfo,i=localStorage.getItem(t.keyPrefix+e);return i&&(i=t.serializer.deserialize(i)),i}));return a(i,t),i},setItem:function(e,t,r){var i=this;e=l(e);var n=i.ready().then((function(){void 0===t&&(t=null);var r=t;return new s((function(n,o){var s=i._dbInfo;s.serializer.serialize(t,(function(t,i){if(i)o(i);else try{localStorage.setItem(s.keyPrefix+e,t),n(r)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||o(e),o(e)}}))}))}));return a(n,r),n},removeItem:function(e,t){var r=this;e=l(e);var i=r.ready().then((function(){var t=r._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return a(i,t),i},clear:function(e){var t=this,r=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,r=localStorage.length-1;r>=0;r--){var i=localStorage.key(r);0===i.indexOf(e)&&localStorage.removeItem(i)}}));return a(r,e),r},length:function(e){var t=this.keys().then((function(e){return e.length}));return a(t,e),t},key:function(e,t){var r=this,i=r.ready().then((function(){var t,i=r._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(i.keyPrefix.length)),t}));return a(i,t),i},keys:function(e){var t=this,r=t.ready().then((function(){for(var e=t._dbInfo,r=localStorage.length,i=[],n=0;n<r;n++){var o=localStorage.key(n);0===o.indexOf(e.keyPrefix)&&i.push(o.substring(e.keyPrefix.length))}return i}));return a(r,e),r},dropInstance:function(e,t){if(t=u.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var r=this.config();e.name=e.name||r.name,e.storeName=e.storeName||r.storeName}var i,n=this;return a(i=e.name?new s((function(t){e.storeName?t(V(e,n._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var r=localStorage.key(t);0===r.indexOf(e)&&localStorage.removeItem(r)}})):s.reject("Invalid arguments"),t),i}},H=function(e,t){for(var r,i,n=e.length,o=0;o<n;){if((r=e[o])===(i=t)||"number"==typeof r&&"number"==typeof i&&isNaN(r)&&isNaN(i))return!0;o++}return!1},Q=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},W={},q={},z={INDEXEDDB:I,WEBSQL:F,LOCALSTORAGE:G},Z=[z.INDEXEDDB._driver,z.WEBSQL._driver,z.LOCALSTORAGE._driver],Y=["dropInstance"],K=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Y),$={description:"",driver:Z.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function J(e,t){e[t]=function(){var r=arguments;return e.ready().then((function(){return e[t].apply(e,r)}))}}function X(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var r in t)t.hasOwnProperty(r)&&(Q(t[r])?arguments[0][r]=t[r].slice():arguments[0][r]=t[r])}return arguments[0]}var ee=new(function(){function e(t){for(var r in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),z)if(z.hasOwnProperty(r)){var i=z[r],n=i._driver;this[r]=n,W[n]||this.defineDriver(i)}this._defaultConfig=X({},$),this._config=X({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":i(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,r){var i=new s((function(t,r){try{var i=e._driver,n=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void r(n);for(var o=K.concat("_initStorage"),c=0,l=o.length;c<l;c++){var u=o[c];if((!H(Y,u)||e[u])&&"function"!=typeof e[u])return void r(n)}!function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),r=s.reject(t);return a(r,arguments[arguments.length-1]),r}},r=0,i=Y.length;r<i;r++){var n=Y[r];e[n]||(e[n]=t(n))}}();var d=function(r){W[i]&&console.info("Redefining LocalForage driver: "+i),W[i]=e,q[i]=r,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(d,r):d(!!e._support):d(!0)}catch(e){r(e)}}));return c(i,t,r),i},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,r){var i=W[e]?s.resolve(W[e]):s.reject(new Error("Driver not found."));return c(i,t,r),i},e.prototype.getSerializer=function(e){var t=s.resolve(D);return c(t,e),t},e.prototype.ready=function(e){var t=this,r=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return c(r,e,e),r},e.prototype.setDriver=function(e,t,r){var i=this;Q(e)||(e=[e]);var n=this._getSupportedDrivers(e);function o(){i._config.driver=i.driver()}function a(e){return i._extend(e),o(),i._ready=i._initStorage(i._config),i._ready}var l=null!==this._driverSet?this._driverSet.catch((function(){return s.resolve()})):s.resolve();return this._driverSet=l.then((function(){var e=n[0];return i._dbInfo=null,i._ready=null,i.getDriver(e).then((function(e){i._driver=e._driver,o(),i._wrapLibraryMethodsWithReady(),i._initDriver=function(e){return function(){var t=0;return function r(){for(;t<e.length;){var n=e[t];return t++,i._dbInfo=null,i._ready=null,i.getDriver(n).then(a).catch(r)}o();var c=new Error("No available storage method found.");return i._driverSet=s.reject(c),i._driverSet}()}}(n)}))})).catch((function(){o();var e=new Error("No available storage method found.");return i._driverSet=s.reject(e),i._driverSet})),c(this._driverSet,t,r),this._driverSet},e.prototype.supports=function(e){return!!q[e]},e.prototype._extend=function(e){X(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],r=0,i=e.length;r<i;r++){var n=e[r];this.supports(n)&&t.push(n)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=K.length;e<t;e++)J(this,K[e])},e.prototype.createInstance=function(t){return new e(t)},e}());t.exports=ee},{3:3}]},{},[4])(4)}).call(this,r(35))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r}])}))},d2bb:function(e,t,r){var i=r("e330"),n=r("825a"),o=r("3bbe");e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{e=i(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),e(r,[]),t=r instanceof Array}catch(s){}return function(r,i){return n(r),o(i),t?e(r,i):r.__proto__=i,r}}():void 0)},d397:function(e,t,r){"use strict";function i(e){return void 0!==e&&null!==e}function n(e){var t=/([(\uAC00-\uD7AF)|(\u3130-\u318F)])+/gi;return t.test(e)}t.__esModule=!0,t.isDef=i,t.isKorean=n},d3b7:function(e,t,r){var i=r("00ee"),n=r("6eeb"),o=r("b041");i||n(Object.prototype,"toString",o,{unsafe:!0})},d44e:function(e,t,r){var i=r("9bf2").f,n=r("1a2d"),o=r("b622"),s=o("toStringTag");e.exports=function(e,t,r){e&&!r&&(e=e.prototype),e&&!n(e,s)&&i(e,s,{configurable:!0,value:t})}},d4af:function(e,t,r){"use strict";var i=r("8eb7"),n=r("7b3e"),o=10,s=40,a=800;function c(e){var t=0,r=0,i=0,n=0;return"detail"in e&&(r=e.detail),"wheelDelta"in e&&(r=-e.wheelDelta/120),"wheelDeltaY"in e&&(r=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=r,r=0),i=t*o,n=r*o,"deltaY"in e&&(n=e.deltaY),"deltaX"in e&&(i=e.deltaX),(i||n)&&e.deltaMode&&(1==e.deltaMode?(i*=s,n*=s):(i*=a,n*=a)),i&&!t&&(t=i<1?-1:1),n&&!r&&(r=n<1?-1:1),{spinX:t,spinY:r,pixelX:i,pixelY:n}}c.getEventType=function(){return i.firefox()?"DOMMouseScroll":n("wheel")?"wheel":"mousewheel"},e.exports=c},d4c3:function(e,t,r){var i=r("342f"),n=r("da84");e.exports=/ipad|iphone|ipod/i.test(i)&&void 0!==n.Pebble},d4ec:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));r("d9e2");function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},d58f:function(e,t,r){var i=r("da84"),n=r("59ed"),o=r("7b0b"),s=r("44ad"),a=r("07fa"),c=i.TypeError,l=function(e){return function(t,r,i,l){n(r);var u=o(t),d=s(u),h=a(u),p=e?h-1:0,f=e?-1:1;if(i<2)while(1){if(p in d){l=d[p],p+=f;break}if(p+=f,e?p<0:h<=p)throw c("Reduce of empty array with no initial value")}for(;e?p>=0:h>p;p+=f)p in d&&(l=r(l,d[p],p,u));return l}};e.exports={left:l(!1),right:l(!0)}},d5d6:function(e,t,r){"use strict";var i=r("ebb5"),n=r("b727").forEach,o=i.aTypedArray,s=i.exportTypedArrayMethod;s("forEach",(function(e){n(o(this),e,arguments.length>1?arguments[1]:void 0)}))},d6d6:function(e,t,r){var i=r("da84"),n=i.TypeError;e.exports=function(e,t){if(e<t)throw n("Not enough arguments");return e}},d784:function(e,t,r){"use strict";r("ac1f");var i=r("e330"),n=r("6eeb"),o=r("9263"),s=r("d039"),a=r("b622"),c=r("9112"),l=a("species"),u=RegExp.prototype;e.exports=function(e,t,r,d){var h=a(e),p=!s((function(){var t={};return t[h]=function(){return 7},7!=""[e](t)})),f=p&&!s((function(){var t=!1,r=/a/;return"split"===e&&(r={},r.constructor={},r.constructor[l]=function(){return r},r.flags="",r[h]=/./[h]),r.exec=function(){return t=!0,null},r[h](""),!t}));if(!p||!f||r){var g=i(/./[h]),m=t(h,""[e],(function(e,t,r,n,s){var a=i(e),c=t.exec;return c===o||c===u.exec?p&&!s?{done:!0,value:g(t,r,n)}:{done:!0,value:a(r,t,n)}:{done:!1}}));n(String.prototype,e,m[0]),n(u,h,m[1])}d&&c(u[h],"sham",!0)}},d7d1:function(e,t,r){"use strict";var i;(function(n){var o={},s=/d{1,4}|M{1,4}|yy(?:yy)?|S{1,3}|Do|ZZ|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,a="\\d\\d?",c="\\d{3}",l="\\d{4}",u="[^\\s]+",d=/\[([^]*?)\]/gm,h=function(){};function p(e){return e.replace(/[|\\{()[^$+*?.-]/g,"\\$&")}function f(e,t){for(var r=[],i=0,n=e.length;i<n;i++)r.push(e[i].substr(0,t));return r}function g(e){return function(t,r,i){var n=i[e].indexOf(r.charAt(0).toUpperCase()+r.substr(1).toLowerCase());~n&&(t.month=n)}}function m(e,t){e=String(e),t=t||2;while(e.length<t)e="0"+e;return e}var _=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],v=["January","February","March","April","May","June","July","August","September","October","November","December"],E=f(v,3),A=f(_,3);o.i18n={dayNamesShort:A,dayNames:_,monthNamesShort:E,monthNames:v,amPm:["am","pm"],DoFn:function(e){return e+["th","st","nd","rd"][e%10>3?0:(e-e%10!==10)*e%10]}};var y={D:function(e){return e.getDay()},DD:function(e){return m(e.getDay())},Do:function(e,t){return t.DoFn(e.getDate())},d:function(e){return e.getDate()},dd:function(e){return m(e.getDate())},ddd:function(e,t){return t.dayNamesShort[e.getDay()]},dddd:function(e,t){return t.dayNames[e.getDay()]},M:function(e){return e.getMonth()+1},MM:function(e){return m(e.getMonth()+1)},MMM:function(e,t){return t.monthNamesShort[e.getMonth()]},MMMM:function(e,t){return t.monthNames[e.getMonth()]},yy:function(e){return m(String(e.getFullYear()),4).substr(2)},yyyy:function(e){return m(e.getFullYear(),4)},h:function(e){return e.getHours()%12||12},hh:function(e){return m(e.getHours()%12||12)},H:function(e){return e.getHours()},HH:function(e){return m(e.getHours())},m:function(e){return e.getMinutes()},mm:function(e){return m(e.getMinutes())},s:function(e){return e.getSeconds()},ss:function(e){return m(e.getSeconds())},S:function(e){return Math.round(e.getMilliseconds()/100)},SS:function(e){return m(Math.round(e.getMilliseconds()/10),2)},SSS:function(e){return m(e.getMilliseconds(),3)},a:function(e,t){return e.getHours()<12?t.amPm[0]:t.amPm[1]},A:function(e,t){return e.getHours()<12?t.amPm[0].toUpperCase():t.amPm[1].toUpperCase()},ZZ:function(e){var t=e.getTimezoneOffset();return(t>0?"-":"+")+m(100*Math.floor(Math.abs(t)/60)+Math.abs(t)%60,4)}},S={d:[a,function(e,t){e.day=t}],Do:[a+u,function(e,t){e.day=parseInt(t,10)}],M:[a,function(e,t){e.month=t-1}],yy:[a,function(e,t){var r=new Date,i=+(""+r.getFullYear()).substr(0,2);e.year=""+(t>68?i-1:i)+t}],h:[a,function(e,t){e.hour=t}],m:[a,function(e,t){e.minute=t}],s:[a,function(e,t){e.second=t}],yyyy:[l,function(e,t){e.year=t}],S:["\\d",function(e,t){e.millisecond=100*t}],SS:["\\d{2}",function(e,t){e.millisecond=10*t}],SSS:[c,function(e,t){e.millisecond=t}],D:[a,h],ddd:[u,h],MMM:[u,g("monthNamesShort")],MMMM:[u,g("monthNames")],a:[u,function(e,t,r){var i=t.toLowerCase();i===r.amPm[0]?e.isPm=!1:i===r.amPm[1]&&(e.isPm=!0)}],ZZ:["[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z",function(e,t){var r,i=(t+"").match(/([+-]|\d\d)/gi);i&&(r=60*i[1]+parseInt(i[2],10),e.timezoneOffset="+"===i[0]?r:-r)}]};S.dd=S.d,S.dddd=S.ddd,S.DD=S.D,S.mm=S.m,S.hh=S.H=S.HH=S.h,S.MM=S.M,S.ss=S.s,S.A=S.a,o.masks={default:"ddd MMM dd yyyy HH:mm:ss",shortDate:"M/D/yy",mediumDate:"MMM d, yyyy",longDate:"MMMM d, yyyy",fullDate:"dddd, MMMM d, yyyy",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},o.format=function(e,t,r){var i=r||o.i18n;if("number"===typeof e&&(e=new Date(e)),"[object Date]"!==Object.prototype.toString.call(e)||isNaN(e.getTime()))throw new Error("Invalid Date in fecha.format");t=o.masks[t]||t||o.masks["default"];var n=[];return t=t.replace(d,(function(e,t){return n.push(t),"@@@"})),t=t.replace(s,(function(t){return t in y?y[t](e,i):t.slice(1,t.length-1)})),t.replace(/@@@/g,(function(){return n.shift()}))},o.parse=function(e,t,r){var i=r||o.i18n;if("string"!==typeof t)throw new Error("Invalid format in fecha.parse");if(t=o.masks[t]||t,e.length>1e3)return null;var n={},a=[],c=[];t=t.replace(d,(function(e,t){return c.push(t),"@@@"}));var l=p(t).replace(s,(function(e){if(S[e]){var t=S[e];return a.push(t[1]),"("+t[0]+")"}return e}));l=l.replace(/@@@/g,(function(){return c.shift()}));var u=e.match(new RegExp(l,"i"));if(!u)return null;for(var h=1;h<u.length;h++)a[h-1](n,u[h],i);var f,g=new Date;return!0===n.isPm&&null!=n.hour&&12!==+n.hour?n.hour=+n.hour+12:!1===n.isPm&&12===+n.hour&&(n.hour=0),null!=n.timezoneOffset?(n.minute=+(n.minute||0)-+n.timezoneOffset,f=new Date(Date.UTC(n.year||g.getFullYear(),n.month||0,n.day||1,n.hour||0,n.minute||0,n.second||0,n.millisecond||0))):f=new Date(n.year||g.getFullYear(),n.month||0,n.day||1,n.hour||0,n.minute||0,n.second||0,n.millisecond||0),f},e.exports?e.exports=o:(i=function(){return o}.call(t,r,t,e),void 0===i||(e.exports=i))})()},d81d:function(e,t,r){"use strict";var i=r("23e7"),n=r("b727").map,o=r("1dde"),s=o("map");i({target:"Array",proto:!0,forced:!s},{map:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})},d86b:function(e,t,r){var i=r("d039");e.exports=i((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}))},d925:function(e,t,r){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},d940:function(e,t,r){"use strict";t.__esModule=!0,t.validateRangeInOneMonth=t.extractTimeFormat=t.extractDateFormat=t.nextYear=t.prevYear=t.nextMonth=t.prevMonth=t.changeYearMonthAndClampDate=t.timeWithinRange=t.limitTimeRange=t.clearMilliseconds=t.clearTime=t.modifyWithTimeString=t.modifyTime=t.modifyDate=t.range=t.getRangeMinutes=t.getMonthDays=t.getPrevMonthLastDays=t.getRangeHours=t.getWeekNumber=t.getStartDateOfMonth=t.nextDate=t.prevDate=t.getFirstDayOfMonth=t.getDayCountOfYear=t.getDayCountOfMonth=t.parseDate=t.formatDate=t.isDateObject=t.isDate=t.toDate=t.getI18nSettings=void 0;var i=r("d7d1"),n=s(i),o=r("4897");function s(e){return e&&e.__esModule?e:{default:e}}var a=["sun","mon","tue","wed","thu","fri","sat"],c=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],l=function(e,t){for(var r=[],i=e;i<=t;i++)r.push(i);return r},u=t.getI18nSettings=function(){return{dayNamesShort:a.map((function(e){return(0,o.t)("el.datepicker.weeks."+e)})),dayNames:a.map((function(e){return(0,o.t)("el.datepicker.weeks."+e)})),monthNamesShort:c.map((function(e){return(0,o.t)("el.datepicker.months."+e)})),monthNames:c.map((function(e,t){return(0,o.t)("el.datepicker.month"+(t+1))})),amPm:["am","pm"]}},d=t.toDate=function(e){return h(e)?new Date(e):null},h=t.isDate=function(e){return null!==e&&void 0!==e&&(!isNaN(new Date(e).getTime())&&!Array.isArray(e))},p=(t.isDateObject=function(e){return e instanceof Date},t.formatDate=function(e,t){return e=d(e),e?n.default.format(e,t||"yyyy-MM-dd",u()):""},t.parseDate=function(e,t){return n.default.parse(e,t||"yyyy-MM-dd",u())}),f=t.getDayCountOfMonth=function(e,t){return 3===t||5===t||8===t||10===t?30:1===t?e%4===0&&e%100!==0||e%400===0?29:28:31},g=(t.getDayCountOfYear=function(e){var t=e%400===0||e%100!==0&&e%4===0;return t?366:365},t.getFirstDayOfMonth=function(e){var t=new Date(e.getTime());return t.setDate(1),t.getDay()},t.prevDate=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return new Date(e.getFullYear(),e.getMonth(),e.getDate()-t)});t.nextDate=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t)},t.getStartDateOfMonth=function(e,t){var r=new Date(e,t,1),i=r.getDay();return g(r,0===i?7:i)},t.getWeekNumber=function(e){if(!h(e))return null;var t=new Date(e.getTime());t.setHours(0,0,0,0),t.setDate(t.getDate()+3-(t.getDay()+6)%7);var r=new Date(t.getFullYear(),0,4);return 1+Math.round(((t.getTime()-r.getTime())/864e5-3+(r.getDay()+6)%7)/7)},t.getRangeHours=function(e){var t=[],r=[];if((e||[]).forEach((function(e){var t=e.map((function(e){return e.getHours()}));r=r.concat(l(t[0],t[1]))})),r.length)for(var i=0;i<24;i++)t[i]=-1===r.indexOf(i);else for(var n=0;n<24;n++)t[n]=!1;return t},t.getPrevMonthLastDays=function(e,t){if(t<=0)return[];var r=new Date(e.getTime());r.setDate(0);var i=r.getDate();return _(t).map((function(e,r){return i-(t-r-1)}))},t.getMonthDays=function(e){var t=new Date(e.getFullYear(),e.getMonth()+1,0),r=t.getDate();return _(r).map((function(e,t){return t+1}))};function m(e,t,r,i){for(var n=t;n<r;n++)e[n]=i}t.getRangeMinutes=function(e,t){var r=new Array(60);return e.length>0?e.forEach((function(e){var i=e[0],n=e[1],o=i.getHours(),s=i.getMinutes(),a=n.getHours(),c=n.getMinutes();o===t&&a!==t?m(r,s,60,!0):o===t&&a===t?m(r,s,c+1,!0):o!==t&&a===t?m(r,0,c+1,!0):o<t&&a>t&&m(r,0,60,!0)})):m(r,0,60,!0),r};var _=t.range=function(e){return Array.apply(null,{length:e}).map((function(e,t){return t}))},v=t.modifyDate=function(e,t,r,i){return new Date(t,r,i,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())},E=t.modifyTime=function(e,t,r,i){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),t,r,i,e.getMilliseconds())},A=(t.modifyWithTimeString=function(e,t){return null!=e&&t?(t=p(t,"HH:mm:ss"),E(e,t.getHours(),t.getMinutes(),t.getSeconds())):e},t.clearTime=function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())},t.clearMilliseconds=function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),0)},t.limitTimeRange=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"HH:mm:ss";if(0===t.length)return e;var i=function(e){return n.default.parse(n.default.format(e,r),r)},o=i(e),s=t.map((function(e){return e.map(i)}));if(s.some((function(e){return o>=e[0]&&o<=e[1]})))return e;var a=s[0][0],c=s[0][0];s.forEach((function(e){a=new Date(Math.min(e[0],a)),c=new Date(Math.max(e[1],a))}));var l=o<a?a:c;return v(l,e.getFullYear(),e.getMonth(),e.getDate())}),y=(t.timeWithinRange=function(e,t,r){var i=A(e,t,r);return i.getTime()===e.getTime()},t.changeYearMonthAndClampDate=function(e,t,r){var i=Math.min(e.getDate(),f(t,r));return v(e,t,r,i)});t.prevMonth=function(e){var t=e.getFullYear(),r=e.getMonth();return 0===r?y(e,t-1,11):y(e,t,r-1)},t.nextMonth=function(e){var t=e.getFullYear(),r=e.getMonth();return 11===r?y(e,t+1,0):y(e,t,r+1)},t.prevYear=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=e.getFullYear(),i=e.getMonth();return y(e,r-t,i)},t.nextYear=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=e.getFullYear(),i=e.getMonth();return y(e,r+t,i)},t.extractDateFormat=function(e){return e.replace(/\W?m{1,2}|\W?ZZ/g,"").replace(/\W?h{1,2}|\W?s{1,3}|\W?a/gi,"").trim()},t.extractTimeFormat=function(e){return e.replace(/\W?D{1,2}|\W?Do|\W?d{1,4}|\W?M{1,4}|\W?y{2,4}/g,"").trim()},t.validateRangeInOneMonth=function(e,t){return e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}},d998:function(e,t,r){var i=r("342f");e.exports=/MSIE|Trident/.test(i)},d9b5:function(e,t,r){var i=r("da84"),n=r("d066"),o=r("1626"),s=r("3a9b"),a=r("fdbf"),c=i.Object;e.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=n("Symbol");return o(t)&&s(t.prototype,c(e))}},d9e2:function(e,t,r){var i=r("23e7"),n=r("da84"),o=r("2ba4"),s=r("e5cb"),a="WebAssembly",c=n[a],l=7!==Error("e",{cause:7}).cause,u=function(e,t){var r={};r[e]=s(e,t,l),i({global:!0,forced:l},r)},d=function(e,t){if(c&&c[e]){var r={};r[e]=s(a+"."+e,t,l),i({target:a,stat:!0,forced:l},r)}};u("Error",(function(e){return function(t){return o(e,this,arguments)}})),u("EvalError",(function(e){return function(t){return o(e,this,arguments)}})),u("RangeError",(function(e){return function(t){return o(e,this,arguments)}})),u("ReferenceError",(function(e){return function(t){return o(e,this,arguments)}})),u("SyntaxError",(function(e){return function(t){return o(e,this,arguments)}})),u("TypeError",(function(e){return function(t){return o(e,this,arguments)}})),u("URIError",(function(e){return function(t){return o(e,this,arguments)}})),d("CompileError",(function(e){return function(t){return o(e,this,arguments)}})),d("LinkError",(function(e){return function(t){return o(e,this,arguments)}})),d("RuntimeError",(function(e){return function(t){return o(e,this,arguments)}}))},da84:function(e,t,r){(function(t){var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof t&&t)||function(){return this}()||Function("return this")()}).call(this,r("c8ba"))},dc4a:function(e,t,r){var i=r("59ed");e.exports=function(e,t){var r=e[t];return null==r?void 0:i(r)}},dca8:function(e,t,r){var i=r("23e7"),n=r("bb2f"),o=r("d039"),s=r("861d"),a=r("f183").onFreeze,c=Object.freeze,l=o((function(){c(1)}));i({target:"Object",stat:!0,forced:l,sham:!n},{freeze:function(e){return c&&s(e)?c(a(e)):e}})},dcdc:function(e,t,r){e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=120)}({0:function(e,t,r){"use strict";function i(e,t,r,i,n,o,s,a){var c,l="function"===typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=r,l._compiled=!0),i&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),s?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},l._ssrRegister=c):n&&(c=a?function(){n.call(this,this.$root.$options.shadowRoot)}:n),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(e,t){return c.call(t),u(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,c):[c]}return{exports:e,options:l}}r.d(t,"a",(function(){return i}))},120:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("label",{staticClass:"el-checkbox",class:[e.border&&e.checkboxSize?"el-checkbox--"+e.checkboxSize:"",{"is-disabled":e.isDisabled},{"is-bordered":e.border},{"is-checked":e.isChecked}],attrs:{id:e.id}},[r("span",{staticClass:"el-checkbox__input",class:{"is-disabled":e.isDisabled,"is-checked":e.isChecked,"is-indeterminate":e.indeterminate,"is-focus":e.focus},attrs:{tabindex:!!e.indeterminate&&0,role:!!e.indeterminate&&"checkbox","aria-checked":!!e.indeterminate&&"mixed"}},[r("span",{staticClass:"el-checkbox__inner"}),e.trueLabel||e.falseLabel?r("input",{directives:[{name:"model",rawName:"v-model",value:e.model,expression:"model"}],staticClass:"el-checkbox__original",attrs:{type:"checkbox","aria-hidden":e.indeterminate?"true":"false",name:e.name,disabled:e.isDisabled,"true-value":e.trueLabel,"false-value":e.falseLabel},domProps:{checked:Array.isArray(e.model)?e._i(e.model,null)>-1:e._q(e.model,e.trueLabel)},on:{change:[function(t){var r=e.model,i=t.target,n=i.checked?e.trueLabel:e.falseLabel;if(Array.isArray(r)){var o=null,s=e._i(r,o);i.checked?s<0&&(e.model=r.concat([o])):s>-1&&(e.model=r.slice(0,s).concat(r.slice(s+1)))}else e.model=n},e.handleChange],focus:function(t){e.focus=!0},blur:function(t){e.focus=!1}}}):r("input",{directives:[{name:"model",rawName:"v-model",value:e.model,expression:"model"}],staticClass:"el-checkbox__original",attrs:{type:"checkbox","aria-hidden":e.indeterminate?"true":"false",disabled:e.isDisabled,name:e.name},domProps:{value:e.label,checked:Array.isArray(e.model)?e._i(e.model,e.label)>-1:e.model},on:{change:[function(t){var r=e.model,i=t.target,n=!!i.checked;if(Array.isArray(r)){var o=e.label,s=e._i(r,o);i.checked?s<0&&(e.model=r.concat([o])):s>-1&&(e.model=r.slice(0,s).concat(r.slice(s+1)))}else e.model=n},e.handleChange],focus:function(t){e.focus=!0},blur:function(t){e.focus=!1}}})]),e.$slots.default||e.label?r("span",{staticClass:"el-checkbox__label"},[e._t("default"),e.$slots.default?e._e():[e._v(e._s(e.label))]],2):e._e()])},n=[];i._withStripped=!0;var o=r(4),s=r.n(o),a={name:"ElCheckbox",mixins:[s.a],inject:{elForm:{default:""},elFormItem:{default:""}},componentName:"ElCheckbox",data:function(){return{selfModel:!1,focus:!1,isLimitExceeded:!1}},computed:{model:{get:function(){return this.isGroup?this.store:void 0!==this.value?this.value:this.selfModel},set:function(e){this.isGroup?(this.isLimitExceeded=!1,void 0!==this._checkboxGroup.min&&e.length<this._checkboxGroup.min&&(this.isLimitExceeded=!0),void 0!==this._checkboxGroup.max&&e.length>this._checkboxGroup.max&&(this.isLimitExceeded=!0),!1===this.isLimitExceeded&&this.dispatch("ElCheckboxGroup","input",[e])):(this.$emit("input",e),this.selfModel=e)}},isChecked:function(){return"[object Boolean]"==={}.toString.call(this.model)?this.model:Array.isArray(this.model)?this.model.indexOf(this.label)>-1:null!==this.model&&void 0!==this.model?this.model===this.trueLabel:void 0},isGroup:function(){var e=this.$parent;while(e){if("ElCheckboxGroup"===e.$options.componentName)return this._checkboxGroup=e,!0;e=e.$parent}return!1},store:function(){return this._checkboxGroup?this._checkboxGroup.value:this.value},isLimitDisabled:function(){var e=this._checkboxGroup,t=e.max,r=e.min;return!(!t&&!r)&&this.model.length>=t&&!this.isChecked||this.model.length<=r&&this.isChecked},isDisabled:function(){return this.isGroup?this._checkboxGroup.disabled||this.disabled||(this.elForm||{}).disabled||this.isLimitDisabled:this.disabled||(this.elForm||{}).disabled},_elFormItemSize:function(){return(this.elFormItem||{}).elFormItemSize},checkboxSize:function(){var e=this.size||this._elFormItemSize||(this.$ELEMENT||{}).size;return this.isGroup&&this._checkboxGroup.checkboxGroupSize||e}},props:{value:{},label:{},indeterminate:Boolean,disabled:Boolean,checked:Boolean,name:String,trueLabel:[String,Number],falseLabel:[String,Number],id:String,controls:String,border:Boolean,size:String},methods:{addToStore:function(){Array.isArray(this.model)&&-1===this.model.indexOf(this.label)?this.model.push(this.label):this.model=this.trueLabel||!0},handleChange:function(e){var t=this;if(!this.isLimitExceeded){var r=void 0;r=e.target.checked?void 0===this.trueLabel||this.trueLabel:void 0!==this.falseLabel&&this.falseLabel,this.$emit("change",r,e),this.$nextTick((function(){t.isGroup&&t.dispatch("ElCheckboxGroup","change",[t._checkboxGroup.value])}))}}},created:function(){this.checked&&this.addToStore()},mounted:function(){this.indeterminate&&this.$el.setAttribute("aria-controls",this.controls)},watch:{value:function(e){this.dispatch("ElFormItem","el.form.change",e)}}},c=a,l=r(0),u=Object(l["a"])(c,i,n,!1,null,null,null);u.options.__file="packages/checkbox/src/checkbox.vue";var d=u.exports;d.install=function(e){e.component(d.name,d)};t["default"]=d},4:function(e,t){e.exports=r("d010")}})},ddb0:function(e,t,r){var i=r("da84"),n=r("fdbc"),o=r("785a"),s=r("e260"),a=r("9112"),c=r("b622"),l=c("iterator"),u=c("toStringTag"),d=s.values,h=function(e,t){if(e){if(e[l]!==d)try{a(e,l,d)}catch(i){e[l]=d}if(e[u]||a(e,u,t),n[t])for(var r in s)if(e[r]!==s[r])try{a(e,r,s[r])}catch(i){e[r]=s[r]}}};for(var p in n)h(i[p]&&i[p].prototype,p);h(o,"DOMTokenList")},df75:function(e,t,r){var i=r("ca84"),n=r("7839");e.exports=Object.keys||function(e){return i(e,n)}},df7c:function(e,t,r){(function(e){function r(e,t){for(var r=0,i=e.length-1;i>=0;i--){var n=e[i];"."===n?e.splice(i,1):".."===n?(e.splice(i,1),r++):r&&(e.splice(i,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}function i(e){"string"!==typeof e&&(e+="");var t,r=0,i=-1,n=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!n){r=t+1;break}}else-1===i&&(n=!1,i=t+1);return-1===i?"":e.slice(r,i)}function n(e,t){if(e.filter)return e.filter(t);for(var r=[],i=0;i<e.length;i++)t(e[i],i,e)&&r.push(e[i]);return r}t.resolve=function(){for(var t="",i=!1,o=arguments.length-1;o>=-1&&!i;o--){var s=o>=0?arguments[o]:e.cwd();if("string"!==typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(t=s+"/"+t,i="/"===s.charAt(0))}return t=r(n(t.split("/"),(function(e){return!!e})),!i).join("/"),(i?"/":"")+t||"."},t.normalize=function(e){var i=t.isAbsolute(e),s="/"===o(e,-1);return e=r(n(e.split("/"),(function(e){return!!e})),!i).join("/"),e||i||(e="."),e&&s&&(e+="/"),(i?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(n(e,(function(e,t){if("string"!==typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},t.relative=function(e,r){function i(e){for(var t=0;t<e.length;t++)if(""!==e[t])break;for(var r=e.length-1;r>=0;r--)if(""!==e[r])break;return t>r?[]:e.slice(t,r-t+1)}e=t.resolve(e).substr(1),r=t.resolve(r).substr(1);for(var n=i(e.split("/")),o=i(r.split("/")),s=Math.min(n.length,o.length),a=s,c=0;c<s;c++)if(n[c]!==o[c]){a=c;break}var l=[];for(c=a;c<n.length;c++)l.push("..");return l=l.concat(o.slice(a)),l.join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!==typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),r=47===t,i=-1,n=!0,o=e.length-1;o>=1;--o)if(t=e.charCodeAt(o),47===t){if(!n){i=o;break}}else n=!1;return-1===i?r?"/":".":r&&1===i?"/":e.slice(0,i)},t.basename=function(e,t){var r=i(e);return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},t.extname=function(e){"string"!==typeof e&&(e+="");for(var t=-1,r=0,i=-1,n=!0,o=0,s=e.length-1;s>=0;--s){var a=e.charCodeAt(s);if(47!==a)-1===i&&(n=!1,i=s+1),46===a?-1===t?t=s:1!==o&&(o=1):-1!==t&&(o=-1);else if(!n){r=s+1;break}}return-1===t||-1===i||0===o||1===o&&t===i-1&&t===r+1?"":e.slice(t,i)};var o="b"==="ab".substr(-1)?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)}}).call(this,r("4362"))},dfb9:function(e,t,r){var i=r("07fa");e.exports=function(e,t){var r=0,n=i(t),o=new e(n);while(n>r)o[r]=t[r++];return o}},dfe5:function(e,t){},e01a:function(e,t,r){"use strict";var i=r("23e7"),n=r("83ab"),o=r("da84"),s=r("e330"),a=r("1a2d"),c=r("1626"),l=r("3a9b"),u=r("577e"),d=r("9bf2").f,h=r("e893"),p=o.Symbol,f=p&&p.prototype;if(n&&c(p)&&(!("description"in f)||void 0!==p().description)){var g={},m=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:u(arguments[0]),t=l(f,this)?new p(e):void 0===e?p():p(e);return""===e&&(g[t]=!0),t};h(m,p),m.prototype=f,f.constructor=m;var _="Symbol(test)"==String(p("test")),v=s(f.toString),E=s(f.valueOf),A=/^Symbol\((.*)\)[^)]+$/,y=s("".replace),S=s("".slice);d(f,"description",{configurable:!0,get:function(){var e=E(this),t=v(e);if(a(g,e))return"";var r=_?S(t,7,-1):y(t,A,"$1");return""===r?void 0:r}}),i({global:!0,forced:!0},{Symbol:m})}},e163:function(e,t,r){var i=r("da84"),n=r("1a2d"),o=r("1626"),s=r("7b0b"),a=r("f772"),c=r("e177"),l=a("IE_PROTO"),u=i.Object,d=u.prototype;e.exports=c?u.getPrototypeOf:function(e){var t=s(e);if(n(t,l))return t[l];var r=t.constructor;return o(r)&&t instanceof r?r.prototype:t instanceof u?d:null}},e177:function(e,t,r){var i=r("d039");e.exports=!i((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},e198:function(e,t,r){var i=r("ef08"),n=r("5524"),o=r("e444"),s=r("fcd4"),a=r("1a14").f;e.exports=function(e){var t=n.Symbol||(n.Symbol=o?{}:i.Symbol||{});"_"==e.charAt(0)||e in t||a(t,e,{value:s.f(e)})}},e260:function(e,t,r){"use strict";var i=r("fc6a"),n=r("44d2"),o=r("3f8c"),s=r("69f3"),a=r("9bf2").f,c=r("7dd0"),l=r("c430"),u=r("83ab"),d="Array Iterator",h=s.set,p=s.getterFor(d);e.exports=c(Array,"Array",(function(e,t){h(this,{type:d,target:i(e),index:0,kind:t})}),(function(){var e=p(this),t=e.target,r=e.kind,i=e.index++;return!t||i>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:i,done:!1}:"values"==r?{value:t[i],done:!1}:{value:[i,t[i]],done:!1}}),"values");var f=o.Arguments=o.Array;if(n("keys"),n("values"),n("entries"),!l&&u&&"values"!==f.name)try{a(f,"name",{value:"values"})}catch(g){}},e2cc:function(e,t,r){var i=r("6eeb");e.exports=function(e,t,r){for(var n in t)i(e,n,t[n],r);return e}},e330:function(e,t,r){var i=r("40d5"),n=Function.prototype,o=n.bind,s=n.call,a=i&&o.bind(s,s);e.exports=i?function(e){return e&&a(e)}:function(e){return e&&function(){return s.apply(e,arguments)}}},e34a:function(e,t,r){var i=r("8b1a")("meta"),n=r("7a41"),o=r("9c0e"),s=r("1a14").f,a=0,c=Object.isExtensible||function(){return!0},l=!r("4b8b")((function(){return c(Object.preventExtensions({}))})),u=function(e){s(e,i,{value:{i:"O"+ ++a,w:{}}})},d=function(e,t){if(!n(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,i)){if(!c(e))return"F";if(!t)return"E";u(e)}return e[i].i},h=function(e,t){if(!o(e,i)){if(!c(e))return!0;if(!t)return!1;u(e)}return e[i].w},p=function(e){return l&&f.NEED&&c(e)&&!o(e,i)&&u(e),e},f=e.exports={KEY:i,NEED:!1,fastKey:d,getWeak:h,onFreeze:p}},e391:function(e,t,r){var i=r("577e");e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:i(e)}},e439:function(e,t,r){var i=r("23e7"),n=r("d039"),o=r("fc6a"),s=r("06cf").f,a=r("83ab"),c=n((function(){s(1)})),l=!a||c;i({target:"Object",stat:!0,forced:l,sham:!a},{getOwnPropertyDescriptor:function(e,t){return s(o(e),t)}})},e444:function(e,t){e.exports=!0},e450:function(e,t,r){e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=104)}({0:function(e,t,r){"use strict";function i(e,t,r,i,n,o,s,a){var c,l="function"===typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=r,l._compiled=!0),i&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),s?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},l._ssrRegister=c):n&&(c=a?function(){n.call(this,this.$root.$options.shadowRoot)}:n),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(e,t){return c.call(t),u(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,c):[c]}return{exports:e,options:l}}r.d(t,"a",(function(){return i}))},10:function(e,t){e.exports=r("f3ad")},104:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:["el-input-number",e.inputNumberSize?"el-input-number--"+e.inputNumberSize:"",{"is-disabled":e.inputNumberDisabled},{"is-without-controls":!e.controls},{"is-controls-right":e.controlsAtRight}],on:{dragstart:function(e){e.preventDefault()}}},[e.controls?r("span",{directives:[{name:"repeat-click",rawName:"v-repeat-click",value:e.decrease,expression:"decrease"}],staticClass:"el-input-number__decrease",class:{"is-disabled":e.minDisabled},attrs:{role:"button"},on:{keydown:function(t){return!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.decrease(t)}}},[r("i",{class:"el-icon-"+(e.controlsAtRight?"arrow-down":"minus")})]):e._e(),e.controls?r("span",{directives:[{name:"repeat-click",rawName:"v-repeat-click",value:e.increase,expression:"increase"}],staticClass:"el-input-number__increase",class:{"is-disabled":e.maxDisabled},attrs:{role:"button"},on:{keydown:function(t){return!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.increase(t)}}},[r("i",{class:"el-icon-"+(e.controlsAtRight?"arrow-up":"plus")})]):e._e(),r("el-input",{ref:"input",attrs:{value:e.displayValue,placeholder:e.placeholder,disabled:e.inputNumberDisabled,size:e.inputNumberSize,max:e.max,min:e.min,name:e.name,label:e.label},on:{blur:e.handleBlur,focus:e.handleFocus,input:e.handleInput,change:e.handleInputChange},nativeOn:{keydown:[function(t){return!("button"in t)&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:(t.preventDefault(),e.increase(t))},function(t){return!("button"in t)&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:(t.preventDefault(),e.decrease(t))}]}})],1)},n=[];i._withStripped=!0;var o=r(10),s=r.n(o),a=r(22),c=r.n(a),l=r(30),u={name:"ElInputNumber",mixins:[c()("input")],inject:{elForm:{default:""},elFormItem:{default:""}},directives:{repeatClick:l["a"]},components:{ElInput:s.a},props:{step:{type:Number,default:1},stepStrictly:{type:Boolean,default:!1},max:{type:Number,default:1/0},min:{type:Number,default:-1/0},value:{},disabled:Boolean,size:String,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:""},name:String,label:String,placeholder:String,precision:{type:Number,validator:function(e){return e>=0&&e===parseInt(e,10)}}},data:function(){return{currentValue:0,userInput:null}},watch:{value:{immediate:!0,handler:function(e){var t=void 0===e?e:Number(e);if(void 0!==t){if(isNaN(t))return;if(this.stepStrictly){var r=this.getPrecision(this.step),i=Math.pow(10,r);t=Math.round(t/this.step)*i*this.step/i}void 0!==this.precision&&(t=this.toPrecision(t,this.precision))}t>=this.max&&(t=this.max),t<=this.min&&(t=this.min),this.currentValue=t,this.userInput=null,this.$emit("input",t)}}},computed:{minDisabled:function(){return this._decrease(this.value,this.step)<this.min},maxDisabled:function(){return this._increase(this.value,this.step)>this.max},numPrecision:function(){var e=this.value,t=this.step,r=this.getPrecision,i=this.precision,n=r(t);return void 0!==i?(n>i&&console.warn("[Element Warn][InputNumber]precision should not be less than the decimal places of step"),i):Math.max(r(e),n)},controlsAtRight:function(){return this.controls&&"right"===this.controlsPosition},_elFormItemSize:function(){return(this.elFormItem||{}).elFormItemSize},inputNumberSize:function(){return this.size||this._elFormItemSize||(this.$ELEMENT||{}).size},inputNumberDisabled:function(){return this.disabled||!!(this.elForm||{}).disabled},displayValue:function(){if(null!==this.userInput)return this.userInput;var e=this.currentValue;if("number"===typeof e){if(this.stepStrictly){var t=this.getPrecision(this.step),r=Math.pow(10,t);e=Math.round(e/this.step)*r*this.step/r}void 0!==this.precision&&(e=e.toFixed(this.precision))}return e}},methods:{toPrecision:function(e,t){return void 0===t&&(t=this.numPrecision),parseFloat(Math.round(e*Math.pow(10,t))/Math.pow(10,t))},getPrecision:function(e){if(void 0===e)return 0;var t=e.toString(),r=t.indexOf("."),i=0;return-1!==r&&(i=t.length-r-1),i},_increase:function(e,t){if("number"!==typeof e&&void 0!==e)return this.currentValue;var r=Math.pow(10,this.numPrecision);return this.toPrecision((r*e+r*t)/r)},_decrease:function(e,t){if("number"!==typeof e&&void 0!==e)return this.currentValue;var r=Math.pow(10,this.numPrecision);return this.toPrecision((r*e-r*t)/r)},increase:function(){if(!this.inputNumberDisabled&&!this.maxDisabled){var e=this.value||0,t=this._increase(e,this.step);this.setCurrentValue(t)}},decrease:function(){if(!this.inputNumberDisabled&&!this.minDisabled){var e=this.value||0,t=this._decrease(e,this.step);this.setCurrentValue(t)}},handleBlur:function(e){this.$emit("blur",e)},handleFocus:function(e){this.$emit("focus",e)},setCurrentValue:function(e){var t=this.currentValue;"number"===typeof e&&void 0!==this.precision&&(e=this.toPrecision(e,this.precision)),e>=this.max&&(e=this.max),e<=this.min&&(e=this.min),t!==e&&(this.userInput=null,this.$emit("input",e),this.$emit("change",e,t),this.currentValue=e)},handleInput:function(e){this.userInput=e},handleInputChange:function(e){var t=""===e?void 0:Number(e);isNaN(t)&&""!==e||this.setCurrentValue(t),this.userInput=null},select:function(){this.$refs.input.select()}},mounted:function(){var e=this.$refs.input.$refs.input;e.setAttribute("role","spinbutton"),e.setAttribute("aria-valuemax",this.max),e.setAttribute("aria-valuemin",this.min),e.setAttribute("aria-valuenow",this.currentValue),e.setAttribute("aria-disabled",this.inputNumberDisabled)},updated:function(){if(this.$refs&&this.$refs.input){var e=this.$refs.input.$refs.input;e.setAttribute("aria-valuenow",this.currentValue)}}},d=u,h=r(0),p=Object(h["a"])(d,i,n,!1,null,null,null);p.options.__file="packages/input-number/src/input-number.vue";var f=p.exports;f.install=function(e){e.component(f.name,f)};t["default"]=f},2:function(e,t){e.exports=r("5924")},22:function(e,t){e.exports=r("12f2")},30:function(e,t,r){"use strict";var i=r(2);t["a"]={bind:function(e,t,r){var n=null,o=void 0,s=function(){return r.context[t.expression].apply()},a=function(){Date.now()-o<100&&s(),clearInterval(n),n=null};Object(i["on"])(e,"mousedown",(function(e){0===e.button&&(o=Date.now(),Object(i["once"])(document,"mouseup",a),clearInterval(n),n=setInterval(s,100))}))}}}})},e452:function(e,t,r){"use strict";t.__esModule=!0;var i=i||{};i.Utils=i.Utils||{},i.Utils.focusFirstDescendant=function(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(i.Utils.attemptFocus(r)||i.Utils.focusFirstDescendant(r))return!0}return!1},i.Utils.focusLastDescendant=function(e){for(var t=e.childNodes.length-1;t>=0;t--){var r=e.childNodes[t];if(i.Utils.attemptFocus(r)||i.Utils.focusLastDescendant(r))return!0}return!1},i.Utils.attemptFocus=function(e){if(!i.Utils.isFocusable(e))return!1;i.Utils.IgnoreUtilFocusChanges=!0;try{e.focus()}catch(t){}return i.Utils.IgnoreUtilFocusChanges=!1,document.activeElement===e},i.Utils.isFocusable=function(e){if(e.tabIndex>0||0===e.tabIndex&&null!==e.getAttribute("tabIndex"))return!0;if(e.disabled)return!1;switch(e.nodeName){case"A":return!!e.href&&"ignore"!==e.rel;case"INPUT":return"hidden"!==e.type&&"file"!==e.type;case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},i.Utils.triggerEvent=function(e,t){var r=void 0;r=/^mouse|click/.test(t)?"MouseEvents":/^key/.test(t)?"KeyboardEvent":"HTMLEvents";for(var i=document.createEvent(r),n=arguments.length,o=Array(n>2?n-2:0),s=2;s<n;s++)o[s-2]=arguments[s];return i.initEvent.apply(i,[t].concat(o)),e.dispatchEvent?e.dispatchEvent(i):e.fireEvent("on"+t,i),e},i.Utils.keys={tab:9,enter:13,space:32,left:37,up:38,right:39,down:40,esc:27},t.default=i.Utils},e507:function(e,t,r){var i=r("512c");i(i.S+i.F,"Object",{assign:r("072d")})},e538:function(e,t,r){var i=r("b622");t.f=i},e58c:function(e,t,r){"use strict";var i=r("2ba4"),n=r("fc6a"),o=r("5926"),s=r("07fa"),a=r("a640"),c=Math.min,l=[].lastIndexOf,u=!!l&&1/[1].lastIndexOf(1,-0)<0,d=a("lastIndexOf"),h=u||!d;e.exports=h?function(e){if(u)return i(l,this,arguments)||0;var t=n(this),r=s(t),a=r-1;for(arguments.length>1&&(a=c(a,o(arguments[1]))),a<0&&(a=r+a);a>=0;a--)if(a in t&&t[a]===e)return a||0;return-1}:l},e5cb:function(e,t,r){"use strict";var i=r("d066"),n=r("1a2d"),o=r("9112"),s=r("3a9b"),a=r("d2bb"),c=r("e893"),l=r("7156"),u=r("e391"),d=r("ab36"),h=r("c770"),p=r("b980"),f=r("c430");e.exports=function(e,t,r,g){var m=g?2:1,_=e.split("."),v=_[_.length-1],E=i.apply(null,_);if(E){var A=E.prototype;if(!f&&n(A,"cause")&&delete A.cause,!r)return E;var y=i("Error"),S=t((function(e,t){var r=u(g?t:e,void 0),i=g?new E(e):new E;return void 0!==r&&o(i,"message",r),p&&o(i,"stack",h(i.stack,2)),this&&s(A,this)&&l(i,this,S),arguments.length>m&&d(i,arguments[m]),i}));if(S.prototype=A,"Error"!==v&&(a?a(S,y):c(S,y,{name:!0})),c(S,E),!f)try{A.name!==v&&o(A,"name",v),A.constructor=S}catch(C){}return S}}},e62d:function(e,t,r){"use strict";t.__esModule=!0,t.default=function(){if(n.default.prototype.$isServer)return 0;if(void 0!==s)return s;var e=document.createElement("div");e.className="el-scrollbar__wrap",e.style.visibility="hidden",e.style.width="100px",e.style.position="absolute",e.style.top="-9999px",document.body.appendChild(e);var t=e.offsetWidth;e.style.overflow="scroll";var r=document.createElement("div");r.style.width="100%",e.appendChild(r);var i=r.offsetWidth;return e.parentNode.removeChild(e),s=t-i,s};var i=r("2b0e"),n=o(i);function o(e){return e&&e.__esModule?e:{default:e}}var s=void 0},e667:function(e,t){e.exports=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}}},e671:function(e,t,r){(function(t,r){!function(t,r){e.exports=r()}(0,(function(){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof t?t:"undefined"!=typeof self?self:{};function i(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&r.path)}},r.exports),r.exports}var n=function(e){return e&&e.Math==Math&&e},o=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||Function("return this")(),s=function(e){try{return!!e()}catch(e){return!0}},a=!s((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),c={}.propertyIsEnumerable,l=Object.getOwnPropertyDescriptor,u={f:l&&!c.call({1:2},1)?function(e){var t=l(this,e);return!!t&&t.enumerable}:c},d=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},h={}.toString,p=function(e){return h.call(e).slice(8,-1)},f="".split,g=s((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==p(e)?f.call(e,""):Object(e)}:Object,m=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},_=function(e){return g(m(e))},v=function(e){return"object"==typeof e?null!==e:"function"==typeof e},E=function(e,t){if(!v(e))return e;var r,i;if(t&&"function"==typeof(r=e.toString)&&!v(i=r.call(e)))return i;if("function"==typeof(r=e.valueOf)&&!v(i=r.call(e)))return i;if(!t&&"function"==typeof(r=e.toString)&&!v(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")},A={}.hasOwnProperty,y=function(e,t){return A.call(e,t)},S=o.document,C=v(S)&&v(S.createElement),T=function(e){return C?S.createElement(e):{}},b=!a&&!s((function(){return 7!=Object.defineProperty(T("div"),"a",{get:function(){return 7}}).a})),I=Object.getOwnPropertyDescriptor,R={f:a?I:function(e,t){if(e=_(e),t=E(t,!0),b)try{return I(e,t)}catch(e){}if(y(e,t))return d(!u.f.call(e,t),e[t])}},w=/#|\.prototype\./,k=function(e,t){var r=N[O(e)];return r==P||r!=L&&("function"==typeof t?s(t):!!t)},O=k.normalize=function(e){return String(e).replace(w,".").toLowerCase()},N=k.data={},L=k.NATIVE="N",P=k.POLYFILL="P",D=k,M={},x=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},B=function(e,t,r){if(x(e),void 0===t)return e;switch(r){case 0:return function(){return e.call(t)};case 1:return function(r){return e.call(t,r)};case 2:return function(r,i){return e.call(t,r,i)};case 3:return function(r,i,n){return e.call(t,r,i,n)}}return function(){return e.apply(t,arguments)}},U=function(e){if(!v(e))throw TypeError(String(e)+" is not an object");return e},F=Object.defineProperty,V={f:a?F:function(e,t,r){if(U(e),t=E(t,!0),U(r),b)try{return F(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},j=a?function(e,t,r){return V.f(e,t,d(1,r))}:function(e,t,r){return e[t]=r,e},G=R.f,H=function(e){var t=function(t,r,i){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,i)}return e.apply(this,arguments)};return t.prototype=e.prototype,t},Q=function(e,t){var r,i,n,s,a,c,l,u,d=e.target,h=e.global,p=e.stat,f=e.proto,g=h?o:p?o[d]:(o[d]||{}).prototype,m=h?M:M[d]||(M[d]={}),_=m.prototype;for(n in t)r=!D(h?n:d+(p?".":"#")+n,e.forced)&&g&&y(g,n),a=m[n],r&&(c=e.noTargetGet?(u=G(g,n))&&u.value:g[n]),s=r&&c?c:t[n],r&&typeof a==typeof s||(l=e.bind&&r?B(s,o):e.wrap&&r?H(s):f&&"function"==typeof s?B(Function.call,s):s,(e.sham||s&&s.sham||a&&a.sham)&&j(l,"sham",!0),m[n]=l,f&&(y(M,i=d+"Prototype")||j(M,i,{}),M[i][n]=s,e.real&&_&&!_[n]&&j(_,n,s)))},W=Math.ceil,q=Math.floor,z=function(e){return isNaN(e=+e)?0:(e>0?q:W)(e)},Z=Math.min,Y=function(e){return e>0?Z(z(e),9007199254740991):0},K=Math.max,$=Math.min,J=function(e,t){var r=z(e);return r<0?K(r+t,0):$(r,t)},X=function(e){return function(t,r,i){var n,o=_(t),s=Y(o.length),a=J(i,s);if(e&&r!=r){for(;s>a;)if((n=o[a++])!=n)return!0}else for(;s>a;a++)if((e||a in o)&&o[a]===r)return e||a||0;return!e&&-1}},ee={includes:X(!0),indexOf:X(!1)},te={},re=ee.indexOf,ie=function(e,t){var r,i=_(e),n=0,o=[];for(r in i)!y(te,r)&&y(i,r)&&o.push(r);for(;t.length>n;)y(i,r=t[n++])&&(~re(o,r)||o.push(r));return o},ne=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],oe=Object.keys||function(e){return ie(e,ne)},se=a?Object.defineProperties:function(e,t){U(e);for(var r,i=oe(t),n=i.length,o=0;n>o;)V.f(e,r=i[o++],t[r]);return e};Q({target:"Object",stat:!0,forced:!a,sham:!a},{defineProperties:se});var ae=i((function(e){var t=M.Object,r=e.exports=function(e,r){return t.defineProperties(e,r)};t.defineProperties.sham&&(r.sham=!0)})),ce=function(e){return"function"==typeof e?e:void 0},le=function(e,t){return arguments.length<2?ce(M[e])||ce(o[e]):M[e]&&M[e][t]||o[e]&&o[e][t]},ue=le("JSON","stringify"),de=/[\uD800-\uDFFF]/g,he=/^[\uD800-\uDBFF]$/,pe=/^[\uDC00-\uDFFF]$/,fe=function(e,t,r){var i=r.charAt(t-1),n=r.charAt(t+1);return he.test(e)&&!pe.test(n)||pe.test(e)&&!he.test(i)?"\\u"+e.charCodeAt(0).toString(16):e},ge=s((function(){return'"\\udf06\\ud834"'!==ue("\udf06\ud834")||'"\\udead"'!==ue("\udead")}));ue&&Q({target:"JSON",stat:!0,forced:ge},{stringify:function(e,t,r){var i=ue.apply(null,arguments);return"string"==typeof i?i.replace(de,fe):i}}),M.JSON||(M.JSON={stringify:JSON.stringify});var me,_e,ve=function(e,t,r){return M.JSON.stringify.apply(null,arguments)},Ee=Array.isArray||function(e){return"Array"==p(e)},Ae=function(e){return Object(m(e))},ye=function(e,t,r){var i=E(t);i in e?V.f(e,i,d(0,r)):e[i]=r},Se="__core-js_shared__",Ce=o[Se]||function(e,t){try{j(o,e,t)}catch(n){o[e]=t}return t}(Se,{}),Te=i((function(e){(e.exports=function(e,t){return Ce[e]||(Ce[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.4.3",mode:"pure",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})})),be=0,Ie=Math.random(),Re=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++be+Ie).toString(36)},we=!!Object.getOwnPropertySymbols&&!s((function(){return!String(Symbol())})),ke=we&&!Symbol.sham&&"symbol"==typeof Symbol(),Oe=Te("wks"),Ne=o.Symbol,Le=ke?Ne:Re,Pe=function(e){return y(Oe,e)||(we&&y(Ne,e)?Oe[e]=Ne[e]:Oe[e]=Le("Symbol."+e)),Oe[e]},De=Pe("species"),Me=function(e,t){var r;return Ee(e)&&("function"!=typeof(r=e.constructor)||r!==Array&&!Ee(r.prototype)?v(r)&&null===(r=r[De])&&(r=void 0):r=void 0),new(void 0===r?Array:r)(0===t?0:t)},xe=le("navigator","userAgent")||"",Be=o.process,Ue=Be&&Be.versions,Fe=Ue&&Ue.v8;Fe?_e=(me=Fe.split("."))[0]+me[1]:xe&&(!(me=xe.match(/Edge\/(\d+)/))||me[1]>=74)&&(me=xe.match(/Chrome\/(\d+)/))&&(_e=me[1]);var Ve=_e&&+_e,je=Pe("species"),Ge=function(e){return Ve>=51||!s((function(){var t=[];return(t.constructor={})[je]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},He=Pe("isConcatSpreadable"),Qe=9007199254740991,We="Maximum allowed index exceeded",qe=Ve>=51||!s((function(){var e=[];return e[He]=!1,e.concat()[0]!==e})),ze=Ge("concat"),Ze=function(e){if(!v(e))return!1;var t=e[He];return void 0!==t?!!t:Ee(e)};Q({target:"Array",proto:!0,forced:!qe||!ze},{concat:function(e){var t,r,i,n,o,s=Ae(this),a=Me(s,0),c=0;for(t=-1,i=arguments.length;t<i;t++)if(Ze(o=-1===t?s:arguments[t])){if(c+(n=Y(o.length))>Qe)throw TypeError(We);for(r=0;r<n;r++,c++)r in o&&ye(a,c,o[r])}else{if(c>=Qe)throw TypeError(We);ye(a,c++,o)}return a.length=c,a}});var Ye=function(e){return M[e+"Prototype"]},Ke=Ye("Array").concat,$e=Array.prototype,Je=function(e){var t=e.concat;return e===$e||e instanceof Array&&t===$e.concat?Ke:t},Xe=!s((function(){return Object.isExtensible(Object.preventExtensions({}))})),et=i((function(e){var t=V.f,r=Re("meta"),i=0,n=Object.isExtensible||function(){return!0},o=function(e){t(e,r,{value:{objectID:"O"+ ++i,weakData:{}}})},s=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!v(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!y(e,r)){if(!n(e))return"F";if(!t)return"E";o(e)}return e[r].objectID},getWeakData:function(e,t){if(!y(e,r)){if(!n(e))return!0;if(!t)return!1;o(e)}return e[r].weakData},onFreeze:function(e){return Xe&&s.REQUIRED&&n(e)&&!y(e,r)&&o(e),e}};te[r]=!0})),tt={},rt=Pe("iterator"),it=Array.prototype,nt=function(e){return void 0!==e&&(tt.Array===e||it[rt]===e)},ot={};ot[Pe("toStringTag")]="z";var st,at,ct,lt="[object z]"===String(ot),ut=Pe("toStringTag"),dt="Arguments"==p(function(){return arguments}()),ht=lt?p:function(e){var t,r,i;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),ut))?r:dt?p(t):"Object"==(i=p(t))&&"function"==typeof t.callee?"Arguments":i},pt=Pe("iterator"),ft=function(e){if(null!=e)return e[pt]||e["@@iterator"]||tt[ht(e)]},gt=function(e,t,r,i){try{return i?t(U(r)[0],r[1]):t(r)}catch(t){var n=e.return;throw void 0!==n&&U(n.call(e)),t}},mt=i((function(e){var t=function(e,t){this.stopped=e,this.result=t};(e.exports=function(e,r,i,n,o){var s,a,c,l,u,d,h,p=B(r,i,n?2:1);if(o)s=e;else{if("function"!=typeof(a=ft(e)))throw TypeError("Target is not iterable");if(nt(a)){for(c=0,l=Y(e.length);l>c;c++)if((u=n?p(U(h=e[c])[0],h[1]):p(e[c]))&&u instanceof t)return u;return new t(!1)}s=a.call(e)}for(d=s.next;!(h=d.call(s)).done;)if("object"==typeof(u=gt(s,p,h.value,n))&&u&&u instanceof t)return u;return new t(!1)}).stop=function(e){return new t(!0,e)}})),_t=function(e,t,r){if(!(e instanceof t))throw TypeError("Incorrect "+(r?r+" ":"")+"invocation");return e},vt=lt?{}.toString:function(){return"[object "+ht(this)+"]"},Et=V.f,At=Pe("toStringTag"),yt=function(e,t,r,i){if(e){var n=r?e:e.prototype;y(n,At)||Et(n,At,{configurable:!0,value:t}),i&&!lt&&j(n,"toString",vt)}},St=[].push,Ct=function(e){var t=1==e,r=2==e,i=3==e,n=4==e,o=6==e,s=5==e||o;return function(a,c,l,u){for(var d,h,p=Ae(a),f=g(p),m=B(c,l,3),_=Y(f.length),v=0,E=u||Me,A=t?E(a,_):r?E(a,0):void 0;_>v;v++)if((s||v in f)&&(h=m(d=f[v],v,p),e))if(t)A[v]=h;else if(h)switch(e){case 3:return!0;case 5:return d;case 6:return v;case 2:St.call(A,d)}else if(n)return!1;return o?-1:i||n?n:A}},Tt={forEach:Ct(0),map:Ct(1),filter:Ct(2),some:Ct(3),every:Ct(4),find:Ct(5),findIndex:Ct(6)},bt=Te("native-function-to-string",Function.toString),It=o.WeakMap,Rt="function"==typeof It&&/native code/.test(bt.call(It)),wt=Te("keys"),kt=function(e){return wt[e]||(wt[e]=Re(e))},Ot=o.WeakMap;if(Rt){var Nt=new Ot,Lt=Nt.get,Pt=Nt.has,Dt=Nt.set;st=function(e,t){return Dt.call(Nt,e,t),t},at=function(e){return Lt.call(Nt,e)||{}},ct=function(e){return Pt.call(Nt,e)}}else{var Mt=kt("state");te[Mt]=!0,st=function(e,t){return j(e,Mt,t),t},at=function(e){return y(e,Mt)?e[Mt]:{}},ct=function(e){return y(e,Mt)}}var xt={set:st,get:at,has:ct,enforce:function(e){return ct(e)?at(e):st(e,{})},getterFor:function(e){return function(t){var r;if(!v(t)||(r=at(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return r}}},Bt=V.f,Ut=Tt.forEach,Ft=xt.set,Vt=xt.getterFor,jt=function(e,t,r){var i,n=-1!==e.indexOf("Map"),c=-1!==e.indexOf("Weak"),l=n?"set":"add",u=o[e],d=u&&u.prototype,h={};if(a&&"function"==typeof u&&(c||d.forEach&&!s((function(){(new u).entries().next()})))){i=t((function(t,r){Ft(_t(t,i,e),{type:e,collection:new u}),null!=r&&mt(r,t[l],t,n)}));var p=Vt(e);Ut(["add","clear","delete","forEach","get","has","set","keys","values","entries"],(function(e){var t="add"==e||"set"==e;!(e in d)||c&&"clear"==e||j(i.prototype,e,(function(r,i){var n=p(this).collection;if(!t&&c&&!v(r))return"get"==e&&void 0;var o=n[e](0===r?0:r,i);return t?this:o}))})),c||Bt(i.prototype,"size",{configurable:!0,get:function(){return p(this).collection.size}})}else i=r.getConstructor(t,e,n,l),et.REQUIRED=!0;return yt(i,e,!1,!0),h[e]=i,Q({global:!0,forced:!0},h),c||r.setStrong(i,e,n),i},Gt=le("document","documentElement"),Ht=kt("IE_PROTO"),Qt=function(){},Wt=function(){var e,t=T("iframe"),r=ne.length;for(t.style.display="none",Gt.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),Wt=e.F;r--;)delete Wt.prototype[ne[r]];return Wt()},qt=Object.create||function(e,t){var r;return null!==e?(Qt.prototype=U(e),r=new Qt,Qt.prototype=null,r[Ht]=e):r=Wt(),void 0===t?r:se(r,t)};te[Ht]=!0;var zt,Zt,Yt,Kt=function(e,t,r,i){i&&i.enumerable?e[t]=r:j(e,t,r)},$t=function(e,t,r){for(var i in t)r&&r.unsafe&&e[i]?e[i]=t[i]:Kt(e,i,t[i],r);return e},Jt=!s((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Xt=kt("IE_PROTO"),er=Object.prototype,tr=Jt?Object.getPrototypeOf:function(e){return e=Ae(e),y(e,Xt)?e[Xt]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?er:null},rr=(Pe("iterator"),!1);[].keys&&("next"in(Yt=[].keys())?(Zt=tr(tr(Yt)))!==Object.prototype&&(zt=Zt):rr=!0),null==zt&&(zt={});var ir={IteratorPrototype:zt,BUGGY_SAFARI_ITERATORS:rr},nr=ir.IteratorPrototype,or=function(){return this},sr=function(e,t,r){var i=t+" Iterator";return e.prototype=qt(nr,{next:d(1,r)}),yt(e,i,!1,!0),tt[i]=or,e},ar=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(r,[]),t=r instanceof Array}catch(e){}return function(r,i){return U(r),function(e){if(!v(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}(i),t?e.call(r,i):r.__proto__=i,r}}():void 0),cr=ir.IteratorPrototype,lr=ir.BUGGY_SAFARI_ITERATORS,ur=Pe("iterator"),dr="keys",hr="values",pr="entries",fr=function(){return this},gr=function(e,t,r,i,n,o,s){sr(r,t,i);var a,c,l,u=function(e){if(e===n&&g)return g;if(!lr&&e in p)return p[e];switch(e){case dr:case hr:case pr:return function(){return new r(this,e)}}return function(){return new r(this)}},d=t+" Iterator",h=!1,p=e.prototype,f=p[ur]||p["@@iterator"]||n&&p[n],g=!lr&&f||u(n),m="Array"==t&&p.entries||f;if(m&&(a=tr(m.call(new e)),cr!==Object.prototype&&a.next&&(yt(a,d,!0,!0),tt[d]=fr)),n==hr&&f&&f.name!==hr&&(h=!0,g=function(){return f.call(this)}),s&&p[ur]!==g&&j(p,ur,g),tt[t]=g,n)if(c={values:u(hr),keys:o?g:u(dr),entries:u(pr)},s)for(l in c)(lr||h||!(l in p))&&Kt(p,l,c[l]);else Q({target:t,proto:!0,forced:lr||h},c);return c},mr=Pe("species"),_r=function(e){var t=le(e),r=V.f;a&&t&&!t[mr]&&r(t,mr,{configurable:!0,get:function(){return this}})},vr=V.f,Er=et.fastKey,Ar=xt.set,yr=xt.getterFor,Sr=(jt("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),{getConstructor:function(e,t,r,i){var n=e((function(e,o){_t(e,n,t),Ar(e,{type:t,index:qt(null),first:void 0,last:void 0,size:0}),a||(e.size=0),null!=o&&mt(o,e[i],e,r)})),o=yr(t),s=function(e,t,r){var i,n,s=o(e),l=c(e,t);return l?l.value=r:(s.last=l={index:n=Er(t,!0),key:t,value:r,previous:i=s.last,next:void 0,removed:!1},s.first||(s.first=l),i&&(i.next=l),a?s.size++:e.size++,"F"!==n&&(s.index[n]=l)),e},c=function(e,t){var r,i=o(e),n=Er(t);if("F"!==n)return i.index[n];for(r=i.first;r;r=r.next)if(r.key==t)return r};return $t(n.prototype,{clear:function(){for(var e=o(this),t=e.index,r=e.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete t[r.index],r=r.next;e.first=e.last=void 0,a?e.size=0:this.size=0},delete:function(e){var t=this,r=o(t),i=c(t,e);if(i){var n=i.next,s=i.previous;delete r.index[i.index],i.removed=!0,s&&(s.next=n),n&&(n.previous=s),r.first==i&&(r.first=n),r.last==i&&(r.last=s),a?r.size--:t.size--}return!!i},forEach:function(e){for(var t,r=o(this),i=B(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.next:r.first;)for(i(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!c(this,e)}}),$t(n.prototype,r?{get:function(e){var t=c(this,e);return t&&t.value},set:function(e,t){return s(this,0===e?0:e,t)}}:{add:function(e){return s(this,e=0===e?0:e,e)}}),a&&vr(n.prototype,"size",{get:function(){return o(this).size}}),n},setStrong:function(e,t,r){var i=t+" Iterator",n=yr(t),o=yr(i);gr(e,t,(function(e,t){Ar(this,{type:i,target:e,state:n(e),kind:t,last:void 0})}),(function(){for(var e=o(this),t=e.kind,r=e.last;r&&r.removed;)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?"keys"==t?{value:r.key,done:!1}:"values"==t?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),_r(t)}}),function(e){return function(t,r){var i,n,o=String(m(t)),s=z(r),a=o.length;return s<0||s>=a?e?"":void 0:(i=o.charCodeAt(s))<55296||i>56319||s+1===a||(n=o.charCodeAt(s+1))<56320||n>57343?e?o.charAt(s):i:e?o.slice(s,s+2):n-56320+(i-55296<<10)+65536}}),Cr={codeAt:Sr(!1),charAt:Sr(!0)},Tr=Cr.charAt,br="String Iterator",Ir=xt.set,Rr=xt.getterFor(br);gr(String,"String",(function(e){Ir(this,{type:br,string:String(e),index:0})}),(function(){var e,t=Rr(this),r=t.string,i=t.index;return i>=r.length?{value:void 0,done:!0}:(e=Tr(r,i),t.index+=e.length,{value:e,done:!1})}));var wr="Array Iterator",kr=xt.set,Or=xt.getterFor(wr);gr(Array,"Array",(function(e,t){kr(this,{type:wr,target:_(e),index:0,kind:t})}),(function(){var e=Or(this),t=e.target,r=e.kind,i=e.index++;return!t||i>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:i,done:!1}:"values"==r?{value:t[i],done:!1}:{value:[i,t[i]],done:!1}}),"values"),tt.Arguments=tt.Array;var Nr=Pe("toStringTag");for(var Lr in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var Pr=o[Lr],Dr=Pr&&Pr.prototype;Dr&&!Dr[Nr]&&j(Dr,Nr,Lr),tt[Lr]=tt.Array}var Mr=M.Map,xr=Pe("match"),Br=function(e){if(function(e){var t;return v(e)&&(void 0!==(t=e[xr])?!!t:"RegExp"==p(e))}(e))throw TypeError("The method doesn't accept regular expressions");return e},Ur=Pe("match"),Fr=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[Ur]=!1,"/./"[e](t)}catch(e){}}return!1},Vr="".endsWith,jr=Math.min,Gr=Fr("endsWith");Q({target:"String",proto:!0,forced:!Gr},{endsWith:function(e){var t=String(m(this));Br(e);var r=arguments.length>1?arguments[1]:void 0,i=Y(t.length),n=void 0===r?i:jr(Y(r),i),o=String(e);return Vr?Vr.call(t,o,n):t.slice(n-o.length,n)===o}});var Hr=Ye("String").endsWith,Qr=String.prototype,Wr=function(e){var t=e.endsWith;return"string"==typeof e||e===Qr||e instanceof String&&t===Qr.endsWith?Hr:t},qr=function(e,t){var r=[][e];return!r||!s((function(){r.call(null,t||function(){throw 1},1)}))},zr=Tt.forEach,Zr=qr("forEach")?function(e){return zr(this,e,arguments.length>1?arguments[1]:void 0)}:[].forEach;Q({target:"Array",proto:!0,forced:[].forEach!=Zr},{forEach:Zr});var Yr=Ye("Array").forEach,Kr=Array.prototype,$r={DOMTokenList:!0,NodeList:!0},Jr=function(e){var t=e.forEach;return e===Kr||e instanceof Array&&t===Kr.forEach||$r.hasOwnProperty(ht(e))?Yr:t},Xr={f:Object.getOwnPropertySymbols},ei=Object.assign,ti=!ei||s((function(){var e={},t={},r=Symbol(),i="abcdefghijklmnopqrst";return e[r]=7,i.split("").forEach((function(e){t[e]=e})),7!=ei({},e)[r]||oe(ei({},t)).join("")!=i}))?function(e,t){for(var r=Ae(e),i=arguments.length,n=1,o=Xr.f,s=u.f;i>n;)for(var c,l=g(arguments[n++]),d=o?oe(l).concat(o(l)):oe(l),h=d.length,p=0;h>p;)c=d[p++],a&&!s.call(l,c)||(r[c]=l[c]);return r}:ei;Q({target:"Object",stat:!0,forced:Object.assign!==ti},{assign:ti});var ri=M.Object.assign,ii=s((function(){oe(1)}));Q({target:"Object",stat:!0,forced:ii},{keys:function(e){return oe(Ae(e))}});var ni=M.Object.keys,oi=function(e){return function(t,r,i,n){x(r);var o=Ae(t),s=g(o),a=Y(o.length),c=e?a-1:0,l=e?-1:1;if(i<2)for(;;){if(c in s){n=s[c],c+=l;break}if(c+=l,e?c<0:a<=c)throw TypeError("Reduce of empty array with no initial value")}for(;e?c>=0:a>c;c+=l)c in s&&(n=r(n,s[c],c,o));return n}},si={left:oi(!1),right:oi(!0)}.left;Q({target:"Array",proto:!0,forced:qr("reduce")},{reduce:function(e){return si(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}});var ai=Ye("Array").reduce,ci=Array.prototype,li=function(e){var t=e.reduce;return e===ci||e instanceof Array&&t===ci.reduce?ai:t};Q({target:"Object",stat:!0,forced:!a,sham:!a},{defineProperty:V.f});var ui=i((function(e){var t=M.Object,r=e.exports=function(e,r,i){return t.defineProperty(e,r,i)};t.defineProperty.sham&&(r.sham=!0)})),di=ui,hi="\t\n\v\f\r                　\u2028\u2029\ufeff",pi="["+hi+"]",fi=RegExp("^"+pi+pi+"*"),gi=RegExp(pi+pi+"*$"),mi=function(e){return function(t){var r=String(m(t));return 1&e&&(r=r.replace(fi,"")),2&e&&(r=r.replace(gi,"")),r}},_i={start:mi(1),end:mi(2),trim:mi(3)},vi=_i.trim,Ei=o.parseInt,Ai=/^[+-]?0[Xx]/,yi=8!==Ei(hi+"08")||22!==Ei(hi+"0x16")?function(e,t){var r=vi(String(e));return Ei(r,t>>>0||(Ai.test(r)?16:10))}:Ei;Q({global:!0,forced:parseInt!=yi},{parseInt:yi});var Si=M.parseInt;let Ci=!0,Ti=!0;function bi(e,t,r){const i=e.match(t);return i&&i.length>=r&&Si(i[r],10)}function Ii(e,t,r){if(!e.RTCPeerConnection)return;const i=e.RTCPeerConnection.prototype,n=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return n.apply(this,arguments);const o=e=>{const t=r(e);t&&i(t)};return this._eventMap=this._eventMap||{},this._eventMap[i]=o,n.apply(this,[e,o])};const o=i.removeEventListener;i.removeEventListener=function(e,r){if(e!==t||!this._eventMap||!this._eventMap[r])return o.apply(this,arguments);const i=this._eventMap[r];return delete this._eventMap[r],o.apply(this,[e,i])},di(i,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function Ri(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Ci=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function wi(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Ti=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function ki(){if("object"==typeof window){if(Ci)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function Oi(e,t){Ti&&console.warn(e+" is deprecated, please use "+t+" instead.")}function Ni(e){const{navigator:t}=e,r={browser:null,version:null};if(void 0===e||!e.navigator)return r.browser="Not a browser.",r;if(t.mozGetUserMedia)r.browser="firefox",r.version=bi(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)r.browser="chrome",r.version=bi(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))r.browser="edge",r.version=bi(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return r.browser="Not a supported browser.",r;r.browser="safari",r.version=bi(t.userAgent,/AppleWebKit\/(\d+)\./,1),r.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return r}function Li(e){return"[object Object]"===Object.prototype.toString.call(e)}function Pi(e){var t;return Li(e)?li(t=ni(e)).call(t,(function(t,r){const i=Li(e[r]),n=i?Pi(e[r]):e[r],o=i&&!ni(n).length;return void 0===n||o?t:ri(t,{[r]:n})}),{}):e}function Di(e,t,r){const i=r?"outbound-rtp":"inbound-rtp",n=new Mr;if(null===t)return n;const o=[];return Jr(e).call(e,e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)}),Jr(o).call(o,t=>{Jr(e).call(e,r=>{r.type===i&&r.trackId===t.id&&function e(t,r,i){var n;r&&!i.has(r.id)&&(i.set(r.id,r),Jr(n=ni(r)).call(n,n=>{if(Wr(n).call(n,"Id"))e(t,t.get(r[n]),i);else if(Wr(n).call(n,"Ids")){var o;Jr(o=r[n]).call(o,r=>{e(t,t.get(r),i)})}}))}(e,r,n)})}),n}var Mi=R.f,xi=s((function(){Mi(1)}));Q({target:"Object",stat:!0,forced:!a||xi,sham:!a},{getOwnPropertyDescriptor:function(e,t){return Mi(_(e),t)}});var Bi=i((function(e){var t=M.Object,r=e.exports=function(e,r){return t.getOwnPropertyDescriptor(e,r)};t.getOwnPropertyDescriptor.sham&&(r.sham=!0)})),Ui=Tt.filter;Q({target:"Array",proto:!0,forced:!Ge("filter")},{filter:function(e){return Ui(this,e,arguments.length>1?arguments[1]:void 0)}});var Fi=Ye("Array").filter,Vi=Array.prototype,ji=function(e){var t=e.filter;return e===Vi||e instanceof Array&&t===Vi.filter?Fi:t},Gi=o.Promise,Hi=Pe("iterator"),Qi=!1;try{var Wi=0,qi={next:function(){return{done:!!Wi++}},return:function(){Qi=!0}};qi[Hi]=function(){return this},Array.from(qi,(function(){throw 2}))}catch(e){}var zi,Zi,Yi,Ki=function(e,t){if(!t&&!Qi)return!1;var r=!1;try{var i={};i[Hi]=function(){return{next:function(){return{done:r=!0}}}},e(i)}catch(e){}return r},$i=Pe("species"),Ji=function(e,t){var r,i=U(e).constructor;return void 0===i||null==(r=U(i)[$i])?t:x(r)},Xi=/(iphone|ipod|ipad).*applewebkit/i.test(xe),en=o.location,tn=o.setImmediate,rn=o.clearImmediate,nn=o.process,on=o.MessageChannel,sn=o.Dispatch,an=0,cn={},ln="onreadystatechange",un=function(e){if(cn.hasOwnProperty(e)){var t=cn[e];delete cn[e],t()}},dn=function(e){return function(){un(e)}},hn=function(e){un(e.data)},pn=function(e){o.postMessage(e+"",en.protocol+"//"+en.host)};tn&&rn||(tn=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return cn[++an]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},zi(an),an},rn=function(e){delete cn[e]},"process"==p(nn)?zi=function(e){nn.nextTick(dn(e))}:sn&&sn.now?zi=function(e){sn.now(dn(e))}:on&&!Xi?(Yi=(Zi=new on).port2,Zi.port1.onmessage=hn,zi=B(Yi.postMessage,Yi,1)):!o.addEventListener||"function"!=typeof postMessage||o.importScripts||s(pn)?zi=ln in T("script")?function(e){Gt.appendChild(T("script")).onreadystatechange=function(){Gt.removeChild(this),un(e)}}:function(e){setTimeout(dn(e),0)}:(zi=pn,o.addEventListener("message",hn,!1)));var fn,gn,mn,_n,vn,En,An,yn,Sn={set:tn,clear:rn},Cn=R.f,Tn=Sn.set,bn=o.MutationObserver||o.WebKitMutationObserver,In=o.process,Rn=o.Promise,wn="process"==p(In),kn=Cn(o,"queueMicrotask"),On=kn&&kn.value;On||(fn=function(){var e,t;for(wn&&(e=In.domain)&&e.exit();gn;){t=gn.fn,gn=gn.next;try{t()}catch(e){throw gn?_n():mn=void 0,e}}mn=void 0,e&&e.enter()},wn?_n=function(){In.nextTick(fn)}:bn&&!Xi?(vn=!0,En=document.createTextNode(""),new bn(fn).observe(En,{characterData:!0}),_n=function(){En.data=vn=!vn}):Rn&&Rn.resolve?(An=Rn.resolve(void 0),yn=An.then,_n=function(){yn.call(An,fn)}):_n=function(){Tn.call(o,fn)});var Nn,Ln,Pn,Dn=On||function(e){var t={fn:e,next:void 0};mn&&(mn.next=t),gn||(gn=t,_n()),mn=t},Mn=function(e){var t,r;this.promise=new e((function(e,i){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=i})),this.resolve=x(t),this.reject=x(r)},xn={f:function(e){return new Mn(e)}},Bn=function(e,t){if(U(e),v(t)&&t.constructor===e)return t;var r=xn.f(e);return(0,r.resolve)(t),r.promise},Un=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},Fn=Sn.set,Vn=Pe("species"),jn="Promise",Gn=xt.get,Hn=xt.set,Qn=xt.getterFor(jn),Wn=Gi,qn=o.TypeError,zn=o.document,Zn=o.process,Yn=Te("inspectSource"),Kn=(le("fetch"),xn.f),$n=Kn,Jn="process"==p(Zn),Xn=!!(zn&&zn.createEvent&&o.dispatchEvent),eo="unhandledrejection",to=D(jn,(function(){if(Yn(Wn)===String(Wn)){if(66===Ve)return!0;if(!Jn&&"function"!=typeof PromiseRejectionEvent)return!0}if(!Wn.prototype.finally)return!0;if(Ve>=51&&/native code/.test(Wn))return!1;var e=Wn.resolve(1),t=function(e){e((function(){}),(function(){}))};return(e.constructor={})[Vn]=t,!(e.then((function(){}))instanceof t)})),ro=to||!Ki((function(e){Wn.all(e).catch((function(){}))})),io=function(e){var t;return!(!v(e)||"function"!=typeof(t=e.then))&&t},no=function(e,t,r){if(!t.notified){t.notified=!0;var i=t.reactions;Dn((function(){for(var n=t.value,o=1==t.state,s=0;i.length>s;){var a,c,l,u=i[s++],d=o?u.ok:u.fail,h=u.resolve,p=u.reject,f=u.domain;try{d?(o||(2===t.rejection&&co(e,t),t.rejection=1),!0===d?a=n:(f&&f.enter(),a=d(n),f&&(f.exit(),l=!0)),a===u.promise?p(qn("Promise-chain cycle")):(c=io(a))?c.call(a,h,p):h(a)):p(n)}catch(e){f&&!l&&f.exit(),p(e)}}t.reactions=[],t.notified=!1,r&&!t.rejection&&so(e,t)}))}},oo=function(e,t,r){var i,n;Xn?((i=zn.createEvent("Event")).promise=t,i.reason=r,i.initEvent(e,!1,!0),o.dispatchEvent(i)):i={promise:t,reason:r},(n=o["on"+e])?n(i):e===eo&&function(e,t){var r=o.console;r&&r.error&&(1===arguments.length?r.error(e):r.error(e,t))}("Unhandled promise rejection",r)},so=function(e,t){Fn.call(o,(function(){var r,i=t.value;if(ao(t)&&(r=Un((function(){Jn?Zn.emit("unhandledRejection",i,e):oo(eo,e,i)})),t.rejection=Jn||ao(t)?2:1,r.error))throw r.value}))},ao=function(e){return 1!==e.rejection&&!e.parent},co=function(e,t){Fn.call(o,(function(){Jn?Zn.emit("rejectionHandled",e):oo("rejectionhandled",e,t.value)}))},lo=function(e,t,r,i){return function(n){e(t,r,n,i)}},uo=function(e,t,r,i){t.done||(t.done=!0,i&&(t=i),t.value=r,t.state=2,no(e,t,!0))},ho=function(e,t,r,i){if(!t.done){t.done=!0,i&&(t=i);try{if(e===r)throw qn("Promise can't be resolved itself");var n=io(r);n?Dn((function(){var i={done:!1};try{n.call(r,lo(ho,e,i,t),lo(uo,e,i,t))}catch(r){uo(e,i,r,t)}})):(t.value=r,t.state=1,no(e,t,!1))}catch(r){uo(e,{done:!1},r,t)}}};to&&(Wn=function(e){_t(this,Wn,jn),x(e),Nn.call(this);var t=Gn(this);try{e(lo(ho,this,t),lo(uo,this,t))}catch(e){uo(this,t,e)}},(Nn=function(e){Hn(this,{type:jn,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=$t(Wn.prototype,{then:function(e,t){var r=Qn(this),i=Kn(Ji(this,Wn));return i.ok="function"!=typeof e||e,i.fail="function"==typeof t&&t,i.domain=Jn?Zn.domain:void 0,r.parent=!0,r.reactions.push(i),0!=r.state&&no(this,r,!1),i.promise},catch:function(e){return this.then(void 0,e)}}),Ln=function(){var e=new Nn,t=Gn(e);this.promise=e,this.resolve=lo(ho,e,t),this.reject=lo(uo,e,t)},xn.f=Kn=function(e){return e===Wn||e===Pn?new Ln(e):$n(e)}),Q({global:!0,wrap:!0,forced:to},{Promise:Wn}),yt(Wn,jn,!1,!0),_r(jn),Pn=le(jn),Q({target:jn,stat:!0,forced:to},{reject:function(e){var t=Kn(this);return t.reject.call(void 0,e),t.promise}}),Q({target:jn,stat:!0,forced:!0},{resolve:function(e){return Bn(this===Pn?Wn:this,e)}}),Q({target:jn,stat:!0,forced:ro},{all:function(e){var t=this,r=Kn(t),i=r.resolve,n=r.reject,o=Un((function(){var r=x(t.resolve),o=[],s=0,a=1;mt(e,(function(e){var c=s++,l=!1;o.push(void 0),a++,r.call(t,e).then((function(e){l||(l=!0,o[c]=e,--a||i(o))}),n)})),--a||i(o)}));return o.error&&n(o.value),r.promise},race:function(e){var t=this,r=Kn(t),i=r.reject,n=Un((function(){var n=x(t.resolve);mt(e,(function(e){n.call(t,e).then(r.resolve,i)}))}));return n.error&&i(n.value),r.promise}}),Q({target:"Promise",stat:!0},{allSettled:function(e){var t=this,r=xn.f(t),i=r.resolve,n=r.reject,o=Un((function(){var r=x(t.resolve),n=[],o=0,s=1;mt(e,(function(e){var a=o++,c=!1;n.push(void 0),s++,r.call(t,e).then((function(e){c||(c=!0,n[a]={status:"fulfilled",value:e},--s||i(n))}),(function(e){c||(c=!0,n[a]={status:"rejected",reason:e},--s||i(n))}))})),--s||i(n)}));return o.error&&n(o.value),r.promise}}),Q({target:"Promise",proto:!0,real:!0},{finally:function(e){var t=Ji(this,le("Promise")),r="function"==typeof e;return this.then(r?function(r){return Bn(t,e()).then((function(){return r}))}:e,r?function(r){return Bn(t,e()).then((function(){throw r}))}:e)}});var po=M.Promise,fo=po,go=Tt.map;Q({target:"Array",proto:!0,forced:!Ge("map")},{map:function(e){return go(this,e,arguments.length>1?arguments[1]:void 0)}});var mo=Ye("Array").map,_o=Array.prototype,vo=function(e){var t=e.map;return e===_o||e instanceof Array&&t===_o.map?mo:t},Eo=Math.max,Ao=Math.min,yo=9007199254740991,So="Maximum allowed length exceeded";Q({target:"Array",proto:!0,forced:!Ge("splice")},{splice:function(e,t){var r,i,n,o,s,a,c=Ae(this),l=Y(c.length),u=J(e,l),d=arguments.length;if(0===d?r=i=0:1===d?(r=0,i=l-u):(r=d-2,i=Ao(Eo(z(t),0),l-u)),l+r-i>yo)throw TypeError(So);for(n=Me(c,i),o=0;o<i;o++)(s=u+o)in c&&ye(n,o,c[s]);if(n.length=i,r<i){for(o=u;o<l-i;o++)a=o+r,(s=o+i)in c?c[a]=c[s]:delete c[a];for(o=l;o>l-i+r;o--)delete c[o-1]}else if(r>i)for(o=l-i;o>u;o--)a=o+r-1,(s=o+i-1)in c?c[a]=c[s]:delete c[a];for(o=0;o<r;o++)c[o+u]=arguments[o+2];return c.length=l-i+r,n}});var Co=Ye("Array").splice,To=Array.prototype,bo=function(e){var t=e.splice;return e===To||e instanceof Array&&t===To.splice?Co:t},Io=ee.indexOf,Ro=[].indexOf,wo=!!Ro&&1/[1].indexOf(1,-0)<0,ko=qr("indexOf");Q({target:"Array",proto:!0,forced:wo||ko},{indexOf:function(e){return wo?Ro.apply(this,arguments)||0:Io(this,e,arguments.length>1?arguments[1]:void 0)}});var Oo=Ye("Array").indexOf,No=Array.prototype,Lo=function(e){var t=e.indexOf;return e===No||e instanceof Array&&t===No.indexOf?Oo:t},Po=Pe("species"),Do=[].slice,Mo=Math.max;Q({target:"Array",proto:!0,forced:!Ge("slice")},{slice:function(e,t){var r,i,n,o=_(this),s=Y(o.length),a=J(e,s),c=J(void 0===t?s:t,s);if(Ee(o)&&("function"!=typeof(r=o.constructor)||r!==Array&&!Ee(r.prototype)?v(r)&&null===(r=r[Po])&&(r=void 0):r=void 0,r===Array||void 0===r))return Do.call(o,a,c);for(i=new(void 0===r?Array:r)(Mo(c-a,0)),n=0;a<c;a++,n++)a in o&&ye(i,n,o[a]);return i.length=n,i}});var xo=Ye("Array").slice,Bo=Array.prototype,Uo=function(e){var t=e.slice;return e===Bo||e instanceof Array&&t===Bo.slice?xo:t},Fo=Tt.find,Vo="find",jo=!0;Vo in[]&&Array(1).find((function(){jo=!1})),Q({target:"Array",proto:!0,forced:jo},{find:function(e){return Fo(this,e,arguments.length>1?arguments[1]:void 0)}});var Go=Ye("Array").find,Ho=Array.prototype,Qo=function(e){var t=e.find;return e===Ho||e instanceof Array&&t===Ho.find?Go:t},Wo=[].slice,qo={},zo=function(e,t,r){if(!(t in qo)){for(var i=[],n=0;n<t;n++)i[n]="a["+n+"]";qo[t]=Function("C,a","return new C("+i.join(",")+")")}return qo[t](e,r)},Zo=Function.bind||function(e){var t=x(this),r=Wo.call(arguments,1),i=function(){var n=r.concat(Wo.call(arguments));return this instanceof i?zo(t,n.length,n):t.apply(e,n)};return v(t.prototype)&&(i.prototype=t.prototype),i};Q({target:"Function",proto:!0},{bind:Zo});var Yo=Ye("Function").bind,Ko=Function.prototype,$o=function(e){var t=e.bind;return e===Ko||e instanceof Function&&t===Ko.bind?Yo:t},Jo=ee.includes;Q({target:"Array",proto:!0},{includes:function(e){return Jo(this,e,arguments.length>1?arguments[1]:void 0)}});var Xo=Ye("Array").includes;Q({target:"String",proto:!0,forced:!Fr("includes")},{includes:function(e){return!!~String(m(this)).indexOf(Br(e),arguments.length>1?arguments[1]:void 0)}});var es=Ye("String").includes,ts=Array.prototype,rs=String.prototype,is=function(e){var t=e.includes;return e===ts||e instanceof Array&&t===ts.includes?Xo:"string"==typeof e||e===rs||e instanceof String&&t===rs.includes?es:t},ns=Tt.some;Q({target:"Array",proto:!0,forced:qr("some")},{some:function(e){return ns(this,e,arguments.length>1?arguments[1]:void 0)}});var os=Ye("Array").some,ss=Array.prototype,as=function(e){var t=e.some;return e===ss||e instanceof Array&&t===ss.some?os:t};const cs=ki;function ls(e){const t=e&&e.navigator;if(!t.mediaDevices)return;const r=Ni(e),i=function(e){var t;if("object"!=typeof e||e.mandatory||e.optional)return e;const r={};var i;return Jr(t=ni(e)).call(t,t=>{if("require"===t||"advanced"===t||"mediaSource"===t)return;const i="object"==typeof e[t]?e[t]:{ideal:e[t]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);const n=function(e,t){return e?e+t.charAt(0).toUpperCase()+Uo(t).call(t,1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){r.optional=r.optional||[];let e={};"number"==typeof i.ideal?(e[n("min",t)]=i.ideal,r.optional.push(e),e={},e[n("max",t)]=i.ideal,r.optional.push(e)):(e[n("",t)]=i.ideal,r.optional.push(e))}var o;void 0!==i.exact&&"number"!=typeof i.exact?(r.mandatory=r.mandatory||{},r.mandatory[n("",t)]=i.exact):Jr(o=["min","max"]).call(o,e=>{void 0!==i[e]&&(r.mandatory=r.mandatory||{},r.mandatory[n(e,t)]=i[e])})}),e.advanced&&(r.optional=Je(i=r.optional||[]).call(i,e.advanced)),r},n=function(e,n){if(r.version>=61)return n(e);if((e=JSON.parse(ve(e)))&&"object"==typeof e.audio){const t=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};t((e=JSON.parse(ve(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=i(e.audio)}if(e&&"object"==typeof e.video){let o=e.video.facingMode;o=o&&("object"==typeof o?o:{ideal:o});const s=r.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||s)){let r;if(delete e.video.facingMode,"environment"===o.exact||"environment"===o.ideal?r=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(r=["front"]),r)return t.mediaDevices.enumerateDevices().then(t=>{t=ji(t).call(t,e=>"videoinput"===e.kind);let s=Qo(t).call(t,e=>as(r).call(r,t=>{var r;return is(r=e.label.toLowerCase()).call(r,t)}));return!s&&t.length&&is(r).call(r,"back")&&(s=t[t.length-1]),s&&(e.video.deviceId=o.exact?{exact:s.deviceId}:{ideal:s.deviceId}),e.video=i(e.video),cs("chrome: "+ve(e)),n(e)})}e.video=i(e.video)}return cs("chrome: "+ve(e)),n(e)},o=function(e){return r.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},s=function(e,r,i){n(e,e=>{t.webkitGetUserMedia(e,r,e=>{i&&i(o(e))})})};if(t.getUserMedia=$o(s).call(s,t),t.mediaDevices.getUserMedia){var a;const e=$o(a=t.mediaDevices.getUserMedia).call(a,t.mediaDevices);t.mediaDevices.getUserMedia=function(t){return n(t,t=>e(t).then(e=>{var r;if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw Jr(r=e.getTracks()).call(r,e=>{e.stop()}),new DOMException("","NotFoundError");return e},e=>fo.reject(o(e))))}}}function us(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function ds(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){di(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{var r;t.stream.addEventListener("addtrack",r=>{let i;var n;i=e.RTCPeerConnection.prototype.getReceivers?Qo(n=this.getReceivers()).call(n,e=>e.track&&e.track.id===r.track.id):{track:r.track};const o=new Event("track");o.track=r.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],this.dispatchEvent(o)}),Jr(r=t.stream.getTracks()).call(r,r=>{let i;var n;i=e.RTCPeerConnection.prototype.getReceivers?Qo(n=this.getReceivers()).call(n,e=>e.track&&e.track.id===r.id):{track:r};const o=new Event("track");o.track=r,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],this.dispatchEvent(o)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else Ii(e,"track",e=>(e.transceiver||di(e,"transceiver",{value:{receiver:e.receiver}}),e))}function hs(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){var e;return this._senders=this._senders||[],Uo(e=this._senders).call(e)};const r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){let n=r.apply(this,arguments);return n||(n=t(this,e),this._senders.push(n)),n};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t;i.apply(this,arguments);const r=Lo(t=this._senders).call(t,e);var n;-1!==r&&bo(n=this._senders).call(n,r,1)}}const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var i;this._senders=this._senders||[],r.apply(this,[e]),Jr(i=e.getTracks()).call(i,e=>{this._senders.push(t(this,e))})};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t;this._senders=this._senders||[],i.apply(this,[e]),Jr(t=e.getTracks()).call(t,e=>{var t;const r=Qo(t=this._senders).call(t,t=>t.track===e);var i,n;r&&bo(i=this._senders).call(i,Lo(n=this._senders).call(n,r),1)})}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return Jr(e).call(e,e=>e._pc=this),e},di(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function ps(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,r,i]=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof e))return t.apply(this,[]);const n=function(e){const t={},r=e.result();return Jr(r).call(r,e=>{var r;const i={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};Jr(r=e.names()).call(r,t=>{i[t]=e.stat(t)}),t[i.id]=i}),t},o=function(e){var t;return new Mr(vo(t=ni(e)).call(t,t=>[t,e[t]]))};if(arguments.length>=2){const i=function(e){r(o(n(e)))};return t.apply(this,[i,e])}return new fo((e,r)=>{t.apply(this,[function(t){e(o(n(t)))},r])}).then(r,i)}}function fs(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return Jr(e).call(e,e=>e._pc=this),e});const r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>Di(t,e.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return Jr(e).call(e,e=>e._pc=this),e}),Ii(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>Di(t,e.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var r,i;const e=arguments[0];let t,n,o;return Jr(r=this.getSenders()).call(r,r=>{r.track===e&&(t?o=!0:t=r)}),Jr(i=this.getReceivers()).call(i,t=>(t.track===e&&(n?o=!0:n=t),t.track===e)),o||t&&n?fo.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():fo.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function gs(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},vo(e=ni(this._shimmedLocalStreams)).call(e,e=>this._shimmedLocalStreams[e][0])};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){var i;if(!r)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const n=t.apply(this,arguments);return this._shimmedLocalStreams[r.id]?-1===Lo(i=this._shimmedLocalStreams[r.id]).call(i,n)&&this._shimmedLocalStreams[r.id].push(n):this._shimmedLocalStreams[r.id]=[r,n],n};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t,i,n;this._shimmedLocalStreams=this._shimmedLocalStreams||{},Jr(t=e.getTracks()).call(t,e=>{var t;if(Qo(t=this.getSenders()).call(t,t=>t.track===e))throw new DOMException("Track already exists.","InvalidAccessError")});const o=this.getSenders();r.apply(this,arguments);const s=ji(i=this.getSenders()).call(i,e=>-1===Lo(o).call(o,e));this._shimmedLocalStreams[e.id]=Je(n=[e]).call(n,s)};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],i.apply(this,arguments)};const n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Jr(t=ni(this._shimmedLocalStreams)).call(t,t=>{var r;const i=Lo(r=this._shimmedLocalStreams[t]).call(r,e);var n;-1!==i&&bo(n=this._shimmedLocalStreams[t]).call(n,i,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]}),n.apply(this,arguments)}}function ms(e){var t;if(!e.RTCPeerConnection)return;const r=Ni(e);if(e.RTCPeerConnection.prototype.addTrack&&r.version>=65)return gs(e);const i=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=i.apply(this);return this._reverseStreams=this._reverseStreams||{},vo(e).call(e,e=>this._reverseStreams[e.id])};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var r;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},Jr(r=t.getTracks()).call(r,e=>{var t;if(Qo(t=this.getSenders()).call(t,t=>t.track===e))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[t.id]){const r=new e.MediaStream(t.getTracks());this._streams[t.id]=r,this._reverseStreams[r.id]=t,t=r}n.apply(this,[t])};const o=e.RTCPeerConnection.prototype.removeStream;function s(e,t){var r;let i=t.sdp;return Jr(r=ni(e._reverseStreams||[])).call(r,t=>{const r=e._reverseStreams[t],n=e._streams[r.id];i=i.replace(new RegExp(n.id,"g"),r.id)}),new RTCSessionDescription({type:t.type,sdp:i})}function a(e,t){var r;let i=t.sdp;return Jr(r=ni(e._reverseStreams||[])).call(r,t=>{const r=e._reverseStreams[t],n=e._streams[r.id];i=i.replace(new RegExp(r.id,"g"),n.id)}),new RTCSessionDescription({type:t.type,sdp:i})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,r){var i,n,o;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const s=Uo([]).call(arguments,1);if(1!==s.length||!Qo(i=s[0].getTracks()).call(i,e=>e===t))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");const a=Qo(n=this.getSenders()).call(n,e=>e.track===t);if(a)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const c=this._streams[r.id];if(c)c.addTrack(t),fo.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const i=new e.MediaStream([t]);this._streams[r.id]=i,this._reverseStreams[i.id]=r,this.addStream(i)}return Qo(o=this.getSenders()).call(o,e=>e.track===t)},Jr(t=["createOffer","createAnswer"]).call(t,(function(t){const r=e.RTCPeerConnection.prototype[t],i={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?r.apply(this,[t=>{const r=s(this,t);e[0].apply(null,[r])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):r.apply(this,arguments).then(e=>s(this,e))}};e.RTCPeerConnection.prototype[t]=i[t]}));const c=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=a(this,arguments[0]),c.apply(this,arguments)):c.apply(this,arguments)};const l=Bi(e.RTCPeerConnection.prototype,"localDescription");di(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=l.get.apply(this);return""===e.type?e:s(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let r;this._streams=this._streams||{},Jr(t=ni(this._streams)).call(t,t=>{var i;Qo(i=this._streams[t].getTracks()).call(i,t=>e.track===t)&&(r=this._streams[t])}),r&&(1===r.getTracks().length?this.removeStream(this._reverseStreams[r.id]):r.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function _s(e){const t=Ni(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),!e.RTCPeerConnection)return;var r;t.version<53&&Jr(r=["setLocalDescription","setRemoteDescription","addIceCandidate"]).call(r,(function(t){const r=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]}));const i=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?t.version<78&&arguments[0]&&""===arguments[0].candidate?fo.resolve():i.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),fo.resolve())}}function vs(e){Ii(e,"negotiationneeded",e=>{if("stable"===e.target.signalingState)return e})}var Es=Object.freeze({__proto__:null,shimMediaStream:us,shimOnTrack:ds,shimGetSendersWithDtmf:hs,shimGetStats:ps,shimSenderReceiverGetStats:fs,shimAddTrackRemoveTrackWithNative:gs,shimAddTrackRemoveTrack:ms,shimPeerConnection:_s,fixNegotiationNeeded:vs,shimGetUserMedia:ls,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then(t=>{const i=r.video&&r.video.width,n=r.video&&r.video.height,o=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},i&&(r.video.mandatory.maxWidth=i),n&&(r.video.mandatory.maxHeight=n),e.navigator.mediaDevices.getUserMedia(r)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}}),As="".startsWith,ys=Math.min,Ss=Fr("startsWith");Q({target:"String",proto:!0,forced:!Ss},{startsWith:function(e){var t=String(m(this));Br(e);var r=Y(ys(arguments.length>1?arguments[1]:void 0,t.length)),i=String(e);return As?As.call(t,i,r):t.slice(r,r+i.length)===i}});var Cs,Ts=Ye("String").startsWith,bs=String.prototype,Is=function(e){var t=e.startsWith;return"string"==typeof e||e===bs||e instanceof String&&t===bs.startsWith?Ts:t},Rs=_i.trim;Q({target:"String",proto:!0,forced:(Cs="trim",s((function(){return!!hi[Cs]()||"​᠎"!="​᠎"[Cs]()||hi[Cs].name!==Cs})))},{trim:function(){return Rs(this)}});var ws=Ye("String").trim,ks=String.prototype,Os=function(e){var t=e.trim;return"string"==typeof e||e===ks||e instanceof String&&t===ks.trim?ws:t},Ns=i((function(e){var t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){var t;return vo(t=Os(e).call(e).split("\n")).call(t,(function(e){return Os(e).call(e)}))},t.splitSections=function(e){var t=e.split("\nm=");return vo(t).call(t,(function(e,t){var r;return Os(r=t>0?"m="+e:e).call(r)+"\r\n"}))},t.getDescription=function(e){var r=t.splitSections(e);return r&&r[0]},t.getMediaSections=function(e){var r=t.splitSections(e);return r.shift(),r},t.matchPrefix=function(e,r){var i;return ji(i=t.splitLines(e)).call(i,(function(e){return 0===Lo(e).call(e,r)}))},t.parseCandidate=function(e){for(var t,r={foundation:(t=0===Lo(e).call(e,"a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:Si(t[1],10),protocol:t[2].toLowerCase(),priority:Si(t[3],10),ip:t[4],address:t[4],port:Si(t[5],10),type:t[7]},i=8;i<t.length;i+=2)switch(t[i]){case"raddr":r.relatedAddress=t[i+1];break;case"rport":r.relatedPort=Si(t[i+1],10);break;case"tcptype":r.tcpType=t[i+1];break;case"ufrag":r.ufrag=t[i+1],r.usernameFragment=t[i+1];break;default:r[t[i]]=t[i+1]}return r},t.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:Si(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=Si(t[1],10),r.channels=3===t.length?Si(t[2],10):1,r.numChannels=r.channels,r},t.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},t.parseExtmap=function(e){var t,r=e.substr(9).split(" ");return{id:Si(r[0],10),direction:Lo(t=r[0]).call(t,"/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){for(var t,r={},i=e.substr(Lo(e).call(e," ")+1).split(";"),n=0;n<i.length;n++){var o,s;t=Os(o=i[n]).call(o).split("="),r[Os(s=t[0]).call(s)]=t[1]}return r},t.writeFmtp=function(e){var t="",r=e.payloadType;if(void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.parameters&&ni(e.parameters).length){var i,n=[];Jr(i=ni(e.parameters)).call(i,(function(t){e.parameters[t]?n.push(t+"="+e.parameters[t]):n.push(t)})),t+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){var t=e.substr(Lo(e).call(e," ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){var t,r="",i=e.payloadType;return void 0!==e.preferredPayloadType&&(i=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&Jr(t=e.rtcpFeedback).call(t,(function(e){r+="a=rtcp-fb:"+i+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),r},t.parseSsrcMedia=function(e){var t=Lo(e).call(e," "),r={ssrc:Si(e.substr(7,t-7),10)},i=Lo(e).call(e,":",t);return i>-1?(r.attribute=e.substr(t+1,i-t-1),r.value=e.substr(i+1)):r.attribute=e.substr(t+1),r},t.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:vo(t).call(t,(function(e){return Si(e,10)}))}},t.getMid=function(e){var r=t.matchPrefix(e,"a=mid:")[0];if(r)return r.substr(6)},t.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},t.getDtlsParameters=function(e,r){var i=t.matchPrefix(e+r,"a=fingerprint:");return{role:"auto",fingerprints:vo(i).call(i,t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){var r,i="a=setup:"+t+"\r\n";return Jr(r=e.fingerprints).call(r,(function(e){i+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),i},t.getIceParameters=function(e,r){var i=t.splitLines(e);return i=Je(i).call(i,t.splitLines(r)),{usernameFragment:ji(i).call(i,(function(e){return 0===Lo(e).call(e,"a=ice-ufrag:")}))[0].substr(12),password:ji(i).call(i,(function(e){return 0===Lo(e).call(e,"a=ice-pwd:")}))[0].substr(10)}},t.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},t.parseRtpParameters=function(e){for(var r,i={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=t.splitLines(e)[0].split(" "),o=3;o<n.length;o++){var s=n[o],a=t.matchPrefix(e,"a=rtpmap:"+s+" ")[0];if(a){var c,l=t.parseRtpMap(a),u=t.matchPrefix(e,"a=fmtp:"+s+" ");switch(l.parameters=u.length?t.parseFmtp(u[0]):{},l.rtcpFeedback=vo(c=t.matchPrefix(e,"a=rtcp-fb:"+s+" ")).call(c,t.parseRtcpFb),i.codecs.push(l),l.name.toUpperCase()){case"RED":case"ULPFEC":i.fecMechanisms.push(l.name.toUpperCase())}}}return Jr(r=t.matchPrefix(e,"a=extmap:")).call(r,(function(e){i.headerExtensions.push(t.parseExtmap(e))})),i},t.writeRtpDescription=function(e,r){var i,n,o,s="";s+="m="+e+" ",s+=r.codecs.length>0?"9":"0",s+=" UDP/TLS/RTP/SAVPF ",s+=vo(i=r.codecs).call(i,(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",s+="c=IN IP4 0.0.0.0\r\n",s+="a=rtcp:9 IN IP4 0.0.0.0\r\n",Jr(n=r.codecs).call(n,(function(e){s+=t.writeRtpMap(e),s+=t.writeFmtp(e),s+=t.writeRtcpFb(e)}));var a,c=0;return Jr(o=r.codecs).call(o,(function(e){e.maxptime>c&&(c=e.maxptime)})),c>0&&(s+="a=maxptime:"+c+"\r\n"),s+="a=rtcp-mux\r\n",r.headerExtensions&&Jr(a=r.headerExtensions).call(a,(function(e){s+=t.writeExtmap(e)})),s},t.parseRtpEncodingParameters=function(e){var r,i,n,o,s,a,c,l=[],u=t.parseRtpParameters(e),d=-1!==Lo(r=u.fecMechanisms).call(r,"RED"),h=-1!==Lo(i=u.fecMechanisms).call(i,"ULPFEC"),p=ji(n=vo(o=t.matchPrefix(e,"a=ssrc:")).call(o,(function(e){return t.parseSsrcMedia(e)}))).call(n,(function(e){return"cname"===e.attribute})),f=p.length>0&&p[0].ssrc,g=vo(s=t.matchPrefix(e,"a=ssrc-group:FID")).call(s,(function(e){var t=e.substr(17).split(" ");return vo(t).call(t,(function(e){return Si(e,10)}))}));g.length>0&&g[0].length>1&&g[0][0]===f&&(c=g[0][1]),Jr(a=u.codecs).call(a,(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:f,codecPayloadType:Si(e.parameters.apt,10)};f&&c&&(t.rtx={ssrc:c}),l.push(t),d&&((t=JSON.parse(ve(t))).fec={ssrc:f,mechanism:h?"red+ulpfec":"red"},l.push(t))}})),0===l.length&&f&&l.push({ssrc:f});var m,_,v=t.matchPrefix(e,"b=");return v.length&&(v=0===Lo(m=v[0]).call(m,"b=TIAS:")?Si(v[0].substr(7),10):0===Lo(_=v[0]).call(_,"b=AS:")?1e3*Si(v[0].substr(5),10)*.95-16e3:void 0,Jr(l).call(l,(function(e){e.maxBitrate=v}))),l},t.parseRtcpParameters=function(e){var r,i,n={},o=ji(r=vo(i=t.matchPrefix(e,"a=ssrc:")).call(i,(function(e){return t.parseSsrcMedia(e)}))).call(r,(function(e){return"cname"===e.attribute}))[0];o&&(n.cname=o.value,n.ssrc=o.ssrc);var s=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=s.length>0,n.compound=0===s.length;var a=t.matchPrefix(e,"a=rtcp-mux");return n.mux=a.length>0,n},t.parseMsid=function(e){var r,i,n,o=t.matchPrefix(e,"a=msid:");if(1===o.length)return{stream:(n=o[0].substr(7).split(" "))[0],track:n[1]};var s=ji(r=vo(i=t.matchPrefix(e,"a=ssrc:")).call(i,(function(e){return t.parseSsrcMedia(e)}))).call(r,(function(e){return"msid"===e.attribute}));return s.length>0?{stream:(n=s[0].value.split(" "))[0],track:n[1]}:void 0},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,r,i){var n=void 0!==r?r:2;return"v=0\r\no="+(i||"thisisadapterortc")+" "+(e||t.generateSessionId())+" "+n+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.writeMediaSection=function(e,r,i,n){var o=t.writeRtpDescription(e.kind,r);if(o+=t.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=t.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===i?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var s="msid:"+n.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+s,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+t.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+t.localCName+"\r\n"),o},t.getDirection=function(e,r){for(var i=t.splitLines(e),n=0;n<i.length;n++)switch(i[n]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[n].substr(2)}return r?t.getDirection(r):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){var r=t.splitLines(e)[0].substr(2).split(" ");return{kind:r[0],port:Si(r[1],10),protocol:r[2],fmt:Uo(r).call(r,3).join(" ")}},t.parseOLine=function(e){var r=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:Si(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var r=t.splitLines(e),i=0;i<r.length;i++)if(r[i].length<2||"="!==r[i].charAt(1))return!1;return!0},e.exports=t}));function Ls(e,t,r,i,n){var o=Ns.writeRtpDescription(e.kind,t);if(o+=Ns.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=Ns.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":n||"active"),o+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var s=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=s;var a="msid:"+(i?i.id:"-")+" "+s+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+Ns.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+Ns.localCName+"\r\n"),o}function Ps(e,t){var r={codecs:[],headerExtensions:[],fecMechanisms:[]},i=function(e,t){e=parseInt(e,10);for(var r=0;r<t.length;r++)if(t[r].payloadType===e||t[r].preferredPayloadType===e)return t[r]},n=function(e,t,r,n){var o=i(e.parameters.apt,r),s=i(t.parameters.apt,n);return o&&s&&o.name.toLowerCase()===s.name.toLowerCase()};return e.codecs.forEach((function(i){for(var o=0;o<t.codecs.length;o++){var s=t.codecs[o];if(i.name.toLowerCase()===s.name.toLowerCase()&&i.clockRate===s.clockRate){if("rtx"===i.name.toLowerCase()&&i.parameters&&s.parameters.apt&&!n(i,s,e.codecs,t.codecs))continue;(s=JSON.parse(JSON.stringify(s))).numChannels=Math.min(i.numChannels,s.numChannels),r.codecs.push(s),s.rtcpFeedback=s.rtcpFeedback.filter((function(e){for(var t=0;t<i.rtcpFeedback.length;t++)if(i.rtcpFeedback[t].type===e.type&&i.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var i=0;i<t.headerExtensions.length;i++){var n=t.headerExtensions[i];if(e.uri===n.uri){r.headerExtensions.push(n);break}}})),r}function Ds(e,t,r){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)}function Ms(e,t){var r=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return r||e.addRemoteCandidate(t),!r}function xs(e,t){var r=new Error(t);return r.name=e,r.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],r}var Bs=function(e,t){function r(t,r){r.addTrack(t),r.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function i(t,r,i,n){var o=new Event("track");o.track=r,o.receiver=i,o.transceiver={receiver:i},o.streams=n,e.setTimeout((function(){t._dispatchEvent("track",o)}))}var n=function(r){var i=this,n=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){i[e]=n[e].bind(n)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",r=JSON.parse(JSON.stringify(r||{})),this.usingBundle="max-bundle"===r.bundlePolicy,"negotiate"===r.rtcpMuxPolicy)throw xs("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(r.rtcpMuxPolicy||(r.rtcpMuxPolicy="require"),r.iceTransportPolicy){case"all":case"relay":break;default:r.iceTransportPolicy="all"}switch(r.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:r.bundlePolicy="balanced"}if(r.iceServers=function(e,t){var r=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var i=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var n="string"==typeof i;return n&&(i=[i]),i=i.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||r?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(r=!0,!0)})),delete e.url,e.urls=n?i[0]:i,!!i.length}}))}(r.iceServers||[],t),this._iceGatherers=[],r.iceCandidatePoolSize)for(var o=r.iceCandidatePoolSize;o>0;o--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:r.iceServers,gatherPolicy:r.iceTransportPolicy}));else r.iceCandidatePoolSize=0;this._config=r,this.transceivers=[],this._sdpSessionId=Ns.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(n.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(n.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),n.prototype.onicecandidate=null,n.prototype.onaddstream=null,n.prototype.ontrack=null,n.prototype.onremovestream=null,n.prototype.onsignalingstatechange=null,n.prototype.oniceconnectionstatechange=null,n.prototype.onconnectionstatechange=null,n.prototype.onicegatheringstatechange=null,n.prototype.onnegotiationneeded=null,n.prototype.ondatachannel=null,n.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},n.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},n.prototype.getConfiguration=function(){return this._config},n.prototype.getLocalStreams=function(){return this.localStreams},n.prototype.getRemoteStreams=function(){return this.remoteStreams},n.prototype._createTransceiver=function(e,t){var r=this.transceivers.length>0,i={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&r)i.iceTransport=this.transceivers[0].iceTransport,i.dtlsTransport=this.transceivers[0].dtlsTransport;else{var n=this._createIceAndDtlsTransports();i.iceTransport=n.iceTransport,i.dtlsTransport=n.dtlsTransport}return t||this.transceivers.push(i),i},n.prototype.addTrack=function(t,r){if(this._isClosed)throw xs("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var i;if(this.transceivers.find((function(e){return e.track===t})))throw xs("InvalidAccessError","Track already exists.");for(var n=0;n<this.transceivers.length;n++)this.transceivers[n].track||this.transceivers[n].kind!==t.kind||(i=this.transceivers[n]);return i||(i=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(r)&&this.localStreams.push(r),i.track=t,i.stream=r,i.rtpSender=new e.RTCRtpSender(t,i.dtlsTransport),i.rtpSender},n.prototype.addStream=function(e){var r=this;if(t>=15025)e.getTracks().forEach((function(t){r.addTrack(t,e)}));else{var i=e.clone();e.getTracks().forEach((function(e,t){var r=i.getTracks()[t];e.addEventListener("enabled",(function(e){r.enabled=e.enabled}))})),i.getTracks().forEach((function(e){r.addTrack(e,i)}))}},n.prototype.removeTrack=function(t){if(this._isClosed)throw xs("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var r=this.transceivers.find((function(e){return e.rtpSender===t}));if(!r)throw xs("InvalidAccessError","Sender was not created by this connection.");var i=r.stream;r.rtpSender.stop(),r.rtpSender=null,r.track=null,r.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(i)&&this.localStreams.indexOf(i)>-1&&this.localStreams.splice(this.localStreams.indexOf(i),1),this._maybeFireNegotiationNeeded()},n.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var r=t.getSenders().find((function(t){return t.track===e}));r&&t.removeTrack(r)}))},n.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},n.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},n.prototype._createIceGatherer=function(t,r){var i=this;if(r&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var n=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(n,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var r=!e.candidate||0===Object.keys(e.candidate).length;n.state=r?"completed":"gathering",null!==i.transceivers[t].bufferedCandidateEvents&&i.transceivers[t].bufferedCandidateEvents.push(e)},n.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),n},n.prototype._gather=function(t,r){var i=this,n=this.transceivers[r].iceGatherer;if(!n.onlocalcandidate){var o=this.transceivers[r].bufferedCandidateEvents;this.transceivers[r].bufferedCandidateEvents=null,n.removeEventListener("localcandidate",this.transceivers[r].bufferCandidates),n.onlocalcandidate=function(e){if(!(i.usingBundle&&r>0)){var o=new Event("icecandidate");o.candidate={sdpMid:t,sdpMLineIndex:r};var s=e.candidate,a=!s||0===Object.keys(s).length;if(a)"new"!==n.state&&"gathering"!==n.state||(n.state="completed");else{"new"===n.state&&(n.state="gathering"),s.component=1,s.ufrag=n.getLocalParameters().usernameFragment;var c=Ns.writeCandidate(s);o.candidate=Object.assign(o.candidate,Ns.parseCandidate(c)),o.candidate.candidate=c,o.candidate.toJSON=function(){return{candidate:o.candidate.candidate,sdpMid:o.candidate.sdpMid,sdpMLineIndex:o.candidate.sdpMLineIndex,usernameFragment:o.candidate.usernameFragment}}}var l=Ns.getMediaSections(i._localDescription.sdp);l[o.candidate.sdpMLineIndex]+=a?"a=end-of-candidates\r\n":"a="+o.candidate.candidate+"\r\n",i._localDescription.sdp=Ns.getDescription(i._localDescription.sdp)+l.join("");var u=i.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==i.iceGatheringState&&(i.iceGatheringState="gathering",i._emitGatheringStateChange()),a||i._dispatchEvent("icecandidate",o),u&&(i._dispatchEvent("icecandidate",new Event("icecandidate")),i.iceGatheringState="complete",i._emitGatheringStateChange())}},e.setTimeout((function(){o.forEach((function(e){n.onlocalcandidate(e)}))}),0)}},n.prototype._createIceAndDtlsTransports=function(){var t=this,r=new e.RTCIceTransport(null);r.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var i=new e.RTCDtlsTransport(r);return i.ondtlsstatechange=function(){t._updateConnectionState()},i.onerror=function(){Object.defineProperty(i,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:r,dtlsTransport:i}},n.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var r=this.transceivers[e].iceTransport;r&&(delete r.onicestatechange,delete this.transceivers[e].iceTransport);var i=this.transceivers[e].dtlsTransport;i&&(delete i.ondtlsstatechange,delete i.onerror,delete this.transceivers[e].dtlsTransport)},n.prototype._transceive=function(e,r,i){var n=Ps(e.localCapabilities,e.remoteCapabilities);r&&e.rtpSender&&(n.encodings=e.sendEncodingParameters,n.rtcp={cname:Ns.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(n.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(n)),i&&e.rtpReceiver&&n.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?n.encodings=e.recvEncodingParameters:n.encodings=[{}],n.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(n.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(n.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(n))},n.prototype.setLocalDescription=function(e){var t,r,i=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(xs("TypeError",'Unsupported type "'+e.type+'"'));if(!Ds("setLocalDescription",e.type,i.signalingState)||i._isClosed)return Promise.reject(xs("InvalidStateError","Can not set local "+e.type+" in state "+i.signalingState));if("offer"===e.type)t=Ns.splitSections(e.sdp),r=t.shift(),t.forEach((function(e,t){var r=Ns.parseRtpParameters(e);i.transceivers[t].localCapabilities=r})),i.transceivers.forEach((function(e,t){i._gather(e.mid,t)}));else if("answer"===e.type){t=Ns.splitSections(i._remoteDescription.sdp),r=t.shift();var n=Ns.matchPrefix(r,"a=ice-lite").length>0;t.forEach((function(e,t){var o=i.transceivers[t],s=o.iceGatherer,a=o.iceTransport,c=o.dtlsTransport,l=o.localCapabilities,u=o.remoteCapabilities;if((!Ns.isRejected(e)||0!==Ns.matchPrefix(e,"a=bundle-only").length)&&!o.rejected){var d=Ns.getIceParameters(e,r),h=Ns.getDtlsParameters(e,r);n&&(h.role="server"),i.usingBundle&&0!==t||(i._gather(o.mid,t),"new"===a.state&&a.start(s,d,n?"controlling":"controlled"),"new"===c.state&&c.start(h));var p=Ps(l,u);i._transceive(o,p.codecs.length>0,!1)}}))}return i._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?i._updateSignalingState("have-local-offer"):i._updateSignalingState("stable"),Promise.resolve()},n.prototype.setRemoteDescription=function(n){var o=this;if(-1===["offer","answer"].indexOf(n.type))return Promise.reject(xs("TypeError",'Unsupported type "'+n.type+'"'));if(!Ds("setRemoteDescription",n.type,o.signalingState)||o._isClosed)return Promise.reject(xs("InvalidStateError","Can not set remote "+n.type+" in state "+o.signalingState));var s={};o.remoteStreams.forEach((function(e){s[e.id]=e}));var a=[],c=Ns.splitSections(n.sdp),l=c.shift(),u=Ns.matchPrefix(l,"a=ice-lite").length>0,d=Ns.matchPrefix(l,"a=group:BUNDLE ").length>0;o.usingBundle=d;var h=Ns.matchPrefix(l,"a=ice-options:")[0];return o.canTrickleIceCandidates=!!h&&h.substr(14).split(" ").indexOf("trickle")>=0,c.forEach((function(i,c){var h=Ns.splitLines(i),p=Ns.getKind(i),f=Ns.isRejected(i)&&0===Ns.matchPrefix(i,"a=bundle-only").length,g=h[0].substr(2).split(" ")[2],m=Ns.getDirection(i,l),_=Ns.parseMsid(i),v=Ns.getMid(i)||Ns.generateIdentifier();if(f||"application"===p&&("DTLS/SCTP"===g||"UDP/DTLS/SCTP"===g))o.transceivers[c]={mid:v,kind:p,protocol:g,rejected:!0};else{var E,A,y,S,C,T,b,I,R;!f&&o.transceivers[c]&&o.transceivers[c].rejected&&(o.transceivers[c]=o._createTransceiver(p,!0));var w,k,O=Ns.parseRtpParameters(i);f||(w=Ns.getIceParameters(i,l),(k=Ns.getDtlsParameters(i,l)).role="client"),b=Ns.parseRtpEncodingParameters(i);var N=Ns.parseRtcpParameters(i),L=Ns.matchPrefix(i,"a=end-of-candidates",l).length>0,P=Ns.matchPrefix(i,"a=candidate:").map((function(e){return Ns.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===n.type||"answer"===n.type)&&!f&&d&&c>0&&o.transceivers[c]&&(o._disposeIceAndDtlsTransports(c),o.transceivers[c].iceGatherer=o.transceivers[0].iceGatherer,o.transceivers[c].iceTransport=o.transceivers[0].iceTransport,o.transceivers[c].dtlsTransport=o.transceivers[0].dtlsTransport,o.transceivers[c].rtpSender&&o.transceivers[c].rtpSender.setTransport(o.transceivers[0].dtlsTransport),o.transceivers[c].rtpReceiver&&o.transceivers[c].rtpReceiver.setTransport(o.transceivers[0].dtlsTransport)),"offer"!==n.type||f)"answer"!==n.type||f||(A=(E=o.transceivers[c]).iceGatherer,y=E.iceTransport,S=E.dtlsTransport,C=E.rtpReceiver,T=E.sendEncodingParameters,I=E.localCapabilities,o.transceivers[c].recvEncodingParameters=b,o.transceivers[c].remoteCapabilities=O,o.transceivers[c].rtcpParameters=N,P.length&&"new"===y.state&&(!u&&!L||d&&0!==c?P.forEach((function(e){Ms(E.iceTransport,e)})):y.setRemoteCandidates(P)),d&&0!==c||("new"===y.state&&y.start(A,w,"controlling"),"new"===S.state&&S.start(k)),!Ps(E.localCapabilities,E.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&E.sendEncodingParameters[0].rtx&&delete E.sendEncodingParameters[0].rtx,o._transceive(E,"sendrecv"===m||"recvonly"===m,"sendrecv"===m||"sendonly"===m),!C||"sendrecv"!==m&&"sendonly"!==m?delete E.rtpReceiver:(R=C.track,_?(s[_.stream]||(s[_.stream]=new e.MediaStream),r(R,s[_.stream]),a.push([R,C,s[_.stream]])):(s.default||(s.default=new e.MediaStream),r(R,s.default),a.push([R,C,s.default]))));else{(E=o.transceivers[c]||o._createTransceiver(p)).mid=v,E.iceGatherer||(E.iceGatherer=o._createIceGatherer(c,d)),P.length&&"new"===E.iceTransport.state&&(!L||d&&0!==c?P.forEach((function(e){Ms(E.iceTransport,e)})):E.iceTransport.setRemoteCandidates(P)),I=e.RTCRtpReceiver.getCapabilities(p),t<15019&&(I.codecs=I.codecs.filter((function(e){return"rtx"!==e.name}))),T=E.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var D,M=!1;"sendrecv"===m||"sendonly"===m?(M=!E.rtpReceiver,C=E.rtpReceiver||new e.RTCRtpReceiver(E.dtlsTransport,p),M&&(R=C.track,_&&"-"===_.stream||(_?(s[_.stream]||(s[_.stream]=new e.MediaStream,Object.defineProperty(s[_.stream],"id",{get:function(){return _.stream}})),Object.defineProperty(R,"id",{get:function(){return _.track}}),D=s[_.stream]):(s.default||(s.default=new e.MediaStream),D=s.default)),D&&(r(R,D),E.associatedRemoteMediaStreams.push(D)),a.push([R,C,D]))):E.rtpReceiver&&E.rtpReceiver.track&&(E.associatedRemoteMediaStreams.forEach((function(t){var r=t.getTracks().find((function(e){return e.id===E.rtpReceiver.track.id}));r&&function(t,r){r.removeTrack(t),r.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(r,t)})),E.associatedRemoteMediaStreams=[]),E.localCapabilities=I,E.remoteCapabilities=O,E.rtpReceiver=C,E.rtcpParameters=N,E.sendEncodingParameters=T,E.recvEncodingParameters=b,o._transceive(o.transceivers[c],!1,M)}}})),void 0===o._dtlsRole&&(o._dtlsRole="offer"===n.type?"active":"passive"),o._remoteDescription={type:n.type,sdp:n.sdp},"offer"===n.type?o._updateSignalingState("have-remote-offer"):o._updateSignalingState("stable"),Object.keys(s).forEach((function(t){var r=s[t];if(r.getTracks().length){if(-1===o.remoteStreams.indexOf(r)){o.remoteStreams.push(r);var n=new Event("addstream");n.stream=r,e.setTimeout((function(){o._dispatchEvent("addstream",n)}))}a.forEach((function(e){var t=e[0],n=e[1];r.id===e[2].id&&i(o,t,n,[r])}))}})),a.forEach((function(e){e[2]||i(o,e[0],e[1],[])})),e.setTimeout((function(){o&&o.transceivers&&o.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},n.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},n.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},n.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},n.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",r)}},n.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var r=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",r)}},n.prototype.createOffer=function(){var r=this;if(r._isClosed)return Promise.reject(xs("InvalidStateError","Can not call createOffer after close"));var i=r.transceivers.filter((function(e){return"audio"===e.kind})).length,n=r.transceivers.filter((function(e){return"video"===e.kind})).length,o=arguments[0];if(o){if(o.mandatory||o.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==o.offerToReceiveAudio&&(i=!0===o.offerToReceiveAudio?1:!1===o.offerToReceiveAudio?0:o.offerToReceiveAudio),void 0!==o.offerToReceiveVideo&&(n=!0===o.offerToReceiveVideo?1:!1===o.offerToReceiveVideo?0:o.offerToReceiveVideo)}for(r.transceivers.forEach((function(e){"audio"===e.kind?--i<0&&(e.wantReceive=!1):"video"===e.kind&&--n<0&&(e.wantReceive=!1)}));i>0||n>0;)i>0&&(r._createTransceiver("audio"),i--),n>0&&(r._createTransceiver("video"),n--);var s=Ns.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.transceivers.forEach((function(i,n){var o=i.track,s=i.kind,a=i.mid||Ns.generateIdentifier();i.mid=a,i.iceGatherer||(i.iceGatherer=r._createIceGatherer(n,r.usingBundle));var c=e.RTCRtpSender.getCapabilities(s);t<15019&&(c.codecs=c.codecs.filter((function(e){return"rtx"!==e.name}))),c.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),i.remoteCapabilities&&i.remoteCapabilities.codecs&&i.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),c.headerExtensions.forEach((function(e){(i.remoteCapabilities&&i.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var l=i.sendEncodingParameters||[{ssrc:1001*(2*n+1)}];o&&t>=15019&&"video"===s&&!l[0].rtx&&(l[0].rtx={ssrc:l[0].ssrc+1}),i.wantReceive&&(i.rtpReceiver=new e.RTCRtpReceiver(i.dtlsTransport,s)),i.localCapabilities=c,i.sendEncodingParameters=l})),"max-compat"!==r._config.bundlePolicy&&(s+="a=group:BUNDLE "+r.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),s+="a=ice-options:trickle\r\n",r.transceivers.forEach((function(e,t){s+=Ls(e,e.localCapabilities,"offer",e.stream,r._dtlsRole),s+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===r.iceGatheringState||0!==t&&r.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,s+="a="+Ns.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(s+="a=end-of-candidates\r\n"))}));var a=new e.RTCSessionDescription({type:"offer",sdp:s});return Promise.resolve(a)},n.prototype.createAnswer=function(){var r=this;if(r._isClosed)return Promise.reject(xs("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==r.signalingState&&"have-local-pranswer"!==r.signalingState)return Promise.reject(xs("InvalidStateError","Can not call createAnswer in signalingState "+r.signalingState));var i=Ns.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.usingBundle&&(i+="a=group:BUNDLE "+r.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),i+="a=ice-options:trickle\r\n";var n=Ns.getMediaSections(r._remoteDescription.sdp).length;r.transceivers.forEach((function(e,o){if(!(o+1>n)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?i+="m=application 0 DTLS/SCTP 5000\r\n":i+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?i+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(i+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(i+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var s;e.stream&&("audio"===e.kind?s=e.stream.getAudioTracks()[0]:"video"===e.kind&&(s=e.stream.getVideoTracks()[0]),s&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var a=Ps(e.localCapabilities,e.remoteCapabilities);!a.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,i+=Ls(e,a,"answer",e.stream,r._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(i+="a=rtcp-rsize\r\n")}}));var o=new e.RTCSessionDescription({type:"answer",sdp:i});return Promise.resolve(o)},n.prototype.addIceCandidate=function(e){var t,r=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(i,n){if(!r._remoteDescription)return n(xs("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var o=e.sdpMLineIndex;if(e.sdpMid)for(var s=0;s<r.transceivers.length;s++)if(r.transceivers[s].mid===e.sdpMid){o=s;break}var a=r.transceivers[o];if(!a)return n(xs("OperationError","Can not add ICE candidate"));if(a.rejected)return i();var c=Object.keys(e.candidate).length>0?Ns.parseCandidate(e.candidate):{};if("tcp"===c.protocol&&(0===c.port||9===c.port))return i();if(c.component&&1!==c.component)return i();if((0===o||o>0&&a.iceTransport!==r.transceivers[0].iceTransport)&&!Ms(a.iceTransport,c))return n(xs("OperationError","Can not add ICE candidate"));var l=e.candidate.trim();0===l.indexOf("a=")&&(l=l.substr(2)),(t=Ns.getMediaSections(r._remoteDescription.sdp))[o]+="a="+(c.type?l:"end-of-candidates")+"\r\n",r._remoteDescription.sdp=Ns.getDescription(r._remoteDescription.sdp)+t.join("")}else for(var u=0;u<r.transceivers.length&&(r.transceivers[u].rejected||(r.transceivers[u].iceTransport.addRemoteCandidate({}),(t=Ns.getMediaSections(r._remoteDescription.sdp))[u]+="a=end-of-candidates\r\n",r._remoteDescription.sdp=Ns.getDescription(r._remoteDescription.sdp)+t.join(""),!r.usingBundle));u++);i()}))},n.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var r=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?r=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(r=e.rtpReceiver)})),!r)throw xs("InvalidAccessError","Invalid selector.");return r.getStats()}var i=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&i.push(e[t].getStats())}))})),Promise.all(i).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var r=e[t];if(r&&r.prototype&&r.prototype.getStats){var i=r.prototype.getStats;r.prototype.getStats=function(){return i.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(r){var i;e[r].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(i=e[r]).type]||i.type,t.set(r,e[r])})),t}))}}}));var o=["createOffer","createAnswer"];return o.forEach((function(e){var t=n.prototype[e];n.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(o=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=n.prototype[e];n.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=n.prototype[e];n.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),n};function Us(e){var t;const r=e&&e.navigator,i=$o(t=r.mediaDevices.getUserMedia).call(t,r.mediaDevices);r.mediaDevices.getUserMedia=function(e){return i(e).catch(e=>fo.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString(){return this.name}}}(e)))}}function Fs(e){var t;"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=$o(t=e.navigator.getDisplayMedia).call(t,e.navigator)))}function Vs(e){const t=Ni(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){const t=Bi(e.MediaStreamTrack.prototype,"enabled");di(e.MediaStreamTrack.prototype,"enabled",{set(e){t.set.call(this,e);const r=new Event("enabled");r.enabled=e,this.dispatchEvent(r)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&di(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);const r=Bs(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=function(e,t){let r=!1;return e=JSON.parse(ve(e)),ji(e).call(e,e=>{if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&Oi("RTCIceServer.url","RTCIceServer.urls");const i="string"==typeof t;return i&&(t=[t]),t=ji(t).call(t,e=>{if(0===Lo(e).call(e,"stun:"))return!1;const t=Is(e).call(e,"turn")&&!Is(e).call(e,"turn:[")&&is(e).call(e,"transport=udp");return t&&!r?(r=!0,!0):t&&!r}),delete e.url,e.urls=i?t[0]:t,!!t.length}})}(e.iceServers,t.version),ki("ICE servers after filtering:",e.iceServers)),new r(e)},e.RTCPeerConnection.prototype=r.prototype}function js(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}var Gs=Object.freeze({__proto__:null,shimPeerConnection:Vs,shimReplaceTrack:js,shimGetUserMedia:Us,shimGetDisplayMedia:Fs});function Hs(e){const t=Ni(e),r=e&&e.navigator,i=e&&e.MediaStreamTrack;if(r.getUserMedia=function(e,t,i){Oi("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){var n;const e=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},t=$o(n=r.mediaDevices.getUserMedia).call(n,r.mediaDevices);if(r.mediaDevices.getUserMedia=function(r){return"object"==typeof r&&"object"==typeof r.audio&&(r=JSON.parse(ve(r)),e(r.audio,"autoGainControl","mozAutoGainControl"),e(r.audio,"noiseSuppression","mozNoiseSuppression")),t(r)},i&&i.prototype.getSettings){const t=i.prototype.getSettings;i.prototype.getSettings=function(){const r=t.apply(this,arguments);return e(r,"mozAutoGainControl","autoGainControl"),e(r,"mozNoiseSuppression","noiseSuppression"),r}}if(i&&i.prototype.applyConstraints){const t=i.prototype.applyConstraints;i.prototype.applyConstraints=function(r){return"audio"===this.kind&&"object"==typeof r&&(r=JSON.parse(ve(r)),e(r,"autoGainControl","mozAutoGainControl"),e(r,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[r])}}}}function Qs(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&di(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Ws(e){const t=Ni(e);if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;var r;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&Jr(r=["setLocalDescription","setRemoteDescription","addIceCandidate"]).call(r,(function(t){const r=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]}));const i=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?t.version<68&&arguments[0]&&""===arguments[0].candidate?fo.resolve():i.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),fo.resolve())};const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,r,i]=arguments;return o.apply(this,[e||null]).then(e=>{if(t.version<53&&!r)try{Jr(e).call(e,e=>{e.type=n[e.type]||e.type})}catch(t){if("TypeError"!==t.name)throw t;Jr(e).call(e,(t,r)=>{e.set(r,ri({},t,{type:n[t.type]||t.type}))})}return e}).then(r,i)}}function qs(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return Jr(e).call(e,e=>e._pc=this),e});const r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):fo.resolve(new Mr)}}function zs(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return Jr(e).call(e,e=>e._pc=this),e}),Ii(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Zs(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){var t;Oi("removeStream","removeTrack"),Jr(t=this.getSenders()).call(t,t=>{var r;t.track&&is(r=e.getTracks()).call(r,t.track)&&this.removeTrack(t)})})}function Ys(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}var Ks=Object.freeze({__proto__:null,shimOnTrack:Qs,shimPeerConnection:Ws,shimSenderGetStats:qs,shimReceiverGetStats:zs,shimRemoveStream:Zs,shimRTCDataChannel:Ys,shimGetUserMedia:Hs,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,fo.reject(e)}return!0===r.video?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)})}});function $s(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var r,i,n;this._localStreams||(this._localStreams=[]),is(r=this._localStreams).call(r,e)||this._localStreams.push(e),Jr(i=e.getAudioTracks()).call(i,r=>t.call(this,r,e)),Jr(n=e.getVideoTracks()).call(n,r=>t.call(this,r,e))},e.RTCPeerConnection.prototype.addTrack=function(e,r){var i;return r&&(this._localStreams?is(i=this._localStreams).call(i,r)||this._localStreams.push(r):this._localStreams=[r]),t.call(this,e,r)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t,r,i;this._localStreams||(this._localStreams=[]);const n=Lo(t=this._localStreams).call(t,e);if(-1===n)return;bo(r=this._localStreams).call(r,n,1);const o=e.getTracks();Jr(i=this.getSenders()).call(i,e=>{is(o).call(o,e.track)&&this.removeTrack(e)})})}}function Js(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){di(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{var t;Jr(t=e.streams).call(t,e=>{var t;if(this._remoteStreams||(this._remoteStreams=[]),is(t=this._remoteStreams).call(t,e))return;this._remoteStreams.push(e);const r=new Event("addstream");r.stream=e,this.dispatchEvent(r)})})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){var r;Jr(r=t.streams).call(r,t=>{var r;if(e._remoteStreams||(e._remoteStreams=[]),Lo(r=e._remoteStreams).call(r,t)>=0)return;e._remoteStreams.push(t);const i=new Event("addstream");i.stream=t,e.dispatchEvent(i)})}),t.apply(e,arguments)}}}function Xs(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,r=t.createOffer,i=t.createAnswer,n=t.setLocalDescription,o=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){const i=arguments.length>=2?arguments[2]:arguments[0],n=r.apply(this,[i]);return t?(n.then(e,t),fo.resolve()):n},t.createAnswer=function(e,t){const r=arguments.length>=2?arguments[2]:arguments[0],n=i.apply(this,[r]);return t?(n.then(e,t),fo.resolve()):n};let a=function(e,t,r){const i=n.apply(this,[e]);return r?(i.then(t,r),fo.resolve()):i};t.setLocalDescription=a,a=function(e,t,r){const i=o.apply(this,[e]);return r?(i.then(t,r),fo.resolve()):i},t.setRemoteDescription=a,a=function(e,t,r){const i=s.apply(this,[e]);return r?(i.then(t,r),fo.resolve()):i},t.addIceCandidate=a}function ea(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var r;const e=t.mediaDevices,i=$o(r=e.getUserMedia).call(r,e);t.mediaDevices.getUserMedia=e=>i(ta(e))}var i;!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=$o(i=function(e,r,i){t.mediaDevices.getUserMedia(e).then(r,i)}).call(i,t))}function ta(e){return e&&void 0!==e.video?ri({},e,{video:Pi(e.video)}):e}function ra(e){const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,r){if(e&&e.iceServers){const t=[];for(let r=0;r<e.iceServers.length;r++){let i=e.iceServers[r];!i.hasOwnProperty("urls")&&i.hasOwnProperty("url")?(Oi("RTCIceServer.url","RTCIceServer.urls"),i=JSON.parse(ve(i)),i.urls=i.url,delete i.url,t.push(i)):t.push(e.iceServers[r])}e.iceServers=t}return new t(e,r)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&di(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function ia(e){"object"==typeof e&&e.RTCPeerConnection&&"receiver"in e.RTCTrackEvent.prototype&&!e.RTCTransceiver&&di(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function na(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){var r,i;void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=Qo(r=this.getTransceivers()).call(r,e=>"audio"===e.receiver.track.kind);!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=Qo(i=this.getTransceivers()).call(i,e=>"video"===e.receiver.track.kind);!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video")}return t.apply(this,arguments)}}var oa=Object.freeze({__proto__:null,shimLocalStreamsAPI:$s,shimRemoteStreamsAPI:Js,shimCallbacksAPI:Xs,shimGetUserMedia:ea,shimConstraints:ta,shimRTCIceServerUrls:ra,shimTrackEventTransceiver:ia,shimCreateOfferLegacy:na});function sa(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){var r;if("object"==typeof e&&e.candidate&&0===Lo(r=e.candidate).call(r,"a=")&&((e=JSON.parse(ve(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){const r=new t(e),i=Ns.parseCandidate(e.candidate),n=ri(r,i);return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,Ii(e,"icecandidate",t=>(t.candidate&&di(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t))}function aa(e){if(!e.RTCPeerConnection)return;const t=Ni(e);"sctp"in e.RTCPeerConnection.prototype||di(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const r=function(e){if(!e||!e.sdp)return!1;const t=Ns.splitSections(e.sdp);return t.shift(),as(t).call(t,e=>{var t;const r=Ns.parseMLine(e);return r&&"application"===r.kind&&-1!==Lo(t=r.protocol).call(t,"SCTP")})},i=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const r=Si(t[1],10);return r!=r?-1:r},n=function(e){let r=65536;return"firefox"===t.browser&&(r=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),r},o=function(e,r){let i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);const n=Ns.matchPrefix(e.sdp,"a=max-message-size:");return n.length>0?i=Si(n[0].substr(19),10):"firefox"===t.browser&&-1!==r&&(i=2147483637),i},s=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&di(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(r(arguments[0])){const e=i(arguments[0]),t=n(e),r=o(arguments[0],e);let s;s=0===t&&0===r?Number.POSITIVE_INFINITY:0===t||0===r?Math.max(t,r):Math.min(t,r);const a={};di(a,"maxMessageSize",{get:()=>s}),this._sctp=a}return s.apply(this,arguments)}}function ca(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const r=e.send;e.send=function(){const i=arguments[0],n=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&n>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return r.apply(e,arguments)}}const r=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=r.apply(this,arguments);return t(e,this),e},Ii(e,"datachannel",e=>(t(e.channel,e.target),e))}function la(e){var t;if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const r=e.RTCPeerConnection.prototype;di(r,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),di(r,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),Jr(t=["setLocalDescription","setRemoteDescription"]).call(t,e=>{const t=r[e];r[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const r=new Event("connectionstatechange",e);t.dispatchEvent(r)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),t.apply(this,arguments)}})}function ua(e){if(!e.RTCPeerConnection)return;const t=Ni(e);if("chrome"===t.browser&&t.version>=71)return;const r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){var t,i;return e&&e.sdp&&-1!==Lo(t=e.sdp).call(t,"\na=extmap-allow-mixed")&&(e.sdp=ji(i=e.sdp.split("\n")).call(i,e=>"a=extmap-allow-mixed"!==Os(e).call(e)).join("\n")),r.apply(this,arguments)}}var da,ha,pa=Object.freeze({__proto__:null,shimRTCIceCandidate:sa,shimMaxMessageSize:aa,shimSendThrowTypeError:ca,shimConnectionState:la,removeAllowExtmapMixed:ua});!function({window:e}={},t={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0}){const r=ki,i=Ni(e),n={browserDetails:i,commonShim:pa,extractVersion:bi,disableLog:Ri,disableWarnings:wi};switch(i.browser){case"chrome":if(!Es||!_s||!t.shimChrome)return r("Chrome shim is not included in this adapter release."),n;r("adapter.js shimming chrome."),n.browserShim=Es,ls(e),us(e),_s(e),ds(e),ms(e),hs(e),ps(e),fs(e),vs(e),sa(e),la(e),aa(e),ca(e),ua(e);break;case"firefox":if(!Ks||!Ws||!t.shimFirefox)return r("Firefox shim is not included in this adapter release."),n;r("adapter.js shimming firefox."),n.browserShim=Ks,Hs(e),Ws(e),Qs(e),Zs(e),qs(e),zs(e),Ys(e),sa(e),la(e),aa(e),ca(e);break;case"edge":if(!Gs||!Vs||!t.shimEdge)return r("MS edge shim is not included in this adapter release."),n;r("adapter.js shimming edge."),n.browserShim=Gs,Us(e),Fs(e),Vs(e),js(e),aa(e),ca(e);break;case"safari":if(!oa||!t.shimSafari)return r("Safari shim is not included in this adapter release."),n;r("adapter.js shimming safari."),n.browserShim=oa,ra(e),na(e),Xs(e),$s(e),Js(e),ia(e),ea(e),sa(e),aa(e),ca(e),ua(e);break;default:r("Unsupported browser!")}}({window:window}),function(e){e.WIN_10="Windows 10",e.WIN_81="Windows 8.1",e.WIN_8="Windows 8",e.WIN_7="Windows 7",e.WIN_VISTA="Windows Vista",e.WIN_SERVER_2003="Windows Server 2003",e.WIN_XP="Windows XP",e.WIN_2000="Windows 2000",e.ANDROID="Android",e.OPEN_BSD="Open BSD",e.SUN_OS="Sun OS",e.LINUX="Linux",e.IOS="iOS",e.MAC_OS="Mac OS",e.QNX="QNX",e.UNIX="UNIX",e.BEOS="BeOS",e.OS_2="OS/2",e.SEARCH_BOT="Search Bot"}(da||(da={})),function(e){e.CHROME="Chrome",e.SAFARI="Safari",e.EDGE="Edge",e.FIREFOX="Firefox",e.OPERA="OPR",e.QQ="QQBrowser",e.WECHAT="MicroMessenger"}(ha||(ha={}));const fa=new(i((function(t,r){
/*!@license
	 * UAParser.js v0.7.28
	 * Lightweight JavaScript-based User-Agent string parser
	 * https://github.com/faisalman/ua-parser-js
	 *
	 * Copyright © 2012-2021 Faisal Salman <f@faisalman.com>
	 * Licensed under MIT License
	 */
!function(e,i){var n="function",o="object",s="string",a="model",c="name",l="type",u="vendor",d="version",h="architecture",p="console",f="mobile",g="tablet",m="smarttv",_="wearable",v="embedded",E={extend:function(e,t){var r={};for(var i in e)t[i]&&t[i].length%2==0?r[i]=t[i].concat(e[i]):r[i]=e[i];return r},has:function(e,t){return typeof e===s&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return typeof e===s?e.replace(/[^\d\.]/g,"").split(".")[0]:i},trim:function(e,t){return e=e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),void 0===t?e:e.substring(0,255)}},A={rgx:function(e,t){for(var r,s,a,c,l,u,d=0;d<t.length&&!l;){var h=t[d],p=t[d+1];for(r=s=0;r<h.length&&!l;)if(l=h[r++].exec(e))for(a=0;a<p.length;a++)u=l[++s],typeof(c=p[a])===o&&c.length>0?2==c.length?typeof c[1]==n?this[c[0]]=c[1].call(this,u):this[c[0]]=c[1]:3==c.length?typeof c[1]!==n||c[1].exec&&c[1].test?this[c[0]]=u?u.replace(c[1],c[2]):i:this[c[0]]=u?c[1].call(this,u,c[2]):i:4==c.length&&(this[c[0]]=u?c[3].call(this,u.replace(c[1],c[2])):i):this[c]=u||i;d+=2}},str:function(e,t){for(var r in t)if(typeof t[r]===o&&t[r].length>0){for(var n=0;n<t[r].length;n++)if(E.has(t[r][n],e))return"?"===r?i:r}else if(E.has(t[r],e))return"?"===r?i:r;return e}},y={browser:{oldSafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}},oldEdge:{version:{.1:"12.",21:"13.",31:"14.",39:"15.",41:"16.",42:"17.",44:"18."}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},S={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[d,[c,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[d,[c,"Edge"]],[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]{3,6})\b.+version\/([\w\.-]+)/i,/(opera)(?:.+version\/|[\/\s]+)([\w\.]+)/i],[c,d],[/opios[\/\s]+([\w\.]+)/i],[d,[c,"Opera Mini"]],[/\sopr\/([\w\.]+)/i],[d,[c,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(ba?idubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i,/(rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([\w\.]+)/i,/(weibo)__([\d\.]+)/i],[c,d],[/(?:[\s\/]uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[d,[c,"UCBrowser"]],[/(?:windowswechat)?\sqbcore\/([\w\.]+)\b.*(?:windowswechat)?/i],[d,[c,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[d,[c,"WeChat"]],[/konqueror\/([\w\.]+)/i],[d,[c,"Konqueror"]],[/trident.+rv[:\s]([\w\.]{1,9})\b.+like\sgecko/i],[d,[c,"IE"]],[/yabrowser\/([\w\.]+)/i],[d,[c,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[c,/(.+)/,"$1 Secure Browser"],d],[/focus\/([\w\.]+)/i],[d,[c,"Firefox Focus"]],[/opt\/([\w\.]+)/i],[d,[c,"Opera Touch"]],[/coc_coc_browser\/([\w\.]+)/i],[d,[c,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[d,[c,"Dolphin"]],[/coast\/([\w\.]+)/i],[d,[c,"Opera Coast"]],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[d,[c,"MIUI Browser"]],[/fxios\/([\w\.-]+)/i],[d,[c,"Firefox"]],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[c,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[c,/(.+)/,"$1 Browser"],d],[/(comodo_dragon)\/([\w\.]+)/i],[[c,/_/g," "],d],[/\s(electron)\/([\w\.]+)\ssafari/i,/(tesla)(?:\sqtcarbrowser|\/(20[12]\d\.[\w\.-]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/\s]?([\w\.]+)/i],[c,d],[/(MetaSr)[\/\s]?([\w\.]+)/i,/(LBBROWSER)/i],[c],[/;fbav\/([\w\.]+);/i],[d,[c,"Facebook"]],[/FBAN\/FBIOS|FB_IAB\/FB4A/i],[[c,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/\s]([\w\.-]+)/i],[c,d],[/\bgsa\/([\w\.]+)\s.*safari\//i],[d,[c,"GSA"]],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[d,[c,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[c,"Chrome WebView"],d],[/droid.+\sversion\/([\w\.]+)\b.+(?:mobile\ssafari|safari)/i],[d,[c,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[c,d],[/version\/([\w\.]+)\s.*mobile\/\w+\s(safari)/i],[d,[c,"Mobile Safari"]],[/version\/([\w\.]+)\s.*(mobile\s?safari|safari)/i],[d,c],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[c,[d,A.str,y.browser.oldSafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[c,d],[/(navigator|netscape)\/([\w\.-]+)/i],[[c,"Netscape"],d],[/ile\svr;\srv:([\w\.]+)\).+firefox/i],[d,[c,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(firefox)\/([\w\.]+)\s[\w\s\-]+\/[\w\.]+$/i,/(mozilla)\/([\w\.]+)\s.+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[c,d]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[h,"amd64"]],[/(ia32(?=;))/i],[[h,E.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[h,"ia32"]],[/\b(aarch64|armv?8e?l?)\b/i],[[h,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[h,"armhf"]],[/windows\s(ce|mobile);\sppc;/i],[[h,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[h,/ower/,"",E.lowerize]],[/(sun4\w)[;\)]/i],[[h,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?:64|(?=v(?:[1-7]|[5-7]1)l?|;|eabi))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[h,E.lowerize]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus\s10)/i],[a,[u,"Samsung"],[l,g]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy\snexus)/i,/\ssamsung[\s-]([\w-]+)/i,/sec-(sgh\w+)/i],[a,[u,"Samsung"],[l,f]],[/\((ip(?:hone|od)[\s\w]*);/i],[a,[u,"Apple"],[l,f]],[/\((ipad);[\w\s\),;-]+apple/i,/applecoremedia\/[\w\.]+\s\((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[a,[u,"Apple"],[l,g]],[/\b((?:agr|ags[23]|bah2?|sht?)-a?[lw]\d{2})/i],[a,[u,"Huawei"],[l,g]],[/d\/huawei([\w\s-]+)[;\)]/i,/\b(nexus\s6p|vog-[at]?l\d\d|ane-[at]?l[x\d]\d|eml-a?l\d\da?|lya-[at]?l\d[\dc]|clt-a?l\d\di?|ele-l\d\d)/i,/\b(\w{2,4}-[atu][ln][01259][019])[;\)\s]/i],[a,[u,"Huawei"],[l,f]],[/\b(poco[\s\w]+)(?:\sbuild|\))/i,/\b;\s(\w+)\sbuild\/hm\1/i,/\b(hm[\s\-_]?note?[\s_]?(?:\d\w)?)\sbuild/i,/\b(redmi[\s\-_]?(?:note|k)?[\w\s_]+)(?:\sbuild|\))/i,/\b(mi[\s\-_]?(?:a\d|one|one[\s_]plus|note lte)?[\s_]?(?:\d?\w?)[\s_]?(?:plus)?)\sbuild/i],[[a,/_/g," "],[u,"Xiaomi"],[l,f]],[/\b(mi[\s\-_]?(?:pad)(?:[\w\s_]+))(?:\sbuild|\))/i],[[a,/_/g," "],[u,"Xiaomi"],[l,g]],[/;\s(\w+)\sbuild.+\soppo/i,/\s(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007)\b/i],[a,[u,"OPPO"],[l,f]],[/\svivo\s(\w+)(?:\sbuild|\))/i,/\s(v[12]\d{3}\w?[at])(?:\sbuild|;)/i],[a,[u,"Vivo"],[l,f]],[/\s(rmx[12]\d{3})(?:\sbuild|;)/i],[a,[u,"Realme"],[l,f]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)\b[\w\s]+build\//i,/\smot(?:orola)?[\s-](\w*)/i,/((?:moto[\s\w\(\)]+|xt\d{3,4}|nexus\s6)(?=\sbuild|\)))/i],[a,[u,"Motorola"],[l,f]],[/\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[a,[u,"Motorola"],[l,g]],[/((?=lg)?[vl]k\-?\d{3})\sbuild|\s3\.[\s\w;-]{10}lg?-([06cv9]{3,4})/i],[a,[u,"LG"],[l,g]],[/(lm-?f100[nv]?|nexus\s[45])/i,/lg[e;\s\/-]+((?!browser|netcast)\w+)/i,/\blg(\-?[\d\w]+)\sbuild/i],[a,[u,"LG"],[l,f]],[/(ideatab[\w\-\s]+)/i,/lenovo\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+)|yt[\d\w-]{6}|tb[\d\w-]{6})/i],[a,[u,"Lenovo"],[l,g]],[/(?:maemo|nokia).*(n900|lumia\s\d+)/i,/nokia[\s_-]?([\w\.-]*)/i],[[a,/_/g," "],[u,"Nokia"],[l,f]],[/droid.+;\s(pixel\sc)[\s)]/i],[a,[u,"Google"],[l,g]],[/droid.+;\s(pixel[\s\daxl]{0,6})(?:\sbuild|\))/i],[a,[u,"Google"],[l,f]],[/droid.+\s([c-g]\d{4}|so[-l]\w+|xq-a\w[4-7][12])(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[a,[u,"Sony"],[l,f]],[/sony\stablet\s[ps]\sbuild\//i,/(?:sony)?sgp\w+(?:\sbuild\/|\))/i],[[a,"Xperia Tablet"],[u,"Sony"],[l,g]],[/\s(kb2005|in20[12]5|be20[12][59])\b/i,/\ba000(1)\sbuild/i,/\boneplus\s(a\d{4})[\s)]/i],[a,[u,"OnePlus"],[l,f]],[/(alexa)webm/i,/(kf[a-z]{2}wi)(\sbuild\/|\))/i,/(kf[a-z]+)(\sbuild\/|\)).+silk\//i],[a,[u,"Amazon"],[l,g]],[/(sd|kf)[0349hijorstuw]+(\sbuild\/|\)).+silk\//i],[[a,"Fire Phone"],[u,"Amazon"],[l,f]],[/\((playbook);[\w\s\),;-]+(rim)/i],[a,u,[l,g]],[/((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10;\s(\w+)/i],[a,[u,"BlackBerry"],[l,f]],[/(?:\b|asus_)(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus\s7|padfone|p00[cj])/i],[a,[u,"ASUS"],[l,g]],[/\s(z[es]6[027][01][km][ls]|zenfone\s\d\w?)\b/i],[a,[u,"ASUS"],[l,f]],[/(nexus\s9)/i],[a,[u,"HTC"],[l,g]],[/(htc)[;_\s-]{1,2}([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[u,[a,/_/g," "],[l,f]],[/droid[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[a,[u,"Acer"],[l,g]],[/droid.+;\s(m[1-5]\snote)\sbuild/i,/\bmz-([\w-]{2,})/i],[a,[u,"Meizu"],[l,f]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i,/(microsoft);\s(lumia[\s\w]+)/i,/(lenovo)[_\s-]?([\w-]+)/i,/linux;.+(jolla);/i,/droid.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[u,a,[l,f]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i,/[;\/]\s?(le[\s\-]+pan)[\s\-]+(\w{1,9})\sbuild/i,/[;\/]\s?(trinity)[\-\s]*(t\d{3})\sbuild/i,/\b(gigaset)[\s\-]+(q\w{1,9})\sbuild/i,/\b(vodafone)\s([\w\s]+)(?:\)|\sbuild)/i],[u,a,[l,g]],[/\s(surface\sduo)\s/i],[a,[u,"Microsoft"],[l,g]],[/droid\s[\d\.]+;\s(fp\du?)\sbuild/i],[a,[u,"Fairphone"],[l,f]],[/\s(u304aa)\sbuild/i],[a,[u,"AT&T"],[l,f]],[/sie-(\w*)/i],[a,[u,"Siemens"],[l,f]],[/[;\/]\s?(rct\w+)\sbuild/i],[a,[u,"RCA"],[l,g]],[/[;\/\s](venue[\d\s]{2,7})\sbuild/i],[a,[u,"Dell"],[l,g]],[/[;\/]\s?(q(?:mv|ta)\w+)\sbuild/i],[a,[u,"Verizon"],[l,g]],[/[;\/]\s(?:barnes[&\s]+noble\s|bn[rt])([\w\s\+]*)\sbuild/i],[a,[u,"Barnes & Noble"],[l,g]],[/[;\/]\s(tm\d{3}\w+)\sbuild/i],[a,[u,"NuVision"],[l,g]],[/;\s(k88)\sbuild/i],[a,[u,"ZTE"],[l,g]],[/;\s(nx\d{3}j)\sbuild/i],[a,[u,"ZTE"],[l,f]],[/[;\/]\s?(gen\d{3})\sbuild.*49h/i],[a,[u,"Swiss"],[l,f]],[/[;\/]\s?(zur\d{3})\sbuild/i],[a,[u,"Swiss"],[l,g]],[/[;\/]\s?((zeki)?tb.*\b)\sbuild/i],[a,[u,"Zeki"],[l,g]],[/[;\/]\s([yr]\d{2})\sbuild/i,/[;\/]\s(dragon[\-\s]+touch\s|dt)(\w{5})\sbuild/i],[[u,"Dragon Touch"],a,[l,g]],[/[;\/]\s?(ns-?\w{0,9})\sbuild/i],[a,[u,"Insignia"],[l,g]],[/[;\/]\s?((nxa|Next)-?\w{0,9})\sbuild/i],[a,[u,"NextBook"],[l,g]],[/[;\/]\s?(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05]))\sbuild/i],[[u,"Voice"],a,[l,f]],[/[;\/]\s?(lvtel\-)?(v1[12])\sbuild/i],[[u,"LvTel"],a,[l,f]],[/;\s(ph-1)\s/i],[a,[u,"Essential"],[l,f]],[/[;\/]\s?(v(100md|700na|7011|917g).*\b)\sbuild/i],[a,[u,"Envizen"],[l,g]],[/[;\/]\s?(trio[\s\w\-\.]+)\sbuild/i],[a,[u,"MachSpeed"],[l,g]],[/[;\/]\s?tu_(1491)\sbuild/i],[a,[u,"Rotor"],[l,g]],[/(shield[\w\s]+)\sbuild/i],[a,[u,"Nvidia"],[l,g]],[/(sprint)\s(\w+)/i],[u,a,[l,f]],[/(kin\.[onetw]{3})/i],[[a,/\./g," "],[u,"Microsoft"],[l,f]],[/droid\s[\d\.]+;\s(cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[a,[u,"Zebra"],[l,g]],[/droid\s[\d\.]+;\s(ec30|ps20|tc[2-8]\d[kx])\)/i],[a,[u,"Zebra"],[l,f]],[/\s(ouya)\s/i,/(nintendo)\s([wids3utch]+)/i],[u,a,[l,p]],[/droid.+;\s(shield)\sbuild/i],[a,[u,"Nvidia"],[l,p]],[/(playstation\s[345portablevi]+)/i],[a,[u,"Sony"],[l,p]],[/[\s\(;](xbox(?:\sone)?(?!;\sxbox))[\s\);]/i],[a,[u,"Microsoft"],[l,p]],[/smart-tv.+(samsung)/i],[u,[l,m]],[/hbbtv.+maple;(\d+)/i],[[a,/^/,"SmartTV"],[u,"Samsung"],[l,m]],[/(?:linux;\snetcast.+smarttv|lg\snetcast\.tv-201\d)/i],[[u,"LG"],[l,m]],[/(apple)\s?tv/i],[u,[a,"Apple TV"],[l,m]],[/crkey/i],[[a,"Chromecast"],[u,"Google"],[l,m]],[/droid.+aft([\w])(\sbuild\/|\))/i],[a,[u,"Amazon"],[l,m]],[/\(dtv[\);].+(aquos)/i],[a,[u,"Sharp"],[l,m]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[u,E.trim],[a,E.trim],[l,m]],[/[\s\/\(](android\s|smart[-\s]?|opera\s)tv[;\)\s]/i],[[l,m]],[/((pebble))app\/[\d\.]+\s/i],[u,a,[l,_]],[/droid.+;\s(glass)\s\d/i],[a,[u,"Google"],[l,_]],[/droid\s[\d\.]+;\s(wt63?0{2,3})\)/i],[a,[u,"Zebra"],[l,_]],[/(tesla)(?:\sqtcarbrowser|\/20[12]\d\.[\w\.-]+)/i],[u,[l,v]],[/droid .+?; ([^;]+?)(?: build|\) applewebkit).+? mobile safari/i],[a,[l,f]],[/droid .+?;\s([^;]+?)(?: build|\) applewebkit).+?(?! mobile) safari/i],[a,[l,g]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[l,E.lowerize]],[/(android[\w\.\s\-]{0,9});.+build/i],[a,[u,"Generic"]],[/(phone)/i],[[l,f]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[d,[c,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[d,[c,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[c,d],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[d,c]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[c,d],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)(?!.+xbox)/i],[c,[d,A.str,y.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[c,"Windows"],[d,A.str,y.os.windows.version]],[/ip[honead]{2,4}\b(?:.*os\s([\w]+)\slike\smac|;\sopera)/i,/cfnetwork\/.+darwin/i],[[d,/_/g,"."],[c,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)(?!.+haiku)/i],[[c,"Mac OS"],[d,/_/g,"."]],[/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/\((series40);/i],[c,d],[/\(bb(10);/i],[d,[c,"BlackBerry"]],[/(?:symbian\s?os|symbos|s60(?=;)|series60)[\/\s-]?([\w\.]*)/i],[d,[c,"Symbian"]],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[c,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[d,[c,"webOS"]],[/crkey\/([\d\.]+)/i],[d,[c,"Chromecast"]],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[c,"Chromium OS"],d],[/(nintendo|playstation)\s([wids345portablevuch]+)/i,/(xbox);\s+xbox\s([^\);]+)/i,/(mint)[\/\s\(\)]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?=\slinux)|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus|raspbian)(?:\sgnu\/linux)?(?:\slinux)?[\/\s-]?(?!chrom|package)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i,/\s([frentopc-]{0,4}bsd|dragonfly)\s?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku)\s(\w+)/i],[c,d],[/(sunos)\s?([\w\.\d]*)/i],[[c,"Solaris"],d],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[c,d]]},C=function(t,r){if("object"==typeof t&&(r=t,t=i),!(this instanceof C))return new C(t,r).getResult();var n=t||(void 0!==e&&e.navigator&&e.navigator.userAgent?e.navigator.userAgent:""),o=r?E.extend(S,r):S;return this.getBrowser=function(){var e={name:i,version:i};return A.rgx.call(e,n,o.browser),e.major=E.major(e.version),e},this.getCPU=function(){var e={architecture:i};return A.rgx.call(e,n,o.cpu),e},this.getDevice=function(){var e={vendor:i,model:i,type:i};return A.rgx.call(e,n,o.device),e},this.getEngine=function(){var e={name:i,version:i};return A.rgx.call(e,n,o.engine),e},this.getOS=function(){var e={name:i,version:i};return A.rgx.call(e,n,o.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=typeof e===s&&e.length>255?E.trim(e,255):e,this},this.setUA(n),this};C.VERSION="0.7.28",C.BROWSER={NAME:c,MAJOR:"major",VERSION:d},C.CPU={ARCHITECTURE:h},C.DEVICE={MODEL:a,VENDOR:u,TYPE:l,CONSOLE:p,MOBILE:f,SMARTTV:m,TABLET:g,WEARABLE:_,EMBEDDED:v},C.ENGINE={NAME:c,VERSION:d},C.OS={NAME:c,VERSION:d},t.exports&&(r=t.exports=C),r.UAParser=C;var T=void 0!==e&&(e.jQuery||e.Zepto);if(T&&!T.ua){var b=new C;T.ua=b.getResult(),T.ua.get=function(){return b.getUA()},T.ua.set=function(e){b.setUA(e);var t=b.getResult();for(var r in t)T.ua[r]=t[r]}}}("object"==typeof window?window:e)})));let ga=fa.getResult();function ma(e){return e&&fa.setUA(e),ga=fa.getResult(),{name:_a(ga),version:va(ga),os:Ea(ga),osVersion:ga.os.version}}function _a(e){if("Blink"===e.engine.name&&"WeChat"!==e.browser.name)return ha.CHROME;switch(e.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return ha.CHROME;case"Safari":case"Mobile Safari":return ha.SAFARI;case"Edge":return ha.EDGE;case"Firefox":return ha.FIREFOX;case"QQBrowser":return ha.QQ;case"Opera":return ha.OPERA;case"WeChat":return ha.WECHAT;default:return e.browser.name||""}}function va(e){let t;return t="Blink"===e.engine.name?e.engine.version||"":e.browser.version||"",t.split(".")[0]}function Ea(e){switch(e.os.name){case"Windows":return e.os.version?e.os.name+" "+e.os.version:e.os.name;default:return e.os.name||""}}function Aa(){return ma().os}function ya(){const e=ma();return!!("WebKit"===ga.engine.name&&e.os===da.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&e.name!==ha.SAFARI||Ra()&&e.name!==ha.SAFARI)}function Sa(){const e=ma();if(ya()){if(e.os===da.MAC_OS)return!0;if(e.os===da.IOS){const e=ga.os.version&&ga.os.version.split(".");if(e&&14===Number(e[0])&&e[1]&&Number(e[1])>=3)return!0;if(e&&Number(e[0])>14)return!0}}return!1}function Ca(){return"WebKit"===ga.engine.name}function Ta(){return ma().name===ha.CHROME}function ba(){return ma().name===ha.SAFARI}function Ia(){return ma().name===ha.FIREFOX}function Ra(){return ma().os===da.IOS}function wa(){const e=ma();if(e.os!==da.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 15===Number(t[0])}function ka(){const e=ma();if(e.os!==da.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 15===Number(t[0])&&0===Number(t[1])}function Oa(){const e=ma();if(e.os!==da.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 15===Number(t[0])&&Number(t[1])>=1}function Na(){return ba()&&navigator.maxTouchPoints>0}function La(){return ma().name===ha.WECHAT}function Pa(){return window.navigator.appVersion&&null!==window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function Da(){const e=ma();return e.name!==ha.EDGE&&e.name!==ha.SAFARI&&!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}Q({target:"Date",stat:!0},{now:function(){return(new Date).getTime()}});var Ma=M.Date.now,xa=[].slice,Ba=/MSIE .\./.test(xe),Ua=function(e){return function(t,r){var i=arguments.length>2,n=i?xa.call(arguments,2):void 0;return e(i?function(){("function"==typeof t?t:Function(t)).apply(this,n)}:t,r)}};Q({global:!0,bind:!0,forced:Ba},{setTimeout:Ua(o.setTimeout),setInterval:Ua(o.setInterval)});var Fa=M.setTimeout,Va=function(e,t){return function(){for(var r=new Array(arguments.length),i=0;i<r.length;i++)r[i]=arguments[i];return e.apply(t,r)}},ja=Object.prototype.toString;function Ga(e){return"[object Array]"===ja.call(e)}function Ha(e){return null!==e&&"object"==typeof e}function Qa(e){return"[object Function]"===ja.call(e)}function Wa(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),Ga(e))for(var r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.call(null,e[n],n,e)}var qa={isArray:Ga,isArrayBuffer:function(e){return"[object ArrayBuffer]"===ja.call(e)},isBuffer:function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:Ha,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===ja.call(e)},isFile:function(e){return"[object File]"===ja.call(e)},isBlob:function(e){return"[object Blob]"===ja.call(e)},isFunction:Qa,isStream:function(e){return Ha(e)&&Qa(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:Wa,merge:function e(){var t={};function r(r,i){"object"==typeof t[i]&&"object"==typeof r?t[i]=e(t[i],r):t[i]=r}for(var i=0,n=arguments.length;i<n;i++)Wa(arguments[i],r);return t},deepMerge:function e(){var t={};function r(r,i){"object"==typeof t[i]&&"object"==typeof r?t[i]=e(t[i],r):t[i]="object"==typeof r?e({},r):r}for(var i=0,n=arguments.length;i<n;i++)Wa(arguments[i],r);return t},extend:function(e,t,r){return Wa(t,(function(t,i){e[i]=r&&"function"==typeof t?Va(t,r):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}};function za(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var Za=function(e,t,r){if(!t)return e;var i;if(r)i=r(t);else if(qa.isURLSearchParams(t))i=t.toString();else{var n=[];qa.forEach(t,(function(e,t){null!=e&&(qa.isArray(e)?t+="[]":e=[e],qa.forEach(e,(function(e){qa.isDate(e)?e=e.toISOString():qa.isObject(e)&&(e=JSON.stringify(e)),n.push(za(t)+"="+za(e))})))})),i=n.join("&")}if(i){var o=e.indexOf("#");-1!==o&&(e=e.slice(0,o)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e};function Ya(){this.handlers=[]}Ya.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},Ya.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},Ya.prototype.forEach=function(e){qa.forEach(this.handlers,(function(t){null!==t&&e(t)}))};var Ka=Ya,$a=function(e,t,r){return qa.forEach(r,(function(r){e=r(e,t)})),e},Ja=function(e){return!(!e||!e.__CANCEL__)},Xa=function(e,t){qa.forEach(e,(function(r,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[i])}))},ec=function(e,t,r,i,n){return function(e,t,r,i,n){return e.config=t,r&&(e.code=r),e.request=i,e.response=n,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}(new Error(e),t,r,i,n)},tc=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],rc=qa.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function i(e){var i=e;return t&&(r.setAttribute("href",i),i=r.href),r.setAttribute("href",i),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=i(window.location.href),function(t){var r=qa.isString(t)?i(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0},ic=qa.isStandardBrowserEnv()?{write:function(e,t,r,i,n,o){var s=[];s.push(e+"="+encodeURIComponent(t)),qa.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),qa.isString(i)&&s.push("path="+i),qa.isString(n)&&s.push("domain="+n),!0===o&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},nc=function(e){return new Promise((function(t,r){var i=e.data,n=e.headers;qa.isFormData(i)&&delete n["Content-Type"];var o=new XMLHttpRequest;if(e.auth){var s=e.auth.username||"",a=e.auth.password||"";n.Authorization="Basic "+btoa(s+":"+a)}if(o.open(e.method.toUpperCase(),Za(e.url,e.params,e.paramsSerializer),!0),o.timeout=e.timeout,o.onreadystatechange=function(){if(o&&4===o.readyState&&(0!==o.status||o.responseURL&&0===o.responseURL.indexOf("file:"))){var i,n,s,a,c,l="getAllResponseHeaders"in o?(i=o.getAllResponseHeaders(),c={},i?(qa.forEach(i.split("\n"),(function(e){if(a=e.indexOf(":"),n=qa.trim(e.substr(0,a)).toLowerCase(),s=qa.trim(e.substr(a+1)),n){if(c[n]&&tc.indexOf(n)>=0)return;c[n]="set-cookie"===n?(c[n]?c[n]:[]).concat([s]):c[n]?c[n]+", "+s:s}})),c):c):null,u={data:e.responseType&&"text"!==e.responseType?o.response:o.responseText,status:o.status,statusText:o.statusText,headers:l,config:e,request:o};!function(e,t,r){var i=r.config.validateStatus;!i||i(r.status)?e(r):t(ec("Request failed with status code "+r.status,r.config,null,r.request,r))}(t,r,u),o=null}},o.onabort=function(){o&&(r(ec("Request aborted",e,"ECONNABORTED",o)),o=null)},o.onerror=function(){r(ec("Network Error",e,null,o)),o=null},o.ontimeout=function(){r(ec("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",o)),o=null},qa.isStandardBrowserEnv()){var c=ic,l=(e.withCredentials||rc(e.url))&&e.xsrfCookieName?c.read(e.xsrfCookieName):void 0;l&&(n[e.xsrfHeaderName]=l)}if("setRequestHeader"in o&&qa.forEach(n,(function(e,t){void 0===i&&"content-type"===t.toLowerCase()?delete n[t]:o.setRequestHeader(t,e)})),e.withCredentials&&(o.withCredentials=!0),e.responseType)try{o.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&o.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&o.upload&&o.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){o&&(o.abort(),r(e),o=null)})),void 0===i&&(i=null),o.send(i)}))},oc={"Content-Type":"application/x-www-form-urlencoded"};function sc(e,t){!qa.isUndefined(e)&&qa.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var ac={adapter:function(){var e;return("undefined"!=typeof r&&"[object process]"===Object.prototype.toString.call(r)||"undefined"!=typeof XMLHttpRequest)&&(e=nc),e}(),transformRequest:[function(e,t){return Xa(t,"Accept"),Xa(t,"Content-Type"),qa.isFormData(e)||qa.isArrayBuffer(e)||qa.isBuffer(e)||qa.isStream(e)||qa.isFile(e)||qa.isBlob(e)?e:qa.isArrayBufferView(e)?e.buffer:qa.isURLSearchParams(e)?(sc(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):qa.isObject(e)?(sc(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};qa.forEach(["delete","get","head"],(function(e){ac.headers[e]={}})),qa.forEach(["post","put","patch"],(function(e){ac.headers[e]=qa.merge(oc)}));var cc=ac;function lc(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var uc=function(e){var t,r;return lc(e),e.baseURL&&!function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}(e.url)&&(e.url=(t=e.baseURL,(r=e.url)?t.replace(/\/+$/,"")+"/"+r.replace(/^\/+/,""):t)),e.headers=e.headers||{},e.data=$a(e.data,e.headers,e.transformRequest),e.headers=qa.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),qa.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||cc.adapter)(e).then((function(t){return lc(e),t.data=$a(t.data,t.headers,e.transformResponse),t}),(function(t){return Ja(t)||(lc(e),t&&t.response&&(t.response.data=$a(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))},dc=function(e,t){t=t||{};var r={};return qa.forEach(["url","method","params","data"],(function(e){void 0!==t[e]&&(r[e]=t[e])})),qa.forEach(["headers","auth","proxy"],(function(i){qa.isObject(t[i])?r[i]=qa.deepMerge(e[i],t[i]):void 0!==t[i]?r[i]=t[i]:qa.isObject(e[i])?r[i]=qa.deepMerge(e[i]):void 0!==e[i]&&(r[i]=e[i])})),qa.forEach(["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"],(function(i){void 0!==t[i]?r[i]=t[i]:void 0!==e[i]&&(r[i]=e[i])})),r};function hc(e){this.defaults=e,this.interceptors={request:new Ka,response:new Ka}}hc.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=dc(this.defaults,e)).method=e.method?e.method.toLowerCase():"get";var t=[uc,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)r=r.then(t.shift(),t.shift());return r},hc.prototype.getUri=function(e){return e=dc(this.defaults,e),Za(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},qa.forEach(["delete","get","head","options"],(function(e){hc.prototype[e]=function(t,r){return this.request(qa.merge(r||{},{method:e,url:t}))}})),qa.forEach(["post","put","patch"],(function(e){hc.prototype[e]=function(t,r,i){return this.request(qa.merge(i||{},{method:e,url:t,data:r}))}}));var pc=hc;function fc(e){this.message=e}fc.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},fc.prototype.__CANCEL__=!0;var gc=fc;function mc(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;e((function(e){r.reason||(r.reason=new gc(e),t(r.reason))}))}mc.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},mc.source=function(){var e;return{token:new mc((function(t){e=t})),cancel:e}};var _c=mc;function vc(e){var t=new pc(e),r=Va(pc.prototype.request,t);return qa.extend(r,pc.prototype,t),qa.extend(r,t),r}var Ec=vc(cc);Ec.Axios=pc,Ec.create=function(e){return vc(dc(Ec.defaults,e))},Ec.Cancel=gc,Ec.CancelToken=_c,Ec.isCancel=Ja,Ec.all=function(e){return Promise.all(e)},Ec.spread=function(e){return function(t){return e.apply(null,t)}};var Ac=Ec,yc=Ec;Ac.default=yc;var Sc=Ac;function Cc(){const e=new Date;return e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}const Tc={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},bc=Ma(),Ic=e=>{for(const t in Tc)if(Object.prototype.hasOwnProperty.call(Tc,t)&&Tc[t]===e)return t;return"DEFAULT"},Rc=new class{constructor(){this.logLevel=Tc.DEBUG,this.uploadState="collecting",this.uploadLogWaitingList=[],this.uploadLogUploadingList=[],this.uploadErrorCount=0,this.currentLogID=0}debug(...e){var t;const r=Je(t=[Tc.DEBUG]).call(t,e);this.log.apply(this,r)}info(...e){var t;const r=Je(t=[Tc.INFO]).call(t,e);this.log.apply(this,r)}warning(...e){var t;const r=Je(t=[Tc.WARNING]).call(t,e);this.log.apply(this,r)}error(...e){var t;const r=Je(t=[Tc.ERROR]).call(t,e);this.log.apply(this,r)}upload(...e){var t;const r=Je(t=[Tc.DEBUG]).call(t,e);this.uploadLog.apply(this,r)}setLogLevel(e){e=Math.min(Math.max(0,e),4),this.logLevel=e}enableLogUpload(){Vc("UPLOAD_LOG",!0)}disableLogUpload(){Vc("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(e){this.proxyServerURL=e}log(...e){var t,r,i,n;if(Ma()-bc<100)return void Fa(()=>{this.log(...e)},Ma()-bc);const o=Math.max(0,Math.min(4,e[0]));if(e[0]=Cc()+" Agora-SDK [".concat(Ic(o),"]:"),this.appendLogToWaitingList(o,e),o<this.logLevel)return;const s=Cc()+" %cAgora-SDK [".concat(Ic(o),"]:");let a=[];switch(o){case Tc.DEBUG:a=Je(t=[s,"color: #64B5F6;"]).call(t,Uo(e).call(e,1)),console.log.apply(console,a);break;case Tc.INFO:a=Je(r=[s,"color: #1E88E5; font-weight: bold;"]).call(r,Uo(e).call(e,1)),console.log.apply(console,a);break;case Tc.WARNING:a=Je(i=[s,"color: #FB8C00; font-weight: bold;"]).call(i,Uo(e).call(e,1)),console.warn.apply(console,a);break;case Tc.ERROR:a=Je(n=[s,"color: #B00020; font-weight: bold;"]).call(n,Uo(e).call(e,1)),console.error.apply(console,a)}}uploadLog(...e){if(Ma()-bc<100)return void Fa(()=>{this.uploadLog(...e)},Ma()-bc);const t=Math.max(0,Math.min(4,e[0]));e[0]=Cc()+" Agora-SDK [".concat(Ic(t),"]:"),this.appendLogToWaitingList(t,e)}appendLogToWaitingList(e,...t){if(!jc("UPLOAD_LOG"))return;let r="";Jr(t).call(t,e=>{"object"==typeof e&&(e=ve(e)),r+="".concat(e," ")}),this.uploadLogWaitingList.push({payload_str:r,log_level:e,log_item_id:this.currentLogID++}),"uploading"===this.uploadState&&0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}async uploadLogs(){var e;const t=this.uploadLogUploadingList,r={sdk_version:kc,process_id:jc("PROCESS_ID"),payload:ve(t)},i=await Sc.post(this.url||(this.proxyServerURL?Je(e="https://".concat(this.proxyServerURL,"/ls/?h=")).call(e,jc("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(jc("LOG_UPLOAD_SERVER"),"/upload/v1")),r,{responseType:"text"});if("OK"!==i.data)throw new Error("unexpected upload log response: "+i.data);this.uploadLogUploadingList=[]}uploadLogInterval(){var e;0===this.uploadLogUploadingList.length&&0===this.uploadLogWaitingList.length||(0===this.uploadLogUploadingList.length&&(this.uploadLogUploadingList=bo(e=this.uploadLogWaitingList).call(e,0,10)),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),3e3)}).catch(e=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),200):window.setTimeout(()=>this.uploadLogInterval(),1e3)}))}},wc="v4.8.1-0-ge9003043(1/5/2022, 3:55:58 PM)",kc=function(e){if(e.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return e;const t=e.match(/([0-9]+\.[0-9]+\.[0-9]+)\-alpha\.([0-9]+)/);if(t&&t[1]&&t[2]){var r;const e=t[1],i=t[2];return Je(r="".concat(e,".")).call(r,i)}const i=e.match(/([0-9]+\.[0-9]+\.[0-9]+)\-special\.([0-9]+)/);if(i&&i[1]&&i[2]){var n;const e=i[1],t=i[2];return Je(n="".concat(e,".")).call(n,100*(Number(t)+1))}return"4.0.0.999"}("4.8.1"),Oc=function(){try{return!0===JSON.parse("true")}catch(e){return!0}}(),Nc={username:"test",password:"111111",turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1},Lc={"90p":Wc(160,90),"90p_1":Wc(160,90),"120p":Wc(160,120,15,30,65),"120p_1":Wc(160,120,15,30,65),"120p_3":Wc(120,120,15,30,50),"120p_4":Wc(212,120),"180p":Wc(320,180,15,30,140),"180p_1":Wc(320,180,15,30,140),"180p_3":Wc(180,180,15,30,100),"180p_4":Wc(240,180,15,30,120),"240p":Wc(320,240,15,40,200),"240p_1":Wc(320,240,15,40,200),"240p_3":Wc(240,240,15,40,140),"240p_4":Wc(424,240,15,40,220),"360p":Wc(640,360,15,80,400),"360p_1":Wc(640,360,15,80,400),"360p_3":Wc(360,360,15,80,260),"360p_4":Wc(640,360,30,80,600),"360p_6":Wc(360,360,30,80,400),"360p_7":Wc(480,360,15,80,320),"360p_8":Wc(480,360,30,80,490),"360p_9":Wc(640,360,15,80,800),"360p_10":Wc(640,360,24,80,800),"360p_11":Wc(640,360,24,80,1e3),"480p":Wc(640,480,15,100,500),"480p_1":Wc(640,480,15,100,500),"480p_2":Wc(640,480,30,100,1e3),"480p_3":Wc(480,480,15,100,400),"480p_4":Wc(640,480,30,100,750),"480p_6":Wc(480,480,30,100,600),"480p_8":Wc(848,480,15,100,610),"480p_9":Wc(848,480,30,100,930),"480p_10":Wc(640,480,10,100,400),"720p":Wc(1280,720,15,120,1130),"720p_1":Wc(1280,720,15,120,1130),"720p_2":Wc(1280,720,30,120,2e3),"720p_3":Wc(1280,720,30,120,1710),"720p_5":Wc(960,720,15,120,910),"720p_6":Wc(960,720,30,120,1380),"1080p":Wc(1920,1080,15,120,2080),"1080p_1":Wc(1920,1080,15,120,2080),"1080p_2":Wc(1920,1080,30,120,3e3),"1080p_3":Wc(1920,1080,30,120,3150),"1080p_5":Wc(1920,1080,60,120,4780),"1440p":Wc(2560,1440,30,120,4850),"1440p_1":Wc(2560,1440,30,120,4850),"1440p_2":Wc(2560,1440,60,120,7350),"4k":Wc(3840,2160,30,120,8910),"4k_1":Wc(3840,2160,30,120,8910),"4k_3":Wc(3840,2160,60,120,13500)},Pc={"480p":qc(640,480,5),"480p_1":qc(640,480,5),"480p_2":qc(640,480,30),"480p_3":qc(640,480,15),"720p":qc(1280,720,5),"720p_1":qc(1280,720,5),"720p_2":qc(1280,720,30),"720p_3":qc(1280,720,15),"1080p":qc(1920,1080,5),"1080p_1":qc(1920,1080,5),"1080p_2":qc(1920,1080,30),"1080p_3":qc(1920,1080,15)},Dc={"1SL1TL":zc(1,1),"3SL3TL":zc(3,3),"2SL3TL":zc(2,3)};function Mc(e){return"string"==typeof e?ri({},Lc[e]):e}function xc(e){return"string"==typeof e?ri({},Pc[e]):e}function Bc(e){return"string"==typeof e?ri({},Dc[e]):e}const Uc={speech_low_quality:Qc(16e3,!1),speech_standard:Qc(32e3,!1,18),music_standard:Qc(48e3,!1),standard_stereo:Qc(48e3,!0,56),high_quality:Qc(48e3,!1,128),high_quality_stereo:Qc(48e3,!0,192)};function Fc(e){return"string"==typeof e?ri({},Uc[e]):e}function Vc(e,t,r){var i,n;is(i=ni(Gc)).call(i,e)&&(!r&&is(n=ni(Hc)).call(n,e)||(Gc[e]=t))}function jc(e){return Gc[e]}const Gc={PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,UPLOAD_LOG:!1,NOT_REPORT_EVENT:[],SUBSCRIBE_TCC:!0,PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],WORKER_DOMAIN:"edge.agora.io",TURN_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,USE_RTX:!1,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,SDK_FALLBACK:!0,ENUMERATE_DEVICES_INTERVAL:!0,H264_PROFILE_LEVEL_ID:"",SDP_LOGGING:!1,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},USE_NEW_TOKEN:!0},Hc={};function Qc(e,t,r){return{sampleRate:e,stereo:t,bitrate:r}}function Wc(e,t,r,i,n){return{width:e,height:t,frameRate:r,bitrateMin:i,bitrateMax:n}}function qc(e,t,r,i,n){return{width:{max:e},height:{max:t},frameRate:r,bitrateMin:i,bitrateMax:n}}function zc(e,t){return{numSpatialLayers:e,numTemporalLayers:t}}Oc||(Gc.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],Gc.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],Gc.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],Gc.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],Gc.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],Gc.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],Gc.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",Gc.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",Gc.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",Gc.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",Gc.AREAS=["NORTH_AMERICA","OVERSEA"]);const Zc=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],Yc=[],Kc=[];function $c(e){is(Yc).call(Yc,e)||Yc.push(e)}function Jc(e){const t=Lo(Yc).call(Yc,e);-1!==t&&bo(Yc).call(Yc,t,1)}function Xc(e){is(Kc).call(Kc,e)||Kc.push(e)}function el(e){const t=Lo(Kc).call(Kc,e);-1!==t&&bo(Kc).call(Kc,t,1)}var tl=[],rl=tl.sort,il=s((function(){tl.sort(void 0)})),nl=s((function(){tl.sort(null)})),ol=qr("sort");Q({target:"Array",proto:!0,forced:il||!nl||ol},{sort:function(e){return void 0===e?rl.call(Ae(this)):rl.call(Ae(this),x(e))}});var sl=Ye("Array").sort,al=Array.prototype,cl=function(e){var t=e.sort;return e===al||e instanceof Array&&t===al.sort?sl:t};Q({target:"Array",stat:!0},{isArray:Ee});var ll,ul,dl,hl=M.Array.isArray;!function(e){e.UNEXPECTED_ERROR="UNEXPECTED_ERROR",e.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",e.TIMEOUT="TIMEOUT",e.INVALID_PARAMS="INVALID_PARAMS",e.NOT_READABLE="NOT_READABLE",e.NOT_SUPPORTED="NOT_SUPPORTED",e.INVALID_OPERATION="INVALID_OPERATION",e.OPERATION_ABORTED="OPERATION_ABORTED",e.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",e.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",e.NETWORK_ERROR="NETWORK_ERROR",e.NETWORK_TIMEOUT="NETWORK_TIMEOUT",e.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",e.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",e.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",e.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",e.ELECTRON_IS_NULL="ELECTRON_IS_NULL",e.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",e.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",e.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",e.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",e.PERMISSION_DENIED="PERMISSION_DENIED",e.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",e.TRACK_IS_DISABLED="TRACK_IS_DISABLED",e.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",e.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",e.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",e.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",e.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",e.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",e.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",e.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",e.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",e.UID_CONFLICT="UID_CONFLICT",e.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",e.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",e.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",e.INVALID_TRACK="INVALID_TRACK",e.SENDER_NOT_FOUND="SENDER_NOT_FOUND",e.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",e.SET_ANSWER_FAILED="SET_ANSWER_FAILED",e.ICE_FAILED="ICE_FAILED",e.PC_CLOSED="PC_CLOSED",e.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",e.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",e.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",e.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",e.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",e.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",e.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",e.INVALID_REMOTE_USER="INVALID_REMOTE_USER",e.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",e.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",e.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",e.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",e.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",e.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",e.WS_ABORT="WS_ABORT",e.WS_DISCONNECT="WS_DISCONNECT",e.WS_ERR="WS_ERR",e.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",e.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",e.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",e.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",e.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",e.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",e.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",e.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",e.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",e.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",e.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",e.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",e.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",e.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",e.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",e.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",e.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",e.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",e.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",e.INVALID_PLUGIN="INVALID_PLUGIN",e.DISCONNECT_P2P="DISCONNECT_P2P"}(ll||(ll={}));class pl extends Error{constructor(e,t="",r){var i;super(t),this.name="AgoraRTCException",this.code=e,this.message=Je(i="AgoraRTCError ".concat(this.code,": ")).call(i,t),this.data=r}toString(){var e;return this.data?Je(e="data: ".concat(ve(this.data),"\n")).call(e,this.stack):"".concat(this.stack)}print(e="error"){return"error"===e&&Rc.error(this.toString()),"warning"===e&&Rc.warning(this.toString()),this}throw(){throw this.print(),this}}function fl(e,t){if("boolean"!=typeof e)throw new pl(ll.INVALID_PARAMS,"Invalid ".concat(t,": The value is of the boolean type."))}function gl(e,t,r){var i;if(!is(r).call(r,e))throw new pl(ll.INVALID_PARAMS,Je(i="".concat(t," can only be set as ")).call(i,ve(r)))}function ml(e,t,r=1,i=1e4,n=!0){var o,s;if(e<r||e>i||n&&!function(e){return"number"==typeof e&&e%1==0}(e))throw new pl(ll.INVALID_PARAMS,Je(o=Je(s="invalid ".concat(t,": the value range is [")).call(s,r,", ")).call(o,i,"]. integer only"))}function _l(e,t,r=1,i=255,n=!0){if(null==e)throw new pl(ll.INVALID_PARAMS,"".concat(t||"param"," cannot be empty"));var o,s,a;if(!Sl(e,r,i,n))throw new pl(ll.INVALID_PARAMS,Je(o=Je(s=Je(a="Invalid ".concat(t||"string param",": Length of the string: [")).call(a,r,",")).call(s,i,"].")).call(o,n?" ASCII characters only.":""))}function vl(e,t){if(!hl(e))throw new pl(ll.INVALID_PARAMS,"".concat(t," should be an array"))}function El(e){if("string"!=typeof e||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(e))throw Rc.error("Invalid Channel Name ".concat(e)),new pl(ll.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function Al(e){var t,r;if(r=e,!("number"==typeof r&&Math.floor(r)===r&&0<=r&&r<=4294967295||Sl(e,1,255)))throw Rc.error(Je(t="Invalid UID ".concat(e," ")).call(t,typeof e)),new pl(ll.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");"string"==typeof e&&Rc.warning("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}function yl(e){return null==e}function Sl(e,t=1,r=255,i=!0){return"string"==typeof e&&e.length<=r&&e.length>=t&&(!i||function(e){if("string"!=typeof e)return!1;for(let t=0;t<e.length;t+=1){const r=e.charCodeAt(t);if(r<0||r>255)return!1}return!0}(e))}!function(e){e.FREE="free",e.UPLOADING="uploading"}(ul||(ul={})),function(e){e.NONE="none",e.INIT="init",e.CANPLAY="canplay",e.PLAYING="playing",e.PAUSED="paused",e.SUSPEND="suspend",e.STALLED="stalled",e.WAITING="waiting",e.ERROR="error",e.DESTROYED="destroyed",e.ABORT="abort",e.ENDED="ended",e.EMPTIED="emptied",e.LOADEDDATA="loadeddata"}(dl||(dl={}));const Cl={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};Q({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991});var Tl=9007199254740991;Q({target:"Number",stat:!0},{MIN_SAFE_INTEGER:-9007199254740991});var bl=-9007199254740991;function Il(e){return _l(e.reportId,"params.reportId",0,100,!1),_l(e.category,"params.category",0,100,!1),_l(e.event,"params.event",0,100,!1),_l(e.label,"params.label",0,100,!1),ml(e.value,"params.value",bl,Tl,!1),!0}const Rl={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};var wl,kl,Ol,Nl,Ll,Pl,Dl,Ml,xl,Bl,Ul,Fl,Vl,jl,Gl,Hl,Ql,Wl,ql,zl,Zl;function Yl(e){return ml(e.timeout,"config.timeout",0,1e5),ml(e.timeoutFactor,"config.timeoutFactor",0,100,!1),ml(e.maxRetryCount,"config.maxRetryConfig",0,1/0),ml(e.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}function Kl(e){if(!hl(e)||e.length<1)return!1;try{Jr(e).call(e,e=>{if(!e.urls)throw Error()})}catch(e){return!1}return!0}function $l(e){return _l(e.turnServerURL,"turnServerURL"),_l(e.username,"username"),_l(e.password,"password"),e.udpport&&ml(e.udpport,"udpport",1,99999,!0),e.forceturn&&fl(e.forceturn,"forceturn"),e.security&&fl(e.security,"security"),e.tcpport&&ml(e.tcpport,"tcpport",1,99999,!0),!0}function Jl(e){return void 0!==e.level&&gl(e.level,"level",[1,2,3]),!0}!function(e){e.PUBLISH="publish",e.SUBSCRIBE="subscribe",e.WS_COMPRESSOR_INIT="ws_compressor_init",e.SESSION_INIT="session_init",e.JOIN_CHOOSE_SERVER="join_choose_server",e.REQ_USER_ACCOUNT="req_user_account",e.JOIN_GATEWAY="join_gateway",e.STREAM_SWITCH="stream_switch",e.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",e.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",e.FIRST_VIDEO_RECEIVED="first_video_received",e.FIRST_AUDIO_RECEIVED="first_audio_received",e.FIRST_VIDEO_DECODE="first_video_decode",e.FIRST_AUDIO_DECODE="first_audio_decode",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_UPDATE_STREAM="on_update_stream",e.ON_REMOVE_STREAM="on_remove_stream",e.USER_ANALYTICS="req_user_analytics"}(wl||(wl={})),function(e){e.SESSION="io.agora.pb.Wrtc.Session",e.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",e.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",e.JOIN_GATEWAT="io.agora.pb.Wrtc.JoinGateway",e.PUBLISH="io.agora.pb.Wrtc.Publish",e.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",e.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",e.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",e.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",e.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",e.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",e.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",e.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",e.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",e.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",e.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",e.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",e.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",e.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",e.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",e.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",e.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",e.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",e.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",e.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",e.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",e.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",e.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",e.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed"}(kl||(kl={})),function(e){e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"}(Ol||(Ol={})),function(e){e.CREATE_CLIENT="createClient",e.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",e.SET_AREA="setArea",e.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",e.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",e.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",e.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",e.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",e.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",e.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",e.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",e.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",e.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",e.START_PROXY_SERVER="Client.startProxyServer",e.STOP_PROXY_SERVER="Client.stopProxyServer",e.SET_PROXY_SERVER="Client.setProxyServer",e.SET_TURN_SERVER="Client.setTurnServer",e.SET_CLIENT_ROLE="Client.setClientRole",e.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",e.ENABLE_DUAL_STREAM="Client.enableDualStream",e.DISABLE_DUAL_STREAM="Client.disableDualStream",e.JOIN="Client.join",e.LEAVE="Client.leave",e.PUBLISH="Client.publish",e.UNPUBLISH="Client.unpublish",e.SUBSCRIBE="Client.subscribe",e.UNSUBSCRIBE="Client.unsubscribe",e.RENEW_TOKEN="Client.renewToken",e.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",e.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",e.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",e.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",e.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",e.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",e.START_LIVE_STREAMING="Client.startLiveStreaming",e.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",e.STOP_LIVE_STREAMING="Client.stopLiveStreaming",e.ADD_INJECT_STREAM_URL="Client.addInjectStreamUrl",e.REMOVE_INJECT_STREAM_URL="Client.removeInjectStreamUrl",e.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",e.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",e.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",e.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",e.SET_CONFIG_DISTRIBUTE="_configDistribute",e.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",e.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",e.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",e.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",e.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",e.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",e.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",e.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",e.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",e.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",e.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",e.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",e.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",e.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",e.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",e.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",e.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",e.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",e.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",e.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",e.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",e.STREAM_TYPE_CHANGE="streamTypeChange",e.CONNECTION_STATE_CHANGE="connectionStateChange",e.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage"}(Nl||(Nl={})),function(e){e.TRACER="tracer"}(Ll||(Ll={})),function(e){e.IDLE="IDLE",e.INITING="INITING",e.INITEND="INITEND"}(Pl||(Pl={})),function(e){e.STATE_CHANGE="state_change",e.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",e.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",e.CAMERA_DEVICE_CHANGED="cameraDeviceChanged"}(Dl||(Dl={})),function(e){e[e.ACCESS_POINT=101]="ACCESS_POINT",e[e.UNILBS=201]="UNILBS",e[e.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR"}(Ml||(Ml={})),function(e){e[e.IIIEGAL_APPID=1]="IIIEGAL_APPID",e[e.IIIEGAL_UID=2]="IIIEGAL_UID",e[e.INTERNAL_ERROR=3]="INTERNAL_ERROR"}(xl||(xl={})),function(e){e[e.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",e[e.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",e[e.INTERNAL_ERROR=8]="INTERNAL_ERROR",e[e.NO_AUTHORIZED=9]="NO_AUTHORIZED",e[e.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",e[e.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",e[e.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",e[e.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",e[e.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",e[e.USER_OVERLOAD=16]="USER_OVERLOAD",e[e.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",e[e.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND"}(Bl||(Bl={})),function(e){e[e.NO_FLAG_SET=100]="NO_FLAG_SET",e[e.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",e[e.INVALID_FALG_SET=102]="INVALID_FALG_SET",e[e.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",e[e.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",e[e.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",e[e.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",e[e.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",e[e.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",e[e.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",e[e.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",e[e.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",e[e.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",e[e.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",e[e.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",e[e.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",e[e.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV"}(Ul||(Ul={})),function(e){e[e.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",e[e.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",e[e.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",e[e.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",e[e.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",e[e.K_TICKET_INVALID=7]="K_TICKET_INVALID",e[e.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",e[e.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",e[e.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",e[e.K_UID_BANNED=14]="K_UID_BANNED",e[e.K_IP_BANNED=15]="K_IP_BANNED",e[e.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",e[e.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",e[e.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",e[e.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",e[e.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",e[e.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",e[e.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",e[e.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",e[e.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",e[e.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",e[e.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",e[e.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",e[e.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",e[e.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",e[e.ERR_INVALID_UID=117]="ERR_INVALID_UID",e[e.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",e[e.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",e[e.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",e[e.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",e[e.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",e[e.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",e[e.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",e[e.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",e[e.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",e[e.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",e[e.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",e[e.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",e[e.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",e[e.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",e[e.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",e[e.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",e[e.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",e[e.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",e[e.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",e[e.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",e[e.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",e[e.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",e[e.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",e[e.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",e[e.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",e[e.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",e[e.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",e[e.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",e[e.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY"}(Fl||(Fl={})),function(e){e.CONNECTION_STATE_CHANGE="connection-state-change",e.MEDIA_RECONNECT_START="media-reconnect-start",e.MEDIA_RECONNECT_END="media-reconnect-end",e.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",e.USER_JOINED="user-joined",e.USER_LEAVED="user-left",e.USER_PUBLISHED="user-published",e.USER_UNPUBLISHED="user-unpublished",e.USER_INFO_UPDATED="user-info-updated",e.CLIENT_BANNED="client-banned",e.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",e.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",e.VOLUME_INDICATOR="volume-indicator",e.CRYPT_ERROR="crypt-error",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGED="stream-type-changed",e.STREAM_FALLBACK="stream-fallback",e.RECEIVE_METADATA="receive-metadata",e.STREAM_MESSAGE="stream-message",e.LIVE_STREAMING_ERROR="live-streaming-error",e.LIVE_STREAMING_WARNING="live-streaming-warning",e.INJECT_STREAM_STATUS="stream-inject-status",e.EXCEPTION="exception",e.ERROR="error",e.P2P_LOST="p2p_lost"}(Vl||(Vl={})),function(e){e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.MULTI_IP="MULTI_IP",e.TIMEOUT="TIMEOUT",e.OFFLINE="OFFLINE",e.LEAVE="LEAVE",e.P2P_FAILED="P2P_FAILED"}(jl||(jl={})),function(e){e.CONNECTING="connecting",e.CONNECTED="connected",e.RECONNECTING="reconnecting",e.CLOSED="closed"}(Gl||(Gl={})),function(e){e.WS_CONNECTED="ws_connected",e.WS_RECONNECTING="ws_reconnecting",e.WS_CLOSED="ws_closed",e.ON_BINARY_DATA="on_binary_data",e.REQUEST_RECOVER="request_recover",e.REQUEST_JOIN_INFO="request_join_info",e.REQUEST_REJOIN_INFO="req_rejoin_info",e.IS_P2P_DISCONNECTED="is_p2p_dis",e.DISCONNECT_P2P="dis_p2p",e.NEED_RENEW_SESSION="need-sid",e.REPORT_JOIN_GATEWAY="report_join_gateway",e.REQUEST_TIMEOUT="request_timeout",e.REQUEST_SUCCESS="request_success",e.JOIN_RESPONSE="join_response"}(Hl||(Hl={})),function(e){e.PING="ping",e.PING_BACK="ping_back",e.JOIN="join_v3",e.REJOIN="rejoin_v3",e.LEAVE="leave",e.SET_CLIENT_ROLE="set_client_role",e.PUBLISH="publish",e.UNPUBLISH="unpublish",e.SUBSCRIBE="subscribe",e.UNSUBSCRIBE="unsubscribe",e.SUBSCRIBE_CHANGE="subscribe_change",e.TRAFFIC_STATS="traffic_stats",e.RENEW_TOKEN="renew_token",e.SWITCH_VIDEO_STREAM="switch_video_stream",e.SET_FALLBACK_OPTION="set_fallback_option",e.GATEWAY_INFO="gateway_info",e.CONTROL="control",e.SEND_METADATA="send_metadata",e.DATA_STREAM="data_stream",e.PICK_SVC_LAYER="pick_svc_layer",e.RESTART_ICE="restart_ice",e.CONNECT_PC="connect_pc"}(Ql||(Ql={})),function(e){e.PUBLISH_STATS="publish_stats",e.PUBLISH_RELATED_STATS="publish_related_stats",e.SUBSCRIBE_STATS="subscribe_stats",e.SUBSCRIBE_RELATED_STATS="subscribe_related_stats",e.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length"}(Wl||(Wl={})),function(e){e.ON_USER_ONLINE="on_user_online",e.ON_USER_OFFLINE="on_user_offline",e.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",e.ON_PUBLISH_STREAM="on_publish_stream",e.ON_UPLINK_STATS="on_uplink_stats",e.ON_P2P_LOST="on_p2p_lost",e.ON_REMOVE_STREAM="on_remove_stream",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",e.ON_USER_BANNED="on_user_banned",e.ON_NOTIFICATION="on_notification",e.ON_CRYPT_ERROR="on_crypt_error",e.MUTE_AUDIO="mute_audio",e.MUTE_VIDEO="mute_video",e.UNMUTE_AUDIO="unmute_audio",e.UNMUTE_VIDEO="unmute_video",e.ON_P2P_OK="on_p2p_ok",e.RECEIVE_METADATA="receive_metadata",e.ON_DATA_STREAM="on_data_stream",e.ENABLE_LOCAL_VIDEO="enable_local_video",e.DISABLE_LOCAL_VIDEO="disable_local_video",e.ENABLE_LOCAL_AUDIO="enable_local_audio",e.DISABLE_LOCAL_AUDIO="disable_local_audio"}(ql||(ql={})),function(e){e.CONNECTION_STATE_CHANGE="CONNECTION_STATE_CHANGE",e.NEED_ANSWER="NEED_ANSWER",e.NEED_RENEGOTIATE="NEED_RENEGOTIATE",e.P2P_LOST="P2P_LOST",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NEED_UNPUB="NEED_UNPUB",e.NEED_UNSUB="NEED_UNSUB",e.NEED_UPLOAD="NEED_UPLOAD",e.NEED_CONTROL="NEED_CONTROL",e.START_RECONNECT="START_RECONNECT",e.END_RECONNECT="END_RECONNECT",e.NEED_SIGNAL_RTT="NEED_SIGNAL_RTT"}(zl||(zl={})),function(e){e.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",e.RECEIVE_TRACK_BUFFER="receive_track_buffer",e.ON_AUDIO_BUFFER="on_audio_buffer"}(Zl||(Zl={}));const Xl={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,currentPacketLossRate:0},eu={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},tu={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},ru={uplinkNetworkQuality:0,downlinkNetworkQuality:0},iu={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};var nu,ou;!function(e){e.CONNECTED="websocket:connected",e.RECONNECTING="websocket:reconnecting",e.WILL_RECONNECT="websocket:will_reconnect",e.CLOSED="websocket:closed",e.FAILED="websocket:failed",e.ON_MESSAGE="websocket:on_message",e.REQUEST_NEW_URLS="websocket:request_new_urls"}(nu||(nu={})),function(e){e.TRANSCODE="mix_streaming",e.RAW="raw_streaming",e.INJECT="inject_streaming"}(ou||(ou={}));const su={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},au={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function cu(e,t){_l(e.url,"".concat(t,".url"),1,1e3,!1),yl(e.x)||ml(e.x,"".concat(t,".x"),0,1e4),yl(e.y)||ml(e.y,"".concat(t,".y"),0,1e4),yl(e.width)||ml(e.width,"".concat(t,".width"),0,1e4),yl(e.height)||ml(e.height,"".concat(t,".height"),0,1e4),yl(e.zOrder)||ml(e.zOrder,"".concat(t,".zOrder"),0,255),yl(e.alpha)||ml(e.alpha,"".concat(t,".alpha"),0,1,!1)}const lu={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""},uu={audioBitrate:48,audioChannels:2,audioVolume:100,audioSampleRate:48e3,height:0,width:0,videoBitrate:400,videoFramerate:15,videoGop:30};var du,hu,pu,fu,gu,mu,_u,vu,Eu,Au,yu;function Su(e){if(!e.channelName)throw new pl(ll.INVALID_PARAMS,"invalid channelName in info");if(!e.uid||"number"!=typeof e.uid)throw new pl(ll.INVALID_PARAMS,"invalid uid in info, uid must be a number");return e.token&&_l(e.token,"info.token",1,2047),Al(e.uid),El(e.channelName),!0}function Cu(e){return gl(e,"mediaSource",["screen","window","application"]),!0}!function(e){e.WARNING="@live_uap-warning",e.ERROR="@line_uap-error",e.PUBLISH_STREAM_STATUS="@live_uap-publish-status",e.INJECT_STREAM_STATUS="@live_uap-inject-status",e.WORKER_STATUS="@live_uap-worker-status",e.REQUEST_NEW_ADDRESS="@live_uap-request-address"}(du||(du={})),function(e){e.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager"}(hu||(hu={})),function(e){e[e.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",e[e.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",e[e.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",e[e.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",e[e.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",e[e.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",e[e.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",e[e.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",e[e.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",e[e.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",e[e.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",e[e.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",e[e.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",e[e.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",e[e.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",e[e.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN"}(pu||(pu={})),function(e){e.CONNECT_FAILED="connect failed",e.CONNECT_TIMEOUT="connect timeout",e.WS_DISCONNECTED="websocket disconnected",e.REQUEST_TIMEOUT="request timeout",e.REQUEST_FAILED="request failed",e.WAIT_STATUS_TIMEOUT="wait status timeout",e.WAIT_STATUS_ERROR="wait status error",e.BAD_STATE="bad state",e.WS_ABORT="ws abort",e.AP_REQUEST_TIMEOUT="AP request timeout",e.AP_JSON_PARSE_ERROR="AP json parse error",e.AP_REQUEST_ERROR="AP request error",e.AP_REQUEST_ABORT="AP request abort"}(fu||(fu={})),function(e){e[e.SetSdkProfile=0]="SetSdkProfile",e[e.SetSourceChannel=1]="SetSourceChannel",e[e.SetSourceUserId=2]="SetSourceUserId",e[e.SetDestChannel=3]="SetDestChannel",e[e.StartPacketTransfer=4]="StartPacketTransfer",e[e.StopPacketTransfer=5]="StopPacketTransfer",e[e.UpdateDestChannel=6]="UpdateDestChannel",e[e.Reconnect=7]="Reconnect",e[e.SetVideoProfile=8]="SetVideoProfile"}(gu||(gu={})),function(e){e.High="high",e.Low="low",e.Audio="audio",e.Screen="screen",e.ScreenLow="screen_low"}(mu||(mu={})),function(e){e.DISCONNECT="disconnect",e.CONNECTION_STATE_CHANGE="connection-state-change",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGE="stream-type-change",e.IS_P2P_DISCONNECTED="is-p2p-dis",e.DISCONNECT_P2P="dis-p2p",e.REQUEST_NEW_GATEWAY_LIST="req-gate-url",e.NEED_RENEW_SESSION="need-sid",e.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",e.JOIN_RESPONSE="join-response"}(_u||(_u={})),function(e){e.NEED_RENEGOTIATE="@need_renegotiate",e.NEED_REPLACE_TRACK="@need_replace_track",e.NEED_CLOSE="@need_close",e.NEED_ENABLE_TRACK="@need_enable_track",e.NEED_DISABLE_TRACK="@need_disable_track",e.NEED_SESSION_ID="@need_sid",e.SET_OPTIMIZATION_MODE="@set_optimization_mode",e.GET_STATS="@get_stats",e.GET_LOW_VIDEO_TRACK="@get_low_video_track",e.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",e.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",e.NEED_MUTE_TRACK="@need_mute_track",e.NEED_UNMUTE_TRACK="@need_unmute_track"}(vu||(vu={})),function(e){e.SCREEN_TRACK="screen_track",e.LOW_STREAM="low_stream"}(Eu||(Eu={})),function(e){e.SOURCE_STATE_CHANGE="source-state-change",e.TRACK_ENDED="track-ended",e.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status"}(Au||(Au={})),function(e){e.FIRST_FRAME_DECODED="first-frame-decoded",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status"}(yu||(yu={}));const Tu=["AFRICA","ASIA","CHINA","EUROPE","GLOBAL","INDIA","JAPAN","NORTH_AMERICA","OCEANIA","OVERSEA","SOUTH_AMERICA","KOREA"];var bu;!function(e){e.CHINA="CN",e.ASIA="AS",e.NORTH_AMERICA="NA",e.EUROPE="EU",e.JAPAN="JP",e.INDIA="IN",e.KOREA="KR",e.OCEANIA="OC",e.SOUTH_AMERICA="SA",e.AFRICA="AF",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL"}(bu||(bu={}));const Iu={CHINA:{},ASIA:{CODE:bu.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:bu.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:bu.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:bu.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","\tuap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:bu.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:bu.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:bu.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:bu.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:bu.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:bu.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:bu.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]}};var Ru,wu,ku,Ou,Nu,Lu,Pu,Du;Oc&&(Iu.CHINA={CODE:bu.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]}),function(e){e.UPDATE_BITRATE_LIMIT="update_bitrate_limit"}(Ru||(Ru={}));class Mu{constructor(){this._events={},this.addListener=this.on}getListeners(e){var t;return this._events[e]?vo(t=this._events[e]).call(t,e=>e.listener):[]}on(e,t){this._events[e]||(this._events[e]=[]);const r=this._events[e];-1===this._indexOfListener(r,t)&&r.push({listener:t,once:!1})}once(e,t){this._events[e]||(this._events[e]=[]);const r=this._events[e];-1===this._indexOfListener(r,t)&&r.push({listener:t,once:!0})}off(e,t){if(!this._events[e])return;const r=this._events[e],i=this._indexOfListener(r,t);-1!==i&&bo(r).call(r,i,1),0===this._events[e].length&&delete this._events[e]}removeAllListeners(e){e?delete this._events[e]:this._events={}}emit(e,...t){var r;this._events[e]||(this._events[e]=[]);const i=vo(r=this._events[e]).call(r,e=>e);for(let n=0;n<i.length;n+=1){const r=i[n];r.once&&this.off(e,r.listener),r.listener.apply(this,t||[])}}_indexOfListener(e,t){let r=e.length;for(;r--;)if(e[r].listener===t)return r;return-1}}class xu extends Mu{constructor(e,t){super()}}!function(e){e.SEND="sendonly",e.RECV="recvonly",e.SENDRECV="sendrecv",e.INACTIVE="inactive"}(wu||(wu={})),function(e){e.VIDEO="video",e.AUDIO="audio"}(ku||(ku={})),function(e){e.LocalVideoTrack="videoTrack",e.LocalAudioTrack="audioTrack",e.LocalVideoLowTrack="videoLowTrack"}(Ou||(Ou={})),function(e){e.New="new",e.Connected="connected",e.Reconnecting="reconnecting",e.Disconnected="disconnected"}(Nu||(Nu={})),function(e){e.StateChange="stateChange",e.IceConnectionStateChange="iceConnectionStateChange",e.RequestMuteLocal="requestMuteLocal",e.RequestUnmuteLocal="requestUnmuteLocal",e.RequestRePublish="requestRePublish",e.RequestReSubscribe="requestReSubscribe",e.RequestUploadStats="requestUploadStats",e.MediaReconnectStart="MediaReconnectStart",e.MediaReconnectEnd="MediaReconnectEnd",e.NeedSignalRTT="NeedSignalRTT",e.RequestRestartICE="RequestRestartIce",e.PeerConnectionStateChange="PeerConnectionStateChange",e.RequestReconnect="RequestReconnect",e.RequestReconnectPC="RequestReconnectPC",e.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",e.P2PLost="P2PLost"}(Lu||(Lu={})),function(e){e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(Pu||(Pu={})),function(e){e.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(Du||(Du={}));const Bu={join:["startJoin","startRequestAp","startJoinGateway","finishJoin"],publish:["startPublish"]},Uu={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1};function Fu(){return Uu}var Vu=ne.concat("length","prototype"),ju={f:Object.getOwnPropertyNames||function(e){return ie(e,Vu)}},Gu=le("Reflect","ownKeys")||function(e){var t=ju.f(U(e)),r=Xr.f;return r?t.concat(r(e)):t};Q({target:"Object",stat:!0,sham:!a},{getOwnPropertyDescriptors:function(e){for(var t,r,i=_(e),n=R.f,o=Gu(i),s={},a=0;o.length>a;)void 0!==(r=n(i,t=o[a++]))&&ye(s,t,r);return s}});var Hu=M.Object.getOwnPropertyDescriptors,Qu=ju.f,Wu={}.toString,qu="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],zu={f:function(e){return qu&&"[object Window]"==Wu.call(e)?function(e){try{return Qu(e)}catch(e){return qu.slice()}}(e):Qu(_(e))}},Zu={f:Pe},Yu=V.f,Ku=function(e){var t=M.Symbol||(M.Symbol={});y(t,e)||Yu(t,e,{value:Zu.f(e)})},$u=Tt.forEach,Ju=kt("hidden"),Xu="Symbol",ed=Pe("toPrimitive"),td=xt.set,rd=xt.getterFor(Xu),id=Object.prototype,nd=o.Symbol,od=le("JSON","stringify"),sd=R.f,ad=V.f,cd=zu.f,ld=u.f,ud=Te("symbols"),dd=Te("op-symbols"),hd=Te("string-to-symbol-registry"),pd=Te("symbol-to-string-registry"),fd=Te("wks"),gd=o.QObject,md=!gd||!gd.prototype||!gd.prototype.findChild,_d=a&&s((function(){return 7!=qt(ad({},"a",{get:function(){return ad(this,"a",{value:7}).a}})).a}))?function(e,t,r){var i=sd(id,t);i&&delete id[t],ad(e,t,r),i&&e!==id&&ad(id,t,i)}:ad,vd=function(e,t){var r=ud[e]=qt(nd.prototype);return td(r,{type:Xu,tag:e,description:t}),a||(r.description=t),r},Ed=we&&"symbol"==typeof nd.iterator?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof nd},Ad=function(e,t,r){e===id&&Ad(dd,t,r),U(e);var i=E(t,!0);return U(r),y(ud,i)?(r.enumerable?(y(e,Ju)&&e[Ju][i]&&(e[Ju][i]=!1),r=qt(r,{enumerable:d(0,!1)})):(y(e,Ju)||ad(e,Ju,d(1,{})),e[Ju][i]=!0),_d(e,i,r)):ad(e,i,r)},yd=function(e,t){U(e);var r=_(t),i=oe(r).concat(bd(r));return $u(i,(function(t){a&&!Sd.call(r,t)||Ad(e,t,r[t])})),e},Sd=function(e){var t=E(e,!0),r=ld.call(this,t);return!(this===id&&y(ud,t)&&!y(dd,t))&&(!(r||!y(this,t)||!y(ud,t)||y(this,Ju)&&this[Ju][t])||r)},Cd=function(e,t){var r=_(e),i=E(t,!0);if(r!==id||!y(ud,i)||y(dd,i)){var n=sd(r,i);return!n||!y(ud,i)||y(r,Ju)&&r[Ju][i]||(n.enumerable=!0),n}},Td=function(e){var t=cd(_(e)),r=[];return $u(t,(function(e){y(ud,e)||y(te,e)||r.push(e)})),r},bd=function(e){var t=e===id,r=cd(t?dd:_(e)),i=[];return $u(r,(function(e){!y(ud,e)||t&&!y(id,e)||i.push(ud[e])})),i};if(we||(Kt((nd=function(){if(this instanceof nd)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=Re(e),r=function(e){this===id&&r.call(dd,e),y(this,Ju)&&y(this[Ju],t)&&(this[Ju][t]=!1),_d(this,t,d(1,e))};return a&&md&&_d(id,t,{configurable:!0,set:r}),vd(t,e)}).prototype,"toString",(function(){return rd(this).tag})),u.f=Sd,V.f=Ad,R.f=Cd,ju.f=zu.f=Td,Xr.f=bd,a&&ad(nd.prototype,"description",{configurable:!0,get:function(){return rd(this).description}})),ke||(Zu.f=function(e){return vd(Pe(e),e)}),Q({global:!0,wrap:!0,forced:!we,sham:!we},{Symbol:nd}),$u(oe(fd),(function(e){Ku(e)})),Q({target:Xu,stat:!0,forced:!we},{for:function(e){var t=String(e);if(y(hd,t))return hd[t];var r=nd(t);return hd[t]=r,pd[r]=t,r},keyFor:function(e){if(!Ed(e))throw TypeError(e+" is not a symbol");if(y(pd,e))return pd[e]},useSetter:function(){md=!0},useSimple:function(){md=!1}}),Q({target:"Object",stat:!0,forced:!we,sham:!a},{create:function(e,t){return void 0===t?qt(e):yd(qt(e),t)},defineProperty:Ad,defineProperties:yd,getOwnPropertyDescriptor:Cd}),Q({target:"Object",stat:!0,forced:!we},{getOwnPropertyNames:Td,getOwnPropertySymbols:bd}),Q({target:"Object",stat:!0,forced:s((function(){Xr.f(1)}))},{getOwnPropertySymbols:function(e){return Xr.f(Ae(e))}}),od){var Id=!we||s((function(){var e=nd();return"[null]"!=od([e])||"{}"!=od({a:e})||"{}"!=od(Object(e))}));Q({target:"JSON",stat:!0,forced:Id},{stringify:function(e,t,r){for(var i,n=[e],o=1;arguments.length>o;)n.push(arguments[o++]);if(i=t,(v(t)||void 0!==e)&&!Ed(e))return Ee(t)||(t=function(e,t){if("function"==typeof i&&(t=i.call(this,e,t)),!Ed(t))return t}),n[1]=t,od.apply(null,n)}})}nd.prototype[ed]||j(nd.prototype,ed,nd.prototype.valueOf),yt(nd,Xu),te[Ju]=!0;var Rd,wd=M.Object.getOwnPropertySymbols,kd=ui,Od=function(e,t,r){return t in e?kd(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e};!function(e){e[e.CHOOSE_SERVER=11]="CHOOSE_SERVER",e[e.CLOUD_PROXY=18]="CLOUD_PROXY",e[e.CLOUD_PROXY_5=20]="CLOUD_PROXY_5"}(Rd||(Rd={}));var Nd=Ye("Array").entries,Ld=Array.prototype,Pd={DOMTokenList:!0,NodeList:!0},Dd=function(e){var t=e.entries;return e===Ld||e instanceof Array&&t===Ld.entries||Pd.hasOwnProperty(ht(e))?Nd:t},Md=function(e){var t,r,i,n,o,s=Ae(e),a="function"==typeof this?this:Array,c=arguments.length,l=c>1?arguments[1]:void 0,u=void 0!==l,d=0,h=ft(s);if(u&&(l=B(l,c>2?arguments[2]:void 0,2)),null==h||a==Array&&nt(h))for(r=new a(t=Y(s.length));t>d;d++)ye(r,d,u?l(s[d],d):s[d]);else for(o=(n=h.call(s)).next,r=new a;!(i=o.call(n)).done;d++)ye(r,d,u?gt(n,l,[i.value,d],!0):i.value);return r.length=d,r},xd=!Ki((function(e){Array.from(e)}));Q({target:"Array",stat:!0,forced:xd},{from:Md});var Bd=M.Array.from,Ud=Ye("Array").keys,Fd=Array.prototype,Vd={DOMTokenList:!0,NodeList:!0},jd=function(e){var t=e.keys;return e===Fd||e instanceof Array&&t===Fd.keys||Vd.hasOwnProperty(ht(e))?Ud:t};function Gd(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}let Hd=0,Qd=0;function Wd(e,t,r){return new fo((i,n)=>{t.timeout=t.timeout||jc("HTTP_CONNECT_TIMEOUT"),t.responseType=t.responseType||"json",t.data&&!r?(t.data=ve(t.data),Hd+=Tp(t.data)):r&&(t.data.size?Hd+=t.data.size:t.data instanceof FormData?Hd+=function(e){let t=0;return/DingTalk/i.test(navigator.userAgent)&&e.realFormData&&(e=e.realFormData),Jr(e).call(e,e=>{t+="string"==typeof e?Tp(e):e.size}),t+138}(t.data):Hd+=Tp(ve(t.data))),t.headers=t.headers||{},t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.method="POST",t.url=e,Sc.request(t).then(e=>{"string"==typeof e.data?Qd+=Tp(e.data):e.data instanceof ArrayBuffer||e.data instanceof Uint8Array?Qd+=e.data.byteLength:Qd+=Tp(ve(e.data)),i(e.data)}).catch(e=>{Sc.isCancel(e)?n(new pl(ll.OPERATION_ABORTED,"cancel token canceled")):"ECONNABORTED"===e.code?n(new pl(ll.NETWORK_TIMEOUT,e.message)):e.response?n(new pl(ll.NETWORK_RESPONSE_ERROR,e.response.status)):n(new pl(ll.NETWORK_ERROR,e.message))})})}async function qd(e,t){const r=new Blob([t.data],{type:"buffer"});return await Wd(e,function(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=Gd(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=Gd(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}({},t,{data:r,headers:{"Content-Type":"application/octet-stream"}}),!0)}const zd=new class extends Mu{constructor(){super(),this._moduleName="network-indicator",this._networkState=Pu.ONLINE,window.addEventListener("online",()=>{this.networkState=Pu.ONLINE}),window.addEventListener("offline",()=>{this.networkState=Pu.OFFLINE})}set networkState(e){Rc.info("[".concat(this._moduleName,"]")+"network state changed, "+this._networkState+" -> "+e),this.emit(Du.NETWORK_STATE_CHANGE,e,this._networkState),e===Pu.ONLINE?this.emit(Du.ONLINE):e===Pu.OFFLINE&&(this.onlineWaiter=new fo(e=>{this.once(Du.ONLINE,()=>{this.onlineWaiter=void 0,e(Pu.ONLINE)})}),this.emit(Du.OFFLINE)),this._networkState=e}get networkState(){return this._networkState}},Zd={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function Yd(e,t){const r=t.timeout*Math.pow(t.timeoutFactor,e);return Math.min(t.maxRetryTimeout,r)}function Kd(e,t,r,i){const n=ri({},Zd,i);let o=n.timeout;const s=async()=>{await Ip(o),o*=n.timeoutFactor,o=Math.min(n.maxRetryTimeout,o)};let a=!1;const c=new fo(async(i,o)=>{t=t||(()=>!1),r=r||(()=>!0);for(let c=0;c<n.maxRetryCount;c+=1){if(a)return o(new pl(ll.OPERATION_ABORTED));try{const r=await e();if(!t(r,c))return i(r);if(c+1===n.maxRetryCount)return i(r);await s()}catch(e){if(!r(e,c))return o(e);if(c+1===n.maxRetryCount)return o(e);await s()}}});return c.cancel=()=>a=!0,c}let $d=!1;const Jd=new class extends Mu{};function Xd(){const e=ma();if(!$d){const t=r=>{r.preventDefault(),$d=!1,"Android"!==e.os||"Chrome"!==e.name&&e.name!==ha.WECHAT?(document.body.removeEventListener("touchstart",t,!0),document.body.removeEventListener("mousedown",t,!0)):document.body.removeEventListener("click",t,!0)};$d=!0,"Android"!==e.os||"Chrome"!==e.name&&e.name!==ha.WECHAT?(document.body.addEventListener("touchstart",t,!0),document.body.addEventListener("mousedown",t,!0)):document.body.addEventListener("click",t,!0),Rc.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),Jd.onAutoplayFailed?Jd.onAutoplayFailed():Jd.onAudioAutoplayFailed?Rc.warning("AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.\n\n  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web ."):Rc.warning("We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.\n\n  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.\n\n  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web ."),Jd.emit("autoplay-failed")}}function eh(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function th(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=eh(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=eh(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}function rh(e={report:nh}){return function(t,r,i){const n=t[r];if("function"==typeof n){const o="AgoraRTCClient"===t.constructor.name?"Client":t.constructor.name;i.value=function(...t){var i;const s=e.report.reportApiInvoke(this._sessionId||null,{name:Je(i="".concat(o,".")).call(i,r),options:t,tag:Ll.TRACER});try{const e=n.apply(this,t);return s.onSuccess(),e}catch(e){throw s.onError(e),e}}}return i}}function ih(e={report:nh}){return function(t,r,i){const n=t[r];if("function"==typeof n){const o="AgoraRTCClient"===t.constructor.name?"Client":t.constructor.name;i.value=async function(...t){var i;const s=e.report.reportApiInvoke(this._sessionId||null,{name:Je(i="".concat(o,".")).call(i,r),options:t,tag:Ll.TRACER});try{const e=await n.apply(this,t);return s.onSuccess(),e}catch(e){throw s.onError(e),e}}}return i}}const nh=new class{constructor(){var e,t;this.baseInfoMap=new Mr,this.clientList=Yc,this.keyEventUploadPendingItems=[],this.normalEventUploadPendingItems=[],this.apiInvokeUploadPendingItems=[],this.apiInvokeCount=0,this.ltsList=[],this.lastSendNormalEventTime=Ma(),this.customReportCount=0,this.eventUploadTimer=window.setInterval($o(e=this.doSend).call(e,this),jc("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval($o(t=this.appendSessionId).call(t,this),jc("EVENT_REPORT_SEND_INTERVAL"))}reportApiInvoke(e,t,r){t.timeout=t.timeout||6e4,t.reportResult=void 0===t.reportResult||t.reportResult;const i=Ma();this.apiInvokeCount+=1;const n=this.apiInvokeCount,o=()=>({tag:t.tag,invokeId:n,sid:e,name:t.name,apiInvokeTime:i,options:t.options,states:t.states||null}),s=!!jc("SHOW_REPORT_INVOKER_LOG");s&&Rc.info("".concat(t.name," start"),t.options);let a=!1;Ip(t.timeout).then(()=>{a||(this.sendApiInvoke(th({},o(),{error:ll.API_INVOKE_TIMEOUT,success:!1})),Rc.debug("".concat(t.name," timeout")))});const c=new pl(ll.UNEXPECTED_ERROR,"".concat(t.name,": this api invoke is end"));return{onSuccess:e=>{const i=()=>{if(a)throw c;return a=!0,this.sendApiInvoke(th({},o(),{success:!0},t.reportResult&&{result:e})),s&&Rc.info("".concat(t.name," onSuccess")),e};return r?zp(i,t.name+"Success",r,()=>a=!0):i()},onError:e=>{const i=()=>{if(a)throw e;a=!0,this.sendApiInvoke(th({},o(),{success:!1,error:e.toString()})),s&&Rc.info("".concat(t.name," onFailure"),e.toString())};return r?zp(i,t.name+"Error",r,()=>a=!0):i()}}}sessionInit(e,t){if(this.baseInfoMap.has(e))return;const r=Ma(),i=this.createBaseInfo(e,r);i.cname=t.cname;const n=ri({},{willUploadConsoleLog:jc("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:Oc?"global":"oversea",areas:jc("AREAS")&&jc("AREAS").join(",")},t.extend),o=Ma(),s=th({},i,{eventType:wl.SESSION_INIT,appid:t.appid,browser:navigator.userAgent,build:wc,lts:o,elapse:o-r,extend:ve(n),mode:t.mode,process:jc("PROCESS_ID"),success:!0,version:kc});this.send({type:kl.SESSION,data:s},!0)}joinChooseServer(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,n=Ma(),o=th({},i,{eventType:wl.JOIN_CHOOSE_SERVER,lts:n,eventElapse:n-t.lts,chooseServerAddr:t.csAddr,errorCode:t.ec,elapse:n-r.startTime,success:t.succ,chooseServerAddrList:ve(t.serverList),uid:t.uid?Si(t.uid):null,cid:t.cid?Si(t.cid):null,chooseServerIp:t.csIp||"",opid:t.opid,unilbsServerIds:t.unilbsServerIds,extend:t.extend||void 0});this.send({type:kl.JOIN_CHOOSE_SERVER,data:o},!0)}reqUserAccount(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,n=Ma(),o=th({},i,{eventType:wl.REQ_USER_ACCOUNT,lts:n,success:t.success,serverAddress:t.serverAddr,stringUid:t.stringUid,uid:t.uid,errorCode:t.errorCode,elapse:n-r.startTime,eventElapse:n-t.lts,extend:ve(t.extend)});this.send({type:kl.REQ_USER_ACCOUNT,data:o},!0)}joinGateway(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info;t.vid&&(i.vid=t.vid),i.uid=t.uid,i.cid=t.cid;const n=Ma(),o=th({},i,{eventType:wl.JOIN_GATEWAY,lts:n,gatewayAddr:t.addr,success:t.succ,errorCode:t.ec,elapse:n-r.startTime,eventElapse:n-t.lts});t.succ&&(r.lastJoinSuccessTime=n),this.send({type:kl.JOIN_GATEWAT,data:o},!0)}joinChannelTimeout(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=Ma(),n=th({},r.info,{lts:i,timeout:t,elapse:i-r.startTime});this.send({type:kl.JOIN_CHANNEL_TIMEOUT,data:n},!0)}publish(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,n=Ma(),o=th({},i,{eventType:wl.PUBLISH,lts:n,eventElapse:t.eventElapse,elapse:n-r.startTime,success:t.succ,errorCode:t.ec,videoName:t.videoName,audioName:t.audioName,screenName:t.screenName,screenshare:t.screenshare,audio:t.audio,video:t.video,p2pid:t.p2pid,publishRequestid:t.publishRequestid});this.send({type:kl.PUBLISH,data:o},!0)}subscribe(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,n=Ma(),o=th({},i,{eventType:wl.SUBSCRIBE,lts:n,eventElapse:t.eventElapse,elapse:n-r.startTime,success:t.succ,errorCode:t.ec,video:t.video,audio:t.audio,subscribeRequestid:t.subscribeRequestid,p2pid:t.p2pid});"string"==typeof t.peerid?o.peerSuid=t.peerid:o.peer=t.peerid,this.send({type:kl.SUBSCRIBE,data:o},!0)}wsCompressorInit(e){var t;const r=[...jd(t=this.baseInfoMap).call(t)],i=r.length?r[0]:"UnableToGetSid",n=this.baseInfoMap.get(i);if(!n)return;const o=n.info,s=Ma(),a=th({},o,{eventType:wl.WS_COMPRESSOR_INIT,lts:s,eventElapse:e.eventElapse,elapse:s-n.startTime,status:e.status?1:2});this.send({type:kl.WS_COMPRESSOR_INIT,data:a},!0)}firstRemoteFrame(e,t,r,i){const n=this.baseInfoMap.get(e);if(!n)return;const o=n.info,s=Ma(),a=th({},o,{},i,{elapse:s-n.startTime,eventType:t,lts:s});this.send({type:r,data:a},!0)}onGatewayStream(e,t,r,i){const n=this.baseInfoMap.get(e);if(!n)return;const o=th({},n.info,{},i,{eventType:t,lts:Ma()});this.send({type:r,data:o},!0)}streamSwitch(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,n=Ma(),o=th({},i,{eventType:wl.STREAM_SWITCH,lts:n,isDual:t.isdual,elapse:n-r.startTime,success:t.succ});this.send({type:kl.STREAM_SWITCH,data:o},!0)}requestProxyAppCenter(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,n=Ma(),o=th({},i,{eventType:wl.REQUEST_PROXY_APPCENTER,lts:n,eventElapse:n-t.lts,elapse:n-r.startTime,APAddr:t.APAddr,workerManagerList:t.workerManagerList,response:t.response,errorCode:t.ec,success:t.succ});this.send({type:kl.REQUEST_PROXY_APPCENTER,data:o},!0)}requestProxyWorkerManager(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,n=Ma(),o=th({},i,{eventType:wl.REQUEST_PROXY_WORKER_MANAGER,lts:n,eventElapse:n-t.lts,elapse:n-r.startTime,workerManagerAddr:t.workerManagerAddr,response:t.response,errorCode:t.ec,success:t.succ});this.send({type:kl.REQUEST_PROXY_WORKER_MANAGER,data:o},!0)}setProxyServer(e){this.proxyServer=e,e?Rc.debug("reportProxyServerurl: ".concat(e)):Rc.debug("disable reportProxyServerurl: ".concat(e))}peerPublishStatus(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,n=Ma(),o=th({},i,{subscribeElapse:t.subscribeElapse,peer:t.peer,peerPublishDuration:Math.max(t.audioPublishDuration,t.videoPublishDuration),audiotag:t.audioPublishDuration>0?1:-1,videotag:t.videoPublishDuration>0?1:-1,lts:n,elapse:n-r.startTime,joinChannelSuccessElapse:n-(r.lastJoinSuccessTime||n)});this.send({type:kl.PEER_PUBLISH_STATUS,data:o},!0)}workerEvent(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,n=Ma(),o=bp(th({},i,{},t,{elapse:n-r.startTime,lts:n,productType:"WebRTC"}),"payload",1300);Jr(o).call(o,e=>this.send({type:kl.WORKER_EVENT,data:e},!0))}apworkerEvent(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,n=Ma(),o=th({},i,{},t,{elapse:n-r.startTime,lts:n});this.send({type:kl.AP_WORKER_EVENT,data:o},!0)}joinWebProxyAP(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,n=Ma(),o=th({},i,{},t,{elapse:n-r.startTime,lts:n,extend:t.extend||void 0});this.send({type:kl.JOIN_WEB_PROXY_AP,data:o},!0)}WebSocketQuit(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,n=Ma(),o=th({},i,{},t,{elapse:n-r.startTime,lts:n});this.send({type:kl.WEBSOCKET_QUIT,data:o},!0)}async sendCustomReportMessage(e,t){if(this.customReportCount+=t.length,this.customReportCount>jc("CUSTOM_REPORT_LIMIT"))throw new pl(ll.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval(()=>{this.customReportCount=0},5e3));const r=vo(t).call(t,t=>({type:kl.USER_ANALYTICS,data:th({sid:e},t)})),i={msgType:"EventMessages",sentTs:Math.round(Ma()/1e3),payloads:vo(r).call(r,e=>ve(e))};try{await this.postDataToStatsCollector(i)}catch(e){throw Rc.error("send custom report message failed",e.toString()),new pl(ll.CUSTOM_REPORT_SEND_FAILED,e.message)}}autoplayFailed(e,t,r,i){if(!e)return;const n=this.baseInfoMap.get(e);if(!n)return;const o=n.info,s=Ma(),a=th({},o,{vid:void 0===o.vid?0:Number(o.vid),lts:s,elapse:s-n.startTime,cbRegistered:Jd.onAutoplayFailed||Jd.onAudioAutoplayFailed?1:-1,errorMsg:r,mediaType:t,trackId:i,extend:void 0});this.send({type:kl.AUTOPLAY_FAILED,data:a},!0)}sendApiInvoke(e){const t=jc("NOT_REPORT_EVENT");if(e.tag&&is(t)&&is(t).call(t,e.tag))return!1;if(null===e.sid)return this.apiInvokeUploadPendingItems.push(e),!1;const r=this.baseInfoMap.get(e.sid);if(!r)return this.apiInvokeUploadPendingItems.push(e),!1;const{cname:i,uid:n,cid:o}=r.info;e.lts=e.lts||Ma();const s={invokeId:e.invokeId,sid:e.sid,cname:i,cid:o,uid:n,lts:e.lts,success:e.success,elapse:e.lts-r.startTime,execElapse:e.lts-e.apiInvokeTime,apiName:e.name,options:e.options?ve(e.options):void 0,execStates:e.states?ve(e.states):void 0,execResult:e.result?ve(e.result):void 0,errorCode:e.error?ve(e.error):void 0};return this.send({type:kl.API_INVOKE,data:s},!1),!0}appendSessionId(){var e;Jr(e=this.clientList).call(e,e=>{if(e._sessionId){const t=this.apiInvokeUploadPendingItems.length;for(let r=0;r<t;r++){const t=this.apiInvokeUploadPendingItems.shift();t&&(t.sid=e._sessionId,this.sendApiInvoke(ri({},t)))}}})}send(e,t){if(t)return this.keyEventUploadPendingItems.push(e),void this.sendItems(this.keyEventUploadPendingItems,!0);var r;this.normalEventUploadPendingItems.push(e),this.normalEventUploadPendingItems.length>jc("NORMAL_EVENT_QUEUE_CAPACITY")&&bo(r=this.normalEventUploadPendingItems).call(r,0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Ma()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(e,t){const r=[],i=[];for(;e.length;){const t=e.shift();r.length<20?r.push(t):i.push(t)}e.push(...i);for(const a of[...r]){var n,o;-1!==Lo(n=this.ltsList).call(n,a.data.lts)?(a.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(a.data.lts)):(this.ltsList.push(a.data.lts),cl(o=this.ltsList).call(o,(e,t)=>e-t))}t||(this.lastSendNormalEventTime=Ma());const s={msgType:"EventMessages",sentTs:Math.round(Ma()/1e3),payloads:vo(r).call(r,e=>ve(e)),vid:(e=>{const t=e&&e.data.sid&&this.baseInfoMap.get(e.data.sid);return t&&t.info.vid&&+t.info.vid||0})(r[0])};return r.length&&this.postDataToStatsCollector(s).catch((e=>r=>{var i,n,o;jc("EVENT_REPORT_RETRY")&&(t?this.keyEventUploadPendingItems=Je(i=this.keyEventUploadPendingItems).call(i,e):(this.normalEventUploadPendingItems=Je(n=this.normalEventUploadPendingItems).call(n,e),this.normalEventUploadPendingItems.length>jc("NORMAL_EVENT_QUEUE_CAPACITY")&&(bo(o=this.normalEventUploadPendingItems).call(o,0,this.normalEventUploadPendingItems.length-jc("NORMAL_EVENT_QUEUE_CAPACITY")),Rc.warning("report: drop normal events"))))})(r)),e}async postDataToStatsCollector(e,t=!1){var r,i,n;zd.networkState===Pu.OFFLINE&&await fo.race([zd.onlineWaiter,Ip(2*Zd.maxRetryTimeout)]);const o=t?"/events/proto-raws":"/events/messages";let s=this.url||(this.proxyServer?Je(r=Je(i="https://".concat(this.proxyServer,"/rs/?h=")).call(i,jc("EVENT_REPORT_DOMAIN"),"&p=6443&d=")).call(r,o):Je(n="https://".concat(jc("EVENT_REPORT_DOMAIN"),":6443")).call(n,o));for(let u=0;u<2;u+=1){var a,c,l;1===u&&(s=this.backupUrl||(this.proxyServer?Je(a=Je(c="https://".concat(this.proxyServer,"/rs/?h=")).call(c,jc("EVENT_REPORT_BACKUP_DOMAIN"),"&p=6443&d=")).call(a,o):Je(l="https://".concat(jc("EVENT_REPORT_BACKUP_DOMAIN"),":6443")).call(l,o)));try{t?await qd(s,{timeout:1e4,data:e}):await Wd(s,{timeout:1e4,data:e})}catch(e){if(1===u)throw e;continue}return}}createBaseInfo(e,t){const r=ri({},Rl);return r.sid=e,this.baseInfoMap.set(e,{info:r,startTime:t}),r}reportResourceTiming(e,t){const r=performance.getEntriesByName(e),i=r[r.length-1];i&&this.reportApiInvoke(t,{name:"Client.resourceTiming",options:i,tag:Ll.TRACER}).onSuccess()}};class oh extends Mu{constructor(e,t){super(),this._hints=[],this._isClosed=!1,this._ID=t||kp(8,"track-"),this._originMediaStreamTrack=e,this._mediaStreamTrack=e,Xc(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(e){if(!e){const e=nh.reportApiInvoke(null,{name:Nl.GET_MEDIA_STREAM_TRACK,options:[],tag:Ll.TRACER});this._mediaStreamTrack&&"string"==typeof this._mediaStreamTrack.label?e.onSuccess(this._mediaStreamTrack.label):e.onSuccess("")}return this._mediaStreamTrack}close(){this._isClosed=!0,el(this)}}let sh=1;class ah{constructor(e){var t;this.lockingPromise=fo.resolve(),this.locks=0,this.name="",this.lockId=sh++,e&&(this.name=e),Rc.debug(Je(t="[lock-".concat(this.name,"-")).call(t,this.lockId,"] is created."))}get isLocked(){return this.locks>0}lock(e){var t,r,i;let n;this.locks+=1,Rc.debug(Je(t=Je(r=Je(i="[lock-".concat(this.name,"-")).call(i,this.lockId,"] is locked, current queue ")).call(r,this.locks,". ")).call(t,"string"==typeof e?e:""));const o=new fo(t=>{n=()=>{var r,i,n;this.locks-=1,Rc.debug(Je(r=Je(i=Je(n="[lock-".concat(this.name,"-")).call(n,this.lockId,"] is not locked, current queue ")).call(i,this.locks,". ")).call(r,"string"==typeof e?e:"")),t()}}),s=this.lockingPromise.then(()=>n);return this.lockingPromise=this.lockingPromise.then(()=>o),s}}function ch(e,t){return function(r,i,n){const o=r[i];if("function"!=typeof o)throw new Error("Cannot use mutex on object property.");return n.value=async function(...r){var n;const s=this[t];var a;if(!s)throw new Error(Je(a="mutex property key ".concat(t," doesn't exist on ")).call(a,e));const c=await s.lock(Je(n="From ".concat(e,".")).call(n,i));try{return await o.apply(this,r)}finally{c()}},n}}class lh extends oh{constructor(e,t){super(e,t),this._enabled=!0,this._muted=!1,this._isClosed=!1,this._trackProcessors=[],this._handleTrackEnded=()=>{this.onTrackEnded()},this._enabledMutex=new ah("".concat(t)),e.addEventListener("ended",this._handleTrackEnded)}get muted(){return this._muted}get enabled(){return this._enabled}getTrackLabel(){return this._originMediaStreamTrack.label}close(){var e;this._isClosed||(this.stop(),Jr(e=this._trackProcessors).call(e,e=>e.destroy()),this._trackProcessors=[],this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,Rc.debug("[".concat(this.getTrackId(),"] close")),this.emit(vu.NEED_CLOSE),super.close())}async _registerTrackProcessor(e){var t;if(-1!==Lo(t=this._trackProcessors).call(t,e))return;const r=this._trackProcessors[this._trackProcessors.length-1];this._trackProcessors.push(e),e.onOutputChange=async()=>{const t=e.output||this._originMediaStreamTrack;this._mediaStreamTrack=t,this._updatePlayerSource(),await Mp(this,vu.NEED_REPLACE_TRACK,this)},r?(r.onOutputChange=async()=>{r.output&&await e.setInput(r.output)},await e.setInput(r.output||r.input||this._originMediaStreamTrack)):await e.setInput(this._originMediaStreamTrack)}_getOutputFromProcessors(){if(0===this._trackProcessors.length)return this._originMediaStreamTrack;const e=this._trackProcessors[this._trackProcessors.length-1];return e.output||e.input||this._originMediaStreamTrack}async _updateOriginMediaStreamTrack(e,t){if(e!==this._originMediaStreamTrack){if(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),t&&this._originMediaStreamTrack.stop(),e.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=e,this._trackProcessors.length>0){await this._trackProcessors[0].setInput(e);const t=this._getOutputFromProcessors();this._mediaStreamTrack=t}else this._mediaStreamTrack=this._originMediaStreamTrack;this._updatePlayerSource(),await Mp(this,vu.NEED_REPLACE_TRACK,this)}}_getDefaultPlayerConfig(){return{}}onTrackEnded(){Rc.debug("[".concat(this.getTrackId(),"] track ended")),this.emit(Au.TRACK_ENDED)}stateCheck(e,t){var r,i,n;if(Rc.debug(Je(r=Je(i=Je(n="check track state, [muted: ".concat(this._muted,", enabled: ")).call(n,this._enabled,"] to [")).call(i,e,": ")).call(r,t,"]")),fl(t,e),this._enabled&&this._muted&&"enabled"===e&&!1===t)throw new pl(ll.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print();if(!this._enabled&&!this._muted&&"muted"===e&&!0===t)throw new pl(ll.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print()}}var uh;!function(e){e.IOS_15_INTERRUPTION_START="ios15-interruption-start",e.IOS_15_INTERRUPTION_END="ios15-interruption-end",e.IOS_INTERRUPTION_START="ios-interruption-start",e.IOS_INTERRUPTION_END="ios-interruption-end",e.STATE_CHANGE="state-change"}(uh||(uh={}));const dh=window.AudioContext||window.webkitAudioContext;let hh=null;const ph=new class extends Mu{constructor(){super(...arguments),this.onLocalAudioTrackMute=()=>{Rc.info("ios15-interruption-start"),this.emit(uh.IOS_15_INTERRUPTION_START)},this.onLocalAudioTrackUnmute=async()=>{Rc.info("ios15-interruption-end"),"running"!==this.curState||this.duringInterruption?Rc.info("ios15-interruption-end-canceled"):(hh&&await hh.suspend(),this.emit(uh.IOS_15_INTERRUPTION_END))}}get duringInterruption(){return"running"===this.prevState&&"interrupted"===this.curState}bindInterruptDetectorTrack(e){Rc.debug("webaudio bindInterruptDetectorTrack ".concat(e.getTrackId())),this.interruptDetectorTrack||(this.interruptDetectorTrack=e,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(e){Rc.debug("webaudio unbindInterruptDetectorTrack ".concat(e.getTrackId())),this.interruptDetectorTrack&&this.interruptDetectorTrack===e&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function fh(){dh?(Rc.info("create audio context"),hh=new dh,ph.curState=hh.state,hh.onstatechange=()=>{var e;ph.prevState=ph.curState,ph.curState=hh?hh.state:void 0,(Ra()||Na())&&"running"===ph.prevState&&"interrupted"===ph.curState&&(Rc.info("ios-interruption-start"),ph.emit(uh.IOS_INTERRUPTION_START)),(Ra()||Na())&&"interrupted"===ph.prevState&&"running"===ph.curState&&(Rc.info("ios-interruption-end"),ph.emit(uh.IOS_INTERRUPTION_END)),ph.prevState!==ph.curState&&(Rc.debug("AudioContext State Change",Je(e="".concat(ph.prevState,"=>")).call(e,ph.curState)),ph.emit(uh.STATE_CHANGE))},async function(e){const t=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let r,i=!1,n=!1,o=!1;function s(t){"running"===e.state?a(!1):Ra()||Na()?"suspended"===e.state&&(a(!0),t&&e.resume().then(l,l)):"closed"!==e.state&&(a(!0),t&&e.resume().then(l,l))}function a(e){if(i!==e){i=e;for(let r=0,i=t;r<i.length;r+=1){const t=i[r];e?window.addEventListener(t,u,{capture:!0,passive:!0}):window.removeEventListener(t,u,{capture:!0,passive:!0})}}}function c(){s(!0)}function l(){s(!1)}function u(){s(!0)}function d(e){if(!o)if(r.paused)if(e){h(!1),o=!0;let t=void 0;try{t=r.play(),t?t.then(p,p):(r.addEventListener("playing",p),r.addEventListener("abort",p),r.addEventListener("error",p))}catch(e){p()}}else h(!0);else h(!1)}function h(e){if(n!==e){n=e;for(let r=0,i=t;r<i.length;r++){const t=i[r];e?window.addEventListener(t,f,{capture:!0,passive:!0}):window.removeEventListener(t,f,{capture:!0,passive:!0})}}}function p(){r.removeEventListener("playing",p),r.removeEventListener("abort",p),r.removeEventListener("error",p),o=!1,d(!1)}function f(){d(!0)}if(Ra()){const t=e.createMediaStreamDestination(),i=document.createElement("div");i.innerHTML="<audio x-webkit-airplay='deny'></audio>",r=i.children.item(0),r.controls=!1,r.disableRemotePlayback=!0,r.preload="auto",r.srcObject=t.stream,d(!0)}ph.on(uh.STATE_CHANGE,c),s(!1)}(hh)):Rc.error("your browser is not support web audio")}function gh(){if(!hh){if(fh(),!hh)throw new pl(ll.NOT_SUPPORTED,"can not create audio context");return hh}return hh}function mh(e){if(function(){if(null!==_h)return _h;const e=gh(),t=e.createBufferSource(),r=e.createGain(),i=e.createGain();t.connect(r),t.connect(i),t.disconnect(r);let n=!1;try{t.disconnect(r)}catch(e){n=!0}return t.disconnect(),_h=n,n}())return;Rc.debug("polyfill audio node");const t=e.connect,r=e.disconnect;e.connect=(r,i,n)=>{var o;return e._inputNodes||(e._inputNodes=[]),is(o=e._inputNodes).call(o,r)||(r instanceof AudioNode?(e._inputNodes.push(r),t.call(e,r,i,n)):t.call(e,r,i)),e},e.disconnect=(i,n,o)=>{r.call(e),i?Up(e._inputNodes,i):e._inputNodes=[];for(const r of e._inputNodes)t.call(e,r)}}let _h=null;function vh(e,t){const r=1/t,i=gh();let n=i.createGain();n.gain.value=0,n.connect(i.destination);let o=!1;const s=()=>{if(o)return void(n=null);const t=i.createOscillator();t.onended=s,t.connect(n),t.start(0),t.stop(i.currentTime+r),e(i.currentTime)};return s(),()=>{o=!0}}class Eh extends Mu{constructor(){super(),this.isPlayed=!1,this.audioOutputLevel=0,this.isDestroyed=!1,this.isNoAudioInput=!1,this._noAudioInputCount=0,this.context=gh(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),mh(this.outputNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.smoothingTimeConstant=.4,this.analyserNode.fftSize=2048}startGetAudioBuffer(e){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(e),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=e=>{this.emit(Zl.ON_AUDIO_BUFFER,function(e){for(let t=0;t<e.outputBuffer.numberOfChannels;t+=1){const r=e.outputBuffer.getChannelData(t);for(let e=0;e<r.length;e+=1)r[e]=0}return e.inputBuffer}(e))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!Fu().webAudioMediaStreamDest)throw new pl(ll.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(e){"running"!==this.context.state&&Vp(()=>{ph.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=e||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch(e){}this.isPlayed=!1}getAccurateVolumeLevel(){if(!this.context||Ra()||Na()||"running"!==this.context.state&&this.context.resume(),!this.analyserNode)return 0;const e=new Uint8Array(this.analyserNode.frequencyBinCount);this.analyserNode.getByteFrequencyData(e);let t=0;for(let r=0;r<e.length;r++)t+=r<64?Math.abs(10*e[r]):Math.abs(6*e[r]/15);return t/e.length/255}async checkHasAudioInput(e=0){if(e>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;if(Ra()||Na()?"suspended"===this.context.state&&this.context.resume():"running"!==this.context.state&&this.context.resume(),!this.analyserNode)return!1;const t=new Uint8Array(this.analyserNode.frequencyBinCount);this.analyserNode.getByteFrequencyData(t);let r=!1;for(let i=0;i<t.length;i++)0!==t[i]&&(r=!0);return r?(this.isNoAudioInput=!1,!0):(await Ip(200),await this.checkHasAudioInput(e?e+1:1)&&r)}getAudioVolume(){return this.outputNode.gain.value}setVolume(e){this.outputNode.gain.setValueAtTime(e,this.context.currentTime)}setMute(e){e?(this.disconnect(),this.audioOutputLevel=0):this.connect()}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}disconnect(){this.sourceNode&&this.sourceNode.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){this.sourceNode&&this.sourceNode.connect(this.outputNode),this.outputNode.connect(this.analyserNode)}}class Ah extends Eh{constructor(e,t){var r;if(super(),this.isCurrentTrackCloned=!1,this.isRemoteTrack=!1,this.rebuildWebAudio=async()=>{if(Rc.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void Rc.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then(()=>Rc.info("resume success")),Rc.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();const e=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?e.stop():this.isCurrentTrackCloned=!0;const t=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(t),mh(this.sourceNode),this.analyserNode=this.context.createAnalyser();const r=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(r,this.context.currentTime),mh(this.outputNode),this.connect(),this.audioElement.srcObject=t,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()},"audio"!==e.kind)throw new pl(ll.UNEXPECTED_ERROR);this.track=e;const i=new MediaStream([this.track]);this.isRemoteTrack=!!t,this.sourceNode=this.context.createMediaStreamSource(i),mh(this.sourceNode),this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=i;const n=ma();t&&n.os===da.IOS&&Number(null===(r=n.osVersion)||void 0===r?void 0:r.split(".")[0])<15&&(ph.on(uh.STATE_CHANGE,()=>{"suspended"===this.context.state?document.body.addEventListener("click",this.rebuildWebAudio,!0):"running"===this.context.state&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(e=>{e||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}get isFreeze(){return!1}updateTrack(e){this.sourceNode.disconnect(),this.track=e,this.isCurrentTrackCloned=!1;const t=new MediaStream([e]);this.sourceNode=this.context.createMediaStreamSource(t),mh(this.sourceNode),this.sourceNode.connect(this.outputNode),this.audioElement.srcObject=t}destroy(){this.audioElement.srcObject=null,this.audioElement.remove(),ph.off("state-change",this.rebuildWebAudio),super.destroy()}}async function yh(e,t){const r=(e,t)=>e?"number"!=typeof e?e.max||e.exact||e.ideal||e.min||t:e:t,i={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxHeight:r(t.height,1080),maxWidth:r(t.width,1920)}}};return t.frameRate&&"number"!=typeof t.frameRate?(i.video.mandatory.maxFrameRate=t.frameRate.max,i.video.mandatory.minFrameRate=t.frameRate.min):"number"==typeof t.frameRate&&(i.video.mandatory.maxFrameRate=t.frameRate),await navigator.mediaDevices.getUserMedia(i)}async function Sh(e){const t=await Ch(e.mediaSource),r=await function(e){return new fo((t,r)=>{const i=document.createElement("div");i.innerText="share screen",i.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const n=document.createElement("div");n.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const o=document.createElement("div");o.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",o.setAttribute("style","height: 12%;");const s=document.createElement("div");s.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const a=document.createElement("div");a.setAttribute("style","text-align: right; padding: 16px 0;");const c=document.createElement("button");c.innerHTML="cancel",c.setAttribute("style","width: 85px;"),c.onclick=()=>{document.body.removeChild(l);const e=new Error("NotAllowedError");e.name="NotAllowedError",r(e)},a.appendChild(c),n.appendChild(o),n.appendChild(s),n.appendChild(a);const l=document.createElement("div");l.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),l.appendChild(i),l.appendChild(n),document.body.appendChild(l),vo(e).call(e,e=>{if(e.id){const r=document.createElement("div");r.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let i=e.thumbnail;const{width:n}=i.getSize();n>1920&&(i=i.resize({width:1920})),r.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+i.toDataURL()+' /></div><span style="\theight: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+e.name.replace(/[\u00A0-\u9999<>\&]/g,(function(e){return"&#"+e.charCodeAt(0)+";"}))+"</span>",r.onclick=()=>{document.body.removeChild(l),t(e.id)},s.appendChild(r)}})})}(t);return await yh(r,e)}async function Ch(e){let t=["window","screen"];"application"!==e&&"window"!==e||(t=["window"]),"screen"===e&&(t=["screen"]);const r=bh();if(!r)throw new pl(ll.ELECTRON_IS_NULL);let i=null;try{i=r.desktopCapturer.getSources({types:t})}catch(e){i=null}i&&i.then||(i=new fo((e,i)=>{r.desktopCapturer.getSources({types:t},(t,r)=>{t?i(t):e(r)})}));try{return await i}catch(e){throw new pl(ll.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,e.toString())}}let Th=null;function bh(){if(Th)return Th;try{return Th=window.require("electron"),Th}catch(e){return null}}const Ih=new ah("safari");let Rh=!1,wh=!1;async function kh(e,t){let r=0,i=null;for(;r<2;)try{i=await Oh(e,t,r>0);break}catch(e){var n,o;if(e instanceof pl)throw Rc.error(Je(o="[".concat(t,"] ")).call(o,e.toString())),e;const i=Nh(e.name||e.code||e,e.message);if(i.code===ll.MEDIA_OPTION_INVALID){Rc.debug("[".concat(t,"] detect media option invalid, retry")),r+=1,await Ip(500);continue}throw Rc.error(Je(n="[".concat(t,"] ")).call(n,i.toString())),i}if(!i)throw new pl(ll.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return i}async function Oh(e,t,r){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new pl(ll.NOT_SUPPORTED,"can not find getUserMedia");r&&(e.video&&(delete e.video.width,delete e.video.height),e.screen&&(delete e.screen.width,delete e.screen.height));const i=Fu(),n=new MediaStream;if(e.audioSource&&n.addTrack(e.audioSource),e.videoSource&&n.addTrack(e.videoSource),!e.audio&&!e.video&&!e.screen)return Rc.debug("Using Video Source/ Audio Source"),n;if(e.screen)if(bh())e.screen.sourceId?Lh(n,await yh(e.screen.sourceId,e.screen)):Lh(n,await Sh(e.screen));else if(Ta()&&e.screen.extensionId&&e.screen.mandatory){if(!i.getStreamFromExtension)throw new pl(ll.NOT_SUPPORTED,"This browser does not support screen sharing");Rc.debug("[".concat(t,'] Screen access on chrome stable, looking for extension"'));const r=await(s=e.screen.extensionId,a=t,new fo((e,t)=>{try{chrome.runtime.sendMessage(s,{getStream:!0},r=>{if(!r||!r.streamId)return Rc.error("[".concat(a,"] No response from Chrome Plugin. Plugin not installed properly"),r),void t(new pl(ll.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));e(r.streamId)})}catch(e){var r;Rc.error(Je(r="[".concat(a,"] AgoraRTC screensharing plugin is not accessible(")).call(r,s,")"),e.toString()),t(new pl(ll.CHROME_PLUGIN_NOT_INSTALL))}}));e.screen.mandatory.chromeMediaSourceId=r,Lh(n,await navigator.mediaDevices.getUserMedia({video:{mandatory:e.screen.mandatory}}))}else if(i.getDisplayMedia){e.screen.mediaSource&&Cu(e.screen.mediaSource);const r={width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate,displaySurface:"screen"===e.screen.mediaSource?"monitor":e.screen.mediaSource};Rc.debug("[".concat(t,"] getDisplayMedia:"),ve({video:r,audio:!!e.screenAudio})),Lh(n,await navigator.mediaDevices.getDisplayMedia({video:r,audio:!!e.screenAudio}))}else{if(!Ia())throw Rc.error("[".concat(t,"] This browser does not support screenSharing")),new pl(ll.NOT_SUPPORTED,"This browser does not support screen sharing");{var o;e.screen.mediaSource&&Cu(e.screen.mediaSource);const r={video:{mediaSource:e.screen.mediaSource,width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate}};Rc.debug(Je(o="[".concat(t,"] getUserMedia: ")).call(o,ve(r))),Lh(n,await navigator.mediaDevices.getUserMedia(r))}}var s,a;if(!e.video&&!e.audio)return n;const c={video:e.video,audio:e.audio};Rc.debug("[".concat(t,"] GetUserMedia"),ve(c)),ma();let l,u=null;(ba()||Ra()||ya())&&(u=await Ih.lock());try{l=await navigator.mediaDevices.getUserMedia(c)}catch(e){throw u&&u(),e}return c.audio&&(Rh=!0),c.video&&(wh=!0),Lh(n,l),u&&u(),n}function Nh(e,t){switch(e){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":var r;return new pl(ll.MEDIA_OPTION_INVALID,Je(r="".concat(e,": ")).call(r,t));case"NotFoundError":case"DevicesNotFoundError":var i;return new pl(ll.DEVICE_NOT_FOUND,Je(i="".concat(e,": ")).call(i,t));case"NotSupportedError":var n;return new pl(ll.NOT_SUPPORTED,Je(n="".concat(e,": ")).call(n,t));case"NotReadableError":var o;return new pl(ll.NOT_READABLE,Je(o="".concat(e,": ")).call(o,t));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":var s;return new pl(ll.PERMISSION_DENIED,Je(s="".concat(e,": ")).call(s,t));case"ConstraintNotSatisfiedError":var a;return new pl(ll.CONSTRAINT_NOT_SATISFIED,Je(a="".concat(e,": ")).call(a,t));default:var c;return Rc.error("getUserMedia unexpected error",e),new pl(ll.UNEXPECTED_ERROR,Je(c="".concat(e,": ")).call(c,t))}}function Lh(e,t){const r=e.getVideoTracks()[0],i=e.getAudioTracks()[0],n=t.getVideoTracks()[0],o=t.getAudioTracks()[0];o&&(i&&e.removeTrack(i),e.addTrack(o)),n&&(r&&e.removeTrack(r),e.addTrack(n))}const Ph=new class extends Mu{constructor(){super(),this._state=Pl.IDLE,this.isAccessMicrophonePermission=!1,this.isAccessCameraPermission=!1,this.lastAccessMicrophonePermission=!1,this.lastAccessCameraPermission=!1,this.checkdeviceMatched=!1,this.deviceInfoMap=new Mr,this.init().then(()=>{var e;navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",$o(e=this.updateDevicesInfo).call(e,this)),window.setInterval(()=>!La()&&jc("ENUMERATE_DEVICES_INTERVAL")&&this.updateDevicesInfo(),6e4)}).catch(e=>Rc.error(e.toString()))}get state(){return this._state}set state(e){e!==this._state&&(this.emit(Dl.STATE_CHANGE,e),this._state=e)}async enumerateDevices(e,t,r=!1){if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new pl(ll.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const i=await navigator.mediaDevices.enumerateDevices(),n=this.checkMediaDeviceInfoIsOk(i);let o=!this.isAccessMicrophonePermission&&e,s=!this.isAccessCameraPermission&&t;n.audio&&(o=!1),n.video&&(s=!1);let a=null,c=null,l=null;if(!r&&(o||s)){if(Ih.isLocked&&(Rc.debug("[device manager] wait GUM lock"),(await Ih.lock())(),Rc.debug("[device manager] GUM unlock")),Rh&&(o=!1,this.isAccessMicrophonePermission=!0),wh&&(s=!1,this.isAccessCameraPermission=!0),Rc.debug("[device manager] check media device permissions",e,t,o,s),o&&s){try{l=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(e){const t=Nh(e.name||e.code||e,e.message);if(t.code===ll.PERMISSION_DENIED)throw t;Rc.warning("getUserMedia failed in getDevices",t)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(o){try{a=await navigator.mediaDevices.getUserMedia({audio:e})}catch(e){const t=Nh(e.name||e.code||e,e.message);if(t.code===ll.PERMISSION_DENIED)throw t;Rc.warning("getUserMedia failed in getDevices",t)}this.isAccessMicrophonePermission=!0}else if(s){try{c=await navigator.mediaDevices.getUserMedia({video:t})}catch(e){const t=Nh(e.name||e.code||e,e.message);if(t.code===ll.PERMISSION_DENIED)throw t;Rc.warning("getUserMedia failed in getDevices",t)}this.isAccessCameraPermission=!0}Rc.debug("[device manager] mic permission",e,"cam permission",t)}try{var u,d,h;const e=await navigator.mediaDevices.enumerateDevices();return a&&Jr(u=a.getTracks()).call(u,e=>e.stop()),c&&Jr(d=c.getTracks()).call(d,e=>e.stop()),l&&Jr(h=l.getTracks()).call(h,e=>e.stop()),a=null,c=null,l=null,e}catch(e){var p,f,g;return a&&Jr(p=a.getTracks()).call(p,e=>e.stop()),c&&Jr(f=c.getTracks()).call(f,e=>e.stop()),l&&Jr(g=l.getTracks()).call(g,e=>e.stop()),a=null,c=null,l=null,new pl(ll.ENUMERATE_DEVICES_FAILED,e.toString()).throw()}}async getRecordingDevices(e=!1){const t=await this.enumerateDevices(!0,!1,e);return ji(t).call(t,e=>"audioinput"===e.kind)}async getCamerasDevices(e=!1){const t=await this.enumerateDevices(!1,!0,e);return ji(t).call(t,e=>"videoinput"===e.kind)}async getSpeakers(e=!1){const t=await this.enumerateDevices(!0,!1,e);return ji(t).call(t,e=>"audiooutput"===e.kind)}searchDeviceNameById(e){const t=this.deviceInfoMap.get(e);return t?t.device.label||t.device.deviceId:null}searchDeviceIdByName(e){var t;let r=null;return Jr(t=this.deviceInfoMap).call(t,t=>{t.device.label===e&&(r=t.device.deviceId)}),r}async getDeviceById(e){const t=await this.enumerateDevices(!0,!0,!0),r=Qo(t).call(t,t=>t.deviceId===e);if(!r)throw new pl(ll.DEVICE_NOT_FOUND,"deviceId: ".concat(e));return r}async init(){this.state=Pl.INITING;try{await this.updateDevicesInfo(),this.state=Pl.INITEND}catch(e){throw Rc.warning("Device Detection functionality cannot start properly.",e.toString()),this.state=Pl.IDLE,function(){return"boolean"==typeof isSecureContext?isSecureContext:"https:"===location.protocol||"file:"===location.protocol||"localhost"===location.hostname||"127.0.0.1"===location.hostname||"::1"===location.hostname}()||new pl(ll.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),e}}async updateDevicesInfo(){var e;const t=await this.enumerateDevices(!0,!0,!0),r=Ma(),i=[];if(t[0]&&t[0].label&&!1===this.checkdeviceMatched){this.checkdeviceMatched=!0;const e=Qo(t).call(t,e=>"audioinput"===e.kind&&"default"===e.deviceId),r=Qo(t).call(t,e=>"audiooutput"===e.kind&&"default"===e.deviceId);if(e&&r)if(r.groupId===e.groupId){var n;Rc.debug(Je(n="[device-check] default input ".concat(e.label," and output ")).call(n,r.label," is the same group"))}else{var o;Rc.warning(Je(o="[device-check] default input ".concat(e.label," and output ")).call(o,r.label," is not the same group"))}else Rc.debug("[device-check] default input or output not found")}const s=this.checkMediaDeviceInfoIsOk(t);if(Jr(t).call(t,e=>{if(!e.deviceId)return;const t=this.deviceInfoMap.get(e.deviceId);if("ACTIVE"!==(t?t.state:"INACTIVE")){const t={initAt:r,updateAt:r,device:e,state:"ACTIVE"};this.deviceInfoMap.set(e.deviceId,t),i.push(t)}t&&(t.updateAt=r)}),Jr(e=this.deviceInfoMap).call(e,(e,t)=>{"ACTIVE"===e.state&&e.updateAt!==r&&(e.state="INACTIVE",i.push(e))}),this.state!==Pl.INITEND)return s.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(s.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));Jr(i).call(i,e=>{switch(e.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(Dl.RECORDING_DEVICE_CHANGED,e);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(Dl.CAMERA_DEVICE_CHANGED,e);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(Dl.PLAYOUT_DEVICE_CHANGED,e)}}),s.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),s.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(e){const t=ji(e).call(e,e=>"audioinput"===e.kind),r=ji(e).call(e,e=>"videoinput"===e.kind),i={audio:!1,video:!1};for(const n of t)if(n.label&&n.deviceId){i.audio=!0;break}for(const n of r)if(n.label&&n.deviceId){i.video=!0;break}return i}},Dh=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended"],Mh=new class{constructor(){this.elementMap=new Mr,this.elementStateMap=new Mr,this.elementsNeedToResume=[],this.sinkIdMap=new Mr,this.autoResumeAfterInterruption=()=>{var e,t;Jr(e=Bd(Dd(t=this.elementMap).call(t))).call(e,([e,t])=>{const r=this.elementStateMap.get(e),i=t.srcObject.getAudioTracks()[0];wa()?i&&"live"===i.readyState&&"running"===ph.curState&&(Rc.debug("auto resume after interruption for iOS 15"),t.pause(),t.play()):r&&"paused"===r&&i&&"live"===i.readyState&&"running"===ph.curState&&(Rc.debug("auto resume after interruption for iOS"),t.play())})},this.autoResumeAfterInterruptionOnIOS15=()=>{var e,t;Jr(e=Bd(Dd(t=this.elementMap).call(t))).call(e,([e,t])=>{const r=t.srcObject.getAudioTracks()[0];r&&"live"===r.readyState&&(Rc.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),t.pause(),t.play())})},this.autoResumeAudioElement(),ph.on(uh.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),ph.on(uh.IOS_15_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15),ph.on(uh.STATE_CHANGE,()=>{Ra()&&"suspended"===ph.prevState&&"running"===ph.curState&&this.autoResumeAfterInterruption()})}async setSinkID(e,t){const r=this.elementMap.get(e);if(this.sinkIdMap.set(e,t),r)try{await r.setSinkId(t)}catch(e){throw new pl(ll.PERMISSION_DENIED,"can not set sink id: "+e.toString())}}play(e,t,r,i){if(this.elementMap.has(t))return;const n=document.createElement("audio");n.autoplay=!0,n.srcObject=new MediaStream([e]),this.bindAudioElementEvents(t,n),this.elementMap.set(t,n),this.elementStateMap.set(t,dl.INIT),this.setVolume(t,r);const o=this.sinkIdMap.get(t);if(o)try{n.setSinkId(o).catch(e=>{Rc.warning("[".concat(t,"] set sink id failed"),e.toString())})}catch(e){Rc.warning("[".concat(t,"] set sink id failed"),e.toString())}const s=n.play();s&&s.then&&s.catch(e=>{i&&nh.autoplayFailed(i,"audio",e.message,t),Rc.warning("audio element play warning",e.toString()),this.elementMap.has(t)&&"NotAllowedError"===e.name&&(Rc.warning("detected audio element autoplay failed"),this.elementsNeedToResume.push(n),Vp(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),Xd()}))})}updateTrack(e,t){const r=this.elementMap.get(e);r&&(r.srcObject=new MediaStream([t]))}isPlaying(e){return this.elementMap.has(e)}setVolume(e,t){const r=this.elementMap.get(e);r&&(t=Math.max(0,Math.min(100,t)),r.volume=t/100)}stop(e){var t,r;const i=this.elementMap.get(e);if(this.sinkIdMap.delete(e),!i)return;const n=Lo(t=this.elementsNeedToResume).call(t,i);bo(r=this.elementsNeedToResume).call(r,n,1),i.srcObject=null,i.remove(),this.elementMap.delete(e),this.elementStateMap.delete(e)}bindAudioElementEvents(e,t){Jr(Dh).call(Dh,r=>{t.addEventListener(r,t=>{var r,i;const n=this.elementStateMap.get(e),o="pause"===t.type?"paused":t.type;Rc.debug(Je(r=Je(i="[".concat(e,"] audio-element-status change ")).call(i,n," => ")).call(r,o)),this.elementStateMap.set(e,o)})})}getPlayerState(e){return this.elementStateMap.get(e)||"uninit"}autoResumeAudioElement(){const e=()=>{var e;Jr(e=this.elementsNeedToResume).call(e,e=>{e.play().then(e=>{Rc.debug("Auto resume audio element success")}).catch(e=>{Rc.warning("Auto resume audio element failed!",e)})}),this.elementsNeedToResume=[]};new fo(e=>{document.body?e():window.addEventListener("load",()=>e())}).then(()=>{const t=ma();"Android"!==t.os||"Chrome"!==t.name&&t.name!==ha.WECHAT?(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0)):document.body.addEventListener("click",e,!0)})}};function xh(){return function(e,t,r){const i=e[t];"function"==typeof i&&(r.value=function(...e){this._isClosed&&new pl(ll.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning");const t=i.apply(this,e);return t instanceof fo?new fo((e,r)=>{t.then(e).catch(r)}):t})}}function Bh(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function Uh(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=Bh(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=Bh(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}var Fh=function(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Bi(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&di(t,r,s),s},Vh=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class jh extends lh{constructor(e,t,r){super(e,r),this.trackMediaType="audio",this._enabled=!0,this._volume=100,this._useAudioElement=!1,this._bypassWebAudio=!1,this._encoderConfig=t,this._source=new Ah(e)}get isPlaying(){return this._useAudioElement?Mh.isPlaying(this.getTrackId()):this._source.isPlayed}setVolume(e){ml(e,"volume",0,1e3);const t=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.LOCAL_AUDIO_TRACK_SET_VOLUME,options:[this.getTrackId(),e]},300);this._volume=e,this._source.setVolume(e/100),this._useAudioElement&&Mh.setVolume(this.getTrackId(),e);try{if(this._bypassWebAudio)return Rc.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio.")),void t.onSuccess();const e=this._source.createOutputTrack();this._mediaStreamTrack!==e&&(this._mediaStreamTrack=e,Mp(this,vu.NEED_REPLACE_TRACK,this).then(()=>{Rc.debug("[".concat(this.getTrackId(),"] replace web audio track success"))}).catch(e=>{Rc.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),e)}))}catch(e){}t.onSuccess()}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}async setPlaybackDevice(e){const t=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.REMOTE_AUDIO_SET_OUTPUT_DEVICE,options:[this.getTrackId(),e]});if(!this._useAudioElement)throw new pl(ll.NOT_SUPPORTED,"your browser does not support setting the audio output device");try{await Mh.setSinkID(this.getTrackId(),e)}catch(e){throw t.onError(e),e}t.onSuccess()}async setEnabled(e,t,r){if(!r){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(Rc.info("[".concat(this.getTrackId(),"] start setEnabled"),e),e){this._originMediaStreamTrack.enabled=!0;try{var i;r||(this._enabled=!0),await Mp(this,vu.NEED_ENABLE_TRACK,this),Rc.info(Je(i="[".concat(this.getTrackId(),"] setEnabled to ")).call(i,e," success"))}catch(e){throw r||(this._enabled=!1),Rc.error("[".concat(this.getTrackId(),"] setEnabled to true error"),e.toString()),e}}else{this._originMediaStreamTrack.enabled=!1,r||(this._enabled=!1);try{await Mp(this,vu.NEED_DISABLE_TRACK,this)}catch(e){throw r||(this._enabled=!0),Rc.error("[".concat(this.getTrackId(),"] setEnabled to false error"),e.toString()),e}}}async setMuted(e){var t;e!==this._muted&&(this.stateCheck("muted",e),this._muted=e,this._mediaStreamTrack.enabled=!e,Rc.debug(Je(t="[".concat(this.getTrackId(),"] start set muted: ")).call(t,e)),e?await Mp(this,vu.NEED_MUTE_TRACK,this):await Mp(this,vu.NEED_UNMUTE_TRACK,this))}getStats(){Hp(()=>{Rc.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning");const e=xp(this,vu.GET_STATS);return e||Uh({},Xl)}setAudioFrameCallback(e,t=4096){if(!e)return this._source.removeAllListeners(Zl.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(t),this._source.removeAllListeners(Zl.ON_AUDIO_BUFFER),this._source.on(Zl.ON_AUDIO_BUFFER,t=>e(t))}play(){const e=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.LOCAL_AUDIO_TRACK_PLAY,options:[this.getTrackId()]});Rc.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(Rc.debug("[".concat(this.getTrackId(),"] start audio playback in element")),Mh.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play(),e.onSuccess()}stop(){const e=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.LOCAL_AUDIO_TRACK_STOP,options:[this.getTrackId()]});Rc.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?Mh.stop(this.getTrackId()):this._source.stop(),e.onSuccess()}close(){super.close(),this._source.destroy()}_updatePlayerSource(){Rc.debug("[".concat(this.getTrackId(),"] update player source track")),this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&Mh.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(e,t){this._originMediaStreamTrack!==e&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),e.addEventListener("ended",this._handleTrackEnded),t&&this._originMediaStreamTrack.stop(),this._originMediaStreamTrack=e,this._source.updateTrack(this._originMediaStreamTrack),this._mediaStreamTrack!==this._source.outputTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Mp(this,vu.NEED_REPLACE_TRACK,this)))}renewMediaStreamTrack(){return fo.resolve(void 0)}}Fh([xh(),Vh("design:type",Function),Vh("design:paramtypes",[String]),Vh("design:returntype",fo)],jh.prototype,"setPlaybackDevice",null),Fh([ch("LocalAudioTrack","_enabledMutex"),xh(),Vh("design:type",Function),Vh("design:paramtypes",[Boolean,Object,Boolean]),Vh("design:returntype",fo)],jh.prototype,"setEnabled",null),Fh([ch("LocalAudioTrack","_enabledMutex"),xh(),ih({report:nh}),Vh("design:type",Function),Vh("design:paramtypes",[Boolean]),Vh("design:returntype",fo)],jh.prototype,"setMuted",null),Fh([xh(),Vh("design:type",Function),Vh("design:paramtypes",[]),Vh("design:returntype",Object)],jh.prototype,"getStats",null),Fh([xh(),Vh("design:type",Function),Vh("design:paramtypes",[Object,Number]),Vh("design:returntype",void 0)],jh.prototype,"setAudioFrameCallback",null),Fh([xh(),Vh("design:type",Function),Vh("design:paramtypes",[]),Vh("design:returntype",void 0)],jh.prototype,"play",null),Fh([xh(),Vh("design:type",Function),Vh("design:paramtypes",[]),Vh("design:returntype",void 0)],jh.prototype,"stop",null);class Gh extends jh{constructor(e,t,r,i){super(e,t.encoderConfig?Fc(t.encoderConfig):{},i),this._deviceName="default",this._enabled=!0,this._config=t,this._constraints=r,this._deviceName=e.label,"boolean"==typeof t.bypassWebAudio&&(this._bypassWebAudio=t.bypassWebAudio),wa()&&ph.bindInterruptDetectorTrack(this)}async setDevice(e){var t,r;const i=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.MIC_AUDIO_TRACK_SET_DEVICE,options:[this.getTrackId(),e]});if(Rc.info(Je(t="[".concat(this.getTrackId(),"] start set device to ")).call(t,e)),this._enabled)try{const t=await Ph.getDeviceById(e),r={};r.audio=Uh({},this._constraints),r.audio.deviceId={exact:e},this._originMediaStreamTrack.stop();let i=null;try{i=await kh(r,this.getTrackId())}catch(e){throw Rc.error("[".concat(this.getTrackId(),"] setDevice failed"),e.toString()),i=await kh({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(i.getAudioTracks()[0],!1),e}await this._updateOriginMediaStreamTrack(i.getAudioTracks()[0],!1),this._deviceName=t.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(e){throw i.onError(e),Rc.error("[".concat(this.getTrackId(),"] setDevice error"),e.toString()),e}else try{const t=await Ph.getDeviceById(e);this._deviceName=t.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(e){throw i.onError(e),Rc.error("[".concat(this.getTrackId(),"] setDevice error"),e.toString()),e}i.onSuccess(),Rc.info(Je(r="[".concat(this.getTrackId(),"] set device to ")).call(r,e," success"))}async setEnabled(e,t,r){if(t)return Rc.debug("[".concat(this.getTrackId,"] setEnabled false (do not close microphone)")),await super.setEnabled(e);if(!r){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(Rc.info("[".concat(this.getTrackId(),"] start setEnabled"),e),!e){this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),r||(this._enabled=!1);try{await Mp(this,vu.NEED_DISABLE_TRACK,this)}catch(e){throw Rc.error("[".concat(this.getTrackId(),"] setEnabled false failed"),e.toString()),e}return}const i=Uh({},this._constraints),n=Ph.searchDeviceIdByName(this._deviceName);n&&!i.deviceId&&(i.deviceId=n);try{r||(this._enabled=!0);const e=await kh({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(e.getAudioTracks()[0],!1),await Mp(this,vu.NEED_ENABLE_TRACK,this)}catch(e){throw r||(this._enabled=!1),Rc.error("[".concat(this.getTrackId(),"] setEnabled true failed"),e.toString()),e}Rc.info("[".concat(this.getTrackId(),"] setEnabled success"))}close(){super.close(),wa()&&ph.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((Ra()||Na())&&this._enabled&&!this._isClosed&&ph.duringInterruption){const e=async()=>{ph.off(uh.IOS_INTERRUPTION_END,e),this._enabled&&!this._isClosed&&(Rc.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};ph.on(uh.IOS_INTERRUPTION_END,e)}else Rc.debug("[".concat(this.getTrackId(),"] track ended")),this.emit(Au.TRACK_ENDED)}async renewMediaStreamTrack(){const e=Uh({},this._constraints),t=Ph.searchDeviceIdByName(this._deviceName);t&&!e.deviceId&&(e.deviceId=t);const r=await kh({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(r.getAudioTracks()[0],!0)}}Fh([xh(),Vh("design:type",Function),Vh("design:paramtypes",[String]),Vh("design:returntype",fo)],Gh.prototype,"setDevice",null),Fh([ch("MicrophoneAudioTrack","_enabledMutex"),xh(),Vh("design:type",Function),Vh("design:paramtypes",[Boolean,Boolean,Boolean]),Vh("design:returntype",fo)],Gh.prototype,"setEnabled",null);class Hh extends jh{constructor(e,t,r,i){super(t.createOutputTrack(),r,i),this.source=e,this._bufferSource=t,this._bufferSource.on(Zl.AUDIO_SOURCE_STATE_CHANGE,e=>{this.emit(Au.SOURCE_STATE_CHANGE,e)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch(e){}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(e){const t=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.BUFFER_AUDIO_TRACK_START,options:[this.getTrackId(),e,this.duration]});e&&this._bufferSource.updateOptions(e),this._bufferSource.startProcessAudioBuffer(),t.onSuccess()}pauseProcessAudioBuffer(){const e=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.BUFFER_AUDIO_TRACK_PAUSE,options:[this.getTrackId()]});this._bufferSource.pauseProcessAudioBuffer(),e.onSuccess()}seekAudioBuffer(e){const t=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.BUFFER_AUDIO_TRACK_SEEK,options:[this.getTrackId()]});this._bufferSource.seekAudioBuffer(e),t.onSuccess()}resumeProcessAudioBuffer(){const e=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.BUFFER_AUDIO_TRACK_RESUME,options:[this.getTrackId()]});this._bufferSource.resumeProcessAudioBuffer(),e.onSuccess()}stopProcessAudioBuffer(){const e=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.BUFFER_AUDIO_TRACK_STOP,options:[this.getTrackId()]});this._bufferSource.stopProcessAudioBuffer(),e.onSuccess()}}Fh([xh(),Vh("design:type",Function),Vh("design:paramtypes",[Object]),Vh("design:returntype",void 0)],Hh.prototype,"startProcessAudioBuffer",null),Fh([xh(),Vh("design:type",Function),Vh("design:paramtypes",[]),Vh("design:returntype",void 0)],Hh.prototype,"pauseProcessAudioBuffer",null),Fh([xh(),Vh("design:type",Function),Vh("design:paramtypes",[Number]),Vh("design:returntype",void 0)],Hh.prototype,"seekAudioBuffer",null),Fh([xh(),Vh("design:type",Function),Vh("design:paramtypes",[]),Vh("design:returntype",void 0)],Hh.prototype,"resumeProcessAudioBuffer",null),Fh([xh(),Vh("design:type",Function),Vh("design:paramtypes",[]),Vh("design:returntype",void 0)],Hh.prototype,"stopProcessAudioBuffer",null);class Qh extends jh{constructor(){const e=gh().createMediaStreamDestination();super(e.stream.getAudioTracks()[0],void 0,kp(8,"track-mix-"));try{this._mediaStreamTrack=this._source.createOutputTrack()}catch(e){}this.destNode=e,this.trackList=[]}get isActive(){for(const e of this.trackList)if(e._enabled&&!e._isClosed&&!e.muted)return!0;return!1}hasAudioTrack(e){var t;return-1!==Lo(t=this.trackList).call(t,e)}addAudioTrack(e){var t;-1===Lo(t=this.trackList).call(t,e)?(Rc.debug("add ".concat(e.getTrackId()," to mixing track")),e._source.outputNode.connect(this.destNode),this.trackList.push(e),this.updateEncoderConfig()):Rc.debug("track ".concat(e.getTrackId()," is already added"))}removeAudioTrack(e){var t;if(-1!==Lo(t=this.trackList).call(t,e)){Rc.debug("remove ".concat(e.getTrackId()," from mixing track"));try{e._source.outputNode.disconnect(this.destNode)}catch(e){}Up(this.trackList,e),this.updateEncoderConfig()}}updateEncoderConfig(){var e;const t={};Jr(e=this.trackList).call(e,e=>{e._encoderConfig&&((e._encoderConfig.bitrate||0)>(t.bitrate||0)&&(t.bitrate=e._encoderConfig.bitrate),(e._encoderConfig.sampleRate||0)>(t.sampleRate||0)&&(t.sampleRate=e._encoderConfig.sampleRate),(e._encoderConfig.sampleSize||0)>(t.sampleSize||0)&&(t.sampleSize=e._encoderConfig.sampleSize),e._encoderConfig.stereo&&(t.stereo=!0))}),this._encoderConfig=t}}class Wh extends Mu{constructor(){super(...arguments),this.resultStorage=new Mr}setLocalAudioStats(e,t,r){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",e,this.checkAudioInputLevel(r,t)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",e,this.checkSendAudioBitrate(r,t))}setLocalVideoStats(e,t,r){this.record("SEND_VIDEO_BITRATE_TOO_LOW",e,this.checkSendVideoBitrate(r,t)),this.record("FRAMERATE_INPUT_TOO_LOW",e,this.checkFramerateInput(r,t)),this.record("FRAMERATE_SENT_TOO_LOW",e,this.checkFramerateSent(r))}setRemoteAudioStats(e,t){const r=e.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",r,this.checkAudioOutputLevel(t))}setRemoteVideoStats(e,t){const r=e.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",r,this.checkVideoDecode(t))}record(e,t,r){this.resultStorage.has(e)||this.resultStorage.set(e,{result:[],isPrevNormal:!0});const i=this.resultStorage.get(e);if(i&&(i.result.push(r),i.result.length>=5)){var n;const r=is(n=i.result).call(n,!0);i.isPrevNormal&&!r&&this.emit("exception",qh[e],e,t),!i.isPrevNormal&&r&&this.emit("exception",qh[e]+2e3,e+"_RECOVER",t),i.isPrevNormal=r,i.result=[]}}checkAudioOutputLevel(e){return!(e.receiveBitrate>0&&0===e.receiveLevel)}checkAudioInputLevel(e,t){return t instanceof Qh&&!t.isActive||!!t.muted||0!==e.sendVolumeLevel}checkFramerateInput(e,t){let r=null;t._encoderConfig&&t._encoderConfig.frameRate&&(r=fp(t._encoderConfig.frameRate));const i=e.captureFrameRate;return!r||!i||!(r>10&&i<5||r<10&&r>=5&&i<=1)}checkFramerateSent(e){return!(e.captureFrameRate&&e.sendFrameRate&&e.captureFrameRate>5&&e.sendFrameRate<=1)}checkSendVideoBitrate(e,t){return!!t.muted||0!==e.sendBitrate}checkSendAudioBitrate(e,t){return t instanceof Qh&&!t.isActive||!!t.muted||0!==e.sendBitrate}checkVideoDecode(e){return 0===e.receiveBitrate||0!==e.decodeFrameRate}}const qh={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},zh=new class{markSubscribeStart(e,t){var r;performance.mark(Je(r="agora-web-sdk/".concat(e,"/subscribe-")).call(r,t))}markPublishStart(e,t){var r;performance.mark(Je(r="agora-web-sdk/".concat(e,"/publish-")).call(r,t))}measureFromSubscribeStart(e,t){var r;const i=performance.getEntriesByName(Je(r="agora-web-sdk/".concat(e,"/subscribe-")).call(r,t));if(i.length>0){const e=i[i.length-1];return performance.now()-e.startTime}return 0}measureFromPublishStart(e,t){var r;const i=performance.getEntriesByName(Je(r="agora-web-sdk/".concat(e,"/publish-")).call(r,t));if(i.length>0){const e=i[i.length-1];return Math.round(performance.now()-e.startTime)}return 0}};function Zh(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function Yh(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=Zh(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=Zh(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}class Kh{constructor(e){this.localStats=new Mr,this.remoteStats=new Mr,this.trafficStatsPeerList=[],this.updateStats=()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))},this.store=e,this.updateStatsInterval=window.setInterval(this.updateStats,1e3),this.exceptionMonitor=new Wh,this.exceptionMonitor.on("exception",(e,t,r)=>{this.onStatsException&&this.onStatsException(e,t,r)})}reset(){this.localStats=new Mr,this.remoteStats=new Mr,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(Ou.LocalAudioTrack)||Yh({},Xl)}getLocalVideoTrackStats(){return this.localStats.get(Ou.LocalVideoTrack)||Yh({},eu)}getRemoteAudioTrackStats(e){const t=(e,t)=>{var r;if(!this.trafficStats)return t;const i=Qo(r=this.trafficStats.peer_delay).call(r,t=>t.peer_uid===e);return i&&(t.publishDuration=i.B_ppad+(Ma()-this.trafficStats.timestamp)),t},r={};if(e){var i;const n=null===(i=this.remoteStats.get(e))||void 0===i?void 0:i.audioStats;n&&(r[e]=t(e,n))}else{var n,o;Jr(n=Bd(Dd(o=this.remoteStats).call(o))).call(n,([e,{audioStats:i}])=>{i&&(r[e]=t(e,i))})}return r}getRemoteNetworkQualityStats(e){const t={};if(e){var r;const i=null===(r=this.remoteStats.get(e))||void 0===r?void 0:r.networkStats;i&&(t[e]=i)}else{var i,n;Jr(i=Bd(Dd(n=this.remoteStats).call(n))).call(i,([e,{networkStats:r}])=>{r&&(t[e]=r)})}return t}getRemoteVideoTrackStats(e){const t=(e,t)=>{var r;if(!this.trafficStats)return t;const i=Qo(r=this.trafficStats.peer_delay).call(r,t=>t.peer_uid===e);return i&&(t.publishDuration=i.B_ppvd+(Ma()-this.trafficStats.timestamp)),t},r={};if(e){var i;const n=null===(i=this.remoteStats.get(e))||void 0===i?void 0:i.videoStats;n&&(r[e]=t(e,n))}else{var n,o;Jr(n=Bd(Dd(o=this.remoteStats).call(o))).call(n,([e,{videoStats:i}])=>{i&&(r[e]=t(e,i))})}return r}getRTCStats(){var e;let t=0,r=0,i=0,n=0;const o=this.localStats.get(Ou.LocalAudioTrack);o&&(t+=o.sendBytes,r+=o.sendBitrate);const s=this.localStats.get(Ou.LocalVideoTrack);s&&(t+=s.sendBytes,r+=s.sendBitrate);const a=this.localStats.get(Ou.LocalVideoLowTrack);a&&(t+=a.sendBytes,r+=a.sendBitrate),Jr(e=this.remoteStats).call(e,({audioStats:e,videoStats:t})=>{e&&(i+=e.receiveBytes,n+=e.receiveBitrate),t&&(i+=t.receiveBytes,n+=t.receiveBitrate)});let c=1;return this.trafficStats&&(c+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:c,SendBitrate:r,SendBytes:t,RecvBytes:i,RecvBitrate:n,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(e){this.localStats.set(e,void 0)}removeLocalStats(e){e?this.localStats.delete(e):this.localStats.clear()}addRemoteStats(e){this.remoteStats.set(e,{})}removeRemoteStats(e){e?this.remoteStats.delete(e):this.remoteStats.clear()}addP2PChannel(e){this.p2pChannel=e}updateTrafficStats(e){var t;const r=ji(t=e.peer_delay).call(t,e=>{var t;return-1===Lo(t=this.trafficStatsPeerList).call(t,e.peer_uid)});Jr(r).call(r,e=>{var t;const r=null===(t=this.p2pChannel)||void 0===t?void 0:t.getRemoteMedia(e.peer_uid),i=null!=r&&r.videoSSRC?zh.measureFromSubscribeStart(this.store.clientId,r.videoSSRC):0,n=null!=r&&r.audioSSRC?zh.measureFromSubscribeStart(this.store.clientId,r.audioSSRC):0;void 0!==e.B_ppad&&void 0!==e.B_ppvd&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(e.peer_uid,e.B_ppad,e.B_ppvd,i>n?i:n),this.trafficStatsPeerList.push(e.peer_uid))}),this.trafficStats=e}updateUplinkStats(e){var t;this.uplinkStats&&this.uplinkStats.B_fir!==e.B_fir&&Rc.debug(Je(t="[".concat(this.store.clientId,"]: Period fir changes to ")).call(t,e.B_fir)),this.uplinkStats=e}static isRemoteVideoFreeze(e,t,r){if(!e)return!1;const i=!!r&&t.framesDecodeFreezeTime>r.framesDecodeFreezeTime,n=!r||t.framesDecodeCount>r.framesDecodeCount;return i||!n}static isRemoteAudioFreeze(e){return!!e&&e._isFreeze()}isLocalVideoFreeze(e){return!(!e.inputFrame||!e.sentFrame)&&e.inputFrame.frameRate>5&&e.sentFrame.frameRate<3}updateLocalStats(e){var t,r;Jr(t=Bd(Dd(r=this.localStats).call(r))).call(t,([t,r])=>{switch(t){case Ou.LocalVideoTrack:case Ou.LocalVideoLowTrack:{const n=r,o=Yh({},eu),s=e.getStats(),a=e.getLocalMedia(t);if(s){var i;const t=Qo(i=s.videoSend).call(i,e=>e.ssrc===(null==a?void 0:a.ssrcs[0].ssrcId));if(t){const r=e.getLocalVideoSize(),i=e.getEncoderConfig(Ou.LocalVideoTrack);"H264"!==t.codec&&"VP8"!==t.codec&&"VP9"!==t.codec&&"AV1X"!==t.codec||(o.codecType=t.codec),o.sendBytes=t.bytes,o.sendBitrate=n?8*Math.max(0,o.sendBytes-n.sendBytes):0,t.inputFrame?(o.captureFrameRate=t.inputFrame.frameRate,o.captureResolutionHeight=t.inputFrame.height,o.captureResolutionWidth=t.inputFrame.width):r&&(o.captureResolutionWidth=r.width,o.captureResolutionHeight=r.height),t.sentFrame?(o.sendFrameRate=t.sentFrame.frameRate,o.sendResolutionHeight=t.sentFrame.height,o.sendResolutionWidth=t.sentFrame.width):r&&(o.sendResolutionWidth=r.width,o.sendResolutionHeight=r.height),t.avgEncodeMs&&(o.encodeDelay=t.avgEncodeMs),i&&i.bitrateMax&&(o.targetSendBitrate=1e3*i.bitrateMax),o.sendPackets=t.packets,o.sendPacketsLost=t.packetsLost,o.totalDuration=n?n.totalDuration+1:1,o.totalFreezeTime=n?n.totalFreezeTime:0,this.isLocalVideoFreeze(t)&&(o.totalFreezeTime+=1)}this.trafficStats&&(o.sendPacketsLost=this.trafficStats.B_pvlr4/100)}this.localStats.set(t,o),o&&a&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,a.track,o);break}case Ou.LocalAudioTrack:{const i=r,o=Yh({},Xl),s=e.getStats(),a=e.getLocalMedia(t);if(s){var n;const t=Qo(n=s.audioSend).call(n,e=>e.ssrc===(null==a?void 0:a.ssrcs[0].ssrcId));if(t){if("opus"!==t.codec&&"aac"!==t.codec||(o.codecType=t.codec),t.inputLevel)o.sendVolumeLevel=Math.round(32767*t.inputLevel);else{const t=e.getLocalAudioVolume();t&&(o.sendVolumeLevel=Math.round(32767*t))}o.sendBytes=t.bytes,o.sendPackets=t.packets,o.sendPacketsLost=t.packetsLost,o.sendBitrate=i?8*Math.max(0,o.sendBytes-i.sendBytes):0}}this.trafficStats&&(o.sendPacketsLost=this.trafficStats.B_pvlr4/100),this.localStats.set(Ou.LocalAudioTrack,o),o&&a&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,a.track,o);break}}})}updateRemoteStats(e){var t,r;Jr(t=Bd(Dd(r=this.remoteStats).call(r))).call(t,([t,{videoStats:r,audioStats:i,videoPcStats:n}])=>{var o,s,a;const c=i,l=r,u=n,d=Yh({},tu),h=Yh({},iu),p=Yh({},ru),{audioTrack:f,videoTrack:g,audioSSRC:m,videoSSRC:_}=e.getRemoteMedia(t),v=e.getStats(),E=null==v?void 0:Qo(o=v.audioRecv).call(o,e=>e.ssrc===m),A=null==v?void 0:Qo(s=v.videoRecv).call(s,e=>e.ssrc===_),y=this.trafficStats&&Qo(a=this.trafficStats.peer_delay).call(a,e=>e.peer_uid===t);if(E&&("opus"!==E.codec&&"aac"!==E.codec||(d.codecType=E.codec),E.outputLevel?d.receiveLevel=Math.round(32767*E.outputLevel):f&&(d.receiveLevel=Math.round(32767*f.getVolumeLevel())),d.receiveBytes=E.bytes,d.receivePackets=E.packets,d.receivePacketsLost=E.packetsLost,d.packetLossRate=d.receivePacketsLost/(d.receivePackets+d.receivePacketsLost),d.receiveBitrate=c?8*Math.max(0,d.receiveBytes-c.receiveBytes):0,d.totalDuration=c?c.totalDuration+1:1,d.totalFreezeTime=c?c.totalFreezeTime:0,d.freezeRate=d.totalFreezeTime/d.totalDuration,d.receiveDelay=E.jitterBufferMs,d.totalDuration>10&&Kh.isRemoteAudioFreeze(f)&&(d.totalFreezeTime+=1)),A){"H264"!==A.codec&&"VP8"!==A.codec&&"VP9"!==A.codec&&"AV1X"!==A.codec||(h.codecType=A.codec),h.receiveBytes=A.bytes,h.receiveBitrate=l?8*Math.max(0,h.receiveBytes-l.receiveBytes):0,h.decodeFrameRate=A.decodeFrameRate<0?0:A.decodeFrameRate,h.renderFrameRate=A.decodeFrameRate<0?0:A.decodeFrameRate,A.outputFrame&&(h.renderFrameRate=A.outputFrame.frameRate),A.receivedFrame?(h.receiveFrameRate=A.receivedFrame.frameRate,h.receiveResolutionHeight=A.receivedFrame.height,h.receiveResolutionWidth=A.receivedFrame.width):g&&(h.receiveResolutionHeight=g._videoHeight||0,h.receiveResolutionWidth=g._videoWidth||0),void 0!==A.framesRateFirefox&&(h.receiveFrameRate=Math.round(A.framesRateFirefox)),h.receivePackets=A.packets,h.receivePacketsLost=A.packetsLost,h.packetLossRate=h.receivePacketsLost/(h.receivePackets+h.receivePacketsLost),h.totalDuration=l?l.totalDuration+1:1,h.totalFreezeTime=l?l.totalFreezeTime:0,h.receiveDelay=A.jitterBufferMs||0;const t=!!_&&e.getRemoteVideoIsReady(_);g&&t&&Kh.isRemoteVideoFreeze(g,A,u)&&(h.totalFreezeTime+=1),h.freezeRate=h.totalFreezeTime/h.totalDuration}y&&(d.end2EndDelay=y.B_ad,h.end2EndDelay=y.B_vd,d.transportDelay=y.B_ed,h.transportDelay=y.B_ed,d.currentPacketLossRate=y.B_ealr4/100,h.currentPacketLossRate=y.B_evlr4/100,p.uplinkNetworkQuality=y.B_punq?y.B_punq:0,p.downlinkNetworkQuality=y.B_pdnq?y.B_pdnq:0),this.remoteStats.set(t,{audioStats:d,videoStats:h,videoPcStats:A,networkStats:p}),f&&this.exceptionMonitor.setRemoteAudioStats(f,d),g&&this.exceptionMonitor.setRemoteVideoStats(g,h)})}}var $h="".repeat||function(e){var t=String(m(this)),r="",i=z(e);if(i<0||i==1/0)throw RangeError("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(t+=t))1&i&&(r+=t);return r},Jh=Math.ceil,Xh=function(e){return function(t,r,i){var n,o,s=String(m(t)),a=s.length,c=void 0===i?" ":String(i),l=Y(r);return l<=a||""==c?s:(n=l-a,(o=$h.call(c,Jh(n/c.length))).length>n&&(o=o.slice(0,n)),e?s+o:o+s)}},ep={start:Xh(!1),end:Xh(!0)},tp=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(xe),rp=ep.start;Q({target:"String",proto:!0,forced:tp},{padStart:function(e){return rp(this,e,arguments.length>1?arguments[1]:void 0)}});var ip=Ye("String").padStart,np=String.prototype,op=function(e){var t=e.padStart;return"string"==typeof e||e===np||e instanceof String&&t===np.padStart?ip:t};function sp(e){return(new TextEncoder).encode(e)}const ap=async e=>{const t=Qp("MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu\nSTM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+\nHvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy\nxQiYDz3vqa6bP29adwIDAQAB"),r=await window.crypto.subtle.importKey("spki",t,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),i=sp(e),n=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},r,i);return Wp(new Uint8Array(n))},cp=async e=>function(e,t){let r="";const i=new Uint8Array(e);return Jr(i).call(i,e=>{var i;r+=op(i=e.toString(t)).call(i,2,"0")}),r}(await crypto.subtle.digest("SHA-256",sp(e)),16);function lp(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function up(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=lp(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=lp(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}function dp(e){if(!e.address||!e.tcp)throw new pl(ll.UNEXPECTED_RESPONSE,"Invalid address format ".concat(e));return e.address.match(/^[\.\:\d]+$/)?"".concat(e.address.replace(/[^\d]/g,"-"),".edge.agora.io"):(Rc.info("Cannot recognized as IP address ".concat(e.address,". Used As Host instead")),Je(t="".concat(e.address,":")).call(t,e.tcp));var t}function hp(e){var t;return e.match(/^[\.\:\d]+$/)?Je(t="".concat(e.replace(/[^\d]/g,"-"),".")).call(t,jc("TURN_DOMAIN")):(Rc.info("Cannot recognized as IP address ".concat(e,". Used As Host instead")),e)}function pp(e,t){var r;const i=jc("GATEWAY_DOMAINS");let n=i[1]&&-1!==Lo(t).call(t,i[1])?1:0;return e.addresses=e.addresses||[],{gatewayAddrs:vo(r=e.addresses).call(r,e=>{var t,r,o;return e.ip.match(/^[\.\:\d]+$/)?Je(t=Je(r="".concat(e.ip.replace(/[^\d]/g,"-"),".")).call(r,i[n++%i.length],":")).call(t,e.port):(Rc.info("Cannot recognized as IP address ".concat(e.ip,". Used As Host instead")),Je(o="".concat(e.ip,":")).call(o,e.port))}),uid:e.uid,cid:e.cid,vid:e.detail&&e.detail[8],uni_lbs_ip:e.detail&&e.detail[1],res:e,csIp:e.detail&&e.detail[502]}}function fp(e){return"number"==typeof e?e:e.exact||e.ideal||e.max||e.min||0}function gp(e){var t;const r=e._encoderConfig;if(!r)return{};const i={resolution:r.width&&r.height?Je(t="".concat(fp(r.width),"x")).call(t,fp(r.height)):void 0,maxVideoBW:r.bitrateMax,minVideoBW:r.bitrateMin};return"number"==typeof r.frameRate?(i.maxFrameRate=r.frameRate,i.minFrameRate=r.frameRate):r.frameRate&&(i.maxFrameRate=r.frameRate.max||r.frameRate.ideal||r.frameRate.exact||r.frameRate.min,i.minFrameRate=r.frameRate.min||r.frameRate.ideal||r.frameRate.exact||r.frameRate.max),i}function mp(e,t,r){var i,n,o;const s=Qo(i=t.videoSend).call(i,t=>t.ssrc===e);if(!s)return null;const a=null==r||null===(n=Qo(o=r.videoSend).call(o,t=>t.ssrc===e))||void 0===n?void 0:n.inputFrame,c={id:kp(10,""),timestamp:new Date(t.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:s.ssrc.toString()};return s.inputFrame&&(a&&s.inputFrame.height===a.height||(c.A_fhi=s.inputFrame.height?s.inputFrame.height.toString():"0"),a&&s.inputFrame.width===a.width||(c.A_fwi=s.inputFrame.width?s.inputFrame.width.toString():"0"),a&&s.inputFrame.frameRate===a.frameRate||(c.A_fri=s.inputFrame.frameRate?s.inputFrame.frameRate.toString():"0")),c}function _p(e){return e>=0&&e<.17?1:e>=.17&&e<.36?2:e>=.36&&e<.59?3:e>=.59&&e<=1?4:e>1?5:0}function vp(e,t){var r;let i,n,o=void 0;switch(t){case Rd.CHOOSE_SERVER:i=4096,n="choose server";break;case Rd.CLOUD_PROXY:i=1048576,n="proxy";break;case Rd.CLOUD_PROXY_5:i=4194304,n="proxy5";break;default:throw new pl(ll.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:e.detail&&e.detail[502],retry:!1})}if(Jr(r=e.response_body).call(r,t=>{var r;t.buffer&&t.buffer.flag===i&&(o={code:t.buffer.code,addresses:vo(r=t.buffer.edges_services).call(r,e=>up({},e,{ticket:t.buffer.cert})),server_ts:e.enter_ts,uid:t.buffer.uid,cid:t.buffer.cid,cname:t.buffer.cname,detail:up({},t.buffer.detail,{},e.detail),flag:t.buffer.flag,opid:e.opid})}),!o)throw new pl(ll.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(n," from multi unilbs response"),{csIp:e.detail&&e.detail[502]});return o}async function Ep(e,t){var r;return await fo.all(vo(r=e.addresses).call(r,async e=>({address:e.ip,tcpport:e.port,udpport:e.port,username:t?t.toString():Nc.username,password:t?await cp(t.toString()):Nc.password})))}function Ap(e,t){const r=t._videoHeight||t.getMediaStreamTrack(!0).getSettings().height;return r?r/fp(e.height):4}var yp;function Sp(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function Cp(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=Sp(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=Sp(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}function Tp(e){return window.TextEncoder?(new TextEncoder).encode(e).length:e.length}function bp(e,t,r){const i=e[t];if(!i||"string"!=typeof i)return[e];e[t]="";const n=Tp(ve(e));let o=0;const s=[];let a=0;for(let c=0;c<i.length;c++)a+=i.charCodeAt(c)<=127?1:3,a<=r-n||(s[s.length]=Cp({},e,{[t]:i.substring(o,c)}),o=c,a=i.charCodeAt(c)<=127?1:3);return o!==i.length-1&&(s[s.length]=Cp({},e,{[t]:i.substring(o)})),s}function Ip(e){return new fo(t=>{window.setTimeout(t,e)})}function Rp(e){const t=new pl(ll.TIMEOUT,"timeout");return new fo((r,i)=>{window.setTimeout(()=>i(t),e)})}function wp(e,t){return t===1/0?e:fo.race([e,Rp(t)])}function kp(e=7,t){var r,i;const n=Math.random().toString(16).substr(2,e).toLowerCase();return n.length===e?Je(r="".concat(t)).call(r,n):Je(i="".concat(t)).call(i,n)+kp(e-n.length,"")}function Op(){return kp(32,"").toUpperCase()}const Np=()=>{};function Lp(e){return new fo((t,r)=>{let i=!1;const n=document.createElement("video");n.setAttribute("autoplay",""),n.setAttribute("muted",""),n.muted=!0,n.autoplay=!0,n.setAttribute("playsinline",""),n.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(n);const o=Ra()?"canplay":"playing";n.addEventListener(o,()=>{const e=n.videoWidth,r=n.videoHeight;!e&&Ia()||(i=!0,n.srcObject=null,n.remove(),t([e,r]))}),n.srcObject=new MediaStream([e]),n.play().catch(Np),Fa(()=>{i||(n.srcObject=null,n.remove(),t([n.videoWidth,n.videoHeight]))},4e3)})}function Pp(e){return fo.all(vo(e).call(e,e=>e.then(e=>{throw e},e=>e))).then(e=>{throw e},e=>e)}function Dp(e,t,...r){return 0===e.getListeners(t).length?fo.reject(new pl(ll.UNEXPECTED_ERROR,"can not emit promise")):new fo((i,n)=>{e.emit(t,...r,i,n)})}function Mp(e,t,...r){return 0===e.getListeners(t).length?fo.resolve():Dp(e,t,...r)}function xp(e,t,...r){return 0===e.getListeners(t).length?null:Bp(e,t,...r)}function Bp(e,t,...r){let i=null,n=null;if(e.emit(t,...r,e=>{i=e},e=>{n=e}),null!==n)throw n;if(null===i)throw new pl(ll.UNEXPECTED_ERROR,"handler is not sync");return i}function Up(e,t){const r=Lo(e).call(e,t);-1!==r&&bo(e).call(e,r,1)}function Fp(e){const t=[];return Jr(e).call(e,e=>{-1===Lo(t).call(t,e)&&t.push(e)}),t}function Vp(e){fo.resolve().then(e)}function jp(e){return JSON.parse(ve(e))}const Gp={};function Hp(e,t){Gp[t]||(Gp[t]=!0,e())}function Qp(e){const t=window.atob(e),r=new Uint8Array(new ArrayBuffer(t.length));for(let i=0;i<t.length;i+=1)r[i]=t.charCodeAt(i);return r}function Wp(e){let t="";for(let r=0;r<e.length;r+=1)t+=String.fromCharCode(e[r]);return window.btoa(t)}const qp=new class{constructor(){this.fnMap=new Mr}throttleByKey(e,t,r,i,...n){if(this.fnMap.has(t)){const o=this.fnMap.get(t);if(o.threshold!==r){o.fn(...o.args),clearTimeout(o.timer);const s=window.setTimeout(()=>{const e=this.fnMap.get(t);e&&e.fn(...e.args),this.fnMap.delete(t)},r);this.fnMap.set(t,{fn:e,threshold:r,timer:s,args:n,skipFn:i})}else o.skipFn&&o.skipFn(...o.args),this.fnMap.set(t,Cp({},o,{fn:e,args:n,skipFn:i}))}else{const o=window.setTimeout(()=>{const e=this.fnMap.get(t);e&&e.fn(...e.args),this.fnMap.delete(t)},r);this.fnMap.set(t,{fn:e,threshold:r,timer:o,args:n,skipFn:i})}}},zp=$o(yp=qp.throttleByKey).call(yp,qp),Zp=async({fragementLength:e,referenceList:t,asyncMapHandler:r,allFailedhandler:i,promisesCollector:n})=>{let o=0;const s=e;let a,c=0;const l=async()=>{const e=(()=>{const e=o*s,i=e+s,n=Uo(t).call(t,e,i);return vo(n).call(n,r)})();n&&n.push(...e);try{a=await Pp(e)}catch(e){if(c+=s,o++,!(c>=t.length))return void await l();i(e)}Jr(e).call(e,e=>e.cancel())};return await l(),a};var Yp=Ye("Array").values,Kp=Array.prototype,$p={DOMTokenList:!0,NodeList:!0},Jp=function(e){var t=e.values;return e===Kp||e instanceof Array&&t===Kp.values||$p.hasOwnProperty(ht(e))?Yp:t};const Xp={[Ml.ACCESS_POINT]:{[Ul.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[Ul.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[Ul.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[Ul.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[Ul.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[Ul.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voice service available",retry:!0},[Ul.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[Ul.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[Ul.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[Ul.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[Ul.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[Ul.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[Ul.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[Ul.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[Ul.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[Ul.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[Ml.UNILBS]:{[Bl.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[Bl.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[Bl.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[Bl.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[Bl.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[Bl.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[Bl.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[Bl.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[Bl.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[Bl.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[Bl.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[Bl.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[Ml.STRING_UID_ALLOCATOR]:{[xl.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[xl.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[xl.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function ef(e){const t=Xp[Math.floor(e/1e4)];if(!t)return{desc:"unkonw error",retry:!1};const r=t[e%1e4];if(!r){if(Math.floor(e/1e4)===Ml.ACCESS_POINT){const t=e%1e4;if("1"===t.toString()[0])return{desc:e.toString(),retry:!1};if("2"===t.toString()[0])return{desc:e.toString(),retry:!0}}return{desc:"unkonw error",retry:!1}}return r}const tf={[Fl.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[Fl.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[Fl.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[Fl.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[Fl.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[Fl.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[Fl.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[Fl.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[Fl.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[Fl.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[Fl.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[Fl.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[Fl.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[Fl.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[Fl.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[Fl.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[Fl.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[Fl.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[Fl.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[Fl.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[Fl.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[Fl.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[Fl.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[Fl.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[Fl.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[Fl.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[Fl.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[Fl.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[Fl.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[Fl.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[Fl.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[Fl.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[Fl.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[Fl.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[Fl.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[Fl.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[Fl.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[Fl.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[Fl.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[Fl.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[Fl.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[Fl.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[Fl.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[Fl.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[Fl.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[Fl.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[Fl.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[Fl.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[Fl.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[Fl.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[Fl.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[Fl.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[Fl.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[Fl.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[Fl.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[Fl.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"}};function rf(e){const t=tf[e];return t||{desc:"UNKNOW_ERROR_".concat(e),action:"failed"}}var nf=i((function(e,t){e.exports=function(){var e={d:function(t,r){for(var i in r)e.o(r,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:r[i]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{DataViewIndexOutOfBoundsError:function(){return j},DecodeError:function(){return E},Decoder:function(){return Q},EXT_TIMESTAMP:function(){return A},Encoder:function(){return O},ExtData:function(){return _},ExtensionCodec:function(){return R},decode:function(){return q},decodeArrayStream:function(){return ee},decodeAsync:function(){return X},decodeMulti:function(){return z},decodeMultiStream:function(){return te},decodeStream:function(){return re},decodeTimestampExtension:function(){return b},decodeTimestampToTimeSpec:function(){return T},encode:function(){return L},encodeDateToTimeSpec:function(){return S},encodeTimeSpecToTimestamp:function(){return y},encodeTimestampExtension:function(){return C}});var i=4294967295;function n(e,t,r){var i=Math.floor(r/4294967296),n=r;e.setUint32(t,i),e.setUint32(t+4,n)}function o(e,t){return 4294967296*e.getInt32(t)+e.getUint32(t+4)}var s=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return s},a=function(e,t){for(var r=0,i=t.length,n=e.length;r<i;r++,n++)e[n]=t[r];return e},c="undefined"!=typeof TextEncoder&&"undefined"!=typeof TextDecoder;function l(e){for(var t=e.length,r=0,i=0;i<t;){var n=e.charCodeAt(i++);if(0!=(4294967168&n))if(0==(4294965248&n))r+=2;else{if(n>=55296&&n<=56319&&i<t){var o=e.charCodeAt(i);56320==(64512&o)&&(++i,n=((1023&n)<<10)+(1023&o)+65536)}r+=0==(4294901760&n)?3:4}else r++}return r}var u=c?new TextEncoder:void 0,d=c?"undefined"!=typeof r?200:0:i,h=(null==u?void 0:u.encodeInto)?function(e,t,r){u.encodeInto(e,t.subarray(r))}:function(e,t,r){t.set(u.encode(e),r)};function p(e,t,r){for(var i=t,n=i+r,o=[],c="";i<n;){var l=e[i++];if(0==(128&l))o.push(l);else if(192==(224&l)){var u=63&e[i++];o.push((31&l)<<6|u)}else if(224==(240&l)){u=63&e[i++];var d=63&e[i++];o.push((31&l)<<12|u<<6|d)}else if(240==(248&l)){var h=(7&l)<<18|(u=63&e[i++])<<12|(d=63&e[i++])<<6|63&e[i++];h>65535&&(h-=65536,o.push(h>>>10&1023|55296),h=56320|1023&h),o.push(h)}else o.push(l);o.length>=4096&&(c+=String.fromCharCode.apply(String,a([],s(o))),o.length=0)}return o.length>0&&(c+=String.fromCharCode.apply(String,a([],s(o)))),c}var f,g=c?new TextDecoder:null,m=c?"undefined"!=typeof r?200:0:i,_=function(e,t){this.type=e,this.data=t},v=(f=function(e,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),E=function(e){function t(r){var i=e.call(this,r)||this,n=Object.create(t.prototype);return Object.setPrototypeOf(i,n),Object.defineProperty(i,"name",{configurable:!0,enumerable:!1,value:t.name}),i}return v(t,e),t}(Error),A=-1;function y(e){var t,r=e.sec,i=e.nsec;if(r>=0&&i>=0&&r<=17179869183){if(0===i&&r<=4294967295){var o=new Uint8Array(4);return(t=new DataView(o.buffer)).setUint32(0,r),o}var s=r/4294967296,a=4294967295&r;return o=new Uint8Array(8),(t=new DataView(o.buffer)).setUint32(0,i<<2|3&s),t.setUint32(4,a),o}return o=new Uint8Array(12),(t=new DataView(o.buffer)).setUint32(0,i),n(t,4,r),o}function S(e){var t=e.getTime(),r=Math.floor(t/1e3),i=1e6*(t-1e3*r),n=Math.floor(i/1e9);return{sec:r+n,nsec:i-1e9*n}}function C(e){return e instanceof Date?y(S(e)):null}function T(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:t.getUint32(0),nsec:0};case 8:var r=t.getUint32(0);return{sec:4294967296*(3&r)+t.getUint32(4),nsec:r>>>2};case 12:return{sec:o(t,4),nsec:t.getUint32(0)};default:throw new E("Unrecognized data size for timestamp (expected 4, 8, or 12): "+e.length)}}function b(e){var t=T(e);return new Date(1e3*t.sec+t.nsec/1e6)}var I={type:A,encode:C,decode:b},R=function(){function e(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(I)}return e.prototype.register=function(e){var t=e.type,r=e.encode,i=e.decode;if(t>=0)this.encoders[t]=r,this.decoders[t]=i;else{var n=1+t;this.builtInEncoders[n]=r,this.builtInDecoders[n]=i}},e.prototype.tryToEncode=function(e,t){for(var r=0;r<this.builtInEncoders.length;r++)if(null!=(i=this.builtInEncoders[r])&&null!=(n=i(e,t)))return new _(-1-r,n);for(r=0;r<this.encoders.length;r++){var i,n;if(null!=(i=this.encoders[r])&&null!=(n=i(e,t)))return new _(r,n)}return e instanceof _?e:null},e.prototype.decode=function(e,t,r){var i=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return i?i(e,t,r):new _(t,e)},e.defaultCodec=new e,e}();function w(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Uint8Array.from(e)}var k=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},O=function(){function e(e,t,r,i,n,o,s,a){void 0===e&&(e=R.defaultCodec),void 0===t&&(t=void 0),void 0===r&&(r=100),void 0===i&&(i=2048),void 0===n&&(n=!1),void 0===o&&(o=!1),void 0===s&&(s=!1),void 0===a&&(a=!1),this.extensionCodec=e,this.context=t,this.maxDepth=r,this.initialBufferSize=i,this.sortKeys=n,this.forceFloat32=o,this.ignoreUndefined=s,this.forceIntegerToFloat=a,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return e.prototype.getUint8Array=function(){return this.bytes.subarray(0,this.pos)},e.prototype.reinitializeState=function(){this.pos=0},e.prototype.encode=function(e){return this.reinitializeState(),this.doEncode(e,1),this.getUint8Array()},e.prototype.doEncode=function(e,t){if(t>this.maxDepth)throw new Error("Too deep objects in depth "+t);null==e?this.encodeNil():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.encodeObject(e,t)},e.prototype.ensureBufferSizeToWrite=function(e){var t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)},e.prototype.resizeBuffer=function(e){var t=new ArrayBuffer(e),r=new Uint8Array(t),i=new DataView(t);r.set(this.bytes),this.view=i,this.bytes=r},e.prototype.encodeNil=function(){this.writeU8(192)},e.prototype.encodeBoolean=function(e){!1===e?this.writeU8(194):this.writeU8(195)},e.prototype.encodeNumber=function(e){Number.isSafeInteger(e)&&!this.forceIntegerToFloat?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):(this.writeU8(211),this.writeI64(e)):this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))},e.prototype.writeStringHeader=function(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else{if(!(e<4294967296))throw new Error("Too long string: "+e+" bytes in UTF-8");this.writeU8(219),this.writeU32(e)}},e.prototype.encodeString=function(e){if(e.length>d){var t=l(e);this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),h(e,this.bytes,this.pos),this.pos+=t}else t=l(e),this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),function(e,t,r){for(var i=e.length,n=r,o=0;o<i;){var s=e.charCodeAt(o++);if(0!=(4294967168&s)){if(0==(4294965248&s))t[n++]=s>>6&31|192;else{if(s>=55296&&s<=56319&&o<i){var a=e.charCodeAt(o);56320==(64512&a)&&(++o,s=((1023&s)<<10)+(1023&a)+65536)}0==(4294901760&s)?(t[n++]=s>>12&15|224,t[n++]=s>>6&63|128):(t[n++]=s>>18&7|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128)}t[n++]=63&s|128}else t[n++]=s}}(e,this.bytes,this.pos),this.pos+=t},e.prototype.encodeObject=function(e,t){var r=this.extensionCodec.tryToEncode(e,this.context);if(null!=r)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else{if("object"!=typeof e)throw new Error("Unrecognized object: "+Object.prototype.toString.apply(e));this.encodeMap(e,t)}},e.prototype.encodeBinary=function(e){var t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large binary: "+t);this.writeU8(198),this.writeU32(t)}var r=w(e);this.writeU8a(r)},e.prototype.encodeArray=function(e,t){var r,i,n=e.length;if(n<16)this.writeU8(144+n);else if(n<65536)this.writeU8(220),this.writeU16(n);else{if(!(n<4294967296))throw new Error("Too large array: "+n);this.writeU8(221),this.writeU32(n)}try{for(var o=k(e),s=o.next();!s.done;s=o.next()){var a=s.value;this.doEncode(a,t+1)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}},e.prototype.countWithoutUndefined=function(e,t){var r,i,n=0;try{for(var o=k(t),s=o.next();!s.done;s=o.next())void 0!==e[s.value]&&n++}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return n},e.prototype.encodeMap=function(e,t){var r,i,n=Object.keys(e);this.sortKeys&&n.sort();var o=this.ignoreUndefined?this.countWithoutUndefined(e,n):n.length;if(o<16)this.writeU8(128+o);else if(o<65536)this.writeU8(222),this.writeU16(o);else{if(!(o<4294967296))throw new Error("Too large map object: "+o);this.writeU8(223),this.writeU32(o)}try{for(var s=k(n),a=s.next();!a.done;a=s.next()){var c=a.value,l=e[c];this.ignoreUndefined&&void 0===l||(this.encodeString(c),this.doEncode(l,t+1))}}catch(e){r={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}},e.prototype.encodeExtension=function(e){var t=e.data.length;if(1===t)this.writeU8(212);else if(2===t)this.writeU8(213);else if(4===t)this.writeU8(214);else if(8===t)this.writeU8(215);else if(16===t)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large extension object: "+t);this.writeU8(201),this.writeU32(t)}this.writeI8(e.type),this.writeU8a(e.data)},e.prototype.writeU8=function(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++},e.prototype.writeU8a=function(e){var t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t},e.prototype.writeI8=function(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++},e.prototype.writeU16=function(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2},e.prototype.writeI16=function(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2},e.prototype.writeU32=function(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4},e.prototype.writeI32=function(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4},e.prototype.writeF32=function(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4},e.prototype.writeF64=function(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8},e.prototype.writeU64=function(e){this.ensureBufferSizeToWrite(8),function(e,t,r){var i=r/4294967296,n=r;e.setUint32(t,i),e.setUint32(t+4,n)}(this.view,this.pos,e),this.pos+=8},e.prototype.writeI64=function(e){this.ensureBufferSizeToWrite(8),n(this.view,this.pos,e),this.pos+=8},e}(),N={};function L(e,t){return void 0===t&&(t=N),new O(t.extensionCodec,t.context,t.maxDepth,t.initialBufferSize,t.sortKeys,t.forceFloat32,t.ignoreUndefined,t.forceIntegerToFloat).encode(e)}function P(e){return(e<0?"-":"")+"0x"+Math.abs(e).toString(16).padStart(2,"0")}var D=function(){function e(e,t){void 0===e&&(e=16),void 0===t&&(t=16),this.maxKeyLength=e,this.maxLengthPerKey=t,this.hit=0,this.miss=0,this.caches=[];for(var r=0;r<this.maxKeyLength;r++)this.caches.push([])}return e.prototype.canBeCached=function(e){return e>0&&e<=this.maxKeyLength},e.prototype.find=function(e,t,r){var i,n,o=this.caches[r-1];try{e:for(var s=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(o),a=s.next();!a.done;a=s.next()){for(var c=a.value,l=c.bytes,u=0;u<r;u++)if(l[u]!==e[t+u])continue e;return c.str}}catch(e){i={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return null},e.prototype.store=function(e,t){var r=this.caches[e.length-1],i={bytes:e,str:t};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=i:r.push(i)},e.prototype.decode=function(e,t,r){var i=this.find(e,t,r);if(null!=i)return this.hit++,i;this.miss++;var n=p(e,t,r),o=Uint8Array.prototype.slice.call(e,t,t+r);return this.store(o,n),n},e}(),M=function(e,t){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},x=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=e[r]&&function(t){return new Promise((function(i,n){!function(e,t,r,i){Promise.resolve(i).then((function(t){e({value:t,done:r})}),t)}(i,n,(t=e[r](t)).done,t.value)}))}}},B=function(e){return this instanceof B?(this.v=e,this):new B(e)},U=function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=r.apply(e,t||[]),o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(e){n[e]&&(i[e]=function(t){return new Promise((function(r,i){o.push([e,t,r,i])>1||a(e,t)}))})}function a(e,t){try{(r=n[e](t)).value instanceof B?Promise.resolve(r.value.v).then(c,l):u(o[0][2],r)}catch(e){u(o[0][3],e)}var r}function c(e){a("next",e)}function l(e){a("throw",e)}function u(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}},F=new DataView(new ArrayBuffer(0)),V=new Uint8Array(F.buffer),j=function(){try{F.getInt8(0)}catch(e){return e.constructor}throw new Error("never reached")}(),G=new j("Insufficient data"),H=new D,Q=function(){function e(e,t,r,n,o,s,a,c){void 0===e&&(e=R.defaultCodec),void 0===t&&(t=void 0),void 0===r&&(r=i),void 0===n&&(n=i),void 0===o&&(o=i),void 0===s&&(s=i),void 0===a&&(a=i),void 0===c&&(c=H),this.extensionCodec=e,this.context=t,this.maxStrLength=r,this.maxBinLength=n,this.maxArrayLength=o,this.maxMapLength=s,this.maxExtLength=a,this.keyDecoder=c,this.totalPos=0,this.pos=0,this.view=F,this.bytes=V,this.headByte=-1,this.stack=[]}return e.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=-1,this.stack.length=0},e.prototype.setBuffer=function(e){this.bytes=w(e),this.view=function(e){if(e instanceof ArrayBuffer)return new DataView(e);var t=w(e);return new DataView(t.buffer,t.byteOffset,t.byteLength)}(this.bytes),this.pos=0},e.prototype.appendBuffer=function(e){if(-1!==this.headByte||this.hasRemaining(1)){var t=this.bytes.subarray(this.pos),r=w(e),i=new Uint8Array(t.length+r.length);i.set(t),i.set(r,t.length),this.setBuffer(i)}else this.setBuffer(e)},e.prototype.hasRemaining=function(e){return this.view.byteLength-this.pos>=e},e.prototype.createExtraByteError=function(e){var t=this.view,r=this.pos;return new RangeError("Extra "+(t.byteLength-r)+" of "+t.byteLength+" byte(s) found at buffer["+e+"]")},e.prototype.decode=function(e){this.reinitializeState(),this.setBuffer(e);var t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t},e.prototype.decodeMulti=function(e){return M(this,(function(t){switch(t.label){case 0:this.reinitializeState(),this.setBuffer(e),t.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return t.sent(),[3,1];case 3:return[2]}}))},e.prototype.decodeAsync=function(e){var t,r,i,n,o,s,a,c;return o=this,s=void 0,c=function(){var o,s,a,c,l,u,d,h;return M(this,(function(p){switch(p.label){case 0:o=!1,p.label=1;case 1:p.trys.push([1,6,7,12]),t=x(e),p.label=2;case 2:return[4,t.next()];case 3:if((r=p.sent()).done)return[3,5];if(a=r.value,o)throw this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{s=this.doDecodeSync(),o=!0}catch(e){if(!(e instanceof j))throw e}this.totalPos+=this.pos,p.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return c=p.sent(),i={error:c},[3,12];case 7:return p.trys.push([7,,10,11]),r&&!r.done&&(n=t.return)?[4,n.call(t)]:[3,9];case 8:p.sent(),p.label=9;case 9:return[3,11];case 10:if(i)throw i.error;return[7];case 11:return[7];case 12:if(o){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,s]}throw u=(l=this).headByte,d=l.pos,h=l.totalPos,new RangeError("Insufficient data in parsing "+P(u)+" at "+h+" ("+d+" in the current buffer)")}}))},new((a=void 0)||(a=Promise))((function(e,t){function r(e){try{n(c.next(e))}catch(e){t(e)}}function i(e){try{n(c.throw(e))}catch(e){t(e)}}function n(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(r,i)}n((c=c.apply(o,s||[])).next())}))},e.prototype.decodeArrayStream=function(e){return this.decodeMultiAsync(e,!0)},e.prototype.decodeStream=function(e){return this.decodeMultiAsync(e,!1)},e.prototype.decodeMultiAsync=function(e,t){return U(this,arguments,(function(){var r,i,n,o,s,a,c,l,u;return M(this,(function(d){switch(d.label){case 0:r=t,i=-1,d.label=1;case 1:d.trys.push([1,13,14,19]),n=x(e),d.label=2;case 2:return[4,B(n.next())];case 3:if((o=d.sent()).done)return[3,12];if(s=o.value,t&&0===i)throw this.createExtraByteError(this.totalPos);this.appendBuffer(s),r&&(i=this.readArraySize(),r=!1,this.complete()),d.label=4;case 4:d.trys.push([4,9,,10]),d.label=5;case 5:return[4,B(this.doDecodeSync())];case 6:return[4,d.sent()];case 7:return d.sent(),0==--i?[3,8]:[3,5];case 8:return[3,10];case 9:if(!((a=d.sent())instanceof j))throw a;return[3,10];case 10:this.totalPos+=this.pos,d.label=11;case 11:return[3,2];case 12:return[3,19];case 13:return c=d.sent(),l={error:c},[3,19];case 14:return d.trys.push([14,,17,18]),o&&!o.done&&(u=n.return)?[4,B(u.call(n))]:[3,16];case 15:d.sent(),d.label=16;case 16:return[3,18];case 17:if(l)throw l.error;return[7];case 18:return[7];case 19:return[2]}}))}))},e.prototype.doDecodeSync=function(){e:for(;;){var e=this.readHeadByte(),t=void 0;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){if(0!=(i=e-128)){this.pushMapState(i),this.complete();continue e}t={}}else if(e<160){if(0!=(i=e-144)){this.pushArrayState(i),this.complete();continue e}t=[]}else{var r=e-160;t=this.decodeUtf8String(r,0)}else if(192===e)t=null;else if(194===e)t=!1;else if(195===e)t=!0;else if(202===e)t=this.readF32();else if(203===e)t=this.readF64();else if(204===e)t=this.readU8();else if(205===e)t=this.readU16();else if(206===e)t=this.readU32();else if(207===e)t=this.readU64();else if(208===e)t=this.readI8();else if(209===e)t=this.readI16();else if(210===e)t=this.readI32();else if(211===e)t=this.readI64();else if(217===e)r=this.lookU8(),t=this.decodeUtf8String(r,1);else if(218===e)r=this.lookU16(),t=this.decodeUtf8String(r,2);else if(219===e)r=this.lookU32(),t=this.decodeUtf8String(r,4);else if(220===e){if(0!==(i=this.readU16())){this.pushArrayState(i),this.complete();continue e}t=[]}else if(221===e){if(0!==(i=this.readU32())){this.pushArrayState(i),this.complete();continue e}t=[]}else if(222===e){if(0!==(i=this.readU16())){this.pushMapState(i),this.complete();continue e}t={}}else if(223===e){if(0!==(i=this.readU32())){this.pushMapState(i),this.complete();continue e}t={}}else if(196===e){var i=this.lookU8();t=this.decodeBinary(i,1)}else if(197===e)i=this.lookU16(),t=this.decodeBinary(i,2);else if(198===e)i=this.lookU32(),t=this.decodeBinary(i,4);else if(212===e)t=this.decodeExtension(1,0);else if(213===e)t=this.decodeExtension(2,0);else if(214===e)t=this.decodeExtension(4,0);else if(215===e)t=this.decodeExtension(8,0);else if(216===e)t=this.decodeExtension(16,0);else if(199===e)i=this.lookU8(),t=this.decodeExtension(i,1);else if(200===e)i=this.lookU16(),t=this.decodeExtension(i,2);else{if(201!==e)throw new E("Unrecognized type byte: "+P(e));i=this.lookU32(),t=this.decodeExtension(i,4)}this.complete();for(var n=this.stack;n.length>0;){var o=n[n.length-1];if(0===o.type){if(o.array[o.position]=t,o.position++,o.position!==o.size)continue e;n.pop(),t=o.array}else{if(1===o.type){if("string"!=(s=typeof t)&&"number"!==s)throw new E("The type of key must be string or number but "+typeof t);if("__proto__"===t)throw new E("The key __proto__ is not allowed");o.key=t,o.type=2;continue e}if(o.map[o.key]=t,o.readCount++,o.readCount!==o.size){o.key=null,o.type=1;continue e}n.pop(),t=o.map}}return t}var s},e.prototype.readHeadByte=function(){return-1===this.headByte&&(this.headByte=this.readU8()),this.headByte},e.prototype.complete=function(){this.headByte=-1},e.prototype.readArraySize=function(){var e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:if(e<160)return e-144;throw new E("Unrecognized array type byte: "+P(e))}},e.prototype.pushMapState=function(e){if(e>this.maxMapLength)throw new E("Max length exceeded: map length ("+e+") > maxMapLengthLength ("+this.maxMapLength+")");this.stack.push({type:1,size:e,key:null,readCount:0,map:{}})},e.prototype.pushArrayState=function(e){if(e>this.maxArrayLength)throw new E("Max length exceeded: array length ("+e+") > maxArrayLength ("+this.maxArrayLength+")");this.stack.push({type:0,size:e,array:new Array(e),position:0})},e.prototype.decodeUtf8String=function(e,t){var r;if(e>this.maxStrLength)throw new E("Max length exceeded: UTF-8 byte length ("+e+") > maxStrLength ("+this.maxStrLength+")");if(this.bytes.byteLength<this.pos+t+e)throw G;var i,n=this.pos+t;return i=this.stateIsMapKey()&&(null===(r=this.keyDecoder)||void 0===r?void 0:r.canBeCached(e))?this.keyDecoder.decode(this.bytes,n,e):e>m?function(e,t,r){var i=e.subarray(t,t+r);return g.decode(i)}(this.bytes,n,e):p(this.bytes,n,e),this.pos+=t+e,i},e.prototype.stateIsMapKey=function(){return this.stack.length>0&&1===this.stack[this.stack.length-1].type},e.prototype.decodeBinary=function(e,t){if(e>this.maxBinLength)throw new E("Max length exceeded: bin length ("+e+") > maxBinLength ("+this.maxBinLength+")");if(!this.hasRemaining(e+t))throw G;var r=this.pos+t,i=this.bytes.subarray(r,r+e);return this.pos+=t+e,i},e.prototype.decodeExtension=function(e,t){if(e>this.maxExtLength)throw new E("Max length exceeded: ext length ("+e+") > maxExtLength ("+this.maxExtLength+")");var r=this.view.getInt8(this.pos+t),i=this.decodeBinary(e,t+1);return this.extensionCodec.decode(i,r,this.context)},e.prototype.lookU8=function(){return this.view.getUint8(this.pos)},e.prototype.lookU16=function(){return this.view.getUint16(this.pos)},e.prototype.lookU32=function(){return this.view.getUint32(this.pos)},e.prototype.readU8=function(){var e=this.view.getUint8(this.pos);return this.pos++,e},e.prototype.readI8=function(){var e=this.view.getInt8(this.pos);return this.pos++,e},e.prototype.readU16=function(){var e=this.view.getUint16(this.pos);return this.pos+=2,e},e.prototype.readI16=function(){var e=this.view.getInt16(this.pos);return this.pos+=2,e},e.prototype.readU32=function(){var e=this.view.getUint32(this.pos);return this.pos+=4,e},e.prototype.readI32=function(){var e=this.view.getInt32(this.pos);return this.pos+=4,e},e.prototype.readU64=function(){var e,t,r=(e=this.view,t=this.pos,4294967296*e.getUint32(t)+e.getUint32(t+4));return this.pos+=8,r},e.prototype.readI64=function(){var e=o(this.view,this.pos);return this.pos+=8,e},e.prototype.readF32=function(){var e=this.view.getFloat32(this.pos);return this.pos+=4,e},e.prototype.readF64=function(){var e=this.view.getFloat64(this.pos);return this.pos+=8,e},e}(),W={};function q(e,t){return void 0===t&&(t=W),new Q(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decode(e)}function z(e,t){return void 0===t&&(t=W),new Q(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeMulti(e)}var Z=function(e,t){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},Y=function(e){return this instanceof Y?(this.v=e,this):new Y(e)},K=function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=r.apply(e,t||[]),o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(e){n[e]&&(i[e]=function(t){return new Promise((function(r,i){o.push([e,t,r,i])>1||a(e,t)}))})}function a(e,t){try{(r=n[e](t)).value instanceof Y?Promise.resolve(r.value.v).then(c,l):u(o[0][2],r)}catch(e){u(o[0][3],e)}var r}function c(e){a("next",e)}function l(e){a("throw",e)}function u(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}};function $(e){if(null==e)throw new Error("Assertion Failure: value must not be null nor undefined")}function J(e){return null!=e[Symbol.asyncIterator]?e:function(e){return K(this,arguments,(function(){var t,r,i,n;return Z(this,(function(o){switch(o.label){case 0:t=e.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,Y(t.read())];case 3:return r=o.sent(),i=r.done,n=r.value,i?[4,Y(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return $(n),[4,Y(n)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}(e)}function X(e,t){return void 0===t&&(t=W),r=this,i=void 0,o=function(){var r;return function(e,t){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}(this,(function(i){return r=J(e),[2,new Q(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeAsync(r)]}))},new((n=void 0)||(n=Promise))((function(e,t){function s(e){try{c(o.next(e))}catch(e){t(e)}}function a(e){try{c(o.throw(e))}catch(e){t(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n((function(e){e(r)}))).then(s,a)}c((o=o.apply(r,i||[])).next())}));var r,i,n,o}function ee(e,t){void 0===t&&(t=W);var r=J(e);return new Q(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeArrayStream(r)}function te(e,t){void 0===t&&(t=W);var r=J(e);return new Q(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeStream(r)}function re(e,t){return void 0===t&&(t=W),te(e,t)}return t}()})),of=Math.min;Q({target:"Array",proto:!0},{copyWithin:[].copyWithin||function(e,t){var r=Ae(this),i=Y(r.length),n=J(e,i),o=J(t,i),s=arguments.length>2?arguments[2]:void 0,a=of((void 0===s?i:J(s,i))-o,i-n),c=1;for(o<n&&n<o+a&&(c=-1,o+=a-1,n+=a-1);a-- >0;)o in r?r[n]=r[o]:delete r[n],n+=c,o+=c;return r}});var sf=Ye("Array").copyWithin,af=Array.prototype,cf=function(e){var t=e.copyWithin;return e===af||e instanceof Array&&t===af.copyWithin?sf:t},lf=Tt.every;Q({target:"Array",proto:!0,forced:qr("every")},{every:function(e){return lf(this,e,arguments.length>1?arguments[1]:void 0)}});var uf=Ye("Array").every,df=Array.prototype,hf=function(e){var t=e.every;return e===df||e instanceof Array&&t===df.every?uf:t},pf=et.getWeakData,ff=xt.set,gf=xt.getterFor,mf=Tt.find,_f=Tt.findIndex,vf=0,Ef=function(e){return e.frozen||(e.frozen=new Af)},Af=function(){this.entries=[]},yf=function(e,t){return mf(e.entries,(function(e){return e[0]===t}))};Af.prototype={get:function(e){var t=yf(this,e);if(t)return t[1]},has:function(e){return!!yf(this,e)},set:function(e,t){var r=yf(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=_f(this.entries,(function(t){return t[0]===e}));return~t&&this.entries.splice(t,1),!!~t}};var Sf={getConstructor:function(e,t,r,i){var n=e((function(e,o){_t(e,n,t),ff(e,{type:t,id:vf++,frozen:void 0}),null!=o&&mt(o,e[i],e,r)})),o=gf(t),s=function(e,t,r){var i=o(e),n=pf(U(t),!0);return!0===n?Ef(i).set(t,r):n[i.id]=r,e};return $t(n.prototype,{delete:function(e){var t=o(this);if(!v(e))return!1;var r=pf(e);return!0===r?Ef(t).delete(e):r&&y(r,t.id)&&delete r[t.id]},has:function(e){var t=o(this);if(!v(e))return!1;var r=pf(e);return!0===r?Ef(t).has(e):r&&y(r,t.id)}}),$t(n.prototype,r?{get:function(e){var t=o(this);if(v(e)){var r=pf(e);return!0===r?Ef(t).get(e):r?r[t.id]:void 0}},set:function(e,t){return s(this,e,t)}}:{add:function(e){return s(this,e,!0)}}),n}},Cf=(i((function(e){var t,r=xt.enforce,i=!o.ActiveXObject&&"ActiveXObject"in o,n=Object.isExtensible,s=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},a=e.exports=jt("WeakMap",s,Sf);if(Rt&&i){t=Sf.getConstructor(s,"WeakMap",!0),et.REQUIRED=!0;var c=a.prototype,l=c.delete,u=c.has,d=c.get,h=c.set;$t(c,{delete:function(e){if(v(e)&&!n(e)){var i=r(this);return i.frozen||(i.frozen=new t),l.call(this,e)||i.frozen.delete(e)}return l.call(this,e)},has:function(e){if(v(e)&&!n(e)){var i=r(this);return i.frozen||(i.frozen=new t),u.call(this,e)||i.frozen.has(e)}return u.call(this,e)},get:function(e){if(v(e)&&!n(e)){var i=r(this);return i.frozen||(i.frozen=new t),u.call(this,e)?d.call(this,e):i.frozen.get(e)}return d.call(this,e)},set:function(e,i){if(v(e)&&!n(e)){var o=r(this);o.frozen||(o.frozen=new t),u.call(this,e)?h.call(this,e,i):o.frozen.set(e,i)}else h.call(this,e,i);return this}})}})),Math.min),Tf=[].lastIndexOf,bf=!!Tf&&1/[1].lastIndexOf(1,-0)<0,If=qr("lastIndexOf"),Rf=bf||If?function(e){if(bf)return Tf.apply(this,arguments)||0;var t=_(this),r=Y(t.length),i=r-1;for(arguments.length>1&&(i=Cf(i,z(arguments[1]))),i<0&&(i=r+i);i>=0;i--)if(i in t&&t[i]===e)return i||0;return-1}:Tf;Q({target:"Array",proto:!0,forced:Rf!==[].lastIndexOf},{lastIndexOf:Rf});var wf=Ye("Array").lastIndexOf,kf=Array.prototype,Of=function(e){var t=e.lastIndexOf;return e===kf||e instanceof Array&&t===kf.lastIndexOf?wf:t};const Nf=()=>function(e){var t;const r=vo(t=window.atob(e).split("")).call(t,e=>e.charCodeAt(0));return new Uint8Array(r,0,r.length/Uint8Array.BYTES_PER_ELEMENT)}("AGFzbQEAAAABMAlgA39/fwF/YAF/AGACf38AYAF/AX9gAn9/AX9gA39/fwBgBH9/f38AYAABf2AAAAI6AgNlbnYWZW1zY3JpcHRlbl9yZXNpemVfaGVhcAADA2VudhVlbXNjcmlwdGVuX21lbWNweV9iaWcAAAMjIggAAAAAAQEDAQEEBAQEAQEGAQYCBQUAAgAHAwEDAAIHAQMEBQFwAQYGBQYBAYACgAIGCQF/AUHQ48ACCweUAQoGbWVtb3J5AgARX193YXNtX2NhbGxfY3RvcnMAAhlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQAGbWFsbG9jABwEZnJlZQAdEF9fZXJybm9fbG9jYXRpb24AGwx6bGliQ29tcHJlc3MAGglzdGFja1NhdmUAIQxzdGFja1Jlc3RvcmUAIgpzdGFja0FsbG9jACMJCwEAQQELBRgZDA0PCq6FAiIDAAELpQcBBH8gAEH//wNxIQMgAEEQdiEEQQEhACACQQFGBEAgAyABLQAAaiIAQfH/A2sgACAAQfD/A0sbIgAgBGoiA0EQdCIEQYCAPGogBCADQfD/A0sbIAByDwsgAQR/IAJBEE8EQAJAAkACQCACQa8rSwRAA0AgAkGwK2shAkHbAiEFIAEhAANAIAMgAC0AAGoiAyAEaiADIAAtAAFqIgNqIAMgAC0AAmoiA2ogAyAALQADaiIDaiADIAAtAARqIgNqIAMgAC0ABWoiA2ogAyAALQAGaiIDaiADIAAtAAdqIgNqIAMgAC0ACGoiA2ogAyAALQAJaiIDaiADIAAtAApqIgNqIAMgAC0AC2oiA2ogAyAALQAMaiIDaiADIAAtAA1qIgNqIAMgAC0ADmoiA2ogAyAALQAPaiIDaiEEIABBEGohACAFQQFrIgUNAAsgBEHx/wNwIQQgA0Hx/wNwIQMgAUGwK2ohASACQa8rSw0ACyACRQ0DIAJBEEkNAQsDQCADIAEtAABqIgAgBGogACABLQABaiIAaiAAIAEtAAJqIgBqIAAgAS0AA2oiAGogACABLQAEaiIAaiAAIAEtAAVqIgBqIAAgAS0ABmoiAGogACABLQAHaiIAaiAAIAEtAAhqIgBqIAAgAS0ACWoiAGogACABLQAKaiIAaiAAIAEtAAtqIgBqIAAgAS0ADGoiAGogACABLQANaiIAaiAAIAEtAA5qIgBqIAAgAS0AD2oiA2ohBCABQRBqIQEgAkEQayICQQ9LDQALIAJFDQELIAJBAWshBiACQQNxIgUEQCABIQADQCACQQFrIQIgAyAALQAAaiIDIARqIQQgAEEBaiIBIQAgBUEBayIFDQALCyAGQQNJDQADQCADIAEtAABqIgAgAS0AAWoiBSABLQACaiIGIAEtAANqIgMgBiAFIAAgBGpqamohBCABQQRqIQEgAkEEayICDQALCyAEQfH/A3AhBCADQfH/A3AhAwsgBEEQdCADcg8LAkAgAkUNACACQQFrIQYgAkEDcSIFBEAgASEAA0AgAkEBayECIAMgAC0AAGoiAyAEaiEEIABBAWoiASEAIAVBAWsiBQ0ACwsgBkEDSQ0AA0AgAyABLQAAaiIAIAEtAAFqIgUgAS0AAmoiBiABLQADaiIDIAYgBSAAIARqampqIQQgAUEEaiEBIAJBBGsiAg0ACwsgBEHx/wNwQRB0IANB8f8DayADIANB8P8DSxtyBSAACwsKACAAIAEgAhADC4UJAQJ/IAFFBEBBAA8LIABBf3MhAAJAIAJFDQAgAUEDcUUNACABLQAAIABB/wFxc0ECdEGACGooAgAgAEEIdnMhACACQQFrIgRBACABQQFqIgNBA3EbRQRAIAMhASAEIQIMAQsgAS0AASAAQf8BcXNBAnRBgAhqKAIAIABBCHZzIQAgAUECaiEDAkAgAkECayIERQ0AIANBA3FFDQAgAS0AAiAAQf8BcXNBAnRBgAhqKAIAIABBCHZzIQAgAUEDaiEDAkAgAkEDayIERQ0AIANBA3FFDQAgAS0AAyAAQf8BcXNBAnRBgAhqKAIAIABBCHZzIQAgAkEEayECIAFBBGohAQwCCyADIQEgBCECDAELIAMhASAEIQILIAJBH0sEQANAIAEoAhwgASgCGCABKAIUIAEoAhAgASgCDCABKAIIIAEoAgQgASgCACAAcyIAQQZ2QfwHcUGAGGooAgAgAEH/AXFBAnRBgCBqKAIAcyAAQQ52QfwHcUGAEGooAgBzIABBFnZB/AdxQYAIaigCAHNzIgBBBnZB/AdxQYAYaigCACAAQf8BcUECdEGAIGooAgBzIABBDnZB/AdxQYAQaigCAHMgAEEWdkH8B3FBgAhqKAIAc3MiAEEGdkH8B3FBgBhqKAIAIABB/wFxQQJ0QYAgaigCAHMgAEEOdkH8B3FBgBBqKAIAcyAAQRZ2QfwHcUGACGooAgBzcyIAQQZ2QfwHcUGAGGooAgAgAEH/AXFBAnRBgCBqKAIAcyAAQQ52QfwHcUGAEGooAgBzIABBFnZB/AdxQYAIaigCAHNzIgBBBnZB/AdxQYAYaigCACAAQf8BcUECdEGAIGooAgBzIABBDnZB/AdxQYAQaigCAHMgAEEWdkH8B3FBgAhqKAIAc3MiAEEGdkH8B3FBgBhqKAIAIABB/wFxQQJ0QYAgaigCAHMgAEEOdkH8B3FBgBBqKAIAcyAAQRZ2QfwHcUGACGooAgBzcyIAQQZ2QfwHcUGAGGooAgAgAEH/AXFBAnRBgCBqKAIAcyAAQQ52QfwHcUGAEGooAgBzIABBFnZB/AdxQYAIaigCAHNzIgBBBnZB/AdxQYAYaigCACAAQf8BcUECdEGAIGooAgBzIABBDnZB/AdxQYAQaigCAHMgAEEWdkH8B3FBgAhqKAIAcyEAIAFBIGohASACQSBrIgJBH0sNAAsLIAJBA0sEQANAIAEoAgAgAHMiAEEGdkH8B3FBgBhqKAIAIABB/wFxQQJ0QYAgaigCAHMgAEEOdkH8B3FBgBBqKAIAcyAAQRZ2QfwHcUGACGooAgBzIQAgAUEEaiEBIAJBBGsiAkEDSw0ACwsCQCACRQ0AIAJBAXEEfyABLQAAIABB/wFxc0ECdEGACGooAgAgAEEIdnMhACABQQFqIQEgAkEBawUgAgshAyACQQFGDQADQCABLQABIAEtAAAgAEH/AXFzQQJ0QYAIaigCACAAQQh2cyIAQf8BcXNBAnRBgAhqKAIAIABBCHZzIQAgAUECaiEBIANBAmsiAw0ACwsgAEF/cwsKACAAIAEgAhAFC9wEAQN/AkBByN8ALQAAQTFHDQAgAEUNACAAQQA2AhggACgCICIBRQRAIABBADYCKCAAQQE2AiBBASEBCyAAKAIkRQRAIABBAjYCJAsgACgCKEEBQcQtIAERAAAiAUUNACAAIAE2AhwgAUEPNgIwIAFBADYCHCABQQA2AhggAUEqNgIEIAEgADYCACABQQs2AlAgAUGAgAI2AiwgAUH//wE2AjQgAUGAEDYCTCABQQQ2AlggAUH/DzYCVCABIAAoAihBgIACQQIgACgCIBEAADYCOCABIAAoAiggASgCLEECIAAoAiARAAA2AkAgACgCKCABKAJMQQIgACgCIBEAACECIAFBADYCwC0gASACNgJEIAFBgAg2ApwtIAEgACgCKEGACEEEIAAoAiARAAAiAjYCCCABIAEoApwtIgNBAnQ2AgwCQAJAIAEoAjhFDQAgASgCQEUNACACRQ0AIAEoAkQNAQsgAUGaBTYCBCAAQbjfACgCADYCGCAAEAgPCyABQQA2AogBIAFBCTYChAEgAUEIOgAkIAEgAiADQQNsajYCmC0gASACIANBfnFqNgKkLSAAEAkNACAAKAIcIgAgACgCLEEBdDYCPCAAKAJEIgEgACgCTEEBdEECayIDakEAOwEAIAEgAxAgIABBADYCtC0gAEKAgICAIDcCdCAAQgA3AmggAEKAgICAIDcCXCAAQQA2AkggACAAKAKEAUEMbCIBQYTIAGovAQA2ApABIAAgAUGAyABqLwEANgKMASAAIAFBgsgAai8BADYCgAEgACABQYbIAGovAQA2AnwLC6kCAQN/AkAgAEUNACAAKAIgRQ0AIAAoAiQiA0UNACAAKAIcIgFFDQAgASgCACAARw0AAkACQCABKAIEIgJBOWsOOQECAgICAgICAgICAgECAgIBAgICAgICAgICAgICAgICAgIBAgICAgICAgICAgIBAgICAgICAgICAQALIAJBmgVGDQAgAkEqRw0BCwJ/An8CfyABKAIIIgIEQCAAKAIoIAIgAxECACAAKAIcIQELIAEoAkQiAgsEQCAAKAIoIAIgACgCJBECACAAKAIcIQELIAEoAkAiAgsEQCAAKAIoIAIgACgCJBECACAAKAIcIQELIAEoAjgiAgsEQCAAKAIoIAIgACgCJBECACAAKAIcIQELIAAoAiggASAAKAIkEQIAIABBADYCHAsLlgIBA39BfiECAkAgAEUNACAAKAIgRQ0AIAAoAiRFDQAgACgCHCIBRQ0AIAEoAgAgAEcNAAJAAkAgASgCBCIDQTlrDjkBAgICAgICAgICAgIBAgICAQICAgICAgICAgICAgICAgICAQICAgICAgICAgICAQICAgICAgICAgEACyADQZoFRg0AIANBKkcNAQsgAEECNgIsIABBADYCCCAAQgA3AhQgAUEANgIUIAEgASgCCDYCECABKAIYIgJBf0wEQCABQQAgAmsiAjYCGAsgAUE5QSpB8QAgAhsgAkECRhs2AgQgAAJ/IAJBAkYEQEEAQQBBABAGDAELQQBBAEEAEAQLNgIwQQAhAiABQQA2AiggARAQCyACC9wIAQt/IAAoAiwiB0GGAmshCyAAKAJ0IQUgByEBA0AgACgCPCAFayAAKAJsIghrIQYgASALaiAITQRAIAAoAjgiASABIAdqIAcgBmsQHxogACAAKAJwIAdrNgJwIAAgACgCbCAHayIINgJsIAAgACgCXCAHazYCXCAAKAJMIgRBAWshCiAAKAJEIARBAXRqIQMgACgCLCEBIARBA3EiAgRAA0AgA0ECayIDQQAgAy8BACIFIAFrIgkgBSAJSRs7AQAgBEEBayEEIAJBAWsiAg0ACwsgCkEDTwRAA0AgA0ECayICQQAgAi8BACICIAFrIgUgAiAFSRs7AQAgA0EEayICQQAgAi8BACICIAFrIgUgAiAFSRs7AQAgA0EGayICQQAgAi8BACICIAFrIgUgAiAFSRs7AQAgA0EIayIDQQAgAy8BACICIAFrIgUgAiAFSRs7AQAgBEEEayIEDQALCyABQQFrIQogACgCQCABQQF0aiEDIAEhBCABQQNxIgIEQANAIANBAmsiA0EAIAMvAQAiBSABayIJIAUgCUkbOwEAIARBAWshBCACQQFrIgINAAsLIApBA08EQANAIANBAmsiAkEAIAIvAQAiAiABayIFIAIgBUkbOwEAIANBBGsiAkEAIAIvAQAiAiABayIFIAIgBUkbOwEAIANBBmsiAkEAIAIvAQAiAiABayIFIAIgBUkbOwEAIANBCGsiA0EAIAMvAQAiAiABayIFIAIgBUkbOwEAIARBBGsiBA0ACwsgBiAHaiEGCwJAIAAoAgAiASgCBCIERQ0AIAAoAnQhAiAGIAQgBCAGSxsiAwRAIAAoAjghBSABIAQgA2s2AgQgBSAIaiACaiABKAIAIAMQHyEEAkACQAJAIAEoAhwoAhhBAWsOAgABAgsgASABKAIwIAQgAxAENgIwDAELIAEgASgCMCAEIAMQBjYCMAsgASABKAIAIANqNgIAIAEgASgCCCADajYCCCAAKAJ0IQILIAAgAiADaiIFNgJ0AkAgACgCtC0iAyAFakEDSQ0AIAAgACgCOCIJIAAoAmwgA2siAWoiBC0AACICNgJIIAAgACgCVCIIIAQtAAEgAiAAKAJYIgZ0c3EiBDYCSANAIANFDQEgACABIAlqLQACIAQgBnRzIAhxIgQ2AkggACgCQCAAKAI0IAFxQQF0aiAAKAJEIARBAXRqIgIvAQA7AQAgAiABOwEAIAAgA0EBayIDNgK0LSABQQFqIQEgAyAFakECSw0ACwsgBUGFAksNACAAKAIAKAIERQ0AIAAoAiwhAQwBCwsCQCAAKAI8IgQgACgCwC0iAU0NACAAKAJ0IAAoAmxqIgMgAUsEQCAAKAI4IANqIAQgA2siAUGCAiABQYICSRsiARAgIAAgASADajYCwC0PCyADQYICaiIDIAFNDQAgACgCOCABaiAEIAFrIgQgAyABayIBIAEgBEsbIgEQICAAIAAoAsAtIAFqNgLALQsLsSwBCn8CQCAARQ0AIAAoAiBFDQAgACgCJEUNACAAKAIcIgFFDQAgASgCACAARw0AAkACQCABKAIEIgNBOWsOOQECAgICAgICAgICAgECAgIBAgICAgICAgICAgICAgICAgIBAgICAgICAgICAgIBAgICAgICAgICAQALIANBmgVGDQAgA0EqRw0BCwJAAkAgACgCDEUNACAAKAIEIgIEQCAAKAIARQ0BCyADQZoFRw0BCyAAQbDfACgCADYCGA8LIAAoAhBFBEAgAEG83wAoAgA2AhgPCyABKAIoIQUgAUEDNgIoAkAgASgCFARAIAEQEwJAIAAoAhAiAyABKAIUIgQgAyAESRsiAkUNACAAKAIMIAEoAhAgAhAfGiAAIAAoAgwgAmo2AgwgASABKAIQIAJqNgIQIAAgACgCFCACajYCFCAAIAAoAhAgAmsiAzYCECABIAEoAhQgAmsiBDYCFCAEDQAgASABKAIINgIQQQAhBAsgAwRAIAEoAgQhAwwCCyABQX82AigPCyACDQAgBUEBdEF3QQAgBUEEShtqQQZIDQAgAEG83wAoAgA2AhgPCwJAAkACQAJAAn8CQAJAAkACQAJAAkAgA0EqRwRAIANBmgVHDQEgACgCBEUNAiAAQbzfACgCADYCGA8LIAEoAjBBDHRBgPABayEDQQAhAgJAIAEoAogBQQFKDQAgASgChAEiBUECSA0AQcAAIQIgBUEGSA0AQYABQcABIAVBBkYbIQILIAEgBEEBajYCFCABKAIIIARqIAIgA3IiAkEgciACIAEoAmwbIgJBCHY6AAAgASABKAIUIgNBAWo2AhQgAyABKAIIaiACQR9wIAJyQR9zOgAAIAEoAmwEQCAAKAIwIQIgASABKAIUIgNBAWo2AhQgAyABKAIIaiACQRh2OgAAIAEgASgCFCIDQQFqNgIUIAMgASgCCGogAkEQdjoAACAAKAIwIQIgASABKAIUIgNBAWo2AhQgAyABKAIIaiACQQh2OgAAIAEgASgCFCIDQQFqNgIUIAMgASgCCGogAjoAAAsgAEEAQQBBABAENgIwIAFB8QA2AgQgACgCHCICEBMCQCAAKAIQIgMgAigCFCIEIAMgBEkbIgNFDQAgACgCDCACKAIQIAMQHxogACAAKAIMIANqNgIMIAIgAigCECADajYCECAAIAAoAhQgA2o2AhQgACAAKAIQIANrNgIQIAIgAigCFCADayIDNgIUIAMNACACIAIoAgg2AhALIAEoAhQNBCABKAIEIQMLAkACQAJAAkACQAJAAkAgA0E5RgR/IABBAEEAQQAQBjYCMCABIAEoAhQiAkEBajYCFCACIAEoAghqQR86AAAgASABKAIUIgJBAWo2AhQgAiABKAIIakGLAToAACABIAEoAhQiAkEBajYCFCACIAEoAghqQQg6AAAgASgCHCICDQIgASABKAIUIgJBAWo2AhQgAiABKAIIakEAOgAAIAEgASgCFCICQQFqNgIUIAIgASgCCGpBADoAACABIAEoAhQiAkEBajYCFCACIAEoAghqQQA6AAAgASABKAIUIgJBAWo2AhQgAiABKAIIakEAOgAAIAEgASgCFCICQQFqNgIUIAIgASgCCGpBADoAAEECIQIgASgChAEiA0EJRwRAQQQgASgCiAFBAUpBAnQgA0ECSBshAgsgASABKAIUIgNBAWo2AhQgAyABKAIIaiACOgAAIAEgASgCFCICQQFqNgIUIAIgASgCCGpBAzoAACABQfEANgIEIAAoAhwiAhATAkAgACgCECIDIAIoAhQiBCADIARJGyIDRQ0AIAAoAgwgAigCECADEB8aIAAgACgCDCADajYCDCACIAIoAhAgA2o2AhAgACAAKAIUIANqNgIUIAAgACgCECADazYCECACIAIoAhQgA2siAzYCFCADDQAgAiACKAIINgIQCyABKAIUDQEgASgCBAUgAwtBxQBrDiMCBgYGAwYGBgYGBgYGBgYGBgYGBgYGBAYGBgYGBgYGBgYGBQYLIAFBfzYCKA8LIAIoAiQhAyACKAIcIQQgAigCECEFIAIoAiwhBiACKAIAIQggASABKAIUIgdBAWo2AhRBAiECIAcgASgCCGogBkEAR0EBdCAIQQBHciAFQQBHQQJ0ciAEQQBHQQN0ciADQQBHQQR0cjoAACABKAIcKAIEIQMgASABKAIUIgRBAWo2AhQgBCABKAIIaiADOgAAIAEoAhwoAgQhAyABIAEoAhQiBEEBajYCFCAEIAEoAghqIANBCHY6AAAgASgCHC8BBiEDIAEgASgCFCIEQQFqNgIUIAQgASgCCGogAzoAACABKAIcLQAHIQMgASABKAIUIgRBAWo2AhQgBCABKAIIaiADOgAAIAEoAoQBIgNBCUcEQEEEIAEoAogBQQFKQQJ0IANBAkgbIQILIAEgASgCFCIDQQFqNgIUIAMgASgCCGogAjoAACABKAIcKAIMIQIgASABKAIUIgNBAWo2AhQgAyABKAIIaiACOgAAIAEoAhwiAigCEAR/IAIoAhQhAiABIAEoAhQiA0EBajYCFCADIAEoAghqIAI6AAAgASgCHCgCFCECIAEgASgCFCIDQQFqNgIUIAMgASgCCGogAkEIdjoAACABKAIcBSACCygCLARAIAAgACgCMCABKAIIIAEoAhQQBjYCMAsgAUHFADYCBCABQQA2AiALIAEoAhwiBCgCECIDBEAgASgCFCICIAQvARQgASgCICIGayIFaiABKAIMIgRLBEADQCABKAIIIAJqIAMgBmogBCACayIEEB8aIAEgASgCDCIDNgIUAkAgAiADTw0AIAEoAhwoAixFDQAgACAAKAIwIAEoAgggAmogAyACaxAGNgIwCyABIAEoAiAgBGo2AiAgACgCHCICEBMCQCAAKAIQIgMgAigCFCIGIAMgBkkbIgNFDQAgACgCDCACKAIQIAMQHxogACAAKAIMIANqNgIMIAIgAigCECADajYCECAAIAAoAhQgA2o2AhQgACAAKAIQIANrNgIQIAIgAigCFCADayIDNgIUIAMNACACIAIoAgg2AhALIAEoAhQEQCABQX82AigPCyABKAIgIQYgASgCHCgCECEDQQAhAiAFIARrIgUgASgCDCIESw0ACwsgASgCCCACaiADIAZqIAUQHxogASABKAIUIAVqIgM2AhQCQCACIANPDQAgASgCHCgCLEUNACAAIAAoAjAgASgCCCACaiADIAJrEAY2AjALIAFBADYCIAsgAUHJADYCBAsgASgCHCgCHARAIAEoAhQiAiEFA0ACQCACIAEoAgxHDQACQCACIAVNDQAgASgCHCgCLEUNACAAIAAoAjAgASgCCCAFaiACIAVrEAY2AjALIAAoAhwiAhATAkAgACgCECIDIAIoAhQiBCADIARJGyIDRQ0AIAAoAgwgAigCECADEB8aIAAgACgCDCADajYCDCACIAIoAhAgA2o2AhAgACAAKAIUIANqNgIUIAAgACgCECADazYCECACIAIoAhQgA2siAzYCFCADDQAgAiACKAIINgIQC0EAIQJBACEFIAEoAhRFDQAgAUF/NgIoDwsgASgCHCgCHCEDIAEgASgCICIEQQFqNgIgIAMgBGotAAAhAyABIAJBAWo2AhQgASgCCCACaiADOgAAIAMEQCABKAIUIQIMAQsLAkAgASgCHCgCLEUNACABKAIUIgIgBU0NACAAIAAoAjAgASgCCCAFaiACIAVrEAY2AjALIAFBADYCIAsgAUHbADYCBAsCQCABKAIcKAIkRQ0AIAEoAhQiAiEFA0ACQCACIAEoAgxHDQACQCACIAVNDQAgASgCHCgCLEUNACAAIAAoAjAgASgCCCAFaiACIAVrEAY2AjALIAAoAhwiAhATAkAgACgCECIDIAIoAhQiBCADIARJGyIDRQ0AIAAoAgwgAigCECADEB8aIAAgACgCDCADajYCDCACIAIoAhAgA2o2AhAgACAAKAIUIANqNgIUIAAgACgCECADazYCECACIAIoAhQgA2siAzYCFCADDQAgAiACKAIINgIQC0EAIQJBACEFIAEoAhRFDQAgAUF/NgIoDwsgASgCHCgCJCEDIAEgASgCICIEQQFqNgIgIAMgBGotAAAhAyABIAJBAWo2AhQgASgCCCACaiADOgAAIAMEQCABKAIUIQIMAQsLIAEoAhwoAixFDQAgASgCFCICIAVNDQAgACAAKAIwIAEoAgggBWogAiAFaxAGNgIwCyABQecANgIECyABKAIcKAIsBEAgASgCDCABKAIUIgJBAmpJBEAgACgCHCICEBMCQCAAKAIQIgMgAigCFCIEIAMgBEkbIgNFDQAgACgCDCACKAIQIAMQHxogACAAKAIMIANqNgIMIAIgAigCECADajYCECAAIAAoAhQgA2o2AhQgACAAKAIQIANrNgIQIAIgAigCFCADayIDNgIUIAMNACACIAIoAgg2AhALIAEoAhQNBUEAIQILIAAoAjAhAyABIAJBAWo2AhQgASgCCCACaiADOgAAIAAoAjAhAiABIAEoAhQiA0EBajYCFCADIAEoAghqIAJBCHY6AAAgAEEAQQBBABAGNgIwCyABQfEANgIEIAAoAhwiAhATAkAgACgCECIDIAIoAhQiBCADIARJGyIDRQ0AIAAoAgwgAigCECADEB8aIAAgACgCDCADajYCDCACIAIoAhAgA2o2AhAgACAAKAIUIANqNgIUIAAgACgCECADazYCECACIAIoAhQgA2siAzYCFCADDQAgAiACKAIINgIQCyABKAIURQ0AIAFBfzYCKA8LIAAoAgQNAQsgASgCdA0AIAEoAgRBmgVGDQgLIAEoAoQBIgJFBEAgAUEDEAwMBAsCQAJAIAEoAogBQQJrDgIAAQQLA0ACQAJAIAEoAnQNACABEAogASgCdA0AIAFBADYCtC0MAQsgAUEANgJgIAEoAjggASgCbGotAAAhAiABKAKkLSABKAKgLSIDQQF0akEAOwEAIAEgA0EBajYCoC0gAyABKAKYLWogAjoAACABIAJBAnRqQZQBaiICIAIvAQBBAWo7AQAgASABKAJ0QQFrNgJ0IAEgASgCbEEBaiICNgJsIAEoAqAtIAEoApwtQQFrRw0BIAEgASgCXCIEQQBOBH8gASgCOCAEagVBAAsgAiAEa0EAEBQgASABKAJsNgJcIAEoAgAiAigCHCIDEBMCQCACKAIQIgQgAygCFCIFIAQgBUkbIgRFDQAgAigCDCADKAIQIAQQHxogAiACKAIMIARqNgIMIAMgAygCECAEajYCECACIAIoAhQgBGo2AhQgAiACKAIQIARrNgIQIAMgAygCFCAEayICNgIUIAINACADIAMoAgg2AhALIAEoAgAoAhANAQwHCwsgASgCoC1FDQcgASABKAJcIgNBAE4EfyABKAI4IANqBUEACyABKAJsIANrQQAQFCABIAEoAmw2AlwgASgCACICKAIcIgMQEwJAIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgASgCACgCEEUNBQwHCwNAAkACQAJAIAEoAnQiAkGDAk8EQCABQQA2AmAMAQsgARAKIAEoAnQiAgRAIAFBADYCYCACQQJLDQEgASgCbCEDDAILIAFBADYCtC0gASgCoC1FDQogASABKAJcIgNBAE4EfyABKAI4IANqBUEACyABKAJsIANrQQAQFCABIAEoAmw2AlwgASgCACICKAIcIgMQEwJAIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgASgCACgCEEUNCAwKCyABKAJsIgNFBEBBACEDDAELIAEoAjggA2oiBkEBayIFLQAAIgQgBi0AAEcNACAEIAUtAAJHDQAgBCAFLQADRw0AIAZBggJqIQlBfyEIAkACQAJAAkACQAJAA0AgBiAIaiIFLQAEIARGBEAgBCAFLQAFRw0CIAQgBS0ABkcNAyAEIAUtAAdHDQQgBCAGIAhBCGoiCmoiBy0AAEcNByAEIAUtAAlHDQUgBCAFLQAKRw0GIAVBC2ohByAIQfYBSg0HIAohCCAEIActAABGDQEMBwsLIAVBBGohBwwFCyAFQQVqIQcMBAsgBUEGaiEHDAMLIAVBB2ohBwwCCyAFQQlqIQcMAQsgBUEKaiEHCyABIAIgByAJa0GCAmoiBCACIARJGyICNgJgIAJBA0kNACABKAKkLSABKAKgLSIDQQF0akEBOwEAIAEgA0EBajYCoC0gAyABKAKYLWogAkEDayICOgAAIAJB/wFxQYDNAGotAABBAnQgAWpBmAlqIgIgAi8BAEEBajsBACABQYDJAC0AAEECdGpBiBNqIgIgAi8BAEEBajsBACABKAJgIQIgAUEANgJgIAEgASgCdCACazYCdCABIAIgASgCbGoiAjYCbCABKAKgLSABKAKcLUEBa0cNAgwBCyABKAI4IANqLQAAIQIgASgCpC0gASgCoC0iA0EBdGpBADsBACABIANBAWo2AqAtIAMgASgCmC1qIAI6AAAgASACQQJ0akGUAWoiAiACLwEAQQFqOwEAIAEgASgCdEEBazYCdCABIAEoAmxBAWoiAjYCbCABKAKgLSABKAKcLUEBa0cNAQsgASABKAJcIgRBAE4EfyABKAI4IARqBUEACyACIARrQQAQFCABIAEoAmw2AlwgASgCACICKAIcIgMQEwJAIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgASgCACgCEA0ACwwECyABQX82AigPCyABQX82AigPCyABQQMgAkEMbEGIyABqKAIAEQQACyICQX5xQQJGBEAgAUGaBTYCBAsgAkF9cQ0BCyAAKAIQDQMgAUF/NgIoDwsgAkEBRw0BCyABQQBBAEEAEBIgASgCRCICIAEoAkxBAXRBAmsiA2pBADsBACACIAMQICABKAJ0RQRAIAFBADYCtC0gAUEANgJcIAFBADYCbAsgACgCHCICEBMCQCAAKAIQIgQgAigCFCIDIAMgBEsbIgNFDQAgACgCDCACKAIQIAMQHxogACAAKAIMIANqNgIMIAIgAigCECADajYCECAAIAAoAhQgA2o2AhQgACAAKAIQIANrIgQ2AhAgAiACKAIUIANrIgM2AhQgAw0AIAIgAigCCDYCEAsgBA0AIAFBfzYCKAsLC7YNAQt/IAAoAgAiBCgCBCEJQQEhCAJAIAQoAhAiAyAAKAK8LUEqakEDdSICSQ0AIAAoAiwiBSAAKAIMQQVrIgYgBSAGSRshCiABQQRHIQsDQCAKIAMgAmsiAyAAKAJsIAAoAlxrIgYgBCgCBGoiAkH//wMgAkH//wNJGyIFIAMgBUkbIgNLBEAgAiADRw0CIAFFDQIgCyADRXENAgsgAEEAQQAgAUEERiACIANGcSIHEBIgACgCFCAAKAIIakEEayADOgAAIAAoAhQgACgCCGpBA2sgA0EIdjoAACAAKAIUIAAoAghqQQJrIANBf3MiAjoAACAAKAIUIAAoAghqQQFrIAJBCHY6AAAgACgCACICKAIcIgQQEwJAIAIoAhAiBSAEKAIUIgwgBSAMSRsiBUUNACACKAIMIAQoAhAgBRAfGiACIAIoAgwgBWo2AgwgBCAEKAIQIAVqNgIQIAIgAigCFCAFajYCFCACIAIoAhAgBWs2AhAgBCAEKAIUIAVrIgI2AhQgAg0AIAQgBCgCCDYCEAsCfyAGBEAgACgCACgCDCAAKAI4IAAoAlxqIAMgBiADIAZJGyICEB8aIAAoAgAiBCAEKAIMIAJqNgIMIAQgBCgCECACazYCECAEIAQoAhQgAmo2AhQgACAAKAJcIAJqNgJcIAMgAmshAwsgAwsEQCAAKAIAIgIoAgwhBSADIAIoAgQiBiADIAZJGyIEBEAgAiAGIARrNgIEIAUgAigCACAEEB8hBQJAAkACQCACKAIcKAIYQQFrDgIAAQILIAIgAigCMCAFIAQQBDYCMAwBCyACIAIoAjAgBSAEEAY2AjALIAIgAigCACAEajYCACACIAIoAgggBGo2AgggACgCACICKAIMIQULIAIgAyAFajYCDCACIAIoAhAgA2s2AhAgAiACKAIUIANqNgIUCyAAKAIAIQQgBwRAQQAhCAwCCyAEKAIQIgMgACgCvC1BKmpBA3UiAk8NAAsLAkAgCSAEKAIEayIDRQRAIAAoAmwhAgwBCwJAIAAoAiwiAiADTQRAIABBAjYCsC0gACgCOCAEKAIAIAJrIAIQHxogACAAKAIsIgQ2AmwgBCECDAELAkAgACgCPCAAKAJsIgRrIANLDQAgACAEIAJrIgQ2AmwgACgCOCIFIAIgBWogBBAfGiAAKAKwLSICQQFLDQAgACACQQFqNgKwLQsgACgCOCAAKAJsaiAAKAIAKAIAIANrIAMQHxogACAAKAJsIANqIgI2AmwgACgCLCEECyAAIAI2AlwgACAEIAAoArQtIgVrIgQgAyADIARLGyAFajYCtC0LIAIgACgCwC1LBEAgACACNgLALQtBAyEDAkAgCEUNACAAKAIAIgQoAgQhAwJAAkAgAUF7cUUNACADDQBBASEDIAIgACgCXEYNAiAAKAI8IAJBf3NqIQVBACEDDAELIAMgACgCPCACQX9zaiIFTQ0AIAAoAlwiByAAKAIsIgZIDQAgACACIAZrIgM2AmwgACAHIAZrNgJcIAAoAjgiAiACIAZqIAMQHxogACgCsC0iA0EBTQRAIAAgA0EBajYCsC0LIAAoAiwgBWohBSAAKAIAIgQoAgQhAwsCQCADIAUgAyAFSRsiAkUEQCAAKAJsIQMMAQsgACgCbCEFIAAoAjghBiAEIAMgAms2AgQgBSAGaiAEKAIAIAIQHyEDAkACQAJAIAQoAhwoAhhBAWsOAgABAgsgBCAEKAIwIAMgAhAENgIwDAELIAQgBCgCMCADIAIQBjYCMAsgBCAEKAIAIAJqNgIAIAQgBCgCCCACajYCCCAAIAAoAmwgAmoiAzYCbAsgAyAAKALALUsEQCAAIAM2AsAtCyADIAAoAlwiBmsiBCAAKAIsIgMgACgCDCAAKAK8LUEqakEDdWsiAkH//wMgAkH//wNJGyICIAIgA0sbSQRAQQAhAyABRQ0BIAFBBEYgBEEAR3JFDQEgAiAESQ0BIAAoAgAoAgQNAQtBACEFIAAgACgCOCAGaiACIAQgAiAESRsiAwJ/IAFBBEYEQCAAKAIAKAIERSACIARPcSEFCyAFCxASIAAgACgCXCADajYCXCAAKAIAIgAoAhwiAxATAkAgACgCECICIAMoAhQiBCACIARJGyICRQ0AIAAoAgwgAygCECACEB8aIAAgACgCDCACajYCDCADIAMoAhAgAmo2AhAgACAAKAIUIAJqNgIUIAAgACgCECACazYCECADIAMoAhQgAmsiADYCFCAADQAgAyADKAIINgIQC0ECQQAgBRshAwsgAwu5CwENfwJAA0ACQAJAIAAoAnRBhQJNBEAgABAKIAAoAnQhAgJAIAENACACQYYCTw0AQQAPCyACRQ0EIAJBA0kNAQsgACAAKAJUIAAoAmwiAiAAKAI4ai0AAiAAKAJIIAAoAlh0c3EiAzYCSCAAKAJAIAIgACgCNHFBAXRqIAAoAkQgA0EBdGoiBC8BACIDOwEAIAQgAjsBACADRQ0AIAAoAixBhgJrIAIgA2tJDQAgACAAIAMQDiICNgJgDAELIAAoAmAhAgsCQCACQQNPBEAgACgCpC0gACgCoC0iA0EBdGogACgCbCAAKAJwayIEOwEAIAAgA0EBajYCoC0gAyAAKAKYLWogAkEDayICOgAAIAJB/wFxQYDNAGotAABBAnQgAGpBmAlqIgIgAi8BAEEBajsBACAAIARBAWtB//8DcSICIAJBB3ZBgAJqIAJBgAJJG0GAyQBqLQAAQQJ0akGIE2oiAiACLwEAQQFqOwEAIAAgACgCdCAAKAJgIgJrIgM2AnQgACgCnC1BAWshBiAAKAKgLSEHAkAgA0EDSQ0AIAIgACgCgAFLDQAgACACQQFrIgM2AmAgACgCSCEEIAAoAmwhAiAAKAI0IQggACgCQCEJIAAoAkQhCiAAKAJUIQsgACgCOCEMIAAoAlghDQNAIAAgAiIFQQFqIgI2AmwgACAFIAxqLQADIAQgDXRzIAtxIgQ2AkggCSACIAhxQQF0aiAKIARBAXRqIg4vAQA7AQAgDiACOwEAIAAgA0EBayIDNgJgIAMNAAsgACAFQQJqIgI2AmwgBiAHRw0DDAILIABBADYCYCAAIAAoAmwgAmoiAjYCbCAAIAAoAjggAmoiAy0AACIENgJIIAAgACgCVCADLQABIAQgACgCWHRzcTYCSCAGIAdHDQIMAQsgACgCOCAAKAJsai0AACECIAAoAqQtIAAoAqAtIgNBAXRqQQA7AQAgACADQQFqNgKgLSADIAAoApgtaiACOgAAIAAgAkECdGpBlAFqIgIgAi8BAEEBajsBACAAIAAoAnRBAWs2AnQgACAAKAJsQQFqIgI2AmwgACgCoC0gACgCnC1BAWtHDQELQQAhAyAAIAAoAlwiBEEATgR/IAAoAjggBGoFIAMLIAIgBGtBABAUIAAgACgCbDYCXCAAKAIAIgIoAhwiAxATAkAgAigCECIEIAMoAhQiBSAEIAVJGyIERQ0AIAIoAgwgAygCECAEEB8aIAIgAigCDCAEajYCDCADIAMoAhAgBGo2AhAgAiACKAIUIARqNgIUIAIgAigCECAEazYCECADIAMoAhQgBGsiAjYCFCACDQAgAyADKAIINgIQCyAAKAIAKAIQDQALQQAPCyAAIAAoAmwiAkECIAJBAkkbNgK0LSABQQRGBEBBACEDIAAgACgCXCIEQQBOBH8gACgCOCAEagUgAwsgAiAEa0EBEBQgACAAKAJsNgJcIAAoAgAiAigCHCIDEBMCQCACKAIQIgQgAygCFCIFIAQgBUkbIgRFDQAgAigCDCADKAIQIAQQHxogAiACKAIMIARqNgIMIAMgAygCECAEajYCECACIAIoAhQgBGo2AhQgAiACKAIQIARrNgIQIAMgAygCFCAEayICNgIUIAINACADIAMoAgg2AhALQQNBAiAAKAIAKAIQGw8LAkAgACgCoC1FDQBBACEDIAAgACgCXCIEQQBOBH8gACgCOCAEagUgAwsgAiAEa0EAEBQgACAAKAJsNgJcIAAoAgAiAigCHCIDEBMCQCACKAIQIgQgAygCFCIFIAQgBUkbIgRFDQAgAigCDCADKAIQIAQQHxogAiACKAIMIARqNgIMIAMgAygCECAEajYCECACIAIoAhQgBGo2AhQgAiACKAIQIARrNgIQIAMgAygCFCAEayICNgIUIAINACADIAMoAgg2AhALIAAoAgAoAhANAEEADwtBAQukBAEQfyAAKAJ8IgMgA0ECdiAAKAJ4IgQgACgCjAFJGyEJQQAgACgCbCIDIAAoAixrQYYCaiICIAIgA0sbIQwgACgCdCIHIAAoApABIgIgAiAHSxshDSAAKAI4Ig4gA2oiBUGCAmohDyAEIAVqIgMtAAAhCiADQQFrLQAAIQsgACgCNCEQIAAoAkAhEQNAAkACQCABIA5qIgMgBGoiAi0AACAKRw0AIAJBAWstAAAgC0cNACADLQAAIAUtAABHDQBBAiEGIAMtAAEgBS0AAUcNAAJAAkACQAJAAkACQAJAA0AgBSAGaiICLQABIAMtAANHDQYgAi0AAiADLQAERw0FIAItAAMgAy0ABUcNBCACLQAEIAMtAAZHDQMgAi0ABSADLQAHRw0CIAItAAYgAy0ACEcNASACLQAHIAMtAAlGBEAgBkH5AUshCCAFIAZBCGoiBmohAiAIDQggAy0ACiEIIANBCGohAyACLQAAIAhGDQEMCAsLIAJBB2ohAgwGCyACQQZqIQIMBQsgAkEFaiECDAQLIAJBBGohAgwDCyACQQNqIQIMAgsgAkECaiECDAELIAJBAWohAgsgAiAPayICQYICaiIDIARMDQAgACABNgJwIAMgDU4EQCADIQQMAgsgAyAFai0AACEKIAIgBWotAIECIQsgAyEECyAJQQFrIglFDQAgDCARIAEgEHFBAXRqLwEAIgFJDQELCyAHIAQgBCAHSxsL3Q4BB38DQAJAAkACQCAAKAJ0QYUCSw0AIAAQCiAAKAJ0IQICQCABDQAgAkGGAk8NAEEADwsgAkUNAiACQQJLDQAgACAAKAJgIgI2AnggACAAKAJwNgJkQQIhAyAAQQI2AmAMAQtBAiEDIAAgACgCVCAAKAJsIgIgACgCOGotAAIgACgCSCAAKAJYdHNxIgQ2AkggACgCQCACIAAoAjRxQQF0aiAAKAJEIARBAXRqIgUvAQAiBDsBACAFIAI7AQAgACAAKAJgIgI2AnggACAAKAJwNgJkIABBAjYCYCAERQ0AAkAgAiAAKAKAAU8NACAAKAIsQYYCayAAKAJsIARrSQ0AIAAgACAEEA4iAzYCYCADQQVLDQAgACgCiAFBAUcEQCADQQNHDQFBAyEDIAAoAmwgACgCcGtBgSBJDQELQQIhAyAAQQI2AmALIAAoAnghAgsCQCACQQNJDQAgAiADSQ0AIAAoAnQhBCAAKAKkLSAAKAKgLSIDQQF0aiAAKAJsIgUgACgCZEF/c2oiBjsBACAAIANBAWo2AqAtIAMgACgCmC1qIAJBA2siAjoAACACQf8BcUGAzQBqLQAAQQJ0IABqQZgJaiICIAIvAQBBAWo7AQAgACAGQQFrQf//A3EiAiACQQd2QYACaiACQYACSRtBgMkAai0AAEECdGpBiBNqIgIgAi8BAEEBajsBACAAIAAoAngiAkECayIDNgJ4IAAgACgCdCACa0EBajYCdCAEIAVqQQNrIQUgACgCnC1BAWshByAAKAJsIQIgACgCoC0hCANAIAAgAiIEQQFqIgI2AmwgAiAFTQRAIAAgACgCVCAEIAAoAjhqLQADIAAoAkggACgCWHRzcSIGNgJIIAAoAkAgACgCNCACcUEBdGogACgCRCAGQQF0aiIGLwEAOwEAIAYgAjsBAAsgACADQQFrIgM2AnggAw0ACyAAQQI2AmAgAEEANgJoIAAgBEECaiICNgJsIAcgCEcNAkEAIQMgACAAKAJcIgRBAE4EfyAAKAI4IARqBSADCyACIARrQQAQFCAAIAAoAmw2AlwgACgCACICKAIcIgMQEwJAIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgACgCACgCEA0CQQAPCyAAKAJoBEAgACgCbCAAKAI4akEBay0AACECIAAoAqQtIAAoAqAtIgNBAXRqQQA7AQAgACADQQFqNgKgLSADIAAoApgtaiACOgAAIAAgAkECdGpBlAFqIgIgAi8BAEEBajsBAAJAIAAoAqAtIAAoApwtQQFrRw0AQQAhAyAAIAAoAlwiAkEATgR/IAAoAjggAmoFIAMLIAAoAmwgAmtBABAUIAAgACgCbDYCXCAAKAIAIgIoAhwiAxATIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgACAAKAJsQQFqNgJsIAAgACgCdEEBazYCdCAAKAIAKAIQDQJBAA8FIABBATYCaCAAIAAoAmxBAWo2AmwgACAAKAJ0QQFrNgJ0DAILAAsLIAAoAmgEQCAAKAJsIAAoAjhqQQFrLQAAIQIgACgCpC0gACgCoC0iA0EBdGpBADsBACAAIANBAWo2AqAtIAMgACgCmC1qIAI6AAAgACACQQJ0akGUAWoiAiACLwEAQQFqOwEAIABBADYCaAsgACAAKAJsIgJBAiACQQJJGzYCtC0gAUEERgRAQQAhAyAAIAAoAlwiBEEATgR/IAAoAjggBGoFIAMLIAIgBGtBARAUIAAgACgCbDYCXCAAKAIAIgIoAhwiAxATAkAgAigCECIEIAMoAhQiBSAEIAVJGyIERQ0AIAIoAgwgAygCECAEEB8aIAIgAigCDCAEajYCDCADIAMoAhAgBGo2AhAgAiACKAIUIARqNgIUIAIgAigCECAEazYCECADIAMoAhQgBGsiAjYCFCACDQAgAyADKAIINgIQC0EDQQIgACgCACgCEBsPCwJAIAAoAqAtRQ0AQQAhAyAAIAAoAlwiBEEATgR/IAAoAjggBGoFIAMLIAIgBGtBABAUIAAgACgCbDYCXCAAKAIAIgIoAhwiAxATAkAgAigCECIEIAMoAhQiBSAEIAVJGyIERQ0AIAIoAgwgAygCECAEEB8aIAIgAigCDCAEajYCDCADIAMoAhAgBGo2AhAgAiACKAIUIARqNgIUIAIgAigCECAEazYCECADIAMoAhQgBGsiAjYCFCACDQAgAyADKAIINgIQCyAAKAIAKAIQDQBBAA8LQQELYQAgAEEANgK8LSAAQQA7AbgtIABBuBZqQajPADYCACAAIABB/BRqNgKwFiAAQawWakGUzwA2AgAgACAAQYgTajYCpBYgAEGgFmpBgM8ANgIAIAAgAEGUAWo2ApgWIAAQEQvwBAEDfyAAQZQBaiECA0AgAiABQQJ0IgNqQQA7AQAgAiADQQRyakEAOwEAIAFBAmoiAUGeAkcNAAsgAEEAOwH8FCAAQQA7AYgTIABBxBVqQQA7AQAgAEHAFWpBADsBACAAQbwVakEAOwEAIABBuBVqQQA7AQAgAEG0FWpBADsBACAAQbAVakEAOwEAIABBrBVqQQA7AQAgAEGoFWpBADsBACAAQaQVakEAOwEAIABBoBVqQQA7AQAgAEGcFWpBADsBACAAQZgVakEAOwEAIABBlBVqQQA7AQAgAEGQFWpBADsBACAAQYwVakEAOwEAIABBiBVqQQA7AQAgAEGEFWpBADsBACAAQYAVakEAOwEAIABB/BNqQQA7AQAgAEH4E2pBADsBACAAQfQTakEAOwEAIABB8BNqQQA7AQAgAEHsE2pBADsBACAAQegTakEAOwEAIABB5BNqQQA7AQAgAEHgE2pBADsBACAAQdwTakEAOwEAIABB2BNqQQA7AQAgAEHUE2pBADsBACAAQdATakEAOwEAIABBzBNqQQA7AQAgAEHIE2pBADsBACAAQcQTakEAOwEAIABBwBNqQQA7AQAgAEG8E2pBADsBACAAQbgTakEAOwEAIABBtBNqQQA7AQAgAEGwE2pBADsBACAAQawTakEAOwEAIABBqBNqQQA7AQAgAEGkE2pBADsBACAAQaATakEAOwEAIABBnBNqQQA7AQAgAEGYE2pBADsBACAAQZQTakEAOwEAIABBkBNqQQA7AQAgAEGME2pBADsBACAAQgA3AqwtIABBlAlqQQE7AQAgAEEANgKoLSAAQQA2AqAtC7IDAQJ/IAAgAC8BuC0gA0H//wNxIgUgACgCvC0iBHRyIgM7AbgtAkACQAJ/IARBDk4EQCAAIAAoAhQiBEEBajYCFCAEIAAoAghqIAM6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAAQbktai0AADoAACAAIAVBECAAKAK8LSIEa3YiAzsBuC0gBEENawwBCyAEQQNqCyIEQQlOBEAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiADOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGohBCAAQbktai0AACEDDAELIARBAUgNASAAIAAoAhQiBEEBajYCFCAEIAAoAghqIQQLIAQgAzoAAAsgAEEANgK8LSAAQQA7AbgtIAAgACgCFCIDQQFqNgIUIAMgACgCCGogAjoAACAAIAAoAhQiA0EBajYCFCADIAAoAghqIAJBCHY6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiACQX9zIgM6AAAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiADQQh2OgAAIAAoAgggACgCFGogASACEB8aIAAgACgCFCACajYCFAusAQEBfwJAIAACfyAAKAK8LSIBQRBGBEAgACAAKAIUIgFBAWo2AhQgASAAKAIIaiAALQC4LToAACAAIAAoAhQiAUEBajYCFCABIAAoAghqIABBuS1qLQAAOgAAIABBADsBuC1BAAwBCyABQQhIDQEgACAAKAIUIgFBAWo2AhQgASAAKAIIaiAALQC4LToAACAAIABBuS1qLQAAOwG4LSAAKAK8LUEIaws2ArwtCwuhEwENfwJ/AkACQAJAIAAoAoQBQQFOBEAgACgCACIGKAIsQQJHDQNB/4D/n38hBANAAkAgBEEBcUUNACAAIAVBAnRqLwGUAUUNAEEAIQQMBAsCQCAEQQJxRQ0AIAAgBUECdEEEcmovAZQBRQ0AQQAhBAwECyAEQQJ2IQQgBUECaiIFQSBHDQALDAELIAJBBWoiBQwDCwJAIAAvAbgBDQAgAC8BvAENACAALwHIAQ0AQSAhBQNAIAAgBUECdCIEai8BlAENASAAIARBBHJqLwGUAQ0BIAAgBEEIcmovAZQBDQEgACAEQQxyai8BlAENAUEAIQQgBUEEaiIFQYACRw0ACwwBC0EBIQQLIAYgBDYCLAsgACAAQZgWahAVIAAgAEGkFmoQFSAALwGWASEEIAAgAEGcFmooAgAiCkECdGpB//8DOwGaASAKQQBOBEBBB0GKASAEGyEJQQRBAyAEGyELIABBwBVqIQ4gAEHEFWohDyAAQbwVaiEQQX8hDANAIAQhBSAAIAgiDUEBaiIIQQJ0ai8BlgEhBAJAAkAgB0EBaiIGIAlODQAgBCAFRw0AIAYhBwwBCwJ/IAYgC0gEQCAAIAVBAnRqQfwUaiIHLwEAIAZqDAELIAUEQCAFIAxHBEAgACAFQQJ0akH8FGoiBiAGLwEAQQFqOwEACyAQIgcvAQBBAWoMAQsgB0EJTARAIA4iBy8BAEEBagwBCyAPIgcvAQBBAWoLIQYgByAGOwEAQQAhBwJ/IARFBEBBAyELQYoBDAELQQNBBCAEIAVGIgYbIQtBBkEHIAYbCyEJIAUhDAsgCiANRw0ACwsgAEGKE2ovAQAhBCAAIABBqBZqKAIAIgpBAnRqQY4TakH//wM7AQBBACEHIApBAE4EQEEHQYoBIAQbIQlBBEEDIAQbIQsgAEHAFWohDiAAQcQVaiEPIABBvBVqIRBBfyEMQQAhCANAIAQhBSAAIAgiDUEBaiIIQQJ0akGKE2ovAQAhBAJAAkAgB0EBaiIGIAlODQAgBCAFRw0AIAYhBwwBCwJ/IAYgC0gEQCAAIAVBAnRqQfwUaiIHLwEAIAZqDAELIAUEQCAFIAxHBEAgACAFQQJ0akH8FGoiBiAGLwEAQQFqOwEACyAQIgcvAQBBAWoMAQsgB0EJTARAIA4iBy8BAEEBagwBCyAPIgcvAQBBAWoLIQYgByAGOwEAQQAhBwJ/IARFBEBBAyELQYoBDAELQQNBBCAEIAVGIgYbIQtBBkEHIAYbCyEJIAUhDAsgCiANRw0ACwsgACAAQbAWahAVIAAgACgCqC0Cf0ESIABBuhVqLwEADQAaQREgAEGCFWovAQANABpBECAAQbYVai8BAA0AGkEPIABBhhVqLwEADQAaQQ4gAEGyFWovAQANABpBDSAAQYoVai8BAA0AGkEMIABBrhVqLwEADQAaQQsgAEGOFWovAQANABpBCiAAQaoVai8BAA0AGkEJIABBkhVqLwEADQAaQQggAEGmFWovAQANABpBByAAQZYVai8BAA0AGkEGIABBohVqLwEADQAaQQUgAEGaFWovAQANABpBBCAAQZ4Vai8BAA0AGkEDQQIgAEH+FGovAQAbCyIIQQNsaiIEQRFqNgKoLSAEQRtqQQN2IgQgACgCrC1BCmpBA3YiBSAEIAVJGwshBAJAAkAgAUUNACACQQRqIARLDQAgACABIAIgAxASDAELIAAoArwtIQYCQCAEIAVHBEAgACgCiAFBBEcNAQsgACAALwG4LSADQQJqQf//A3EiBCAGdHIiBTsBuC0gAAJ/IAZBDk4EQCAAIAAoAhQiBkEBajYCFCAGIAAoAghqIAU6AAAgACAAKAIUIgVBAWo2AhQgBSAAKAIIaiAAQbktai0AADoAACAAIARBECAAKAK8LSIFa3Y7AbgtIAVBDWsMAQsgBkEDags2ArwtIABBwM8AQcDYABAWDAELIAAvAbgtIANBBGpB//8DcSIHIAZ0ciEFAkAgBkEOTgRAIAAgBTsBuC0gACAAKAIUIgRBAWo2AhQgBCAAKAIIaiAFOgAAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogAEG5LWotAAA6AAAgACgCvC0iBUENayEEIAdBECAFa3YhBQwBCyAGQQNqIQQLIAAgBDYCvC0gAEGcFmooAgAiCkGA/gNqQf//A3EiByAEdCEGIABBqBZqKAIAIQkCfyAEQQxOBEAgACAFIAZyIgQ7AbgtIAAgACgCFCIFQQFqNgIUIAUgACgCCGogBDoAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIABBuS1qLQAAOgAAIAAoArwtIgVBC2shBCAHQRAgBWt2DAELIARBBWohBCAFIAZyCyEFIAAgBDYCvC0gCUH//wNxIgcgBHQhBgJ/IARBDE4EQCAAIAUgBnIiBDsBuC0gACAAKAIUIgVBAWo2AhQgBSAAKAIIaiAEOgAAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogAEG5LWotAAA6AAAgACgCvC0iBUELayEEIAdBECAFa3YMAQsgBEEFaiEEIAUgBnILIQUgACAENgK8LSAIQf3/A2pB//8DcSIHIAR0IQYCfyAEQQ1OBEAgACAFIAZyIgQ7AbgtIAAgACgCFCIFQQFqNgIUIAUgACgCCGogBDoAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIABBuS1qLQAAOgAAIAAoArwtIgVBDGshBCAHQRAgBWt2DAELIARBBGohBCAFIAZyCyEGIAAgBDYCvC1BACEFIABBuS1qIQ0DQCAAIAYgACAFQZDcAGotAABBAnRqQf4Uai8BACIHIAR0ciIGOwG4LSAAAn8gBEEOTgRAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogBjoAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIA0tAAA6AAAgACAHQRAgACgCvC0iBGt2IgY7AbgtIARBDWsMAQsgBEEDagsiBDYCvC0gBSAIRyEHIAVBAWohBSAHDQALIAAgAEGUAWoiBCAKEBcgACAAQYgTaiIFIAkQFyAAIAQgBRAWCyAAEBEgAwRAAkACfyAAKAK8LSIEQQlOBEAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiAALQC4LToAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIQQgAEG5LWotAAAMAQsgBEEBSA0BIAAgACgCFCIEQQFqNgIUIAQgACgCCGohBCAALQC4LQshBSAEIAU6AAALIABBADYCvC0gAEEAOwG4LQsLsRUBFX8jAEEgayEKIAEoAgAhCSABKAIIIgIoAgAhBSACKAIMIQ0gAEKAgICA0McANwLQKEF/IRACQCANQQBKBEBBACECA0ACQCAJIAJBAnRqIgMvAQAEQCAAIAAoAtAoQQFqIgM2AtAoIAAgA0ECdGpB3BZqIAI2AgAgACACakHYKGpBADoAACACIRAMAQsgA0EAOwECCyACQQFqIgIgDUcNAAsgACgC0CgiBEEBSg0BCwNAIAAgBEEBaiICNgLQKCAAIAJBAnRqQdwWaiAQQQFqIgNBACAQQQJIIgQbIgI2AgAgCSACQQJ0IgdqQQE7AQAgACACakHYKGpBADoAACAAIAAoAqgtQQFrNgKoLSAFBEAgACAAKAKsLSAFIAdqLwECazYCrC0LIAMgECAEGyEQIAAoAtAoIgRBAkgNAAsLIAEgEDYCBCAEQQF2IQgDQCAAIAhBAnRqQdwWaigCACELAkAgCCICQQF0IgMgBEoNACAAIAtqQdgoaiEPIAkgC0ECdGohBiAIIQUDQAJAIAMgBE4EQCADIQIMAQsgCSAAQdwWaiICIANBAXIiBEECdGooAgAiDkECdGovAQAiByAJIAIgA0ECdGooAgAiDEECdGovAQAiAk8EQCACIAdHBEAgAyECDAILIAMhAiAAQdgoaiIDIA5qLQAAIAMgDGotAABLDQELIAQhAgsgBi8BACIEIAkgACACQQJ0akHcFmooAgAiA0ECdGovAQAiB0kEQCAFIQIMAgsCQCAEIAdHDQAgDy0AACAAIANqQdgoai0AAEsNACAFIQIMAgsgACAFQQJ0akHcFmogAzYCACACIQUgAkEBdCIDIAAoAtAoIgRMDQALCyAAIAJBAnRqQdwWaiALNgIAIAhBAk4EQCAIQQFrIQggACgC0CghBAwBCwsgACgC0CghAwNAIA0hCCAAIANBAWsiBDYC0CggACgC4BYhCyAAIAAgA0ECdGpB3BZqKAIAIg02AuAWQQEhAgJAIANBA0gNACAAIA1qQdgoaiEPQQIhAyAJIA1BAnRqIQZBASEFA0ACQCADIAROBEAgAyECDAELIAkgAEHcFmoiAiADQQFyIgRBAnRqKAIAIg5BAnRqLwEAIgcgCSACIANBAnRqKAIAIgxBAnRqLwEAIgJPBEAgAiAHRwRAIAMhAgwCCyADIQIgAEHYKGoiAyAOai0AACADIAxqLQAASw0BCyAEIQILIAYvAQAiBCAJIAAgAkECdGpB3BZqKAIAIgNBAnRqLwEAIgdJBEAgBSECDAILAkAgBCAHRw0AIA8tAAAgACADakHYKGotAABLDQAgBSECDAILIAAgBUECdGpB3BZqIAM2AgAgAiEFIAJBAXQiAyAAKALQKCIETA0ACwtBAiEDIABB3BZqIgYgAkECdGogDTYCACAAIAAoAtQoQQFrIgQ2AtQoIAAoAuAWIQIgBiAEQQJ0aiALNgIAIAAgACgC1ChBAWsiBDYC1CggBiAEQQJ0aiACNgIAIAkgCEECdGoiDiAJIAJBAnRqIgQvAQAgCSALQQJ0aiIFLwEAajsBACAAQdgoaiIMIAhqIg8gAiAMai0AACICIAsgDGotAAAiByACIAdLG0EBajoAACAEIAg7AQIgBSAIOwECIAAgCDYC4BZBASEFQQEhAgJAIAAoAtAoIgRBAkgNAANAAn8gAyADIARODQAaIAkgBiADQQFyIgRBAnRqKAIAIgtBAnRqLwEAIgIgCSAGIANBAnRqKAIAIg1BAnRqLwEAIgdPBEAgAyACIAdHDQEaIAMgCyAMai0AACAMIA1qLQAASw0BGgsgBAshAiAOLwEAIgQgCSAAIAJBAnRqQdwWaigCACIDQQJ0ai8BACIHSQRAIAUhAgwCCwJAIAQgB0cNACAPLQAAIAAgA2pB2ChqLQAASw0AIAUhAgwCCyAAIAVBAnRqQdwWaiADNgIAIAIhBSACQQF0IgMgACgC0CgiBEwNAAsLIAhBAWohDSAAIAJBAnRqQdwWaiAINgIAIAAoAtAoIgNBAUoNAAsgACAAKALUKEEBayICNgLUKCAAQdwWaiIDIAJBAnRqIAAoAuAWNgIAIAEoAgQhByABKAIIIgIoAhAhBiACKAIIIREgAigCBCETIAIoAgAhEiABKAIAIQwgAEHUFmoiAUIANwEAIABBzBZqIhRCADcBACAAQcQWaiIVQgA3AQAgAEG8FmoiFkIANwEAQQAhCCAMIAMgACgC1ChBAnRqKAIAQQJ0akEAOwECAkAgACgC1CgiAkG7BEoNACACQQFqIQJBACEOA0AgDCAAIAJBAnRqQdwWaigCACIEQQJ0Ig1qIgUgDCAFLwECQQJ0ai8BAiIDQQFqIAYgAyAGSBsiDzsBAiADIAZOIQMCQCAEIAdKDQAgACAPQQF0akG8FmoiCyALLwEAQQFqOwEAQQAhCyAEIBFOBEAgEyAEIBFrQQJ0aigCACELCyAAIAAoAqgtIAUvAQAiBCALIA9qbGo2AqgtIBJFDQAgACAAKAKsLSALIA0gEmovAQJqIARsajYCrC0LIAMgDmohDiACQQFqIgJBvQRHDQALIA5FDQAgACAGQQF0akG8FmohDwNAIAYhAgNAIAAgAiIDQQFrIgJBAXRqQbwWaiIELwEAIgVFDQALIAQgBUEBazsBACAAIANBAXRqQbwWaiICIAIvAQBBAmo7AQAgDyAPLwEAQQFrIgI7AQAgDkECSiEDIA5BAmshDiADDQALIAZFDQBBvQQhBQNAIAJB//8DcSEDIAUhAgNAIAMEQCAAIAJBAWsiAkECdGpB3BZqKAIAIgQgB0oNASAMIARBAnRqIgQvAQIiBSAGRwRAIAAgACgCqC0gBC8BACAGIAVrbGo2AqgtIAQgBjsBAgsgA0EBayEDIAIhBQwBCwsgBkEBayIGRQ0BIAAgBkEBdGpBvBZqLwEAIQIMAAsACyAKIBYvAQBBAXQiAjsBAiAKIAIgAEG+FmovAQBqQQF0IgI7AQQgCiACIABBwBZqLwEAakEBdCICOwEGIAogAiAAQcIWai8BAGpBAXQiAjsBCCAKIAIgFS8BAGpBAXQiAjsBCiAKIAIgAEHGFmovAQBqQQF0IgI7AQwgCiACIABByBZqLwEAakEBdCICOwEOIAogAiAAQcoWai8BAGpBAXQiAjsBECAKIAIgFC8BAGpBAXQiAjsBEiAKIAIgAEHOFmovAQBqQQF0IgI7ARQgCiACIABB0BZqLwEAakEBdCICOwEWIAogAiAAQdIWai8BAGpBAXQiAjsBGCAKIAEvAQAgAmpBAXQiAjsBGiAKIABB1hZqLwEAIAJqQQF0IgI7ARwgCiACIABB2BZqLwEAakEBdDsBHiAQQQBOBEADQCAJIAhBAnRqIgcvAQIiBARAIAogBEEBdGoiACAALwEAIgBBAWo7AQAgBEEDcSEDQQAhAiAEQQFrQQNPBEAgBEH8/wNxIQUDQCAAQQN2QQFxIABBAnZBAXEgAEECcSACIABBAXFyQQJ0cnJBAXRyIgRBAXQhAiAAQQR2IQAgBUEEayIFDQALCyADBEADQCACIABBAXFyIgRBAXQhAiAAQQF2IQAgA0EBayIDDQALCyAHIAQ7AQALIAggEEchACAIQQFqIQggAA0ACwsL2QgBCn8CQCAAKAKgLUUEQCAAKAK8LSEDDAELIABBuS1qIQgDQCAEQQFqIQogACgCmC0gBGotAAAhBQJAIAACfyAAKAKkLSAEQQF0ai8BACIHRQRAIAEgBUECdGoiAy8BAiEEIAAgAC8BuC0gAy8BACIFIAAoArwtIgN0ciIHOwG4LUEQIARrIANIBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAHOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAVBECAAKAK8LSIDa3Y7AbgtIAMgBGpBEGsMAgsgAyAEagwBCyAFQYDNAGotAAAiC0ECdCIJQYAIciABaiIDLwEGIQQgACAALwG4LSADLwEEIgwgACgCvC0iBnRyIgM7AbgtIAACf0EQIARrIAZIBEAgACAAKAIUIgZBAWo2AhQgBiAAKAIIaiADOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAxBECAAKAK8LSIGa3YiAzsBuC0gBCAGakEQawwBCyAEIAZqCyIENgK8LSALQQhrQRNNBEAgACADIAUgCUGw3ABqKAIAa0H//wNxIgYgBHRyIgM7AbgtIAACf0EQIAlBwNkAaigCACIFayAESARAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogAzoAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIAgtAAA6AAAgACAGQRAgACgCvC0iBGt2IgM7AbgtIAQgBWpBEGsMAQsgBCAFagsiBDYCvC0LIAIgB0EBayIFIAVBB3ZBgAJqIAVBgAJJG0GAyQBqLQAAIgtBAnQiCWoiBi8BAiEHIAAgAyAGLwEAIgwgBHRyIgY7AbgtIAACf0EQIAdrIARIBEAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiAGOgAAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogCC0AADoAACAAIAxBECAAKAK8LSIEa3YiBjsBuC0gBCAHakEQawwBCyAEIAdqCyIDNgK8LSALQQRJDQEgACAGIAUgCUGw3QBqKAIAa0H//wNxIgUgA3RyIgc7AbgtQRAgCUHA2gBqKAIAIgRrIANIBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAHOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAVBECAAKAK8LSIDa3Y7AbgtIAMgBGpBEGsMAQsgAyAEagsiAzYCvC0LIAoiBCAAKAKgLUkNAAsLIAFBgghqLwEAIQQgACAALwG4LSABLwGACCIKIAN0ciIFOwG4LUEQIARrIANIBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAFOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogAEG5LWotAAA6AAAgACAKQRAgACgCvC0iA2t2OwG4LSAAIAMgBGpBEGs2ArwtDwsgACADIARqNgK8LQuXCwEMfyACQQBOBEBBBEEDIAEvAQIiChshBkEHQYoBIAobIQMgAEG5LWohCEF/IQcDQCAKIQkgASALIgxBAWoiC0ECdGovAQIhCgJAAkAgBUEBaiIEIANODQAgCSAKRw0AIAQhBQwBCwJAIAQgBkgEQCAAIAlBAnRqIgVB/BRqIQ0gBUH+FGohDiAAKAK8LSEFA0AgDi8BACEDIAAgAC8BuC0gDS8BACIGIAV0ciIHOwG4LSAAAn9BECADayAFSARAIAAgACgCFCIFQQFqNgIUIAUgACgCCGogBzoAACAAIAAoAhQiBUEBajYCFCAFIAAoAghqIAgtAAA6AAAgACAGQRAgACgCvC0iBWt2OwG4LSADIAVqQRBrDAELIAMgBWoLIgU2ArwtIARBAWsiBA0ACwwBCyAAAn8gCQRAAkAgByAJRgRAIAAoArwtIQMgBCEFDAELIAAgCUECdGoiBEH+FGovAQAhAyAAIAAvAbgtIARB/BRqLwEAIgYgACgCvC0iBHRyIgc7AbgtIAACf0EQIANrIARIBEAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiAHOgAAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogCC0AADoAACAAIAZBECAAKAK8LSIEa3Y7AbgtIAMgBGpBEGsMAQsgAyAEagsiAzYCvC0LIAAvAbgtIAAvAbwVIgcgA3RyIQQCQEEQIAAvAb4VIgZrIANIBEAgACAEOwG4LSAAIAAoAhQiA0EBajYCFCADIAAoAghqIAQ6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAILQAAOgAAIAYgACgCvC0iBGpBEGshAyAHQRAgBGt2IQQMAQsgAyAGaiEDCyAAIAM2ArwtIAAgBCAFQf3/A2pB//8DcSIFIAN0ciIEOwG4LSADQQ9OBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAEOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAVBECAAKAK8LSIDa3Y7AbgtIANBDmsMAgsgA0ECagwBCyAFQQlMBEAgAC8BuC0gAC8BwBUiByAAKAK8LSIDdHIhBAJAQRAgAC8BwhUiBmsgA0gEQCAAIAQ7AbgtIAAgACgCFCIDQQFqNgIUIAMgACgCCGogBDoAACAAIAAoAhQiA0EBajYCFCADIAAoAghqIAgtAAA6AAAgBiAAKAK8LSIEakEQayEDIAdBECAEa3YhBAwBCyADIAZqIQMLIAAgAzYCvC0gACAEIAVB/v8DakH//wNxIgUgA3RyIgQ7AbgtIANBDk4EQCAAIAAoAhQiA0EBajYCFCADIAAoAghqIAQ6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAILQAAOgAAIAAgBUEQIAAoArwtIgNrdjsBuC0gA0ENawwCCyADQQNqDAELIAAvAbgtIAAvAcQVIgcgACgCvC0iA3RyIQQCQEEQIAAvAcYVIgZrIANIBEAgACAEOwG4LSAAIAAoAhQiA0EBajYCFCADIAAoAghqIAQ6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAILQAAOgAAIAYgACgCvC0iBGpBEGshAyAHQRAgBGt2IQQMAQsgAyAGaiEDCyAAIAM2ArwtIAAgBCAFQfb/A2pB//8DcSIFIAN0ciIEOwG4LSADQQpOBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAEOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAVBECAAKAK8LSIDa3Y7AbgtIANBCWsMAQsgA0EHags2ArwtC0EAIQUCfyAKRQRAQYoBIQNBAwwBC0EGQQcgCSAKRiIEGyEDQQNBBCAEGwshBiAJIQcLIAIgDEcNAAsLCwkAIAEgAmwQHAsGACABEB0LXwEBfyMAQUBqIgMkACADQQA2AjAgA0IANwMoIAMgADYCCCADIAI2AhQgAyABNgIMIAMgAUEDbDYCGCADQQhqEAcgA0EIahALIANBCGoQCCADKAIcIQEgA0FAayQAIAELBgBB1N8AC6QuAQx/IwBBEGsiDCQAAkACQAJAAkACQAJAAkACQAJAAkACQAJAIABB9AFNBEBB2N8AKAIAIgZBECAAQQtqQXhxIABBC0kbIgRBA3YiAXYiAEEDcQRAIABBf3NBAXEgAWoiAkEDdCIDQYjgAGooAgAiAUEIaiEAAkAgASgCCCIEIANBgOAAaiIDRgRAQdjfACAGQX4gAndxNgIADAELIAQgAzYCDCADIAQ2AggLIAEgAkEDdCICQQNyNgIEIAEgAmoiASABKAIEQQFyNgIEDA0LIARB4N8AKAIAIghNDQEgAARAAkAgACABdEECIAF0IgBBACAAa3JxIgBBACAAa3FBAWsiACAAQQx2QRBxIgB2IgFBBXZBCHEiAiAAciABIAJ2IgBBAnZBBHEiAXIgACABdiIAQQF2QQJxIgFyIAAgAXYiAEEBdkEBcSIBciAAIAF2aiICQQN0IgNBiOAAaigCACIBKAIIIgAgA0GA4ABqIgNGBEBB2N8AIAZBfiACd3EiBjYCAAwBCyAAIAM2AgwgAyAANgIICyABQQhqIQAgASAEQQNyNgIEIAEgBGoiAyACQQN0IgUgBGsiAkEBcjYCBCABIAVqIAI2AgAgCARAIAhBA3YiBUEDdEGA4ABqIQRB7N8AKAIAIQECfyAGQQEgBXQiBXFFBEBB2N8AIAUgBnI2AgAgBAwBCyAEKAIICyEFIAQgATYCCCAFIAE2AgwgASAENgIMIAEgBTYCCAtB7N8AIAM2AgBB4N8AIAI2AgAMDQtB3N8AKAIAIglFDQEgCUEAIAlrcUEBayIAIABBDHZBEHEiAHYiAUEFdkEIcSICIAByIAEgAnYiAEECdkEEcSIBciAAIAF2IgBBAXZBAnEiAXIgACABdiIAQQF2QQFxIgFyIAAgAXZqQQJ0QYjiAGooAgAiAygCBEF4cSAEayEBIAMhAgNAAkAgAigCECIARQRAIAIoAhQiAEUNAQsgACgCBEF4cSAEayICIAEgASACSyICGyEBIAAgAyACGyEDIAAhAgwBCwsgAyAEaiILIANNDQIgAygCGCEKIAMgAygCDCIFRwRAIAMoAggiAEHo3wAoAgBJGiAAIAU2AgwgBSAANgIIDAwLIANBFGoiAigCACIARQRAIAMoAhAiAEUNBCADQRBqIQILA0AgAiEHIAAiBUEUaiICKAIAIgANACAFQRBqIQIgBSgCECIADQALIAdBADYCAAwLC0F/IQQgAEG/f0sNACAAQQtqIgBBeHEhBEHc3wAoAgAiCEUNAEEfIQcgBEH///8HTQRAIABBCHYiACAAQYD+P2pBEHZBCHEiAHQiASABQYDgH2pBEHZBBHEiAXQiAiACQYCAD2pBEHZBAnEiAnRBD3YgACABciACcmsiAEEBdCAEIABBFWp2QQFxckEcaiEHC0EAIARrIQECQAJAAkAgB0ECdEGI4gBqKAIAIgJFBEBBACEADAELQQAhACAEQQBBGSAHQQF2ayAHQR9GG3QhAwNAAkAgAigCBEF4cSAEayIGIAFPDQAgAiEFIAYiAQ0AQQAhASACIQAMAwsgACACKAIUIgYgBiACIANBHXZBBHFqKAIQIgJGGyAAIAYbIQAgA0EBdCEDIAINAAsLIAAgBXJFBEBBAiAHdCIAQQAgAGtyIAhxIgBFDQMgAEEAIABrcUEBayIAIABBDHZBEHEiAHYiAkEFdkEIcSIDIAByIAIgA3YiAEECdkEEcSICciAAIAJ2IgBBAXZBAnEiAnIgACACdiIAQQF2QQFxIgJyIAAgAnZqQQJ0QYjiAGooAgAhAAsgAEUNAQsDQCAAKAIEQXhxIARrIgYgAUkhAyAGIAEgAxshASAAIAUgAxshBSAAKAIQIgIEfyACBSAAKAIUCyIADQALCyAFRQ0AIAFB4N8AKAIAIARrTw0AIAQgBWoiByAFTQ0BIAUoAhghCSAFIAUoAgwiA0cEQCAFKAIIIgBB6N8AKAIASRogACADNgIMIAMgADYCCAwKCyAFQRRqIgIoAgAiAEUEQCAFKAIQIgBFDQQgBUEQaiECCwNAIAIhBiAAIgNBFGoiAigCACIADQAgA0EQaiECIAMoAhAiAA0ACyAGQQA2AgAMCQsgBEHg3wAoAgAiAE0EQEHs3wAoAgAhAQJAIAAgBGsiAkEQTwRAQeDfACACNgIAQezfACABIARqIgM2AgAgAyACQQFyNgIEIAAgAWogAjYCACABIARBA3I2AgQMAQtB7N8AQQA2AgBB4N8AQQA2AgAgASAAQQNyNgIEIAAgAWoiACAAKAIEQQFyNgIECyABQQhqIQAMCwsgBEHk3wAoAgAiA0kEQEHk3wAgAyAEayIBNgIAQfDfAEHw3wAoAgAiACAEaiICNgIAIAIgAUEBcjYCBCAAIARBA3I2AgQgAEEIaiEADAsLQQAhACAEQS9qIggCf0Gw4wAoAgAEQEG44wAoAgAMAQtBvOMAQn83AgBBtOMAQoCggICAgAQ3AgBBsOMAIAxBDGpBcHFB2KrVqgVzNgIAQcTjAEEANgIAQZTjAEEANgIAQYAgCyIBaiIGQQAgAWsiB3EiBSAETQ0KQZDjACgCACIBBEBBiOMAKAIAIgIgBWoiCSACTQ0LIAEgCUkNCwtBlOMALQAAQQRxDQUCQAJAQfDfACgCACIBBEBBmOMAIQADQCABIAAoAgAiAk8EQCACIAAoAgRqIAFLDQMLIAAoAggiAA0ACwtBABAeIgNBf0YNBiAFIQZBtOMAKAIAIgBBAWsiASADcQRAIAUgA2sgASADakEAIABrcWohBgsgBCAGTw0GIAZB/v///wdLDQZBkOMAKAIAIgAEQEGI4wAoAgAiASAGaiICIAFNDQcgACACSQ0HCyAGEB4iACADRw0BDAgLIAYgA2sgB3EiBkH+////B0sNBSAGEB4iAyAAKAIAIAAoAgRqRg0EIAMhAAsCQCAEQTBqIAZNDQAgAEF/Rg0AQbjjACgCACIBIAggBmtqQQAgAWtxIgFB/v///wdLBEAgACEDDAgLIAEQHkF/RwRAIAEgBmohBiAAIQMMCAtBACAGaxAeGgwFCyAAIQMgAEF/Rw0GDAQLAAtBACEFDAcLQQAhAwwFCyADQX9HDQILQZTjAEGU4wAoAgBBBHI2AgALIAVB/v///wdLDQEgBRAeIgNBABAeIgBPDQEgA0F/Rg0BIABBf0YNASAAIANrIgYgBEEoak0NAQtBiOMAQYjjACgCACAGaiIANgIAQYzjACgCACAASQRAQYzjACAANgIACwJAAkACQEHw3wAoAgAiAQRAQZjjACEAA0AgAyAAKAIAIgIgACgCBCIFakYNAiAAKAIIIgANAAsMAgtB6N8AKAIAIgBBACAAIANNG0UEQEHo3wAgAzYCAAtBACEAQZzjACAGNgIAQZjjACADNgIAQfjfAEF/NgIAQfzfAEGw4wAoAgA2AgBBpOMAQQA2AgADQCAAQQN0IgFBiOAAaiABQYDgAGoiAjYCACABQYzgAGogAjYCACAAQQFqIgBBIEcNAAtB5N8AIAZBKGsiAEF4IANrQQdxQQAgA0EIakEHcRsiAWsiAjYCAEHw3wAgASADaiIBNgIAIAEgAkEBcjYCBCAAIANqQSg2AgRB9N8AQcDjACgCADYCAAwCCyABIANPDQAgASACSQ0AIAAoAgxBCHENACAAIAUgBmo2AgRB8N8AIAFBeCABa0EHcUEAIAFBCGpBB3EbIgBqIgI2AgBB5N8AQeTfACgCACAGaiIDIABrIgA2AgAgAiAAQQFyNgIEIAEgA2pBKDYCBEH03wBBwOMAKAIANgIADAELQejfACgCACADSwRAQejfACADNgIACyADIAZqIQJBmOMAIQACQAJAAkACQAJAAkADQCACIAAoAgBHBEAgACgCCCIADQEMAgsLIAAtAAxBCHFFDQELQZjjACEAA0AgASAAKAIAIgJPBEAgAiAAKAIEaiICIAFLDQMLIAAoAgghAAwACwALIAAgAzYCACAAIAAoAgQgBmo2AgQgA0F4IANrQQdxQQAgA0EIakEHcRtqIgcgBEEDcjYCBCACQXggAmtBB3FBACACQQhqQQdxG2oiBiAHayAEayECIAQgB2ohBCABIAZGBEBB8N8AIAQ2AgBB5N8AQeTfACgCACACaiIANgIAIAQgAEEBcjYCBAwDCyAGQezfACgCAEYEQEHs3wAgBDYCAEHg3wBB4N8AKAIAIAJqIgA2AgAgBCAAQQFyNgIEIAAgBGogADYCAAwDCyAGKAIEIgBBA3FBAUYEQCAAQXhxIQgCQCAAQf8BTQRAIAYoAggiASAAQQN2IgVBA3RBgOAAakYaIAEgBigCDCIARgRAQdjfAEHY3wAoAgBBfiAFd3E2AgAMAgsgASAANgIMIAAgATYCCAwBCyAGKAIYIQkCQCAGIAYoAgwiA0cEQCAGKAIIIgAgAzYCDCADIAA2AggMAQsCQCAGQRRqIgAoAgAiAQ0AIAZBEGoiACgCACIBDQBBACEDDAELA0AgACEFIAEiA0EUaiIAKAIAIgENACADQRBqIQAgAygCECIBDQALIAVBADYCAAsgCUUNAAJAIAYgBigCHCIBQQJ0QYjiAGoiACgCAEYEQCAAIAM2AgAgAw0BQdzfAEHc3wAoAgBBfiABd3E2AgAMAgsgCUEQQRQgCSgCECAGRhtqIAM2AgAgA0UNAQsgAyAJNgIYIAYoAhAiAARAIAMgADYCECAAIAM2AhgLIAYoAhQiAEUNACADIAA2AhQgACADNgIYCyAGIAhqIQYgAiAIaiECCyAGIAYoAgRBfnE2AgQgBCACQQFyNgIEIAIgBGogAjYCACACQf8BTQRAIAJBA3YiAUEDdEGA4ABqIQACf0HY3wAoAgAiAkEBIAF0IgFxRQRAQdjfACABIAJyNgIAIAAMAQsgACgCCAshASAAIAQ2AgggASAENgIMIAQgADYCDCAEIAE2AggMAwtBHyEAIAJB////B00EQCACQQh2IgAgAEGA/j9qQRB2QQhxIgB0IgEgAUGA4B9qQRB2QQRxIgF0IgMgA0GAgA9qQRB2QQJxIgN0QQ92IAAgAXIgA3JrIgBBAXQgAiAAQRVqdkEBcXJBHGohAAsgBCAANgIcIARCADcCECAAQQJ0QYjiAGohAQJAQdzfACgCACIDQQEgAHQiBXFFBEBB3N8AIAMgBXI2AgAgASAENgIAIAQgATYCGAwBCyACQQBBGSAAQQF2ayAAQR9GG3QhACABKAIAIQMDQCADIgEoAgRBeHEgAkYNAyAAQR12IQMgAEEBdCEAIAEgA0EEcWpBEGoiBSgCACIDDQALIAUgBDYCACAEIAE2AhgLIAQgBDYCDCAEIAQ2AggMAgtB5N8AIAZBKGsiAEF4IANrQQdxQQAgA0EIakEHcRsiBWsiBzYCAEHw3wAgAyAFaiIFNgIAIAUgB0EBcjYCBCAAIANqQSg2AgRB9N8AQcDjACgCADYCACABIAJBJyACa0EHcUEAIAJBJ2tBB3EbakEvayIAIAAgAUEQakkbIgVBGzYCBCAFQaDjACkCADcCECAFQZjjACkCADcCCEGg4wAgBUEIajYCAEGc4wAgBjYCAEGY4wAgAzYCAEGk4wBBADYCACAFQRhqIQADQCAAQQc2AgQgAEEIaiEDIABBBGohACACIANLDQALIAEgBUYNAyAFIAUoAgRBfnE2AgQgASAFIAFrIgZBAXI2AgQgBSAGNgIAIAZB/wFNBEAgBkEDdiICQQN0QYDgAGohAAJ/QdjfACgCACIDQQEgAnQiAnFFBEBB2N8AIAIgA3I2AgAgAAwBCyAAKAIICyECIAAgATYCCCACIAE2AgwgASAANgIMIAEgAjYCCAwEC0EfIQAgAUIANwIQIAZB////B00EQCAGQQh2IgAgAEGA/j9qQRB2QQhxIgB0IgIgAkGA4B9qQRB2QQRxIgJ0IgMgA0GAgA9qQRB2QQJxIgN0QQ92IAAgAnIgA3JrIgBBAXQgBiAAQRVqdkEBcXJBHGohAAsgASAANgIcIABBAnRBiOIAaiECAkBB3N8AKAIAIgNBASAAdCIFcUUEQEHc3wAgAyAFcjYCACACIAE2AgAgASACNgIYDAELIAZBAEEZIABBAXZrIABBH0YbdCEAIAIoAgAhAwNAIAMiAigCBEF4cSAGRg0EIABBHXYhAyAAQQF0IQAgAiADQQRxakEQaiIFKAIAIgMNAAsgBSABNgIAIAEgAjYCGAsgASABNgIMIAEgATYCCAwDCyABKAIIIgAgBDYCDCABIAQ2AgggBEEANgIYIAQgATYCDCAEIAA2AggLIAdBCGohAAwFCyACKAIIIgAgATYCDCACIAE2AgggAUEANgIYIAEgAjYCDCABIAA2AggLQeTfACgCACIAIARNDQBB5N8AIAAgBGsiATYCAEHw3wBB8N8AKAIAIgAgBGoiAjYCACACIAFBAXI2AgQgACAEQQNyNgIEIABBCGohAAwDC0HU3wBBMDYCAEEAIQAMAgsCQCAJRQ0AAkAgBSgCHCICQQJ0QYjiAGoiACgCACAFRgRAIAAgAzYCACADDQFB3N8AIAhBfiACd3EiCDYCAAwCCyAJQRBBFCAJKAIQIAVGG2ogAzYCACADRQ0BCyADIAk2AhggBSgCECIABEAgAyAANgIQIAAgAzYCGAsgBSgCFCIARQ0AIAMgADYCFCAAIAM2AhgLAkAgAUEPTQRAIAUgASAEaiIAQQNyNgIEIAAgBWoiACAAKAIEQQFyNgIEDAELIAUgBEEDcjYCBCAHIAFBAXI2AgQgASAHaiABNgIAIAFB/wFNBEAgAUEDdiIBQQN0QYDgAGohAAJ/QdjfACgCACICQQEgAXQiAXFFBEBB2N8AIAEgAnI2AgAgAAwBCyAAKAIICyEBIAAgBzYCCCABIAc2AgwgByAANgIMIAcgATYCCAwBC0EfIQAgAUH///8HTQRAIAFBCHYiACAAQYD+P2pBEHZBCHEiAHQiAiACQYDgH2pBEHZBBHEiAnQiBCAEQYCAD2pBEHZBAnEiBHRBD3YgACACciAEcmsiAEEBdCABIABBFWp2QQFxckEcaiEACyAHIAA2AhwgB0IANwIQIABBAnRBiOIAaiECAkACQCAIQQEgAHQiBHFFBEBB3N8AIAQgCHI2AgAgAiAHNgIAIAcgAjYCGAwBCyABQQBBGSAAQQF2ayAAQR9GG3QhACACKAIAIQQDQCAEIgIoAgRBeHEgAUYNAiAAQR12IQQgAEEBdCEAIAIgBEEEcWpBEGoiAygCACIEDQALIAMgBzYCACAHIAI2AhgLIAcgBzYCDCAHIAc2AggMAQsgAigCCCIAIAc2AgwgAiAHNgIIIAdBADYCGCAHIAI2AgwgByAANgIICyAFQQhqIQAMAQsCQCAKRQ0AAkAgAygCHCICQQJ0QYjiAGoiACgCACADRgRAIAAgBTYCACAFDQFB3N8AIAlBfiACd3E2AgAMAgsgCkEQQRQgCigCECADRhtqIAU2AgAgBUUNAQsgBSAKNgIYIAMoAhAiAARAIAUgADYCECAAIAU2AhgLIAMoAhQiAEUNACAFIAA2AhQgACAFNgIYCwJAIAFBD00EQCADIAEgBGoiAEEDcjYCBCAAIANqIgAgACgCBEEBcjYCBAwBCyADIARBA3I2AgQgCyABQQFyNgIEIAEgC2ogATYCACAIBEAgCEEDdiIEQQN0QYDgAGohAkHs3wAoAgAhAAJ/QQEgBHQiBCAGcUUEQEHY3wAgBCAGcjYCACACDAELIAIoAggLIQQgAiAANgIIIAQgADYCDCAAIAI2AgwgACAENgIIC0Hs3wAgCzYCAEHg3wAgATYCAAsgA0EIaiEACyAMQRBqJAAgAAvMDAEHfwJAIABFDQAgAEEIayICIABBBGsoAgAiAUF4cSIAaiEFAkAgAUEBcQ0AIAFBA3FFDQEgAiACKAIAIgFrIgJB6N8AKAIASQ0BIAAgAWohACACQezfACgCAEcEQCABQf8BTQRAIAIoAggiBCABQQN2IgdBA3RBgOAAakYaIAQgAigCDCIBRgRAQdjfAEHY3wAoAgBBfiAHd3E2AgAMAwsgBCABNgIMIAEgBDYCCAwCCyACKAIYIQYCQCACIAIoAgwiA0cEQCACKAIIIgEgAzYCDCADIAE2AggMAQsCQCACQRRqIgEoAgAiBA0AIAJBEGoiASgCACIEDQBBACEDDAELA0AgASEHIAQiA0EUaiIBKAIAIgQNACADQRBqIQEgAygCECIEDQALIAdBADYCAAsgBkUNAQJAIAIgAigCHCIEQQJ0QYjiAGoiASgCAEYEQCABIAM2AgAgAw0BQdzfAEHc3wAoAgBBfiAEd3E2AgAMAwsgBkEQQRQgBigCECACRhtqIAM2AgAgA0UNAgsgAyAGNgIYIAIoAhAiAQRAIAMgATYCECABIAM2AhgLIAIoAhQiAUUNASADIAE2AhQgASADNgIYDAELIAUoAgQiAUEDcUEDRw0AQeDfACAANgIAIAUgAUF+cTYCBCACIABBAXI2AgQgACACaiAANgIADwsgAiAFTw0AIAUoAgQiAUEBcUUNAAJAIAFBAnFFBEAgBUHw3wAoAgBGBEBB8N8AIAI2AgBB5N8AQeTfACgCACAAaiIANgIAIAIgAEEBcjYCBCACQezfACgCAEcNA0Hg3wBBADYCAEHs3wBBADYCAA8LIAVB7N8AKAIARgRAQezfACACNgIAQeDfAEHg3wAoAgAgAGoiADYCACACIABBAXI2AgQgACACaiAANgIADwsgAUF4cSAAaiEAAkAgAUH/AU0EQCAFKAIIIgQgAUEDdiIHQQN0QYDgAGpGGiAEIAUoAgwiAUYEQEHY3wBB2N8AKAIAQX4gB3dxNgIADAILIAQgATYCDCABIAQ2AggMAQsgBSgCGCEGAkAgBSAFKAIMIgNHBEAgBSgCCCIBQejfACgCAEkaIAEgAzYCDCADIAE2AggMAQsCQCAFQRRqIgEoAgAiBA0AIAVBEGoiASgCACIEDQBBACEDDAELA0AgASEHIAQiA0EUaiIBKAIAIgQNACADQRBqIQEgAygCECIEDQALIAdBADYCAAsgBkUNAAJAIAUgBSgCHCIEQQJ0QYjiAGoiASgCAEYEQCABIAM2AgAgAw0BQdzfAEHc3wAoAgBBfiAEd3E2AgAMAgsgBkEQQRQgBigCECAFRhtqIAM2AgAgA0UNAQsgAyAGNgIYIAUoAhAiAQRAIAMgATYCECABIAM2AhgLIAUoAhQiAUUNACADIAE2AhQgASADNgIYCyACIABBAXI2AgQgACACaiAANgIAIAJB7N8AKAIARw0BQeDfACAANgIADwsgBSABQX5xNgIEIAIgAEEBcjYCBCAAIAJqIAA2AgALIABB/wFNBEAgAEEDdiIBQQN0QYDgAGohAAJ/QdjfACgCACIEQQEgAXQiAXFFBEBB2N8AIAEgBHI2AgAgAAwBCyAAKAIICyEBIAAgAjYCCCABIAI2AgwgAiAANgIMIAIgATYCCA8LQR8hASACQgA3AhAgAEH///8HTQRAIABBCHYiASABQYD+P2pBEHZBCHEiAXQiBCAEQYDgH2pBEHZBBHEiBHQiAyADQYCAD2pBEHZBAnEiA3RBD3YgASAEciADcmsiAUEBdCAAIAFBFWp2QQFxckEcaiEBCyACIAE2AhwgAUECdEGI4gBqIQQCQAJAAkBB3N8AKAIAIgNBASABdCIFcUUEQEHc3wAgAyAFcjYCACAEIAI2AgAgAiAENgIYDAELIABBAEEZIAFBAXZrIAFBH0YbdCEBIAQoAgAhAwNAIAMiBCgCBEF4cSAARg0CIAFBHXYhAyABQQF0IQEgBCADQQRxakEQaiIFKAIAIgMNAAsgBSACNgIAIAIgBDYCGAsgAiACNgIMIAIgAjYCCAwBCyAEKAIIIgAgAjYCDCAEIAI2AgggAkEANgIYIAIgBDYCDCACIAA2AggLQfjfAEH43wAoAgBBAWsiAkF/IAIbNgIACwtVAQJ/QdDfACgCACIBIABBA2pBfHEiAmohAAJAIAJBAU5BACAAIAFNGw0APwBBEHQgAEkEQCAAEABFDQELQdDfACAANgIAIAEPC0HU3wBBMDYCAEF/C4IEAQN/IAJBgARPBEAgACABIAIQARogAA8LIAAgAmohAwJAIAAgAXNBA3FFBEACQCACQQFIBEAgACECDAELIABBA3FFBEAgACECDAELIAAhAgNAIAIgAS0AADoAACABQQFqIQEgAkEBaiICIANPDQEgAkEDcQ0ACwsCQCADQXxxIgRBwABJDQAgAiAEQUBqIgVLDQADQCACIAEoAgA2AgAgAiABKAIENgIEIAIgASgCCDYCCCACIAEoAgw2AgwgAiABKAIQNgIQIAIgASgCFDYCFCACIAEoAhg2AhggAiABKAIcNgIcIAIgASgCIDYCICACIAEoAiQ2AiQgAiABKAIoNgIoIAIgASgCLDYCLCACIAEoAjA2AjAgAiABKAI0NgI0IAIgASgCODYCOCACIAEoAjw2AjwgAUFAayEBIAJBQGsiAiAFTQ0ACwsgAiAETw0BA0AgAiABKAIANgIAIAFBBGohASACQQRqIgIgBEkNAAsMAQsgA0EESQRAIAAhAgwBCyAAIANBBGsiBEsEQCAAIQIMAQsgACECA0AgAiABLQAAOgAAIAIgAS0AAToAASACIAEtAAI6AAIgAiABLQADOgADIAFBBGohASACQQRqIgIgBE0NAAsLIAIgA0kEQANAIAIgAS0AADoAACABQQFqIQEgAkEBaiICIANHDQALCyAAC9YCAQJ/AkAgAUUNACAAIAFqIgJBAWtBADoAACAAQQA6AAAgAUEDSQ0AIAJBAmtBADoAACAAQQA6AAEgAkEDa0EAOgAAIABBADoAAiABQQdJDQAgAkEEa0EAOgAAIABBADoAAyABQQlJDQAgAEEAIABrQQNxIgNqIgJBADYCACACIAEgA2tBfHEiA2oiAUEEa0EANgIAIANBCUkNACACQQA2AgggAkEANgIEIAFBCGtBADYCACABQQxrQQA2AgAgA0EZSQ0AIAJBADYCGCACQQA2AhQgAkEANgIQIAJBADYCDCABQRBrQQA2AgAgAUEUa0EANgIAIAFBGGtBADYCACABQRxrQQA2AgAgAyACQQRxQRhyIgNrIgFBIEkNACACIANqIQIDQCACQgA3AxggAkIANwMQIAJCADcDCCACQgA3AwAgAkEgaiECIAFBIGsiAUEfSw0ACwsLBAAjAAsGACAAJAALEAAjACAAa0FwcSIAJAAgAAsLvVYIAEGECAvxQJYwB3csYQ7uulEJmRnEbQeP9GpwNaVj6aOVZJ4yiNsOpLjceR7p1eCI2dKXK0y2Cb18sX4HLbjnkR2/kGQQtx3yILBqSHG5895BvoR91Noa6+TdbVG11PTHhdODVphsE8Coa2R6+WL97Mllik9cARTZbAZjYz0P+vUNCI3IIG47XhBpTORBYNVycWei0eQDPEfUBEv9hQ3Sa7UKpfqotTVsmLJC1sm720D5vKzjbNgydVzfRc8N1txZPdGrrDDZJjoA3lGAUdfIFmHQv7X0tCEjxLNWmZW6zw+lvbieuAIoCIgFX7LZDMYk6Quxh3xvLxFMaFirHWHBPS1mtpBB3HYGcdsBvCDSmCoQ1e+JhbFxH7W2BqXkv58z1LjooskHeDT5AA+OqAmWGJgO4bsNan8tPW0Il2xkkQFcY+b0UWtrYmFsHNgwZYVOAGLy7ZUGbHulARvB9AiCV8QP9cbZsGVQ6bcS6ri+i3yIufzfHd1iSS3aFfN804xlTNT7WGGyTc5RtTp0ALyj4jC71EGl30rXldg9bcTRpPv01tNq6WlD/NluNEaIZ63QuGDacy0EROUdAzNfTAqqyXwN3TxxBVCqQQInEBALvoYgDMkltWhXs4VvIAnUZrmf5GHODvneXpjJ2SkimNCwtKjXxxc9s1mBDbQuO1y9t61susAgg7jttrO/mgzitgOa0rF0OUfV6q930p0VJtsEgxbccxILY+OEO2SUPmptDahaanoLzw7knf8JkyeuAAqxngd9RJMP8NKjCIdo8gEe/sIGaV1XYvfLZ2WAcTZsGecGa252G9T+4CvTiVp62hDMSt1nb9+5+fnvvo5DvrcX1Y6wYOij1tZ+k9GhxMLYOFLy30/xZ7vRZ1e8pt0GtT9LNrJI2isN2EwbCq/2SgM2YHoEQcPvYN9V32eo745uMXm+aUaMs2HLGoNmvKDSbyU24mhSlXcMzANHC7u5FgIiLyYFVb47usUoC72yklq0KwRqs1yn/9fCMc/QtYue2Swdrt5bsMJkmybyY+yco2p1CpNtAqkGCZw/Ng7rhWcHchNXAAWCSr+VFHq44q4rsXs4G7YMm47Skg2+1eW379x8Id/bC9TS04ZC4tTx+LPdaG6D2h/NFr6BWya59uF3sG93R7cY5loIiHBqD//KOwZmXAsBEf+eZY9prmL40/9rYUXPbBZ44gqg7tIN11SDBE7CswM5YSZnp/cWYNBNR2lJ23duPkpq0a7cWtbZZgvfQPA72DdTrrypxZ673n/Pskfp/7UwHPK9vYrCusowk7NTpqO0JAU20LqTBtfNKVfeVL9n2SMuemazuEphxAIbaF2UK28qN74LtKGODMMb3wVaje8CLQAAAABBMRsZgmI2MsNTLSsExWxkRfR3fYanWlbHlkFPCIrZyEm7wtGK6O/6y9n04wxPtaxNfq61ji2Dns8cmIdREsJKECPZU9Nw9HiSQe9hVdeuLhTmtTfXtZgcloSDBVmYG4IYqQCb2/otsJrLNqldXXfmHGxs/98/QdSeDlrNoiSEleMVn4wgRrKnYXepvqbh6PHn0PPoJIPew2Wyxdqqrl1d659GRCjMa29p/XB2rmsxOe9aKiAsCQcLbTgcEvM2Rt+yB13GcVRw7TBla/T38yq7tsIxonWRHIk0oAeQ+7yfF7qNhA553qklOO+yPP9583O+SOhqfRvFQTwq3lgFT3nwRH5i6YctT8LGHFTbAYoVlEC7Do2D6COmwtk4vw3FoDhM9Lshj6eWCs6WjRMJAMxcSDHXRYti+m7KU+F3VF27uhVsoKPWP42Ilw6WkVCY194RqczH0vrh7JPL+vVc12JyHeZ5a961VECfhE9ZWBIOFhkjFQ/acDgkm0EjPadr/WXmWuZ8JQnLV2Q40E6jrpEB4p+KGCHMpzNg/bwqr+Ekre7QP7QtgxKfbLIJhqskSMnqFVPQKUZ++2h3ZeL2eT8vt0gkNnQbCR01KhIE8rxTS7ONSFJw3mV5Me9+YP7z5ue/wv3+fJHQ1T2gy8z6NoqDuweRmnhUvLE5ZaeoS5iDOwqpmCLJ+rUJiMuuEE9d718ObPRGzT/ZbYwOwnRDElrzAiNB6sFwbMGAQXfYR9c2lwbmLY7FtQClhIQbvBqKQXFbu1pomOh3Q9nZbFoeTy0VX342DJwtGyfdHAA+EgCYuVMxg6CQYq6L0VO1khbF9N1X9O/ElKfC79WW2fbpvAeuqI0ct2veMZwq7yqF7XlryqxIcNNvG134LipG4eE23magB8V/Y1ToVCJl803l87ICpMKpG2eRhDAmoJ8puK7F5Pmf3v06zPPWe/3oz7xrqYD9WrKZPgmfsn84hKuwJBws8RUHNTJGKh5zdzEHtOFwSPXQa1E2g0Z6d7JdY07X+ssP5uHSzLXM+Y2E1+BKEpavCyONtshwoJ2JQbuERl0jAwdsOBrEPxUxhQ4OKEKYT2cDqVR+wPp5VYHLYkwfxTiBXvQjmJ2nDrPclhWqGwBU5VoxT/yZYmLX2FN5zhdP4UlWfvpQlS3Xe9QczGITio0tUruWNJHoux/Q2aAG7PN+Xq3CZUdukUhsL6BTdeg2EjqpBwkjalQkCCtlPxHkeaeWpUi8j2YbkaQnKoq94LzL8qGN0Oti3v3AI+/m2b3hvBT80KcNP4OKJn6ykT+5JNBw+BXLaTtG5kJ6d/1btWtl3PRafsU3CVPudjhI97GuCbjwnxKhM8w/inL9JJMAAAAAN2rCAW7UhANZvkYC3KgJB+vCywayfI0EhRZPBbhREw6PO9EP1oWXDeHvVQxk+RoJU5PYCAotngo9R1wLcKMmHEfJ5B0ed6IfKR1gHqwLLxubYe0awt+rGPW1aRnI8jUS/5j3E6YmsRGRTHMQFFo8FSMw/hR6jrgWTeR6F+BGTTjXLI85jpLJO7n4Czo87kQ/C4SGPlI6wDxlUAI9WBdeNm99nDc2w9o1AakYNIS/VzGz1ZUw6mvTMt0BETOQ5Wskp4+pJf4x7yfJWy0mTE1iI3snoCIimeYgFfMkISi0eCof3rorRmD8KXEKPij0HHEtw3azLJrI9S6tojcvwI2acPfnWHGuWR5zmTPcchwlk3crT1F2cvEXdEWb1XV43Il+T7ZLfxYIDX0hYs98pHSAeZMeQnjKoAR6/crGe7AuvGyHRH5t3vo4b+mQ+m5shrVrW+x3agJSMWg1OPNpCH+vYj8VbWNmqythUcHpYNTXpmXjvWRkugMiZo1p4Gcgy9dIF6EVSU4fU0t5dZFK/GPeT8sJHE6St1pMpd2YTZiaxEav8AZH9k5ARcEkgkREMs1Bc1gPQCrmSUIdjItDUGjxVGcCM1U+vHVXCda3VozA+FO7qjpS4hR8UNV+vlHoOeJa31MgW4btZlmxh6RYNJHrXQP7KVxaRW9ebS+tX4AbNeG3cffg7s+x4tmlc+Ncszzma9n+5zJnuOUFDXrkOEom7w8g5O5WnqLsYfRg7eTiL+jTiO3pijar671caerwuBP9x9LR/J5sl/6pBlX/LBAa+ht62PtCxJ75da5c+EjpAPN/g8LyJj2E8BFXRvGUQQn0oyvL9fqVjffN/0/2YF142Vc3utgOifzaOeM+27z1cd6Ln7Pf0iH13eVLN9zYDGvX72ap1rbY79SBsi3VBKRi0DPOoNFqcObTXRok0hD+XsUnlJzEfiraxklAGMfMVlfC+zyVw6KC08GV6BHAqK9Ny5/Fj8rGe8nI8RELyXQHRMxDbYbNGtPAzy25As5Alq+Rd/xtkC5CK5IZKOmTnD6mlqtUZJfy6iKVxYDglPjHvJ/PrX6elhM4nKF5+p0kb7WYEwV3mUq7MZt90fOaMDWJjQdfS4xe4Q2OaYvPj+ydgIrb90KLgkkEibUjxoiIZJqDvw5YguawHoDR2tyBVMyThGOmUYU6GBeHDXLVhqDQ4qmXuiCozgRmqvlupKt8eOuuSxIprxKsb60lxq2sGIHxpy/rM6Z2VXWkQT+3pcQp+KDzQzqhqv18o52XvqLQc8S15xkGtL6nQLaJzYK3DNvNsjuxD7NiD0mxVWWLsGgi17tfSBW6BvZTuDGckbm0it68g+AcvdpeWr/tNJi+AAAAAGVnvLiLyAmq7q+1EleXYo8y8N433F9rJbk4153vKLTFik8IfWTgvW8BhwHXuL/WSt3YavIzd9/gVhBjWJ9XGVD6MKXoFJ8Q+nH4rELIwHvfrafHZ0MIcnUmb87NcH+tlRUYES37t6Q/ntAYhyfozxpCj3OirCDGsMlHegg+rzKgW8iOGLVnOwrQAIeyaThQLwxf7Jfi8FmFh5flPdGHhmW04DrdWk+Pzz8oM3eGEOTq43dYUg3Y7UBov1H4ofgr8MSfl0gqMCJaT1ee4vZvSX+TCPXHfadA1RjA/G1O0J81K7cjjcUYlp+gfyonGUf9unwgQQKSj/QQ9+hIqD1YFJtYP6gjtpAdMdP3oYlqz3YUD6jKrOEHf76EYMMG0nCgXrcXHOZZuKn0PN8VTIXnwtHggH5pDi/Le2tId8OiDw3Lx2ixcynHBGFMoLjZ9ZhvRJD/0/x+UGbuGzfaVk0nuQ4oQAW2xu+wpKOIDBwasNuBf9dnOZF40iv0H26TA/cmO2aQmoOIPy+R7ViTKVRgRLQxB/gM36hNHrrP8abs35L+ibguRmcXm1QCcCfsu0jwcd4vTMkwgPnbVedFY5ygP2v5x4PTF2g2wXIPinnLN13krlDhXED/VE4lmOj2c4iLrhbvNxb4QIIEnSc+vCQf6SFBeFWZr9fgi8qwXDM7tlntXtHlVbB+UEfVGez/bCE7YglGh9rn6TLIgo6OcNSe7Six+VGQX1bkgjoxWDqDCY+n5m4zHwjBhg1tpjq1pOFAvcGG/AUvKUkXSk71r/N2IjKWEZ6KeL4rmB3ZlyBLyfR4Lq5IwMAB/dKlZkFqHF6W93k5Kk+Xlp9d8vEj5QUZa01gftf1jtFi5+u23l9SjgnCN+m1etlGAGi8IbzQ6jHfiI9WYzBh+dYiBJ5qmr2mvQfYwQG/Nm60rVMJCBWaTnId/ynOpRGGe7d04ccPzdkQkqi+rCpGERk4I3algHVmxtgQAXpg/q7PcpvJc8oi8aRXR5YY76k5rf3MXhFFBu5NdmOJ8c6NJkTc6EH4ZFF5L/k0HpNB2rEmU7/WmuvpxvmzjKFFC2IO8BkHaUyhvlGbPNs2J4Q1mZKWUP4uLpm5VCb83uieEnFdjHcW4TTOLjapq0mKEUXmPwMggYO7dpHg4xP2XFv9WelJmD5V8SEGgmxEYT7Uqs6Lxs+pN344QX/WXSbDbrOJdnzW7srEb9YdWQqxoeHkHhTzgXmoS9dpyxOyDnerXKHCuTnGfgGA/qmc5ZkVJAs2oDZuURyOpxZmhsJx2j4s3m8sSbnTlPCBBAmV5rixe0kNox4usRtIPtJDLVlu+8P22+mmkWdRH6mwzHrODHSUYblm8QYF3gAAAAB3BzCW7g5hLJkJUboHbcQZcGr0j+ljpTWeZJWjDtuIMnncuKTg1ekel9LZiAm2TCt+sXy957gtB5C/HZEdtxBkarAg8vO5cUiEvkHeGtrUfW3d5Ov01LVRg9OFxxNsmFZka6jA/WL5eoplyewUAVxPYwZs2foPPWONCA31O24gyExpEF7VYEHkomdxcjwD5NFLBNRH0g2F/aUKtWs1taj6QrKYbNu7ydasvPlAMths40XfXHXc1g3Pq9E9WSbZMKxR3gA6yNdRgL/QYRYhtPS1VrPEI8+6lZm4vaUPKAK4nl8FiAjGDNmysQvpJC9vfIdYaEwRwWEdq7ZmLT123EGQAdtxBpjSILzv1RAqcbGFiQa2tR+fv+Sl6LjUM3gHyaIPAPk0lgmojuEOmBh/ag27CG09LZFkbJfmY1wBa2tR9BxsYWKFZTDY8mIATmwGle0bAaV7ggj0wfUPxFdlsNnGErfpUIu+uOr8uYh8Yt0d3xXaLUmM03zz+9RMZU2yYVg6tVHOo7wAdNS7MOJK36VBPdiV16TRxG3T1vT7Q2npajRu2fytZ4hG2mC40EQELXMzAx3lqgpMX90NfMlQBXE8JwJBqr4LEBDJDCCGV2i1JSBvhbO5ZtQJzmHkn17e+Q4p2cmYsNCYIsfXqLRZsz0XLrQNgbe9XDvAumyt7biDIJq/s7YDtuIMdLHSmurVRzmd0nevBNsmFXPcFoPjYwsSlGQ7hA1taj56alqo5A7PC5MJ/50KAK4nfQeesfAPk0SHCKPSHgHyaGkGwv73YlddgGVnyxlsNnFuawbn/tQbdonTK+AQ2npaZ91KzPm532+Ovu/5F7e+Q2CwjtXW1qPoodGTfjjYwsRP3/JS0btn8aa8V2c/tQbdSLI2S9gNK9qvChtMNgNK9kEEemDfYO/DqGffVTFuju9Gab55y2GzjLxmgxolb9KgUmjiNswMd5W7C0cDIgIWuVUFJi/Fuju+sr0LKCu0WpJcs2oEwtf/p7XQzzEs2Z6LW96uHZtkwrDsY/ImdWqjnAJtkwqcCQap6w42P3IHZ4UFAFcTlb9KguK4ehR7sSuuDLYbOJLSjpvl1b4NfNzvtwvb3yGG09LU8dTiQmjds/gf2oNugb4Wzfa5JltvsHfhGLdHd4gIWub/D2pwZgY7yhEBC1yPZZ7/+GKuaWFr/9MWbM9FoArieNcN0u5OBINUOQOzwqdnJmHQYBb3SWlHTT5ud9uu0WpK2dZa3EDfC2Y32DvwqbyuU967nsVHss9/MLX/6b298hzKusKKU7OTMCS0o6a60DYFzdcGk1TeVykj2We/s2Z6LsRhSrhdaBsCKm8rlLQLvjfDDI6hWgXfGy0C740AAAAAGRsxQTI2YoIrLVPDZGzFBH139EVWWqeGT0GWx8jZigjRwrtJ+u/oiuP02custU8Mta5+TZ6DLY6HmBzPSsISUVPZIxB49HDTYe9Bki6u11U3teYUHJi11wWDhJaCG5hZmwCpGLAt+tupNsua5nddXf9sbBzUQT/fzVoOnpWEJKKMnxXjp7JGIL6pd2Hx6OGm6PPQ58PegyTaxbJlXV2uqkRGn+tva8wodnD9aTkxa64gKlrvCwcJLBIcOG3fRjbzxl0Hsu1wVHH0a2Uwuyrz96IxwraJHJF1kAegNBefvPsOhI26JaneeTyy7zhz83n/auhIvkHFG31Y3io88HlPBelifkTCTy2H21QcxpQVigGNDrtApiPog7842cI4oMUNIbv0TAqWp48TjZbOXMwACUXXMUhu+mKLd+FTyrq7XVSjoGwViI0/1pGWDpfe15hQx8ypEezh+tL1+suTcmLXXGt55h1AVLXeWU+EnxYOElgPFSMZJDhw2j0jQZtl/WunfOZa5lfLCSVO0DhkAZGuoxiKn+Izp8whKrz9YK0k4a+0P9DunxKDLYYJsmzJSCSr0FMV6vt+RiniZXdoLz959jYkSLcdCRt0BBIqNUtTvPJSSI2zeWXecGB+7zHn5vP+/v3Cv9XQkXzMy6A9g4o2+pqRB7uxvFR4qKdlOTuDmEsimKkKCbX6yRCuy4hf711PRvRsDm3ZP810wg6M81oSQ+pBIwLBbHDB2HdBgJc210eOLeYGpQC1xbwbhIRxQYoaaFq7W0N36JhabNnZFS1PHgw2fl8nGy2cPgAc3bmYABKggzFTi65ikJK1U9Hd9MUWxO/0V+/Cp5T22ZbVrge86bccjaicMd5rhSrvKspree3TcEis+F0bb+FGKi5m3jbhf8UHoFToVGNN82UiArLz5RupwqQwhJFnKZ+gJuTFrrj93p/51vPMOs/o/XuAqWu8mbJa/bKfCT6rhDh/LBwksDUHFfEeKkYyBzF3c0hw4bRRa9D1ekaDNmNdsnfL+tdO0uHmD/nMtczg14SNr5YSSraNIwudoHDIhLtBiQMjXUYaOGwHMRU/xCgODoVnT5hCflSpA1V5+sBMYsuBgTjFH5gj9F6zDqedqhWW3OVUABv8TzFa12Jimc55U9hJ4U8XUPp+VnvXLZVizBzULY2KEzSWu1Ifu+iRBqDZ0F5+8+xHZcKtbEiRbnVToC86EjboIwkHqQgkVGoRP2Urlqd55I+8SKWkkRtmvYoqJ/LLvODr0I2hwP3eYtnm7yMUvOG9DafQ/CaKgz8/kbJ+cNAkuWnLFfhC5kY7W/13etxla7XFflr07lMJN/dIOHa4Ca6xoRKf8Io/zDOTJP1yAAAAAAHCajcDhNRuAka+WQcJqNwGy8LrBI18sgVPFoUOE1G4D9E7jw2XhdYMVe/hCRr5ZAjYk1MKni0KC1xHPRwmo3Ad5MlHH6J3Hh5gHSkbLwusGu1hmxir38IZabX1EjXyyBP3mP8RsSamEHNMkRU8WhQU/jAjFriOehd65E04TUbgOY8s1zvJko46C/i5P0TuPD6GhAs8wDpSPQJQZTZeF1g3nH1vNdrDNjQYqQExV7+EMJXVszLTa+ozEQHdJGvlkCWpj6cn7zH+Ji1bySNiTUwioCd7IOaZIiEk8xUqeLQoK7reHyn8YEYoPgpxLXEc9CyzdsMu9ciaLzeirXCajcBxWOf3cx5ZrnLcM5l3kyUcdlFPK3QX8XJ11ZtFfonceH9Ltk99DQgWfM9iIXmAdKR4Qh6TegSgynvGyv1svC6wbX5Eh284+t5u+pDpa7WGbGp37FtoMVICafM4NWKvfwhjbRU/YSurZmDpwVFlptfUZGS942YiA7pn4GmNSNfLIEkVoRdLUx9OSpF1eU/eY/xOHAnLTFq3kk2Y3aVGxJqYRwbwr0VATvZEgiTBQc0yREAPWHNCSeYqQ4uMHVTxaFBVMwJnV3W8Pla31glT+MCMUjqqu1B8FOJRvn7VWuI56FsgU99ZZu2GWKSHsV3rkTRcKfsDXm9FWl+tL23hNRuA4Pdxt+Kxz+7jc6XZ5jyzXOf+2WvluGcy5HoNBe8mSjju5CAP7KKeVu1g9GHoL+Lk6e2I0+urNorqaVy9/RO48PzR0sf+l2ye/1UGqfoaECz72Hob+Z7EQvhcrnXzAOlI8sKDf/CEPSbxRlcR9AlBlPXLK6P3jZX69k//zdl4XWDYujdX2vyJDts+4znecfW837Ofi931IdLcN0vl12sM2NapZu/U79i21S2ygdBipATRoM4z0+ZwatIkGl3FXv4QxJyUJ8baKn7HGEBJwldWzMOVPPvB04KiwBHolctNr6jKj8WfyMl7xskLEfHMRAd0zYZtQ8/A0xrOArktka+WQJBt/HeSK0Iuk+koGZamPpyXZFSrlSLq8pTggMWfvMf4nn6tz5w4E5ad+nmhmLVvJJl3BRObMbtKmvPRfY2JNTCMS18Hjg3hXo/Pi2mKgJ3si0L324kESYKIxiO1g5pkiIJYDr+AHrDmgdza0YSTzFSFUaZjhxcYOobVcg2p4tCgqCC6l6pmBM6rpG75rut4fK8pEkutb6wSrK3GJafxgRimM+svpHVVdqW3P0Gg+CnEoTpD86N8/aqivpedtcRz0LQGGee2QKe+t4LNibLN2wyzD7E7sUkPYrCLZVW71yJouhVIX7hT9ga5kZwxvN6KtL0c4IO/Wl7avpg07QAAAAC4vGdlqgnIixK1r+6PYpdXN97wMiVrX9yd1zi5xbQo730IT4pvveBk1wGHAUrWv7jyatjd4N93M1hjEFZQGVef6KUw+voQnxRCrPhx33vAyGfHp611cghDzc5vJpWtf3AtERgVP6S3+4cY0J4az+gnonOPQrDGIKwIekfJoDKvPhiOyFsKO2e1socA0C9QOGmX7F8MhVnw4j3ll4dlhofR3TrgtM+PT1p3Myg/6uQQhlJYd+NA7dgN+FG/aPAr+KFIl5/EWiIwKuKeV09/SW/2x/UIk9VAp31t/MAYNZ/QTo0jtyuflhjFJyp/oLr9RxkCQSB8EPSPkqhI6PebFFg9I6g/WDEdkLaJoffTFHbPaqzKqA++fwfhBsNghF6gcNLmHBe39Km4WUwV3zzRwueFaX6A4HvLLw7Dd0hryw0PonOxaMdhBMcp2bigTERvmPX80/+Q7mZQflbaNxsOuSdNtgVAKKSw78YcDIijgduwGjln138r0niRk24f9Dsm9wODmpBmkS8/iCmTWO20RGBUDPgHMR5NqN+m8c+6/pLf7EYuuIlUmxdn7CdwAnHwSLvJTC/e2/mAMGNF51VrP6Cc04PH+cE2aBd5ig9y5F03y1zhUK5OVP9A9uiYJa6LiHMWN+8WBIJA+Lw+J50h6R8kmVV4QYvg168zXLDK7Vm2O1Xl0V5HUH6w/+wZ1WI7IWzah0YJyDLp53COjoIo7Z7UkFH5sYLkVl86WDE6p48Jgx8zbuYNhsEItTqmbb1A4aQF/IbBF0kpL6/1TkoyInbzip4Rlpgrvnggl9kdePTJS8BIri7S/QHAakFmpfeWXhxPKjl5XZ+Wl+Uj8fJNaxkF9dd+YOdi0Y5f3rbrwgmOUnq16TdoAEbZ0LwhvIjfMeowY1aPItb5YZpqngQHvaa9vwHB2K20bjYVCAlTHXJOmqXOKf+3e4YRD8fhdJIQ2c0qrL6oOBkRRoCldiPYxmZ1YHoBEHLPrv7Kc8mbV6TxIu8Ylkf9rTmpRRFezHZN7gbO8Ylj3EQmjWT4Qej5L3lRQZMeNFMmsdrrmta/s/nG6QtFoYwZ8A5ioUxpBzybUb6EJzbblpKZNS4u/lAmVLmZnuje/IxdcRI04RZ3qTYuzhGKSasDP+ZFu4OBIOPgkXZbXPYTSelZ/fFVPphsggYh1D5hRMaLzqp+N6nP1n9BOG7DJl18domzxMru1lkd1m/hobEK8xQe5EuoeYETy2nXq3cOsrnCoVwBfsY5nKn+gCQVmeU2oDYLjhxRboZmFqc+2nHCLG/eLJTTuUkJBIHwsbjmlaMNSXsbsS4eQ9I+SPtuWS3p2/bDUWeRpsywqR90DM56ZrlhlN4FBvEAAAAAAAAAAAMAAAAEAAQACAAEAAQAAAAEAAUAEAAIAAQAAAAEAAYAIAAgAAQAAAAEAAQAEAAQAAUAAAAIABAAIAAgAAUAAAAIABAAgACAAAUAAAAIACAAgAAAAQUAAAAgAIAAAgEABAUAAAAgAAIBAgEAEAUAQYHJAAu2EAECAwQEBQUGBgYGBwcHBwgICAgICAgICQkJCQkJCQkKCgoKCgoKCgoKCgoKCgoKCwsLCwsLCwsLCwsLCwsLCwwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDwAAEBESEhMTFBQUFBUVFRUWFhYWFhYWFhcXFxcXFxcXGBgYGBgYGBgYGBgYGBgYGBkZGRkZGRkZGRkZGRkZGRkaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHB0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0AAQIDBAUGBwgICQkKCgsLDAwMDA0NDQ0ODg4ODw8PDxAQEBAQEBAQERERERERERESEhISEhISEhMTExMTExMTFBQUFBQUFBQUFBQUFBQUFBUVFRUVFRUVFRUVFRUVFRUWFhYWFhYWFhYWFhYWFhYWFxcXFxcXFxcXFxcXFxcXFxgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxscwCcAAMAsAAABAQAAHgEAAA8AAABALAAAQC0AAAAAAAAeAAAADwAAAAAAAADALQAAAAAAABMAAAAHAAAAAAAAAAwACACMAAgATAAIAMwACAAsAAgArAAIAGwACADsAAgAHAAIAJwACABcAAgA3AAIADwACAC8AAgAfAAIAPwACAACAAgAggAIAEIACADCAAgAIgAIAKIACABiAAgA4gAIABIACACSAAgAUgAIANIACAAyAAgAsgAIAHIACADyAAgACgAIAIoACABKAAgAygAIACoACACqAAgAagAIAOoACAAaAAgAmgAIAFoACADaAAgAOgAIALoACAB6AAgA+gAIAAYACACGAAgARgAIAMYACAAmAAgApgAIAGYACADmAAgAFgAIAJYACABWAAgA1gAIADYACAC2AAgAdgAIAPYACAAOAAgAjgAIAE4ACADOAAgALgAIAK4ACABuAAgA7gAIAB4ACACeAAgAXgAIAN4ACAA+AAgAvgAIAH4ACAD+AAgAAQAIAIEACABBAAgAwQAIACEACAChAAgAYQAIAOEACAARAAgAkQAIAFEACADRAAgAMQAIALEACABxAAgA8QAIAAkACACJAAgASQAIAMkACAApAAgAqQAIAGkACADpAAgAGQAIAJkACABZAAgA2QAIADkACAC5AAgAeQAIAPkACAAFAAgAhQAIAEUACADFAAgAJQAIAKUACABlAAgA5QAIABUACACVAAgAVQAIANUACAA1AAgAtQAIAHUACAD1AAgADQAIAI0ACABNAAgAzQAIAC0ACACtAAgAbQAIAO0ACAAdAAgAnQAIAF0ACADdAAgAPQAIAL0ACAB9AAgA/QAIABMACQATAQkAkwAJAJMBCQBTAAkAUwEJANMACQDTAQkAMwAJADMBCQCzAAkAswEJAHMACQBzAQkA8wAJAPMBCQALAAkACwEJAIsACQCLAQkASwAJAEsBCQDLAAkAywEJACsACQArAQkAqwAJAKsBCQBrAAkAawEJAOsACQDrAQkAGwAJABsBCQCbAAkAmwEJAFsACQBbAQkA2wAJANsBCQA7AAkAOwEJALsACQC7AQkAewAJAHsBCQD7AAkA+wEJAAcACQAHAQkAhwAJAIcBCQBHAAkARwEJAMcACQDHAQkAJwAJACcBCQCnAAkApwEJAGcACQBnAQkA5wAJAOcBCQAXAAkAFwEJAJcACQCXAQkAVwAJAFcBCQDXAAkA1wEJADcACQA3AQkAtwAJALcBCQB3AAkAdwEJAPcACQD3AQkADwAJAA8BCQCPAAkAjwEJAE8ACQBPAQkAzwAJAM8BCQAvAAkALwEJAK8ACQCvAQkAbwAJAG8BCQDvAAkA7wEJAB8ACQAfAQkAnwAJAJ8BCQBfAAkAXwEJAN8ACQDfAQkAPwAJAD8BCQC/AAkAvwEJAH8ACQB/AQkA/wAJAP8BCQAAAAcAQAAHACAABwBgAAcAEAAHAFAABwAwAAcAcAAHAAgABwBIAAcAKAAHAGgABwAYAAcAWAAHADgABwB4AAcABAAHAEQABwAkAAcAZAAHABQABwBUAAcANAAHAHQABwADAAgAgwAIAEMACADDAAgAIwAIAKMACABjAAgA4wAIAAAABQAQAAUACAAFABgABQAEAAUAFAAFAAwABQAcAAUAAgAFABIABQAKAAUAGgAFAAYABQAWAAUADgAFAB4ABQABAAUAEQAFAAkABQAZAAUABQAFABUABQANAAUAHQAFAAMABQATAAUACwAFABsABQAHAAUAFwAFAEHg2QALTQEAAAABAAAAAQAAAAEAAAACAAAAAgAAAAIAAAACAAAAAwAAAAMAAAADAAAAAwAAAAQAAAAEAAAABAAAAAQAAAAFAAAABQAAAAUAAAAFAEHQ2gALZQEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAUAAAAGAAAABgAAAAcAAAAHAAAACAAAAAgAAAAJAAAACQAAAAoAAAAKAAAACwAAAAsAAAAMAAAADAAAAA0AAAANAEGA3AALIwIAAAADAAAABwAAAAAAAAAQERIACAcJBgoFCwQMAw0CDgEPAEG03AALaQEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACgAAAAwAAAAOAAAAEAAAABQAAAAYAAAAHAAAACAAAAAoAAAAMAAAADgAAABAAAAAUAAAAGAAAABwAAAAgAAAAKAAAADAAAAA4ABBtN0AC5oCAQAAAAIAAAADAAAABAAAAAYAAAAIAAAADAAAABAAAAAYAAAAIAAAADAAAABAAAAAYAAAAIAAAADAAAAAAAEAAIABAAAAAgAAAAMAAAAEAAAABgAAAAgAAAAMAAAAEAAAABgAAAAgAAAAMAAAAEAAAABgAABuZWVkIGRpY3Rpb25hcnkAc3RyZWFtIGVuZAAAZmlsZSBlcnJvcgBzdHJlYW0gZXJyb3IAZGF0YSBlcnJvcgBpbnN1ZmZpY2llbnQgbWVtb3J5AGJ1ZmZlciBlcnJvcgBpbmNvbXBhdGlibGUgdmVyc2lvbgAAAAAoLwAAOC8AAEMvAABELwAATy8AAFwvAABnLwAAey8AAIgvAABDLwAAMS4yLjExAEHQ3wALA9AxUA==");let Lf,Pf;async function Df(){var e,t;if(Lf)return Lf;const i={};let n,o={};for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(o[n]=i[n]);let s=!1,a=!1,c=!1;s="object"==typeof window,a="function"==typeof importScripts,c="object"==typeof r&&"object"==typeof r.versions&&"string"==typeof r.versions.node;let l="";(s||a)&&(a?l=self.location.href:"undefined"!=typeof document&&document.currentScript&&(l=document.currentScript.src),l=0!==Lo(l).call(l,"blob:")?l.substr(0,Of(l).call(l,"/")+1):""),i.print||$o(e=console.log).call(e,console);const u=i.printErr||$o(t=console.warn).call(t,console);for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(i[n]=o[n]);let d;o=null,"object"!=typeof WebAssembly&&N("no native wasm support detected");let h=!1;function p(e){const t=i["_"+e];var r;return r="Cannot call unknown function "+e+", make sure it is exported",t||N("Assertion failed: "+r),t}function f(e,t,r,i,n){const o={string:function(e){let t=0;if(null!=e&&0!==e){const r=1+(e.length<<2);t=W(r),function(e,t,r){(function(e,t,r,i){if(!(i>0))return 0;const n=r+i-1;for(let o=0;o<e.length;++o){let i=e.charCodeAt(o);if(i>=55296&&i<=57343&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++o)),i<=127){if(r>=n)break;t[r++]=i}else if(i<=2047){if(r+1>=n)break;t[r++]=192|i>>6,t[r++]=128|63&i}else if(i<=65535){if(r+2>=n)break;t[r++]=224|i>>12,t[r++]=128|i>>6&63,t[r++]=128|63&i}else{if(r+3>=n)break;t[r++]=240|i>>18,t[r++]=128|i>>12&63,t[r++]=128|i>>6&63,t[r++]=128|63&i}}t[r]=0})(e,_,t,r)}(e,t,r)}return t},array:function(e){const t=W(e.length);var r,i;return r=e,i=t,m.set(r,i),t}},s=p(e),a=[];let c=0;if(i)for(let u=0;u<i.length;u++){const e=o[r[u]];e?(0===c&&(c=H()),a[u]=e(i[u])):a[u]=i[u]}let l=s.apply(null,a);return l=function(e){return"string"===t?(r=e)?function(e,t,r){const i=t+r;let n=t,o="";for(;e[n]&&!(n>=i);)++n;if(n-t>16&&e.subarray&&g)return g.decode(e.subarray(t,n));for(;t<n;){let r=e[t++];if(!(128&r)){o+=String.fromCharCode(r);continue}const i=63&e[t++];if(192==(224&r)){o+=String.fromCharCode((31&r)<<6|i);continue}const n=63&e[t++];if(r=224==(240&r)?(15&r)<<12|i<<6|n:(7&r)<<18|i<<12|n<<6|63&e[t++],r<65536)o+=String.fromCharCode(r);else{const e=r-65536;o+=String.fromCharCode(55296|e>>10,56320|1023&e)}}return o}(_,r,i):"":"boolean"===t?Boolean(e):e;var r,i}(l),0!==c&&Q(c),l}const g="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;let m,_,v,E,A,y,S,C,T;"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");const b=[],I=[],R=[],w=[];I.push({func:function(){U()}});let k=0,O=null;function N(e){throw i.onAbort&&i.onAbort(e),u(e+=""),h=!0,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(e)}i.preloadedImages={},i.preloadedAudios={};let L="deflate.wasm";var P,D;function M(e){for(;e.length>0;){const t=e.shift();if("function"==typeof t){t(i);continue}const r=t.func;"number"==typeof r?void 0===t.arg?T.get(r)():T.get(r)(t.arg):r(void 0===t.arg?null:t.arg)}}D="data:application/octet-stream;base64,",Is(P=L).call(P,D)||(L=function(e){return i.locateFile?i.locateFile(e,l):l+e}(L));const x={emscripten_memcpy_big:function(e,t,r){cf(_).call(_,e,t,t+r)},emscripten_resize_heap:function(e){N("OOM")}};await async function(){const e={env:x,wasi_snapshot_preview1:x};function t(e,t){const r=e.exports;var n;i.asm=r,d=i.asm.memory,n=d.buffer,i.HEAP8=m=new Int8Array(n),i.HEAP16=v=new Int16Array(n),i.HEAP32=A=new Int32Array(n),i.HEAPU8=_=new Uint8Array(n),i.HEAPU16=E=new Uint16Array(n),i.HEAPU32=y=new Uint32Array(n),i.HEAPF32=S=new Float32Array(n),i.HEAPF64=C=new Float64Array(n),T=i.asm.__indirect_function_table,function(e){if(k--,i.monitorRunDependencies&&i.monitorRunDependencies(k),0==k&&O){const e=O;O=null,e()}}()}function r(e){t(e.instance)}function n(t){return new fo((e,t)=>{e(Nf().buffer)}).then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(e){u("failed to asynchronously prepare wasm: "+e),N(e)}))}if(k++,i.monitorRunDependencies&&i.monitorRunDependencies(k),i.instantiateWasm)try{return i.instantiateWasm(e,t)}catch(e){return u("Module.instantiateWasm callback failed with error: "+e),!1}return await n(r),{}}();let B,U=i.___wasm_call_ctors=function(){return(U=i.___wasm_call_ctors=i.asm.__wasm_call_ctors).apply(null,arguments)},F=i._malloc=function(){return(F=i._malloc=i.asm.malloc).apply(null,arguments)},V=i._free=function(){return(V=i._free=i.asm.free).apply(null,arguments)},j=i.___errno_location=function(){return(j=i.___errno_location=i.asm.__errno_location).apply(null,arguments)},G=i._zlibCompress=function(){return(G=i._zlibCompress=i.asm.zlibCompress).apply(null,arguments)},H=i.stackSave=function(){return(H=i.stackSave=i.asm.stackSave).apply(null,arguments)},Q=i.stackRestore=function(){return(Q=i.stackRestore=i.asm.stackRestore).apply(null,arguments)},W=i.stackAlloc=function(){return(W=i.stackAlloc=i.asm.stackAlloc).apply(null,arguments)};function q(e){function t(){B||(B=!0,i.calledRun=!0,h||(M(I),M(R),i.onRuntimeInitialized&&i.onRuntimeInitialized(),function(){if(i.postRun)for("function"==typeof i.postRun&&(i.postRun=[i.postRun]);i.postRun.length;)e=i.postRun.shift(),w.unshift(e);var e;M(w)}()))}k>0||(function(){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;)e=i.preRun.shift(),b.unshift(e);var e;M(b)}(),k>0||(i.setStatus?(i.setStatus("Running..."),Fa((function(){Fa((function(){i.setStatus("")}),1),t()}),1)):t()))}if(i.ccall=f,i.cwrap=function(e,t,r,i){const n=hf(r=r||[]).call(r,(function(e){return"number"===e}));return"string"!==t&&n&&!i?p(e):function(){return f(e,t,r,arguments)}},i.allocate=function(e,t){let r;return r=1==t?W(e.length):F(e.length),e.subarray||Uo(e)?_.set(e,r):_.set(new Uint8Array(e),r),r},O=function e(){B||q(),B||(O=e)},i.run=q,i.preInit)for("function"==typeof i.preInit&&(i.preInit=[i.preInit]);i.preInit.length>0;)i.preInit.pop()();return q(),Lf=i,i}const Mf=Uint8Array.BYTES_PER_ELEMENT,xf={bytesReceived:"br",frameDropped:"fd",frameReceived:"fr",googJitterReceived:"jr",isAudioMute:"am",isFreeze:"fz",mediaType:"mt",packetsLost:"pl",packetsReceived:"pr",peerId:"pid",id:"id",ssrc:"ssrc",timestamp:"ts",type:"tp",frameRateInput:"fi",frameRateSent:"fs",googRtt:"rt",isVideoMute:"vm"},Bf={stats:"sts",state:"st",stream_id:"stid",session_id:"seid",stream_type:"stt",app_id:"aid",channel_key:"ck",channel_name:"cn",sdk_version:"sv",browser:"b",process_id:"pcid",mode:"m",codec:"c",role:"r",has_changed_gateway:"hcg",ap_response:"ar",extends:"es",details:"d",features:"ft",p2p_id:"ppid",sdp:"sdp",audio:"a",video:"v",attributes:"at",hq:"h",lq:"l",stereo:"str",speech:"spe",extend:"e",pingpongElapse:"ppe"},Uf={_message:"m",_type:"t",_id:"id"},Ff={join_v2:"j2",publish:"pub",publish_related_stats:"prs",ping:"pi",traffic_stats:"ts",ping_back:"pib",publish_stats:"pubs"};let Vf;class jf{constructor(){}async init(){if(!Vf){const e=await(async()=>(Pf||(Pf=await Df()),{zlibCompress:e=>{var t;const r=new Uint8Array(e),i=Mf*r.byteLength,n=Pf._malloc(i),o=Pf._malloc(3*i);for(let c=0;c<i;c++)Pf.HEAP8[n/Mf+c]=r[c];const s=Pf._zlibCompress(n,i,o),a=new Uint8Array(Uo(t=Pf.HEAP8).call(t,o,o+s));return Pf._free(n),Pf._free(o),a}}))();Vf=e.zlibCompress}this.zlibCompress=Vf}msgPackCompress(e){return nf.encode(e)}compress(e){const t=Ma(),r=this.compressKeyAndValue(JSON.parse(ve(e))),i=this.msgPackCompress(r),n=this.zlibCompress(i),o=new Uint8Array([49,49,49,50,...Bd(n)]);return{origin:ri({},e),originLength:ve(e).length,shortKeyAndValue:r,msgpackSer:i,compressed:o,compressedLength:o.length,time:Ma()-t}}compressKeyAndValue(e){return this._ObjectKeyCompress(this._typeCompress(e))}_typeCompress(e){const t=e._type;if(!t)return e;const r=Ff[t];return e._type=r||t,e}_ObjectKeyCompress(e){const t=e._message;if(t){const r=t.stats;r&&(t.stats=this._statsCompress(r)),e._message=this._messageCompress(t)}return this._reportCompress(e)}_statsCompress(e){return this._keyCompress(e,xf)}_messageCompress(e){return this._keyCompress(e,Bf)}_reportCompress(e){return this._keyCompress(e,Uf)}_keyCompress(e,t){const r={},i=ni(e);return li(i).call(i,(i,n)=>{const o=e[n];return t[n]?r[t[n]]=o:r[n]=o,r},r),r}}class Gf extends Mu{constructor(e){super(),this.lowPriorityQueue=[],this.highPriorityQueue=[],this.AgoraWebSocketManager=e}get queue(){return[...this.highPriorityQueue,...this.lowPriorityQueue]}reset(){this.lowPriorityQueue=[],this.highPriorityQueue=[]}pushMessage(e,t=!1){t?this.highPriorityQueue.push(e):this.lowPriorityQueue.push(e),this.sendMessage()}sendMessage(){const e=this.queue.length;let t=0;t=e<5?15*e:60+3*(e-4),Fa(()=>{this._sendMessage()},t)}_sendMessage(){var e;if(!this.queue.length)return;const t=this.AgoraWebSocketManager.getConnection();if(!t||1!==t.readyState)return;const r=this.queue.shift();return is(e=this.lowPriorityQueue).call(e,r)?this.lowPriorityQueue.shift():this.highPriorityQueue.shift(),t.send(r.compressed),r}}class Hf extends Mu{constructor(e,t,r=!1,i=!1){super(),this.connectionID=0,this.currentURLIndex=0,this.reconnectMode="tryNext",this._state="closed",this.reconnectCount=0,this.isCompressorInitSuccess=!1,this.tryDoubleDomain=!1,this.wsInflateLength=0,this.wsDeflateLength=0,this.closeEstablishingWs=()=>{},this.name=e,this.retryConfig=t,this.useCompress=r,this.tryDoubleDomain=i}get url(){return this.websocket?this.websocket.url:null}get ipPortTuple(){if(!this.url)return[void 0,void 0];const e=/^wss:\/\/(\d+-\d+-\d+-\d+)\..+:(\d+)\/?$/.exec(this.url);return e&&e[1]&&e[2]?[e[1].split("-").join("."),e[2]]:[void 0,void 0]}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,"reconnecting"===this._state?this.emit(nu.RECONNECTING,this.reconnectReason):"connected"===this._state?this.emit(nu.CONNECTED):"closed"===this._state?this.emit(nu.CLOSED):"failed"===this._state&&this.emit(nu.FAILED))}getConnection(){return this.websocket||void 0}init(e){const t=(t,r)=>{this.urls=e;const i=this.urls[this.currentURLIndex];this.state="connecting",this.messageSender=new Gf(this),this.createWebSocketConnection(i).then(t).catch(r),this.once(nu.CLOSED,()=>r(new pl(ll.WS_DISCONNECT))),this.once(nu.CONNECTED,()=>t())};return new fo((e,r)=>{this.compressor=new jf,this.compressor.init().then(()=>{var i;Rc.debug("websocket compressor initialized successfully"),nh.wsCompressorInit({status:!0,ec:null,eventElapse:1}),this.isCompressorInitSuccess=!0,this.compress=$o(i=this.compressor.compress).call(i,this.compressor),t(e,r)}).catch(i=>{t(e,r),Rc.debug("websocket compressor failed to initialize"),nh.wsCompressorInit({status:!1,ec:i?i.message||i.toString():"Empty Error",eventElapse:1})})})}close(e,t){if(this.currentURLIndex=0,this.reconnectCount=0,this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const e=this.websocket;t?Fa(()=>e.close(),500):e.close(),this.websocket=void 0}this.state=e?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(e,t){if(!this.websocket)return void Rc.warning("[".concat(this.name,"] can not reconnect, no websocket"));void 0!==e&&(this.reconnectMode=e),Rc.debug("[".concat(this.name,"] reconnect is triggered initiative"));const r=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),r&&$o(r).call(r,this.websocket)({code:9999,reason:t})}sendMessage(e,t=!1){if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new pl(ll.WS_ABORT,"websocket is not ready");try{let r=null;if(this.isCompressorInitSuccess&&this.useCompress&&jc("WEBSOCKET_COMPRESS"))r=this.compress(e),this.setWsInflateData(r);else{if(this.isCompressorInitSuccess&&this.useCompress){const t=this.compress(e);this.setWsInflateData(t)}const t=ve(e);r={compressed:t,compressedLength:t.length,origin:e}}t?this.websocket.send(r.compressed):this.messageSender.pushMessage(r)}catch(e){throw new pl(ll.WS_ERR,"send websocket message error"+e.toString())}}setWsInflateData(e){this.wsDeflateLength=this.wsDeflateLength+e.originLength,this.wsInflateLength=this.wsInflateLength+e.compressedLength}getWsInflateData(){const e=this.wsInflateLength,t=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:e,wsDeflateLength:t}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(e,t){return this.connectionID+=1,this.connectionID,new fo((r,i)=>{var n,o;const s=()=>{Rc.debug("[".concat(this.name,"] websocket opened:"),e),this.reconnectMode="retry",this.state="connected",this.reconnectCount=0,r()},a=async e=>{var t,n,o,s;if(Rc.debug(Je(t=Je(n=Je(o=Je(s="[".concat(this.name,"] websocket close ")).call(s,this.websocket&&this.websocket.url,", code: ")).call(o,e.code,", reason: ")).call(n,e.reason,", current mode: ")).call(t,this.reconnectMode)),this.reconnectCount<this.retryConfig.maxRetryCount){"connected"===this.state&&(this.reconnectReason=e.reason,this.state="reconnecting");const t=xp(this,nu.WILL_RECONNECT,this.reconnectMode)||this.reconnectMode,n=await this.reconnectWithAction(t);if("closed"===this.state)return void Rc.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect"));if(!n)return i(new pl(ll.WS_DISCONNECT,"websocket reconnect failed: ".concat(e.code))),void this.close(!0);r()}else i(new pl(ll.WS_DISCONNECT,"websocket close: ".concat(e.code))),this.close()},c=e=>{this.emit(nu.ON_MESSAGE,e)};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),jc("GATEWAY_WSS_ADDRESS")&&Is(n=this.name).call(n,"gateway")&&(e=jc("GATEWAY_WSS_ADDRESS")),Rc.debug(Je(o="[".concat(this.name,"] start connect, url: ")).call(o,e)),this.chooseBestWebsocketConnection(e,!!t).then(e=>{this.websocket=e,s&&s(),e.onclose=a,e.onmessage=c}).catch(e=>{if("closed"!==this.state){if(e instanceof pl&&e.code===ll.WS_ERR){var t;const r=new pl(ll.WS_ERR,"init websocket failed! Error: ".concat(e.toString()));return Rc.error(Je(t="[".concat(this.name,"]")).call(t,r)),void i(r)}a&&a(e)}else i(new pl(ll.WS_DISCONNECT,"websocket is closed: ".concat(e.toString())))})})}async reconnectWithAction(e,t){var r,i;if(!t&&this.reconnectCount>=this.retryConfig.maxRetryCount)return!1;if(!this.urls)return!1;if("closed"===this.state)return!1;this.onlineReconnectListener||zd.networkState!==Pu.OFFLINE||(this.onlineReconnectListener=zd.onlineWaiter&&zd.onlineWaiter.then(()=>{this.onlineReconnectListener=void 0}));const n=Yd(this.reconnectCount,this.retryConfig);if(Rc.debug(Je(r=Je(i="[".concat(this.name,"] wait ")).call(i,n,"ms to reconnect websocket, mode: ")).call(r,e)),await fo.race([Ip(n),this.onlineReconnectListener||new fo(()=>{})]),"closed"===this.state)return!1;this.reconnectCount+=1;try{if("retry"===e){const e=this.urls[this.currentURLIndex];await this.createWebSocketConnection(e)}else if("tryNext"===e){var o,s;if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return await this.reconnectWithAction("recover");Rc.debug(Je(o=Je(s="[".concat(this.name,"] websocket url length: ")).call(s,this.urls.length," current index: ")).call(o,this.currentURLIndex));const e=this.urls[this.currentURLIndex];await this.createWebSocketConnection(e)}else if("recover"===e){Rc.debug("[".concat(this.name,"] request new urls")),this.urls=await Dp(this,nu.REQUEST_NEW_URLS),this.currentURLIndex=0;const e=this.urls[this.currentURLIndex];await this.createWebSocketConnection(e)}return!0}catch(t){return Rc.error("[".concat(this.name,"] reconnect failed"),t.toString()),await this.reconnectWithAction(e)}}async chooseBestWebsocketConnection(e,t){return new fo((r,i)=>{let n=!1;const o=[];this.closeEstablishingWs=()=>{Rc.debug("[choose-best-ws] close establishing websockets"),Jr(o).call(o,e=>{e.onclose=null,e.onopen=null,e.onmessage=null,e.close()}),i(new pl(ll.WS_ABORT,"choose best websocket aborted"))};const s=jc("GATEWAY_DOMAINS");let a;const c=Lo(e).call(e,"?h="),l=Qo(s).call(s,t=>-1!==c?is(e).call(e,t,c):is(e).call(e,t));Rc.debug("[choose-best-ws] currentDomain: ",l,", domains: ",s);let u=!this.tryDoubleDomain||t||!l;if(!u&&l){try{Jr(s).call(s,t=>{const r=-1===c?e.replace(l,t):e.substr(0,c)+e.substr(c).replace(l,t),i=new WebSocket(r);i.binaryType="arraybuffer",o.push(i),Rc.debug("[choose-best-ws] ws is connecting:",i.url)})}catch(e){for(Rc.debug("[choose-best-ws] ws create failed, fallback to single url"),Jr(o).call(o,e=>e.close());o.length;)o.pop();u=!0}Jr(o).call(o,e=>{e.onopen=()=>{var t;n||(Jr(t=ji(o).call(o,t=>t!==e)).call(t,e=>{Rc.debug("[choose-best-ws]close backup websocket: ".concat(e.url)),e.close()}),n=!0,r(e))},e.onclose=e=>{a=e,n||Qo(o).call(o,e=>!(e.readyState===WebSocket.CLOSED||e.readyState===WebSocket.CLOSING))||(Rc.debug("[choose-best-ws] all websocket is closed"),n=!0,i(a))},e.onmessage=t=>{var r;Rc.debug(Je(r="[choose-best-ws]".concat(e.url," onmessage: ")).call(r,t.data))}}),Ip(5e3).then(()=>{Jr(o).call(o,e=>{e.readyState!==WebSocket.OPEN&&e.close()})})}if(u){let t;Rc.debug("[choose-best-ws] use single url: ",e);try{t=new WebSocket(e),o.push(t),t.binaryType="arraybuffer"}catch(e){var d;const r=new pl(ll.WS_ERR,"init websocket failed! Error: ".concat(e.toString()));return Rc.error(Je(d="[".concat(this.name,"]")).call(d,r)),void i(r)}t.onopen=()=>{r(t)},t.onclose=e=>{i(e)},t.onmessage=e=>{var r;Rc.debug(Je(r="[choose-best-ws]".concat(t.url," onmessage: ")).call(r,e.data))},Ip(5e3).then(()=>{t&&t.readyState!==WebSocket.OPEN&&t.close()})}}).finally(()=>{this.closeEstablishingWs=void 0})}}class Qf{constructor(e){this.input=[],this.size=e}add(e){var t;this.input.push(e),this.input.length>this.size&&bo(t=this.input).call(t,0,1)}mean(){var e;return 0===this.input.length?0:li(e=this.input).call(e,(e,t)=>e+t)/this.input.length}}class Wf extends Mu{constructor(e){super(),this._connectionState=Gl.CLOSED,this.openConnectionTime=Ma(),this.lastMsgTime=Ma(),this.uploadCache=[],this.rttRolling=new Qf(5),this.pingpongTimeoutCount=0,this.onWebsocketMessage=e=>{if(e.data instanceof ArrayBuffer)return void this.emit(Hl.ON_BINARY_DATA,e.data);const t=JSON.parse(e.data);if(this.lastMsgTime=Ma(),Object.prototype.hasOwnProperty.call(t,"_id")){const e="res-@".concat(t._id);this.emit(e,t._result,t._message)}else if(Object.prototype.hasOwnProperty.call(t,"_type")&&(this.emit(t._type,t._message),t._type===ql.ON_NOTIFICATION&&this.handleNotification(t._message),t._type===ql.ON_USER_BANNED))switch(t._message.error_code){case 14:this.close("UID_BANNED");break;case 15:this.close("IP_BANNED");break;case 16:this.close("CHANNEL_BANNED")}},this.clientId=e.clientId,this.spec=e,this.websocket=new Hf("gateway-".concat(this.clientId),this.spec.retryConfig,!0,!0),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===Gl.CONNECTED&&this.reconnect("retry",jl.OFFLINE)})}get connectionState(){return this._connectionState}set connectionState(e){e!==this._connectionState&&(this._connectionState=e,e===Gl.CONNECTED?this.emit(Hl.WS_CONNECTED):e===Gl.RECONNECTING?this.emit(Hl.WS_RECONNECTING,this._websocketReconnectReason):e===Gl.CLOSED&&this.emit(Hl.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket?this.websocket.url:null}get rtt(){return this.rttRolling.mean()}async request(e,t,r,i){var n,o,s,a,c;const l=kp(6,""),u={_id:l,_type:e,_message:t},d=this.websocket.connectionID,h=()=>new fo((t,r)=>{if(this.connectionState===Gl.CONNECTED)return t();const i=()=>{this.off(Hl.WS_CLOSED,n),t()},n=()=>{this.off(Hl.WS_CONNECTED,i),r(new pl(ll.WS_ABORT))};this.once(Hl.WS_CONNECTED,i),this.once(Hl.WS_CLOSED,n),e!==Ql.PUBLISH&&e!==Ql.SUBSCRIBE&&e!==Ql.UNSUBSCRIBE&&e!==Ql.UNPUBLISH&&e!==Ql.CONTROL||this.once(Hl.DISCONNECT_P2P,()=>{r(new pl(ll.DISCONNECT_P2P))})});if(this.connectionState!==Gl.CONNECTING&&this.connectionState!==Gl.RECONNECTING||e===Ql.JOIN||e===Ql.REJOIN||await h(),this.websocket.sendMessage(u,!0),i)return;const p=new fo((r,i)=>{let n=!1;const o=(i,o)=>{n=!0,r({isSuccess:"success"===i,message:o||{}}),this.off(Hl.WS_CLOSED,s),this.off(Hl.WS_RECONNECTING,s),this.emit(Hl.REQUEST_SUCCESS,e,t)};this.once("res-@".concat(l),o);const s=()=>{i(new pl(ll.WS_ABORT,"type: ".concat(e))),this.off(Hl.WS_CLOSED,s),this.off(Hl.WS_RECONNECTING,s),this.off("res-@".concat(l),o)};this.once(Hl.WS_CLOSED,s),this.once(Hl.WS_RECONNECTING,s),Ip(jc("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==d||n||(Rc.warning("ws request timeout, type: ".concat(e)),this.emit(Hl.REQUEST_TIMEOUT,e,t))})});let f=null;try{f=await p}catch(i){if(this.connectionState===Gl.CLOSED||e===Ql.LEAVE)throw new pl(ll.WS_ABORT);return!this.spec.forceWaitGatewayResponse||r?i.throw():e===Ql.JOIN||e===Ql.REJOIN?null:(await h(),await this.request(e,t))}if(f.isSuccess)return f.message;const g=Number(f.message.error_code||f.message.code),m=rf(g),_=new pl(ll.UNEXPECTED_RESPONSE,Je(n="".concat(m.desc,": ")).call(n,f.message.error_str),{code:g,data:f.message});return"success"===m.action?f.message:(Rc.warning(Je(o=Je(s=Je(a=Je(c="[".concat(this.websocket.connectionID,"] unexpected response from type ")).call(c,e,", error_code: ")).call(a,g,", message: ")).call(s,m.desc,", action: ")).call(o,m.action)),"failed"===m.action?_.throw():"quit"===m.action?(this.initError=_,this.close(),_.throw()):(g===Fl.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=f.message.option,Rc.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",jl.MULTI_IP)):this.reconnect(m.action,jl.SERVER_ERROR),e===Ql.JOIN||e===Ql.REJOIN?null:await this.request(e,t)))}waitMessage(e,t){return new fo(r=>{const i=n=>{(!t||t(n))&&(this.off(e,i),r(n))};this.on(e,i)})}upload(e,t){const r={_type:e,_message:t};try{this.websocket.sendMessage(r)}catch(e){const t=jc("MAX_UPLOAD_CACHE")||50;var i;this.uploadCache.push(r),this.uploadCache.length>t&&bo(i=this.uploadCache).call(i,0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{var e;if(this.connectionState!==Gl.CONNECTED)return;const t=bo(e=this.uploadCache).call(e,0,1)[0];0===this.uploadCache.length&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(t._type,t._message)},jc("UPLOAD_CACHE_INTERVAL")||2e3))}}send(e,t){const r={_type:e,_message:t};this.websocket.sendMessage(r)}init(e){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,new fo((t,r)=>{this.once(Hl.WS_CONNECTED,()=>t(this.joinResponse)),this.once(Hl.WS_CLOSED,()=>r(this.initError||new pl(ll.WS_ABORT))),this.connectionState=Gl.CONNECTING,this.websocket.init(e).catch(r),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4)})}close(e){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=e||"LEAVE",this.connectionState=Gl.CLOSED,this.websocket.close()}async join(){var e;if(!this.joinResponse){const e=await Dp(this,Hl.REQUEST_JOIN_INFO),t=await this.request(Ql.JOIN,e);if(!t)return this.emit(Hl.REPORT_JOIN_GATEWAY,ll.TIMEOUT,this.url||""),!1;this.joinResponse=t,this.emit(Hl.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=Gl.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval($o(e=this.handlePingPong).call(e,this),3e3),!0}async rejoin(){var e,t;if(!this.reconnectToken)throw new pl(ll.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const r=Bp(this,Hl.REQUEST_REJOIN_INFO);r.token=this.reconnectToken;const i=await this.request(Ql.REJOIN,r);return!!i&&(this.connectionState=Gl.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval($o(e=this.handlePingPong).call(e,this),3e3),i.peers&&Jr(t=i.peers).call(t,e=>{this.emit(ql.ON_USER_ONLINE,{uid:e.uid}),e.audio_mute?this.emit(ql.MUTE_AUDIO,{uid:e.uid}):this.emit(ql.UNMUTE_AUDIO,{uid:e.uid}),e.video_mute?this.emit(ql.MUTE_VIDEO,{uid:e.uid}):this.emit(ql.UNMUTE_VIDEO,{uid:e.uid}),e.audio_enable_local?this.emit(ql.ENABLE_LOCAL_AUDIO,{uid:e.uid}):this.emit(ql.DISABLE_LOCAL_AUDIO,{uid:e.uid}),e.video_enable_local?this.emit(ql.ENABLE_LOCAL_VIDEO,{uid:e.uid}):this.emit(ql.DISABLE_LOCAL_VIDEO,{uid:e.uid}),e.audio||e.video||this.emit(ql.ON_REMOVE_STREAM,{uid:e.uid,uint_id:e.uint_id}),e.audio&&this.emit(ql.ON_ADD_AUDIO_STREAM,{uid:e.uid,uint_id:e.uint_id,audio:!0}),e.video&&this.emit(ql.ON_ADD_VIDEO_STREAM,{uid:e.uid,uint_id:e.uint_id,video:!0})}),!0)}reconnect(e,t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(e,t)}handleNotification(e){Rc.debug("[".concat(this.clientId,"] receive notification: "),e);const t=rf(e.code);if("success"!==t.action){if("failed"!==t.action)return"quit"===t.action?("ERR_REPEAT_JOIN_CHANNEL"===t.desc&&this.close("UID_BANNED"),void this.close()):void this.reconnect(t.action,jl.SERVER_ERROR);Rc.error("[".concat(this.clientId,"] ignore error: "),t.desc)}}handlePingPong(){if(!this.websocket||"connected"!==this.websocket.state)return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const e=jc("PING_PONG_TIME_OUT"),t=Ma();this.pingpongTimeoutCount>=e&&(Rc.warning("PINGPONG Timeout. Last Socket Message: ".concat(t-this.lastMsgTime,"ms")),t-this.lastMsgTime>jc("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",jl.TIMEOUT):this.request(Ql.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const e=Ma()-t;this.rttRolling.add(e),jc("REPORT_STATS")&&this.send(Ql.PING_BACK,{pingpongElapse:e})}).catch(e=>{})}handleWsInflateData(){const{wsInflateLength:e,wsDeflateLength:t}=this.websocket.getWsInflateData();0!==e&&0!==t&&this.upload(Wl.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:t,ws_inflate_length:e})}handleWebsocketEvents(){this.websocket.on(nu.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(nu.CLOSED,()=>{this.connectionState=Gl.CLOSED}),this.websocket.on(nu.FAILED,()=>{this._disconnectedReason="NETWORK_ERROR",this.connectionState=Gl.CLOSED}),this.websocket.on(nu.RECONNECTING,e=>{this._websocketReconnectReason=e,this.joinResponse=void 0,this.connectionState===Gl.CONNECTED?this.connectionState=Gl.RECONNECTING:this.connectionState=Gl.CONNECTING}),this.websocket.on(nu.WILL_RECONNECT,(e,t)=>{if(Bp(this,Hl.IS_P2P_DISCONNECTED)&&"retry"===e)return this.reconnectToken=void 0,this.emit(Hl.NEED_RENEW_SESSION),this.emit(Hl.DISCONNECT_P2P),t("tryNext");"retry"!==e&&(this.reconnectToken=void 0,this.emit(Hl.NEED_RENEW_SESSION),this.emit(Hl.DISCONNECT_P2P)),t(e)}),this.websocket.on(nu.CONNECTED,()=>{this.openConnectionTime=Ma(),this.reconnectToken?this.rejoin().catch(e=>{var t;Rc.warning(Je(t="[".concat(this.clientId,"] rejoin failed ")).call(t,e)),this.reconnect("tryNext",jl.SERVER_ERROR)}):this.join().catch(e=>{if(this.emit(Hl.REPORT_JOIN_GATEWAY,e.message||e.code,this.url||""),e instanceof pl&&e.code===ll.UNEXPECTED_RESPONSE&&e.data.code===Fl.ERR_NO_AUTHORIZED)return Rc.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",jl.SERVER_ERROR);Rc.error("[".concat(this.clientId,"] join gateway request failed"),e.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",jl.SERVER_ERROR):(this.initError=e,this.close())})}),this.websocket.on(nu.REQUEST_NEW_URLS,(e,t)=>{Dp(this,Hl.REQUEST_RECOVER,this.multiIpOption).then(e).catch(t)})}}function qf(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function zf(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=qf(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=qf(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}const Zf=new Mr;class Yf extends Mu{constructor(e,t){super(),this.inChannelInfo={joinAt:null,duration:0},this._state="DISCONNECTED",this.isSignalRecover=!1,this.hasChangeBGPAddress=!1,this.joinGatewayStartTime=0,this._signalTimeout=!1,this.store=e,this.spec=t,this.signal=new Wf(zf({},t,{retryConfig:t.websocketRetryConfig})),this._statsCollector=t.statsCollector,this.role=t.role||"audience",this._clientRoleOptions=t.clientRoleOptions,this.handleSignalEvents()}get state(){return this._state}set state(e){if(e===this._state)return;const t=this._state;this._state=e,"DISCONNECTED"===e&&this._disconnectedReason?this.emit(_u.CONNECTION_STATE_CHANGE,e,t,this._disconnectedReason):this.emit(_u.CONNECTION_STATE_CHANGE,e,t)}async join(e,t){var r,i;this.store.joinGatewayStart(),"disabled"!==e.cloudProxyServer&&(this.hasChangeBGPAddress=!0);const n=Ma();let o=Zf.get(e.cname);if(o||(o=new Mr,Zf.set(e.cname,o)),o.has(e.uid)){const t=new pl(ll.UID_CONFLICT);throw nh.joinGateway(e.sid,{lts:n,succ:!1,ec:t.message,addr:null,uid:e.uid,cid:e.cid}),t}o.set(e.uid,!0),this.joinInfo=e,this.key=t;const s=e.proxyServer?vo(r=e.gatewayAddrs).call(r,t=>{var r,i;const n=t.split(":");return Je(r=Je(i="wss://".concat(e.proxyServer,"/ws/?h=")).call(i,n[0],"&p=")).call(r,n[1])}):vo(i=e.gatewayAddrs).call(i,e=>"wss://".concat(e));let a=0;this.joinGatewayStartTime=n;try{a=(await this.signal.init(s)).uid}catch(t){throw Rc.error("[".concat(this.store.clientId,"] User join failed"),t.toString()),nh.joinGateway(e.sid,{lts:n,succ:!1,ec:t.message,addr:this.signal.url,uid:e.uid,cid:e.cid}),o.delete(e.uid),this.signal.close(),t}return this.state="CONNECTED",this.inChannelInfo.joinAt=Ma(),Rc.debug("[".concat(this.store.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval(()=>{this.updateTrafficStats().catch(e=>{Rc.warning("[".concat(this.store.clientId,"] get traffic stats error"),e.toString())})},3e3),this.networkQualityInterval=window.setInterval(()=>{navigator&&void 0!==navigator.onLine&&!navigator.onLine?this.emit(_u.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(_u.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):"CONNECTED"===this.state&&this._statsCollector.trafficStats?this.emit(_u.NETWORK_QUALITY,{uplinkNetworkQuality:_p(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:_p(this._statsCollector.trafficStats.B_dnq)}):this.emit(_u.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),this.store.joinGatewayEnd(),a}async leave(e=!1){if("DISCONNECTED"!==this.state){this.state="DISCONNECTING";try{e||this.signal.connectionState!==Gl.CONNECTED||await wp(this.signal.request(Ql.LEAVE,void 0,!0),3e3)}catch(e){Rc.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),e)}this.signal.close(),this.reset(),this.state="DISCONNECTED"}}async publish(e,t,r){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new pl(ll.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const i={state:"offer",p2p_id:this.store.p2pId,ortc:t,mode:this.spec.mode,extend:jc("PUB_EXTEND")};try{return(await this.signal.request(Ql.PUBLISH,i,!0))._message}catch(i){if(r&&i.data&&i.data.code===Fl.ERR_PUBLISH_REQUEST_INVALID)return Rc.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),i.toString()),await this.tryUnpubBeforeRepub(e,t),this.publish(e,t,!1);throw i}}async unpublish(e,t){try{if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new pl(ll.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(Ql.UNPUBLISH,{stream_id:t,ortc:e},!0)}catch(e){Rc.warning("unpublish warning: ",e)}}async subscribe(e,t,r){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new pl(ll.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));const i={stream_id:e,stream_type:t.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,tcc:!!jc("SUBSCRIBE_TCC"),extend:jc("SUB_EXTEND"),ssrcId:t.ssrcId};try{return(await this.signal.request(Ql.SUBSCRIBE,i,!0))._message}catch(i){if(r&&i.data&&i.data.code===Fl.ERR_SUBSCRIBE_REQUEST_INVALID)return Rc.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),i.toString()),await this.tryUnsubBeforeResub(e,t),await this.subscribe(e,t,!1);throw i}}async unsubscribe(e,t){try{await this.signal.request(Ql.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:e,stream_id:t},!0)}catch(e){Rc.warning("unsubscribe warning: ",e)}}async reconnectPC(e){const{iceParameters:t,dtlsParameters:r,rtpCapabilities:i}=e;return{gatewayEstablishParams:await this.signal.request(Ql.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:t,dtlsParameters:r,rtpCapabilities:i}},!0)}}getGatewayInfo(){return this.signal.request(Ql.GATEWAY_INFO)}renewToken(e){return this.signal.request(Ql.RENEW_TOKEN,e)}async setClientRole(e,t){if(t&&(this._clientRoleOptions=ri({},t)),"CONNECTED"!==this.state)return void(this.role=e);let r=void 0;r="audience"===e?this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:0,await this.signal.request(Ql.SET_CLIENT_ROLE,{role:e,level:r}),this.role=e}async setRemoteVideoStreamType(e,t){await this.signal.request(Ql.SWITCH_VIDEO_STREAM,{stream_id:e,stream_type:t})}async setStreamFallbackOption(e,t){await this.signal.request(Ql.SET_FALLBACK_OPTION,{stream_id:e,fallback_type:t})}async pickSVCLayer(e,t){await this.signal.request(Ql.PICK_SVC_LAYER,{stream_id:e,spatial_layer:t.spatialLayer,temporal_layer:t.temporalLayer})}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Ma()-this.inChannelInfo.joinAt),zf({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request(Ql.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Ma()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const e=Zf.get(this.joinInfo.cname);e&&e.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const e=function(e){const t=e.match(/(wss\:\/\/)?([^:]+):(\d+)/);return t?{username:Nc.username,password:Nc.password,turnServerURL:t[2],tcpport:Si(t[3])+30,udpport:Si(t[3])+30,forceturn:!1}:null}(("disabled"===this.joinInfo.cloudProxyServer?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex])||"");this.joinInfo.turnServer.serversFromGateway=[],e&&"off"!==this.joinInfo.turnServer.mode&&"disabled"===this.joinInfo.cloudProxyServer&&this.joinInfo.turnServer.serversFromGateway.push(zf({},Nc,{turnServerURL:e.turnServerURL,tcpport:e.tcpport,udpport:e.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){var e;if("CONNECTED"!==this.state)return;const t=await this.signal.request(Ql.TRAFFIC_STATS,void 0,!0);t.timestamp=Ma(),Jr(e=t.peer_delay).call(e,e=>{var t;const r=this._statsCollector.trafficStats&&Qo(t=this._statsCollector.trafficStats.peer_delay).call(t,t=>t.peer_uid===e.peer_uid);r&&r.B_st!==e.B_st&&Vp(()=>{this.emit(_u.STREAM_TYPE_CHANGE,e.peer_uid,e.B_st)})}),this._statsCollector.updateTrafficStats(t)}getJoinMessage(e){if(!this.joinInfo||!this.key)throw new pl(ll.UNEXPECTED_ERROR,"can not generate join message, no join info");const t=ri({},this.joinInfo.apResponse);let r=jc("REPORT_APP_SCENARIO");if("string"!=typeof r)try{r=ve(r)}catch(e){r=void 0}r&&r.length>128&&(r=void 0);const i=zf({p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:kc,browser:navigator.userAgent,process_id:jc("PROCESS_ID"),mode:this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:t,extend:jc("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:"proxy3"===this.joinInfo.cloudProxyServer?"1":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:r},e);return this.joinInfo.stringUid&&(i.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(i.aes_mode=this.joinInfo.aesmode,jc("ENCRYPT_AES")?(i.aes_secret=this.joinInfo.aespassword,i.aes_encrypt=!0):i.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(i.aes_salt=this.joinInfo.aessalt)),t.addresses[this.signal.websocket.currentURLIndex]&&(i.ap_response.ticket=t.addresses[this.signal.websocket.currentURLIndex].ticket,delete t.addresses),i}getRejoinMessage(){if(!this.joinInfo)throw new pl(ll.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(Hl.WS_RECONNECTING,e=>{this.joinInfo&&nh.WebSocketQuit(this.joinInfo.sid,{lts:Ma(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:e||jl.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",nh.sessionInit(this.joinInfo.sid,{lts:(new Date).getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode}),this.isSignalRecover=!1,this.joinGatewayStartTime=Ma())}),this.signal.on(Hl.WS_CLOSED,e=>{let t;switch(e){case"LEAVE":t=jl.LEAVE;break;case"UID_BANNED":case"IP_BANNED":case"CHANNEL_BANNED":case"SERVER_ERROR":t=jl.SERVER_ERROR;break;default:t=jl.NETWORK_ERROR}Rc.debug("[signal] websocket closed, reason: ".concat(t||"undefined -> "+jl.NETWORK_ERROR)),this.joinInfo&&nh.WebSocketQuit(this.joinInfo.sid,{lts:Ma(),succ:"LEAVE"===e?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:t}),this.reset(),this._disconnectedReason=e,this.state="DISCONNECTED"}),this.signal.on(Hl.WS_CONNECTED,()=>{var e,t,r;if((this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo)&&("audience"===this.role&&this._clientRoleOptions&&this._clientRoleOptions.level&&(Rc.debug(Je(e=Je(t=Je(r="[".concat(this.store.clientId,"] patch to send set client role, role: ")).call(r,this.role,", mode: ")).call(t,this.spec.mode,", level: ")).call(e,this._clientRoleOptions&&this._clientRoleOptions.level)),this.setClientRole(this.role,this._clientRoleOptions)),nh.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid}),this.joinInfo.useLocalAccessPoint)){const e=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);var i;if(!e)return void Rc.error(Je(i="[".concat(this.store.clientId,"] set local access point after joined failed: ")).call(i,e));Vc("EVENT_REPORT_DOMAIN",e[1]),Vc("EVENT_REPORT_BACKUP_DOMAIN",e[1]),Vc("LOG_UPLOAD_SERVER","".concat(e[1],":6444"))}}),this.signal.on(ql.ON_UPLINK_STATS,e=>{this._statsCollector.updateUplinkStats(e)}),this.signal.on(Hl.REQUEST_RECOVER,(e,t,r)=>{if(!this.joinInfo)return r(new pl(ll.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));e&&(this.joinInfo.multiIP=e,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,Dp(this,_u.REQUEST_NEW_GATEWAY_LIST).then(t).catch(r)}),this.signal.on(Hl.REQUEST_JOIN_INFO,async e=>{var t;this.updateTurnConfigFromSignal();const{iceParameters:r,dtlsParameters:i,rtpCapabilities:n}=await Dp(this,_u.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:null===(t=this.joinInfo)||void 0===t?void 0:t.turnServer});e(this.getJoinMessage({ortc:{iceParameters:r,dtlsParameters:i,rtpCapabilities:n}}))}),this.signal.on(Hl.REQUEST_REJOIN_INFO,e=>{e(this.getRejoinMessage())}),this.signal.on(Hl.REPORT_JOIN_GATEWAY,(e,t)=>{this.joinInfo&&nh.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:e,addr:t,uid:this.joinInfo.uid,cid:this.joinInfo.cid})}),this.signal.on(Hl.IS_P2P_DISCONNECTED,e=>{e(Bp(this,_u.IS_P2P_DISCONNECTED))}),this.signal.on(Hl.DISCONNECT_P2P,()=>{this.emit(_u.DISCONNECT_P2P)}),this.signal.on(Hl.NEED_RENEW_SESSION,()=>{this.emit(_u.NEED_RENEW_SESSION)}),this.signal.on(Hl.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(Hl.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(Hl.JOIN_RESPONSE,e=>{this.emit(_u.JOIN_RESPONSE,e)})}async tryUnsubBeforeResub(e,t){try{await this.signal.request(Ql.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:e,ortc:[t]},!0)}catch(e){throw Rc.warning("unsubscribe warning",e),e}}async tryUnpubBeforeRepub(e,t){try{await this.signal.request(Ql.UNPUBLISH,{stream_id:e,ortc:t},!0)}catch(e){throw Rc.warning("unpublish warning: ",e),e}}async muteLocal(e,t){const r={action:Qo(e).call(e,e=>e.stream_type===mu.Audio)?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:e,stream_id:t};try{await this.signal.request(Ql.CONTROL,r,!0,!0)}catch(e){throw Rc.warning("gateway unmuteLocal warning: ",e),e}}async unmuteLocal(e,t){const r={action:Qo(e).call(e,e=>e.stream_type===mu.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:e,stream_id:t};try{await this.signal.request(Ql.CONTROL,r,!0,!0)}catch(e){throw Rc.warning("gateway muteLocal warning: ",e),e}}uploadStats(e,t){this.signal.upload(e,t)}getSignalRTT(){return this.signal.rtt}async restartICE(e){const t={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:e};try{return{response:await this.signal.request(Ql.RESTART_ICE,t,!0)}}catch(e){throw Rc.warning("P2PChannel.restartICE warning: ",e),e}}reconnect(){"CONNECTED"===this.state&&this.signal.reconnect(void 0,jl.P2P_FAILED)}}var Kf=Pe("iterator"),$f=!s((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r="";return e.pathname="c%20d",t.forEach((function(e,i){t.delete("b"),r+=i+e})),!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[Kf]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==r||"x"!==new URL("http://x",void 0).host})),Jf=2147483647,Xf=/[^\0-\u007E]/,eg=/[.\u3002\uFF0E\uFF61]/g,tg="Overflow: input needs wider integers to process",rg=Math.floor,ig=String.fromCharCode,ng=function(e){return e+22+75*(e<26)},og=function(e,t,r){var i=0;for(e=r?rg(e/700):e>>1,e+=rg(e/t);e>455;i+=36)e=rg(e/35);return rg(i+36*e/(e+38))},sg=function(e){var t,r,i=[],n=(e=function(e){for(var t=[],r=0,i=e.length;r<i;){var n=e.charCodeAt(r++);if(n>=55296&&n<=56319&&r<i){var o=e.charCodeAt(r++);56320==(64512&o)?t.push(((1023&n)<<10)+(1023&o)+65536):(t.push(n),r--)}else t.push(n)}return t}(e)).length,o=128,s=0,a=72;for(t=0;t<e.length;t++)(r=e[t])<128&&i.push(ig(r));var c=i.length,l=c;for(c&&i.push("-");l<n;){var u=Jf;for(t=0;t<e.length;t++)(r=e[t])>=o&&r<u&&(u=r);var d=l+1;if(u-o>rg((Jf-s)/d))throw RangeError(tg);for(s+=(u-o)*d,o=u,t=0;t<e.length;t++){if((r=e[t])<o&&++s>Jf)throw RangeError(tg);if(r==o){for(var h=s,p=36;;p+=36){var f=p<=a?1:p>=a+26?26:p-a;if(h<f)break;var g=h-f,m=36-f;i.push(ig(ng(f+g%m))),h=rg(g/m)}i.push(ig(ng(h))),a=og(s,d,l==c),s=0,++l}}++s,++o}return i.join("")},ag=function(e){var t=ft(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return U(t.call(e))},cg=le("fetch"),lg=le("Headers"),ug=Pe("iterator"),dg="URLSearchParams",hg="URLSearchParamsIterator",pg=xt.set,fg=xt.getterFor(dg),gg=xt.getterFor(hg),mg=/\+/g,_g=Array(4),vg=function(e){return _g[e-1]||(_g[e-1]=RegExp("((?:%[\\da-f]{2}){"+e+"})","gi"))},Eg=function(e){try{return decodeURIComponent(e)}catch(i){return e}},Ag=function(e){var t=e.replace(mg," "),r=4;try{return decodeURIComponent(t)}catch(e){for(;r;)t=t.replace(vg(r--),Eg);return t}},yg=/[!'()~]|%20/g,Sg={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},Cg=function(e){return Sg[e]},Tg=function(e){return encodeURIComponent(e).replace(yg,Cg)},bg=function(e,t){if(t)for(var r,i,n=t.split("&"),o=0;o<n.length;)(r=n[o++]).length&&(i=r.split("="),e.push({key:Ag(i.shift()),value:Ag(i.join("="))}))},Ig=function(e){this.entries.length=0,bg(this.entries,e)},Rg=function(e,t){if(e<t)throw TypeError("Not enough arguments")},wg=sr((function(e,t){pg(this,{type:hg,iterator:ag(fg(e).entries),kind:t})}),"Iterator",(function(){var e=gg(this),t=e.kind,r=e.iterator.next(),i=r.value;return r.done||(r.value="keys"===t?i.key:"values"===t?i.value:[i.key,i.value]),r})),kg=function(){_t(this,kg,dg);var e,t,r,i,n,o,s,a,c,l=arguments.length>0?arguments[0]:void 0,u=this,d=[];if(pg(u,{type:dg,entries:d,updateURL:function(){},updateSearchParams:Ig}),void 0!==l)if(v(l))if("function"==typeof(e=ft(l)))for(r=(t=e.call(l)).next;!(i=r.call(t)).done;){if((s=(o=(n=ag(U(i.value))).next).call(n)).done||(a=o.call(n)).done||!o.call(n).done)throw TypeError("Expected sequence with length 2");d.push({key:s.value+"",value:a.value+""})}else for(c in l)y(l,c)&&d.push({key:c,value:l[c]+""});else bg(d,"string"==typeof l?"?"===l.charAt(0)?l.slice(1):l:l+"")},Og=kg.prototype;$t(Og,{append:function(e,t){Rg(arguments.length,2);var r=fg(this);r.entries.push({key:e+"",value:t+""}),r.updateURL()},delete:function(e){Rg(arguments.length,1);for(var t=fg(this),r=t.entries,i=e+"",n=0;n<r.length;)r[n].key===i?r.splice(n,1):n++;t.updateURL()},get:function(e){Rg(arguments.length,1);for(var t=fg(this).entries,r=e+"",i=0;i<t.length;i++)if(t[i].key===r)return t[i].value;return null},getAll:function(e){Rg(arguments.length,1);for(var t=fg(this).entries,r=e+"",i=[],n=0;n<t.length;n++)t[n].key===r&&i.push(t[n].value);return i},has:function(e){Rg(arguments.length,1);for(var t=fg(this).entries,r=e+"",i=0;i<t.length;)if(t[i++].key===r)return!0;return!1},set:function(e,t){Rg(arguments.length,1);for(var r,i=fg(this),n=i.entries,o=!1,s=e+"",a=t+"",c=0;c<n.length;c++)(r=n[c]).key===s&&(o?n.splice(c--,1):(o=!0,r.value=a));o||n.push({key:s,value:a}),i.updateURL()},sort:function(){var e,t,r,i=fg(this),n=i.entries,o=n.slice();for(n.length=0,r=0;r<o.length;r++){for(e=o[r],t=0;t<r;t++)if(n[t].key>e.key){n.splice(t,0,e);break}t===r&&n.push(e)}i.updateURL()},forEach:function(e){for(var t,r=fg(this).entries,i=B(e,arguments.length>1?arguments[1]:void 0,3),n=0;n<r.length;)i((t=r[n++]).value,t.key,this)},keys:function(){return new wg(this,"keys")},values:function(){return new wg(this,"values")},entries:function(){return new wg(this,"entries")}},{enumerable:!0}),Kt(Og,ug,Og.entries),Kt(Og,"toString",(function(){for(var e,t=fg(this).entries,r=[],i=0;i<t.length;)e=t[i++],r.push(Tg(e.key)+"="+Tg(e.value));return r.join("&")}),{enumerable:!0}),yt(kg,dg),Q({global:!0,forced:!$f},{URLSearchParams:kg}),$f||"function"!=typeof cg||"function"!=typeof lg||Q({global:!0,enumerable:!0,forced:!0},{fetch:function(e){var t,r,i,n=[e];return arguments.length>1&&(v(t=arguments[1])&&(r=t.body,ht(r)===dg&&((i=t.headers?new lg(t.headers):new lg).has("content-type")||i.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),t=qt(t,{body:d(0,String(r)),headers:d(0,i)}))),n.push(t)),cg.apply(this,n)}});var Ng,Lg={URLSearchParams:kg,getState:fg},Pg=Cr.codeAt,Dg=o.URL,Mg=Lg.URLSearchParams,xg=Lg.getState,Bg=xt.set,Ug=xt.getterFor("URL"),Fg=Math.floor,Vg=Math.pow,jg="Invalid scheme",Gg="Invalid host",Hg="Invalid port",Qg=/[A-Za-z]/,Wg=/[\d+\-.A-Za-z]/,qg=/\d/,zg=/^(0x|0X)/,Zg=/^[0-7]+$/,Yg=/^\d+$/,Kg=/^[\dA-Fa-f]+$/,$g=/[\u0000\u0009\u000A\u000D #%/:?@[\\]]/,Jg=/[\u0000\u0009\u000A\u000D #/:?@[\\]]/,Xg=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,em=/[\u0009\u000A\u000D]/g,tm=function(e,t){var r,i,n;if("["==t.charAt(0)){if("]"!=t.charAt(t.length-1))return Gg;if(!(r=im(t.slice(1,-1))))return Gg;e.host=r}else if(dm(e)){if(t=function(e){var t,r,i=[],n=e.toLowerCase().replace(eg,".").split(".");for(t=0;t<n.length;t++)r=n[t],i.push(Xf.test(r)?"xn--"+sg(r):r);return i.join(".")}(t),$g.test(t))return Gg;if(null===(r=rm(t)))return Gg;e.host=r}else{if(Jg.test(t))return Gg;for(r="",i=Md(t),n=0;n<i.length;n++)r+=lm(i[n],om);e.host=r}},rm=function(e){var t,r,i,n,o,s,a,c=e.split(".");if(c.length&&""==c[c.length-1]&&c.pop(),(t=c.length)>4)return e;for(r=[],i=0;i<t;i++){if(""==(n=c[i]))return e;if(o=10,n.length>1&&"0"==n.charAt(0)&&(o=zg.test(n)?16:8,n=n.slice(8==o?1:2)),""===n)s=0;else{if(!(10==o?Yg:8==o?Zg:Kg).test(n))return e;s=parseInt(n,o)}r.push(s)}for(i=0;i<t;i++)if(s=r[i],i==t-1){if(s>=Vg(256,5-t))return null}else if(s>255)return null;for(a=r.pop(),i=0;i<r.length;i++)a+=r[i]*Vg(256,3-i);return a},im=function(e){var t,r,i,n,o,s,a,c=[0,0,0,0,0,0,0,0],l=0,u=null,d=0,h=function(){return e.charAt(d)};if(":"==h()){if(":"!=e.charAt(1))return;d+=2,u=++l}for(;h();){if(8==l)return;if(":"!=h()){for(t=r=0;r<4&&Kg.test(h());)t=16*t+parseInt(h(),16),d++,r++;if("."==h()){if(0==r)return;if(d-=r,l>6)return;for(i=0;h();){if(n=null,i>0){if(!("."==h()&&i<4))return;d++}if(!qg.test(h()))return;for(;qg.test(h());){if(o=parseInt(h(),10),null===n)n=o;else{if(0==n)return;n=10*n+o}if(n>255)return;d++}c[l]=256*c[l]+n,2!=++i&&4!=i||l++}if(4!=i)return;break}if(":"==h()){if(d++,!h())return}else if(h())return;c[l++]=t}else{if(null!==u)return;d++,u=++l}}if(null!==u)for(s=l-u,l=7;0!=l&&s>0;)a=c[l],c[l--]=c[u+s-1],c[u+--s]=a;else if(8!=l)return;return c},nm=function(e){var t,r,i,n;if("number"==typeof e){for(t=[],r=0;r<4;r++)t.unshift(e%256),e=Fg(e/256);return t.join(".")}if("object"==typeof e){for(t="",i=function(e){for(var t=null,r=1,i=null,n=0,o=0;o<8;o++)0!==e[o]?(n>r&&(t=i,r=n),i=null,n=0):(null===i&&(i=o),++n);return n>r&&(t=i,r=n),t}(e),r=0;r<8;r++)n&&0===e[r]||(n&&(n=!1),i===r?(t+=r?":":"::",n=!0):(t+=e[r].toString(16),r<7&&(t+=":")));return"["+t+"]"}return e},om={},sm=ti({},om,{" ":1,'"':1,"<":1,">":1,"`":1}),am=ti({},sm,{"#":1,"?":1,"{":1,"}":1}),cm=ti({},am,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),lm=function(e,t){var r=Pg(e,0);return r>32&&r<127&&!y(t,e)?e:encodeURIComponent(e)},um={ftp:21,file:null,http:80,https:443,ws:80,wss:443},dm=function(e){return y(um,e.scheme)},hm=function(e){return""!=e.username||""!=e.password},pm=function(e){return!e.host||e.cannotBeABaseURL||"file"==e.scheme},fm=function(e,t){var r;return 2==e.length&&Qg.test(e.charAt(0))&&(":"==(r=e.charAt(1))||!t&&"|"==r)},gm=function(e){var t;return e.length>1&&fm(e.slice(0,2))&&(2==e.length||"/"===(t=e.charAt(2))||"\\"===t||"?"===t||"#"===t)},mm=function(e){var t=e.path,r=t.length;!r||"file"==e.scheme&&1==r&&fm(t[0],!0)||t.pop()},_m=function(e){return"."===e||"%2e"===e.toLowerCase()},vm={},Em={},Am={},ym={},Sm={},Cm={},Tm={},bm={},Im={},Rm={},wm={},km={},Om={},Nm={},Lm={},Pm={},Dm={},Mm={},xm={},Bm={},Um={},Fm=function(e,t,r,i){var n,o,s,a,c,l=r||vm,u=0,d="",h=!1,p=!1,f=!1;for(r||(e.scheme="",e.username="",e.password="",e.host=null,e.port=null,e.path=[],e.query=null,e.fragment=null,e.cannotBeABaseURL=!1,t=t.replace(Xg,"")),t=t.replace(em,""),n=Md(t);u<=n.length;){switch(o=n[u],l){case vm:if(!o||!Qg.test(o)){if(r)return jg;l=Am;continue}d+=o.toLowerCase(),l=Em;break;case Em:if(o&&(Wg.test(o)||"+"==o||"-"==o||"."==o))d+=o.toLowerCase();else{if(":"!=o){if(r)return jg;d="",l=Am,u=0;continue}if(r&&(dm(e)!=y(um,d)||"file"==d&&(hm(e)||null!==e.port)||"file"==e.scheme&&!e.host))return;if(e.scheme=d,r)return void(dm(e)&&um[e.scheme]==e.port&&(e.port=null));d="","file"==e.scheme?l=Nm:dm(e)&&i&&i.scheme==e.scheme?l=ym:dm(e)?l=bm:"/"==n[u+1]?(l=Sm,u++):(e.cannotBeABaseURL=!0,e.path.push(""),l=xm)}break;case Am:if(!i||i.cannotBeABaseURL&&"#"!=o)return jg;if(i.cannotBeABaseURL&&"#"==o){e.scheme=i.scheme,e.path=i.path.slice(),e.query=i.query,e.fragment="",e.cannotBeABaseURL=!0,l=Um;break}l="file"==i.scheme?Nm:Cm;continue;case ym:if("/"!=o||"/"!=n[u+1]){l=Cm;continue}l=Im,u++;break;case Sm:if("/"==o){l=Rm;break}l=Mm;continue;case Cm:if(e.scheme=i.scheme,o==Ng)e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.query=i.query;else if("/"==o||"\\"==o&&dm(e))l=Tm;else if("?"==o)e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.query="",l=Bm;else{if("#"!=o){e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.path.pop(),l=Mm;continue}e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.query=i.query,e.fragment="",l=Um}break;case Tm:if(!dm(e)||"/"!=o&&"\\"!=o){if("/"!=o){e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,l=Mm;continue}l=Rm}else l=Im;break;case bm:if(l=Im,"/"!=o||"/"!=d.charAt(u+1))continue;u++;break;case Im:if("/"!=o&&"\\"!=o){l=Rm;continue}break;case Rm:if("@"==o){h&&(d="%40"+d),h=!0,s=Md(d);for(var g=0;g<s.length;g++){var m=s[g];if(":"!=m||f){var _=lm(m,cm);f?e.password+=_:e.username+=_}else f=!0}d=""}else if(o==Ng||"/"==o||"?"==o||"#"==o||"\\"==o&&dm(e)){if(h&&""==d)return"Invalid authority";u-=Md(d).length+1,d="",l=wm}else d+=o;break;case wm:case km:if(r&&"file"==e.scheme){l=Pm;continue}if(":"!=o||p){if(o==Ng||"/"==o||"?"==o||"#"==o||"\\"==o&&dm(e)){if(dm(e)&&""==d)return Gg;if(r&&""==d&&(hm(e)||null!==e.port))return;if(a=tm(e,d))return a;if(d="",l=Dm,r)return;continue}"["==o?p=!0:"]"==o&&(p=!1),d+=o}else{if(""==d)return Gg;if(a=tm(e,d))return a;if(d="",l=Om,r==km)return}break;case Om:if(!qg.test(o)){if(o==Ng||"/"==o||"?"==o||"#"==o||"\\"==o&&dm(e)||r){if(""!=d){var v=parseInt(d,10);if(v>65535)return Hg;e.port=dm(e)&&v===um[e.scheme]?null:v,d=""}if(r)return;l=Dm;continue}return Hg}d+=o;break;case Nm:if(e.scheme="file","/"==o||"\\"==o)l=Lm;else{if(!i||"file"!=i.scheme){l=Mm;continue}if(o==Ng)e.host=i.host,e.path=i.path.slice(),e.query=i.query;else if("?"==o)e.host=i.host,e.path=i.path.slice(),e.query="",l=Bm;else{if("#"!=o){gm(n.slice(u).join(""))||(e.host=i.host,e.path=i.path.slice(),mm(e)),l=Mm;continue}e.host=i.host,e.path=i.path.slice(),e.query=i.query,e.fragment="",l=Um}}break;case Lm:if("/"==o||"\\"==o){l=Pm;break}i&&"file"==i.scheme&&!gm(n.slice(u).join(""))&&(fm(i.path[0],!0)?e.path.push(i.path[0]):e.host=i.host),l=Mm;continue;case Pm:if(o==Ng||"/"==o||"\\"==o||"?"==o||"#"==o){if(!r&&fm(d))l=Mm;else if(""==d){if(e.host="",r)return;l=Dm}else{if(a=tm(e,d))return a;if("localhost"==e.host&&(e.host=""),r)return;d="",l=Dm}continue}d+=o;break;case Dm:if(dm(e)){if(l=Mm,"/"!=o&&"\\"!=o)continue}else if(r||"?"!=o)if(r||"#"!=o){if(o!=Ng&&(l=Mm,"/"!=o))continue}else e.fragment="",l=Um;else e.query="",l=Bm;break;case Mm:if(o==Ng||"/"==o||"\\"==o&&dm(e)||!r&&("?"==o||"#"==o)){if(".."===(c=(c=d).toLowerCase())||"%2e."===c||".%2e"===c||"%2e%2e"===c?(mm(e),"/"==o||"\\"==o&&dm(e)||e.path.push("")):_m(d)?"/"==o||"\\"==o&&dm(e)||e.path.push(""):("file"==e.scheme&&!e.path.length&&fm(d)&&(e.host&&(e.host=""),d=d.charAt(0)+":"),e.path.push(d)),d="","file"==e.scheme&&(o==Ng||"?"==o||"#"==o))for(;e.path.length>1&&""===e.path[0];)e.path.shift();"?"==o?(e.query="",l=Bm):"#"==o&&(e.fragment="",l=Um)}else d+=lm(o,am);break;case xm:"?"==o?(e.query="",l=Bm):"#"==o?(e.fragment="",l=Um):o!=Ng&&(e.path[0]+=lm(o,om));break;case Bm:r||"#"!=o?o!=Ng&&("'"==o&&dm(e)?e.query+="%27":e.query+="#"==o?"%23":lm(o,om)):(e.fragment="",l=Um);break;case Um:o!=Ng&&(e.fragment+=lm(o,sm))}u++}},Vm=function(e){var t,r,i=_t(this,Vm,"URL"),n=arguments.length>1?arguments[1]:void 0,o=String(e),s=Bg(i,{type:"URL"});if(void 0!==n)if(n instanceof Vm)t=Ug(n);else if(r=Fm(t={},String(n)))throw TypeError(r);if(r=Fm(s,o,null,t))throw TypeError(r);var c=s.searchParams=new Mg,l=xg(c);l.updateSearchParams(s.query),l.updateURL=function(){s.query=String(c)||null},a||(i.href=Gm.call(i),i.origin=Hm.call(i),i.protocol=Qm.call(i),i.username=Wm.call(i),i.password=qm.call(i),i.host=zm.call(i),i.hostname=Zm.call(i),i.port=Ym.call(i),i.pathname=Km.call(i),i.search=$m.call(i),i.searchParams=Jm.call(i),i.hash=Xm.call(i))},jm=Vm.prototype,Gm=function(){var e=Ug(this),t=e.scheme,r=e.username,i=e.password,n=e.host,o=e.port,s=e.path,a=e.query,c=e.fragment,l=t+":";return null!==n?(l+="//",hm(e)&&(l+=r+(i?":"+i:"")+"@"),l+=nm(n),null!==o&&(l+=":"+o)):"file"==t&&(l+="//"),l+=e.cannotBeABaseURL?s[0]:s.length?"/"+s.join("/"):"",null!==a&&(l+="?"+a),null!==c&&(l+="#"+c),l},Hm=function(){var e=Ug(this),t=e.scheme,r=e.port;if("blob"==t)try{return new URL(t.path[0]).origin}catch(e){return"null"}return"file"!=t&&dm(e)?t+"://"+nm(e.host)+(null!==r?":"+r:""):"null"},Qm=function(){return Ug(this).scheme+":"},Wm=function(){return Ug(this).username},qm=function(){return Ug(this).password},zm=function(){var e=Ug(this),t=e.host,r=e.port;return null===t?"":null===r?nm(t):nm(t)+":"+r},Zm=function(){var e=Ug(this).host;return null===e?"":nm(e)},Ym=function(){var e=Ug(this).port;return null===e?"":String(e)},Km=function(){var e=Ug(this),t=e.path;return e.cannotBeABaseURL?t[0]:t.length?"/"+t.join("/"):""},$m=function(){var e=Ug(this).query;return e?"?"+e:""},Jm=function(){return Ug(this).searchParams},Xm=function(){var e=Ug(this).fragment;return e?"#"+e:""},e_=function(e,t){return{get:e,set:t,configurable:!0,enumerable:!0}};if(a&&se(jm,{href:e_(Gm,(function(e){var t=Ug(this),r=String(e),i=Fm(t,r);if(i)throw TypeError(i);xg(t.searchParams).updateSearchParams(t.query)})),origin:e_(Hm),protocol:e_(Qm,(function(e){var t=Ug(this);Fm(t,String(e)+":",vm)})),username:e_(Wm,(function(e){var t=Ug(this),r=Md(String(e));if(!pm(t)){t.username="";for(var i=0;i<r.length;i++)t.username+=lm(r[i],cm)}})),password:e_(qm,(function(e){var t=Ug(this),r=Md(String(e));if(!pm(t)){t.password="";for(var i=0;i<r.length;i++)t.password+=lm(r[i],cm)}})),host:e_(zm,(function(e){var t=Ug(this);t.cannotBeABaseURL||Fm(t,String(e),wm)})),hostname:e_(Zm,(function(e){var t=Ug(this);t.cannotBeABaseURL||Fm(t,String(e),km)})),port:e_(Ym,(function(e){var t=Ug(this);pm(t)||(""==(e=String(e))?t.port=null:Fm(t,e,Om))})),pathname:e_(Km,(function(e){var t=Ug(this);t.cannotBeABaseURL||(t.path=[],Fm(t,e+"",Dm))})),search:e_($m,(function(e){var t=Ug(this);""==(e=String(e))?t.query=null:("?"==e.charAt(0)&&(e=e.slice(1)),t.query="",Fm(t,e,Bm)),xg(t.searchParams).updateSearchParams(t.query)})),searchParams:e_(Jm),hash:e_(Xm,(function(e){var t=Ug(this);""!=(e=String(e))?("#"==e.charAt(0)&&(e=e.slice(1)),t.fragment="",Fm(t,e,Um)):t.fragment=null}))}),Kt(jm,"toJSON",(function(){return Gm.call(this)}),{enumerable:!0}),Kt(jm,"toString",(function(){return Gm.call(this)}),{enumerable:!0}),Dg){var t_=Dg.createObjectURL,r_=Dg.revokeObjectURL;t_&&Kt(Vm,"createObjectURL",(function(e){return t_.apply(Dg,arguments)})),r_&&Kt(Vm,"revokeObjectURL",(function(e){return r_.apply(Dg,arguments)}))}yt(Vm,"URL"),Q({global:!0,forced:!$f,sham:!a},{URL:Vm});var i_=M.URL;function n_(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}!function(){var t;function r(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var i,n="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,r){return e==Array.prototype||e==Object.prototype||(e[t]=r.value),e},o=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof e&&e];for(var r=0;r<t.length;++r){var i=t[r];if(i&&i.Math==Math)return i}throw Error("Cannot find global object")}(this);function s(e,t){if(t)e:{var r=o;e=e.split(".");for(var i=0;i<e.length-1;i++){var s=e[i];if(!(s in r))break e;r=r[s]}(t=t(i=r[e=e[e.length-1]]))!=i&&null!=t&&n(r,e,{configurable:!0,writable:!0,value:t})}}function a(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function c(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:r(e)}}if(s("Symbol",(function(e){function t(e,t){this.A=e,n(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.A};var r="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",i=0;return function e(n){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(r+(n||"")+"_"+i++,n)}})),s("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),i=0;i<t.length;i++){var s=o[t[i]];"function"==typeof s&&"function"!=typeof s.prototype[e]&&n(s.prototype,e,{configurable:!0,writable:!0,value:function(){return a(r(this))}})}return e})),"function"==typeof Object.setPrototypeOf)i=Object.setPrototypeOf;else{var l;e:{var u={};try{u.__proto__={a:!0},l=u.a;break e}catch(e){}l=!1}i=l?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var d=i;function h(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function p(e){if(e.m)throw new TypeError("Generator is already running");e.m=!0}function f(e,t){return e.h=3,{value:t}}function g(e){this.g=new h,this.G=e}function m(e,t,r,i){try{var n=t.call(e.g.j,r);if(!(n instanceof Object))throw new TypeError("Iterator result "+n+" is not an object");if(!n.done)return e.g.m=!1,n;var o=n.value}catch(t){return e.g.j=null,e.g.s(t),_(e)}return e.g.j=null,i.call(e.g,o),_(e)}function _(e){for(;e.g.h;)try{var t=e.G(e.g);if(t)return e.g.m=!1,{value:t.value,done:!1}}catch(t){e.g.v=void 0,e.g.s(t)}if(e.g.m=!1,e.g.l){if(t=e.g.l,e.g.l=null,t.F)throw t.D;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function v(e){this.next=function(t){return e.o(t)},this.throw=function(t){return e.s(t)},this.return=function(t){return function(e,t){p(e.g);var r=e.g.j;return r?m(e,"return"in r?r.return:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),_(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function E(e,t){return t=new v(new g(t)),d&&e.prototype&&d(t,e.prototype),t}if(h.prototype.o=function(e){this.v=e},h.prototype.s=function(e){this.l={D:e,F:!0},this.h=this.C||this.u},h.prototype.return=function(e){this.l={return:e},this.h=this.u},g.prototype.o=function(e){return p(this.g),this.g.j?m(this,this.g.j.next,e,this.g.o):(this.g.o(e),_(this))},g.prototype.s=function(e){return p(this.g),this.g.j?m(this,this.g.j.throw,e,this.g.o):(this.g.s(e),_(this))},s("Array.prototype.entries",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var r=0,i=!1,n={next:function(){if(!i&&r<e.length){var n=r++;return{value:t(n,e[n]),done:!1}}return i=!0,{done:!0,value:void 0}}};return n[Symbol.iterator]=function(){return n},n}(this,(function(e,t){return[e,t]}))}})),"undefined"!=typeof Blob&&("undefined"==typeof FormData||!FormData.prototype.keys)){var A=function(e,t){for(var r=0;r<e.length;r++)t(e[r])},y=function(e){return e.replace(/\r?\n|\r/g,"\r\n")},S=function(e,t,r){return t instanceof Blob?(r=void 0!==r?String(r+""):"string"==typeof t.name?t.name:"blob",t.name===r&&"[object Blob]"!==Object.prototype.toString.call(t)||(t=new File([t],r)),[String(e),t]):[String(e),String(t)]},C=function(e,t){if(e.length<t)throw new TypeError(t+" argument required, but only "+e.length+" present.")},T="object"==typeof globalThis?globalThis:"object"==typeof window?window:"object"==typeof self?self:this,b=T.FormData,I=T.XMLHttpRequest&&T.XMLHttpRequest.prototype.send,R=T.Request&&T.fetch,w=T.navigator&&T.navigator.sendBeacon,k=T.Element&&T.Element.prototype,O=T.Symbol&&Symbol.toStringTag;O&&(Blob.prototype[O]||(Blob.prototype[O]="Blob"),"File"in T&&!File.prototype[O]&&(File.prototype[O]="File"));try{new File([],"")}catch(e){T.File=function(e,t,r){return e=new Blob(e,r||{}),Object.defineProperties(e,{name:{value:t},lastModified:{value:+(r&&void 0!==r.lastModified?new Date(r.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),O&&Object.defineProperty(e,O,{value:"File"}),e}}var N=function(e){return e.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},L=function(e){this.i=[];var t=this;e&&A(e.elements,(function(e){if(e.name&&!e.disabled&&"submit"!==e.type&&"button"!==e.type&&!e.matches("form fieldset[disabled] *"))if("file"===e.type){var r=e.files&&e.files.length?e.files:[new File([],"",{type:"application/octet-stream"})];A(r,(function(r){t.append(e.name,r)}))}else"select-multiple"===e.type||"select-one"===e.type?A(e.options,(function(r){!r.disabled&&r.selected&&t.append(e.name,r.value)})):"checkbox"===e.type||"radio"===e.type?e.checked&&t.append(e.name,e.value):(r="textarea"===e.type?y(e.value):e.value,t.append(e.name,r))}))};if((t=L.prototype).append=function(e,t,r){C(arguments,2),this.i.push(S(e,t,r))},t.delete=function(e){C(arguments,1);var t=[];e=String(e),A(this.i,(function(r){r[0]!==e&&t.push(r)})),this.i=t},t.entries=function e(){var t,r=this;return E(e,(function(e){if(1==e.h&&(t=0),3!=e.h)return t<r.i.length?e=f(e,r.i[t]):(e.h=0,e=void 0),e;t++,e.h=2}))},t.forEach=function(e,t){C(arguments,1);for(var r=c(this),i=r.next();!i.done;i=r.next()){var n=c(i.value);i=n.next().value,n=n.next().value,e.call(t,n,i,this)}},t.get=function(e){C(arguments,1);var t=this.i;e=String(e);for(var r=0;r<t.length;r++)if(t[r][0]===e)return t[r][1];return null},t.getAll=function(e){C(arguments,1);var t=[];return e=String(e),A(this.i,(function(r){r[0]===e&&t.push(r[1])})),t},t.has=function(e){C(arguments,1),e=String(e);for(var t=0;t<this.i.length;t++)if(this.i[t][0]===e)return!0;return!1},t.keys=function e(){var t,r,i,n,o=this;return E(e,(function(e){if(1==e.h&&(t=c(o),r=t.next()),3!=e.h)return r.done?void(e.h=0):(i=r.value,n=c(i),f(e,n.next().value));r=t.next(),e.h=2}))},t.set=function(e,t,r){C(arguments,2),e=String(e);var i=[],n=S(e,t,r),o=!0;A(this.i,(function(t){t[0]===e?o&&(o=!i.push(n)):i.push(t)})),o&&i.push(n),this.i=i},t.values=function e(){var t,r,i,n,o=this;return E(e,(function(e){if(1==e.h&&(t=c(o),r=t.next()),3!=e.h)return r.done?void(e.h=0):(i=r.value,(n=c(i)).next(),f(e,n.next().value));r=t.next(),e.h=2}))},L.prototype._asNative=function(){for(var e=new b,t=c(this),r=t.next();!r.done;r=t.next()){var i=c(r.value);r=i.next().value,i=i.next().value,e.append(r,i)}return e},L.prototype._blob=function(){var e="----formdata-polyfill-"+Math.random(),t=[],r="--"+e+'\r\nContent-Disposition: form-data; name="';return this.forEach((function(e,i){return"string"==typeof e?t.push(r+N(y(i))+'"\r\n\r\n'+y(e)+"\r\n"):t.push(r+N(y(i))+'"; filename="'+N(e.name)+'"\r\nContent-Type: '+(e.type||"application/octet-stream")+"\r\n\r\n",e,"\r\n")})),t.push("--"+e+"--"),new Blob(t,{type:"multipart/form-data; boundary="+e})},L.prototype[Symbol.iterator]=function(){return this.entries()},L.prototype.toString=function(){return"[object FormData]"},k&&!k.matches&&(k.matches=k.matchesSelector||k.mozMatchesSelector||k.msMatchesSelector||k.oMatchesSelector||k.webkitMatchesSelector||function(e){for(var t=(e=(this.document||this.ownerDocument).querySelectorAll(e)).length;0<=--t&&e.item(t)!==this;);return-1<t}),O&&(L.prototype[O]="FormData"),I){var P=T.XMLHttpRequest.prototype.setRequestHeader;T.XMLHttpRequest.prototype.setRequestHeader=function(e,t){P.call(this,e,t),"content-type"===e.toLowerCase()&&(this.B=!0)},T.XMLHttpRequest.prototype.send=function(e){e instanceof L?(e=e._blob(),this.B||this.setRequestHeader("Content-Type",e.type),I.call(this,e)):I.call(this,e)}}R&&(T.fetch=function(e,t){return t&&t.body&&t.body instanceof L&&(t.body=t.body._blob()),R.call(this,e,t)}),w&&(T.navigator.sendBeacon=function(e,t){return t instanceof L&&(t=t._asNative()),w.call(this,e,t)}),T.FormData=L}}();let o_=1;function s_(e,t,r,i,n){o_+=1;const o={sid:r.sid,command:"convergeAllocateEdge",uid:"666",appId:r.appId,ts:Math.floor(Ma()/1e3),seq:o_,requestId:o_,version:kc,cname:r.cname},s={service_name:t,json_body:ve(o)};let a,c,l=e[0];return Kd(async()=>{a=Ma();const e=await Wd(l,{data:s,cancelToken:i,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(c=Ma()-a,0!==e.code){const t=new pl(ll.UNEXPECTED_RESPONSE,"live streaming ap error, code"+e.code,{retry:!0,responseTime:c});throw Rc.error(t.toString()),t}const r=JSON.parse(e.json_body);if(200!==r.code){var n;const e=new pl(ll.UNEXPECTED_RESPONSE,Je(n="live streaming app center error, code: ".concat(r.code,", reason: ")).call(n,r.reason),{code:r.code,responseTime:c});throw Rc.error(e.toString()),e}if(!r.servers||0===r.servers.length){const e=new pl(ll.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:r.code,responseTime:c});throw Rc.error(e.toString()),e}const o=function(e,t){var r;return{addressList:vo(r=e.servers).call(r,e=>{var r,i,n;return Je(r=Je(i=Je(n="wss://".concat(e.address.replace(/\./g,"-"),".")).call(n,jc("WORKER_DOMAIN"),":")).call(i,e.wss,"?serviceName=")).call(r,encodeURIComponent(t))}),workerToken:e.workerToken,vid:e.vid}}(r,t);return jc("LIVE_STREAMING_ADDRESS")&&(o.addressList=jc("LIVE_STREAMING_ADDRESS")instanceof Array?jc("LIVE_STREAMING_ADDRESS"):[jc("LIVE_STREAMING_ADDRESS")]),function(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=n_(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=n_(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}({},o,{responseTime:c})},(i,n)=>(nh.apworkerEvent(r.sid,{success:!0,sc:200,serviceName:t,responseDetail:ve(i.addressList),firstSuccess:0===n,responseTime:c,serverIp:e[n%e.length]}),!1),(i,n)=>(nh.apworkerEvent(r.sid,{success:!1,sc:i.data&&i.data.code||200,serviceName:t,responseTime:c,serverIp:e[n%e.length]}),!!(i.code!==ll.OPERATION_ABORTED&&i.code!==ll.UNEXPECTED_RESPONSE||i.data&&i.data.retry)&&(l=e[(n+1)%e.length],!0)),n)}let a_=1;function c_({url:e,areaCode:t},r,i,n){const o=Ma(),[s,a]=p_(r,t,[Rd.CHOOSE_SERVER]);let c=zd.networkState;return Kd(async()=>{c&&zd.networkState===Pu.OFFLINE&&zd.onlineWaiter&&await fo.race([zd.onlineWaiter,Ip(n&&n.maxRetryTimeout||Zd.maxRetryTimeout)]),c=zd.networkState;const t=await Wd(e,{data:s,cancelToken:i,headers:{"Content-Type":"multipart/form-data;"}},!0);nh.reportResourceTiming(e,r.sid),u_(t,e,r,o,[Rd.CHOOSE_SERVER]);const a=vp(t,Rd.CHOOSE_SERVER);return d_(a),pp(a,e)},t=>(t&&nh.joinChooseServer(r.sid,{lts:o,succ:!0,csAddr:e,opid:a,serverList:t.gatewayAddrs,ec:null,cid:t.cid.toString(),uid:t.uid.toString(),csIp:t.csIp,unilbsServerIds:[Rd.CHOOSE_SERVER].toString()}),!1),t=>t.code!==ll.OPERATION_ABORTED&&(t.code===ll.CAN_NOT_GET_GATEWAY_SERVER?t.data.retry:(nh.joinChooseServer(r.sid,{lts:o,succ:!1,csAddr:e,serverList:null,opid:a,ec:t.code,csIp:t.data&&t.data.csIp,unilbsServerIds:[Rd.CHOOSE_SERVER].toString(),extend:ve({networkState:c})}),Rc.warning("[".concat(r.clientId,"] Choose server network error, retry"),t),!0)),n)}function l_({url:e,areaCode:t,serviceIds:r},i,n,o){const s=Ma(),[a,c]=p_(i,t,r);let l=void 0;return Kd(async()=>{l&&zd.networkState===Pu.OFFLINE&&zd.onlineWaiter&&await fo.race([zd.onlineWaiter,Ip(o&&o.maxRetryTimeout||Zd.maxRetryTimeout)]),l=zd.networkState;const t=await Wd(e,{data:a,cancelToken:n,headers:{"Content-Type":"multipart/form-data;"}},!0);nh.reportResourceTiming(e,i.sid),u_(t,e,i,s,r);const c=vp(t,Rd.CHOOSE_SERVER),u=vp(t,"proxy5"===i.cloudProxyServer?Rd.CLOUD_PROXY_5:Rd.CLOUD_PROXY);return d_(c),{gatewayInfo:pp(c,e),proxyInfo:u,url:e}},t=>{var n;return t.gatewayInfo&&nh.joinChooseServer(i.sid,{lts:s,succ:!0,csAddr:e,serverList:t.gatewayInfo.gatewayAddrs,ec:null,opid:c,cid:t.gatewayInfo.cid.toString(),uid:t.gatewayInfo.uid.toString(),csIp:t.gatewayInfo.csIp,unilbsServerIds:r.toString()}),t.proxyInfo&&nh.joinWebProxyAP(i.sid,{lts:s,sucess:1,apServerAddr:e,turnServerAddrList:vo(n=t.proxyInfo.addresses).call(n,e=>e.ip).join(","),errorCode:null,eventType:i.cloudProxyServer,unilbsServerIds:r.toString()}),!1},t=>t.code!==ll.OPERATION_ABORTED&&(t.code===ll.CAN_NOT_GET_GATEWAY_SERVER?t.data.retry:(nh.joinWebProxyAP(i.sid,{lts:s,sucess:0,apServerAddr:e,turnServerAddrList:null,errorCode:t.code,eventType:i.cloudProxyServer,unilbsServerIds:r.toString(),extend:ve({networkState:l})}),Rc.warning("[".concat(i.clientId,"] multi unilbs network error, retry"),t),!0)),o)}const u_=(e,t,r,i,n)=>{var o,s,a;const c=[];if(Jr(o=e.response_body).call(o,o=>{const s=o.buffer.code;if(0!==s){const a=ef(s),l={error:new pl(ll.CAN_NOT_GET_GATEWAY_SERVER,a.desc,{retry:a.retry,csIp:e.detail[502]}),flag:o.buffer.flag};c.push(l),4096===l.flag?nh.joinChooseServer(r.sid,{lts:i,succ:!1,csAddr:t,opid:e.opid,serverList:null,ec:l.error.message,csIp:l.error.data&&l.error.data.csIp,unilbsServerIds:n.toString()}):1048576!==l.flag&&4194304!==l.flag||nh.joinWebProxyAP(r.sid,{lts:i,sucess:0,apServerAddr:t,turnServerAddrList:null,errorCode:l.error.code,eventType:r.cloudProxyServer,unilbsServerIds:n.toString()})}}),c.length)throw Rc.warning(Je(s=Je(a="[".concat(r.clientId,"] multi unilbs ")).call(a,t," failed, ")).call(s,vo(c).call(c,e=>{var t,r;return Je(t=Je(r="flag: ".concat(e.flag,", message: ")).call(r,e.error.message,", retry: ")).call(t,e.error.data.retry)}).join(" | "))),new pl(ll.CAN_NOT_GET_GATEWAY_SERVER,vo(c).call(c,e=>{var t;return Je(t="flag: ".concat(e.flag,", message: ")).call(t,e.error.message)}).join(" | "),{retry:!!Qo(c).call(c,e=>e.error.data.retry),csIp:e.detail[502]})},d_=e=>{if(e.addresses&&0===e.addresses.length&&0===e.code)throw new pl(ll.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:e.detail&&e.detail[502]});if(jc("GATEWAY_ADDRESS")&&jc("GATEWAY_ADDRESS").length>0){var t;Rc.debug("assign gateway address to",jc("GATEWAY_ADDRESS"));const r=vo(t=jc("GATEWAY_ADDRESS")).call(t,t=>({ip:t.ip,port:t.port,ticket:e.addresses[0]&&e.addresses[0].ticket}));e.addresses=r}},h_=(e,t)=>{if(e.response_body&&e.response_body.length){const t=e.response_body[0];if(0!==t.buffer.code){var r;const e=ef(t.buffer.code);throw new pl(ll.UPDATE_TICKET_FAILED,Je(r="[".concat(t.buffer.code,"]: ")).call(r,e.desc),{retry:e.retry})}return t.buffer.ticket}throw Rc.debug("update ticket request received ap response without response body:",t),new pl(ll.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},p_=(e,t,r)=>{var i;const n=Math.floor(Math.random()*10**12),o={appid:e.appId,client_ts:Ma(),opid:n,sid:e.sid,request_bodies:[{uri:22,buffer:{cname:e.cname,detail:{6:e.stringUid,11:t,12:jc("USE_NEW_TOKEN")?"1":void 0},key:e.token,service_ids:r,uid:e.uid||0}}]};Jr(i=o.request_bodies).call(i,t=>{e.multiIP&&e.multiIP.gateway_ip&&(t.buffer.detail[5]=ve({vocs_ip:[e.multiIP.uni_lbs_ip],vos_ip:[e.multiIP.gateway_ip]}))});const s=new FormData;return s.append("request",ve(o)),[s,n]},f_=(e,t)=>{var r;const i=Math.floor(Math.random()*10**12),n={appid:e.appId,client_ts:Ma(),opid:i,sid:e.sid,request_bodies:[{uri:28,buffer:{cname:e.cname,detail:{1:"",12:"1"},token:e.token,service_ids:t,uid:e.uid||0,edges_services:vo(r=e.apResponse.addresses).call(r,e=>({ip:e.ip,port:e.port}))}}]},o=new FormData;return o.append("request",ve(n)),[o,i]},g_=()=>{const e=jc("AREAS");return 0===e.length&&e.push("GLOBAL"),li(e).call(e,(e,t,r)=>{const i=m_(t);var n;return i?0===r?i:Je(n="".concat(e,",")).call(n,i):e},"")},m_=e=>{var t,r,i,n,o;return"OVERSEA"===e?Je(t=Je(r=Je(i=Je(n=Je(o="".concat(bu.ASIA,",")).call(o,bu.EUROPE,",")).call(n,bu.AFRICA,",")).call(i,bu.NORTH_AMERICA,",")).call(r,bu.SOUTH_AMERICA,",")).call(t,bu.OCEANIA):bu[e]},__={GLOBAL:{ASIA:["CHINA","JAPAN","INDIA","KOREA"],EUROPE:[],NORTH_AMERICA:[],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},v_=ni(__.GLOBAL),E_=["CHINA","NORTH_AMERICA","EUROPE","ASIA","JAPAN","INDIA","OCEANIA","SOUTH_AMERICA","AFRICA","KOREA"],A_=function(e,t){let r=[];if(is(e).call(e,"GLOBAL")){const n=["GLOBAL","OVERSEA"],o=ni(Iu);if("GLOBAL"===t)throw new pl(ll.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if("CHINA"===t)r=["OVERSEA"];else if(i=t,is(v_).call(v_,i)){const e=__.GLOBAL[t]||[],i=[...n,t,...e];r=ji(o).call(o,e=>!is(i).call(i,e))}else if(function(e){let t=!1;return Jr(v_).call(v_,r=>{var i;is(i=__.GLOBAL[r]).call(i,e)&&(t=!0)}),t}(t)){const e=function(e){let t;return Jr(v_).call(v_,r=>{var i;is(i=__.GLOBAL[r]).call(i,e)&&(t=r)}),t}(t),i=[...n,e,t];r=ji(o).call(o,e=>!is(i).call(i,e))}else r=e;r=function(e){const t=[];return Jr(E_).call(E_,r=>{is(e).call(e,r)&&t.push(r)}),Je(t).call(t,ji(e).call(e,e=>!is(E_).call(E_,e)))}(r)}else r=e;var i;return r};function y_(e){const t=nh.reportApiInvoke(null,{name:Nl.SET_AREA,options:e,tag:Ll.TRACER});try{var r;let t=[];if("string"==typeof e&&(t=[e]),hl(e)&&(Jr(e).call(e,e=>{if(!is(Tu).call(Tu,e))throw new pl(ll.INVALID_PARAMS,"invalid area code")}),t=e),"[object Object]"===Object.prototype.toString.call(e)){const{areaCode:r,excludedArea:i}=e;if(!r)throw new pl(ll.INVALID_PARAMS,"area code is needed");let n=r;"string"==typeof r&&(n=[r]),t=i?A_(n,i):n}Vc("AREAS",t);const i=(e=>{const t={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return vo(e).call(e,e=>{const r=Iu[e],i=ni(r);i&&vo(i).call(i,e=>{var i;"CODE"!==e&&(t[e]=Je(i=t[e]).call(i,r[e]))})}),t})(t);vo(r=ni(i)).call(r,e=>{Vc(e,"LOG_UPLOAD_SERVER"===e||"EVENT_REPORT_DOMAIN"===e||"EVENT_REPORT_BACKUP_DOMAIN"===e||"PROXY_SERVER_TYPE3"===e?i[e][0]:i[e])}),Rc.debug("set area success:",t.join(","))}catch(e){throw t.onError(e),e}t.onSuccess()}async function S_(e,t,r){const i=async function(e,t,r){var i,n;const o=vo(i=Uo(n=jc("WEBCS_DOMAIN")).call(n,0,jc("AJAX_REQUEST_CONCURRENT"))).call(i,t=>{var r;return{url:e.proxyServer?Je(r="https://".concat(e.proxyServer,"/ap/?url=")).call(r,t+"/api/v2/transpond/webrtc?v=2"):"https://".concat(t,"/api/v2/transpond/webrtc?v=2"),areaCode:g_()}});let s=null;const a=[],c=async()=>await Zp({fragementLength:jc("FRAGEMENT_LENGTH"),referenceList:o,asyncMapHandler:i=>(Rc.debug("[".concat(e.clientId,"] Connect to choose_server:"),i.url),c_(i,e,t,r)),allFailedhandler:e=>{throw e[0]},promisesCollector:a}),l=async()=>{var i;if(await Ip(1e3),null!==s)return s;const n=vo(i=jc("WEBCS_DOMAIN_BACKUP_LIST")).call(i,t=>{var r;return{url:e.proxyServer?Je(r="https://".concat(e.proxyServer,"/ap/?url=")).call(r,t+"/api/v2/transpond/webrtc?v=2"):"https://".concat(t,"/api/v2/transpond/webrtc?v=2"),areaCode:g_()}});return await Zp({fragementLength:jc("FRAGEMENT_LENGTH"),referenceList:n,asyncMapHandler:i=>(Rc.debug("[".concat(e.clientId,"] Connect to backup choose_server:"),i.url),c_(i,e,t,r)),allFailedhandler:e=>{throw e[0]},promisesCollector:a})};try{return s=await Pp([c(),l()]),a.length&&Jr(a).call(a,e=>e.cancel&&"function"==typeof e.cancel&&e.cancel()),s}catch(e){throw e[0]}}(e,t,r);return{gatewayInfo:await i}}async function C_(e,t,r,i){var n,o;if("disabled"===e.cloudProxyServer)return i?await S_(e,t,r):void 0;let s;if("443only"===e.cloudProxyServer||"normal"===e.cloudProxyServer){var a;let n;i?"normal"!==e.cloudProxyServer?[n,s]=await fo.all([b_(e,t,r),S_(e,t,r)]):(n=await b_(e,t,r),e.proxyServer=n.addresses[0],nh.setProxyServer(e.proxyServer),Rc.setProxyServer(e.proxyServer),s=await S_(e,t,r)):(s=void 0,"normal"!==e.cloudProxyServer?n=await b_(e,t,r):(n=await b_(e,t,r),e.proxyServer=n.addresses[0],nh.setProxyServer(e.proxyServer),Rc.setProxyServer(e.proxyServer))),e.turnServer={mode:"manual",servers:vo(a=n.addresses).call(a,t=>({turnServerURL:t,tcpport:"proxy3"===e.cloudProxyServer?void 0:n.serverResponse.tcpport?n.serverResponse.tcpport:Nc.tcpport,udpport:"proxy4"===e.cloudProxyServer?void 0:n.serverResponse.udpport?n.serverResponse.udpport:Nc.udpport,username:n.serverResponse.username||Nc.username,password:n.serverResponse.password||Nc.password,forceturn:"proxy4"!==e.cloudProxyServer&&"proxy5"!==e.cloudProxyServer,security:"proxy5"===e.cloudProxyServer}))}}else{const{proxyInfo:i,gatewayInfo:n}=await async function(e,t,r){var i,n;const o=jc("PROXY_SERVER_TYPE3"),s=(e,t)=>{var r;let i=o;return hl(i)&&(i=t%2==0?o[1]:o[0]),Je(r="https://".concat(i,"/ap/?url=")).call(r,e)},a=vo(i=Uo(n=jc("WEBCS_DOMAIN")).call(n,0,jc("AJAX_REQUEST_CONCURRENT"))).call(i,(t,r)=>({url:s("".concat(t,"/api/v2/transpond/webrtc?v=2"),r),areaCode:g_(),serviceIds:[Rd.CHOOSE_SERVER,"proxy5"===e.cloudProxyServer?Rd.CLOUD_PROXY_5:Rd.CLOUD_PROXY]}));let c=null;const l=[],u=async()=>await Zp({fragementLength:jc("FRAGEMENT_LENGTH"),referenceList:a,asyncMapHandler:i=>(Rc.debug("[".concat(e.clientId,"] Connect to choose_server:"),i.url),l_(i,e,t,r)),allFailedhandler:e=>{throw e[0]},promisesCollector:l}),d=async()=>{var i;if(await Ip(1e3),null!==c)return c;const n=vo(i=jc("WEBCS_DOMAIN_BACKUP_LIST")).call(i,(e,t)=>({url:s("".concat(e,"/api/v2/transpond/webrtc?v=2"),t),areaCode:g_(),serviceIds:[11,18]}));return await Zp({fragementLength:jc("FRAGEMENT_LENGTH"),referenceList:n,asyncMapHandler:i=>(Rc.debug("[".concat(e.clientId,"] Connect to backup choose_server:"),i.url),l_(i,e,t,r)),allFailedhandler:e=>{throw e[0]},promisesCollector:l})};let h,p,f;try{({gatewayInfo:h,proxyInfo:p,url:f}=await Pp([u(),d()]))}catch(e){throw e[0]}if(l.length&&Jr(l).call(l,e=>e.cancel&&"function"==typeof e.cancel&&e.cancel()),!h||!p)throw new pl(ll.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(hl(o)&&f){const t=new i_(f).host;is(o).call(o,t)&&(e.proxyServer=t,Rc.setProxyServer(t),nh.setProxyServer(t))}return c={gatewayInfo:h,proxyInfo:await Ep(p,h.uid)},c}(e,t,r);s={gatewayInfo:n},e.turnServer={mode:"manual",servers:vo(i).call(i,t=>({turnServerURL:t.address,tcpport:"proxy3"===e.cloudProxyServer?void 0:t.tcpport?t.tcpport:Nc.tcpport,udpport:"proxy4"===e.cloudProxyServer?void 0:t.udpport?t.udpport:Nc.udpport,username:t.username||Nc.username,password:t.password||Nc.password,forceturn:"proxy4"!==e.cloudProxyServer&&"proxy5"!==e.cloudProxyServer,security:"proxy5"===e.cloudProxyServer}))}}return Rc.debug(Je(n=Je(o="[".concat(e.clientId,"] set proxy server: ")).call(o,e.proxyServer,", mode: ")).call(n,e.cloudProxyServer)),s}async function T_(e,t,r,i){var n;const o=Uo(n=jc("ACCOUNT_REGISTER")).call(n,0,jc("AJAX_REQUEST_CONCURRENT"));let s=[];return s=t.proxyServer?vo(o).call(o,e=>{var r;return Je(r="https://".concat(t.proxyServer,"/ap/?url=")).call(r,e+"/api/v1")}):vo(o).call(o,e=>"https://".concat(e,"/api/v1")),(await async function(e,t,r,i,n){const o=Ma(),s={sid:r.sid,opid:10,appid:r.appId,string_uid:t};let a=e[0];const c=await Kd(()=>Wd(a+"".concat(-1===Lo(a).call(a,"?")?"?":"&","action=stringuid"),{data:s,cancelToken:i,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(r,i)=>{if(0===r.code){var n;if(r.uid<=0||r.uid>=Math.pow(2,32))throw Rc.error(Je(n="Invalid Uint Uid ".concat(t," => ")).call(n,r.uid),r),nh.reqUserAccount(s.sid,{lts:o,success:!1,serverAddr:a,stringUid:s.string_uid,uid:r.uid,errorCode:ll.INVALID_UINT_UID_FROM_STRING_UID,extend:s}),new pl(ll.INVALID_UINT_UID_FROM_STRING_UID);return nh.reqUserAccount(s.sid,{lts:o,success:!0,serverAddr:a,stringUid:s.string_uid,uid:r.uid,errorCode:null,extend:s}),!1}const c=ef(r.code);return c.retry&&(a=e[(i+1)%e.length]),nh.reqUserAccount(s.sid,{lts:o,success:!1,serverAddr:a,stringUid:s.string_uid,uid:r.uid,errorCode:c.desc,extend:s}),c.retry},(t,r)=>t.code!==ll.OPERATION_ABORTED&&(nh.reqUserAccount(s.sid,{lts:o,success:!1,serverAddr:a,stringUid:s.string_uid,uid:null,errorCode:t.code,extend:s}),a=e[(r+1)%e.length],!0),n);if(0!==c.code){const e=ef(c.code);throw new pl(ll.UNEXPECTED_RESPONSE,e.desc)}return c}(s,e,t,r,i)).uid}async function b_(e,t,r){var i,n;let o=Ma();const s=vo(i=jc("normal"===e.cloudProxyServer?"PROXY_CS":"WEBCS_DOMAIN")).call(i,t=>{var r;return e.proxyServer?Je(r="https://".concat(e.proxyServer,"/ap/?url=")).call(r,t+"/api/v1"):"https://".concat(t,"/api/v1")});if("proxy3"===e.cloudProxyServer||"proxy4"===e.cloudProxyServer||"proxy5"===e.cloudProxyServer){const i=vo(s).call(s,e=>({url:e,areaCode:g_()}));let n=null;n=await Zp({fragementLength:jc("FRAGEMENT_LENGTH"),referenceList:i,asyncMapHandler:i=>function({url:e,areaCode:t},r,i,n){const o=Ma(),s={opid:133,flag:"proxy5"===r.cloudProxyServer?4194304:1048576,ts:+new Date,key:r.token,cname:r.cname,sid:r.sid,detail:{6:r.stringUid,11:t},uid:r.uid||0};return Kd(async()=>await Wd(e,{data:s,cancelToken:i,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":69}}),t=>{var i;if(0===t.code)return nh.joinWebProxyAP(r.sid,{lts:o,sucess:1,apServerAddr:e,turnServerAddrList:vo(i=t.addresses).call(i,e=>e.ip).join(","),errorCode:null,eventType:r.cloudProxyServer}),!1;const n=ef(t.code);throw new pl(ll.CAN_NOT_GET_GATEWAY_SERVER,n.desc,{retry:n.retry})},t=>{return t.code!==ll.OPERATION_ABORTED&&(t.code===ll.CAN_NOT_GET_GATEWAY_SERVER?(nh.joinWebProxyAP(s.sid,{lts:o,sucess:0,apServerAddr:e,turnServerAddrList:null,errorCode:t.code,eventType:r.cloudProxyServer}),Rc.warning(Je(i=Je(n=Je(a="[".concat(r.clientId,"] proxy ap server ")).call(a,e," failed, message: ")).call(n,t.message,", retry: ")).call(i,t.data.retry)),t.data.retry):(nh.joinWebProxyAP(s.sid,{lts:o,sucess:0,apServerAddr:e,turnServerAddrList:null,errorCode:t.code,eventType:r.cloudProxyServer}),!0));var i,n,a},n)}(i,e,t,r),allFailedhandler:()=>{throw Rc.error("[".concat(e.clientId,"] can not get proxy server after trying several times")),new pl(ll.CAN_NOT_GET_PROXY_SERVER)}});const o=n.addresses;if(!o||0===o.length)throw Rc.error("[".concat(e.clientId,"] can not get proxy server, empty proxy server list")),new pl(ll.CAN_NOT_GET_PROXY_SERVER,"empty proxy server list");return{addresses:vo(o).call(o,e=>e.ip),serverResponse:{tcpport:o[0].port||443,udpport:o[0].port||Nc.udpport,username:Nc.username,password:Nc.password}}}let a=null;a=await Zp({fragementLength:jc("FRAGEMENT_LENGTH"),referenceList:s,asyncMapHandler:i=>function(e,t,r,i){const n=Ma(),o={command:"convergeAllocateEdge",sid:t.sid,appId:t.appId,token:t.token,uid:t.uid,cname:t.cname,ts:Math.floor(Ma()/1e3),version:kc,seq:0,requestId:1};return Kd(async()=>({res:await Wd(e,{data:{service_name:"webrtc_proxy",json_body:ve(o)},cancelToken:r,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}}),url:e}),e=>{if(!e.res.json_body)throw Rc.debug("[".concat(t.clientId,"] Get proxy server failed: no json_body")),new pl(ll.UNEXPECTED_RESPONSE,ve(e.res));const r=JSON.parse(e.res.json_body);var i,n;if(200!==r.code)throw Rc.debug(Je(i=Je(n="[".concat(t.clientId,"] Get proxy server failed: response code [")).call(n,r.code,"], reason [")).call(i,r.reason,"]")),new pl(ll.UNEXPECTED_RESPONSE,ve(e.res));return Rc.debug("[".concat(t.clientId,"] App return server length"),r.servers.length),!1},t=>t.code!==ll.OPERATION_ABORTED&&(nh.requestProxyAppCenter(o.sid,{lts:n,succ:!1,APAddr:e,workerManagerList:null,ec:t.code,response:t.message}),!0),i)}(i,e,t,r),allFailedhandler:()=>{throw Rc.error("[".concat(e.clientId,"] can not get proxy server after trying several times")),new pl(ll.CAN_NOT_GET_PROXY_SERVER)}});const c=JSON.parse(a.res.json_body),l=vo(n=c.servers).call(n,dp);if("443only"===e.cloudProxyServer)return{addresses:l,serverResponse:{tcpport:443,udpport:Nc.udpport,username:Nc.username,password:Nc.password}};nh.requestProxyAppCenter(e.sid,{lts:o,succ:!0,APAddr:a.url,workerManagerList:ve(l),ec:null,response:ve(a.res)}),o=Ma();const u=vo(l).call(l,i=>function(e,t,r,i){const n=Ma();let o=e;Is(e).call(e,"http")||(o="https://".concat(e,":4000/v2/machine"));const s={command:"request",gatewayType:"http",appId:t.appId,cname:t.cname,uid:(t.uid||"").toString(),sdkVersion:"2.3.1",sid:t.sid,seq:1,ts:Ma(),requestId:3,clientRequest:{appId:t.appId,cname:t.cname,uid:(t.uid||"").toString(),sid:t.sid}};return Kd(async()=>({res:await Wd(o,{data:s,cancelToken:r}),url:e}),e=>{if(!e.res.serverResponse)throw new pl(ll.UNEXPECTED_RESPONSE,"requeet worker manager server failed: serverResponse is undefined");return!1},t=>t.code!==ll.OPERATION_ABORTED&&(nh.requestProxyWorkerManager(s.sid,{lts:n,succ:!1,workerManagerAddr:e,ec:t.code,response:t.message}),!0),i)}(i,e,t,r));let d=null;try{d=await Pp(u)}catch(t){throw Rc.error("[".concat(e.clientId,"] can not get worker manager after trying several times")),new pl(ll.CAN_NOT_GET_PROXY_SERVER)}return Jr(u).call(u,e=>e.cancel()),nh.requestProxyWorkerManager(e.sid,{lts:o,succ:!0,workerManagerAddr:d.url,ec:null,response:ve(d.res)}),{addresses:[d.url],serverResponse:d.res.serverResponse}}async function I_(e,t,r){var i,n;const o=vo(i=Uo(n=jc("CDS_AP")).call(n,0,jc("AJAX_REQUEST_CONCURRENT"))).call(i,t=>{var r;return e.proxyServer?Je(r="https://".concat(e.proxyServer,"/ap/?url=")).call(r,t+"/api/v1"):"https://".concat(t,"/api/v1?action=config")}),s=vo(o).call(o,i=>function(e,t,r,i){const n=ma(),o={flag:64,cipher_method:0,features:{device:n.name,system:n.os,system_general:navigator.userAgent,vendor:t.appId,version:kc,cname:t.cname,sid:t.sid,session_id:t.sid,detail:"",proxyServer:t.proxyServer}};return Kd(()=>Wd(e,{data:o,timeout:1e3,cancelToken:r,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,e=>e.code!==ll.OPERATION_ABORTED,i)}(i,e,t,r));let a=null,c=null,l={};try{a=await Pp(s)}catch(e){if(e.code===ll.OPERATION_ABORTED)throw e;c=e}if(Jr(s).call(s,e=>e.cancel()),nh.reportApiInvoke(e.sid,{name:Nl.REQUEST_CONFIG_DISTRIBUTE,options:{error:c,res:a}}).onSuccess(),a&&a.test_tags)try{l=function(e){if(!e.test_tags)return{};const t=e.test_tags,r=ni(t),i={};return Jr(r).call(r,e=>{var r;const n=Os(r=Uo(e).call(e,4)).call(r),o=JSON.parse(t[e])[1];i[n]=o}),i}(a)}catch(e){}return l}async function R_(e,t,r,i){var n,o;const s=vo(n=Uo(o=jc("UAP_AP")).call(o,0,jc("AJAX_REQUEST_CONCURRENT"))).call(n,e=>{var r;return t.proxyServer?Je(r="https://".concat(t.proxyServer,"/ap/?url=")).call(r,e+"/api/v1?action=uap"):"https://".concat(e,"/api/v1?action=uap")});return await s_(s,e,t,r,i)}async function w_(e,t,r){var i,n;const o=vo(i=Uo(n=jc("UAP_AP")).call(n,0,jc("AJAX_REQUEST_CONCURRENT"))).call(i,t=>{var r;return e.proxyServer?Je(r="https://".concat(e.proxyServer,"/ap/?url=")).call(r,t+"/api/v1?action=uap"):"https://".concat(t,"/api/v1?action=uap")}),s=vo(o).call(o,i=>function(e,t,r,i){const n={command:"convergeAllocateEdge",sid:t.sid,appId:t.appId,token:t.token,ts:Ma(),version:kc,cname:t.cname,uid:t.uid.toString(),requestId:a_,seq:a_};a_+=1;const o={service_name:"tele_channel",json_body:ve(n)};return Kd(async()=>{var t;const i=await Wd(e,{data:o,cancelToken:r,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(0!==i.code){const e=new pl(ll.UNEXPECTED_RESPONSE,"cross channel ap error, code"+i.code,{retry:!0});throw Rc.error(e.toString()),e}const n=JSON.parse(i.json_body);if(200!==n.code){var s;const e=new pl(ll.UNEXPECTED_RESPONSE,Je(s="cross channel app center error, code: ".concat(n.code,", reason: ")).call(s,n.reason));throw Rc.error(e.toString()),e}if(!n.servers||0===n.servers.length){const e=new pl(ll.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw Rc.error(e.toString()),e}return{vid:n.vid,workerToken:n.workerToken,addressList:vo(t=n.servers).call(t,e=>{var t,r;return Je(t=Je(r="wss://".concat(e.address.replace(/\./g,"-"),".")).call(r,jc("WORKER_DOMAIN"),":")).call(t,e.wss)})}},void 0,e=>!!(e.code!==ll.OPERATION_ABORTED&&e.code!==ll.UNEXPECTED_RESPONSE||e.data&&e.data.retry),i)}(i,e,t,r));try{const e=await Pp(s);return Jr(s).call(s,e=>e.cancel()),e}catch(e){throw e[0]}}async function k_(e,t,r){let i=null;const n=[],o=async o=>{var s;const a=vo(s=jc(o?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN")).call(s,t=>{var r;return e.proxyServer?Je(r="https://".concat(e.proxyServer,"/ap/?url=")).call(r,t+"/api/v2/transpond/webrtc?v=2"):"https://".concat(t,"/api/v2/transpond/webrtc?v=2")});return o&&(await Ip(1e3),null!==i)?i:await Zp({fragementLength:jc("FRAGEMENT_LENGTH"),referenceList:a,asyncMapHandler:i=>{var n;return Rc.debug(Je(n="[".concat(e.clientId,"] update ticket, Connect to ")).call(n,o?"backup":""," choose_server:"),i),function(e,t,r,i){const[n]=f_(t,[Rd.CHOOSE_SERVER]);let o=zd.networkState;return Kd(async()=>{o&&zd.networkState===Pu.OFFLINE&&zd.onlineWaiter&&await fo.race([zd.onlineWaiter,Ip(i&&i.maxRetryTimeout||Zd.maxRetryTimeout)]),o=zd.networkState;const t=await Wd(e,{data:n,cancelToken:r,headers:{"Content-Type":"multipart/form-data;"}},!0);return h_(t,e)},()=>!1,e=>e.code!==ll.OPERATION_ABORTED&&(e.code===ll.UPDATE_TICKET_FAILED?e.data.retry:(Rc.warning("[".concat(t.clientId,"] update ticket network error, retry"),e),!0)),i)}(i,e,t,r)},allFailedhandler:e=>{throw e[0]},promisesCollector:n})};try{return i=await Pp([o(!1),o(!0)]),n.length&&Jr(n).call(n,e=>e.cancel&&"function"==typeof e.cancel&&e.cancel()),i}catch(e){throw e[0]}}function O_(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function N_(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=O_(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=O_(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}class L_ extends Mu{constructor(){super(),this.retryConfig={timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4},this.mutex=new ah("config-distribute"),this.mutableParamsRead=!1}startGetConfigDistribute(e,t){this.joinInfo=e,this.cancelToken=t,this.interval&&this.stopGetConfigDistribute(),this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},jc("CONFIG_DISTRIBUTE_INTERVAL"))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0}async awaitConfigDistributeComplete(){this.mutex.isLocked&&(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,nh.reportApiInvoke(null,{options:void 0,name:Nl.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:Ll.TRACER}).onSuccess(ve(Hc))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return void Rc.debug("[config-distribute] get config distribute interrupted have no joininfo");let e;const t=await this.mutex.lock();try{e=await I_(this.joinInfo,this.cancelToken,this.retryConfig),Rc.debug("[config-distribute] get config distribute",ve(e)),e.limit_bitrate&&this.handleBitrateLimit(e.limit_bitrate),this.cacheGlobalParameterConfig(e),this.configs=e}catch(e){const t=new pl(ll.NETWORK_RESPONSE_ERROR,e);Rc.warning("[config-distribute] ".concat(t.toString()))}finally{t()}}getBitrateLimit(){return this.configs?this.configs.limit_bitrate:void 0}handleBitrateLimit(e){var t;(t=e)&&t.uplink&&t.id&&void 0!==t.uplink.max_bitrate&&void 0!==t.uplink.min_bitrate&&(this.configs&&this.configs.limit_bitrate?this.configs&&this.configs.limit_bitrate&&this.configs.limit_bitrate.id!==e.id&&this.emit(Ru.UPDATE_BITRATE_LIMIT,e):this.emit(Ru.UPDATE_BITRATE_LIMIT,e))}getLowStreamConfigDistribute(){return this.configs&&this.configs.limit_bitrate&&N_({},this.configs.limit_bitrate.low_stream_uplink)}cacheGlobalParameterConfig(e){var t,r;const i=cl(t=ji(r=ni(e)).call(r,e=>/^webrtc_ng_global_parameter/.test(e))).call(t);for(let o=0;o<i.length;o++)for(let t=i.length-1;t>o;t--){const r=i[t];if("number"==typeof e[r].__priority){const n=e[r].__priority,o=i[t-1];if("number"==typeof e[o].__priority){if(!(n>e[o].__priority))continue;{const e=r;i[t]=i[t-1],i[t-1]=e}}else{const e=r;i[t]=i[t-1],i[t-1]=e}}}const n={};Jr(i).call(i,t=>{var r;const i=e[t],o=i.__expires;Jr(r=ni(i)).call(r,e=>{"__priority"!==e&&"__expires"!==e&&!Object.prototype.hasOwnProperty.call(n,e)&&i[e]&&(n[e]=N_({value:i[e]},o&&{expires:o}))})});try{const e=ve(n),t=window.btoa(e);window.localStorage.setItem("websdk_ng_global_parameter",t),Rc.debug("Caching global parameters ".concat(e))}catch(e){Rc.error("Error caching global parameters:",e.message)}}}function P_(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function D_(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=P_(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=P_(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}class M_ extends Mu{constructor(e,t,r,i){super(),this.reconnectMode="retry",this.reqId=0,this.commandReqId=0,this.handleWebSocketOpen=()=>{this.reconnectMode="retry",this.startPingPong()},this.handleWebSocketMessage=e=>{if(!e.data)return;const t=JSON.parse(e.data);var r;t.requestId?this.emit(Je(r="@".concat(t.requestId,"-")).call(r,t.sid),t):this.serviceMode===ou.INJECT?this.emit(du.INJECT_STREAM_STATUS,t):(nh.workerEvent(this.spec.sid,{actionType:"status",serverCode:t.code,workerType:this.serviceMode===ou.TRANSCODE?1:2}),this.emit(du.PUBLISH_STREAM_STATUS,t))},this.spec=t,this.token=e,this.serviceMode=i,this.websocket=new Hf("live-streaming",r),this.websocket.on(nu.CONNECTED,this.handleWebSocketOpen),this.websocket.on(nu.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(nu.REQUEST_NEW_URLS,(e,t)=>{Dp(this,du.REQUEST_NEW_ADDRESS).then(e).catch(t)}),this.websocket.on(nu.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(e){return this.websocket.init(e)}async request(e,t,r,i){this.reqId+=1,"request"===e&&(this.commandReqId+=1);const n=this.commandReqId,o=this.reqId;if(!o||!this.websocket)throw new pl(ll.UNEXPECTED_ERROR);const s=D_({command:e,sdkVersion:"4.8.1"===kc?"0.0.1":kc,seq:o,requestId:o,allocate:r,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Ma()/1e3)},t);if("closed"===this.websocket.state)throw new pl(ll.WS_DISCONNECT);const a=()=>new fo((e,t)=>{this.websocket.once(nu.CLOSED,()=>t(new pl(ll.WS_ABORT))),this.websocket.once(nu.CONNECTED,e)});"connected"!==this.websocket.state&&await a(),s.clientRequest&&(s.clientRequest.workerToken=this.token);const c=new fo((e,t)=>{var r;const i=()=>{t(new pl(ll.WS_ABORT))};this.websocket.once(nu.RECONNECTING,i),this.websocket.once(nu.CLOSED,i),this.once(Je(r="@".concat(o,"-")).call(r,this.spec.sid),t=>{e(t)})});i&&nh.workerEvent(this.spec.sid,D_({},i,{requestId:n,actionType:"request",payload:ve(t.clientRequest),serverCode:0,code:0}));const l=Ma();this.websocket.sendMessage(s);let u=null;try{u=await c}catch(i){if("closed"===this.websocket.state)throw i;return await a(),await this.request(e,t,r)}return i&&nh.workerEvent(this.spec.sid,D_({},i,{requestId:n,actionType:"response",payload:ve(u.serverResponse),serverCode:u.code,success:200===u.code,responseTime:Ma()-l})),200!==u.code&&this.handleResponseError(u),u}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const e="4.8.1"===kc?"0.0.1":kc;this.reqId+=1,"connected"===this.websocket.state?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:e,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Ma()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(e){switch(e.code){case pu.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void Rc.warning("live stream response already exists stream");case pu.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case pu.LIVE_STREAM_RESPONSE_BAD_STREAM:case pu.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new pl(ll.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:e.code}).throw();case pu.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if("UnpublishStream"===e.serverResponse.command||"UninjectStream"===e.serverResponse.command)return;throw new pl(ll.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case pu.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new pl(ll.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:e.code}).throw();case pu.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const t=new pl(ll.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(du.WARNING,t,e.serverResponse.url)}case pu.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const t=new pl(ll.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(du.WARNING,t,e.serverResponse.url)}case pu.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new pl(ll.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case pu.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new pl(ll.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:e.code}).throw();case pu.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const t=new pl(ll.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(du.WARNING,t,e.serverResponse.url)}case pu.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new pl(ll.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:e.code}).throw();case pu.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new pl(ll.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case pu.LIVE_STREAM_RESPONSE_WORKER_LOST:case pu.LIVE_STREAM_RESPONSE_WORKER_QUIT:if("UnpublishStream"===e.serverResponse.command||"UninjectStream"===e.serverResponse.command)return;throw new pl(ll.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case pu.ERROR_FAIL_SEND_MESSAGE:if("UnpublishStream"===e.serverResponse.command||"UninjectStream"===e.serverResponse.command)return;if("UpdateTranscoding"===e.serverResponse.command||"ControlStream"===e.serverResponse.command)return new pl(ll.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:e.code}).throw();throw new pl(ll.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case pu.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case pu.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case pu.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case pu.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new pl(ll.LIVE_STREAMING_CDN_ERROR,"",{code:e.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{"connected"===this.websocket.state&&this.request("ping",{}).catch(Np)},6e3)}}function x_(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function B_(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=x_(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=x_(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}class U_ extends Mu{constructor(e,t=Zd,r=Zd){super(),this.retryTimeout=1e4,this.streamingTasks=new Mr,this.isStartingStreamingTask=!1,this.taskMutex=new ah("live-streaming"),this.cancelToken=Sc.CancelToken.source(),this.injectConfig=B_({},uu),this.injectLoopTimes=0,this.lastTaskId=1,this.statusError=new Mr,this.spec=e,this.httpRetryConfig=r,this.wsRetryConfig=t}async setTranscodingConfig(e){var t;const r=B_({},lu,{},e);var i,n;66!==r.videoCodecProfile&&77!==r.videoCodecProfile&&100!==r.videoCodecProfile&&(Rc.debug(Je(i="[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ")).call(i,r.videoCodecProfile," -> 100")),r.videoCodecProfile=100),r.transcodingUsers||(r.transcodingUsers=r.userConfigs),r.transcodingUsers&&(r.transcodingUsers=vo(n=r.transcodingUsers).call(n,e=>B_({},su,{},e,{zOrder:e.zOrder?e.zOrder+1:1}))),function(e){var t,r;yl(e.width)||ml(e.width,"config.width",0,1e4),yl(e.height)||ml(e.height,"config.height",0,1e4),yl(e.videoBitrate)||ml(e.videoBitrate,"config.videoBitrate",1,1e6),yl(e.videoFrameRate)||ml(e.videoFrameRate,"config.videoFrameRate"),yl(e.lowLatency)||fl(e.lowLatency,"config.lowLatency"),yl(e.audioSampleRate)||gl(e.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),yl(e.audioBitrate)||ml(e.audioBitrate,"config.audioBitrate",1,128),yl(e.audioChannels)||gl(e.audioChannels,"config.audioChannels",[1,2,3,4,5]),yl(e.videoGop)||ml(e.videoGop,"config.videoGop"),yl(e.videoCodecProfile)||gl(e.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),yl(e.userCount)||ml(e.userCount,"config.userCount",0,17),yl(e.backgroundColor)||ml(e.backgroundColor,"config.backgroundColor",0,16777215),yl(e.userConfigExtraInfo)||_l(e.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),e.transcodingUsers&&!yl(e.transcodingUsers)&&(vl(e.transcodingUsers,"config.transcodingUsers"),Jr(t=e.transcodingUsers).call(t,(e,t)=>{Al(e.uid),yl(e.x)||ml(e.x,"transcodingUser[".concat(t,"].x"),0,1e4),yl(e.y)||ml(e.y,"transcodingUser[".concat(t,"].y"),0,1e4),yl(e.width)||ml(e.width,"transcodingUser[".concat(t,"].width"),0,1e4),yl(e.height)||ml(e.height,"transcodingUser[".concat(t,"].height"),0,1e4),yl(e.zOrder)||ml(e.zOrder-1,"transcodingUser[".concat(t,"].zOrder"),0,100),yl(e.alpha)||ml(e.alpha,"transcodingUser[".concat(t,"].alpha"),0,1,!1)})),yl(e.watermark)||cu(e.watermark,"watermark"),yl(e.backgroundImage)||cu(e.backgroundImage,"backgroundImage"),e.images&&!yl(e.images)&&(vl(e.images,"config.images"),Jr(r=e.images).call(r,(e,t)=>{cu(e,"images[".concat(t,"]"))}))}(r);const o=[];var s,a;r.images&&o.push(...vo(s=r.images).call(s,e=>B_({},au,{},e,{zOrder:255}))),r.backgroundImage&&(o.push(B_({},au,{},r.backgroundImage,{zOrder:0})),delete r.backgroundImage),r.watermark&&(o.push(B_({},au,{},r.watermark,{zOrder:255})),delete r.watermark),r.images=o,r.transcodingUsers&&(r.userConfigs=vo(a=r.transcodingUsers).call(a,e=>B_({},e)),r.userCount=r.transcodingUsers.length,delete r.transcodingUsers);const c=vo(t=r.userConfigs||[]).call(t,e=>"number"==typeof e.uid?fo.resolve(e.uid):T_(e.uid,this.spec,this.cancelToken.token,this.httpRetryConfig)),l=await fo.all(c);if(Jr(l).call(l,(e,t)=>{r.userConfigs&&r.userConfigs[t]&&(r.userConfigs[t].uid=e)}),this.transcodingConfig=r,this.connection)try{var u,d,h;const e=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:vo(u=Bd(Jp(d=this.streamingTasks).call(d))).call(u,e=>e.taskId).join("#")});Rc.debug(Je(h="[".concat(this.spec.clientId,"] update live transcoding config success, code: ")).call(h,e.code,", config:"),ve(this.transcodingConfig))}catch(e){var p;if(!e.data||!e.data.retry)throw e;e.data.changeAddress&&this.connection.tryNextAddress(),Jr(p=this.streamingTasks).call(p,t=>{Rc.warning("[".concat(this.spec.clientId,"] live streaming receive error"),e.toString(),"try to republish",t.url),this.startLiveStreamingTask(t.url,t.mode,e).then(()=>{var e;Rc.debug(Je(e="[".concat(this.spec.clientId,"] live streaming republish ")).call(e,t.url," success"))}).catch(e=>{Rc.error("[".concat(this.spec.clientId,"] live streaming republish failed"),t.url,e.toString()),this.onLiveStreamError&&this.onLiveStreamError(t.url,e)})})}}setInjectStreamConfig(e,t){this.injectConfig=ri({},this.injectConfig,e),this.injectLoopTimes=t}async startLiveStreamingTask(e,t,r){var i,n,o,s;if(Qo(i=Bd(Jp(n=this.streamingTasks).call(n))).call(i,e=>e.mode===ou.INJECT)&&t===ou.INJECT)return new pl(ll.LIVE_STREAMING_TASK_CONFLICT,"inject stream over limit").throw();if(!this.transcodingConfig&&t===ou.TRANSCODE)throw new pl(ll.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");let a={command:"PublishStream",ts:Ma(),url:e,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};Rc.debug(Je(o=Je(s="[".concat(this.spec.clientId,"] start live streaming ")).call(s,e,", mode: ")).call(o,t));const c=await this.taskMutex.lock();if(!this.connection&&r)return void c();if(this.streamingTasks.get(e)&&!r)return c(),new pl(ll.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(t))}catch(e){throw c(),e}switch(t){case ou.TRANSCODE:a.transcodingConfig=B_({},this.transcodingConfig);break;case ou.RAW:break;case ou.INJECT:a={cname:this.spec.cname,command:"InjectStream",sid:this.spec.sid,transcodingConfig:this.injectConfig,ts:Ma(),url:e,loopTimes:this.injectLoopTimes}}this.uapResponse&&this.uapResponse.vid&&(a.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;const l=this.lastTaskId++;try{var u;const i=new fo((t,i)=>{Ip(this.retryTimeout).then(()=>{if(r)return i(r);const t=this.statusError.get(e);return t?(this.statusError.delete(e),i(t)):void 0})}),n=await fo.race([this.connection.request("request",{clientRequest:a},!0,{url:e,command:"PublishStream",workerType:t===ou.TRANSCODE?1:2,requestByUser:!r,tid:l.toString()}),i]);this.isStartingStreamingTask=!1,Rc.debug(Je(u="[".concat(this.spec.clientId,"] live streaming started, code: ")).call(u,n.code)),this.streamingTasks.set(e,{clientRequest:a,mode:t,url:e,taskId:l}),c()}catch(i){if(c(),this.isStartingStreamingTask=!1,!i.data||!i.data.retry||r)throw i;return i.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(e,t,i)):await this.startLiveStreamingTask(e,t,i)}}stopLiveStreamingTask(e){return new fo((t,r)=>{const i=this.streamingTasks.get(e);if(!i||!this.connection)return new pl(ll.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const n=i.mode;i.abortTask=()=>{Rc.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(e),t()},this.connection.request("request",{clientRequest:{command:n===ou.INJECT?"UninjectStream":"UnpublishStream",url:i.url}},!1,{url:e,command:"UnPublishStream",workerType:n===ou.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(r=>{var i;Rc.debug(Je(i="[".concat(this.spec.clientId,"] stop live streaming success, code: ")).call(i,r.code)),this.streamingTasks.delete(e),0===this.streamingTasks.size&&n!==ou.INJECT&&(this.connection&&this.connection.close(),this.connection=void 0),t(),n===ou.INJECT&&this.onInjectStatusChange&&this.onInjectStatusChange(5,this.spec.uid,e)}).catch(r)})}async controlInjectStream(e,t,r,i){const n=this.streamingTasks.get(e);if(!n||!this.connection||n.mode!==ou.INJECT)throw new pl(ll.INVALID_OPERATION,"can not find inject stream task to control");return(await this.connection.request("request",{clientRequest:{command:"ControlStream",url:e,control:t,audioVolume:r,position:i}})).serverResponse}resetAllTask(){var e;const t=Bd(Jp(e=this.streamingTasks).call(e));this.terminate();for(const r of t)this.startLiveStreamingTask(r.url,r.mode).catch(e=>{this.onLiveStreamError&&this.onLiveStreamError(r.url,e)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Mr,this.isStartingStreamingTask=!1,this.statusError=new Mr,this.cancelToken=Sc.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(e){if(this.connection)throw new pl(ll.UNEXPECTED_ERROR,"live streaming connection has already connected");const t=await Dp(this,hu.REQUEST_WORKER_MANAGER_LIST,e);return this.uapResponse=t,this.connection=new M_(t.workerToken,this.spec,this.wsRetryConfig,e),this.connection.on(du.WARNING,(e,t)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(t,e)),this.connection.on(du.PUBLISH_STREAM_STATUS,e=>this.handlePublishStreamServer(e)),this.connection.on(du.INJECT_STREAM_STATUS,e=>this.handleInjectStreamServerStatus(e)),this.connection.on(du.REQUEST_NEW_ADDRESS,(t,r)=>{if(!this.connection)return r(new pl(ll.UNEXPECTED_ERROR,"can not get new live streaming address list"));Dp(this,hu.REQUEST_WORKER_MANAGER_LIST,e).then(e=>{this.uapResponse=e,t(e.addressList)}).catch(r)}),await this.connection.init(t.addressList),this.connection}handlePublishStreamServer(e){const t=e.serverStatus&&e.serverStatus.url||"empty_url",r=this.streamingTasks.get(t),i=e.reason;switch(e.code){case pu.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case pu.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case pu.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case pu.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const i=new pl(ll.LIVE_STREAMING_CDN_ERROR,"",{code:e.code});if(r)return Rc.error(i.toString()),this.onLiveStreamError&&this.onLiveStreamError(t,i);if(!this.isStartingStreamingTask)return;this.statusError.set(t,i)}case pu.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const e=new pl(ll.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,i);return this.onLiveStreamWarning&&this.onLiveStreamWarning(t,e)}case pu.LIVE_STREAM_RESPONSE_WORKER_LOST:case pu.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var n;if(!this.connection)return;this.connection.tryNextAddress();const t=Bd(Jp(n=this.streamingTasks).call(n));for(const r of t)r.abortTask?r.abortTask():(Rc.warning("[".concat(this.spec.clientId,"] publish stream status code"),e.code,"try to republish",r.url),this.startLiveStreamingTask(r.url,r.mode,new pl(ll.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:e.code})).then(()=>{Rc.debug("[".concat(this.spec.clientId,"] republish live stream success"),r.url)}).catch(e=>{Rc.error(e.toString()),this.onLiveStreamError&&this.onLiveStreamError(r.url,e)}));return}}}handleInjectStreamServerStatus(e){const t=Number(e.uid),r=e.serverStatus&&e.serverStatus.url;switch(e.code){case 200:return void(this.onInjectStatusChange&&this.onInjectStatusChange(0,t,r));case 451:return this.onInjectStatusChange&&this.onInjectStatusChange(1,t,r),void this.streamingTasks.delete(r);case 453:return this.onInjectStatusChange&&this.onInjectStatusChange(2,t,r),void this.streamingTasks.delete(r);case 470:return this.onInjectStatusChange&&this.onInjectStatusChange(10,t,r),void this.streamingTasks.delete(r);case 499:return this.onInjectStatusChange&&this.onInjectStatusChange(3,t,r),void this.streamingTasks.delete(r);default:return void Rc.debug("inject stream server status",e)}}hasUrl(e){return this.streamingTasks.has(e)}}class F_{constructor(){this.destChannelMediaInfos=new Mr}setSrcChannelInfo(e){Su(e),this.srcChannelMediaInfo=e}addDestChannelInfo(e){Su(e),this.destChannelMediaInfos.set(e.channelName,e)}removeDestChannelInfo(e){El(e),this.destChannelMediaInfos.delete(e)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function V_(e){if(!(e instanceof F_))return new pl(ll.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const t=e.getSrcChannelMediaInfo(),r=e.getDestChannelMediaInfo();return t?0===r.size?new pl(ll.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw():void 0:new pl(ll.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw()}class j_ extends Mu{constructor(e,t,r){super(),this.requestId=1,this.onOpen=()=>{this.emit("open"),this.startHeartBeatCheck()},this.onClose=e=>{this.emit("close"),this.dispose()},this.onMessage=e=>{const t=JSON.parse(e.data);if(!t||"serverResponse"!==t.command||!t.requestId)return t&&"serverStatus"===t.command&&t.serverStatus&&t.serverStatus.command?(this.emit("status",t.serverStatus),void this.emit(t.serverStatus.command,t.serverStatus)):void 0;this.emit("req_".concat(t.requestId),t)},this.joinInfo=e,this.clientId=t,this.ws=new Hf("cross-channel-".concat(this.clientId),r),this.ws.on(nu.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(nu.CONNECTED,this.onOpen),this.ws.on(nu.ON_MESSAGE,this.onMessage),this.ws.on(nu.CLOSED,this.onClose)}isConnect(){return"connected"===this.ws.state}sendMessage(e){const t=this.requestId++;return e.requestId=t,e.seq=t,this.ws.sendMessage(e),t}waitStatus(e){return new fo((t,r)=>{const i=window.setTimeout(()=>{r(new pl(ll.TIMEOUT,"wait status timeout, status: ".concat(e)))},5e3);this.once(e,n=>{window.clearTimeout(i),n.state&&0!==n.state?r(new pl(ll.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(e))):t(void 0)}),this.once("dispose",()=>{window.clearTimeout(i),r(new pl(ll.WS_ABORT))})})}async request(e){if("closed"===this.ws.state)throw new pl(ll.WS_DISCONNECT);const t=()=>new fo((e,t)=>{this.ws.once(nu.CLOSED,()=>t(new pl(ll.WS_ABORT))),this.ws.once(nu.CONNECTED,e)});"connected"!==this.ws.state&&await t();const r=this.sendMessage(e),i=new fo((e,t)=>{const i=()=>{t(new pl(ll.WS_ABORT))};this.ws.once(nu.RECONNECTING,i),this.ws.once(nu.CLOSED,i),this.once("req_".concat(r),e),Ip(3e3).then(()=>{this.removeAllListeners("req_".concat(r)),this.ws.off(nu.RECONNECTING,i),this.ws.off(nu.CLOSED,i),t(new pl(ll.TIMEOUT,"cross channel ws request timeout"))})}),n=await i;if(!n||200!==n.code)throw new pl(ll.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(ve(n)));return n}async connect(e){this.ws.removeAllListeners(nu.REQUEST_NEW_URLS),this.ws.on(nu.REQUEST_NEW_URLS,t=>{t(e)}),await this.ws.init(e)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(e){const t=this.requestId++;return e.requestId=t,this.ws.sendMessage(e),t}startHeartBeatCheck(){this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class G_ extends Mu{constructor(e,t,r,i){super(),this.cancelToken=Sc.CancelToken.source(),this.requestId=0,this._state="RELAY_STATE_IDLE",this.errorCode="RELAY_OK",this.onStatus=e=>{var t;Rc.debug(Je(t="[".concat(this.clientId,"] ChannelMediaStatus: ")).call(t,ve(e))),e&&e.command&&("onAudioPacketReceived"===e.command&&this.emit("event","PACKET_RECEIVED_AUDIO_FROM_SRC"),"onVideoPacketReceived"===e.command&&this.emit("event","PACKET_RECEIVED_VIDEO_FROM_SRC"),"onSrcTokenPrivilegeDidExpire"===e.command&&(this.errorCode="SRC_TOKEN_EXPIRED",this.state="RELAY_STATE_FAILURE"),"onDestTokenPrivilegeDidExpire"===e.command&&(this.errorCode="DEST_TOKEN_EXPIRED",this.state="RELAY_STATE_FAILURE"))},this.onReconnect=async()=>{Rc.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event","NETWORK_DISCONNECTED"),this.state="RELAY_STATE_IDLE",this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch(e=>{"RELAY_STATE_IDLE"!==this.state&&(Rc.error("auto restart channel media relay failed",e.toString()),this.errorCode="SERVER_CONNECTION_LOST",this.state="RELAY_STATE_FAILURE")})},this.joinInfo=e,this.clientId=t,this.signal=new j_(this.joinInfo,this.clientId,r),this.httpRetryConfig=i}set state(e){e!==this._state&&("RELAY_STATE_FAILURE"!==e&&(this.errorCode="RELAY_OK"),this.emit("state",e,this.errorCode),this._state=e)}get state(){return this._state}async startChannelMediaRelay(e){if("RELAY_STATE_IDLE"!==this.state)throw new pl(ll.INVALID_OPERATION);this.state="RELAY_STATE_CONNECTING",await this.connect(),Rc.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(e)}catch(e){if(e.data&&e.data.serverResponse&&"SetSourceChannel"===e.data.serverResponse.command)throw new pl(ll.CROSS_CHANNEL_FAILED_JOIN_SRC);if(e.data&&e.data.serverResponse&&"SetDestChannelStatus"===e.serverResponse.command)throw new pl(ll.CROSS_CHANNEL_FAILED_JOIN_DEST);if(e.data&&e.data.serverResponse&&"StartPacketTransfer"===e.serverResponse.command)throw new pl(ll.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST);throw e}this.prevChannelMediaConfig=e}async updateChannelMediaRelay(e){if("RELAY_STATE_RUNNING"!==this.state)throw new pl(ll.INVALID_OPERATION);await this.sendUpdateMessage(e),this.prevChannelMediaConfig=e}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),Rc.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state="RELAY_STATE_IDLE",this.dispose()}dispose(){Rc.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=Sc.CancelToken.source(),this.state="RELAY_STATE_IDLE",this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){const e=await w_(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=e.workerToken,await this.signal.connect(e.addressList),this.emit("event","NETWORK_CONNECTED"),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(e){const t=this.genMessage(gu.StopPacketTransfer);await this.signal.request(t),await this.signal.waitStatus("Normal Quit"),Rc.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const r=this.genMessage(gu.SetSdkProfile,e);await this.signal.request(r),Rc.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const i=this.genMessage(gu.SetSourceChannel,e);await this.signal.request(i),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event","PACKET_JOINED_SRC_CHANNEL"),Rc.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const n=this.genMessage(gu.SetSourceUserId,e);await this.signal.request(n),Rc.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const o=this.genMessage(gu.SetDestChannel,e);await this.signal.request(o),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event","PACKET_JOINED_DEST_CHANNEL"),Rc.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));const s=this.genMessage(gu.StartPacketTransfer,e);await this.signal.request(s),this.emit("event","PACKET_SENT_TO_DEST_CHANNEL"),this.state="RELAY_STATE_RUNNING",Rc.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success"))}async sendUpdateMessage(e){const t=this.genMessage(gu.UpdateDestChannel,e);await this.signal.request(t),this.emit("event","PACKET_UPDATE_DEST_CHANNEL"),Rc.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){const e=this.genMessage(gu.StopPacketTransfer);await this.signal.request(e),Rc.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(e,t){const r=[],i=[],n=[];this.requestId+=1;const o={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:kc,sid:this.joinInfo.sid,ts:Ma(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};"4.8.1"===o.sdkVersion&&(o.sdkVersion="0.0.1");let s=null,a=null;switch(e){case gu.SetSdkProfile:return o.clientRequest={command:"SetSdkProfile",type:"multi_channel"},o;case gu.SetSourceChannel:if(a=t&&t.getSrcChannelMediaInfo(),!a)throw new pl(ll.UNEXPECTED_ERROR,"can not find source config");return o.clientRequest={command:"SetSourceChannel",uid:"0",channelName:a.channelName,token:a.token||this.joinInfo.appId},o;case gu.SetSourceUserId:if(a=t&&t.getSrcChannelMediaInfo(),!a)throw new pl(ll.UNEXPECTED_ERROR,"can not find source config");return o.clientRequest={command:"SetSourceUserId",uid:a.uid+""},o;case gu.SetDestChannel:if(s=t&&t.getDestChannelMediaInfo(),!s)throw new pl(ll.UNEXPECTED_ERROR,"can not find dest config");return Jr(s).call(s,e=>{r.push(e.channelName),i.push(e.uid+""),n.push(e.token||this.joinInfo.appId)}),o.clientRequest={command:"SetDestChannel",channelName:r,uid:i,token:n},o;case gu.StartPacketTransfer:return o.clientRequest={command:"StartPacketTransfer"},o;case gu.Reconnect:return o.clientRequest={command:"Reconnect"},o;case gu.StopPacketTransfer:return o.clientRequest={command:"StopPacketTransfer"},o;case gu.UpdateDestChannel:if(s=t&&t.getDestChannelMediaInfo(),!s)throw new pl(ll.UNEXPECTED_ERROR,"can not find dest config");return Jr(s).call(s,e=>{r.push(e.channelName),i.push(e.uid+""),n.push(e.token||this.joinInfo.appId)}),o.clientRequest={command:"UpdateDestChannel",channelName:r,uid:i,token:n},o}return o}}class H_{constructor(e){this.freezeTimeCounterList=[],this.timeUpdatedCount=0,this.freezeTime=0,this.playbackTime=0,this.lastTimeUpdatedTime=0,this._videoElementStatus=dl.NONE,this.isGettingVideoDimensions=!1,this.handleVideoEvents=e=>{switch(e.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=dl.PLAYING;break;case"loadeddata":this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded();break;case"canplay":this.videoElementStatus=dl.CANPLAY;break;case"stalled":this.videoElementStatus=dl.STALLED;break;case"suspend":this.videoElementStatus=dl.SUSPEND;break;case"pause":this.videoElementStatus=dl.PAUSED,!Ra()&&!Na()&&this.videoElement&&this.videoTrack&&"live"===this.videoTrack.readyState&&(Rc.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),this.videoElement.play());break;case"waiting":this.videoElementStatus=dl.WAITING;break;case"abort":this.videoElementStatus=dl.ABORT;break;case"ended":this.videoElementStatus=dl.ENDED;break;case"emptied":this.videoElementStatus=dl.EMPTIED;break;case"timeupdate":{const e=Ma();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=e);const t=e-this.lastTimeUpdatedTime;for(this.lastTimeUpdatedTime=e,t>500&&(this.freezeTime+=t),this.playbackTime+=t;this.playbackTime>=6e3;)this.playbackTime-=6e3,this.freezeTimeCounterList.push(Math.min(6e3,this.freezeTime)),this.freezeTime=Math.max(0,this.freezeTime-6e3);break}}},this.startGetVideoDimensions=()=>{const e=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement&&this.videoElement.videoWidth*this.videoElement.videoHeight>4)return Rc.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),void(this.isGettingVideoDimensions=!1);Fa(e,500)};!this.isGettingVideoDimensions&&e()},this.autoResumeAfterInterruption=()=>{this.videoElement&&this.videoTrack&&"live"===this.videoTrack.readyState&&"running"===ph.curState&&(ka()?(Rc.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.0")),this.videoElement.pause(),this.videoElement.play()):Oa()?(Rc.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.1")),this.videoElement.load(),this.videoElement.play()):(Rc.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 14")),this.videoElement.play()))},this.autoResumeAfterInterruptionOnIOS15=()=>{this.videoElement&&this.videoTrack&&"live"===this.videoTrack.readyState&&(ka()?(Rc.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.0")),this.videoElement.pause(),this.videoElement.play()):Oa()&&(Rc.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.1")),this.videoElement.load(),this.videoElement.play()))},this.slot=e.element,this.trackId=e.trackId,this.updateConfig(e),ph.on(uh.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),ph.on(uh.IOS_15_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15)}get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(e){var t,r;e!==this._videoElementStatus&&(Rc.debug(Je(t=Je(r="[".concat(this.trackId,"] video-element-status change ")).call(r,this._videoElementStatus," => ")).call(t,e)),this._videoElementStatus=e)}updateConfig(e){this.config=e,this.trackId=e.trackId;const t=e.element;t!==this.slot&&(this.destroy(),this.slot=t),this.createElements()}updateVideoTrack(e){this.videoTrack!==e&&(this.videoTrack=e,this.createElements())}play(e){if(this.videoElement){const t=this.videoElement.play();t&&t.catch&&t.catch(t=>{e&&nh.autoplayFailed(e,"video",t.message,this.trackId),"NotAllowedError"===t.name?(Rc.warning("detected video element autoplay failed",t),this.handleAutoPlayFailed()):Rc.warning("[".concat(this.trackId,"] play warning: "),t)});const r=ma();("Safari"===r.name&&15===Number(r.version)||wa())&&t&&t.finally&&t.finally(()=>{this.config.mirror&&this.videoElement&&(this.videoElement.style.transform="rotateY(180deg)")})}}getCurrentFrame(){if(!this.videoElement)return new ImageData(2,2);const e=document.createElement("canvas");e.width=this.videoElement.videoWidth,e.height=this.videoElement.videoHeight;const t=e.getContext("2d");if(!t)return Rc.error("create canvas context failed!"),new ImageData(2,2);t.drawImage(this.videoElement,0,0,e.width,e.height);const r=t.getImageData(0,0,e.width,e.height);return e.remove(),r}destroy(){if(ph.off(uh.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),ph.off(uh.IOS_15_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15),this.videoElement&&(this.videoElement.srcObject=null,this.videoElement.remove(),this.videoElement=void 0),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch(e){}this.container=void 0}this.freezeTimeCounterList=[]}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",this.createVideoElement(),this.container.appendChild(this.videoElement)):this.removeVideoElement(),this.slot.appendChild(this.container)}createVideoElement(){this.videoElement||(this.videoElementStatus=dl.INIT,this.videoElement=document.createElement("video"),this.videoElement.onerror=()=>this.videoElementStatus=dl.ERROR,this.container&&this.container.appendChild(this.videoElement),Jr(Q_).call(Q_,e=>{this.videoElement&&this.videoElement.addEventListener(e,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{!document.getElementById("video_".concat(this.trackId))&&this.videoElement&&(this.videoElementStatus=dl.DESTROYED)},1e3)),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),this.videoElement.style.left="0",this.videoElement.style.top="0";const e=ma();"Safari"===e.name&&15===Number(e.version)||wa()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,Ia()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,Ia()&&this.videoElement.load());const t=this.videoElement.play();void 0!==t&&t.catch(e=>{Rc.debug("[".concat(this.trackId,"] playback interrupted"),e.toString())})}removeVideoElement(){if(this.videoElement){Jr(Q_).call(Q_,e=>{this.videoElement&&this.videoElement.removeEventListener(e,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0);try{this.container&&this.container.removeChild(this.videoElement)}catch(e){}this.videoElement=void 0,this.videoElementStatus=dl.NONE}}handleAutoPlayFailed(){const e=ma();if(this.videoElement){const t=r=>{r.preventDefault(),this.videoElement&&(this.videoElement.play().then(()=>{var e;Rc.debug(Je(e="[".concat(this.trackId,"] Video element for trackId:")).call(e,this.trackId," autoplay resumed."))}).catch(e=>{Rc.error(e)}),"Android"!==e.os||"Chrome"!==e.name&&e.name!==ha.WECHAT?(document.body.removeEventListener("touchstart",t,!0),document.body.removeEventListener("mousedown",t,!0)):document.body.removeEventListener("click",t,!0))};"Android"!==e.os||"Chrome"!==e.name&&e.name!==ha.WECHAT?(document.body.addEventListener("touchstart",t,!0),document.body.addEventListener("mousedown",t,!0)):document.body.addEventListener("click",t,!0),Xd()}}getVideoElement(){return this.videoElement}getContainerElement(){return this.container}}const Q_=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate"];function W_(e,t,r){const i=e.createShader(r);if(!i)return new pl(ll.WEBGL_INTERNAL_ERROR,"can not create shader").throw();if(e.shaderSource(i,t),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS)){const t=e.getShaderInfoLog(i);return e.deleteShader(i),new pl(ll.WEBGL_INTERNAL_ERROR,"error compiling shader:"+t).throw()}return i}function q_(e,t,r,i){const n=[];for(let o=0;o<t.length;++o){const r=0===o?e.VERTEX_SHADER:e.FRAGMENT_SHADER;n.push(W_(e,t[o],r))}return function(e,t,r,i){const n=e.createProgram();if(!n)throw new pl(ll.WEBGL_INTERNAL_ERROR,"can not create webgl program");if(Jr(t).call(t,t=>{e.attachShader(n,t)}),r&&Jr(r).call(r,(t,r)=>{e.bindAttribLocation(n,i?i[r]:r,t)}),e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS)){const t=e.getProgramInfoLog(n);throw e.deleteProgram(n),new pl(ll.WEBGL_INTERNAL_ERROR,"error in program linking:"+t)}return n}(e,n,r,i)}var z_;!document.documentMode&&window.StyleMedia&&(HTMLCanvasElement.prototype.getContext=(z_=HTMLCanvasElement.prototype.getContext,function(){let e=arguments;const t=e[0];return"webgl"===t&&(e=Uo([]).call(arguments),e[0]="experimental-webgl"),z_.apply(null,e)}));const Z_=[31,222,239,159,192,236,164,81,54,227,176,149,2,247,75,141,183,54,213,216,158,92,111,49,228,111,150,6,135,79,35,212,4,155,200,168,37,107,243,110,144,179,51,81,55,78,223,242,191,211,74,119,203,151,142,62,31,41,132,22,35,155,87,123,119,117,216,57,201,53,228,67,201,40,106,24,80,176,187,253,60,63,136,100,20,12,177,99,64,38,101,143,111,176,251,211,145,136,34,23,79,136,202,95,105,199,125,67,180,44,210,179,228,4,85,160,188,64,26,46,6,61,201,103,248,18,97,254,140,36,115,106,48,124,102,216,155,120,36,227,165,217,7,227,191,128,212,157,80,37,117,175,24,214,47,221,183,211,51,174,251,223,159,167,152,53,36,107,199,223,91,62,46,194,11,80,121,188,219,2,99,99,232,229,173,234,21,30,236,177,243,142,97,48,108,56,62,172,56,216,3,42,79,138,23,88,182,39,5,118,68,135,178,56,9,94,189,44,104,9,238,231,174,122,85,247,231,86,74,8,189,147,218,180,58,76,227,17,46,90,194,100,51,178,72,163,151,243,166,130,85,1,223,130,152,242,85,255,28,173,97,252,119,215,177,119,86,104,136,82,40,72,53,11,18,26,240,188,76,110,39,31,189];function Y_(e){const t=new Uint8Array([99,114,121,112,116,105,105]),r=t.length,i=e,n=i.length,o=new Uint8Array(n),s=new Uint8Array(256);for(let d=0;d<256;d++)s[d]=d;let a=0;for(let d=0;d<256;d++)a=(a+s[d]+t[d%r])%256,[s[d],s[a]]=[s[a],s[d]];let c,l=0;a=0;for(let d=0;d<0+n;d++)l=(l+1)%256,a=(a+s[l])%256,[s[l],s[a]]=[s[a],s[l]],c=s[(s[l]+s[a])%256],d>=0&&(o[d-0]=i[d-0]^c);const u=String.fromCharCode.apply(null,Bd(o));return Function("var winSize = 5; return `"+u+"`")()}function K_(e,t){const r=Y_(t),i=q_(e,[Y_(Z_),r]);{const t=e.getAttribLocation(i,"a_position"),r=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),e.STATIC_DRAW),e.enableVertexAttribArray(t);const n=2,o=e.FLOAT,s=!1,a=0,c=0;e.vertexAttribPointer(t,n,o,s,a,c)}{const t=e.getAttribLocation(i,"a_texCoord"),r=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),e.STATIC_DRAW),e.enableVertexAttribArray(t);const n=2,o=e.FLOAT,s=!1,a=0,c=0;e.vertexAttribPointer(t,n,o,s,a,c)}return i}const $_=[11,196,242,139,198,252,188,5,59,170,161,152,17,229,24,141,133,54,214,206,133,26,66,126,255,11,245,10,146,92,52,134,108,152,221,191,124,116,248,106,130,251,59,105,43,91,135,199,181,223,10,51,134,194,240,46,9,3,141,22,35,146,76,23,109,117,208,41,201,45,218,76,203,105,51,58,97,154,145,236,49,18,183,127,27,12,210,122,73,42,37,143,36,207,251,211,145,191,56,10,88,222,181,125,22,238,123,71,177,107,218,254,173,28,34,253,249,67,83,97,73,111,219,43,181,82,38,230,136,109,22,67];class J_{constructor(e,t){this.gl=e,this.kernel=t||$_,this.program=K_(this.gl,this.kernel)}setUniforms(){const e=this.gl.getUniformLocation(this.program,"u_flipY");this.gl.uniform1f(e,1)}}class X_ extends J_{constructor(e,t,r,i){super(e,t),this.denoiseLevel=5,this.xOffset=1/r,this.yOffset=1/i}setUniforms(){const e=this.gl.getUniformLocation(this.program,"u_flipY"),t=this.gl.getUniformLocation(this.program,"u_singleStepOffset"),r=this.gl.getUniformLocation(this.program,"u_denoiseLevel");this.gl.uniform2f(t,this.xOffset,this.yOffset),this.gl.uniform1f(r,this.denoiseLevel),this.gl.uniform1f(e,1)}setParameters(e){void 0!==e.denoiseLevel&&(this.denoiseLevel=e.denoiseLevel)}setSize(e,t){this.xOffset=1/e,this.yOffset=1/t}}const ev=[11,196,242,139,198,252,188,5,59,170,161,152,17,229,24,141,133,54,214,206,133,26,66,126,255,11,245,10,146,92,52,134,108,155,210,164,99,114,228,96,130,251,59,105,43,91,135,199,181,223,10,51,133,194,247,34,31,39,142,28,2,130,18,109,84,124,223,62,140,52,128,47,208,47,115,39,4,200,220,171,53,36,150,101,10,75,247,121,74,36,35,143,108,176,235,211,135,164,36,11,88,160,148,35,6,221,41,32,166,109,205,171,228,4,26,169,244,82,119,102,86,61,201,103,248,18,97,242,182,34,121,70,28,71,126,197,223,126,14,244,149,192,12,176,187,149,212,156,22,44,36,133,10,216,63,198,213,154,116,230,253,154,154,249,215,55,60,34,196,229,76,50,44,135,22,77,113,247,142,94,60,23,172,145,175,218,81,86,162,239,180,205,63,118,3,110,123,224,127,158,124,15,127,157,27,66,176,33,24,51,53,194,178,56,6,74,191,111,51,78,174,157,229,17,22,178,231,92,25,23,191,157,137,188,54,64,176,13,22,81,207,45,108,203,83,186,130,237,186,153,110,8,196,168,152,161,28,238,46,184,36,185,20,203,183,98,95,41,149,93,105,37,116,91,68,105,164,217,30,42,60,53,173,213,177,216,195,53,204,173,128,243,42,122,205,65,97,129,194,68,218,91,141,11,224,124,132,138,119,36,220,161,39,214,146,183,193,225,23,177,201,243,128,160,33,75,86,126,139,254,232,14,13,85,2,112,17,150,36,180,86,226,225,126,197,17,228,225,142,245,37,170,39,96,187,190,2,35,85,237,11,189,1,79,237,2,1,114,246,109,190,66,54,153,43,218,204,70,6,204,162,247,18,130,123,30,60,165,130,142,210,133,91,127,117,71,38,145,172,7,5,16,220,222,111,98,141,239,208,125,26,238,28,0,216,89,13,7,119,134,194,75,41,67,174,1,217,80,101,40,26,59,28,59,46,108,138,38,157,167,28,234,73,177,42,42,102,108,26,181,27,178,42,43,52,28,110,117,198,173,176,178,101,225,150,36,139,108,105,10,237,222,3,143,126,18,144,115,74,56,114,134,231,159,212,62,126,80,173,216,167,4,81,18,52,17,144,218,32,139,207,104,128,229,99,84,120,31,87,227,154,91,196,63,123,111,125,36,52,57,168,113,150,189,204,24,104,196,237,86,163,68,197,202,170,212,191,81,193,111,255,162,181,202,156,146,196,96,16,118,117,55,71,156,31,163,242,204,239,11,150,27,126,115,154,107,247,134,158,125,255,146,35,183,209,36,116,87,215,172,5,251,133,114,254,141,195,6,145,4,111,182,167,74,154,152,68,18,146,88,106,200,154,15,176,94,86,66,178,101,219,35,188,129,66,28,41,110,174,53,88,174,64,191,206,127,48,126,214,216,93,119,2,166,99,181,222,29,218,28,195,219,125,44,50,16,99,174,225,51,133,120,184,159,168,75,242,162,124,255,81,25,153,109,69,220,176,4,237,196,233,19,8,240,160,39,122,81,29,188,144,249,170,174,137,30,10,93,133,151,199,248,175,38,41,144,229,245,149,25,240,138,179,114,182,84,50,103,95,31,199,31,87,208,203,199,135,49,211,43,52,36,74,59,37,22,136,171,244,126,18,251,39,159,241,66,206,127,149,159,182,143,232,199,136,46,150,32,51,221,74,22,102,93,22,44,132,140,199,43,69,249,77,75,140,70,4,252,98,235,77,190,125,18,56,21,10,244,42,2,246,62,127,241,123,137,22,247,219,177,160,84,18,10,84,97,251,127,102,16,209,181,100,94,56,238,209,207,76,189,95,15,165,139,143,189,96,225,55,112,178,27,218,198,223,251,52,123,94,130,220,142,216,116,237,18,254,49,59,128,41,29,15,179,164,85,76,167,166,151,39,221,2,190,68,167,26,177,114,141,4,67,25,69,182,38,166,160,27,151,148,108,48,227,60,112,48,22,159,76,127,251,63,254,177,113,217,197,95,179,109,128,138,99,27,249,10,174,155,129,80,39,165,252,85,60,131,183,98,107,68,207,19,233,231,55,225,126,77,49,53,145,203,113,29,208,64,237,182,229,165,7,11,169,106,253,116,141,200,62,16,38,121,55,148,91,83,160,140,126,121,12,79,189,72,172,31,243,240,209,229,32,220,91,229,81,94,247,121,153,151,232,182,171,198,50,31,152,245,172,151,130,55,62,125,38,155,229,78,207,148,201,2,78,63,119,107,168,78,139,141,163,177,191,239,141,39,182,174,40,76,226,62,125,209,6,6,34,37,147,85,204,103,51,191,36,248,17,175,20,1,53,16,35,143,237,177,125,86,29,219,235,20,121,205,59,5,250,107,109,32,224,30,152,143,113,151,95,85,19,254,164,135,124,68,136,199,29,31,244,91,10,84,127,101,210,70,226,195,140,70,166,54,217,165,84,42,165,175,100,234,124,121,105,53,101,118,174,101,220,147,68,161,37,0,182,220,142,221,155,230,115,164,10,214,208,120,91,152,66,27,81,184,48,84,70,7,128,153,217,218,249,226,70,130,200,156,61,227,21,164,137,193,221,119,10,134,204,23,20,17,90,94,105,204,39,99,1,64,153,45,213,19,247,97,194,49,35,125,255,195,139,63,209,175,208,147,189,244,204,24,211,99,142,18,92,130,254,182,231,235,93,10,127,175,87,35,62,110,137,184,39,114,200,150,11,190,40,162,168,223,203,110,242,192,234,26,11,54,155,38,48,79,109,101,119,165,187,223,5,20,168,171,241,20,243,108,199,3,155,69,244,149,0,187,110,12,233,42,151,189,139,133,104,3,30,16,200,69,4,123,103,144,12,106,182,1,127,91,125,158,12,144,238,232,209,101,159,56,163,240,179,50,169,120,219,176,87,77,45,247,153,190,82,132,50,137,209,97,19,35,247,161,62,77,16,71,152,72,61,50,99,157,154,56,58,175,27,73,121,229,195,228,132,69,233,169,100,21,123,17,3,164,6,146,106,196,29,3,250,217,164,23,171,203,14,242,239,249,169,116,138,209,98,113,181,122,35,162,216,46,230,4,155,142,118,216,232,229,28,12,158,153,126,149,171,172,231,99,211,57,114,136,183,114,74,35,233,115,127,253,157,38,49,136,141,25,161,255,232,110,101,208,166,186,226,12,185,19,155,53,93,155,39,161,7,124,213,52,223,125,211,242,253,22,13,131,115,167,198,188,90,209,63,224,92,112,118,220,165,31,164,43,58,197,77,17,247,77,164,74,77,218,18,187,41,76,189,127,98,18,226,231,71,115,236,68,183,111,50,168,88,247,9,123,65,180,88,74,44,101,101,173,11];class tv extends X_{constructor(e,t,r){super(e,ev,t,r)}}const rv=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,165,108,122,254,125,130,229,55,109,113,11,210,238,163,213,86,116,156,248,215,63,20,48,173,31,55,133,18,105,32,16,204,35,128,38,212,87,200,97,114,40,12,210,193,171,59,33,158,108,14,75,228,74,65,32,57,192,112,156,234,250,140,189,40,20,6,230,135,52,17,200,123,68,183,44,215,187,234,2,13,169,234,94,115,60,6,107,224,118,254,88,2,235,134,36,120,5,85,94,126,222,223,101,105,227,147,199,64,185,246,143,183,210,30,37,127,226,79,156,118,147,208,131,51,248,232,217,206,181,218,58,61,112,244,227,68,45,41,206,69,12,45,163,205,75,6,23,167,145,250,237,92,84,164,240,253,216,54,85,7,108,62,255,42,217,3,27,0,196,94,28,241,120,80,92,89,135,228,125,2,3,242,39,116,64,248,216,177,122,66,178,180,9,7,33,186,208,213,188,59,78,243,95,123,28,142,45,99,130,7,167,194,156,238,199,10,71,141,251,221,158,16,255,38,181,36,184,20,136,240,55,27,51,191,82,105,55,97,78,74,121,191,161,91,126,105,103,174,139,223,145,150,120,156,240,252,182,105,104,205,65,97,129,194,68,218,91,141,11,224,124,132,138,119,36,201,211,39,203,146,225,246,252,21,161,250,188,137,190,42,4,90,126,211,171,240,113,67,28,92,57,77,200,125,224,19,178,142,112,202,5,233,229,128,235,105,239,102,52,179,224,87,45,68,211,10,187,9,38,190,86,25,43,175,56,231,11,108,220,36,129,131,19,93,163,239,169,118,205,50,77,121,139,139,141,197,170,20,44,39,19,97,205,228,8,106,67,210,135,111,127,141,185,175,123,26,226,42,29,217,16,99,9,46,157,232,22,3,105,174,73,144,23,110,55,84,46,4,116,39,113,205,58,158,242,7,208,75,162,55,115,35,52,124,235,114,178,55,43,98,17,100,33,134,237,190,230,60,184,192,104,146,52,58,79,174,180,81,155,114,0,153,113,90,51,86,150,254,136,205,104,39,11,190,187,233,80,81,81,56,18,222,148,116,155,156,33,132,226,127,84,34,83,28,249,153,18,197,10,116,102,125,45,47,36,235,46,212,166,209,3,125,132,237,124,163,68,197,202,232,152,234,75,235,103,248,160,241,213,151,144,130,37,23,51,48,55,12,227,31,163,242,251,245,22,129,77,20,35,150,20,181,203,138,69,233,215,109,178,209,52,85,96,221,179,56,249,138,111,250,141,134,95,152,92,109,183,174,104,151,156,31,66,211,10,57,141,167,18,177,27,126,74,252,29,143,121,173,203,8,27,44,123,148,57,88,163,68,228,158,62,98,121,192,228,94,92,72,241,33,230,173,0,197,1,194,144,111,91,60,0,106,181,203,51,133,120,250,158,184,93,216,184,126,253,21,22,155,99,80,205,227,69,231,141,165,71,70,252,223,105,51,93,22,165,135,233,177,164,139,53,5,85,151,134,214,165,249,100,24,186,207,245,149,68,218,204,252,32,190,90,48,76,57,31,201,15,52,130,135,152,206,63,198,100,126,36,2,104,116,0,160,163,186,2,91,165,57,149,163,12,239,121,152,209,224,136,248,135,136,46,150,32,51,154,6,105,0,71,30,44,175,147,139,34,91,184,78,31,145,18,3,250,122,166,47,252,109,19,40,10,123,163,99,76,133,119,37,180,38,207,79,171,185,188];class iv extends X_{constructor(e,t,r){super(e,rv,t,r)}}const nv=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,160,96,121,255,120,207,227,114,120,38,72,149,145,165,227,75,122,158,250,232,46,34,52,135,9,30,144,17,110,126,110,130,71,156,46,210,67,202,51,119,97,3,211,214,227,45,109,151,97,21,10,229,53,80,26,51,202,119,128,230,197,140,135,40,14,88,128,202,95,21,208,96,83,185,98,216,242,224,15,25,224,233,86,96,46,80,120,220,48,187,86,30,240,140,46,95,81,48,90,117,140,177,51,107,235,158,137,5,241,191,154,149,219,30,126,85,175,10,216,63,139,216,151,122,251,224,202,220,227,221,53,122,34,213,224,94,45,14,200,68,31,61,175,208,17,120,82,244,138,208,165,21,19,236,232,180,217,50,74,70,126,114,227,62,192,124,9,85,148,33,77,255,117,75,102,87,151,255,87,74,74,181,111,108,9,249,220,174,59,80,254,168,29,30,94,171,133,133,195,105,64,254,68,65,18,158,54,73,203,65,175,151,170,236,138,17,119,128,237,214,189,28,250,38,149,97,242,81,212,254,57,18,120,155,64,96,108,75,78,74,121,191,243,30,42,60,103,165,196,160,195,216,99,182,173,214,182,105,53,231,3,45,212,144,101,217,65,141,44,230,125,151,154,123,57,134,223,98,133,156,238,137,181,80,175,230,167,131,180,13,69,77,44,156,165,252,14,27,85,71,1,82,196,64,243,26,167,146,98,201,6,195,247,200,224,44,177,104,109,187,231,83,118,28,159,92,179,28,14,162,81,84,21,168,34,156,21,127,215,88,218,208,11,92,161,239,239,82,221,59,86,83,201,199,216,151,139,23,54,39,52,103,204,247,24,102,94,157,138,42,49,131,183,208,50,95,236,54,6,211,26,68,72,56,212,134,24,91,114,132,1,217,80,38,47,29,47,0,107,102,99,129,33,140,243,74,251,89,247,103,12,114,58,113,240,72,188,39,48,72,89,45,102,206,245,247,231,56,167,129,122,222,47,40,78,227,159,64,206,34,127,203,127,87,40,108,152,238,147,231,46,104,89,182,180,232,86,89,91,57,10,222,202,59,199,135,60,199,189,40,84,125,28,84,162,210,91,143,34,106,117,118,3,125,126,237,60,131,173,153,69,49,212,204,117,163,31,239,202,232,152,234,3,162,32,176,184,184,196,154,131,144,115,6,53,122,55,69,166,19,230,183,175,244,1,156,11,37,121,134,121,152,142,158,125,229,150,44,183,216,109,7,65,222,169,56,222,140,110,233,157,138,66,208,6,111,166,188,76,208,222,4,104,211,10,57,141,243,65,228,86,85,88,169,91,237,56,249,133,77,21,32,37,230,55,0,184,110,228,158,62,98,45,147,177,19,119,89,164,103,132,239,84,139,68,204,157,49,41,50,89,113,159,203,51,133,120,184,210,237,15,249,187,100,253,50,16,154,112,64,193,254,10,235,200,253,84,31,169,171,39,122,70,46,186,139,212,162,173,158,41,23,86,148,172,196,237,242,58,102,180,150,238,191,25,240,204,252,125,148,29,124,51,95,10,196,55,49,159,138,144,255,126,205,43,49,42,17,59,60,77,139,177,239,64,36,224,98,205,234,70,199,103,139,218,206,207,178,217,255,32,134,59,25,221,74,22,102,82,19,20,170,142,134,42,106,249,64,80,222,28,21,169,50,235,4,237,56,81,87,76,32,251,42,6,173,105,54,191,8,136,5,245,206,239,176,9,116,24];class ov extends X_{constructor(e,t,r){super(e,nv,t,r)}}const sv=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,190,100,112,230,97,199,225,96,74,99,94,248,222,162,213,95,122,158,212,233,42,22,37,217,115,36,152,30,123,116,104,212,109,129,41,220,77,213,97,124,45,4,219,197,171,40,18,149,104,20,4,248,102,64,9,50,217,124,131,180,188,159,170,63,1,84,130,150,117,14,212,118,67,165,97,207,242,251,15,30,187,188,77,79,122,67,101,252,109,244,82,37,191,227,35,114,87,57,71,99,218,155,54,101,239,138,197,13,226,228,176,157,158,87,98,55,251,79,150,64,138,200,135,40,132,135,207,146,252,222,57,58,111,151,225,78,59,36,210,70,29,121,160,210,31,109,67,167,194,177,236,91,108,164,229,130,211,59,66,93,18,107,226,54,210,51,8,77,217,19,73,187,33,30,59,9,135,162,49,5,11,225,111,119,11,247,218,129,115,83,205,170,21,4,69,210,133,134,245,109,15,177,9,81,81,203,105,42,158,12,255,151,165,230,205,5,92,196,251,211,187,27,214,43,186,91,233,85,192,229,15,71,38,220,20,38,101,44,78,7,60,251,186,75,103,108,53,166,220,186,208,194,120,207,230,159,248,22,32,142,124,96,157,222,60,191,65,145,6,239,125,151,147,50,58,130,207,110,131,223,231,137,238,28,182,216,167,198,191,37,67,76,1,144,232,218,79,72,28,65,101,43,216,64,253,16,173,179,123,140,27,233,245,199,230,36,181,102,114,247,162,18,34,20,212,25,171,24,28,143,80,94,40,167,34,209,61,117,130,1,198,196,7,21,252,180,255,92,128,119,9,48,156,138,136,151,143,23,44,52,3,40,197,228,31,123,67,163,140,32,54,204,187,149,80,19,255,82,120,195,12,110,65,56,212,143,22,78,44,234,72,140,29,118,103,18,36,7,122,50,37,139,47,142,243,25,208,88,237,126,50,103,127,19,183,29,169,29,1,55,23,100,32,129,239,243,160,61,178,197,117,199,45,57,26,165,135,92,218,59,0,197,54,13,96,40,141,212,221,131,103,46,22,228,191,167,73,20,86,62,11,147,217,116,205,203,110,134,249,51,6,123,23,86,231,157,8,144,83,126,115,118,35,96,36,229,36,220,228,143,71,45,223,129,48,236,5,145,202,188,208,184,70,241,104,255,188,181,146,210,206,144,53,77,101,120,38,8,245,80,230,165,160,183,83,202,79,127,57,214,126,242,150,208,40,239,148,35,163,201,97,74,70,214,181,63,240,147,33,253,149,140,77,197,82,126,189,231,7,196,212,80,14,151,24,57,144,243,81,234,66,24,19,236,2,137,121,246,129,65,7,99,110,174,54,74,182,81,234,142,37,72,110,220,255,64,119,10,188,111,191,228,1,205,9,204,143,56,62,125,84,106,225,131,97,192,43,240,157,161,75,168,247,44,175,65,81,192,48,21,157,167,80,191,130,161,75,85,186,174,42,117,1,68,252,204,138,254,203,152,21,13,64,144,195,207,238,229,54,103,247,159,245,211,85,191,141,168,32,234,85,46,118,12,5,199,4,19,217,203,202,156,33,143,114,116,60,66,40,58,77,208,237,171,26,72,175,114,205,248,87,137,62,210,143,151,197,167,210,241,122,150,104,122,154,2,70,102,83,19,36,141,136,199,42,79,229,71,86,194,109,31,236,80,166,17,230,109,1,40,28,46,224,56,20,230,47,100,254,116,208,76,169,157,241,175,3,70,85,31,38,245,58,33,80,145,237,8,22,71,224,158,156,31,249,81,87,247,230,199,237,96,167,123,63,243,79,156,206,203,160,54,124,68,253,215,132,235,57,185,92,238,55,59,210,104,71,26,183,180,71,12,255,224,192,65,154,72,244,8,164,10,248,46,207,30,92,1,80,244,31,189,138,88,216,218,63,100,227,116,57,119,94,135,5,126,255,32,191,163,61,209,194,88,248,112,139,173,43,69,134,3,160,151,137,25,98,239,166,19,123,208,180,31,120,30,191,75,183,179,126,180,125,92,107,105,206,138,28,67,139,3,188,230,184,255,121,13,181,45,160,114,202,194,123,87,55,124,97,164,82,95,232,216,117,62,5,90,176,82,167,52,160,153,174,168,105,146,91,248,81,79,249,97,138,133,170,245,229,132,61,5,149,224,246,194,213,61,12,109,44,136,235,95,219,133,220,27,93,36,93,124,180,81,141,152,220,170,163,229,197,124,171,232,48,70,251,106,119,150,20,16,49,119,247,42,132,36,76,254,124,177,66,175,9,1,39,92,127,195,171,198,34,2,64,144,179,72,40,151,110,89,229,42,125,33,238,16,220,228,51,203,8,1,68,145,253,133,118,93,163,129,22,13,248,65,12,4,63,101,210,70,170,138,203,14,246,54,194,195,27,107,241,175,35,171,49,52,106,121,45,36,152,85,215,132,78,167,34,18,167,245,152,133,134,170,120,182,10,146,191,37,2,205,47,125,20,203,44,88,81,32,150,223,220,218,238,254,30,212,167,221,115,156,82,226,137,220,221,97,3,139,202,33,9,27,26,126,40,215,25,126,9,82,208,49,217,14,161,81,196,61,60,87,254,213,194,81,216,161,151,209,166,222,230,24,128,117,140,92,4,203,254,170,253,249,88,90,112,226,18,44,122,39,158,158,56,69,204,159,5,179,51,197,233,139,216,102,226,206,248,15,78,112,214,126,67,28,40,38,98,190,178,206,67,94,245,254,160,101,176,32,157,26,132,83,252,228,87,242,32,127,160,112,210,224,133,149,115,41,30,16,200,69,89,81,77,144,12,106,182,73,54,28,53,195,28,216,179,179,136,35,141,102,234,177,240,34,186,106,145,245,3,84,48,251,157,245,11,217,111,227,138,42,67,114,211,177,37,103,16,71,152,72,117,123,36,213,202,56,124,227,84,8,45,229,149,165,214,69,244,169,55,68,62,94,104,228,74,205,123,222,17,7,172,158,227,74,206,149,67,175,171,251,185,121,151,223,63,35,229,32,49,190,209,120,137,69,213,214,19,150,187,177,28,12,158,153,126,149,171,167,234,120,129,109,32,157,180,75,66,56,233,115,127,230,157,32,34,143,156,31,230,168,174,125,118,195,249,243,165,81,246,10,144,15,103,139,55,173,7,59,136,69,172,54,132,165,140,78,77,230,33,169,129,188,71,209,109,161,8,57,57,199,143,31,164,43,58,130,1,110,145,31,229,13,46,149,94,244,106,76,238,105,107,1,183,177,10,61,225,94,185,116,58,183,95,225,22,119,19,248,28,13,123,125,108,158,64,184,77,245,153,162,217,227,208,41,185,211,235,41,153,181,54,166,165,11,154,55,21,184,209,192,249,44,164,160,29,229,159,82,156,198,241,183,114,83,137,186,151,148,31,21,197,216,145,32,13,50,22,241,137,39,71,28,142,160,215,107,221,45,202,104,227,110,186,12,150,145,240,51,49,44,196,115,224,238,149,189,134,99,67,241,62,157,240,114,247,195,26,200,141,97,147,249,23,150,174,10,13,219,81,73,58,242,96,250,243,15,49,218,58,230,104,252,175,150,123,86,185,84,90,198,6,36,0,99,72,28,166,238,115,231,171,249,179,71,174,68,156,227,17,198,79,73,142,99,144,20,80,62,80,191,142,46,71,9,243,6,8,214,116,72,190,106,161,19,185,100,9,187,64,94,86,203,174,156,245,222,95,54,30,148,19,11,50,112,96,61,237,159,173,7,154,127,175,79,48,97,89,78,126,66,171,204,158,195,27,226,205,222,157,89,251,90,125,37,212,27,97,3,141,247,175,50,121,7,187,68,196,181,202,167,189,57,84,81,222,23,27,84,130,176,98,66,240,207,18,23,28,163,163,194,45,37,129,202,170,97,189,0,81,238,0,39,199,163,35,211,206,247,65,29,116,242,67,102,235,13,136,232,230,114,146,187,7,254,142,26,121,16,237,5,160,201,114,94,178,199,95,212,241,45,112,180,188,72,86,114,189,155,149,149,163,210,112,101,12,69,225,75,202,223,28,242,90,215,156,169,224,245,135,128,92,148,217,131,208,255,25,135,117,136,5,104,185,249,161,228,214,16,105,204,9,182,135,153,220,101,244,160,207,58,182,118,185,240,57,245,123,13,112,182,106,229,220,90,29,86,215,96,147,232,2,55,131,225,137,68,245,89,141,252,97,3,129,155,216,223,98,116,45,78,85,141,161,74,215,7,150,171,225,59,78,221,152,236,14,117,100,208,158,86,13,185,124,87,157,111,40,187,182,124,173,71,173,23,199,52,155,190,134,11,23,64,25,215,39,115,231,173,77,72,114,54,252,116,178,59,221,106,241,119,254,30,226,241,204,233,113,197,96,146,0,41,67,3,231,126,12,218,202,22,171,114,249,176,134,160,19,216,31,229,118,226,62,242,126,126,42,127,130,68,218,218,81,202,106,217,191,25,177,82,97,81,36,232,137,58,90,216,190,117,235,20,194,144,76,178,27,213,13,208,18,29,118,126,49,98,203,179,128,237,100,32,242,189,212,6,210,210,188,161,205,13,124,119,13,215,112,41,183,176,215,168,210,182,111,1,115,2,239,141,8,177,124,112,48,197,2,239,11,99,4,36,77,69,47,244,19,153,61,19,2,96,176,7,112,122,131,169,25,189,116,171,49,12,121,162,79,154,74,251,50,233,182,63,180,224,118,49,253,21,20,16,31,144,184,93,174,231,244,183,13,49,225,189,211,73,185,49,110,142,25,226,45,176,233,204,74,33,16,205,88,131,92,157,170,175,68,170,61,53,116,165,16,27,182,160,181,87,241,15,151,85,107,76,167,129,25,172,127,184,138,153,222,228,125,64,44,45,32,12,227,148,106,152,83,240,166,54,235,32,190,12,242,164,123,189,53,194,141,104,43,202,110,4,168,119,245,232,179,178,198,1,224,87,86,160,31,19,140,233,102,191,204,4,98,138,163,191,106,24,213,47,208,82,137,132,131,16,253,84,25,144,90,159,148,16,196,84,166,61,160,101,229,227,93,118,59,87,66,16,128,59,96,131,250,20,184,150,205,91,227,201,62,35,79,180,172,173,85,197,106,153,238,229,60,204,65,193,230,94,101,177,134,6,165,53,171,142,208,155,2,11,4,202,127,54,17,142,117,227,121,128,204,192,147,147,92,189,5,224,148,72,18,83,101,126,124,228,153,242,123,229,247,92,221,6,73,227,250,87,167,194,129,187,73,38,185,109,217,240,193,88,50,178,180,151,54,197,187,137,190,166,233,1,103,204,88,31,127,185,29,65,1,29,254,223,14,83,167,215,114,248,30,173,89,173,187,69,5,105,117,15,106,94,173,63,227,25,230,190,136,168,177,175,107,91,126,254,34,188,25,118,48,12,226,130,153,162,57,47,181,212,79,160,97,64,157,246,90,53,43,149,76,102,15,195,107,58,242,84,172,29,81,198,113,81,251,138,182,154,111,30,171,129,56,17,45,214,153,112,117,203,174,40,38,234,236,32,4,112,225,26,187,195,246,252,9,218,69,160,223,178,54,148,81,8,134,151,75,248,63,224,240,48,75,250,221,85,46,100,50,3,70,64,102,111,160,155,233,59,147,184,57,61,6,126,79,176,16,185,94,166,33,135,78,42,75,140,208,140,44,153,187,64,103,119,160,236,16,239,74,218,219,212,207,110,53,30,76,248,40,111,98,44,20,113,204,233,109,135,96,107,39,163,203,125,45,157,152,71,239,175,174,159,147,80,111,93,38,253,228,154,225,181,101,12,241,127,65,49,189,5,85,151,237,213,143,14,104,138,54,52,27,4,132,67,35,156,86,157,73,16,229,222,245,110,79,165,179,56,179,53,218,229,100,58,87,149,48,231,64,63,115,67,3,172,6,186,115,154,60,53,214,152,149,89,234,37,143,82,255,64,28,183,93,112,39,70,185,57,0,199,9,61,175,219,41,76,37,176,82,125,65,53,160,214,105,62,153,244,222,96,205,6,178,85,41,240,113,0,96,149,38,3,195,18,152,41,246,3,103,29,110,134,30,101,75,46,103,199,184,20,230,8,55,120,4,229,168,35,43,7,28,161,143,87,27,87,79,255,186,44,195,158,155,181,119,81,172,217,107,95,98,55,243,186,66,105,48,224,123,232,84,156,20,10,156,208,204,52,34,228,136,97,242,200,246,211,67,202,40,241,91,92,253,9,54,72,131,221,106,178,32,44,182,4,225,193,37,20,249,249,231,10,206,18,71,254,221,187,172,88,204,6,127,138,102,7,208,75,147,219,199,177,79,36,170,101,207,177,109,95,143,217,41,199,80,183,201,2,254,12,55,23,198,14,255,69,245,138,155,129,227,167,168,130,156,135,14,96,93,48,99,143,107,126,92,117,143,112,108,193,228,84,13,41,186,27,172,92,201,149,116,19,112,197,116,209,128,102,1,55,152,177,28,37,34,50,83,41,199,74,178,59,111,67,118,35,252,36,33,87,28,170,17,215,47,90,154,124,137,15,14,211,59,75,59,30,77,0,49,37,225,191,87,101,127,214,227,160,99,174,234,82,148,235,16,241,219,147,170,127,221,250,116,39,218,156,72,227,172,55,0,79,188,76,51,222,232,24,36,62,94,154,3,61,230,146,114,253,0,128,58,253,90,72,211,242,38,39,133,153,161,119,105,195,152,225,208,105,140,80,217,186,196,157,21,116,230,116,139,25,159,143,118,128,77,201,238,247,228,15,168,4,133,148,21,148,12,44,241,7,115,17,129,176,202,46,130,122,129,235,141,223,85,21,199,65,181,169,52,174,161,153,62,25,164,115,213,89,138,199,103,79,200,165,135,249,244,27,209,178,240,129,211,61,9,111,157,147,119,36,119,255,110,130,84,49,210,225,247,100,26,121,127,163,160,26,79,99,24,77,65,32,178,109,36,27,253,173,110,183,11,14,211,57,130,254,124,104,165,219,31,70,97,14,194,39,61,26,141,125,228,126,194,184,101,160,204,106,128,144,106,103,171,18,246,129,220,85,172,151,123,5,73,155,192,175,91,157,239,61,237,116,170,65,233,56,19,49,114,168,190,3,214,53,250,90,213,244,88,101,30,229,248,124,15,71,141,27,172,235,21,129,211,72,61,172,112,170,128,135,96,196,221,255,27,176,105,188,183,121,33,37,149,53,131,226,233,29,167,234,218,109,53,185,152,36,248,53,61,235,78,21,201,214,210,163,12,251,187,45,188,137,126,127,237,92,234,91,240,225,38,194,57,213,251,237,171,30,99,52,14,49,84,101,252,237,7,166,122,114,32,107,32,207,239,136,168,178,12,11,241,233,230,146,132,18,83,233,41,172,17,6,161,42,113,87,40,255,185,1,146,128,5,240,126,131,71,42,54,124,205,2,122,71,30,222,229,40,134,142,102,97,239,151,177,1,230,231,49,123,219,28,129,91,152,112,13,154,81,197,226,255,112,158,178,177,55,181,108,138,185,245,29,186,21,73,188,209,154,200,89,116,235,198,144,36,87,248,22,7,200,122,7,148,44,42,87,140,238,204,95,231,252,0,136,0,22,39,70,123,125,165,113,227,172,146,163,128,158,36,52,91,19,36,245,27,150,138,141,11,67,239,224,65,24,116,101,7,39,46,142,172,164,243,148,0,33,226,59,47,203,137,156,241,66,250,157,30,204,101,143,134,98,238,155,226,25,184,136,219,89,100,193,11,143,71,139,243,230,151,0,249,1,78,26,32,93,104,157,67,97,164,248,86,124,146,93,74,222,228,167,55,53,100,135,216,109,13,64,37,106,177,200,200,182,92,251,69,31,243,89,80,198,14,132,203,72,103,28,104,217,24,97,223,113,11,29,178,191,210,46,162,255,68,99,8,237,213,162,152,193,183,121,203,19,108,182,29,86,26,192,103,220,103,205,154,179,197,9,22,73,127,175,146,38,119,210,0,24,180,21,245,215,204,91,186,119,138,183,239,15,155,231,248,133,39,24,101,144,236,10,230,54,174,227,73,21,110,10,160,241,232,131,14,212,127,232,59,122,65,146,54,163,9,189,190,121,88,170,62,194,14,204,152,245,38,131,37,91,81,72,114,29,115,239,182,56,44,156,159,177,180,82,160,93,97,86,183,236,50,95,85,39,71,181,225,152,143,63,123,117,34,44,109,160,166,229,240,91,138,102,54,180,173,44,50,80,42,124,7,50,124,211,239,21,94,197,185,239,213,107,142,64,95,124,125,17,180,97,189,101,52,48,19,112,12,70,9,212,177,54,118,66,84,147,236,248,26,124,95,103,135,254,124,49,112,186,99,120,90,8,194,191,88,57,242,65,61,10,104,246,197,252,19,159,58,194,75,173,242,103,8,115,84,69,238,149,26,15,159,182,141,132,119,70,29,53,20,143,46,163,204,6,236,59,45,185,172,89,119,83,38,144,36,222,96,151,26,99,195,163,170,133,92,159,214,53,150,116,90,176,69,145,130,15,172,140,217,215,101,163,115,161,65,101,8,7,183,113,213,134,58,175,130,251,143,173,248,168,135,60,159,30,194,68,208,119,120,2,40,178,227,247,161,77,47,136,46,244,163,72,65,158,25,225,195,61,132,182,204,177,186,200,81,2,65,105,212,72,94,203,232,217,182,123,251,228,160,1,161,204,123,20,37,1,77,208,179,45,149,181,122,102,190,123,213,164,231,41,216,130,234,248,208,251,252,220,84,209,67,47,61,220,5,142,162,26,236,121,142,248,132,255,65,122,203,196,102,191,187,2,195,127,255,193,92,49,91,186,154,39,156,29,211,172,49,104,245,114,153,223,211,199,249,35,130,160,128,0,152,176,183,20,236,113,193,108,26,255,11,237,102,133,245,94,115,114,10,89,229,214,221,99,149,30,99,37,246,10,26,26,39,92,123,170,73,211,127,227,54,30,86,133,159,112,225,91,148,100,174,149,75,143,14,140,20,44,64,212,5,243,8,116,63,30,97,42,123,20,73,212,85,207,83,122,27,251,233,84,10,17,236,232,83,200,127,119,143,163,204,220,167,59,231,20,106,186,222,191,8,40,234,21,25,180,13,116,250,152,224,174,75,3,205,38,173,215,236,151,185,121,254,244,154,239,17,53,106,164,61,49,116,216,118,94,150,35,181,26,238,66,49,211,221,132,146,166,115,39,136,36,205,230,179,31,197,51,148,165,109,38,70,37,148,52,44,209,250,98,58,246,225,103,198,101,26,25,196,207,8,166,21,88,252,175,253,10,88,107,157,19,225,61,12,246,221,37,239,186,167,137,142,135,222,128,174,62,95,216,38,141,157,45,232,97,217,173,203,234,116,129,69,206,189,94,221,12,54,139,186,247,184,16,200,121,244,104,8,7,35,111,47,188,10,140,92,73,143,206,203,72,122,184,20,102,197,130,64,150,63,96,239,8,132,111,217,84,91,198,32,43,100,138,241,15,160,42,190,253,193,184,164,124,29,210,96,67,224,221,182,29,218,129,149,29,128,174,98,88,88,125,56,40,255,120,5,0,87,174,42,150,90,112,201,183,169,19,57,195,191,12,58,244,235,132,25,145,72,146,214,8,125,100,135,12,5,102,97,248,174,24,159,90,33,43,187,6,61,212,241,225,190,219,252,197,123,129,164,108,123,55,230,4,153,166,105,234,15,85,216,23,56,32,3,41,110,68,146,172,133,202,98,41,7,47,152,35,255,168,106,241,226,222,77,244,52,185,65,252,227,32,66,38,11,172,60,28,28,103,84,1,1,205,182,190,28,189,102,253,43,1,191,148,116,10,227,18,81,93,80,239,157,232,215,180,163,165,161,109,177,71,150,244,144,208,160,110,22,174,60,206,43,103,121,55,103,114,115,173,238,13,10,227,251,41,176,216,158,229,216,55,234,128,128,20,167,106,181,86,163,130,215,110,149,191,10,227,215,8,214,154,178,181,15,19,0,247,250,97,74,43,157,55,94,174,41,41,9,199,97,20,91,32,18,10,43,98,240,247,203,20,250,117,160,44,229,202,187,64,54,124,15,184,169,129,27,160,240,26,61,255,60,166,60,144,209,84,55,187,186,168,13,124,125,29,17,100,249,227,62,205,78,179,163,168,139,168,21,38,83,239,151,74,43,66,2,92,72,71,94,216,134,238,20,45,158,213,164,73,57,80,47,198,184,130,223,227,71,132,133,235,177,85,174,142,124,172,200,54,229,40,126,60,76,92,216,153,56,241,174,66,141,90,226,3,30,68,234,71,187,163,112,146,255,22,143,170,204,3,127,179,81,139,160,37,77,246,128,220,196,158,153,73,177,65,199,119,29,197,144,130,248,206,155,253,108,213,124,7,223,221,162,146,134,242,65,99,162,107,120,247,214,207,96,150,169,131,208,218,221,28,24,112,208,23,1,130,142,232,56,104,45,33,158,95,255,123,31,74,76,120,178,155,213,6,195,164,8,8,69,241,197,127,83,169,21,167,19,94,143,252,33,159,248,241,170,153,147,1,149,199,201,131,170,79,236,212,209,143,107,98,24,123,56,33,193,85,247,64,225,135,210,78,145,57,16,145,71,170,20,133,87,235,4,166,239,100,82,235,81,50,223,9,193,52,49,86,129,190,196,82,165,107,63,115,161,98,33,20,193,29,42,151,205,252,124,72,245,48,181,67,7,13,21,127,59,226,188,144,129,112,244,192,121,213,80,42,196,1,13,107,108,78,0,40,121,225,148,237,234,209,216,238,9,147,226,254,96,89,212,72,193,106,75,135,74,227,67,255,92,191,81,188,124,226,149,152,142,15,159,195,238,114,55,255,166,157,230,59,148,170,166,151,65,213,104,253,253,112,150,82,147,137,27,214,100,247,65,81,92,47,86,217,7,45,120,81,130,31,236,243,76,78,3,45,105,172,220,71,48,220,94,196,249,163,193,133,50,236,205,20,55,2,63,14,127,69,113,212,204,12,58,79,89,86,29,61,199,201,64,149,6,144,182,150,129,31,18,167,120,248,82,107,25,143,128,27,161,28,25,153,183,217,238,78,186,106,92,27,202,219,165,96,0,216,234,169,73,101,39,182,113,217,240,170,116,172,221,250,233,48,49,242,83,227,92,181,184,72,230,180,21,15,108,135,25,38,153,25,124,227,26,149,73,236,39,211,244,149,58,183,132,26,223,219,174,144,117,233,219,165,205,157,159,222,184,52,47,241,201,123,65,24,44,55,215,177,168,250,179,115,190,227,123,158,163,179,224,69,196,66,207,254,243,101,221,193,140,250,4,28,222,52,96,138,160,33,218,64,118,214,234,201,152,148,91,178,111,107,144,142,6,182,102,72,188,34,213,181,26,223,58,255,103,81,17,47,169,11,245,224,123,148,215,237,186,107,75,152,90,202,166,22,149,197,5,246,238,78,76,229,106,199,94,127,195,0,45,82,6,159,103,96,138,231,71,46,107,59,216,39,43,12,221,27,214,56,155,145,66,187,169,250,235,78,211,179,239,183,198,163,93,5,196,24,174,143,225,106,139,89,98,13,127,207,184,194,30,1,165,198,169,8,197,118,86,163,221,138,23,209,61,116,79,99,233,43,130,60,244,85,229,243,172,123,148,200,120,192,127,211,52,11,159,41,95,212,230,188,169,156,137,29,212,12,148,168,148,133,243,44,241,139,127,24,246,220,227,125,209,97,60,52,162,192,146,49,161,92,138,112,189,128,59,126,125,46,207,60,79,231,174,152,209,68,223,205,2,38,14,91,116,159,255,28,27,178,248,164,104,158,79,69,214,234,157,12,75,163,83,253,245,202,61,213,176,6,197,230,29,208,166,253,194,254,235,29,141,241,70,249,15,62,0,148,163,135,52,122,40,96,87,31,179,152,51,216,133,184,122,198,203,60,115,218,191,193,16,178,25,148,252,112,104,103,252,36,92,221,28,179,43,199,198,151,128,100,252,217,161,249,34,201,172,118,52,180,252,104,7,223,44,116,102,212,21,40,224,184,55,163,210,21,207,161,239,51,54,155,41,133,18,67,48,3,165,130,251,4,79,214,57,72,130,157,212,144],av=[0,1,3,4,6,7,9,10,12,13,15,16,18,19,21,22,24,26,29,31,34,36,39,41,44,46,49,51,54,56,59,61,64,65,66,67,68,69,70,72,73,74,75,76,77,79,80,81,82,83,84,85,87,88,89,90,91,92,94,95,96,97,98,99,101,102,103,104,105,106,107,109,110,111,112,113,114,116,117,118,119,120,121,123,124,125,126,127,128,129,131,132,133,134,135,136,138,139,140,141,142,143,145,146,147,148,149,150,151,153,154,155,156,157,158,160,161,162,163,164,165,166,168,169,170,171,172,173,175,176,177,178,179,180,182,183,184,185,186,187,188,190,191,192,193,194,195,197,198,199,200,201,202,204,205,206,207,208,209,210,212,213,214,215,216,217,219,220,221,222,223,224,226,226,226,227,227,227,228,228,228,229,229,229,230,230,231,231,231,232,232,232,233,233,233,234,234,235,235,235,236,236,236,237,237,237,238,238,239,239,239,240,240,240,241,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255],cv=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,32,33,35,36,37,39,40,42,43,44,46,47,49,50,51,53,54,56,57,58,59,61,62,63,64,66,67,68,69,71,72,73,74,76,77,78,79,81,82,83,84,86,87,88,90,91,92,93,95,96,97,98,100,101,102,103,105,106,107,108,110,111,112,113,115,116,117,118,120,121,122,124,125,126,127,129,130,131,132,134,135,136,137,139,140,141,142,144,145,146,147,149,150,151,152,154,155,156,158,159,160,161,163,164,165,166,168,169,170,171,173,174,175,176,178,179,180,181,183,184,185,186,188,189,190,192,193,194,195,197,198,199,200,202,203,204,205,207,208,209,210,212,213,214,215,217,218,219,220,222,223,224,226,226,226,227,227,228,228,229,229,230,230,231,231,232,232,233,233,234,234,234,235,235,236,236,237,237,238,238,239,239,240,240,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255],lv=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,43,44,45,46,47,48,50,51,52,53,54,55,56,58,59,60,61,62,63,65,66,67,68,69,70,72,73,74,76,77,78,80,81,83,84,85,87,88,89,91,92,94,95,96,98,99,100,102,103,105,106,107,109,110,111,113,114,116,117,118,120,121,122,124,125,127,128,129,131,132,133,135,136,138,139,140,142,143,144,146,147,149,150,151,153,154,155,157,158,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,192,193,193,194,195,195,196,197,197,198,199,199,200,201,201,202,203,203,204,205,205,206,207,207,208,209,209,210,211,211,212,213,213,214,215,215,216,217,217,218,219,219,220,221,221,222,223,223,224,225,225,226,227,227,228,229,229,230,231,231,232,233,233,234,235,235,236,237,237,238,239,239,240,241,241,242,243,243,244,245,245,246,247,247,248,249,249,250,251,251,252,253,253,254,255];class uv extends X_{constructor(e,t,r,i){super(e,sv,r,i),this.lightLevel=.1,this.rednessLevel=.5,this.mskin_he_max=175/180*3.141593,this.mskin_he_min=115/180*3.141593,this.mskin_hc_max=173/180*3.141593,this.mskin_hc_min=116/180*3.141593,this.mskin_hc_axis=2.04203545,this.mfacts_rotate_c=0,this.mfacts_rotate_le=0,this.mfacts_rotate_ge=0,this.tab_addr=null,this.lutTextures=[],this.inputTexture=t,this.init()}setUniforms(){const e=this.gl.getUniformLocation(this.program,"u_flipY"),t=this.gl.getUniformLocation(this.program,"u_denoiseLevel");this.gl.uniform1f(t,this.denoiseLevel),this.gl.uniform1f(e,1);const r=this.gl.getUniformLocation(this.program,"light");this.gl.uniform1f(r,this.lightLevel);const i=this.gl.getUniformLocation(this.program,"redness");this.gl.uniform1f(i,this.rednessLevel);const n=this.gl.getUniformLocation(this.program,"skin_he_max"),o=this.gl.getUniformLocation(this.program,"skin_he_min"),s=this.gl.getUniformLocation(this.program,"skin_hc_max"),a=this.gl.getUniformLocation(this.program,"skin_hc_min"),c=this.gl.getUniformLocation(this.program,"skin_hc_axis"),l=this.gl.getUniformLocation(this.program,"facts_rotate_c"),u=this.gl.getUniformLocation(this.program,"facts_rotate_le"),d=this.gl.getUniformLocation(this.program,"facts_rotate_ge");this.gl.uniform1f(n,this.mskin_he_max),this.gl.uniform1f(o,this.mskin_he_min),this.gl.uniform1f(s,this.mskin_hc_max),this.gl.uniform1f(a,this.mskin_hc_min),this.gl.uniform1f(c,this.mskin_hc_axis),this.gl.uniform1f(l,this.mfacts_rotate_c),this.gl.uniform1f(u,this.mfacts_rotate_le),this.gl.uniform1f(d,this.mfacts_rotate_ge);const h=this.gl.getUniformLocation(this.program,"u_originImage");this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,this.inputTexture),this.gl.uniform1i(h,2);const p=["lighten_lut"],f=[this.gl.TEXTURE3];for(let g=0;g<p.length;g++){const e=this.gl.getUniformLocation(this.program,p[g]);this.gl.activeTexture(f[g]),this.gl.bindTexture(this.gl.TEXTURE_2D,this.lutTextures[g]),this.gl.uniform1i(e,g+3)}}setParameters(e){void 0!==e.denoiseLevel&&(this.denoiseLevel=e.denoiseLevel),void 0!==e.lightLevel&&(this.lightLevel=e.lightLevel),void 0!==e.rednessLevel&&(this.rednessLevel=e.rednessLevel,this.updateRedness(this.rednessLevel)),e.lighteningContrastLevel&&this.updateLut(e.lighteningContrastLevel)}init(){this.tab_addr=new Uint8Array(cv);const e=[this.tab_addr],t=[256],r=[1];for(let i=0;i<e.length;i++){const n=this.gl.createTexture();if(!n)throw new pl(ll.WEBGL_INTERNAL_ERROR,"create lut texture failed");this.gl.bindTexture(this.gl.TEXTURE_2D,n),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,t[i],r[i],0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,e[i]),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.lutTextures.push(n)}}updateRedness(e){const t=3.141593;let r,i,n=e,o=n;n>1&&(n=1),n<0&&(n=0),o>1&&(o=1),o<0&&(o=0),this.mfacts_rotate_c=.8*n,o<.8&&(o=0),this.mskin_he_max=175/180*t,this.mskin_hc_max=173/180*t,this.mskin_he_min=(115-4*o)/180*t,this.mskin_hc_min=(116-4*o)/180*t,this.mskin_hc_axis=(117-4*o)/180*t,this.mskin_hc_axis<this.mskin_hc_min&&(this.mskin_hc_axis=this.mskin_hc_min),this.mskin_hc_min<t/2&&(this.mskin_hc_min=t/2),this.mskin_hc_axis<t/2&&(this.mskin_hc_axis=t/2),this.mskin_he_min<t/2&&(this.mskin_he_min=t/2),this.mskin_hc_max>t&&(this.mskin_hc_max=t),this.mskin_hc_axis>t&&(this.mskin_hc_axis=t),this.mskin_he_max>t&&(this.mskin_he_max=t),r=this.mskin_he_max-this.mskin_hc_max,i=this.mskin_hc_max-this.mskin_hc_axis,this.mfacts_rotate_ge=r>.01?this.mfacts_rotate_c*i/r:this.mfacts_rotate_c,r=this.mskin_hc_min-this.mskin_he_min,i=this.mskin_hc_axis-this.mskin_hc_min,this.mfacts_rotate_le=r>.01?this.mfacts_rotate_c*i/r:this.mfacts_rotate_c}updateLut(e){let t=null;if(0===e&&(t=cv),1===e&&(t=lv),2===e&&(t=av),!t)throw new pl(ll.WEBGL_INTERNAL_ERROR,"invalid ylut_table value:"+e);this.tab_addr=new Uint8Array(t);const r=[this.tab_addr],i=[256],n=[1];for(let o=0;o<r.length;o++)this.gl.bindTexture(this.gl.TEXTURE_2D,this.lutTextures[o]),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,i[o],n[o],0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,r[o])}}class dv{constructor(){this.gl=null,this.canvas=null,this.programs=[],this.commonProgram=null,this.inputTexture=null,this.outputTextures=[],this.fbos=[],this.originalFrameWidth=0,this.originalFrameHeight=0,this.enableBeauty=!1,this.denoiseLevel=5,this.lightLevel=.35,this.rednessLevel=.5,this.lighteningContrastLevel=1}setEnableBeauty(e){this.enableBeauty=!!e}init(e,t,r){if(!Fu().supportWebGL)throw new pl(ll.NOT_SUPPORTED,"your browser is not support webGL");if(this.gl=r.getContext("webgl"),!this.gl)throw new pl(ll.WEBGL_INTERNAL_ERROR,"can not get webgl context");if(this.initGL(e,t),!this.inputTexture)throw new pl(ll.WEBGL_INTERNAL_ERROR,"can not find input texture");this.canvas=r,this.programs.push(new J_(this.gl)),this.programs.push(new tv(this.gl,e,t)),this.programs.push(new iv(this.gl,e,t)),this.programs.push(new ov(this.gl,e,t)),this.programs.push(new uv(this.gl,this.inputTexture,e,t)),this.commonProgram=this.programs[0].program,this.setDenoiseLevel(this.denoiseLevel),this.setLightLevel(this.lightLevel),this.setRednessLevel(this.rednessLevel),this.setContrastLevel(this.lighteningContrastLevel)}render(e){if(!this.gl||!this.commonProgram||!this.canvas)return void Rc.warning("video effect manager is not init!");let t=0;if(this.originalFrameHeight===e.videoWidth&&this.originalFrameWidth===e.videoHeight)t=2;else if(this.originalFrameHeight!==e.videoHeight||this.originalFrameWidth!==e.videoWidth){var r,i,n;if(Rc.debug(Je(r=Je(i=Je(n="beauty effect: resolution changed ".concat(this.originalFrameWidth,"x")).call(n,this.originalFrameHeight," -> ")).call(i,e.videoWidth,"x")).call(r,e.videoHeight)),0===e.videoHeight||0===e.videoWidth)return void Rc.debug("beauty effect: skip 0 resolution frame");this.canvas.width=e.videoWidth,this.canvas.height=e.videoHeight,e.setAttribute("width",e.videoWidth.toString()),e.setAttribute("height",e.videoHeight.toString()),this.release(),this.init(e.videoWidth,e.videoHeight,this.canvas)}this.gl.viewport(0,0,e.videoWidth,e.videoHeight),this.gl.bindTexture(this.gl.TEXTURE_2D,this.inputTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e);const o=this.enableBeauty?this.programs.length-1:0;for(let a=0;a<=o;a++){const e=this.programs[a].program;this.gl.useProgram(e);const r=this.gl.getUniformLocation(e,"u_image");this.programs[a].setUniforms(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.fbos[t+a%2]),this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.outputTextures[t+a%2]),this.gl.uniform1i(r,0)}this.gl.useProgram(this.commonProgram);const s=this.gl.getUniformLocation(this.commonProgram,"u_flipY");this.gl.uniform1f(s,-1),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.drawArrays(this.gl.TRIANGLES,0,6)}setDenoiseLevel(e){var t;Jr(t=this.programs).call(t,t=>{t instanceof X_&&t.setParameters({denoiseLevel:e})}),this.denoiseLevel=e}setLightLevel(e){var t;Jr(t=this.programs).call(t,t=>{t instanceof X_&&t.setParameters({lightLevel:e})}),this.lightLevel=e}setRednessLevel(e){var t;Jr(t=this.programs).call(t,t=>{t instanceof X_&&t.setParameters({rednessLevel:e})}),this.rednessLevel=e}setContrastLevel(e){var t;Jr(t=this.programs).call(t,t=>{t instanceof X_&&t.setParameters({lighteningContrastLevel:e})}),this.lighteningContrastLevel=e}setSize(e,t){var r;Jr(r=this.programs).call(r,r=>{r instanceof X_&&r.setSize(e,t)})}release(){this.gl=null,this.commonProgram=null,this.inputTexture=null,this.programs=[],this.outputTextures=[],this.fbos=[]}initGL(e,t){if(!this.gl)throw new pl(ll.WEBGL_INTERNAL_ERROR,"can not find webgl context");this.inputTexture=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,this.inputTexture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);for(let r=0;r<4;r++){const i=this.gl.createTexture();if(!i)throw new pl(ll.WEBGL_INTERNAL_ERROR,"create texture failed");this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),r<2?this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,e,t,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null):this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,t,e,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null);const n=this.gl.createFramebuffer();if(!n)throw new pl(ll.WEBGL_INTERNAL_ERROR,"create frame buffer failed");this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,n),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,i,0),this.outputTextures.push(i),this.fbos.push(n)}this.gl.viewport(0,0,e,t),this.originalFrameWidth=e,this.originalFrameHeight=t}}class hv{constructor(){this.targetFrameRate=0,this.recordedFrameCount=0,this.recordingTime=2}async startRecordBeautyEffectOutput(e,t=4){if(this.recordID)throw new pl(ll.UNEXPECTED_ERROR,"another beauty effect recording is in progress");const r=kp(6,"");return this.recordID=r,this.targetFrameRate=e,this.recordedFrameCount=0,this.recordingTime=t,await Ip(1e3*this.recordingTime),this.recordID!==r?(this.recordID=void 0,!0):(this.recordID=void 0,this.recordedFrameCount<this.targetFrameRate*this.recordingTime/2?(Rc.warning("detect beauty effect overload, current framerate",this.recordedFrameCount/2),!1):(Rc.debug("beauty effect current framerate",this.recordedFrameCount/2),!0))}stopRecordBeautyEffectOutput(){this.targetFrameRate=0,this.recordedFrameCount=0,this.recordID=void 0}addFrame(){this.recordID&&(this.recordedFrameCount+=1)}}class pv extends class{get output(){return this._output}async setInput(e){if(e!==this.input){if(e.kind!==this.kind)throw new pl(ll.UNEXPECTED_ERROR);this.input&&this.removeInput(),this.input=e,await this._setInput(e)}}removeInput(){this.input=void 0,this._removeInput()}async updateOutput(e){this.output!==e&&(this._output=e,this.onOutputChange&&await this.onOutputChange())}replaceOriginMediaStream(e,t){var r,i;const n=Qo(r=e.getTracks()).call(r,e=>e.kind===this.kind);n&&e.removeTrack(n);const o=Qo(i=t.getTracks()).call(i,e=>e.kind===this.kind);void 0===this.output&&o&&e.addTrack(o),this.output&&(Rc.debug("replace ".concat(this.output.kind," track to origin media stream")),e.addTrack(this.output))}}{constructor(){super(),this.kind="video",this.fps=15,this.overloadDetector=new hv,this.enabled=!1,this.stopChromeBackgroundLoop=null,this.lastRenderTime=0,this.fps=30,this.manager=new dv}async setBeautyEffectOptions(e,t){if(function(e){void 0!==e.smoothnessLevel&&ml(e.smoothnessLevel,"options.smoothnessLevel",0,1,!1),void 0!==e.lighteningLevel&&ml(e.lighteningLevel,"options.lighteningLevel",0,1,!1),void 0!==e.rednessLevel&&ml(e.rednessLevel,"options.rednessLevel",0,1,!1),void 0!==e.lighteningContrastLevel&&gl(e.lighteningContrastLevel,"options.lighteningContrastLevel",[0,1,2])}(t),void 0!==t.smoothnessLevel){const e=Math.max(.1,10*t.smoothnessLevel);this.manager.setDenoiseLevel(e)}if(void 0!==t.lighteningLevel){const e=Math.max(.1,t.lighteningLevel/2);this.manager.setLightLevel(e)}if(void 0!==t.rednessLevel){const e=Math.max(.01,t.rednessLevel);this.manager.setRednessLevel(e)}if(void 0!==t.lighteningContrastLevel){const e=t.lighteningContrastLevel;this.manager.setContrastLevel(e)}this.enabled!==e&&(this.manager.setEnableBeauty(e),this.enabled=e,e?this.input&&await this.startEffect():await this.stopEffect())}destroy(){this.onOutputChange=void 0,this.stopEffect(),this.enabled=!1}async startEffect(){const e=ma();if(!this.input)return void Rc.warning("video track is null, fail to start video effect!");if(this.input&&this.output&&this.input!==this.output)return void Rc.warning("video effect is already enabled");const t=await this.renderWithWebGL();await this.updateOutput(t),Rc.info("start video effect, output:",this.output),this.overloadDetector.startRecordBeautyEffectOutput(this.fps).then(e=>{e||this.onOverload&&this.onOverload()});const r=()=>{this.enabled&&requestAnimationFrame(r);const e=Ma(),t=1e3/this.fps,i=this.lastRenderTime?e-this.lastRenderTime:t;i<t||(this.lastRenderTime=e-(i-t),this.video&&this.video.paused&&this.video.play(),this.enabled&&this.video&&(this.manager.render(this.video),this.output&&this.output.requestFrame&&this.output.requestFrame(),this.overloadDetector.addFrame()))};requestAnimationFrame(r),e.name===ha.CHROME&&document.addEventListener("visibilitychange",()=>{document.hidden?this.stopChromeBackgroundLoop=vh(()=>{this.enabled&&this.video&&this.manager.render(this.video),this.output&&this.output.requestFrame&&this.output.requestFrame(),this.overloadDetector.addFrame()},this.fps):this.stopChromeBackgroundLoop&&(this.stopChromeBackgroundLoop(),this.stopChromeBackgroundLoop=null)},!1)}async stopEffect(){Rc.info("stop video effect"),this.overloadDetector.stopRecordBeautyEffectOutput(),this.manager.release(),this.canvas&&this.canvas.remove(),this.video&&this.video.remove(),this.canvas=void 0,this.video=void 0,await this.updateOutput(this.input)}async _setInput(e){this.enabled&&!this.video&&await this.startEffect()}_removeInput(){this.stopEffect()}async renderWithWebGL(){var e;if(!this.input)throw new pl(ll.BEAUTY_PROCESSOR_INTERNAL_ERROR,"can not renderWithWebGL, no input");this.canvas&&(this.canvas.remove(),this.canvas=void 0),this.video&&(this.video.remove(),this.video=void 0),this.canvas=document.createElement("canvas"),this.video=document.createElement("video"),this.video.setAttribute("autoplay",""),this.video.setAttribute("muted",""),this.video.muted=!0,this.video.setAttribute("playsinline",""),this.video.setAttribute("style","display:none"),this.video.srcObject=new MediaStream([this.input]);const t=new fo(e=>{const t=()=>{this.video&&this.video.removeEventListener("playing",t),e(void 0)};this.video&&this.video.addEventListener("playing",t)});this.video.play(),await t;const r=this.input.getSettings(),i=r.width||this.video.videoWidth,n=r.height||this.video.videoHeight;if(r.frameRate&&this.fps!==r.frameRate&&(this.fps=r.frameRate,Rc.debug("beauty video processor: set fps to",this.fps)),Rc.debug(Je(e="beauty video processor: width ".concat(i," height ")).call(e,n)),!i||!n)throw new pl(ll.BEAUTY_PROCESSOR_INTERNAL_ERROR,"can not get track resolution");this.canvas.width=i,this.canvas.height=n,this.video.setAttribute("width",i.toString()),this.video.setAttribute("height",n.toString()),this.manager.init(i,n,this.canvas);const o=Fu();return this.canvas.captureStream(o.supportRequestFrame?0:this.fps).getVideoTracks()[0]}}function fv(e){const t={};if(e.facingMode&&(t.facingMode=e.facingMode),e.cameraId&&(t.deviceId={exact:e.cameraId}),!e.encoderConfig)return t;const r=Mc(e.encoderConfig);return t.width=r.width,t.height=r.height,!Pa()&&r.frameRate&&(t.frameRate=r.frameRate),ma().name===ha.EDGE&&"object"==typeof t.frameRate&&(t.frameRate.max=60),Ia()&&(t.frameRate={ideal:30,max:30}),t}function gv(e){const t={};e.screenSourceType&&(t.mediaSource=e.screenSourceType),e.extensionId&&Ta()&&(t.extensionId=e.extensionId),e.electronScreenSourceId&&(t.sourceId=e.electronScreenSourceId);const r=e.encoderConfig?xc(e.encoderConfig):null;return t.mandatory={chromeMediaSource:"desktop",maxWidth:r?r.width:void 0,maxHeight:r?r.height:void 0},r&&r.frameRate&&("number"==typeof r.frameRate?(t.mandatory.maxFrameRate=r.frameRate,t.mandatory.minFrameRate=r.frameRate):(t.mandatory.maxFrameRate=r.frameRate.max||r.frameRate.ideal||r.frameRate.exact||void 0,t.mandatory.minFrameRate=r.frameRate.min||r.frameRate.ideal||r.frameRate.exact||void 0),t.frameRate=r.frameRate),r&&r.width&&(t.width=r.width),r&&r.height&&(t.height=r.height),t}function mv(e){const t={};if(Pa()||(void 0!==e.AGC&&(t.autoGainControl=e.AGC,Ta()&&(t.googAutoGainControl=e.AGC,t.googAutoGainControl2=e.AGC)),void 0!==e.AEC&&(t.echoCancellation=e.AEC),void 0!==e.ANS&&(t.noiseSuppression=e.ANS,Ta()&&(t.googNoiseSuppression=e.ANS))),e.encoderConfig){const r=Fc(e.encoderConfig);t.channelCount=r.stereo?2:1,t.sampleRate=r.sampleRate,t.sampleSize=r.sampleSize}return e.microphoneId&&(t.deviceId={exact:e.microphoneId}),Ta()&&2===t.channelCount&&(t.googAutoGainControl=!1,t.googAutoGainControl2=!1,t.echoCancellation=!1,t.googNoiseSuppression=!1),ma().os===da.ANDROID&&(t.sampleRate=void 0),t}var _v,vv;!function(e){e.COVERED="COVERED",e.POSITION="POSITION",e.SIZE="SIZE",e.STYLE="STYLE"}(_v||(_v={})),function(e){e.UNMOUNTED="UNMOUNTED",e.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT"}(vv||(vv={}));var Ev=new class{constructor(){this._clientSize=null,this.getClientWidth=()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth,this.getClientHeight=()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight,this.getStyle=e=>window.getComputedStyle(e,null),this.checkCssVisibleProperty=e=>{var t;let r=!0;const i=this.getStyle(e),{display:n,visibility:o,opacity:s,filter:a}=i;if(("none"===n||is(t=["hidden","collapse"]).call(t,o)||Number(s)<.1)&&(r=!1),!r)return!1;if(a){var c;const e=ji(c=a.split(" ")).call(c,e=>{var t;const r=e.split("(")[0];return is(t=["brightness","blur","opacity"]).call(t,r)}),t=vo(e).call(e,e=>{const[t,r]=e.split(/\(|\)/);return[t,Number(r.match(/^[0-9\.]+/))]});Jr(t).call(t,e=>{const[t,i]=e;switch(t){case"brightness":(i<.1||i>3)&&(r=!1);break;case"blur":i>3&&(r=!1);break;case"opacity":i<.1&&(r=!1)}})}return r},this.checkPropertyUpToAllParentNodes=(e,t)=>{let r=!0,i=!0;const n=e=>t(e);let o=e;for(;o&&i;)n(o)||(r=!1,i=!1),o=o.parentElement,o||(i=!1);return r},this.checkActualCssVisibleIncludeInherit=e=>this.checkPropertyUpToAllParentNodes(e,this.checkCssVisibleProperty),this.getSizeAboutClient=e=>{const{width:t,height:r,left:i,right:n,top:o,bottom:s}=e.getBoundingClientRect(),a=this.getClientWidth(),c=this.getClientHeight();return{width:t,height:r,left:i,right:n,top:o,bottom:s,clientWidth:a,clientHeight:c,clientMin:Math.min(a,c)}},this.checkActualSize=()=>{const{width:e,height:t,clientMin:r}=this._clientSize;return this.checkSizeIsVisible(e,t,r)},this.elementFromPoint=(e,t)=>document.elementFromPoint?document.elementFromPoint(e,t):null,this.checkCoverForAPoint=(e,t,r)=>{const i=this.elementFromPoint(e,t);return null!==i&&i!==r},this.getPointPositionList=()=>{const{width:e,height:t,left:r,top:i}=this._clientSize,n=e/6,o=t/6,s=[],a=10**6;for(let c=0;c<5;c++)for(let e=0;e<5;e++){const t=(r*a+(0===c?.1:4===c?(n*c*a-1e5)/a:n*c)*a)/a,l=(i*a+(0===e?.1:4===e?(o*e*a-1e5)/a:o*e)*a)/a;s.push({x:t,y:l})}return[...s]},this.checkElementCover=e=>{var t;const r=this.getPointPositionList();return ji(t=vo(r).call(r,t=>this.checkCoverForAPoint(t.x,t.y,e))).call(t,e=>!!e).length>6},this.checkSizeIsVisible=(e,t,r)=>(e>50||r/e<=10)&&(t>50||r/t<=10),this.checkSizeOfPartInClient=()=>{const{left:e,right:t,top:r,bottom:i,clientHeight:n,clientWidth:o,clientMin:s}=this._clientSize;let a,c,l,u;if(e<0)a=0;else{if(!(e<o))return!1;a=e}if(t<0)return!1;if(c=t<o?t:o,r<0)l=0;else{if(!(r<n))return!1;l=r}if(i<0)return!1;u=i<n?i:n;const d=c-a,h=u-l;return this.checkSizeIsVisible(d,h,s)},this.returnHiddenResult=e=>(this._clientSize=null,{visible:!1,reason:e}),this.checkOneElementVisible=e=>{if(e instanceof HTMLElement){if(this.checkElementIsMountedOnDom(e)){if(this.checkActualCssVisibleIncludeInherit(e)){if(this._clientSize=this.getSizeAboutClient(e),this.checkElementCover(e))return this.returnHiddenResult(_v.COVERED);{const e=this.checkActualSize(),t=this.checkSizeOfPartInClient();return e&&!t?this.returnHiddenResult(_v.POSITION):e?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(_v.SIZE)}}return this.returnHiddenResult(_v.STYLE)}return this.returnHiddenResult(vv.UNMOUNTED)}return this.returnHiddenResult(vv.INVALID_HTML_ELEMENT)},this.checkElementIsMountedOnDom=e=>this.checkPropertyUpToAllParentNodes(e,e=>"HTML"!==e.nodeName.toUpperCase()?null!==e.parentElement:!!document.documentElement)}};function Av(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function yv(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=Av(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=Av(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}var Sv=function(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Bi(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&di(t,r,s),s},Cv=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class Tv extends lh{constructor(e,t,r,i,n){super(e,n),this.trackMediaType="video",this._videoVisibleTimer=null,this._scalabiltyMode={numSpatialLayers:1,numTemporalLayers:1},this._enabled=!0,this.updateMediaStreamTrackResolution(),this._encoderConfig=t,this._scalabiltyMode=r,this._optimizationMode=i}get isPlaying(){return!(!this._player||this._player.videoElementStatus!==dl.PLAYING)}play(e,t={}){const r=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.LOCAL_VIDEO_TRACK_PLAY,options:[this.getTrackId(),"string"==typeof e?e:"HTMLElement",t]});if(!(e instanceof HTMLElement)){const t=document.getElementById(e.toString());var i;t?e=t:(Rc.warning(Je(i="[".concat(this.getTrackId(),'] can not find "#')).call(i,e,'" element, use document.body')),e=document.body)}Rc.debug("[".concat(this.getTrackId(),"] start video playback"),ve(t));const n=yv({},this._getDefaultPlayerConfig(),{},t,{trackId:this.getTrackId(),element:e});this._player?this._player.updateConfig(n):(this._player=new H_(n),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=window.setInterval(()=>{try{const e=this.getVideoElementVisibleStatus();this.emit(Au.VIDEO_ELEMENT_VISIBLE_STATUS,e)}catch(e){}},jc("CHECK_VIDEO_VISIBLE_INTERVAL")),r.onSuccess()}stop(){const e=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.LOCAL_VIDEO_TRACK_STOP,options:[this.getTrackId()]});if(!this._player)return e.onSuccess();this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._player.destroy(),this._player=void 0,Rc.debug("[".concat(this.getTrackId(),"] stop video playback")),e.onSuccess()}async setEnabled(e,t){if(!t){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(Rc.info("[".concat(this.getTrackId(),"] start setEnabled"),e),!e){this._originMediaStreamTrack.enabled=!1;try{await Mp(this,vu.NEED_DISABLE_TRACK,this)}catch(e){throw Rc.error("[".concat(this.getTrackId(),"] setEnabled to false error"),e.toString()),e}return t||(this._enabled=!1),void Rc.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}this._originMediaStreamTrack.enabled=!0;try{await Mp(this,vu.NEED_ENABLE_TRACK,this)}catch(e){throw Rc.error("[".concat(this.getTrackId(),"] setEnabled to true error"),e.toString()),e}Rc.info("[".concat(this.getTrackId(),"] setEnabled to true success")),t||(this._enabled=!0)}async setMuted(e){var t;e!==this._muted&&(this.stateCheck("muted",e),this._muted=e,this._mediaStreamTrack.enabled=!e,Rc.debug(Je(t="[".concat(this.getTrackId(),"] start set muted: ")).call(t,e)),e?await Mp(this,vu.NEED_MUTE_TRACK,this):await Mp(this,vu.NEED_UNMUTE_TRACK,this))}getStats(){Hp(()=>{Rc.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning");const e=xp(this,vu.GET_STATS);return e||yv({},eu)}async setBeautyEffect(e,t={}){const r=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.LOCAL_VIDEO_TRACK_BEAUTY,options:[this.getTrackId(),e,t]});if(e||this._videoBeautyProcessor){if(Aa()===da.IOS||Aa()===da.ANDROID){const e=new pl(ll.INVALID_OPERATION,"can not enable beauty effect on mobile device");throw r.onError(e),e}if(!this._enabled&&e){const e=new pl(ll.TRACK_IS_DISABLED,"can not enable beauty effect when track is disabled");throw r.onError(e),e}Rc.info("[".concat(this.getTrackId(),"] start setBeautyEffect"),e,ve(t));try{this._videoBeautyProcessor?await this._videoBeautyProcessor.setBeautyEffectOptions(e,t):(this._videoBeautyProcessor=new pv,this._videoBeautyProcessor.onOverload=()=>{Vp(()=>this.emit(Au.BEAUTY_EFFECT_OVERLOAD))},await this._videoBeautyProcessor.setBeautyEffectOptions(e,t),await this._registerTrackProcessor(this._videoBeautyProcessor))}catch(e){throw Rc.error("[".concat(this.getTrackId(),"] setBeautyEffect error"),e.toString()),r.onError(e),e}Rc.info("[".concat(this.getTrackId(),"] setBeautyEffect success")),r.onSuccess()}}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}clone(e,t,r,i){const n=this._mediaStreamTrack.clone();return new Tv(n,e,t,r,i)}async setBitrateLimit(e){var t;if(Rc.debug(Je(t="[".concat(this.getTrackId(),"] set bitrate limit, ")).call(t,ve(e))),e){this._forceBitrateLimit=e,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<e.max_bitrate?this._encoderConfig.bitrateMax:e.max_bitrate:this._encoderConfig.bitrateMax=e.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=e.min_bitrate);try{await Mp(this,vu.NEED_UPDATE_VIDEO_ENCODER,this)}catch(e){return e.throw()}}}async setOptimizationMode(e){var t;if("motion"!==e&&"detail"!==e&&"balanced"!==e)return void Rc.error(ll.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");const r=this._optimizationMode;try{this._optimizationMode=e,await Mp(this,vu.SET_OPTIMIZATION_MODE,this)}catch(e){throw this._optimizationMode=r,Rc.error("[".concat(this.getTrackId(),"] set optimization mode failed"),e.toString()),e}Rc.info(Je(t="[".concat(this.getTrackId(),"] set optimization mode success (")).call(t,e,")"))}setScalabiltyMode(e){var t;if(1===e.numSpatialLayers&&1!==e.numTemporalLayers)return Rc.error(ll.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabiltyMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabiltyMode=e,Rc.info(Je(t="[".concat(this.getTrackId(),"] set scalability mode success (")).call(t,e,")"))}updateMediaStreamTrackResolution(){Lp(this._originMediaStreamTrack).then(([e,t])=>{this._videoHeight=t,this._videoWidth=e}).catch(Np)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}getVideoElementVisibleStatus(){try{var e,t;const r=null==this||null===(e=this._player)||void 0===e?void 0:e.getContainerElement(),i={track:this,element:null==this||null===(t=this._player)||void 0===t?void 0:t.getVideoElement(),slot:null==r?void 0:r.parentElement},{element:n,slot:o}=i;if(this.isPlaying&&n instanceof HTMLVideoElement&&o instanceof HTMLElement){const e=Ev.checkOneElementVisible(n),t=ri({},e);return t.visible||nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]}).onSuccess("Not visible because of ".concat(t.reason)),t}return}catch(e){throw new pl(ll.GET_VIDEO_ELEMENT_VISIBLE_ERROR,e.message)}}async renewMediaStreamTrack(){}}Sv([xh(),Cv("design:type",Function),Cv("design:paramtypes",[Object,Object]),Cv("design:returntype",void 0)],Tv.prototype,"play",null),Sv([ch("LocalVideoTrack","_enabledMutex"),xh(),Cv("design:type",Function),Cv("design:paramtypes",[Boolean,Boolean]),Cv("design:returntype",fo)],Tv.prototype,"setEnabled",null),Sv([ch("LocalVideoTrack","_enabledMutex"),xh(),ih({report:nh}),Cv("design:type",Function),Cv("design:paramtypes",[Boolean]),Cv("design:returntype",fo)],Tv.prototype,"setMuted",null),Sv([xh(),Cv("design:type",Function),Cv("design:paramtypes",[]),Cv("design:returntype",Object)],Tv.prototype,"getStats",null),Sv([xh(),Cv("design:type",Function),Cv("design:paramtypes",[Boolean,Object]),Cv("design:returntype",fo)],Tv.prototype,"setBeautyEffect",null),Sv([xh(),Cv("design:type",Function),Cv("design:paramtypes",[]),Cv("design:returntype",ImageData)],Tv.prototype,"getCurrentFrameData",null),Sv([xh(),Cv("design:type",Function),Cv("design:paramtypes",[Object]),Cv("design:returntype",fo)],Tv.prototype,"setBitrateLimit",null),Sv([xh(),Cv("design:type",Function),Cv("design:paramtypes",[String]),Cv("design:returntype",fo)],Tv.prototype,"setOptimizationMode",null),Sv([xh(),Cv("design:type",Function),Cv("design:paramtypes",[Object]),Cv("design:returntype",void 0)],Tv.prototype,"setScalabiltyMode",null),Sv([xh(),Cv("design:type",Function),Cv("design:paramtypes",[]),Cv("design:returntype",void 0)],Tv.prototype,"updateMediaStreamTrackResolution",null);class bv extends Tv{constructor(e,t,r,i,n,o){super(e,t.encoderConfig?Mc(t.encoderConfig):{},i,n,o),this._enabled=!0,this._deviceName="default",this.tryResumeVideoForIOS15WeChat=async()=>{wa()&&La()&&this._enabled&&!this._isClosed&&(Rc.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.setEnabled(!1),await this.setEnabled(!0))},this._config=t,this._constraints=r,this._deviceName=e.label,this._config.encoderConfig&&(this._encoderConfig=Mc(this._config.encoderConfig)),ph.on(uh.IOS_15_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat),ph.on(uh.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat)}async setDevice(e){var t;const r=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.CAM_VIDEO_TRACK_SET_DEVICE,options:[this.getTrackId(),e]});if(Rc.info(Je(t="[".concat(this.getTrackId(),"] set device to ")).call(t,e)),this._enabled)try{const t=await Ph.getDeviceById(e),r={};r.video=yv({},this._constraints),r.video.deviceId={exact:e},r.video.facingMode=void 0,this._originMediaStreamTrack.stop();let i=null;try{i=await kh(r,this.getTrackId())}catch(e){throw Rc.error("[".concat(this.getTrackId(),"] setDevice failed"),e.toString()),i=await kh({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(i.getVideoTracks()[0],!1),e}await this._updateOriginMediaStreamTrack(i.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=t.label,this._config.cameraId=e,this._constraints.deviceId={exact:e}}catch(e){throw r.onError(e),Rc.error("[".concat(this.getTrackId(),"] setDevice error"),e.toString()),e}else try{const t=await Ph.getDeviceById(e);this._deviceName=t.label,this._config.cameraId=e,this._constraints.deviceId={exact:e}}catch(e){throw r.onError(e),Rc.error("[".concat(this.getTrackId(),"] setDevice error"),e.toString()),e}Rc.info("[".concat(this.getTrackId(),"] setDevice success")),r.onSuccess()}async setEnabled(e,t){if(!t){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(Rc.info("[".concat(this.getTrackId(),"] start setEnabled"),e),!e){this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),t||(this._enabled=!1);try{await Mp(this,vu.NEED_DISABLE_TRACK,this)}catch(e){throw Rc.error("[".concat(this.getTrackId(),"] setEnabled to false error"),e.toString()),e}return void Rc.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}const r=yv({},this._constraints),i=Ph.searchDeviceIdByName(this._deviceName);i&&!r.deviceId&&(r.deviceId={exact:i});try{const e=await kh({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(e.getVideoTracks()[0],!1),await Mp(this,vu.NEED_ENABLE_TRACK,this)}catch(e){throw Rc.error("[".concat(this.getTrackId(),"] setEnabled true error"),e.toString()),e}this.updateMediaStreamTrackResolution(),Rc.info("[".concat(this.getTrackId(),"] setEnabled to true success")),t||(this._enabled=!0)}async setEncoderConfiguration(e,t){const r=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG,options:[this.getTrackId(),e]});if(!this._enabled){const e=new pl(ll.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");throw r.onError(e),e}e=Mc(e),this._forceBitrateLimit&&(e.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:e.bitrateMax,e.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:e.bitrateMin);const i=jp(this._config);i.encoderConfig=e;const n=fv(i);(ba()||Ra()||Na())&&(n.deviceId=void 0),Rc.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),ve(e),ve(n));try{await this._originMediaStreamTrack.applyConstraints(n),this.updateMediaStreamTrackResolution()}catch(e){const t=new pl(ll.UNEXPECTED_ERROR,e.toString());throw Rc.error("[".concat(this.getTrackId(),"] applyConstraints error"),t.toString()),r.onError(t),t}this._config=i,this._constraints=n,this._encoderConfig=e;try{await Mp(this,vu.NEED_UPDATE_VIDEO_ENCODER,this)}catch(e){return r.onError(e),e.throw()}r.onSuccess()}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((Ra()||Na())&&this._enabled&&!this._isClosed&&ph.duringInterruption){const e=async()=>{ph.off(uh.IOS_INTERRUPTION_END,e),this._enabled&&!this._isClosed&&(Rc.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};ph.on(uh.IOS_INTERRUPTION_END,e)}else Rc.debug("[".concat(this.getTrackId(),"] track ended")),this.emit(Au.TRACK_ENDED)}async renewMediaStreamTrack(){const e=yv({},this._constraints),t=Ph.searchDeviceIdByName(this._deviceName);t&&!e.deviceId&&(e.deviceId={exact:t});const r=await kh({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(r.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}close(){super.close(),ph.off(uh.IOS_15_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat),ph.off(uh.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat)}}Sv([xh(),Cv("design:type",Function),Cv("design:paramtypes",[String]),Cv("design:returntype",fo)],bv.prototype,"setDevice",null),Sv([ch("CameraVideoTrack","_enabledMutex"),xh(),Cv("design:type",Function),Cv("design:paramtypes",[Boolean,Boolean]),Cv("design:returntype",fo)],bv.prototype,"setEnabled",null),Sv([xh(),Cv("design:type",Function),Cv("design:paramtypes",[Object,Boolean]),Cv("design:returntype",fo)],bv.prototype,"setEncoderConfiguration",null);class Iv{constructor(e,t){this._trust_in_room_=!0,this._trust_audio_enabled_state_=!0,this._trust_video_enabled_state_=!0,this._trust_audio_mute_state_=!0,this._trust_video_mute_state_=!0,this._trust_stream_added_state_=!0,this._audio_muted_=!1,this._video_muted_=!1,this._audio_enabled_=!0,this._video_enabled_=!0,this._audio_added_=!1,this._video_added_=!1,this.uid=e,this._uintid=t}get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio)return this._audioTrack}get videoTrack(){if(this.hasVideo)return this._videoTrack}}var Rv=Tt.findIndex,wv="findIndex",kv=!0;wv in[]&&Array(1).findIndex((function(){kv=!1})),Q({target:"Array",proto:!0,forced:kv},{findIndex:function(e){return Rv(this,e,arguments.length>1?arguments[1]:void 0)}});var Ov=Ye("Array").findIndex,Nv=Array.prototype,Lv=function(e){var t=e.findIndex;return e===Nv||e instanceof Array&&t===Nv.findIndex?Ov:t};Ku("asyncIterator");var Pv=Zu.f("asyncIterator");Ku("hasInstance"),Ku("isConcatSpreadable"),Ku("iterator"),Ku("match"),Ku("matchAll"),Ku("replace"),Ku("search"),Ku("species"),Ku("split"),Ku("toPrimitive"),Ku("toStringTag"),Ku("unscopables"),yt(Math,"Math",!0),yt(o.JSON,"JSON",!0);var Dv=M.Symbol;Ku("asyncDispose"),Ku("dispose"),Ku("observable"),Ku("patternMatch"),Ku("replaceAll");var Mv=Dv,xv=xt.set,Bv=xt.getterFor("AggregateError"),Uv=function(e,t){var r=this;if(!(r instanceof Uv))return new Uv(e,t);ar&&(r=ar(new Error(t),tr(r)));var i=[];return mt(e,i.push,i),a?xv(r,{errors:i,type:"AggregateError"}):r.errors=i,void 0!==t&&j(r,"message",String(t)),r};Uv.prototype=qt(Error.prototype,{constructor:d(5,Uv),message:d(5,""),name:d(5,"AggregateError")}),a&&V.f(Uv.prototype,"errors",{get:function(){return Bv(this).errors},configurable:!0}),Q({global:!0},{AggregateError:Uv}),Q({target:"Promise",stat:!0},{try:function(e){var t=xn.f(this),r=Un(e);return(r.error?t.reject:t.resolve)(r.value),t.promise}});var Fv="No one promise resolved";Q({target:"Promise",stat:!0},{any:function(e){var t=this,r=xn.f(t),i=r.resolve,n=r.reject,o=Un((function(){var r=x(t.resolve),o=[],s=0,a=1,c=!1;mt(e,(function(e){var l=s++,u=!1;o.push(void 0),a++,r.call(t,e).then((function(e){u||c||(c=!0,i(e))}),(function(e){u||c||(u=!0,o[l]=e,--a||n(new(le("AggregateError"))(o,Fv)))}))})),--a||n(new(le("AggregateError"))(o,Fv))}));return o.error&&n(o.value),r.promise}});var Vv=po,jv=function(e){this.wrapped=e};function Gv(e){var t,r;function i(t,r){try{var o=e[t](r),s=o.value,a=s instanceof jv;Vv.resolve(a?s.wrapped:s).then((function(e){a?i("return"===t?"return":"next",e):n(o.done?"return":"normal",e)}),(function(e){i("throw",e)}))}catch(e){n("throw",e)}}function n(e,n){switch(e){case"return":t.resolve({value:n,done:!0});break;case"throw":t.reject(n);break;default:t.resolve({value:n,done:!1})}(t=t.next)?i(t.key,t.arg):r=null}this._invoke=function(e,n){return new Vv((function(o,s){var a={key:e,arg:n,resolve:o,reject:s,next:null};r?r=r.next=a:(t=r=a,i(e,n))}))},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Mv&&Pv&&(Gv.prototype[Pv]=function(){return this}),Gv.prototype.next=function(e){return this._invoke("next",e)},Gv.prototype.throw=function(e){return this._invoke("throw",e)},Gv.prototype.return=function(e){return this._invoke("return",e)};var Hv=Gv,Qv=function(e){return function(){return new Hv(e.apply(this,arguments))}},Wv=function(e){return new jv(e)},qv=ft,zv=Zu.f("iterator"),Zv=zv,Yv=function(e){var t;if(void 0!==Mv){if(Pv&&null!=(t=e[Pv]))return t.call(e);if(Zv&&null!=(t=qv(e)))return t.call(e)}throw new TypeError("Object is not async iterable")},Kv=function(e,t){var r={},i=!1;function n(r,n){return i=!0,n=new Vv((function(t){t(e[r](n))})),{done:!1,value:t(n)}}return"function"==typeof Mv&&Zv&&(r[Zv]=function(){return this}),r.next=function(e){return i?(i=!1,e):n("next",e)},"function"==typeof e.throw&&(r.throw=function(e){if(i)throw i=!1,e;return n("throw",e)}),"function"==typeof e.return&&(r.return=function(e){return i?(i=!1,e):n("return",e)}),r},$v=i((function(e,t){e.exports=(()=>{var e={8:(e,t,r)=>{r.r(t),r.d(t,{Parser:()=>S,Printer:()=>R,parse:()=>N,print:()=>L});const i="\n",n="".concat("\r").concat(i),o=" ";let s;function a(e){return e>="0"&&e<="9"}function c(e){return e>="!"&&e<="~"}function l(e){return c(e)||e>=""&&e<="ÿ"}function u(e){return"!"===e||e>="#"&&e<="'"||e>="*"&&e<="+"||e>="-"&&e<="."||e>="0"&&e<="9"||e>="A"&&e<="Z"||e>="^"&&e<="~"}function d(e){return e>="1"&&e<="9"}function h(e){return e>="A"&&e<="Z"||e>="a"&&e<="z"}function p(e){return"d"===e||"h"===e||"m"===e||"s"===e}function f(e){return e>""&&e<"\t"||e>"\v"&&e<"\f"||e>""&&e<"ÿ"}function g(e){return h(e)||a(e)||"+"===e||"/"===e}function m(e){return a(e)||h(e)||"+"===e||"/"===e||"-"===e||"_"===e}function _(e){return h(e)||a(e)||"+"===e||"/"===e}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function A(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e){e.VERSION="v",e.ORIGIN="o",e.SESSION_NAME="s",e.INFORMATION="i",e.URI="u",e.EMAIL="e",e.PHONE="p",e.CONNECTION="c",e.BANDWIDTH="b",e.TIME="t",e.REPEAT="r",e.ZONE_ADJUSTMENTS="z",e.KEY="k",e.ATTRIBUTE="a",e.MEDIA="m"}(s||(s={}));class y{consumeText(e,t){let r=t;for(;r<e.length;){const t=e[r];if("\0"===t||"\r"===t||t===i)break;r+=1}if(r-t==0)throw new Error("Invalid text, at ".concat(e));return r}consumeUnicastAddress(e,t,r){return this.consumeTill(e,t,o)}consumeOneOrMore(e,t,r){let i=t;for(;r(e[i]);)i++;if(i-t==0)throw new Error("Invalid rule at ".concat(t,"."));return i}consumeSpace(e,t){if(e[t]===o)return t+1;throw new Error("Invalid space at ".concat(t,"."))}consumeIP4Address(e,t){let r=t;for(let i=0;i<4;i++)if(r=this.consumeDecimalUChar(e,r),3!==i){if("."!==e[r])throw new Error("Invalid IP4 address.");r++}return r}consumeDecimalUChar(e,t){let r=t;for(let n=0;n<3&&a(e[r]);n++,r++);if(r-t==0)throw new Error("Invalid decimal uchar.");const i=parseInt(e.slice(t,r));if(i>=0&&i<=255)return r;throw new Error("Invalid decimal uchar")}consumeIP6Address(e,t){let r=this.consumeHexpart(e,t);return":"===e[r]?(r+=1,r=this.consumeIP4Address(e,r),r):r}consumeHexpart(e,t){let r=t;if(":"===e[r]&&":"===e[r+1]){r+=2;try{r=this.consumeHexseq(e,r)}catch(e){}return r}if(r=this.consumeHexseq(e,r),":"===e[r]&&":"===e[r+1]){r+=2;try{r=this.consumeHexseq(e,r)}catch(e){}return r}return r}consumeHexseq(e,t){let r=t;for(;r=this.consumeHex4(e,r),":"===e[r]&&":"!==e[r+1];)r+=1;return r}consumeHex4(e,t){let r=0;for(;r<4;r++)if(!((i=e[t+r])>="0"&&i<="9"||i>="a"&&i<="f"||i>="A"&&i<="F")){if(0===r)throw new Error("Invalid hex 4");break}var i;return t+r}consumeFQDN(e,t){let r=t;for(;a(e[r])||h(e[r])||"-"===e[r]||"."===e[r];)r+=1;if(r-t<4)throw new Error("Invalid FQDN");return r}consumeExtnAddr(e,t){return this.consumeOneOrMore(e,t,l)}consumeMulticastAddress(e,t,r){switch(r){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(e,t);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(e,t);default:try{return this.consumeFQDN(e,t)}catch(r){return this.consumeExtnAddr(e,t)}}}consumeIP6MulticastAddress(e,t){const r=this.consumeHexpart(e,t);return"/"===e[r]?this.consumeInteger(e,r+1):r}consumeIP4MulticastAddress(e,t){let r=t+3;const i=e.slice(t,r),n=parseInt(i);if(n<224||n>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let o=0;o<3;o++){if("."!==e[r])throw new Error("Invalid IP4 multicast address.");r+=1,r=this.consumeDecimalUChar(e,r)}return"/"===e[r]&&(r+=1),r=this.consumeTTL(e,r),"/"===e[r]&&(r=this.consumeInteger(e,r)),r}consumeInteger(e,t){if(!d(e[t]))throw new Error("Invalid integer.");for(t+=1;a(e[t]);)t+=1;return t}consumeTTL(e,t){if("0"===e[t])return t+1;if(!d(e[t]))throw new Error("Invalid TTL.");t+=1;for(let r=0;r<2&&a(e[t]);r++)t+=1;return t}consumeToken(e,t){return this.consumeOneOrMore(e,t,u)}consumeTime(e,t){let r=t;if("0"===e[r])return r+1;for(d(e[r])&&(r+=1);a(e[r]);)r++;if(r-t<10)throw new Error("Invalid time");return r}consumeAddress(e,t){return this.consumeTill(e,t,o)}consumeTypedTime(e,t){let r=t;return r=this.consumeOneOrMore(e,r,a),p(e[r])?r+1:r}consumeRepeatInterval(e,t){if(!d(e[t]))throw new Error("Invalid repeat interval");for(t+=1;a(e[t]);)t+=1;return p(e[t])&&(t+=1),t}consumePort(e,t){return this.consumeOneOrMore(e,t,a)}consume(e,t,r){for(let i=0;i<r.length;i++){if(t+i>=e.length)throw new Error("consume exceeding value length");if(e[t+i]!==r[i])throw new Error("consume ".concat(r," failed at ").concat(i))}return t+r.length}consumeTill(e,t,r){let i=t;for(;i<e.length&&("string"!=typeof r||e[i]!==r)&&("function"!=typeof r||!r(e[i]));)i++;return i}}class S extends y{constructor(){super(),A(this,"records",[]),A(this,"currentLine",0)}parse(e){const t=this.probeEOL(e);this.records=e.split(t).filter(e=>!!e.trim()).map(this.parseLine),this.currentLine=0;const r=this.parseVersion(),i=this.parseOrigin(),n=this.parseSessionName(),o=this.parseInformation(),s=this.parseUri(),a=this.parseEmail(),c=this.parsePhone(),l=this.parseConnection(),u=this.parseBandWidth(),d=this.parseTimeFields(),h=this.parseKey(),p=this.parseSessionAttribute(),f=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:r,origin:i,sessionName:n,information:o,uri:s,emails:a,phones:c,connection:l,bandwidths:u,timeFields:d,key:h,attributes:p,mediaDescriptions:f}}getCurrentRecord(){const e=this.records[this.currentLine];if(!e)throw new Error("Record doesn't exit.");return e}probeEOL(e){for(let t=0;t<e.length;t++)if(e[t]===i)return"\r"===e[t-1]?n:i;throw new Error("Invalid newline character.")}parseLine(e,t){if(e.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const r=e[0];if("="!==e[1])throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:r,value:e.slice(2),line:t,cur:0}}parseSessionAttribute(){const e=new T;for(;this.currentLine<this.records.length;){const t=this.getCurrentRecord();if(t.type!==s.ATTRIBUTE)break;const r={attField:this.extractOneOrMore(t,e=>u(e)&&":"!==e),_cur:0};":"===t.value[t.cur]&&(t.cur+=1,r.attValue=this.extractOneOrMore(t,f)),e.parse(r),this.currentLine++}return e.digest()}parseMediaAttributes(e){const t=new b(e);for(;this.currentLine<this.records.length;){const e=this.getCurrentRecord();if(e.type!==s.ATTRIBUTE)break;const r={attField:this.extractOneOrMore(e,e=>u(e)&&":"!==e),_cur:0};":"===e.value[e.cur]&&(e.cur+=1,r.attValue=this.extractOneOrMore(e,f)),t.parse(r),this.currentLine++}return t.digest()}parseKey(){const e=this.getCurrentRecord();if(e.type===s.KEY){if("prompt"===e.value||"clear:"===e.value||"base64:"===e.value||"uri:"===e.value)return e.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const e=this.getCurrentRecord();if(e.type===s.ZONE_ADJUSTMENTS){const t=[];for(;;)try{const r=this.extract(e,this.consumeTime);this.consumeSpaceForRecord(e);let i=!1;"-"===e.value[e.cur]&&(i=!0,e.cur+=1);const n=this.extract(e,this.consumeTypedTime);t.push({time:r,typedTime:n,back:i})}catch(e){break}if(0===t.length)throw new Error("Invalid zone adjustments");return this.currentLine++,t}return[]}parseRepeat(){const e=[];for(;;){const t=this.getCurrentRecord();if(t.type!==s.REPEAT)break;{const r=this.extract(t,this.consumeRepeatInterval),i=this.parseTypedTime(t);e.push({repeatInterval:r,typedTimes:i}),this.currentLine++}}return e}parseTypedTime(e){const t=[];for(;;)try{this.consumeSpaceForRecord(e),t.push(this.extract(e,this.consumeTypedTime))}catch(e){break}if(0===t.length)throw new Error("Invalid typed time.");return t}parseTime(){const e=this.getCurrentRecord(),t=this.extract(e,this.consumeTime);this.consumeSpaceForRecord(e);const r=this.extract(e,this.consumeTime);return this.currentLine++,{startTime:t,stopTime:r}}parseBandWidth(){const e=[];for(;this.currentLine<this.records.length;){const t=this.getCurrentRecord();if(t.type!==s.BANDWIDTH)break;{const r=this.extractOneOrMore(t,u);if(":"!==t.value[t.cur])throw new Error("Invalid bandwidth field.");t.cur++;const i=this.extractOneOrMore(t,a);e.push({bwtype:r,bandwidth:i}),this.currentLine++}}return e}parseVersion(){const e=this.getCurrentRecord();if(e.type!==s.VERSION)throw new Error("first sdp record must be version");const t=e.value.slice(0,this.consumeOneOrMore(e.value,0,a));if(t.length!==e.value.length)throw new Error('invalid proto version, "v='.concat(e.value,'"'));return this.currentLine++,t}parseOrigin(){const e=this.getCurrentRecord();if(e.type!==s.ORIGIN)throw new Error("second line of sdp must be origin");const t=this.extractOneOrMore(e,l);this.consumeSpaceForRecord(e);const r=this.extractOneOrMore(e,a);this.consumeSpaceForRecord(e);const i=this.extractOneOrMore(e,a);this.consumeSpaceForRecord(e);const n=this.extractOneOrMore(e,u);this.consumeSpaceForRecord(e);const o=this.extractOneOrMore(e,u);this.consumeSpaceForRecord(e);const c=this.extract(e,this.consumeUnicastAddress);return this.currentLine++,{username:t,sessId:r,sessVersion:i,nettype:n,addrtype:o,unicastAddress:c}}parseSessionName(){const e=this.getCurrentRecord();if(e.type===s.SESSION_NAME){const t=this.extract(e,this.consumeText);return this.currentLine++,t}}parseInformation(){const e=this.getCurrentRecord();if(e.type!==s.INFORMATION)return;const t=this.extract(e,this.consumeText);return this.currentLine++,t}parseUri(){const e=this.getCurrentRecord();if(e.type===s.URI)return this.currentLine++,e.value}parseEmail(){const e=[];for(;;){const t=this.getCurrentRecord();if(t.type!==s.EMAIL)break;e.push(t.value),this.currentLine++}return e}parsePhone(){const e=[];for(;;){const t=this.getCurrentRecord();if(t.type!==s.PHONE)break;e.push(t.value),this.currentLine++}return e}parseConnection(){const e=this.getCurrentRecord();if(e.type===s.CONNECTION){const t=this.extractOneOrMore(e,u);this.consumeSpaceForRecord(e);const r=this.extractOneOrMore(e,u);this.consumeSpaceForRecord(e);const i=this.extract(e,this.consumeAddress);return this.currentLine++,{nettype:t,addrtype:r,address:i}}}parseMedia(){const e=this.getCurrentRecord(),t=this.extract(e,this.consumeToken);this.consumeSpaceForRecord(e);let r=this.extract(e,this.consumePort);"/"===e.value[e.cur]&&(e.cur+=1,r+=this.extract(e,this.consumeInteger)),this.consumeSpaceForRecord(e);const i=[];for(i.push(this.extract(e,this.consumeToken));"/"===e.value[e.cur];)e.cur+=1,i.push(this.extract(e,this.consumeToken));if(0===i.length)throw new Error("Invalid proto");const n=this.parseFmt(e);return this.currentLine++,{mediaType:t,port:r,protos:i,fmts:n}}parseTimeFields(){const e=[];for(;this.getCurrentRecord().type===s.TIME;){const t=this.parseTime(),r=this.parseRepeat(),i=this.parseZone();e.push({time:t,repeats:r,zones:i})}return e}parseMediaDescription(){const e=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===s.MEDIA;){const t=this.parseMedia(),r=this.parseInformation(),i=this.parseConnections(),n=this.parseBandWidth(),o=this.parseKey(),s=this.parseMediaAttributes(t);e.push({media:t,information:r,connections:i,bandwidths:n,key:o,attributes:s})}return e}parseConnections(){const e=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===s.CONNECTION;)e.push(this.parseConnection());return e}parseFmt(e){const t=[];for(;;)try{this.consumeSpaceForRecord(e),t.push(this.extract(e,this.consumeToken))}catch(e){break}if(0===t.length)throw new Error("Invalid fmts");return t}extract(e,t,...r){const i=t.call(this,e.value,e.cur,...r),n=e.value.slice(e.cur,i);return e.cur=i,n}extractOneOrMore(e,t){const r=this.consumeOneOrMore(e.value,e.cur,t),i=e.value.slice(e.cur,r);return e.cur=r,i}consumeSpaceForRecord(e){if(e.value[e.cur]!==o)throw new Error("Invalid space at ".concat(e.cur,"."));e.cur+=1}}class C extends y{constructor(...e){super(...e),A(this,"attributes",void 0),A(this,"digested",!1)}extractOneOrMore(e,t,r){const i=this.consumeOneOrMore(e.attValue,e._cur,t),n=e.attValue.slice(e._cur,i),[o,s]=r||[];if("number"==typeof o&&n.length<o)throw new Error("error in length, should be more or equal than ".concat(o," characters."));if("number"==typeof s&&n.length>s)throw new Error("error in length, should be less or equal than ".concat(s," characters."));return e._cur=i,n}consumeAttributeSpace(e){if(e.attValue[e._cur]!==o)throw new Error("Invalid space at ".concat(e._cur,"."));e._cur+=1}extract(e,t,...r){if(!e.attValue)throw new Error("Nothing to extract from attValue.");const i=t.call(this,e.attValue,e._cur,...r),n=e.attValue.slice(e._cur,i);return e._cur=i,n}atEnd(e){if(!e.attValue)throw new Error;return e._cur>=e.attValue.length}peekChar(e){if(!e.attValue)throw new Error;return e.attValue[e._cur]}peek(e,t){if(!e.attValue)throw new Error;for(let r=0;r<t.length;r++)if(t[r]!==e.attValue[e._cur+r])return!1;return!0}parseIceUfrag(e){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(e,g,[4,256])}parseIcePwd(e){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(e,g,[22,256])}parseIceOptions(e){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const t=[];for(;!this.atEnd(e);){t.push(this.extractOneOrMore(e,g));try{this.consumeAttributeSpace(e)}catch(t){if(this.atEnd(e))break;throw t}}this.attributes.iceOptions=t}parseFingerprint(e){const t=this.extract(e,this.consumeToken);this.consumeAttributeSpace(e);const r=this.extract(e,this.consumeTill);this.attributes.fingerprints.push({hashFunction:t,fingerprint:r})}parseExtmap(e){const t=this.extractOneOrMore(e,a);let r;"/"===this.peekChar(e)&&(this.extract(e,this.consume,"/"),r=this.extract(e,this.consumeToken)),this.consumeAttributeSpace(e);const i=this.extract(e,this.consumeTill,o),n=E(E({entry:parseInt(t,10)},r&&{direction:r}),{},{extensionName:i});this.peekChar(e)===o&&(this.consumeAttributeSpace(e),n.extensionAttributes=this.extract(e,this.consumeTill)),this.attributes.extmaps.push(n)}parseSetup(e){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const t=this.extract(e,this.consumeTill);if("active"!==t&&"passive"!==t&&"actpass"!==t&&"holdconn"!==t)throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=t}}class T extends C{constructor(...e){super(...e),A(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(e){if(this.digested)throw new Error("already digested");try{switch(e.attField){case"group":this.parseGroup(e);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(e);break;case"ice-pwd":this.parseIcePwd(e);break;case"ice-options":this.parseIceOptions(e);break;case"fingerprint":this.parseFingerprint(e);break;case"setup":this.parseSetup(e);break;case"tls-id":this.parseTlsId(e);break;case"identity":this.parseIdentity(e);break;case"extmap":this.parseExtmap(e);break;case"msid-semantic":this.parseMsidSemantic(e);break;default:e.ignored=!0,this.attributes.unrecognized.push(e)}}catch(t){throw console.error("parsing session attribute ".concat(e.attField,' error, "a=').concat(e.attField,":").concat(e.attValue,'"')),t}if(!e.ignored&&e.attValue&&!this.atEnd(e))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(e){const t=this.extract(e,this.consumeToken),r=[];for(;!this.atEnd(e)&&this.peekChar(e)===o;)this.consumeAttributeSpace(e),r.push(this.extract(e,this.consumeToken));this.attributes.groups.push({semantic:t,identificationTag:r})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(e){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(e,m)}parseIdentity(e){const t=this.extractOneOrMore(e,_),r=[];for(;!this.atEnd(e)&&this.peekChar(e)===o;){this.consumeAttributeSpace(e);const t=this.extract(e,this.consumeToken);this.extract(e,this.consume,"=");const i=this.extractOneOrMore(e,e=>e!==o&&f(e));r.push({name:t,value:i})}this.attributes.identities.push({assertionValue:t,extensions:r})}parseMsidSemantic(e){this.peekChar(e)===o&&this.consumeAttributeSpace(e);const t={semantic:this.extract(e,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(e)}catch(e){break}if("*"===this.peekChar(e)){this.extract(e,this.consume,"*"),t.applyForAll=!0;break}{const r=this.extract(e,this.consumeTill,o);t.identifierList.push(r)}}this.attributes.msidSemantic=t}}class b extends C{constructor(e){super(),A(this,"attributes",void 0),-1!==e.protos.indexOf("RTP")||e.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(e){if(this.digested)throw new Error("already digested");try{switch(e.attField){case"extmap":this.parseExtmap(e);break;case"setup":this.parseSetup(e);break;case"ice-ufrag":this.parseIceUfrag(e);break;case"ice-pwd":this.parseIcePwd(e);break;case"ice-options":this.parseIceOptions(e);break;case"candidate":this.parseCandidate(e);break;case"remote-candidate":this.parseRemoteCandidate(e);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(e);break;case"rtpmap":this.parseRtpmap(e);break;case"ptime":this.parsePtime(e);break;case"maxptime":this.parseMaxPtime(e);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(e);break;case"ssrc":this.parseSSRC(e);break;case"fmtp":this.parseFmtp(e);break;case"rtcp-fb":this.parseRtcpFb(e);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(e);break;case"mid":this.parseMid(e);break;case"msid":this.parseMsid(e);break;case"imageattr":this.parseImageAttr(e);break;case"rid":this.parseRid(e);break;case"simulcast":this.parseSimulcast(e);break;case"sctp-port":this.parseSctpPort(e);break;case"max-message-size":this.parseMaxMessageSize(e);break;case"ssrc-group":this.parseSSRCGroup(e);break;default:e.ignored=!0,this.attributes.unrecognized.push(e)}}catch(t){throw console.error("parsing media attribute ".concat(e.attField,' error, "a=').concat(e.attField,":").concat(e.attValue,'"')),t}if(!e.ignored&&e.attValue&&!this.atEnd(e))throw new Error("attribute parsing error")}parseCandidate(e){const t=this.extractOneOrMore(e,g,[1,32]);this.consumeAttributeSpace(e);const r=this.extractOneOrMore(e,a,[1,5]);this.consumeAttributeSpace(e);const i=this.extract(e,this.consumeToken);this.consumeAttributeSpace(e);const n=this.extractOneOrMore(e,a,[1,10]);this.consumeAttributeSpace(e);const s=this.extract(e,this.consumeAddress);this.consumeAttributeSpace(e);const l=this.extract(e,this.consumePort);this.consumeAttributeSpace(e),this.extract(e,this.consume,"typ"),this.consumeAttributeSpace(e);const u={foundation:t,componentId:r,transport:i,priority:n,connectionAddress:s,port:l,type:this.extract(e,this.consumeToken),extension:{}};for(this.peek(e," raddr")&&(this.extract(e,this.consume," raddr"),this.consumeAttributeSpace(e),u.relAddr=this.extract(e,this.consumeAddress)),this.peek(e," rport")&&(this.extract(e,this.consume," rport"),this.consumeAttributeSpace(e),u.relPort=this.extract(e,this.consumePort));this.peekChar(e)===o;){this.consumeAttributeSpace(e);const t=this.extract(e,this.consumeToken);this.consumeAttributeSpace(e),u.extension[t]=this.extractOneOrMore(e,c)}this.attributes.candidates.push(u)}parseRemoteCandidate(e){const t=[];for(;;){const r=this.extractOneOrMore(e,a,[1,5]);this.consumeAttributeSpace(e);const i=this.extract(e,this.consumeAddress);this.consumeAttributeSpace(e);const n=this.extract(e,this.consumePort);t.push({componentId:r,connectionAddress:i,port:n});try{this.consumeAttributeSpace(e)}catch(e){break}}this.attributes.remoteCandidatesList.push(t)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(e){const t=this.extract(e,this.consumeToken);this.consumeAttributeSpace(e);const r=this.extract(e,this.consumeTill,"/");this.extract(e,this.consume,"/");const i={encodingName:r,clockRate:this.extractOneOrMore(e,a)};this.atEnd(e)||"/"!==this.peekChar(e)||(this.extract(e,this.consume,"/"),i.encodingParameters=parseInt(this.extract(e,this.consumeTill),10));const n=this.attributes.payloads.find(e=>e.payloadType===parseInt(t,10));n?n.rtpMap=i:this.attributes.payloads.push({payloadType:parseInt(t,10),rtpMap:i,rtcpFeedbacks:[]})}parsePtime(e){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(e,this.consumeTill)}parseMaxPtime(e){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(e,this.consumeTill)}parseDirection(e){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=e.attField}parseSSRC(e){const t=this.extractOneOrMore(e,a);this.consumeAttributeSpace(e);const r=this.extract(e,this.consumeTill,":");let i;":"===this.peekChar(e)&&(this.extract(e,this.consume,":"),i=this.extract(e,this.consumeTill));const n=this.attributes.ssrcs.find(e=>e.ssrcId===parseInt(t,10));n?n.attributes[r]=i:this.attributes.ssrcs.push({ssrcId:parseInt(t,10),attributes:{[r]:i}})}parseFmtp(e){const t=this.extract(e,this.consumeTill,o);this.consumeAttributeSpace(e);const r=this.extract(e,this.consumeTill),i={};r.split(";").forEach(e=>{let[t,r]=e.split("=");t=t.trim(),r="string"==typeof r?r.trim():r,"string"==typeof t&&t.length>0&&(i[t]=r)});const n=this.attributes.payloads.find(e=>e.payloadType===parseInt(t,10));n?n.fmtp={parameters:i}:this.attributes.payloads.push({payloadType:parseInt(t,10),rtcpFeedbacks:[],fmtp:{parameters:i}})}parseFmtParameters(e){const t={},r=this.extract(e,this.consumeTill,"=");e._cur++;const i=this.extract(e,this.consumeTill,";");for(t[r]=i;";"===e.attValue[e._cur];){const r=this.extract(e,this.consumeTill,"=");e._cur++;const i=this.extract(e,this.consumeTill,";");t[r]=i}return t}parseRtcpFb(e){let t="";t="*"===this.peekChar(e)?this.extract(e,this.consume,"*"):this.extract(e,this.consumeTill,o),this.consumeAttributeSpace(e);const r=this.extract(e,this.consumeTill,o);let i;switch(r){case"trr-int":i={type:r,interval:this.extract(e,this.consumeTill)};break;case"ack":case"nack":default:{const t={type:r};this.peekChar(e)===o&&(this.consumeAttributeSpace(e),t.parameter=this.extract(e,this.consumeToken),this.peekChar(e)===o&&(t.additional=this.extract(e,this.consumeTill))),i=t}}if("*"===t)this.attributes.rtcpFeedbackWildcards.push(i);else{const e=this.attributes.payloads.find(e=>e.payloadType===parseInt(t,10));e?e.rtcpFeedbacks.push(i):this.attributes.payloads.push({payloadType:parseInt(t,10),rtcpFeedbacks:[i]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(e){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const t={port:this.extract(e,this.consumePort)};this.peekChar(e)===o&&(this.consumeAttributeSpace(e),t.netType=this.extractOneOrMore(e,u),this.consumeAttributeSpace(e),t.addressType=this.extractOneOrMore(e,u),this.consumeAttributeSpace(e),t.address=this.extract(e,this.consumeAddress)),this.attributes.rtcp=t}parseMsid(e){const t={id:this.extractOneOrMore(e,u,[1,64])};this.peekChar(e)===o&&(this.consumeAttributeSpace(e),t.appdata=this.extractOneOrMore(e,u,[1,64])),this.attributes.msids.push(t)}parseImageAttr(e){this.attributes.imageattr.push(e.attValue)}parseRid(e){const t=this.extractOneOrMore(e,e=>h(e)||a(e)||"_"===e||"-"===e);this.consumeAttributeSpace(e);const r={id:t,direction:this.extract(e,this.consumeToken),params:[]};if(this.peekChar(e)===o){if(this.consumeAttributeSpace(e),this.peek(e,"pt=")){this.extract(e,this.consume,"pt=");const t=[];for(;;){const r=this.extract(e,this.consumeToken);t.push(r);try{this.extract(e,this.consume,",")}catch(e){break}}r.payloads=t,this.peekChar(e)===o&&this.extract(e,this.consume,o)}for(;;){const t=this.extract(e,this.consumeToken);switch(t){case"depend":{const i={type:t,rids:this.extract(e,this.consume,"=").split(",")};r.params.push(i);break}case"max-width":case"height-width":case"max-fps":case"max-fs":case"max-br":case"max-pps":case"max-bpp":default:{const i={type:t};"="===this.peekChar(e)&&(this.extract(e,this.consume,"="),i.val=this.extract(e,this.consumeTill,";")),r.params.push(i)}}try{this.extract(e,this.consume,";")}catch(e){break}}}this.attributes.rids.push(r)}parseSimulcast(e){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=e.attValue,this.extract(e,this.consumeTill)}parseSctpPort(e){this.attributes.sctpPort=this.extractOneOrMore(e,a,[1,5])}parseMaxMessageSize(e){this.attributes.maxMessageSize=this.extractOneOrMore(e,a,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(e){this.attributes.mid=this.extract(e,this.consumeToken)}parseSSRCGroup(e){const t=this.extract(e,this.consumeToken),r=[];for(;;)try{this.consumeAttributeSpace(e);const t=this.extract(e,this.consumeInteger);r.push(parseInt(t,10))}catch(e){break}this.attributes.ssrcGroups.push({semantic:t,ssrcIds:r})}}function I(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class R{constructor(){I(this,"eol",n)}print(e,t){let r="";return t&&(this.eol=t),r+=this.printVersion(e.version),r+=this.printOrigin(e.origin),r+=this.printSessionName(e.sessionName),r+=this.printInformation(e.information),r+=this.printUri(e.uri),r+=this.printEmail(e.emails),r+=this.printPhone(e.phones),r+=this.printConnection(e.connection),r+=this.printBandwidth(e.bandwidths),r+=this.printTimeFields(e.timeFields),r+=this.printKey(e.key),r+=this.printSessionAttributes(e.attributes),r+=this.printMediaDescription(e.mediaDescriptions),r}printVersion(e){return"v=".concat(e).concat(this.eol)}printOrigin(e){return"o=".concat(e.username," ").concat(e.sessId," ").concat(e.sessVersion," ").concat(e.nettype," ").concat(e.addrtype," ").concat(e.unicastAddress).concat(this.eol)}printSessionName(e){return e?"s=".concat(e).concat(this.eol):""}printInformation(e){return e?"i=".concat(e).concat(this.eol):""}printUri(e){return e?"u=".concat(e).concat(this.eol):""}printEmail(e){let t="";for(const r of e)t+="e=".concat(r).concat(this.eol);return t}printPhone(e){let t="";for(const r of e)t+="e=".concat(r).concat(this.eol);return t}printConnection(e){return e?"c=".concat(e.nettype," ").concat(e.addrtype," ").concat(e.address).concat(this.eol):""}printBandwidth(e){let t="";for(const r of e)t+="b=".concat(r.bwtype,":").concat(r.bandwidth).concat(this.eol);return t}printTimeFields(e){let t="";for(const r of e){t+="t=".concat(r.time.startTime," ").concat(r.time.startTime).concat(this.eol);for(const e of r.repeats)t+="r=".concat(e.repeatInterval," ").concat(e.typedTimes.join(" ")).concat(this.eol);r.zoneAdjustments&&(t+="z=",t+="z=".concat(r.zoneAdjustments.map(e=>"".concat(e.time," ").concat(e.back?"-":""," ").concat(e.typedTime)).join(" ")).concat(this.eol),t+=this.eol)}return t}printKey(e){return e?"k=".concat(e).concat(this.eol):""}printAttributes(e){let t="";for(const r of e)t+="a=".concat(r.attField).concat(r.attValue?":".concat(r.attValue):"").concat(this.eol);return t}printMediaDescription(e){let t="";for(const r of e)t+=this.printMedia(r.media),t+=this.printInformation(r.information),t+=this.printConnections(r.connections),t+=this.printBandwidth(r.bandwidths),t+=this.printKey(r.key),t+=this.printMediaAttributes(r);return t}printConnections(e){let t="";for(const r of e)t+=this.printConnection(r);return t}printMedia(e){return"m=".concat(e.mediaType," ").concat(e.port," ").concat(e.protos.join("/")," ").concat(e.fmts.join(" ")).concat(this.eol)}printSessionAttributes(e){return new k(this.eol).print(e)}printMediaAttributes(e){return new O(this.eol).print(e)}}class w{constructor(e){I(this,"eol",void 0),this.eol=e}printIceUfrag(e){return void 0===e?"":"a=ice-ufrag:".concat(e).concat(this.eol)}printIcePwd(e){return void 0===e?"":"a=ice-pwd:".concat(e).concat(this.eol)}printIceOptions(e){return void 0===e?"":"a=ice-options:".concat(e.join(o)).concat(this.eol)}printFingerprints(e){return e.length>0?e.map(e=>"a=fingerprint:".concat(e.hashFunction).concat(o).concat(e.fingerprint)).join(this.eol)+this.eol:""}printExtmap(e){return e.map(e=>"a=extmap:".concat(e.entry).concat(e.direction?"/".concat(e.direction):"").concat(o).concat(e.extensionName).concat(e.extensionAttributes?"".concat(o).concat(e.extensionAttributes):"").concat(this.eol)).join("")}printSetup(e){return void 0===e?"":"a=setup:".concat(e).concat(this.eol)}printUnrecognized(e){return e.map(e=>"a=".concat(e.attField).concat(e.attValue?":".concat(e.attValue):"").concat(this.eol)).join("")}}class k extends w{print(e){let t="";return t+=this.printGroups(e.groups),t+=this.printMsidSemantic(e.msidSemantic),t+=this.printIceLite(e.iceLite),t+=this.printIceUfrag(e.iceUfrag),t+=this.printIcePwd(e.icePwd),t+=this.printIceOptions(e.iceOptions),t+=this.printFingerprints(e.fingerprints),t+=this.printSetup(e.setup),t+=this.printTlsId(e.tlsId),t+=this.printIdentity(e.identities),t+=this.printExtmap(e.extmaps),t+=this.printUnrecognized(e.unrecognized),t}printGroups(e){let t="";return e.length>0&&(t+=e.map(e=>"a=group:".concat(e.semantic).concat(e.identificationTag.map(e=>"".concat(o).concat(e)).join("")).concat(this.eol)).join("")),t}printIceLite(e){return void 0===e?"":"a=ice-lite"+this.eol}printTlsId(e){return e?"a=tls-id:".concat(e).concat(this.eol):""}printIdentity(e){return 0===e.length?"":e.map(e=>"a=identity:".concat(e.assertionValue).concat(e.extensions.map(e=>"".concat(o).concat(e.name).concat(e.value?"=".concat(e.value):"")))).join(this.eol)+this.eol}printMsidSemantic(e){if(!e)return"";let t="a=msid-semantic:".concat(e.semantic);return e.applyForAll?t+="".concat(o,"*"):e.identifierList.length>0&&(t+=e.identifierList.map(e=>"".concat(o).concat(e))),t+this.eol}}class O extends w{print(e){const t=e.attributes;let r="";return r+=this.printRTCP(t.rtcp),r+=this.printIceUfrag(t.iceUfrag),r+=this.printIcePwd(t.icePwd),r+=this.printIceOptions(t.iceOptions),r+=this.printCandidates(t.candidates),r+=this.printRemoteCandidatesList(t.remoteCandidatesList),r+=this.printEndOfCandidates(t.endOfCandidates),r+=this.printFingerprints(t.fingerprints),r+=this.printSetup(t.setup),r+=this.printMid(t.mid),r+=this.printExtmap(t.extmaps),r+=this.printRTPRelated(t),r+=this.printPtime(t.ptime),r+=this.printMaxPtime(t.maxPtime),r+=this.printDirection(t.direction),r+=this.printSSRCGroups(t.ssrcGroups),r+=this.printSSRC(t.ssrcs),r+=this.printRTCPMux(t.rtcpMux),r+=this.printRTCPMuxOnly(t.rtcpMuxOnly),r+=this.printRTCPRsize(t.rtcpRsize),r+=this.printMSId(t.msids),r+=this.printImageattr(t.imageattr),r+=this.printRid(t.rids),r+=this.printSimulcast(t.simulcast),r+=this.printSCRPPort(t.sctpPort),r+=this.printMaxMessageSize(t.maxMessageSize),r+=this.printUnrecognized(t.unrecognized),r}printCandidates(e){return e.map(e=>"a=candidate:".concat(e.foundation).concat(o).concat(e.componentId).concat(o).concat(e.transport).concat(o).concat(e.priority).concat(o).concat(e.connectionAddress).concat(o).concat(e.port).concat(o,"typ").concat(o).concat(e.type).concat(e.relAddr?"".concat(o,"raddr").concat(o).concat(e.relAddr):"").concat(e.relPort?"".concat(o,"rport").concat(o).concat(e.relPort):"").concat(Object.keys(e.extension).map(t=>"".concat(o).concat(t).concat(o).concat(e.extension[t])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(e){return e.map(e=>"a=remote-candidates:".concat(e.join(o)).concat(this.eol)).join("")}printEndOfCandidates(e){return void 0===e?"":"a=end-of-candidates"+this.eol}printRTPRelated(e){if(!e.payloads)return"";const t=e.payloads;let r="";r+=e.rtcpFeedbackWildcards.map(e=>this.printRTCPFeedback("*",e)).join("");for(const i of t)r+=this.printRtpMap(i.payloadType,i.rtpMap),r+=this.printFmtp(i.payloadType,i.fmtp),r+=i.rtcpFeedbacks.map(e=>this.printRTCPFeedback(i.payloadType,e)).join("");return r}printFmtp(e,t){if(!t)return"";const r=Object.keys(t.parameters);return 1===r.length&&void 0===t.parameters[r[0]]?"a=fmtp:".concat(e).concat(o).concat(r[0]).concat(this.eol):"a=fmtp:".concat(e).concat(o).concat(Object.keys(t.parameters).map(e=>"".concat(e,"=").concat(t.parameters[e])).join(";")).concat(this.eol)}printRtpMap(e,t){return t?"a=rtpmap:".concat(e).concat(o).concat(t.encodingName,"/").concat(t.clockRate).concat(t.encodingParameters?"/".concat(t.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(e,t){let r="a=rtcp-fb:".concat(e).concat(o),i=t;switch(i.type){case"trr-int":r+="ttr-int".concat(o).concat(i.interval);break;case"ack":case"nack":default:i=i,r+="".concat(i.type),i.parameter&&(r+="".concat(o).concat(i.parameter),i.additional&&(r+="".concat(o).concat(i.additional)))}return r+this.eol}printPtime(e){return void 0===e?"":"a=ptime:".concat(e).concat(this.eol)}printMaxPtime(e){return void 0===e?"":"a=maxptime:".concat(e).concat(this.eol)}printDirection(e){return void 0===e?"":"a=".concat(e).concat(this.eol)}printSSRC(e){return e.map(e=>Object.keys(e.attributes).map(t=>"a=ssrc:".concat(e.ssrcId.toString(10)).concat(o).concat(t).concat(e.attributes[t]?":".concat(e.attributes[t]):"").concat(this.eol)).join("")).join("")}printRTCPMux(e){return void 0===e?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(e){return void 0===e?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(e){return void 0===e?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(e){if(void 0===e)return"";let t="a=rtcp:".concat(e.port);return e.netType&&(t+="".concat(o).concat(e.netType)),e.addressType&&(t+="".concat(o).concat(e.addressType)),e.address&&(t+="".concat(o).concat(e.address)),t+this.eol}printMSId(e){return e.map(e=>"a=msid:".concat(e.id).concat(e.appdata?"".concat(o).concat(e.appdata):"").concat(this.eol)).join("")}printImageattr(e){return e.map(e=>"a=imageattr:".concat(e).concat(this.eol)).join("")}printRid(e){return e.map(e=>{let t="a=rid:".concat(e.id).concat(o).concat(e.direction);return e.payloads&&(t+="".concat(o,"pt=").concat(e.payloads.join(","))),e.params.length>0&&(t+="".concat(o).concat(e.params.map(e=>"depend"===e.type?"depend=".concat(e.rids.join(",")):"".concat(e.type,"=").concat(e.val)).join(";"))),t+this.eol}).join("")}printSimulcast(e){return void 0===e?"":"a=simulcast:".concat(e).concat(this.eol)}printSCRPPort(e){return void 0===e?"":"a=sctp-port:".concat(e).concat(this.eol)}printMaxMessageSize(e){return void 0===e?"":"a=max-message-size:".concat(e)}printMid(e){return void 0===e?"":"a=mid:".concat(e).concat(this.eol)}printSSRCGroups(e){return e.map(e=>"a=ssrc-group:".concat(e.semantic).concat(e.ssrcIds.map(e=>"".concat(o).concat(e.toString(10))).join("")).concat(this.eol)).join("")}}function N(e){return(new S).parse(e)}function L(e,t){return(new R).print(e,t)}}},t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={exports:{}};return e[i](n,n.exports,r),n.exports}return r.d=(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(8)})()}));function Jv(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function Xv(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=Jv(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=Jv(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}function eE(e,t,r,i,n){var o;let s=[],a=[],c=[],l=[],u=!1,d=!1;const h=$v.parse(e);if(Jr(o=h.mediaDescriptions).call(o,e=>{"video"!==e.media.mediaType||u||(a=e.attributes.payloads,l=e.attributes.extmaps,u=!0),"audio"!==e.media.mediaType||d||(s=e.attributes.payloads,c=e.attributes.extmaps,d=!0)}),!l||0===a.length)throw new Error("Cannot get video capabilities from SDP.");if(!c||0===s.length)throw new Error("Cannot get audio capabilities from SDP.");return Jr(a).call(a,e=>{var t;null!==(t=e.rtpMap)&&void 0!==t&&t.clockRate&&(e.rtpMap.clockRate=Si(e.rtpMap.clockRate))}),Jr(s).call(s,e=>{var t;null!==(t=e.rtpMap)&&void 0!==t&&t.clockRate&&(e.rtpMap.clockRate=Si(e.rtpMap.clockRate))}),t&&(s=ji(s).call(s,e=>{var t;return"rtx"!==(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())}),a=ji(a).call(a,e=>{var t;return"rtx"!==(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())})),r&&(a=ji(a).call(a,e=>{var t;return!/(red)|(ulpfec)|(flexfec)/i.test((null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName)||"")})),i&&(null==i?void 0:i.length)>0&&(s=ji(s).call(s,e=>{var t;return is(i).call(i,(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())||"")})),n&&(null==n?void 0:n.length)>0&&(a=ji(a).call(a,e=>{var t;return is(n).call(n,(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())||"")})),{audioCodecs:s,videoCodecs:a,audioExtensions:c,videoExtensions:l}}function tE(e){const t=$v.parse(e);let r,i;for(const n of t.mediaDescriptions){if(!r){const e=n.attributes.iceUfrag,t=n.attributes.icePwd;if(!e||!t)throw new Error("Cannot get iceUfrag or icePwd from SDP.");r={iceUfrag:e,icePwd:t}}if(!i){const e=n.attributes.fingerprints;e.length>0&&(i={fingerprints:e})}}if(!i&&t.attributes.fingerprints.length>0&&(i={fingerprints:t.attributes.fingerprints}),!i||!r)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:r,dtlsParameters:i}}function rE(e){var t,r,i;const{dtls:n,ice:o,rtpCapabilities:s,cname:a}=e,{candidates:c,defaultIp:l,defaultPort:u}=cE(o.candidates),d={fingerprints:vo(t=n.fingerprints).call(t,e=>({hashFunction:e.algorithm,fingerprint:e.fingerprint}))},h={iceUfrag:o.iceUfrag,icePwd:o.icePwd};let p;switch(n.role){case"server":p="passive";break;case"client":p="active";break;case"auto":p="actpass"}return Jr(r=s.audioCodecs).call(r,e=>{hl(e.rtcpFeedbacks)||(e.rtcpFeedbacks=[])}),Jr(i=s.videoCodecs).call(i,e=>{hl(e.rtcpFeedbacks)||(e.rtcpFeedbacks=[])}),s.audioExtensions||(s.audioExtensions=[]),s.videoExtensions||(s.videoExtensions=[]),{dtlsParameters:d,iceParameters:h,candidates:c,rtpCapabilities:s,setup:p,cname:a,defaultIp:l,defaultPort:u}}function iE(e,t,r){const i=[],n=[];return Jr(e).call(e,({ssrcId:e,rtx:o})=>{var s;const a=kp(8,"track-"),c={ssrcId:e,attributes:Xv({label:a,mslabel:r=r||kp(10,""),msid:Je(s="".concat(r," ")).call(s,a)},t&&{cname:t})};if(i.push(c),void 0!==o){var l;const s={ssrcId:o,attributes:Xv({label:a,mslabel:r,msid:Je(l="".concat(r," ")).call(l,a)},t&&{cname:t})};i.push(s),n.push({semantic:"FID",ssrcIds:[e,o]})}}),e.length>1&&n.push({semantic:"SIM",ssrcIds:vo(e).call(e,({ssrcId:e})=>e)}),{ssrcs:i,ssrcGroups:n}}function nE(e,t){var r;t instanceof jh&&Jr(r=e.attributes.payloads).call(r,e=>{var r;if("opus"!==(null===(r=e.rtpMap)||void 0===r?void 0:r.encodingName.toLowerCase()))return;e.fmtp||(e.fmtp={parameters:{}}),e.fmtp.parameters.minptime="10",e.fmtp.parameters.useinbandfec="1";const i=t._encoderConfig;i&&(i.bitrate&&!Ia()&&(e.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*i.bitrate))),i.sampleRate&&(e.fmtp.parameters.maxplaybackrate="".concat(i.sampleRate),e.fmtp.parameters["sprop-maxcapturerate"]="".concat(i.sampleRate)),i.stereo&&(e.fmtp.parameters.stereo="1",e.fmtp.parameters["sprop-stereo"]="1"))})}function oE(e){var t;const r=Lv(t=e.attributes.unrecognized).call(t,e=>"x-google-flag"===e.attField&&"conference"===e.attValue);var i;-1!==r&&bo(i=e.attributes.unrecognized).call(i,r,1)}function sE(e,t){var r,i;if(!(t instanceof Tv&&t._encoderConfig&&-1===Lo(r=t._hints).call(r,Eu.SCREEN_TRACK)))return;const n=t._encoderConfig;var o,s;Fu().supportMinBitrate&&n.bitrateMin&&Jr(o=e.attributes.payloads).call(o,e=>{var t,r;is(t=["h264","vp8","vp9","av1"]).call(t,(null===(r=e.rtpMap)||void 0===r?void 0:r.encodingName.toLowerCase())||"")&&(e.fmtp||(e.fmtp={parameters:{}}),e.fmtp.parameters["x-google-min-bitrate"]="".concat(n.bitrateMin))}),Fu().supportMinBitrate&&!is(i=t._hints).call(i,Eu.LOW_STREAM)&&n.bitrateMax&&Jr(s=e.attributes.payloads).call(s,e=>{var t,r;is(t=["h264","vp8","vp9","av1"]).call(t,(null===(r=e.rtpMap)||void 0===r?void 0:r.encodingName.toLowerCase())||"")&&(e.fmtp||(e.fmtp={parameters:{}}),e.fmtp.parameters["x-google-start-bitrate"]="".concat(Math.floor(n.bitrateMax)))})}function aE(e,t,r){if(!t)return;let i,n;if("video"===e.media.mediaType?(i=r.videoExtensions,n=r.videoCodecs):(i=r.audioExtensions,n=r.audioCodecs),!0===t.tcc){const t=Qo(i).call(i,e=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e.extensionName);if(t){var o;Qo(o=e.attributes.extmaps).call(o,e=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e.extensionName)||e.attributes.extmaps.push({entry:t.entry,extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"});const r=function(e,t){return ji(t).call(t,t=>!!Qo(e).call(e,e=>{var r;return e.payloadType===t.payloadType&&!!Qo(r=e.rtcpFeedbacks).call(r,e=>"transport-cc"===e.type)}))}(n,e.attributes.payloads);Jr(r).call(r,e=>{var t;Qo(t=e.rtcpFeedbacks).call(t,e=>"transport-cc"===e.type)||e.rtcpFeedbacks.push({type:"transport-cc"})})}}else if(!1===t.tcc){var s,a;const t=Lv(s=e.attributes.extmaps).call(s,e=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e.extensionName);var c;-1!==t&&bo(c=e.attributes.extmaps).call(c,t,1),Jr(a=e.attributes.payloads).call(a,e=>{var t;const r=Lv(t=e.rtcpFeedbacks).call(t,e=>"transport-cc"===e.type);var i;-1!==r&&bo(i=e.rtcpFeedbacks).call(i,r,1)})}if(!0===t.remb){const t=Qo(i).call(i,e=>"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===e.extensionName);if(t){var l;Qo(l=e.attributes.extmaps).call(l,e=>"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===e.extensionName)||e.attributes.extmaps.push({entry:t.entry,extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"});const r=function(e,t){return ji(t).call(t,t=>!!Qo(e).call(e,e=>{var r;return e.payloadType===t.payloadType&&!!Qo(r=e.rtcpFeedbacks).call(r,e=>"goog-remb"===e.type)}))}(n,e.attributes.payloads);Jr(r).call(r,e=>{var t;Qo(t=e.rtcpFeedbacks).call(t,e=>"goog-remb"===e.type)||e.rtcpFeedbacks.push({type:"goog-remb"})})}}else if(!1===t.remb){var u,d;const t=Lv(u=e.attributes.extmaps).call(u,e=>"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===e.extensionName);var h;-1!==t&&bo(h=e.attributes.extmaps).call(h,t,1),Jr(d=e.attributes.payloads).call(d,e=>{var t;const r=Lv(t=e.rtcpFeedbacks).call(t,e=>"goog-remb"===e.type);var i;-1!==r&&bo(i=e.rtcpFeedbacks).call(i,r,1)})}}function cE(e){var t;const r=[];Jr(e).call(e,e=>{const t={foundation:e.foundation,componentId:"1",transport:e.protocol,priority:e.priority.toString(),connectionAddress:e.ip,port:e.port.toString(),type:e.type,extension:{}};r.push(t),r.push(Xv({},t,{componentId:"2"}))});const i=r[0].connectionAddress||"0.0.0.0",n=r[0].port||"9";return Rc.debug(Je(t="choose highest priority candidate IP:port ".concat(i,":")).call(t,n," as default ICE connection address")),{candidates:r,defaultIp:i,defaultPort:n}}class lE{constructor(e){e=jp(e);const{remoteIceParameters:t,remoteDtlsParameters:r,candidates:i,remoteRTPCapabilities:n,remoteSetup:o,localCapabilities:s,sdkCodec:a,cname:c,ip:l,port:u}=e,d=$v.parse("v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE audio video\na=msid-semantic: WMS\na=ice-lite\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendrecv\na=rtcp-mux\na=rtcp-rsize\na=mid:audio\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendrecv\na=rtcp-mux\na=rtcp-rsize\na=mid:video\n");this.rtpCapabilities=n,this.candidates=i,this.iceParameters=t,this.dtlsParameters=r,this.setup=o,this.localCapabilities=s,this.cname=c,this.ip=l,this.port=u,this.addressType=-1===Lo(l).call(l,":")?"IP4":"IP6";for(let m=0;m<d.mediaDescriptions.length;m++){var h;const e=d.mediaDescriptions[m];if(e.media.port=this.port,Jr(h=e.connections).call(h,e=>{e.address=this.ip,e.addrtype=this.addressType}),e.attributes.rtcp?(e.attributes.rtcp.address=this.ip,e.attributes.rtcp.port=this.port,e.attributes.rtcp.addressType=this.addressType):e.attributes.rtcp={port:u,address:l,netType:"IN",addressType:this.addressType},e.attributes.iceUfrag=t.iceUfrag,e.attributes.icePwd=t.icePwd,e.attributes.fingerprints=r.fingerprints,e.attributes.candidates=i,e.attributes.setup=o,"video"===e.media.mediaType){var p,f;e.media.fmts=vo(p=n.videoCodecs).call(p,e=>e.payloadType.toString(10));const t=ji(f=n.videoCodecs).call(f,e=>{var t,r;return null===(t=e.rtpMap)||void 0===t?void 0:is(r=t.encodingName.toLowerCase()).call(r,a)});if(0===t.length)throw new Error("Codec ".concat(a," not supported by remote SDP."));e.attributes.payloads=t,e.attributes.extmaps=n.videoExtensions}var g;"audio"===e.media.mediaType&&(e.media.fmts=vo(g=n.audioCodecs).call(g,e=>e.payloadType.toString(10)),e.attributes.payloads=n.audioCodecs,e.attributes.extmaps=n.audioExtensions),d.mediaDescriptions[m]=this.mungMediaDesc(e)}this.sessionDesc=d,this.currentMidIndex=d.mediaDescriptions.length-1}toString(){return $v.print(this.sessionDesc)}send(e,t,r){var i,n,o;const{ssrcs:s,ssrcGroups:a}=iE(t,this.cname),c=Qo(i=this.sessionDesc.mediaDescriptions).call(i,t=>e===ku.VIDEO?"video"===t.media.mediaType:"audio"===t.media.mediaType),l=s[0].attributes.label,u=s[0].attributes.mslabel;return c.attributes.ssrcs=Je(n=c.attributes.ssrcs).call(n,s),c.attributes.ssrcGroups=Je(o=c.attributes.ssrcGroups).call(o,a),{id:l,mslabel:u}}stopSending(e){var t;Jr(t=this.sessionDesc.mediaDescriptions).call(t,t=>{var r,i;const n=[],o=[],s=[];Jr(r=t.attributes.ssrcs).call(r,t=>{is(e).call(e,t.attributes.label||"")?s.push(t):n.push(t)}),Jr(i=t.attributes.ssrcGroups).call(i,e=>{var t;is(t=vo(s).call(s,e=>e.ssrcId)).call(t,e.ssrcIds[0])||o.push(e)}),t.attributes.ssrcs=n,t.attributes.ssrcGroups=o})}mute(e){var t;const r=Qo(t=this.sessionDesc.mediaDescriptions).call(t,t=>t.attributes.mid===e);if(!r)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.mute."));r.attributes.direction="inactive"}unmute(e){var t;const r=Qo(t=this.sessionDesc.mediaDescriptions).call(t,t=>t.attributes.mid===e);if(!r)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.unmute."));r.attributes.direction="sendonly"}receive(e,t,r){Jr(e).call(e,(e,t)=>{var r;const i=e._mediaStreamTrack,n=Lv(r=this.sessionDesc.mediaDescriptions).call(r,e=>e.attributes.mid===i.kind),o=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[n],e);this.sessionDesc.mediaDescriptions[n]=o})}stopReceiving(e){}restartICE(e,t,r,i){var n;e=jp(e),t=jp(t),this.iceParameters=e,this.candidates=t,this.ip=r,this.port=i,this.addressType=-1===Lo(r).call(r,":")?"IP4":"IP6",Jr(n=this.sessionDesc.mediaDescriptions).call(n,t=>{var n;t.media.port=this.port,Jr(n=t.connections).call(n,e=>{e.address=r,e.addrtype=this.addressType}),t.attributes.rtcp?(t.attributes.rtcp.address=this.ip,t.attributes.rtcp.port=this.port,t.attributes.rtcp.addressType=this.addressType):t.attributes.rtcp={port:i,address:r,netType:"IN",addressType:this.addressType},t.attributes.iceUfrag=e.iceUfrag,t.attributes.icePwd=e.icePwd,t.attributes.candidates=this.candidates})}predictReceivingMids(e){const t=[];for(let r=0;r<e;r++)t.push((this.currentMidIndex+r+1).toString(10));return t}mungRecvMediaDsec(e,t){const r=jp(e);return nE(r,t),sE(r,t),r}updateRecvMedia(e,t){var r;const i=Lv(r=this.sessionDesc.mediaDescriptions).call(r,t=>t.attributes.mid===e);if(-1!==i){const e=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[i],t);this.sessionDesc.mediaDescriptions[i]=e}}bumpMid(e){this.currentMidIndex+=e}updateTrackLabel(e,t,r){var i;const n=Qo(i=this.sessionDesc.mediaDescriptions).call(i,t=>e===ku.VIDEO?"video"===t.attributes.mid:"audio"===t.attributes.mid);if(n){var o;const e=Qo(o=n.attributes.ssrcs).call(o,e=>e.attributes.label===t);var s;e&&(e.attributes.label=r,null===(s=e.attributes.msid)||void 0===s||s.replace(t,r))}}mungMediaDesc(e){const t=jp(e);return oE(t),function(e){var t,r;const i=Qo(t=e.attributes.extmaps).call(t,e=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e.extensionName);var n,o;i&&bo(n=e.attributes.extmaps).call(n,Lo(o=e.attributes.extmaps).call(o,i),1),Jr(r=e.attributes.payloads).call(r,e=>{var t;const r=Lv(t=e.rtcpFeedbacks).call(t,e=>"transport-cc"===e.type);var i;-1!==r&&bo(i=e.rtcpFeedbacks).call(i,r,1)})}(t),t}}function uE(e){if(Array.isArray(e))return e.map((function(e){return e}));if(!dE(e))return e;var t={};for(var r in e)dE(e[r])||Array.isArray(e[r])?t[r]=uE(e[r]):t[r]=e[r];return t}function dE(e){return!("object"!=typeof e||Array.isArray(e)||!e)}var hE=function(){function e(e){this.input=[],this.size=e}return e.prototype.add=function(e){this.input.push(e),this.input.length>this.size&&this.input.splice(0,1)},e.prototype.diffMean=function(){return 0===this.input.length?0:(this.input[this.input.length-1]-this.input[0])/this.input.length},e}(),pE=function(e,t){return(pE=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0

	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.

	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */function fE(e,t){function r(){this.constructor=e}pE(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var gE=function(){return(gE=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function mE(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(s,a)}c((i=i.apply(e,t||[])).next())}))}function _E(e,t){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(n=s.trys,!((n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}var vE,EE={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[]},AE={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0},yE={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0},SE={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0},CE={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0},TE=function(){function e(e,t){var r=this;this.videoIsReady=!1,this.videoIsReady2={},this.stats=uE(EE),this.isFirstVideoReceived={},this.isFirstVideoDecoded={},this.isFirstAudioReceived={},this.isFirstAudioDecoded={},this.lossRateWindowStats=[],this.pc=e,this.options=t,this.intervalTimer=window.setInterval((function(){return mE(r,void 0,void 0,(function(){return _E(this,(function(e){return this.updateStats(),[2]}))}))}),this.options.updateInterval)}return e.prototype.getStats=function(){return this.stats},e.prototype.setVideoIsReady=function(e){this.videoIsReady=e},e.prototype.setVideoIsReady2=function(e,t){this.videoIsReady2[e]=t},e.prototype.getVideoIsReady=function(e){return this.videoIsReady2[e]||!1},e.prototype.setIsFirstAudioDecoded=function(e){},e.prototype.destroy=function(){window.clearInterval(this.intervalTimer),this.pc=void 0},e.prototype.calcLossRate=function(e){var t=this;this.lossRateWindowStats.push(e),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);for(var r=this.lossRateWindowStats.length,i=0,n=0,o=0,s=0,a=function(a){e[a].forEach((function(e,c){if(t.lossRateWindowStats[r-1][a][c]&&t.lossRateWindowStats[0][a][c]){var l=t.lossRateWindowStats[r-1][a][c].packets-t.lossRateWindowStats[0][a][c].packets,u=t.lossRateWindowStats[r-1][a][c].packetsLost-t.lossRateWindowStats[0][a][c].packetsLost;"videoSend"===a||"audioSend"===a?(i+=l,o+=u):(n+=l,s+=u),Number.isNaN(l)||Number.isNaN(l)?e.packetLostRate=0:e.packetLostRate=l<=0||u<=0?0:u/(l+u)}}))},c=0,l=["videoSend","audioSend","videoRecv","audioRecv"];c<l.length;c++)a(l[c]);e.sendPacketLossRate=i<=0||o<=0?0:o/(i+o),e.recvPacketLossRate=n<=0||s<=0?0:s/(n+s)},e}(),bE=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._stats=EE,t.lastDecodeVideoReceiverStats=new Map,t}return fE(t,e),t.prototype.updateStats=function(){return mE(this,void 0,void 0,(function(){var e,t,r,i;return _E(this,(function(n){switch(n.label){case 0:return[4,this._getStats()];case 1:return e=n.sent(),t=this.statsResponsesToObjects(e),this._stats=uE(EE),r=t.filter((function(e){return"ssrc"===e.type})),this.processSSRCStats(r),(i=t.find((function(e){return"VideoBwe"===e.type})))&&this.processBandwidthStats(i),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats,[2]}}))}))},t.prototype.processBandwidthStats=function(e){this._stats.bitrate={actualEncoded:Number(e.googActualEncBitrate),targetEncoded:Number(e.googTargetEncBitrate),retransmit:Number(e.googRetransmitBitrate),transmit:Number(e.googTransmitBitrate)},this._stats.sendBandwidth=Number(e.googAvailableSendBandwidth)},t.prototype.processSSRCStats=function(e){var t=this;e.forEach((function(e){var r=e.id.includes("send");switch(e.mediaType+"_"+(r?"send":"recv")){case"video_send":var i=uE(yE);i.codec=e.googCodecName,i.adaptionChangeReason="none",e.googCpuLimitedResolution&&(i.adaptionChangeReason="cpu"),e.googBandwidthLimitedResolution&&(i.adaptionChangeReason="bandwidth"),i.avgEncodeMs=Number(e.googAvgEncodeMs),i.inputFrame={width:Number(e.googFrameWidthInput)||Number(e.googFrameWidthSent),height:Number(e.googFrameHeightInput)||Number(e.googFrameHeightSent),frameRate:Number(e.googFrameRateInput)},i.sentFrame={width:Number(e.googFrameWidthSent),height:Number(e.googFrameHeightSent),frameRate:Number(e.googFrameRateInput)},i.firsCount=Number(e.googFirReceived),i.nacksCount=Number(e.googNacksReceived),i.plisCount=Number(e.googPlisReceived),i.frameCount=Number(e.framesEncoded),i.bytes=Number(e.bytesSent),i.packets=Number(e.packetsSent),i.packetsLost=Number(e.packetsLost),i.ssrc=Number(e.ssrc),i.rttMs=Number(e.googRtt||0),t._stats.videoSend.push(i),t._stats.rtt=i.rttMs;break;case"video_recv":var n=uE(AE),o=t.lastDecodeVideoReceiverStats.get(Number(e.ssrc));if(n.codec=e.googCodecName,n.targetDelayMs=Number(e.googTargetDelayMs),n.renderDelayMs=Number(e.googRenderDelayMs),n.currentDelayMs=Number(e.googCurrentDelayMs),n.minPlayoutDelayMs=Number(e.googMinPlayoutDelayMs),n.decodeMs=Number(e.googDecodeMs),n.maxDecodeMs=Number(e.googMaxDecodeMs),n.receivedFrame={width:Number(e.googFrameWidthReceived),height:Number(e.googFrameHeightReceived),frameRate:Number(e.googFrameRateReceived)},n.decodedFrame={width:Number(e.googFrameWidthReceived),height:Number(e.googFrameHeightReceived),frameRate:Number(e.googFrameRateDecoded)},n.outputFrame={width:Number(e.googFrameWidthReceived),height:Number(e.googFrameHeightReceived),frameRate:Number(e.googFrameRateOutput)},n.jitterBufferMs=Number(e.googJitterBufferMs),n.firsCount=Number(e.googFirsSent),n.nacksCount=Number(e.googNacksSent),n.plisCount=Number(e.googPlisSent),n.framesDecodeCount=Number(e.framesDecoded),n.bytes=Number(e.bytesReceived),n.packets=Number(e.packetsReceived),n.packetsLost=Number(e.packetsLost),n.ssrc=Number(e.ssrc),n.packets>0&&!t.isFirstVideoReceived[n.ssrc]&&(t.onFirstVideoReceived&&t.onFirstVideoReceived(n.ssrc),t.isFirstVideoReceived[n.ssrc]=!0),n.framesDecodeCount>0&&!t.isFirstVideoDecoded[n.ssrc]&&(t.onFirstVideoDecoded&&t.onFirstVideoDecoded(n.ssrc,n.decodedFrame.width,n.decodedFrame.height),t.isFirstVideoDecoded[n.ssrc]=!0),o){var s=o.stats,a=Date.now()-o.lts;n.framesDecodeFreezeTime=s.framesDecodeFreezeTime,n.framesDecodeInterval=s.framesDecodeInterval,n.framesDecodeCount>s.framesDecodeCount&&t.isFirstVideoDecoded?(o.lts=Date.now(),n.framesDecodeInterval=a,n.framesDecodeInterval>=t.options.freezeRateLimit&&(t.getVideoIsReady(parseInt(e.ssrc,10))?n.framesDecodeFreezeTime+=n.framesDecodeInterval:t.setVideoIsReady2(parseInt(e.ssrc,10),!0))):n.framesDecodeCount<o.stats.framesDecodeCount&&(n.framesDecodeInterval=0)}t.lastDecodeVideoReceiverStats.set(n.ssrc,{stats:gE({},n),lts:Date.now()}),t._stats.videoRecv.push(n);break;case"audio_recv":var c=uE(CE);c.codec=e.googCodecName,c.outputLevel=Math.abs(Number(e.audioOutputLevel))/32767,c.decodingCNG=Number(e.googDecodingCNG),c.decodingCTN=Number(e.googDecodingCTN),c.decodingCTSG=Number(e.googDecodingCTSG),c.decodingNormal=Number(e.googDecodingNormal),c.decodingPLC=Number(e.googDecodingPLC),c.decodingPLCCNG=Number(e.googDecodingPLCCNG),c.expandRate=Number(e.googExpandRate),c.accelerateRate=Number(e.googAccelerateRate),c.preemptiveExpandRate=Number(e.googPreemptiveExpandRate),c.secondaryDecodedRate=Number(e.googSecondaryDecodedRate),c.speechExpandRate=Number(e.googSpeechExpandRate),c.preferredJitterBufferMs=Number(e.googPreferredJitterBufferMs),c.jitterBufferMs=Number(e.googJitterBufferMs),c.jitterMs=Number(e.googJitterReceived),c.bytes=Number(e.bytesReceived),c.packets=Number(e.packetsReceived),c.packetsLost=Number(e.packetsLost),c.ssrc=Number(e.ssrc),c.receivedFrames=Number(e.googDecodingCTN)||Number(e.packetsReceived),c.droppedFrames=Number(e.googDecodingPLC)+Number(e.googDecodingPLCCNG)||Number(e.packetsLost),c.receivedFrames>0&&!t.isFirstAudioReceived[c.ssrc]&&(t.onFirstAudioReceived&&t.onFirstAudioReceived(c.ssrc),t.isFirstAudioReceived[c.ssrc]=!0),c.decodingNormal>0&&!t.isFirstAudioDecoded[c.ssrc]&&(t.onFirstAudioDecoded&&t.onFirstAudioDecoded(c.ssrc),t.isFirstAudioDecoded[c.ssrc]=!0),t._stats.audioRecv.push(c);break;case"audio_send":var l=uE(SE);l.codec=e.googCodecName,l.inputLevel=Math.abs(Number(e.audioInputLevel))/32767,l.aecReturnLoss=Number(e.googEchoCancellationReturnLoss||0),l.aecReturnLossEnhancement=Number(e.googEchoCancellationReturnLossEnhancement||0),l.residualEchoLikelihood=Number(e.googResidualEchoLikelihood||0),l.residualEchoLikelihoodRecentMax=Number(e.googResidualEchoLikelihoodRecentMax||0),l.bytes=Number(e.bytesSent),l.packets=Number(e.packetsSent),l.packetsLost=Number(e.packetsLost),l.ssrc=Number(e.ssrc),l.rttMs=Number(e.googRtt||0),t._stats.rtt=l.rttMs,t._stats.audioSend.push(l)}}))},t.prototype._getStats=function(){var e=this;return new Promise((function(t,r){e.pc.getStats(t,r)}))},t.prototype.statsResponsesToObjects=function(e){var t=[];return e.result().forEach((function(e){var r={id:e.id,timestamp:e.timestamp.valueOf().toString(),type:e.type};e.names().forEach((function(t){r[t]=e.stat(t)})),t.push(r)})),t},t}(TE);!function(e){e.CERTIFICATE="certificate",e.CODEC="codec",e.CANDIDATE_PAIR="candidate-pair",e.LOCAL_CANDIDATE="local-candidate",e.REMOTE_CANDIDATE="remote-candidate",e.INBOUND="inbound-rtp",e.TRACK="track",e.OUTBOUND="outbound-rtp",e.PC="peer-connection",e.REMOTE_INBOUND="remote-inbound-rtp",e.REMOTE_OUTBOUND="remote-outbound-rtp",e.TRANSPORT="transport",e.CSRC="csrc",e.DATA_CHANNEL="data-channel",e.STREAM="stream",e.SENDER="sender",e.RECEIVER="receiver"}(vE||(vE={}));var IE=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._stats=EE,t.lastDecodeVideoReceiverStats=new Map,t.lastVideoFramesRecv=new Map,t.lastVideoFramesSent=new Map,t.lastVideoFramesDecode=new Map,t.lastVideoJBDelay=new Map,t.lastAudioJBDelay=new Map,t.mediaBytesSent=new Map,t.mediaBytesRetransmit=new Map,t.mediaBytesTargetEncode=new Map,t.lastEncoderMs=new Map,t}return fE(t,e),t.prototype.updateStats=function(){return mE(this,void 0,void 0,(function(){var e,t=this;return _E(this,(function(r){switch(r.label){case 0:return e=this,[4,this.pc.getStats()];case 1:return e.report=r.sent(),this._stats=uE(EE),this.report.forEach((function(e){switch(e.type){case vE.OUTBOUND:"audio"===e.mediaType?t.processAudioOutboundStats(e):"video"===e.mediaType&&t.processVideoOutboundStats(e);break;case vE.INBOUND:"audio"===e.mediaType?t.processAudioInboundStats(e):"video"===e.mediaType&&t.processVideoInboundStats(e);break;case vE.TRANSPORT:var r=t.report.get(e.selectedCandidatePairId);r&&t.processCandidatePairStats(r);break;case vE.CANDIDATE_PAIR:e.selected&&t.processCandidatePairStats(e)}})),this.updateSendBitrate(),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats,[2]}}))}))},t.prototype.processCandidatePairStats=function(e){this._stats.sendBandwidth=e.availableOutgoingBitrate||0,e.currentRoundTripTime&&(this._stats.rtt=1e3*e.currentRoundTripTime),this._stats.videoSend.forEach((function(t){!t.rttMs&&e.currentRoundTripTime&&(t.rttMs=1e3*e.currentRoundTripTime)})),this._stats.audioSend.forEach((function(t){!t.rttMs&&e.currentRoundTripTime&&(t.rttMs=1e3*e.currentRoundTripTime)}))},t.prototype.processAudioInboundStats=function(e){var t=this._stats.audioRecv.find((function(t){return t.ssrc===e.ssrc}));t||(t=uE(CE),this._stats.audioRecv.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsReceived,t.packetsLost=e.packetsLost,t.bytes=e.bytesReceived,t.jitterMs=1e3*e.jitter,e.trackId&&this.processAudioTrackReceiverStats(e.trackId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),t.receivedFrames||(t.receivedFrames=e.packetsReceived),t.droppedFrames||(t.droppedFrames=e.packetsLost),t.receivedFrames>0&&!this.isFirstAudioReceived[t.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(t.ssrc),this.isFirstAudioReceived[t.ssrc]=!0),t.outputLevel&&t.outputLevel>0&&!this.isFirstAudioDecoded[t.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(t.ssrc),this.isFirstAudioDecoded[t.ssrc]=!0)},t.prototype.processVideoInboundStats=function(e){var t=this._stats.videoRecv.find((function(t){return t.ssrc===e.ssrc}));t||(t=uE(AE),this._stats.videoRecv.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsReceived,t.packetsLost=e.packetsLost,t.bytes=e.bytesReceived,t.firsCount=e.firCount,t.nacksCount=e.nackCount,t.plisCount=e.pliCount,t.framesDecodeCount=e.framesDecoded;var r=this.lastDecodeVideoReceiverStats.get(t.ssrc),i=this.lastVideoFramesDecode.get(t.ssrc),n=Date.now();if(t.framesDecodeCount>0&&!this.isFirstVideoDecoded[t.ssrc]){var o=t.decodedFrame?t.decodedFrame.width:0,s=t.decodedFrame?t.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(t.ssrc,o,s),this.isFirstVideoDecoded[t.ssrc]=!0}if(r){var a=r.stats,c=n-r.lts;t.framesDecodeFreezeTime=a.framesDecodeFreezeTime,t.framesDecodeInterval=a.framesDecodeInterval,t.framesDecodeCount>a.framesDecodeCount&&this.isFirstVideoDecoded?(r.lts=Date.now(),t.framesDecodeInterval=c,t.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(e.ssrc))?t.framesDecodeFreezeTime+=t.framesDecodeInterval:this.setVideoIsReady2(parseInt(e.ssrc,10),!0))):t.framesDecodeCount<a.framesDecodeCount&&(t.framesDecodeInterval=0)}i&&n-i.lts>=800?(t.decodeFrameRate=Math.round((t.framesDecodeCount-i.count)/((n-i.lts)/1e3)),this.lastVideoFramesDecode.set(t.ssrc,{count:t.framesDecodeCount,lts:n,rate:t.decodeFrameRate})):i?t.decodeFrameRate=i.rate:this.lastVideoFramesDecode.set(t.ssrc,{count:t.framesDecodeCount,lts:n,rate:0}),e.totalDecodeTime&&(t.decodeMs=1e3*e.totalDecodeTime),e.trackId&&this.processVideoTrackReceiverStats(e.trackId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),e.framerateMean&&(t.framesRateFirefox=e.framerateMean),t.packets>0&&!this.isFirstVideoReceived[t.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(t.ssrc),this.isFirstVideoReceived[t.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(t.ssrc,{stats:gE({},t),lts:r?r.lts:Date.now()})},t.prototype.processVideoOutboundStats=function(e){var t=this._stats.videoSend.find((function(t){return t.ssrc===e.ssrc}));t||(t=uE(yE),this._stats.videoSend.push(t));var r=this.mediaBytesSent.get(e.ssrc);if(r?r.add(e.bytesSent):((n=new hE(10)).add(e.bytesSent),this.mediaBytesSent.set(e.ssrc,n)),void 0!==e.retransmittedBytesSent){var i=this.mediaBytesRetransmit.get(e.ssrc);i?i.add(e.retransmittedBytesSent):((n=new hE(10)).add(e.retransmittedBytesSent),this.mediaBytesRetransmit.set(e.ssrc,n))}if(e.totalEncodedBytesTarget){var n,o=this.mediaBytesTargetEncode.get(e.ssrc);o?o.add(e.totalEncodedBytesTarget):((n=new hE(10)).add(e.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(e.ssrc,n))}if(t.ssrc=e.ssrc,t.bytes=e.bytesSent,t.packets=e.packetsSent,t.firsCount=e.firCount,t.nacksCount=e.nackCount,t.plisCount=e.pliCount,t.frameCount=e.framesEncoded,t.adaptionChangeReason=e.qualityLimitationReason,e.totalEncodeTime&&e.framesEncoded){var s=this.lastEncoderMs.get(e.ssrc);if(!s||s.lastFrameCount>e.framesEncoded)t.avgEncodeMs=1e3*e.totalEncodeTime/e.framesEncoded;else{var a=e.framesEncoded-s.lastFrameCount,c=e.totalEncodeTime-s.lastEncoderTime;t.avgEncodeMs=1e3*c/a}this.lastEncoderMs.set(e.ssrc,{lastFrameCount:e.framesEncoded,lastEncoderTime:e.totalEncodeTime,lts:Date.now()})}if(e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),e.mediaSourceId&&this.processVideoMediaSource(e.mediaSourceId,t),e.trackId&&this.processVideoTrackSenderStats(e.trackId,t),e.remoteId)this.processRemoteInboundStats(e.remoteId,t);else{var l=this.findRemoteStatsId(e.ssrc,vE.REMOTE_INBOUND);l&&this.processRemoteInboundStats(l,t)}},t.prototype.processAudioOutboundStats=function(e){var t=this._stats.audioSend.find((function(t){return t.ssrc===e.ssrc}));if(t||(t=uE(SE),this._stats.audioSend.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsSent,t.bytes=e.bytesSent,e.mediaSourceId&&this.processAudioMediaSource(e.mediaSourceId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),e.trackId&&this.processAudioTrackSenderStats(e.trackId,t),e.remoteId)this.processRemoteInboundStats(e.remoteId,t);else{var r=this.findRemoteStatsId(e.ssrc,vE.REMOTE_INBOUND);r&&this.processRemoteInboundStats(r,t)}},t.prototype.findRemoteStatsId=function(e,t){var r=Array.from(this.report.values()).find((function(r){return r.type===t&&r.ssrc===e}));return r?r.id:null},t.prototype.processVideoMediaSource=function(e,t){var r=this.report.get(e);r&&r.width&&r.height&&r.framesPerSecond&&(t.inputFrame={width:r.width,height:r.height,frameRate:r.framesPerSecond})},t.prototype.processAudioMediaSource=function(e,t){var r=this.report.get(e);r&&(t.inputLevel=r.audioLevel)},t.prototype.processVideoTrackSenderStats=function(e,t){var r=this.report.get(e);if(r){var i=0,n=Date.now(),o=this.lastVideoFramesSent.get(t.ssrc);o&&n-o.lts>=800?(i=Math.round((r.framesSent-o.count)/((n-o.lts)/1e3)),this.lastVideoFramesSent.set(t.ssrc,{count:r.framesSent,lts:n,rate:i})):o?i=o.rate:this.lastVideoFramesSent.set(t.ssrc,{count:r.framesSent,lts:n,rate:0}),t.sentFrame={width:r.frameWidth,height:r.frameHeight,frameRate:i}}},t.prototype.processVideoTrackReceiverStats=function(e,t){var r=this.report.get(e);if(r){var i=this.lastVideoFramesRecv.get(t.ssrc),n=Date.now();t.framesReceivedCount=r.framesReceived;var o=0;if(i&&n-i.lts>=800?(o=Math.round((r.framesReceived-i.count)/((n-i.lts)/1e3)),this.lastVideoFramesRecv.set(t.ssrc,{count:r.framesReceived,lts:n,rate:o})):i?o=i.rate:this.lastVideoFramesRecv.set(t.ssrc,{count:r.framesReceived,lts:n,rate:0}),t.receivedFrame={width:r.frameWidth||0,height:r.frameHeight||0,frameRate:o||0},t.decodedFrame={width:r.frameWidth||0,height:r.frameHeight||0,frameRate:t.decodeFrameRate||0},t.outputFrame={width:r.frameWidth||0,height:r.frameHeight||0,frameRate:t.decodeFrameRate||0},r.jitterBufferDelay&&r.jitterBufferEmittedCount){var s=this.lastVideoJBDelay.get(t.ssrc);this.lastVideoJBDelay.set(t.ssrc,{jitterBufferDelay:r.jitterBufferDelay,jitterBufferEmittedCount:r.jitterBufferEmittedCount}),s||(s={jitterBufferDelay:0,jitterBufferEmittedCount:0});var a=1e3*(r.jitterBufferDelay-s.jitterBufferDelay)/(r.jitterBufferEmittedCount-s.jitterBufferEmittedCount);t.jitterBufferMs=a,t.currentDelayMs=Math.round(a)}}},t.prototype.processAudioTrackSenderStats=function(e,t){var r=this.report.get(e);r&&(t.aecReturnLoss=r.echoReturnLoss||0,t.aecReturnLossEnhancement=r.echoReturnLossEnhancement||0)},t.prototype.processAudioTrackReceiverStats=function(e,t){var r=this.report.get(e);if(r){if(r.removedSamplesForAcceleration&&r.totalSamplesReceived&&(t.accelerateRate=r.removedSamplesForAcceleration/r.totalSamplesReceived),r.jitterBufferDelay&&r.jitterBufferEmittedCount){var i=this.lastAudioJBDelay.get(t.ssrc);this.lastAudioJBDelay.set(t.ssrc,{jitterBufferDelay:r.jitterBufferDelay,jitterBufferEmittedCount:r.jitterBufferEmittedCount}),i||(i={jitterBufferDelay:0,jitterBufferEmittedCount:0});var n=1e3*(r.jitterBufferDelay-i.jitterBufferDelay)/(r.jitterBufferEmittedCount-i.jitterBufferEmittedCount);t.jitterBufferMs=Math.round(n)}t.outputLevel=r.audioLevel;var o=1920;r.totalSamplesDuration&&r.totalSamplesReceived&&(o=r.totalSamplesReceived/r.totalSamplesDuration/50,t.receivedFrames=Math.round(r.totalSamplesReceived/o)),r.concealedSamples&&(t.droppedFrames=Math.round(r.concealedSamples/o))}},t.prototype.processRemoteInboundStats=function(e,t){var r=this.report.get(e);r&&(t.packetsLost=r.packetsLost,r.roundTripTime&&(t.rttMs=1e3*r.roundTripTime))},t.prototype.getCodecFromCodecStats=function(e){var t=this.report.get(e);if(!t)return"";var r=t.mimeType.match(/\/(.*)$/);return r&&r[1]?r[1]:""},t.prototype.updateSendBitrate=function(){var e=0,t=null,r=null;this.mediaBytesSent.forEach((function(t){e+=t.diffMean()})),this.mediaBytesRetransmit.forEach((function(e){t=null===t?e.diffMean():t+e.diffMean()})),this.mediaBytesTargetEncode.forEach((function(e){r=null===r?e.diffMean():r+e.diffMean()}));var i=null!==t?e-t:e;this._stats.bitrate={actualEncoded:8*i/(this.options.updateInterval/1e3),transmit:8*e/(this.options.updateInterval/1e3)},null!==t&&(this._stats.bitrate.retransmit=8*t/(this.options.updateInterval/1e3)),null!==r&&(this._stats.bitrate.targetEncoded=8*r/(this.options.updateInterval/1e3))},t}(TE),RE=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fE(t,e),t.prototype.updateStats=function(){return Promise.resolve()},t}(TE);function wE(e,t,r,i){void 0===t&&(t=250),void 0===r&&(r=8),void 0===i&&(i=500);var n,o=(n=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i))&&n[0]?Number(n[0].split("/")[1]):null;return o?o<76?new bE(e,{updateInterval:t,lossRateInterval:r,freezeRateLimit:i}):new IE(e,{updateInterval:t,lossRateInterval:r,freezeRateLimit:i}):function(e){return!!window.RTCStatsReport&&e.getStats()instanceof Promise}(e)?new IE(e,{updateInterval:t,lossRateInterval:r,freezeRateLimit:i}):new RE(e,{updateInterval:t,lossRateInterval:r,freezeRateLimit:i})}function kE(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}var OE=function(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Bi(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&di(t,r,s),s},NE=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class LE extends xu{constructor(e,t){super(e,t),this.useRTX=!1,this.localCandidateCount=0,this.allCandidatesReceived=!1,this.mutex=new ah("P2PConnection-mutex"),this.store=t,this.peerConnection=new RTCPeerConnection(LE.resolvePCConfiguration(e),{optional:[{googDscp:!0}]}),this.statsFilter=wE(this.peerConnection,void 0,void 0,Ia()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}async establish(){try{const e=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!e.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const t=tE(e.sdp),r=eE(e.sdp,!this.useRTX,!1,["opus"]);return this.localCapabilities=r,this.initialOffer=e,function(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=kE(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=kE(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}({},t,{rtpCapabilities:r,offerSDP:e.sdp})}catch(e){throw new pl(ll.GET_LOCAL_CONNECTION_PARAMS_FAILED,e.toString())}}async connect(e,t,r,i,n,o,s,a){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new lE({remoteIceParameters:e,remoteDtlsParameters:t,candidates:r,remoteRTPCapabilities:i,remoteSetup:n,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec,cname:o,ip:s,port:a});const c=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:c})}catch(e){throw new pl(ll.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(e.toString()))}}send(e,t){var r=this;return Qv((function*(){const i=yield Wv(r.mutex.lock());try{if(!r.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const n=vo(e).call(e,e=>r.peerConnection.addTrack(e._mediaStreamTrack)),o=yield Wv(r.peerConnection.createOffer()),s=$v.parse(o.sdp),a=vo(e).call(e,e=>{var t;const i=e._mediaStreamTrack,n=Qo(t=s.mediaDescriptions).call(t,e=>e.attributes.mid===i.kind);if(!n)throw new Error("Cannot extract ssrc from mediaDescription.");return function(e,t,r){var i;const n=ji(i=e.attributes.ssrcs).call(i,e=>e.attributes.label===t),o=e.attributes.ssrcGroups;if(0===n.length)throw new Error("Cannot extract ssrc from plan-b SDP.");if(o&&n.length>1){const e=Qo(o).call(o,e=>{var t;return-1!==Lo(t=e.ssrcIds).call(t,n[0].ssrcId)});return e?[{ssrcId:e.ssrcIds[0],rtx:r?e.ssrcIds[1]:void 0}]:[{ssrcId:n[0].ssrcId}]}return[{ssrcId:n[0].ssrcId}]}(n,i.id,r.useRTX)});let c;try{c=yield a}catch(e){throw Jr(n).call(n,e=>{ba()&&e.replaceTrack(null),r.peerConnection.removeTrack(e)}),e}const l=r.mungSendOfferSDP(o.sdp,e);r.remoteSDP.receive(e,t,c);const u=r.remoteSDP.toString();return yield Wv(r.peerConnection.setLocalDescription({type:"offer",sdp:l})),yield Wv(r.applySendEncodings(n,e)),yield Wv(r.peerConnection.setRemoteDescription({type:"answer",sdp:u})),vo(e).call(e,(e,t)=>{const r=e._mediaStreamTrack.id;return{localSSRC:a[t],id:r}})}catch(e){throw new pl(ll.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(e.toString()))}finally{i()}}))()}async stopSending(e){try{var t;if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const r=ji(t=this.peerConnection.getSenders()).call(t,t=>{var r;return-1!==Lo(e).call(e,(null===(r=t.track)||void 0===r?void 0:r.id)||"")});if(r.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");vo(r).call(r,e=>{ba()&&e.replaceTrack(null),this.peerConnection.removeTrack(e)});const i=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(i),this.remoteSDP.stopReceiving(e);const n=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:n})}catch(e){throw new pl(ll.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(e.toString()))}}async receive(e,t,r,i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(e," before remoteSDP created."));const{id:r,mslabel:n}=this.remoteSDP.send(e,t,i),o=new fo((t,i)=>{const o=Fa(()=>{i(new Error("Cannot receive track, id: ".concat(r)))},1e4),s=i=>{const a=ma();if("Safari"===a.name&&11===Number(a.version)&&i.track.id!==r&&i.streams[0].id===n){var c;const n=i.streams[0].getTracks()[0];return null===(c=this.remoteSDP)||void 0===c||c.updateTrackLabel(e,r,i.track.id),this.peerConnection.removeEventListener("track",s),clearTimeout(o),void t(n)}if(i.track.id===r)return this.peerConnection.removeEventListener("track",s),clearTimeout(o),void t(i.track)};this.peerConnection.addEventListener("track",s)}),s=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const a=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(a),{track:await o,id:r}}catch(e){throw new pl(ll.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async stopReceiving(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(e);const t=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(r)}catch(e){throw new pl(ll.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(e.toString()))}}async muteRemote(e){}async unmuteRemote(e){}async muteLocal(e){try{var t;if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const r=ji(t=this.peerConnection.getSenders()).call(t,t=>{var r;return-1!==Lo(e).call(e,(null===(r=t.track)||void 0===r?void 0:r.id)||"")});if(r.length!==e.length)throw new Error("sender' length doesn't match mids' length.");vo(r).call(r,e=>{if(ba()&&e.track)e.track.enabled=!1;else{var t;const r=e.getParameters();Jr(t=r.encodings).call(t,e=>e.active=!1),e.setParameters(r)}})}catch(e){throw new pl(ll.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(e.toString()))}}async unmuteLocal(e){try{var t;if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const r=ji(t=this.peerConnection.getSenders()).call(t,t=>{var r;return-1!==Lo(e).call(e,(null===(r=t.track)||void 0===r?void 0:r.id)||"")});if(r.length!==e.length)throw new Error("Senders' length doesn't match mids' length.");vo(r).call(r,async e=>{if(ba()&&e.track)e.track.enabled=!0;else{var t;const r=e.getParameters();Jr(t=r.encodings).call(t,e=>e.active=!0),await e.setParameters(r)}});const i=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(i);const n=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:n})}catch(e){throw new pl(ll.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(e.toString()))}}async reEstablish(){const e=await this.peerConnection.createOffer({iceRestart:!0});if(!e.sdp)throw new Error("Cannot get SDP from restart offer.");return{iceParameters:tE(e.sdp).iceParameters,restartICE:async(t,r,i,n)=>this.restartICE(e,t,r,i,n),restartOfferSDP:e.sdp}}close(){var e;this.peerConnection.close(),null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(e){return this.statsFilter.getVideoIsReady(e)}async updateEncoderConfig(e,t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const e=await this.peerConnection.createOffer(),r=this.mungSendOfferSDP(e.sdp,[t]);this.remoteSDP.updateRecvMedia(t._mediaStreamTrack.kind,t);const i=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:r}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}catch(e){throw new pl(ll.EXCHANGE_SDP_FAILED,e.toString())}}async updateSendParameters(e,t){var r;const i=ji(r=this.peerConnection.getSenders()).call(r,t=>{var r;return(null===(r=t.track)||void 0===r?void 0:r.id)===e});1===i.length&&await this.applySendEncodings(i,[t])}setStatsRemoteVideoIsReady(e,t){this.statsFilter.setVideoIsReady2(e,t)}async replaceTrack(e,t){var r;const i=Qo(r=this.peerConnection.getSenders()).call(r,e=>{var r;return(null===(r=e.track)||void 0===r?void 0:r.id)===t});i&&await i.replaceTrack(e._mediaStreamTrack)}async restartICE(e,t,r,i,n){try{if(!this.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");this.remoteSDP.restartICE(t,r,i,n);const o=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(e),await this.peerConnection.setRemoteDescription({type:"answer",sdp:o})}catch(e){throw new pl(ll.EXCHANGE_SDP_FAILED,"P2PConnection.restartICE failed; ".concat(e.toString()))}}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var e;null===(e=this.onICEConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var e;null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=e=>{e.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,Rc.debug("[pc-".concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},Fa(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,Rc.debug("[pc-".concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},jc("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(e){const t={iceServers:[],sdpSemantics:"plan-b"};var r,i;return e.iceServers?t.iceServers=e.iceServers:e.turnServer&&"off"!==e.turnServer.mode&&(Kl(e.turnServer.servers)?t.iceServers=e.turnServer.servers:(t.iceServers&&t.iceServers.push(...LE.turnServerConfigToIceServers(e.turnServer.servers)),t.iceServers&&e.turnServer.serversFromGateway&&t.iceServers.push(...LE.turnServerConfigToIceServers(e.turnServer.serversFromGateway)),Jr(r=Je(i=e.turnServer.servers).call(i,e.turnServer.serversFromGateway||[])).call(r,e=>{e.forceturn&&(t.iceTransportPolicy="relay")}))),t}static turnServerConfigToIceServers(e){const t=[];return Jr(e).call(e,e=>{var r,i,n;e.security?e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:Je(r="turns:".concat(hp(e.turnServerURL),":")).call(r,e.tcpport,"?transport=tcp")}):(e.udpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:Je(i="turn:".concat(e.turnServerURL,":")).call(i,e.udpport,"?transport=udp")}),e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:Je(n="turn:".concat(e.turnServerURL,":")).call(n,e.tcpport,"?transport=tcp")}))}),t}async applySendEncodings(e,t){try{if(!Fu().supportSetRtpSenderParameters)return;if(e.length!==t.length)return;for(let n=0;n<e.length;n++){var r;const o=e[n],s=t[n];if(!s)continue;const a={},c={};if(s instanceof Tv)switch(s._optimizationMode){case"motion":a.degradationPreference="maintain-framerate";break;case"detail":a.degradationPreference="maintain-resolution";break;default:a.degradationPreference="balanced"}if(jc("DSCP_TYPE")&&Da()){var i;const e=jc("DSCP_TYPE");is(i=["very-low","low","medium","high"]).call(i,e)&&(c.networkPriority=e)}const l=o.getParameters(),u=null===(r=l.encodings)||void 0===r?void 0:r[0];u&&ri(u,c),ri(l,a),await o.setParameters(l)}}catch(e){Rc.debug("Apply RTPSendEncodings failed.")}}mungSendOfferSDP(e,t){const r=$v.parse(e);return Jr(t).call(t,(e,t)=>{var i;const n=e._mediaStreamTrack,o=Qo(i=r.mediaDescriptions).call(i,e=>e.attributes.mid===n.kind);o&&nE(o,e)}),$v.print(r)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=e=>{var t;null===(t=this.onFirstAudioReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoReceived=e=>{var t;null===(t=this.onFirstVideoReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstAudioDecoded=e=>{var t;null===(t=this.onFirstAudioDecoded)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoDecoded=(e,t,r)=>{var i;null===(i=this.onFirstVideoDecoded)||void 0===i||i.call(this,e,t,r)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0}}function PE(e,t,r){const i=e[t];if("function"!=typeof i)throw new Error("Cannot use mutex on object property.");return r.value=async function(...e){const r=this.mutex,n=await r.lock("Locking from P2PConnection.".concat(t));try{return await i.apply(this,e)}finally{n()}},r}OE([PE,NE("design:type",Function),NE("design:paramtypes",[Object,Object,Array,Object,String,String,String,String]),NE("design:returntype",fo)],LE.prototype,"connect",null),OE([PE,NE("design:type",Function),NE("design:paramtypes",[Array]),NE("design:returntype",fo)],LE.prototype,"stopSending",null),OE([PE,NE("design:type",Function),NE("design:paramtypes",[String,Array,String,Object]),NE("design:returntype",fo)],LE.prototype,"receive",null),OE([PE,NE("design:type",Function),NE("design:paramtypes",[Array]),NE("design:returntype",fo)],LE.prototype,"stopReceiving",null),OE([PE,NE("design:type",Function),NE("design:paramtypes",[String]),NE("design:returntype",fo)],LE.prototype,"muteRemote",null),OE([PE,NE("design:type",Function),NE("design:paramtypes",[String]),NE("design:returntype",fo)],LE.prototype,"unmuteRemote",null),OE([PE,NE("design:type",Function),NE("design:paramtypes",[Array]),NE("design:returntype",fo)],LE.prototype,"muteLocal",null),OE([PE,NE("design:type",Function),NE("design:paramtypes",[Array]),NE("design:returntype",fo)],LE.prototype,"unmuteLocal",null),OE([PE,NE("design:type",Function),NE("design:paramtypes",[]),NE("design:returntype",fo)],LE.prototype,"reEstablish",null),OE([PE,NE("design:type",Function),NE("design:paramtypes",[]),NE("design:returntype",void 0)],LE.prototype,"close",null),OE([PE,NE("design:type",Function),NE("design:paramtypes",[String,lh]),NE("design:returntype",fo)],LE.prototype,"updateEncoderConfig",null),OE([PE,NE("design:type",Function),NE("design:paramtypes",[String,lh]),NE("design:returntype",fo)],LE.prototype,"updateSendParameters",null),OE([PE,NE("design:type",Function),NE("design:paramtypes",[lh,String]),NE("design:returntype",fo)],LE.prototype,"replaceTrack",null),OE([PE,NE("design:type",Function),NE("design:paramtypes",[Object,Object,Array,String,String]),NE("design:returntype",fo)],LE.prototype,"restartICE",null);const DE=4e4;class ME{constructor(e){e=jp(e);const{remoteIceParameters:t,remoteDtlsParameters:r,candidates:i,remoteRTPCapabilities:n,remoteSetup:o,localCapabilities:s,cname:a,ip:c,port:l}=e,u=$v.parse("v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE 0 1\na=msid-semantic: WMS\na=ice-lite\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:0\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:1\n");this._rtpCapabilities=n,this._candidates=i,this._iceParameters=t,this._dtlsParameters=r,this._localCapabilities=s,this.setup=o,this.cname=a,this.ip=c,this.port=l,this.addressType=-1===Lo(c).call(c,":")?"IP4":"IP6";for(const f of u.mediaDescriptions){var d,h,p;if(f.media.port=this.port,Jr(d=f.connections).call(d,e=>{e.address=this.ip,e.addrtype=this.addressType}),f.attributes.rtcp?(f.attributes.rtcp.address=this.ip,f.attributes.rtcp.port=this.port,f.attributes.rtcp.addressType=this.addressType):f.attributes.rtcp={port:l,address:c,netType:"IN",addressType:this.addressType},f.attributes.iceUfrag=t.iceUfrag,f.attributes.icePwd=t.icePwd,f.attributes.fingerprints=r.fingerprints,f.attributes.candidates=i,f.attributes.setup=o,"video"===f.media.mediaType&&(f.media.fmts=vo(h=n.videoCodecs).call(h,e=>e.payloadType.toString(10)),f.attributes.payloads=n.videoCodecs,f.attributes.extmaps=n.videoExtensions,jc("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:e,ssrcGroups:t}=iE([{ssrcId:DE,rtx:jc("USE_RTX")?40001:void 0}],this.cname);f.attributes.ssrcs=e,f.attributes.ssrcGroups=t}if("audio"===f.media.mediaType&&(f.media.fmts=vo(p=n.audioCodecs).call(p,e=>e.payloadType.toString(10)),f.attributes.payloads=n.audioCodecs,f.attributes.extmaps=n.audioExtensions,jc("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:e,ssrcGroups:t}=iE([{ssrcId:2e4}],this.cname);f.attributes.ssrcs=e,f.attributes.ssrcGroups=t}}this.sessionDesc=u,this.currentMidIndex=u.mediaDescriptions.length-1}get localCapabilities(){return jp(this._localCapabilities)}get rtpCapabilities(){return jp(this._rtpCapabilities)}get candidates(){return jp(this._candidates)}get iceParameters(){return jp(this._iceParameters)}get dtlsParameters(){return jp(this._dtlsParameters)}preloadRemoteMedia(){const e=jc("PRELOAD_MEDIA_COUNT"),t=this.rtpCapabilities,r=this.candidates,i=this.dtlsParameters,n=this.iceParameters;for(let a=1;a<e;a++){var o,s;const e=2*a+2e4,c=2*a+DE,{ssrcs:l,ssrcGroups:u}=iE([{ssrcId:e}],this.cname),{ssrcs:d,ssrcGroups:h}=iE([{ssrcId:c,rtx:jc("USE_RTX")?c+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:this.port,protos:["UDP","TLS","RTP","SAVPF"],fmts:vo(o=t.videoCodecs).call(o,e=>e.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:this.addressType,address:this.ip}],bandwidths:[],attributes:{iceUfrag:n.iceUfrag,icePwd:n.icePwd,unrecognized:[],candidates:r,extmaps:t.videoExtensions,fingerprints:i.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:d,ssrcGroups:h,rtcpFeedbackWildcards:[],payloads:t.videoCodecs,rtcp:{port:this.port,netType:"IN",addressType:this.addressType,address:this.ip},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*a)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:this.port,protos:["UDP","TLS","RTP","SAVPF"],fmts:vo(s=t.audioCodecs).call(s,e=>e.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:this.addressType,address:this.ip}],bandwidths:[],attributes:{iceUfrag:n.iceUfrag,icePwd:n.icePwd,unrecognized:[],candidates:r,extmaps:t.audioExtensions,fingerprints:i.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:l,ssrcGroups:u,rtcpFeedbackWildcards:[],payloads:t.audioCodecs,rtcp:{port:this.port,netType:"IN",addressType:this.addressType,address:this.ip},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*a+1)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return $v.print(this.sessionDesc)}send(e,t,r,i){const{ssrcs:n,ssrcGroups:o}=iE(t,this.cname,r),s=this.findPreloadMediaDesc(n);if(s){if(i&&(i.tcc||i.remb)){var a;const e=Lo(a=this.sessionDesc.mediaDescriptions).call(a,s);return this.sessionDesc.mediaDescriptions[e]=this.mungSendMediaDesc(s,i),{mid:s.attributes.mid,needExchangeSDP:!0}}return{mid:s.attributes.mid,needExchangeSDP:!1}}{const t=this.findAvailableMediaIndex(e);if(ba()){if(-1!==t&&1!==t){const e=jp(this.sessionDesc.mediaDescriptions[t]);return e.attributes.direction="sendonly",e.attributes.ssrcs=n,e.attributes.ssrcGroups=o,this.sessionDesc.mediaDescriptions[t]=this.mungSendMediaDesc(e,i),{mid:e.attributes.mid,needExchangeSDP:!0}}{const t=this.createOrRecycleSendMedia(e,n,o,"sendonly",i);return this.updateBundleMids(),{mid:t.attributes.mid,needExchangeSDP:!0}}}if(-1!==t){const e=jp(this.sessionDesc.mediaDescriptions[t]);return e.attributes.direction="sendonly",e.attributes.ssrcs=n,e.attributes.ssrcGroups=o,this.sessionDesc.mediaDescriptions[t]=this.mungSendMediaDesc(e,i),{mid:e.attributes.mid,needExchangeSDP:!0}}{const t=this.createOrRecycleSendMedia(e,n,o,"sendonly",i);return this.updateBundleMids(),{mid:t.attributes.mid,needExchangeSDP:!0}}}}stopSending(e){var t;const r=ji(t=this.sessionDesc.mediaDescriptions).call(t,t=>t.attributes.mid&&-1!==Lo(e).call(e,t.attributes.mid));if(r.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");Jr(r).call(r,e=>{"0"===e.attributes.mid||Ia()||ba()?e.attributes.ssrcs=[]:(e.attributes.ssrcs=[],e.attributes.direction="inactive",e.media.port="0")}),this.updateBundleMids()}mute(e){var t;const r=Qo(t=this.sessionDesc.mediaDescriptions).call(t,t=>t.attributes.mid===e);if(!r)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.mute."));r.attributes.direction="inactive"}unmute(e){var t;const r=Qo(t=this.sessionDesc.mediaDescriptions).call(t,t=>t.attributes.mid===e);if(!r)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.unmute."));r.attributes.direction="sendonly"}muteRemote(e){var t;const r=ji(t=this.sessionDesc.mediaDescriptions).call(t,t=>is(e).call(e,t.attributes.mid||""));if(r.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");Jr(r).call(r,e=>{e.attributes.direction="inactive"})}unmuteRemote(e){var t;const r=ji(t=this.sessionDesc.mediaDescriptions).call(t,t=>is(e).call(e,t.attributes.mid||""));if(r.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");Jr(r).call(r,e=>{e.attributes.direction="recvonly"})}receive(e,t,r){Jr(e).call(e,(e,i)=>{this.createOrRecycleRecvMedia(e,[],"recvonly",t,r[i])}),this.updateBundleMids()}stopReceiving(e){var t;const r=ji(t=this.sessionDesc.mediaDescriptions).call(t,t=>-1!==Lo(e).call(e,t.attributes.mid));if(r.length!==e.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");Jr(r).call(r,e=>{e.media.port="0",e.attributes.direction="inactive"}),this.updateBundleMids()}restartICE(e,t,r,i){var n,o;e=jp(e),t=jp(t),this._iceParameters=e,this._candidates=t,this.ip=r,this.port=i,this.addressType=-1===Lo(n=this.ip).call(n,":")?"IP4":"IP6",Jr(o=this.sessionDesc.mediaDescriptions).call(o,t=>{var n;"0"!==t.media.port&&(t.media.port=this.port),Jr(n=t.connections).call(n,e=>{e.address=this.ip,e.addrtype=this.addressType}),t.attributes.rtcp?(t.attributes.rtcp.address=this.ip,t.attributes.rtcp.port=this.port,t.attributes.rtcp.addressType=this.addressType):t.attributes.rtcp={port:i,address:r,netType:"IN",addressType:this.addressType},t.attributes.iceUfrag=e.iceUfrag,t.attributes.icePwd=e.icePwd,t.attributes.candidates=this.candidates})}predictReceivingMids(e){const t=[];for(let r=0;r<e;r++)t.push((this.currentMidIndex+r+1).toString(10));return t}findAvailableMediaIndex(e){var t;return Lv(t=this.sessionDesc.mediaDescriptions).call(t,t=>t.media.mediaType===e&&"0"!==t.media.port&&("sendonly"===t.attributes.direction||"sendrecv"===t.attributes.direction)&&0===t.attributes.ssrcs.length)}createOrRecycleRecvMedia(e,t,r,i,n){const o=e._mediaStreamTrack.kind;let s;var a,c,l,u,d;o===ku.VIDEO?(jc("H264_PROFILE_LEVEL_ID")&&"h264"===i&&(s=ji(c=this.rtpCapabilities.videoCodecs).call(c,e=>{var t,r,n;return is(t=(null===(r=e.rtpMap)||void 0===r?void 0:r.encodingName.toLowerCase())||"").call(t,i)&&(null==e||null===(n=e.fmtp)||void 0===n?void 0:n.parameters["profile-level-id"])===jc("H264_PROFILE_LEVEL_ID")})),s&&0!==(null===(a=s)||void 0===a?void 0:a.length)||(s=ji(l=this.rtpCapabilities.videoCodecs).call(l,e=>{var t,r;return is(t=(null===(r=e.rtpMap)||void 0===r?void 0:r.encodingName.toLowerCase())||"").call(t,i)})),0===s.length&&(Rc.warning(Je(u="codec ".concat(i," not included in rtpCapabilities, fallback to default payloads: ")).call(u,null===(d=this.rtpCapabilities.videoCodecs[0].rtpMap)||void 0===d?void 0:d.encodingName)),s=this.rtpCapabilities.videoCodecs)):s=this.rtpCapabilities.audioCodecs;const h=o===ku.VIDEO?this.rtpCapabilities.videoExtensions:this.rtpCapabilities.audioExtensions;this.currentMidIndex+=1;const p="".concat(this.currentMidIndex);let f={media:{mediaType:o,port:this.port,protos:["UDP","TLS","RTP","SAVPF"],fmts:vo(s).call(s,e=>e.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:this.addressType,address:this.ip}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:h,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:s,rtcp:{port:this.port,netType:"IN",addressType:this.addressType,address:this.ip},setup:this.setup,direction:r,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(p)}};f=this.mungRecvMediaDsec(f,e,n);const g=this.findFirstClosedMedia(o);if(g){var m;const e=Lo(m=this.sessionDesc.mediaDescriptions).call(m,g);this.sessionDesc.mediaDescriptions[e]=f}else this.sessionDesc.mediaDescriptions.push(f);return f}createOrRecycleSendMedia(e,t,r,i,n){const o=e===ku.VIDEO?this.rtpCapabilities.videoCodecs:this.rtpCapabilities.audioCodecs,s=e===ku.VIDEO?this.rtpCapabilities.videoExtensions:this.rtpCapabilities.audioExtensions;this.currentMidIndex+=1;const a="".concat(this.currentMidIndex);let c={media:{mediaType:e,port:this.port,protos:["UDP","TLS","RTP","SAVPF"],fmts:vo(o).call(o,e=>e.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:this.addressType,address:this.ip}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:s,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:r,rtcpFeedbackWildcards:[],payloads:o,rtcp:{port:this.port,netType:"IN",addressType:this.addressType,address:this.ip},setup:this.setup,direction:i,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(a)}};c=this.mungSendMediaDesc(c,n);const l=this.findFirstClosedMedia(e);if(l){var u;const e=Lo(u=this.sessionDesc.mediaDescriptions).call(u,l);this.sessionDesc.mediaDescriptions[e]=c}else this.sessionDesc.mediaDescriptions.push(c);return c}updateBundleMids(){var e,t;this.sessionDesc.attributes.groups[0].identificationTag=vo(e=ji(t=this.sessionDesc.mediaDescriptions).call(t,e=>"0"!==e.media.port)).call(e,e=>e.attributes.mid)}mungRecvMediaDsec(e,t,r){const i=jp(e);return oE(i),nE(i,t),sE(i,t),function(e){var t;if("video"!==e.media.mediaType)return;const r=ma();if(r.name!==ha.SAFARI&&r.os!==da.IOS)return;const i=Lv(t=e.attributes.extmaps).call(t,e=>/video-orientation/g.test(e.extensionName));var n;-1!==i&&bo(n=e.attributes.extmaps).call(n,i,1)}(i),aE(i,r,this.localCapabilities),i}mungSendMediaDesc(e,t){const r=jp(e);return aE(r,t,this.localCapabilities),r}updateRecvMedia(e,t){var r;const i=Lv(r=this.sessionDesc.mediaDescriptions).call(r,t=>t.attributes.mid===e);if(-1!==i){const e=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[i],t);this.sessionDesc.mediaDescriptions[i]=e}}bumpMid(e){this.currentMidIndex+=e}findFirstClosedMedia(e){var t;return Qo(t=this.sessionDesc.mediaDescriptions).call(t,t=>Ia()?"0"===t.media.port&&t.media.mediaType===e:"0"===t.media.port)}findPreloadMediaDesc(e){var t;return Qo(t=this.sessionDesc.mediaDescriptions).call(t,t=>{var r,i;return(null===(r=t.attributes)||void 0===r||null===(i=r.ssrcs[0])||void 0===i?void 0:i.ssrcId)===e[0].ssrcId})}}function xE(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}var BE=function(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Bi(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&di(t,r,s),s},UE=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class FE extends xu{constructor(e,t){super(e,t),this.useRTX=jc("USE_RTX"),this.localCandidateCount=0,this.allCandidatesReceived=!1,this.mutex=new ah("P2PConnection-mutex"),this.store=t,this.peerConnection=new RTCPeerConnection(FE.resolvePCConfiguration(e),{optional:[{googDscp:!0}]}),this.statsFilter=wE(this.peerConnection,void 0,void 0,Ia()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const e=await this.peerConnection.createOffer();if(!e.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const t=tE(e.sdp),r=await async function(e,t,r,i){const n=new RTCPeerConnection;n.addTransceiver("video",{direction:"sendrecv"}),n.addTransceiver("audio",{direction:"sendrecv"});const o=await n.createOffer();if(!o.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const s=eE(o.sdp,e,t,r,i);try{n.close()}catch(e){}return s}(!this.useRTX,!1,["opus"]);return this.localCapabilities=r,this.initialOffer=e,function(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=xE(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=xE(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}({},t,{rtpCapabilities:r,offerSDP:e.sdp})}catch(e){throw new pl(ll.GET_LOCAL_CONNECTION_PARAMS_FAILED,e.toString())}}async connect(e,t,r,i,n,o,s,a){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new ME({remoteIceParameters:e,remoteDtlsParameters:t,candidates:r,remoteRTPCapabilities:i,remoteSetup:n,localCapabilities:this.localCapabilities,cname:o,ip:s,port:a});const c=this.remoteSDP.toString(),l=this.logSDPExchange(this.initialOffer.sdp||"","offer","local","connect");await this.peerConnection.setLocalDescription(this.initialOffer),null==l||l(c),await this.peerConnection.setRemoteDescription({type:"answer",sdp:c});const u=this.peerConnection.getTransceivers()[0];if(null!=u&&u.receiver&&this.tryBindTransportEvents(u.receiver),jc("PRELOAD_MEDIA_COUNT")>0){this.remoteSDP.preloadRemoteMedia();const e=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:e});const t=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(t)}}catch(e){throw new pl(ll.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(e.toString()))}}send(e,t){var r=this;return Qv((function*(){const i=yield Wv(r.mutex.lock());try{if(!r.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const n=[];Jr(e).call(e,e=>{const t=r.peerConnection.addTransceiver(e._mediaStreamTrack,{direction:"sendonly"});n.push(t)}),Ia()&&!0===jc("SIMULCAST")&&(yield Wv(r.applySimulcastForFirefox(n,e)));const o=yield Wv(r.peerConnection.createOffer()),s=r.remoteSDP.predictReceivingMids(e.length),a=r.mungSendOfferSDP(o.sdp,e,s),c=$v.parse(a),l=vo(s).call(s,e=>{var t;const i=Qo(t=c.mediaDescriptions).call(t,t=>t.attributes.mid===e);if(!i)throw new Error("Cannot extract ssrc from mediaDescription.");return function(e,t){var r,i;const n=[],o=ji(r=e.attributes.ssrcGroups).call(r,e=>"FID"===e.semantic),s=Qo(i=e.attributes.ssrcGroups).call(i,e=>"SIM"===e.semantic),a=e.attributes.ssrcs;var c;if(s)Jr(c=s.ssrcIds).call(c,e=>{var r;const i=null===(r=Qo(o).call(o,t=>t.ssrcIds[0]===e))||void 0===r?void 0:r.ssrcIds[1];n.push({ssrcId:e,rtx:t?i:void 0})});else if(o.length>0){const e=o[0].ssrcIds[0],r=o[0].ssrcIds[1];n.push({ssrcId:e,rtx:t?r:void 0})}else{if(0===a.length)throw new Error("No ssrcs found on local media description.");n.push({ssrcId:a[0].ssrcId})}return n}(i,r.useRTX)});let u;try{u=yield l}catch(e){throw Jr(n).call(n,e=>{var t;return null===(t=e.stop)||void 0===t?void 0:t.call(e)}),r.remoteSDP.bumpMid(n.length),e}r.remoteSDP.receive(e,t,u);const d=r.remoteSDP.toString(),h=r.logSDPExchange(a,"offer","local","send");return yield Wv(r.peerConnection.setLocalDescription({type:"offer",sdp:a})),yield Wv(r.applySimulcastEncodings(n,e)),yield Wv(r.applySendEncodings(n,e)),null==h||h(d),yield Wv(r.peerConnection.setRemoteDescription({type:"answer",sdp:d})),vo(n).call(n,(e,t)=>{const r=s[t];return{localSSRC:l[t],id:r,transceiver:e}})}catch(e){throw new pl(ll.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(e.toString()))}finally{i()}}))()}async stopSending(e){try{var t;if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const r=ji(t=this.peerConnection.getTransceivers()).call(t,t=>-1!==Lo(e).call(e,t.mid));if(r.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");vo(r).call(r,e=>{var t;e.direction="inactive",null===(t=e.stop)||void 0===t||t.call(e)});const i=await this.peerConnection.createOffer(),n=this.logSDPExchange(i.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(i),this.remoteSDP.stopReceiving(e);const o=this.remoteSDP.toString();null==n||n(o),await this.peerConnection.setRemoteDescription({type:"answer",sdp:o})}catch(e){throw new pl(ll.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(e.toString()))}}async receive(e,t,r,i){try{var n;if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(e," before remoteSDP created."));const{mid:o,needExchangeSDP:s}=this.remoteSDP.send(e,t,r,i);if(s){const t=this.remoteSDP.toString(),r=this.logSDPExchange(t,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const i=await this.peerConnection.createAnswer();null==r||r(i.sdp||""),await this.peerConnection.setLocalDescription(i),Rc.debug("[P2PConnection] receive ".concat(e," by exchanging SDP."))}else Rc.debug("[P2PConnection] receive ".concat(e," no need to exchange SDP."));const a=Qo(n=this.peerConnection.getTransceivers()).call(n,e=>e.mid===o);if(!a)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:a.receiver.track,id:o}}catch(e){throw new pl(ll.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async stopReceiving(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(e);const t=this.remoteSDP.toString(),r=this.logSDPExchange(t,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const i=await this.peerConnection.createAnswer();null==r||r(i.sdp||""),await this.peerConnection.setLocalDescription(i)}catch(e){throw new pl(ll.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(e.toString()))}}async muteRemote(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(e," before remote SDP created."));this.remoteSDP.mute(e);const t=this.remoteSDP.toString(),r=this.logSDPExchange(t,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const i=await this.peerConnection.createAnswer();null==r||r(i.sdp||""),await this.peerConnection.setLocalDescription(i)}catch(e){throw new pl(ll.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(e.toString()))}}async unmuteRemote(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(e," before remote SDP created."));this.remoteSDP.unmute(e);const t=this.remoteSDP.toString(),r=this.logSDPExchange(t,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const i=await this.peerConnection.createAnswer();null==r||r(i.sdp||""),await this.peerConnection.setLocalDescription(i)}catch(e){throw new pl(ll.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(e.toString()))}}async muteLocal(e){try{var t;if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const r=ji(t=this.peerConnection.getTransceivers()).call(t,t=>t.mid&&-1!==Lo(e).call(e,t.mid));if(r.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");vo(r).call(r,e=>{e.direction="inactive"});const i=await this.peerConnection.createOffer(),n=this.logSDPExchange(i.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(i),this.remoteSDP.muteRemote(e);const o=this.remoteSDP.toString();null==n||n(o),await this.peerConnection.setRemoteDescription({type:"answer",sdp:o})}catch(e){throw new pl(ll.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(e.toString()))}}async unmuteLocal(e){try{var t;if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const r=ji(t=this.peerConnection.getTransceivers()).call(t,t=>t.mid&&-1!==Lo(e).call(e,t.mid));if(r.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");vo(r).call(r,async(e,t)=>{e.direction="sendonly"});const i=await this.peerConnection.createOffer(),n=this.logSDPExchange(i.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(i),this.remoteSDP.unmuteRemote(e);const o=this.remoteSDP.toString();null==n||n(o),await this.peerConnection.setRemoteDescription({type:"answer",sdp:o})}catch(e){throw new pl(ll.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(e.toString()))}}async reEstablish(){const e=await this.peerConnection.createOffer({iceRestart:!0});if(!e.sdp)throw new Error("Cannot get SDP from restart offer.");return{iceParameters:tE(e.sdp).iceParameters,restartICE:async(t,r,i,n)=>this.restartICE(e,t,r,i,n),restartOfferSDP:e.sdp}}close(){var e;this.peerConnection.close(),null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(e){return this.statsFilter.getVideoIsReady(e)}async updateEncoderConfig(e,t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const r=await this.peerConnection.createOffer(),i=this.mungSendOfferSDP(r.sdp,[t],[e]);this.remoteSDP.updateRecvMedia(e,t);const n=this.remoteSDP.toString(),o=this.logSDPExchange(i,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:i}),null==o||o(n),await this.peerConnection.setRemoteDescription({type:"answer",sdp:n})}catch(e){throw new pl(ll.EXCHANGE_SDP_FAILED,e.toString())}}async updateSendParameters(e,t){var r;const i=ji(r=this.peerConnection.getTransceivers()).call(r,t=>t.mid===e);1===i.length&&(this.isVP8Simulcast(t)?Ia()||await this.applySimulcastEncodings(i,[t]):await this.applySendEncodings(i,[t]))}setStatsRemoteVideoIsReady(e,t){this.statsFilter.setVideoIsReady2(e,t)}async replaceTrack(e,t){var r;const i=Qo(r=this.peerConnection.getTransceivers()).call(r,e=>e.mid===t);i&&await i.sender.replaceTrack(e._mediaStreamTrack)}async restartICE(e,t,r,i,n){try{if(!this.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");this.remoteSDP.restartICE(t,r,i,n);const o=this.remoteSDP.toString(),s=this.logSDPExchange(e.sdp||"","offer","local","restartICE");await this.peerConnection.setLocalDescription(e),null==s||s(o),await this.peerConnection.setRemoteDescription({type:"answer",sdp:o})}catch(e){throw new pl(ll.EXCHANGE_SDP_FAILED,"P2PConnection.restartICE failed; ".concat(e.toString()))}}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var e;null===(e=this.onICEConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var e;null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=e=>{e.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,Rc.debug("[pc-".concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},Fa(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,Rc.debug("[pc-".concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},jc("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(e){const t={iceServers:[]};var r,i;return e.iceServers?t.iceServers=e.iceServers:e.turnServer&&"off"!==e.turnServer.mode&&(Kl(e.turnServer.servers)?t.iceServers=e.turnServer.servers:(t.iceServers&&t.iceServers.push(...FE.turnServerConfigToIceServers(e.turnServer.servers)),t.iceServers&&e.turnServer.serversFromGateway&&t.iceServers.push(...FE.turnServerConfigToIceServers(e.turnServer.serversFromGateway)),Jr(r=Je(i=e.turnServer.servers).call(i,e.turnServer.serversFromGateway||[])).call(r,e=>{e.forceturn&&(t.iceTransportPolicy="relay")}))),t}static turnServerConfigToIceServers(e){const t=[];return Jr(e).call(e,e=>{var r,i,n;e.security?e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:Je(r="turns:".concat(hp(e.turnServerURL),":")).call(r,e.tcpport,"?transport=tcp")}):(e.udpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:Je(i="turn:".concat(e.turnServerURL,":")).call(i,e.udpport,"?transport=udp")}),e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:Je(n="turn:".concat(e.turnServerURL,":")).call(n,e.tcpport,"?transport=tcp")}))}),t}tryBindTransportEvents(e){e.transport&&(this.transportEventReceiver=e,e.transport.onstatechange=()=>{var t,r;null!==(t=e.transport)&&void 0!==t&&t.state&&(null===(r=this.onDTLSTransportStateChange)||void 0===r||r.call(this,e.transport.state))},e.transport.onerror=e=>{var t;null===(t=this.onDTLSTransportError)||void 0===t||t.call(this,e.error)},e.transport.iceTransport&&(e.transport.iceTransport.onstatechange=()=>{var t,r,i;null!==(t=e.transport)&&void 0!==t&&t.iceTransport.state&&(null===(r=this.onICETransportStateChange)||void 0===r||r.call(this,null===(i=e.transport)||void 0===i?void 0:i.iceTransport.state))}))}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async applySendEncodings(e,t){try{if(!Fu().supportSetRtpSenderParameters)return;if(e.length!==t.length)return;for(let u=0;u<e.length;u++){const d=e[u],h=t[u];if(h&&h instanceof Tv){var r,i,n;if(this.isVP8Simulcast(h))continue;const e={},t={};switch(h._optimizationMode){case"motion":e.degradationPreference="maintain-framerate";break;case"detail":e.degradationPreference="maintain-resolution";break;default:e.degradationPreference="balanced"}var o,s,a,c;if(null!==(r=h._encoderConfig)&&void 0!==r&&r.bitrateMax&&(t.maxBitrate=1e3*(null===(o=h._encoderConfig)||void 0===o?void 0:o.bitrateMax)),is(i=h._hints).call(i,Eu.LOW_STREAM)&&(null!==(s=h._encoderConfig)&&void 0!==s&&s.frameRate&&(t.maxFramerate=fp(h._encoderConfig.frameRate)),null!==(a=h._encoderConfig)&&void 0!==a&&a.scaleResolutionDownBy&&(null===(c=h._encoderConfig)||void 0===c?void 0:c.scaleResolutionDownBy)>1&&(t.scaleResolutionDownBy=h._encoderConfig.scaleResolutionDownBy)),jc("DSCP_TYPE")&&Da()){var l;const e=jc("DSCP_TYPE");is(l=["very-low","low","medium","high"]).call(l,e)&&(t.networkPriority=e)}const u=d.sender.getParameters(),p=null===(n=u.encodings)||void 0===n?void 0:n[0];Ia()&&!p&&(e.encodings=[t]),p&&ri(p,t),ri(u,e),await d.sender.setParameters(u)}}}catch(e){Rc.debug("Apply RTPSendEncodings failed.")}}mungSendOfferSDP(e,t,r){const i=$v.parse(e);return Jr(t).call(t,(e,t)=>{var n;const o=r[t],s=Qo(n=i.mediaDescriptions).call(n,e=>e.attributes.mid===o);s&&(nE(s,e),function(e,t,r){var i;if(Ia())return;if("video"!==e.media.mediaType)return;if(!(t instanceof Tv))return;if("vp9"!==r&&"vp8"!==r)return;if("vp8"===r&&!jc("SIMULCAST"))return;if(void 0===t._scalabiltyMode||t._scalabiltyMode.numSpatialLayers<=1)return;const n="vp8"===r?2:t._scalabiltyMode.numSpatialLayers,o=e.attributes.ssrcs[0],s=Qo(i=e.attributes.ssrcGroups).call(i,e=>"FID"===e.semantic&&e.ssrcIds[0]===o.ssrcId),a={semantic:"SIM",ssrcIds:[o.ssrcId]};for(let c=1;c<n;c++)e.attributes.ssrcs.push({ssrcId:o.ssrcId+c,attributes:jp(o.attributes)}),a.ssrcIds.push(o.ssrcId+c),s&&(e.attributes.ssrcs.push({ssrcId:s.ssrcIds[1]+c,attributes:jp(o.attributes)}),e.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[o.ssrcId+c,s.ssrcIds[1]+c]}));e.attributes.ssrcGroups.unshift(a)}(s,e,this.store.codec))}),$v.print(i)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=e=>{var t;null===(t=this.onFirstAudioReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoReceived=e=>{var t;null===(t=this.onFirstVideoReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstAudioDecoded=e=>{var t;null===(t=this.onFirstAudioDecoded)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoDecoded=(e,t,r)=>{var i;null===(i=this.onFirstVideoDecoded)||void 0===i||i.call(this,e,t,r)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0}async applySimulcastForFirefox(e,t){if(e.length===t.length)for(let a=0;a<e.length;a++){var r,i,n,o,s;const c=e[a],l=t[a];if(l instanceof Tv&&!is(r=l._hints).call(r,Eu.LOW_STREAM)&&null!==(i=l._encoderConfig)&&void 0!==i&&i.bitrateMax&&(null===(n=l._encoderConfig)||void 0===n?void 0:n.bitrateMax)>200&&null!==(o=l._scalabiltyMode)&&void 0!==o&&o.numSpatialLayers&&(null===(s=l._scalabiltyMode)||void 0===s?void 0:s.numSpatialLayers)>1&&"vp8"===this.store.codec){const e={},t={high:1e3*(l._encoderConfig.bitrateMax-50),medium:5e4};e.encodings=[{rid:"m",active:!0,maxBitrate:t.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:t.high}];const r=c.sender.getParameters();await c.sender.setParameters(ri(r,e))}}}async applySimulcastEncodings(e,t){if(!Ia()&&e.length===t.length)for(let r=0;r<e.length;r++){const i=t[r];if(i instanceof Tv&&this.isVP8Simulcast(i)){const t=e[r],n={},o={high:1e3*(i._encoderConfig.bitrateMax-50),medium:5e4};n.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:o.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:o.medium,scaleResolutionDownBy:4}];const s=t.sender.getParameters();await t.sender.setParameters(ri(s,n))}}}isVP8Simulcast(e){var t,r,i,n,o;return e instanceof Tv&&jc("SIMULCAST")&&"vp8"===this.store.codec&&!is(t=e._hints).call(t,Eu.LOW_STREAM)&&(null===(r=e._encoderConfig)||void 0===r?void 0:r.bitrateMax)&&(null===(i=e._encoderConfig)||void 0===i?void 0:i.bitrateMax)>200&&(null===(n=e._scalabiltyMode)||void 0===n?void 0:n.numSpatialLayers)&&(null===(o=e._scalabiltyMode)||void 0===o?void 0:o.numSpatialLayers)>1}logSDPExchange(e,t,r,i){var n,o;if((jc("UPLOAD_LOG")||jc("SDP_LOGGING"))&&(Rc.upload(Je(n=Je(o="exchanging ".concat(r," ")).call(o,t," SDP during P2PConnection.")).call(n,i,"\n"),e),"offer"===t))return e=>{this.logSDPExchange(e,"answer","local"===r?"remote":"local",i)}}}function VE(e,t,r){const i=e[t];if("function"!=typeof i)throw new Error("Cannot use mutex on object property.");return r.value=async function(...e){const r=this.mutex,n=await r.lock("Locking from P2PConnection.".concat(t));try{return await i.apply(this,e)}finally{n()}},r}function jE(e,t){let r=document.createElement("video"),i=document.createElement("canvas");r.setAttribute("style","display:none"),i.setAttribute("style","display:none"),r.setAttribute("muted",""),r.muted=!0,r.setAttribute("autoplay",""),r.autoplay=!0,r.setAttribute("playsinline",""),i.width=fp(t.width),i.height=fp(t.height);const n=fp(t.framerate||15);document.body.append(r),document.body.append(i);let o=e._mediaStreamTrack;r.srcObject=new MediaStream([o]),r.play();const s=i.getContext("2d");if(!s)throw new pl(ll.UNEXPECTED_ERROR,"can not get canvas context");const a=Fu(),c=i.captureStream(a.supportRequestFrame?0:n).getVideoTracks()[0],l=vh(()=>(()=>{if(r.paused&&r.play(),r.videoHeight>2&&r.videoWidth>2){const e=r.videoWidth,o=r.videoHeight/e,s=i.width*o;var t,n,a;Math.abs(s-i.height)>=2&&(Rc.debug("adjust low stream resolution",Je(t=Je(n=Je(a="".concat(i.width,"x")).call(a,i.height," -> ")).call(n,i.width,"x")).call(t,s)),i.height=s)}s.drawImage(r,0,0,i.width,i.height),c.requestFrame&&c.requestFrame(),o!==e._mediaStreamTrack&&(o=e._mediaStreamTrack,r.srcObject=new MediaStream([o]))})(),n),u=c.stop;return c.stop=()=>{u.call(c),l(),r.remove(),i.width=0,i.remove(),i=null,r=null,Rc.debug("clean low stream renderer")},c}function GE(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function HE(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=GE(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=GE(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}BE([VE,UE("design:type",Function),UE("design:paramtypes",[Object,Object,Array,Object,String,String,String,String]),UE("design:returntype",fo)],FE.prototype,"connect",null),BE([VE,UE("design:type",Function),UE("design:paramtypes",[Array]),UE("design:returntype",fo)],FE.prototype,"stopSending",null),BE([VE,UE("design:type",Function),UE("design:paramtypes",[String,Array,String,Object]),UE("design:returntype",fo)],FE.prototype,"receive",null),BE([VE,UE("design:type",Function),UE("design:paramtypes",[Array]),UE("design:returntype",fo)],FE.prototype,"stopReceiving",null),BE([VE,UE("design:type",Function),UE("design:paramtypes",[String]),UE("design:returntype",fo)],FE.prototype,"muteRemote",null),BE([VE,UE("design:type",Function),UE("design:paramtypes",[String]),UE("design:returntype",fo)],FE.prototype,"unmuteRemote",null),BE([VE,UE("design:type",Function),UE("design:paramtypes",[Array]),UE("design:returntype",fo)],FE.prototype,"muteLocal",null),BE([VE,UE("design:type",Function),UE("design:paramtypes",[Array]),UE("design:returntype",fo)],FE.prototype,"unmuteLocal",null),BE([VE,UE("design:type",Function),UE("design:paramtypes",[]),UE("design:returntype",fo)],FE.prototype,"reEstablish",null),BE([VE,UE("design:type",Function),UE("design:paramtypes",[]),UE("design:returntype",void 0)],FE.prototype,"close",null),BE([VE,UE("design:type",Function),UE("design:paramtypes",[String,lh]),UE("design:returntype",fo)],FE.prototype,"updateEncoderConfig",null),BE([VE,UE("design:type",Function),UE("design:paramtypes",[String,lh]),UE("design:returntype",fo)],FE.prototype,"updateSendParameters",null),BE([VE,UE("design:type",Function),UE("design:paramtypes",[lh,String]),UE("design:returntype",fo)],FE.prototype,"replaceTrack",null),BE([VE,UE("design:type",Function),UE("design:paramtypes",[Object,Object,Array,String,String]),UE("design:returntype",fo)],FE.prototype,"restartICE",null);class QE extends oh{constructor(e,t,r,i){var n,o,s;super(e,Je(n=Je(o=Je(s="track-".concat(e.kind,"-")).call(s,t,"-")).call(o,i.clientId,"_")).call(n,kp(5,""))),this._isDestroyed=!1,this._userId=t,this._uintId=r,this.store=i}getUserId(){return this._userId}_updateOriginMediaStreamTrack(e){this._originMediaStreamTrack=e,this._mediaStreamTrack=e,this._updatePlayerSource()}_destroy(){this._isDestroyed=!0,Rc.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}}class WE extends QE{constructor(e,t,r,i){super(e,t,r,i),this._videoVisibleTimer=null,this.trackMediaType="video",this.updateMediaStreamTrackResolution()}get isPlaying(){return!(!this._player||this._player.videoElementStatus!==dl.PLAYING)}getStats(){return Hp(()=>{Rc.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),xp(this,vu.GET_STATS)||HE({},iu)}play(e,t={}){const r=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.REMOTE_VIDEO_TRACK_PLAY,options:[this.getTrackId(),"string"==typeof e?e:"HTMLElement",t]});if("string"==typeof e){const t=document.getElementById(e);var i;t?e=t:(Rc.warning(Je(i="[".concat(this.getTrackId(),'] can not find "#')).call(i,e,'" element, use document.body')),e=document.body)}Rc.debug("[".concat(this.getTrackId(),"] start video playback"),ve(t));const n=HE({fit:"cover"},t,{trackId:this.getTrackId(),element:e});this._player?this._player.updateConfig(n):(this._player=new H_(n),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,performance.now()),this.emit(yu.FIRST_FRAME_DECODED)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=window.setInterval(()=>{try{const e=this.getVideoElementVisibleStatus();this.emit(yu.VIDEO_ELEMENT_VISIBLE_STATUS,e)}catch(e){}},jc("CHECK_VIDEO_VISIBLE_INTERVAL")),r.onSuccess()}stop(){const e=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.REMOTE_VIDEO_TRACK_STOP,options:[this.getTrackId()]});if(!this._player)return e.onSuccess();this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._player.destroy(),this._player=void 0,Rc.debug("[".concat(this.getTrackId(),"] stop video playback")),e.onSuccess()}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){Lp(this._originMediaStreamTrack).then(([e,t])=>{this._videoHeight=t,this._videoWidth=e}).catch(Np)}_updatePlayerSource(){Rc.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var e,t;const r=null==this||null===(e=this._player)||void 0===e?void 0:e.getContainerElement(),i={track:this,element:null==this||null===(t=this._player)||void 0===t?void 0:t.getVideoElement(),slot:null==r?void 0:r.parentElement},{element:n,slot:o}=i;if(this.isPlaying&&n instanceof HTMLVideoElement&&o instanceof HTMLElement){const e=Ev.checkOneElementVisible(n),t=ri({},e);return t.visible||nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]}).onSuccess("Not visible because of ".concat(t.reason)),t}return}catch(e){throw new pl(ll.GET_VIDEO_ELEMENT_VISIBLE_ERROR,e.message)}}}class qE extends QE{constructor(e,t,r,i){super(e,t,r,i),this.trackMediaType="audio",this._useAudioElement=!0,this._volume=100,this._source=new Ah(e,!0),this._source.once(Zl.RECEIVE_TRACK_BUFFER,()=>{this.emit(yu.FIRST_FRAME_DECODED)})}get isPlaying(){return this._useAudioElement?Mh.isPlaying(this.getTrackId()):this._source.isPlayed}setAudioFrameCallback(e,t=4096){if(!e)return this._source.removeAllListeners(Zl.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(t),this._source.removeAllListeners(Zl.ON_AUDIO_BUFFER),this._source.on(Zl.ON_AUDIO_BUFFER,t=>e(t))}setVolume(e){const t=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.REMOTE_AUDIO_SET_VOLUME,options:[this.getTrackId(),e]},300);this._volume=e,this._useAudioElement?Mh.setVolume(this.getTrackId(),e):this._source.setVolume(e/100),t.onSuccess()}async setPlaybackDevice(e){const t=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.REMOTE_AUDIO_SET_OUTPUT_DEVICE,options:[this.getTrackId(),e]});if(!this._useAudioElement)throw new pl(ll.NOT_SUPPORTED,"your browser does not support setting the audio output device");try{await Mh.setSinkID(this.getTrackId(),e)}catch(e){throw t.onError(e),e}t.onSuccess()}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return Hp(()=>{Rc.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),xp(this,vu.GET_STATS)||HE({},tu)}play(){const e=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.REMOTE_AUDIO_TRACK_PLAY,options:[this.getTrackId()]});Rc.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(Rc.debug("[".concat(this.getTrackId(),"] use audio element to play")),Mh.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play(),e.onSuccess()}stop(){const e=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.REMOTE_AUDIO_TRACK_STOP,options:[this.getTrackId()]});Rc.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?Mh.stop(this.getTrackId()):this._source.stop(),e.onSuccess()}_destroy(){super._destroy(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){Rc.debug("[".concat(this.getTrackId(),"] update player source track")),this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&Mh.updateTrack(this.getTrackId(),this._mediaStreamTrack)}}function zE(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function ZE(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=zE(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=zE(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}class YE extends Mu{constructor(){super(),this.uploadUnplinkStarted=!1,this.uploadDownlinkStarted=!1}startUploadUplinkStats(){this.uploadUnplinkStarted||(this.uploadUnplinkStarted=!0,this.uplinkStatsUploadInterval&&window.clearInterval(this.uplinkStatsUploadInterval),this.uplinkStatsUploadInterval=window.setInterval(()=>{var e;const t=null===(e=this.requestStats)||void 0===e?void 0:e.call(this);t&&(this.uploadUplinkStats(t,this.lastStats),this.lastStats=t)},3e3),this.uplinkStatsUploadSlowInterval&&window.clearInterval(this.uplinkStatsUploadSlowInterval),this.uplinkStatsUploadSlowInterval=window.setInterval(()=>{var e;const t=null===(e=this.requestStats)||void 0===e?void 0:e.call(this);t&&this.uploadSlowUplinkStats(t)},6e4),this.uplinkRelatedStatsUploadInterval&&window.clearInterval(this.uplinkRelatedStatsUploadInterval),this.uplinkRelatedStatsUploadInterval=window.setInterval(()=>{var e;const t=null===(e=this.requestStats)||void 0===e?void 0:e.call(this);t&&this.uploadRelatedUplinkStats(t,this.lastStats),this.lastStats=t},1e3))}uploadUplinkStats(e,t){var r;const i=(null===(r=this.requestLocalMedia)||void 0===r?void 0:r.call(this))||[];Jr(i).call(i,([r,{track:i,ssrcs:n}])=>{switch(r){case Ou.LocalVideoLowTrack:case Ou.LocalVideoTrack:{const o=function(e,t,r){var i,n;const o=Qo(i=t.videoSend).call(i,t=>t.ssrc===e);if(!o)return null;const s={id:kp(10,""),timestamp:new Date(t.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:o.ssrc.toString()};switch(s.A_vstd=r._originMediaStreamTrack&&!r._originMediaStreamTrack.enabled||!r._mediaStreamTrack.enabled?"1":"0",o.sentFrame&&(s.A_fhs=o.sentFrame.height.toString(),s.A_frs=o.sentFrame.frameRate.toString(),s.A_fws=o.sentFrame.width.toString()),o.adaptionChangeReason){case"none":s.A_ac="0";break;case"cpu":s.A_ac="1";break;case"bandwidth":s.A_ac="2";break;case"other":s.A_ac="3"}return s.A_lvps=Cl[r._player?r._player.videoElementStatus:"uninit"].toString(),s.A_nr=null===(n=o.nacksCount)||void 0===n?void 0:n.toString(),o.avgEncodeMs&&(s.A_aem=o.avgEncodeMs.toFixed(0).toString()),s}(n[0].ssrcId,e,i),s=mp(n[0].ssrcId,e,t);o&&Vp(()=>{var e;return null===(e=this.requestUpload)||void 0===e?void 0:e.call(this,Wl.PUBLISH_STATS,{stream_type:r===Ou.LocalVideoLowTrack?"low":"high",stats:ZE({},o,{},s)})});break}case Ou.LocalAudioTrack:{const t=function(e,t,r){var i;const n=Qo(i=t.audioSend).call(i,t=>t.ssrc===e);if(!n)return null;const o={id:kp(10,""),timestamp:new Date(t.timestamp).toISOString(),mediaType:"audio",type:"ssrc",ssrc:n.ssrc.toString()};return o.A_astd=r._originMediaStreamTrack.enabled&&r._mediaStreamTrack.enabled?"0":"1",n.inputLevel?o.A_ail=Math.round(100*n.inputLevel).toString():o.A_ail=Math.round(100*r._source.getAccurateVolumeLevel()).toString(),o.A_apil=Math.round(100*r._source.getAccurateVolumeLevel()).toString(),o}(n[0].ssrcId,e,i);t&&Vp(()=>{var e;return null===(e=this.requestUpload)||void 0===e?void 0:e.call(this,Wl.PUBLISH_STATS,{stream_type:"high",stats:t})});break}}const o=function(e){const t={id:"bweforvideo",timestamp:new Date(e.timestamp).toISOString(),type:"VideoBwe"};return e.bitrate.retransmit&&(t.A_rb=e.bitrate.retransmit.toString()),e.bitrate.targetEncoded&&(t.A_teb=e.bitrate.targetEncoded.toString()),t.A_aeb=e.bitrate.actualEncoded.toString(),t.A_tb=e.bitrate.transmit.toString(),void 0!==e.sendBandwidth&&(t.A_asb=e.sendBandwidth.toString()),t}(e);o&&Vp(()=>{var e;return null===(e=this.requestUpload)||void 0===e?void 0:e.call(this,Wl.PUBLISH_STATS,{stream_type:r===Ou.LocalVideoLowTrack?"low":"high",stats:o})})})}uploadSlowUplinkStats(e){var t,r;const i=ji(t=(null===(r=this.requestLocalMedia)||void 0===r?void 0:r.call(this))||[]).call(t,([e])=>e===Ou.LocalVideoLowTrack||e===Ou.LocalVideoTrack);Jr(i).call(i,([t,{ssrcs:r}])=>{const i=mp(r[0].ssrcId,e);i&&Vp(()=>{var e;return null===(e=this.requestUpload)||void 0===e?void 0:e.call(this,Wl.PUBLISH_STATS,{stream_type:t===Ou.LocalVideoLowTrack?"low":"high",stats:i})})})}uploadRelatedUplinkStats(e,t){var r,i;const n=ji(r=(null===(i=this.requestLocalMedia)||void 0===i?void 0:i.call(this))||[]).call(r,([e])=>e===Ou.LocalVideoLowTrack||e===Ou.LocalVideoTrack);Jr(n).call(n,([t,{ssrcs:r}])=>{const i=function(e,t){var r;const i=Qo(r=t.videoSend).call(r,t=>t.ssrc===e);return i?{mediaType:"video",isVideoMute:!1,frameRateInput:i.inputFrame&&i.inputFrame.frameRate.toString(),frameRateSent:i.sentFrame&&i.sentFrame.frameRate.toString(),googRtt:i.rttMs.toString()}:null}(r[0].ssrcId,e);i&&Vp(()=>{var e;null===(e=this.requestUpload)||void 0===e||e.call(this,Wl.PUBLISH_RELATED_STATS,{stream_type:t===Ou.LocalVideoLowTrack?"low":"high",stats:i})})})}stopUploadUplinkStats(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStatsUploadInterval&&window.clearInterval(this.uplinkStatsUploadInterval),this.uplinkRelatedStatsUploadInterval&&window.clearInterval(this.uplinkRelatedStatsUploadInterval),this.uplinkStatsUploadInterval=void 0,this.uplinkRelatedStatsUploadInterval=void 0)}startUploadDownlinkStats(){this.uploadDownlinkStarted||(this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval),this.downlinkStatsUploadInterval=window.setInterval(()=>{var e;const t=null===(e=this.requestStats)||void 0===e?void 0:e.call(this);t&&(this.uploadDownlinkStats(t,this.lastStats),this.lastStats=t)},3e3),this.downlinkStatsUploadSlowInterval&&window.clearInterval(this.downlinkStatsUploadSlowInterval),this.downlinkStatsUploadSlowInterval=window.setInterval(()=>{var e;const t=null===(e=this.requestStats)||void 0===e?void 0:e.call(this);t&&this.uploadSlowDownlinkStats(t)},6e4),this.downlinkRelatedStatsUploadInterval&&window.clearInterval(this.downlinkRelatedStatsUploadInterval),this.downlinkRelatedStatsUploadInterval=window.setInterval(()=>{var e;const t=null===(e=this.requestStats)||void 0===e?void 0:e.call(this);t&&(this.uploadRelatedDownlinkStats(t,this.lastStats),this.lastStats=t)},1e3))}uploadDownlinkStats(e,t){var r;const i=(null===(r=this.requestRemoteMedia)||void 0===r?void 0:r.call(this))||[];Jr(i).call(i,([t,r])=>{if(r.has(ku.VIDEO)&&t.videoTrack){const r=t.videoTrack?function(e,t,r){var i;const n=Qo(i=t.videoRecv).call(i,t=>t.ssrc===e);if(!n)return null;const o={id:kp(10,""),timestamp:new Date(t.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:n.ssrc.toString()};var s;return o.bytesReceived=n.bytes.toString(),o.packetsLost=n.packetsLost.toString(),o.packetsReceived=n.packets.toString(),n.framesRateFirefox&&(o.A_frr=n.framesRateFirefox.toString()),n.receivedFrame&&(o.A_frr=n.receivedFrame.frameRate.toString()),o.A_frd=n.decodeFrameRate.toString(),n.outputFrame&&(o.A_fro=n.outputFrame.frameRate.toString()),void 0!==n.jitterBufferMs&&(o.A_jbm=Math.floor(n.jitterBufferMs).toString()),void 0!==n.currentDelayMs&&(o.A_cdm=Math.floor(n.currentDelayMs).toString()),o.A_fs=n.firsCount.toString(),o.A_ns=n.nacksCount.toString(),o.A_ps=n.plisCount.toString(),r&&(o.A_vrtd=r._originMediaStreamTrack.enabled&&r._mediaStreamTrack.enabled?"0":"1"),r._player&&r._player.freezeTimeCounterList.length>0&&(o.A_vrft=bo(s=r._player.freezeTimeCounterList).call(s,0,1)[0].toString()),o.A_rvps=Cl[r._player?r._player.videoElementStatus:"uninit"].toString(),o}(t._videoSSRC,e,t.videoTrack):void 0;r&&Vp(()=>{var e;return null===(e=this.requestUpload)||void 0===e?void 0:e.call(this,Wl.SUBSCRIBE_STATS,{stream_id:t.uid,stats:r})})}if(r.has(ku.AUDIO)&&t.audioTrack){const r=t.audioTrack?function(e,t,r){var i;const n=Qo(i=t.audioRecv).call(i,t=>t.ssrc===e);if(!n)return null;const o={id:kp(10,""),timestamp:new Date(t.timestamp).toISOString(),mediaType:"audio",type:"ssrc",ssrc:n.ssrc.toString()};return o.bytesReceived=n.bytes.toString(),o.packetsLost=n.packetsLost.toString(),o.packetsReceived=n.packets.toString(),n.outputLevel?o.A_aol=Math.round(100*n.outputLevel).toString():o.A_aol=Math.round(100*r._source.getAccurateVolumeLevel()).toString(),o.A_apol=Math.round(100*r._source.getAccurateVolumeLevel()).toString(),r&&(o.A_artd=r._originMediaStreamTrack.enabled&&r._mediaStreamTrack.enabled?"0":"1"),o.A_jr=n.jitterMs.toString(),o.A_jbm=Math.floor(n.jitterBufferMs).toString(),o.A_cdm=Math.floor(n.jitterBufferMs).toString(),o.A_raps=Cl[Mh.getPlayerState(r.getTrackId())].toString(),o}(t._audioSSRC,e,t.audioTrack):void 0;r&&Vp(()=>{var e;return null===(e=this.requestUpload)||void 0===e?void 0:e.call(this,Wl.SUBSCRIBE_STATS,{stream_id:t.uid,stats:r})})}})}uploadSlowDownlinkStats(e){}uploadRelatedDownlinkStats(e,t){var r;const i=(null===(r=this.requestRemoteMedia)||void 0===r?void 0:r.call(this))||[];Jr(i).call(i,([r,i])=>{if(i.has(ku.VIDEO)&&r.videoTrack){var n;const i=!0===(r._videoSSRC&&(null===(n=this.requestVideoIsReady)||void 0===n?void 0:n.call(this,r._videoSSRC))||!1),o=function(e,t,r,i,n,o){var s,a;const c=Qo(s=r.videoRecv).call(s,t=>t.ssrc===e),l=n?Qo(a=n.videoRecv).call(a,t=>t.ssrc===e):void 0;if(!c)return null;const u=Kh.isRemoteVideoFreeze(o,c,l)&&t,d={mediaType:"video",isVideoMute:!1,peerId:i,frameRateReceived:c.receivedFrame&&c.receivedFrame.frameRate.toString(),frameRateDecoded:c.decodedFrame&&c.decodedFrame.frameRate.toString(),isFreeze:u,bytesReceived:c.bytes.toString(),packetsReceived:c.packets.toString(),packetsLost:c.packetsLost.toString()};return c.framesRateFirefox&&(d.frameRateDecoded=c.framesRateFirefox.toString(),d.frameRateReceived=c.framesRateFirefox.toString()),d}(r._videoSSRC,i,e,r.uid,t,r.videoTrack);o&&Vp(()=>{var e;null===(e=this.requestUpload)||void 0===e||e.call(this,Wl.SUBSCRIBE_RELATED_STATS,{stream_id:r.uid,stats:o})})}if(i.has(ku.AUDIO)&&r.audioTrack){const t=function(e,t,r,i){var n;const o=Qo(n=t.audioRecv).call(n,t=>t.ssrc===e);if(!o)return null;const s=Kh.isRemoteAudioFreeze(i);return{mediaType:"audio",isAudioMute:!1,peerId:r,googJitterReceived:o.jitterMs.toString(),isFreeze:s,bytesReceived:o.bytes.toString(),packetsReceived:o.packets.toString(),packetsLost:o.packetsLost.toString(),frameReceived:o.receivedFrames.toString(),frameDropped:o.droppedFrames.toString()}}(r._audioSSRC,e,r.uid,r.audioTrack);t&&Vp(()=>{var e;null===(e=this.requestUpload)||void 0===e||e.call(this,Wl.SUBSCRIBE_RELATED_STATS,{stream_id:r.uid,stats:t})})}})}stopUploadDownlinkStats(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval),this.downlinkRelatedStatsUploadInterval&&window.clearInterval(this.downlinkRelatedStatsUploadInterval),this.downlinkStatsUploadInterval=void 0,this.downlinkRelatedStatsUploadInterval=void 0)}}function KE(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function $E(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=KE(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=KE(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}var JE=function(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Bi(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&di(t,r,s),s},XE=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class eA extends Mu{constructor(e,t){super(),this.localTrackMap=new Mr,this.remoteUserMap=new Mr,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.isPlanB=!1,this.iceFailedCount=0,this.dtlsFailedCount=0,this.mutex=new ah("P2PChannel-mutex"),this._state=Nu.Disconnected,this.handleMuteLocalTrack=async(e,t,r)=>{const i=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection)return void r(new pl(ll.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));await this.waitTillConnected();const n=this.filterTobeMutedTracks(e);if(0===n.length)return void t();await this.connection.muteLocal(vo(n).call(n,([,{id:e}])=>e));const o=this.createMuteMessage(n);await Mp(this,Lu.RequestMuteLocal,o),t()}catch(e){r(e)}finally{i()}},this.handleUnmuteLocalTrack=async(e,t,r)=>{const i=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection)return void r(new pl(ll.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));await this.waitTillConnected();const n=this.filterTobeUnmutedTracks(e);if(0===n.length)return void t();await this.connection.unmuteLocal(vo(n).call(n,([,{id:e}])=>e));const o=this.createUnmuteMessage(n);await Mp(this,Lu.RequestUnmuteLocal,o),t()}catch(e){r(e)}finally{i()}},this.handleUpdateVideoEncoder=async(e,t,r)=>{const i=await this.mutex.lock("Locking from P2PChannel.handleSetVideoEncoder");try{const r=this.localTrackMap.get(Ou.LocalVideoTrack);if(!this.connection||!r||r.track!==e)return void t();await this.waitTillConnected();const{id:n,track:o}=r;await this.connection.updateSendParameters(n,o),await this.connection.updateEncoderConfig(n,o),t()}catch(e){r(e)}finally{i()}},this.handleSetOptimizationMode=async(e,t,r)=>{const i=await this.mutex.lock("Locking from P2PChannel.handleSetOptimizationMode");try{const r=this.localTrackMap.get(Ou.LocalVideoTrack);if(!this.connection||!r||r.track!==e)return;await this.waitTillConnected();const{id:n,track:o}=r;await this.connection.updateSendParameters(n,o),t()}catch(e){r(e)}finally{i()}},this.handleReplaceTrack=async(e,t,r)=>{try{var i,n;const r=Qo(i=Bd(Dd(n=this.localTrackMap).call(n))).call(i,([,{track:t}])=>e===t);if(!this.connection||!r)return void t();if(await this.waitTillConnected(),await this.connection.replaceTrack(e,r[1].id),this.isPlanB){const t=r[1];t.id=e._mediaStreamTrack.id,this.localTrackMap.set(r[0],t)}t()}catch(e){r(e)}},this.handleGetLocalVideoStats=e=>{e(this.statsCollector.getLocalVideoTrackStats())},this.handleGetLocalAudioStats=e=>{e(this.statsCollector.getLocalAudioTrackStats())},this.handleGetRemoteVideoStats=e=>this.statsCollector.getRemoteVideoTrackStats(e.uid)[e.uid],this.handleGetRemoteAudioStats=e=>this.statsCollector.getRemoteAudioTrackStats(e.uid)[e.uid],this.store=e,this.statsCollector=t,this.statsCollector.addP2PChannel(this),this.statsUploader=new YE,this.bindStatsUploaderEvents(),this.isPlanB=!Fu().supportUnifiedPlan||jc("CHROME_FORCE_PLAN_B")&&Da()}get state(){return this._state}set state(e){const t=this._state;this._state=e,this.emit(Lu.StateChange,t,this._state)}async startP2PConnection(e){return this.state=Nu.New,this.connection=this.isPlanB?new LE(e,this.store):new FE(e,this.store),this.bindConnectionEvents(this.connection),this.store.peerConnectionStart(),this.connection.establish()}async connect(e,t,r,i,n,o,s,a){if(!this.connection)throw new pl(ll.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");await this.connection.connect(e,t,r,i,n,o,s,a),this.state=Nu.Connected}publish(e,t,r){var i=this;return Qv((function*(){const n=yield Wv(i.mutex.lock("From P2PChannel.publish"));if(i.connection){i.store.pubId=i.store.pubId+1,zh.markPublishStart(i.store.clientId,i.store.pubId);try{yield Wv(i.waitTillConnected());const o=i.filterTobePublishedTracks(e,t,r);if(0===o.length)return;yield*Kv(Yv(i.doPublish(i.connection,o)),Wv)}finally{n()}}else{var o;if(i.state===Nu.Disconnected)throw new pl(ll.UNEXPECTED_ERROR,"PeerConnection already disconnected.");i.throwIfTrackTypeNotMatch(e);const t=ji(e).call(e,e=>{var t;return-1===Lo(t=i.pendingLocalTracks).call(t,e)});i.pendingLocalTracks=Je(o=i.pendingLocalTracks).call(o,t)}}))()}doPublish(e,t){var r=this;return Qv((function*(){Jr(t).call(t,({track:e,type:t})=>{const i=performance.now();r.store.publish(e.getTrackId(),t===Ou.LocalAudioTrack?"audio":"video",i)});const i=yield Wv(e.send(vo(t).call(t,({track:e})=>e),r.store.codec)),n=(yield Wv(i.next())).value,o=r.createGatewayPublishMessage(t,n);let s;try{s=yield o}catch(e){throw i.throw(e),(null==e?void 0:e.code)===ll.WS_ABORT&&Jr(t).call(t,({track:e})=>{var t;-1===Lo(t=r.pendingLocalTracks).call(t,e)&&r.pendingLocalTracks.push(e)}),e}const a=r.mapPubResToRemoteConfig(o,s),c=(yield Wv(i.next(a))).value;Jr(t).call(t,({type:e})=>{r.statsCollector.addLocalStats(e)}),r.bindLocalTrackEvents(t),r.assignLocalTracks(t,c),r.statsUploader.startUploadUplinkStats(),Jr(t).call(t,({track:e,type:t})=>{const i=performance.now();r.store.publish(e.getTrackId(),t===Ou.LocalAudioTrack?"audio":"video",void 0,i)})}))()}publishLowStream(e){var t=this;return Qv((function*(){if(!t.connection)return;const r=yield Wv(t.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const n=t.localTrackMap.get(Ou.LocalVideoTrack);if(!n)throw new pl(ll.UNEXPECTED_ERROR,"Could not find high stream");if(t.localTrackMap.has(Ou.LocalVideoLowTrack))throw new pl(ll.UNEXPECTED_ERROR,"[".concat(t.store.clientId,"] Can't publish low stream when stream already publish"));yield Wv(t.waitTillConnected());const o=[{track:t.getLowVideoTrack(n.track,e),type:Ou.LocalVideoLowTrack}];if(yield*Kv(Yv(t.doPublish(t.connection,o)),Wv),n.track.muted||!n.track.enabled){var i;const e=null===(i=t.localTrackMap.get(Ou.LocalVideoLowTrack))||void 0===i?void 0:i.id;void 0!==e&&(yield Wv(t.connection.muteLocal([e])))}}finally{r()}}))()}async republish(){this.pendingLocalTracks.length>0&&(Rc.debug("Emit P2PChannelEvents.RequestRePublish to republish tracks."),await Dp(this,Lu.RequestRePublish,this.pendingLocalTracks),this.emit(Lu.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async reSubscribe(e){var t;for(let i=this.pendingRemoteTracks.length-1;i>=0;i--){const{user:e,kind:t}=this.pendingRemoteTracks[i];var r;(t!==ku.AUDIO||e._audio_added_&&e._audioSSRC)&&(t!==ku.VIDEO||e._video_added_&&e._videoSSRC)||bo(r=this.pendingRemoteTracks).call(r,i,1)}if(e)await Dp(this,Lu.RequestReSubscribe,this.pendingRemoteTracks);else for(const{user:i,kind:n}of this.pendingRemoteTracks)await this.subscribe(i,n,n===ku.VIDEO?i._videoSSRC:i._audioSSRC);Jr(t=this.pendingRemoteTracks).call(t,({user:e})=>{this.emit(Lu.MediaReconnectEnd,e.uid)}),this.pendingRemoteTracks=[]}async unpublish(e){if(!this.connection)return void Jr(e).call(e,e=>{var t;const r=Lo(t=this.pendingLocalTracks).call(t,e);var i;-1!==r&&bo(i=this.pendingLocalTracks).call(i,r,1)});await this.waitTillConnected();const t=this.filterTobeUnpublishedTracks(e);return 0!==t.length?this.doUnpublish(this.connection,t):void 0}async unpublishLowStream(){if(!this.connection)return;const e=this.localTrackMap.get(Ou.LocalVideoLowTrack);if(!e)return;await this.waitTillConnected();const t=[[Ou.LocalVideoLowTrack,e]];return this.doUnpublish(this.connection,t)}async doUnpublish(e,t){const r=this.createGatewayUnpublishMessage(t);return await e.stopSending(vo(t).call(t,([,{id:e}])=>e)),this.withdrawLocalTracks(t),this.unbindLocalTrackEvents(t),Jr(t).call(t,([e])=>{this.statsCollector.removeLocalStats(e)}),0===this.localTrackMap.size&&this.statsUploader.stopUploadUplinkStats(),r}async subscribe(e,t,r,i){var n,o;if(!this.connection)throw new pl(ll.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if(null!==(n=this.remoteUserMap.get(e))&&void 0!==n&&n.has(t))return;let s,a;if(await this.waitTillConnected(),i){const r=Qo(i).call(i,({stream_type:e})=>e===t);var c,l;if(!r)throw new pl(ll.UNEXPECTED_ERROR,Je(c=Je(l="Cannot subscribe to remote ".concat(t," for user: ")).call(l,e.uid," because subscribe answer from gateway does not contain stream_type: ")).call(c,t,"."));const n=await this.connection.receive(t,r.ssrcs,String(e.uid),r.attributes);s=n.track,a=n.id}else{const i=await this.connection.receive(t,[{ssrcId:r}],String(e.uid),void 0);s=i.track,a=i.id}var u,d;t===ku.AUDIO?e._audioTrack?e._audioTrack._updateOriginMediaStreamTrack(s):(e._audioTrack=new qE(s,e.uid,e._uintid,this.store),Rc.info(Je(u="[".concat(this.store.p2pId,"] create remote audio track: ")).call(u,e._audioTrack.getTrackId())),this.bindRemoteTrackEvents(e,e._audioTrack)):e._videoTrack?e._videoTrack._updateOriginMediaStreamTrack(s):(e._videoTrack=new WE(s,e.uid,e._uintid,this.store),Rc.info(Je(d="[".concat(this.store.p2pId,"] create remote video track: ")).call(d,e._videoTrack.getTrackId())),this.bindRemoteTrackEvents(e,e._videoTrack));const h=this.remoteUserMap.get(e);h?h.set(t,a):this.remoteUserMap.set(e,new Mr([[t,a]])),this.statsCollector.addRemoteStats(e.uid),this.statsUploader.startUploadDownlinkStats();const p=Lv(o=this.pendingRemoteTracks).call(o,({user:r,kind:i})=>r.uid===e.uid&&t===i);var f;-1!==p&&(bo(f=this.pendingRemoteTracks).call(f,p,1),this.emit(Lu.MediaReconnectEnd,e.uid))}async unsubscribe(e,t){var r;const i=ji(r=this.pendingRemoteTracks).call(r,({user:r,kind:i})=>void 0!==t?r.uid===e.uid&&t===i:r.uid===e.uid);if(Jr(i).call(i,e=>{var t,r;const i=Lo(t=this.pendingRemoteTracks).call(t,e);bo(r=this.pendingRemoteTracks).call(r,i,1)}),!this.connection)return void Jr(i).call(i,({kind:t})=>{var r;if(t===ku.AUDIO)null===(r=e._audioTrack)||void 0===r||r._destroy(),e._audioTrack=void 0;else if(t===ku.VIDEO){var i;null===(i=e._videoTrack)||void 0===i||i._destroy(),e._videoTrack=void 0}});const n=this.filterTobeUnSubscribedTracks(e,t);if(0===n.length)return;await this.connection.stopReceiving(vo(n).call(n,([,{id:e}])=>e));const o=this.createUnsubscribeMessage(n);return this.withdrawRemoteTracks(n),0===this.remoteUserMap.size&&this.statsUploader.stopUploadDownlinkStats(),Jr(n).call(n,([e,{kind:t}])=>{var r,i;if(t===ku.VIDEO&&e._videoSSRC&&(null===(r=this.connection)||void 0===r||r.setStatsRemoteVideoIsReady(e._videoSSRC,!1)),t===ku.VIDEO)this.unbindRemoteTrackEvents(e._videoTrack),null===(i=e._videoTrack)||void 0===i||i._destroy(),e._videoTrack=void 0;else if(t===ku.AUDIO){var n;this.unbindRemoteTrackEvents(e._audioTrack),null===(n=e._audioTrack)||void 0===n||n._destroy(),e._audioTrack=void 0}}),o}async muteRemote(e,t){if(!this.connection)return;const r=this.remoteUserMap.get(e);if(!r)return void Rc.warning("P2PChannel.unmuteRemote has no remote user ".concat(e.uid,"."));const i=r.get(t);var n;if(!i)return void Rc.warning(Je(n="P2PChannel.unmuteRemote has no remote user ".concat(e.uid," media type ")).call(n,t,"."));const o=t===ku.VIDEO?e._videoSSRC:e._audioSSRC;void 0!==o&&this.connection.setStatsRemoteVideoIsReady(o,!1),await this.connection.muteRemote(i)}async unmuteRemote(e,t){if(!this.connection)return;const r=this.remoteUserMap.get(e);if(!r)return void Rc.warning("P2PChannel.unmuteRemote has no remote user ".concat(e.uid,"."));const i=r.get(t);var n;i?await this.connection.unmuteRemote(i):Rc.warning(Je(n="P2PChannel.unmuteRemote has no remote user ".concat(e.uid," media type ")).call(n,t,"."))}getAllTracks(e){const t=this.localTrackMap.get(Ou.LocalAudioTrack);if((null==t?void 0:t.track)instanceof Qh){var r,i,n,o,s;const a=t.track;return Je(r=vo(i=ji(n=ji(o=Bd(Dd(s=this.localTrackMap).call(s))).call(o,([e])=>e!==Ou.LocalAudioTrack)).call(n,([t])=>!(e&&t===Ou.LocalVideoLowTrack))).call(i,([,{track:e}])=>e)).call(r,a.trackList)}var a,c,l;return vo(a=ji(c=Bd(Dd(l=this.localTrackMap).call(l))).call(c,([t])=>!(e&&t===Ou.LocalVideoLowTrack))).call(a,([,{track:e}])=>e)}reportPublishEvent(e,t,r,i,n){if(e){var o;const r=this.localTrackMap.get(Ou.LocalAudioTrack),s=i?this.localTrackMap.get(Ou.LocalVideoLowTrack):this.localTrackMap.get(Ou.LocalVideoTrack);nh.publish(this.store.sessionId,{eventElapse:zh.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:null==r?void 0:r.track.getTrackLabel(),videoName:null==s?void 0:s.track.getTrackLabel(),screenshare:-1!==(null==s?void 0:Lo(o=s.track._hints).call(o,Eu.SCREEN_TRACK)),audio:!!r,video:!!s,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:n})}else{var s,a;r||(r=[]);const o=Qo(r).call(r,e=>e instanceof jh),c=i?null===(s=this.localTrackMap.get(Ou.LocalVideoTrack))||void 0===s?void 0:s.track:Qo(r).call(r,e=>e instanceof Tv);nh.publish(this.store.sessionId,{eventElapse:zh.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:null==o?void 0:o.getTrackLabel(),videoName:null==c?void 0:c.getTrackLabel(),screenshare:-1!==(null==c?void 0:Lo(a=c._hints).call(a,Eu.SCREEN_TRACK)),audio:!!o,video:!!c,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:n})}}reportSubscribeEvent(e,t,r,i){const n=i===ku.VIDEO?r._videoSSRC:r._audioSSRC;n&&nh.subscribe(this.store.sessionId,{succ:e,ec:t,video:i===ku.VIDEO,audio:i===ku.AUDIO,peerid:r.uid,subscribeRequestid:i===ku.VIDEO?r._videoSSRC:r._audioSSRC,p2pid:this.store.p2pId,eventElapse:zh.measureFromSubscribeStart(this.store.clientId,n)})}reset(){Rc.debug("P2PChannel.reset"),this.mutex=new ah("P2PChannel-mutex"),this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.statsUploader.stopUploadUplinkStats(),this.statsUploader.stopUploadDownlinkStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.state=Nu.Disconnected}getStats(){var e;return null===(e=this.connection)||void 0===e?void 0:e.getStats()}getRemoteVideoIsReady(e){var t;return(null===(t=this.connection)||void 0===t?void 0:t.getRemoteVideoIsReady(e))||!1}getLocalAudioVolume(){const e=this.localTrackMap.get(Ou.LocalAudioTrack);if(e)return e.track.getVolumeLevel()}getLocalVideoSize(){const e=this.localTrackMap.get(Ou.LocalVideoTrack);if(e)return{width:e.track._videoWidth||0,height:e.track._videoHeight||0}}getEncoderConfig(e){const t=this.localTrackMap.get(e);return t&&t.track instanceof Tv||t&&t.track instanceof jh?t.track._encoderConfig:void 0}getLocalMedia(e){return this.localTrackMap.get(e)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(e,t){if(!e)return this.remoteUserMap.size>0;const r=this.remoteUserMap.get(e);return!!r&&(!t||r.has(t))}getRemoteMedia(e){var t,r;const i=Qo(t=Bd(jd(r=this.remoteUserMap).call(r))).call(t,t=>t.uid===e);return i?{audioTrack:i.audioTrack,audioSSRC:i._audioSSRC,videoTrack:i.videoTrack,videoSSRC:i._videoSSRC}:{}}getAudioLevels(){var e,t;let r=vo(e=Bd(Dd(t=this.remoteUserMap).call(t))).call(e,([e])=>({uid:e.uid,level:e.audioTrack?100*e.audioTrack._source.getAccurateVolumeLevel():0}));const i=this.localTrackMap.get(Ou.LocalAudioTrack);return i&&r.push({level:100*i.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),r=cl(r).call(r,(e,t)=>e.level-t.level),r}async disconnectForReconnect(){var e,t,r,i;this.connection&&(Rc.debug("P2PChannel.disconnectForReconnect closing P2PConnection"),this.state=Nu.Reconnecting,this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0,0!==this.localTrackMap.size&&(Jr(e=Bd(Dd(t=this.localTrackMap).call(t))).call(e,([e,{track:t}])=>{var r;switch(e){case Ou.LocalVideoTrack:is(r=t._hints).call(r,Eu.LOW_STREAM)?t.close():this.pendingLocalTracks.push(t);break;case Ou.LocalAudioTrack:var i;t instanceof Qh?this.pendingLocalTracks=Je(i=this.pendingLocalTracks).call(i,t.trackList):this.pendingLocalTracks.push(t);break;case Ou.LocalVideoLowTrack:}}),this.emit(Lu.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),0!==this.remoteUserMap.size&&Jr(r=Bd(Dd(i=this.remoteUserMap).call(i))).call(r,([e,t])=>{var r;Jr(r=Bd(jd(t).call(t))).call(r,t=>{this.setPendingRemoteMedia(e,t)}),this.emit(Lu.MediaReconnectStart,e.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.statsUploader.stopUploadUplinkStats(),this.statsUploader.stopUploadDownlinkStats(),Rc.debug("P2PChannel disconnected, waiting to reconnect."))}hasPendingRemoteMedia(e,t){for(const r of this.pendingRemoteTracks){const{user:i,kind:n}=r;if((e instanceof Iv?e.uid:e)===i.uid&&t===n)return!0}return!1}setPendingRemoteMedia(e,t){this.hasPendingRemoteMedia(e,t)||this.pendingRemoteTracks.push({user:e,kind:t})}async reEstablish(){if(this.connection)return this.connection.reEstablish()}getUplinkNetworkQuality(){var e,t,r;if(!this.connection)return 0;const i=this.connection.getStats(),n=this.localTrackMap.get(Ou.LocalVideoTrack),o=this.localTrackMap.get(Ou.LocalAudioTrack),s=Qo(e=i.videoSend).call(e,e=>e.ssrc===(null==n?void 0:n.ssrcs[0].ssrcId)),a=Qo(t=i.audioSend).call(t,e=>e.ssrc===(null==o?void 0:o.ssrcs[0].ssrcId));if(!s||!a)return 1;const c=xp(this,Lu.NeedSignalRTT),l=s?s.rttMs:void 0,u=a?a.rttMs:void 0,d=l&&u?(l+u)/2:l||u,h=(d&&c?(d+c)/2:d||c)||0,p=100*i.sendPacketLossRate*.7/50+.3*h/1500,f=p<.17?1:p<.36?2:p<.59?3:p<.1?4:5,g=null==n?void 0:n.track;if(g&&g._encoderConfig&&-1===Lo(r=g._hints).call(r,Eu.SCREEN_TRACK)){const e=g._encoderConfig.bitrateMax,t=i.bitrate.actualEncoded;if(e&&t){const r=(1e3*e-t)/(1e3*e);return Zc[r<.15?0:r<.3?1:r<.45?2:r<.6?3:4][f]}}return f}getDownlinkNetworkQuality(){var e,t;if(!this.connection)return 0;const r=this.connection.getStats();let i=0;return Jr(e=Bd(Dd(t=this.remoteUserMap).call(t))).call(e,([e])=>{var t,n;const o=e._audioSSRC,s=e._videoSSRC,a=Qo(t=r.audioRecv).call(t,e=>e.ssrc===o),c=Qo(n=r.videoRecv).call(n,e=>e.ssrc===s);if(!a&&!c)return void(i+=1);const l=xp(this,Lu.NeedSignalRTT),u=r.rtt,d=(u&&l?(u+l)/2:u||l)||0,h=a?a.jitterMs:void 0,p=r.recvPacketLossRate;let f=.7*p*100/50+.3*d/1500;h&&(f=.6*p*100/50+.2*d/1500+.2*h/400),i+=f<.1?1:f<.17?2:f<.36?3:f<.59?4:5}),this.remoteUserMap.size>0?Math.round(i/this.remoteUserMap.size):i}async muteLocalTrack(e){return new fo((t,r)=>{this.handleMuteLocalTrack(e,t,r)})}filterTobePublishedTracks(e,t,r){const i=[],n=Fu(),o=this.getAllTracks();e=Fp(e=ji(e).call(e,e=>-1===Lo(o).call(o,e)));let s=!1,a=!1;for(const c of e){if(c instanceof Tv&&(this.localTrackMap.has(Ou.LocalVideoTrack)||s?new pl(ll.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(i.push({track:c,type:Ou.LocalVideoTrack}),s=!0),t)){const e=this.getLowVideoTrack(c,r);i.push({track:e,type:Ou.LocalVideoLowTrack})}if(c instanceof jh){const e=this.localTrackMap.get(Ou.LocalAudioTrack);if(e){if(!(e.track instanceof Qh))throw new pl(ll.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(c._bypassWebAudio)throw new pl(ll.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");e.track.addAudioTrack(c),this.bindLocalAudioTrackEvents(c,!0)}else if(a){const e=Qo(i).call(i,({type:e})=>e===Ou.LocalAudioTrack);if(!(e.track instanceof Qh))throw new pl(ll.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(c._bypassWebAudio)throw new pl(ll.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");e.track.addAudioTrack(c)}else{if(!n.webAudioMediaStreamDest||c instanceof Qh||c._bypassWebAudio)i.push({track:c,type:Ou.LocalAudioTrack});else{const e=new Qh;e.addAudioTrack(c),i.push({track:e,type:Ou.LocalAudioTrack})}a=!0}}}return i}filterTobeUnpublishedTracks(e){const t=[],r=this.getAllTracks();e=Fp(e=ji(e).call(e,e=>-1!==Lo(r).call(r,e)));for(const i of e){if(i instanceof jh){const e=this.localTrackMap.get(Ou.LocalAudioTrack);if(!e)continue;e.track instanceof Qh?(e.track.removeAudioTrack(i),this.unbindLocalAudioTrackEvents(i),0===e.track.trackList.length&&(t.push([Ou.LocalAudioTrack,e]),e.track.close())):t.push([Ou.LocalAudioTrack,e])}if(i instanceof Tv){const e=this.localTrackMap.get(Ou.LocalVideoTrack);if(!e)continue;t.push([Ou.LocalVideoTrack,e]);const r=this.localTrackMap.get(Ou.LocalVideoLowTrack);r&&t.push([Ou.LocalVideoLowTrack,r])}}return t}bindLocalTrackEvents(e){Jr(e).call(e,({track:e,type:t})=>{switch(t){case Ou.LocalVideoTrack:e.addListener(vu.GET_STATS,this.handleGetLocalVideoStats),e.addListener(vu.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(vu.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(vu.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),e.addListener(vu.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),e.addListener(vu.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.addListener(vu.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(vu.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Ou.LocalAudioTrack:this.bindLocalAudioTrackEvents(e);break;case Ou.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(e,t){var r;e instanceof Qh?Jr(r=e.trackList).call(r,e=>{e.addListener(vu.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(vu.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(vu.GET_STATS,this.handleGetLocalAudioStats),e.addListener(vu.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(vu.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.addListener(vu.GET_STATS,this.handleGetLocalAudioStats),e.addListener(vu.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(vu.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(vu.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(vu.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),t||e.addListener(vu.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(e){var t;e||(e=Bd(Dd(t=this.localTrackMap).call(t))),Jr(e).call(e,([e,{track:t}])=>{switch(e){case Ou.LocalVideoTrack:t.off(vu.GET_STATS,this.handleGetLocalVideoStats),t.off(vu.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(vu.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(vu.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),t.off(vu.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),t.off(vu.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.off(vu.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(vu.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Ou.LocalAudioTrack:this.unbindLocalAudioTrackEvents(t);break;case Ou.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(e){var t;e instanceof Qh?Jr(t=e.trackList).call(t,e=>{e.off(vu.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(vu.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(vu.GET_STATS,this.handleGetLocalAudioStats),e.off(vu.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(vu.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.off(vu.GET_STATS,this.handleGetLocalAudioStats),e.off(vu.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(vu.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(vu.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(vu.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(vu.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(e,t){t instanceof WE&&t.addListener(vu.GET_STATS,t=>{t(this.handleGetRemoteVideoStats(e))}),t instanceof qE&&t.addListener(vu.GET_STATS,t=>{t(this.handleGetRemoteAudioStats(e))})}unbindRemoteTrackEvents(e){e&&e.removeAllListeners(vu.GET_STATS)}unbindAllRemoteTrackEvents(){var e,t;Jr(e=Bd(Dd(t=this.remoteUserMap).call(t))).call(e,([e,t])=>{t.has(ku.AUDIO)&&this.unbindRemoteTrackEvents(e._audioTrack),t.has(ku.VIDEO)&&this.unbindRemoteTrackEvents(e._videoTrack)})}createGatewayPublishMessage(e,t){return vo(e).call(e,({track:e,type:r},i)=>{var n;let o,s;switch(r){case Ou.LocalAudioTrack:o=mu.Audio,s={dtx:e instanceof Gh&&e._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case Ou.LocalVideoTrack:o=is(n=e._hints).call(n,Eu.SCREEN_TRACK)?mu.Screen:mu.High,s=$E({},gp(e),{codec:this.store.codec});break;case Ou.LocalVideoLowTrack:o=mu.Low,s=$E({},gp(e),{codec:this.store.codec})}return{stream_type:o,attributes:s,ssrcs:t[i]}})}createGatewayUnpublishMessage(e){return vo(e).call(e,([e,{track:t,ssrcs:r,id:i}])=>{var n;let o;switch(e){case Ou.LocalVideoTrack:o=is(n=t._hints).call(n,Eu.SCREEN_TRACK)?mu.Screen:mu.High;break;case Ou.LocalAudioTrack:o=mu.Audio;break;case Ou.LocalVideoLowTrack:o=mu.Low}return{stream_type:o,ssrcs:r,mid:i}})}assignLocalTracks(e,t){Jr(e).call(e,({track:e,type:r},i)=>{this.localTrackMap.set(r,{track:e,id:t[i].id,ssrcs:t[i].localSSRC})})}withdrawLocalTracks(e){Jr(e).call(e,([e])=>{this.localTrackMap.delete(e)})}async waitTillConnected(){return new fo((e,t)=>{switch(this.state){case Nu.New:case Nu.Reconnecting:{const r=(i,n)=>n===Nu.Disconnected?(this.off(Lu.StateChange,r),void t(new pl(ll.UNEXPECTED_ERROR,"PeerConnection already disconnected."))):n===Nu.Connected?(this.off(Lu.StateChange,r),void e(void 0)):void 0;this.on(Lu.StateChange,r);break}case Nu.Connected:e(void 0);break;case Nu.Disconnected:t(new pl(ll.UNEXPECTED_ERROR,"PeerConnection already disconnected."))}})}bindConnectionEvents(e){e.onConnectionStateChange=async t=>{var r;Rc.info(Je(r="[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(")).call(r,t,")")),this.emit(Lu.PeerConnectionStateChange,t),"connected"!==t||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),"failed"===t&&("failed"===e.iceConnectionState?(Fa(()=>this.emit(Lu.P2PLost),0),this.iceFailedCount+=1,await Ip(Yd(this.iceFailedCount,Zd)),this.emit(Lu.RequestRestartICE)):await this.requestReconnect())},e.onICEConnectionStateChange=e=>{var t;Rc.info(Je(t="[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(")).call(t,e,")")),this.emit(Lu.IceConnectionStateChange,e)},e.onICETransportStateChange=e=>{var t;Rc.info(Je(t="[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(")).call(t,e,")"))},e.onDTLSTransportStateChange=e=>{var t;Rc.info(Je(t="[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(")).call(t,e,")"))},e.onDTLSTransportError=e=>{var t;Rc.info(Je(t="[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(")).call(t,e,")"))},e.onFirstAudioDecoded=e=>{var t,r;const i=Qo(t=Bd(jd(r=this.remoteUserMap).call(r))).call(t,t=>t._audioSSRC===e);var n;i&&(null===(n=i.audioTrack)||void 0===n||n.emit(yu.FIRST_FRAME_DECODED),nh.firstRemoteFrame(this.store.sessionId,wl.FIRST_AUDIO_DECODE,kl.FIRST_AUDIO_DECODE,{peer:i._uintid,subscribeElapse:zh.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId}))},e.onFirstAudioReceived=e=>{var t,r;const i=Qo(t=Bd(jd(r=this.remoteUserMap).call(r))).call(t,t=>t._audioSSRC===e);i&&nh.firstRemoteFrame(this.store.sessionId,wl.FIRST_AUDIO_RECEIVED,kl.FIRST_AUDIO_RECEIVED,{peer:i._uintid,subscribeElapse:zh.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId})},e.onFirstVideoDecoded=(e,t,r)=>{var i,n;const o=Qo(i=Bd(jd(n=this.remoteUserMap).call(n))).call(i,t=>t._videoSSRC===e);o&&nh.firstRemoteFrame(this.store.sessionId,wl.FIRST_VIDEO_DECODE,kl.FIRST_VIDEO_DECODE,{peer:o._uintid,videowidth:t,videoheight:r,subscribeElapse:zh.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId})},e.onFirstVideoReceived=e=>{var t,r;const i=Qo(t=Bd(jd(r=this.remoteUserMap).call(r))).call(t,t=>t._videoSSRC===e);i&&nh.firstRemoteFrame(this.store.sessionId,wl.FIRST_VIDEO_RECEIVED,kl.FIRST_VIDEO_RECEIVED,{peer:i._uintid,subscribeElapse:zh.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId})}}unbindConnectionEvents(e){e.onConnectionStateChange=void 0,e.onICEConnectionStateChange=void 0,e.onICETransportStateChange=void 0,e.onDTLSTransportStateChange=void 0,e.onDTLSTransportError=void 0,e.onFirstAudioDecoded=void 0,e.onFirstAudioReceived=void 0,e.onFirstVideoDecoded=void 0,e.onFirstVideoReceived=void 0}filterTobeMutedTracks(e){var t,r;const i=[],n=this.getAllTracks();if(-1===Lo(n).call(n,e))return i;const o=this.localTrackMap.get(Ou.LocalAudioTrack);if(e instanceof jh&&(null==o?void 0:o.track)instanceof Qh)return o.track.isActive||i.push([Ou.LocalAudioTrack,o]),i;const s=Qo(t=Bd(Dd(r=this.localTrackMap).call(r))).call(t,([,{track:t}])=>e===t);if(s&&(i.push(s),s[0]===Ou.LocalVideoTrack)){const e=this.localTrackMap.get(Ou.LocalVideoLowTrack);e&&i.push([Ou.LocalVideoLowTrack,e])}return i}filterTobeUnmutedTracks(e){var t,r;const i=[],n=this.localTrackMap.get(Ou.LocalAudioTrack);if(e instanceof jh&&(null==n?void 0:n.track)instanceof Qh)return n.track.isActive&&i.push([Ou.LocalAudioTrack,n]),i;const o=Qo(t=Bd(Dd(r=this.localTrackMap).call(r))).call(t,([,{track:t}])=>e===t);if(o)if(o[0]===Ou.LocalVideoTrack){i.push(o);const e=this.localTrackMap.get(Ou.LocalVideoLowTrack);e&&i.push([Ou.LocalVideoLowTrack,e])}else i.push(o);return i}createMuteMessage(e){return vo(e).call(e,([e,{track:t,ssrcs:r,id:i}])=>{var n;let o;switch(e){case Ou.LocalAudioTrack:o=mu.Audio;break;case Ou.LocalVideoTrack:o=is(n=t._hints).call(n,Eu.SCREEN_TRACK)?mu.Screen:mu.High;break;case Ou.LocalVideoLowTrack:o=mu.Low}return{stream_type:o,ssrcs:r,mid:i}})}createUnmuteMessage(e){return vo(e).call(e,([e,{track:t,ssrcs:r,id:i}])=>{var n;let o;switch(e){case Ou.LocalAudioTrack:o=mu.Audio;break;case Ou.LocalVideoTrack:o=is(n=t._hints).call(n,Eu.SCREEN_TRACK)?mu.Screen:mu.High;break;case Ou.LocalVideoLowTrack:o=mu.Low}return{stream_type:o,ssrcs:r,mid:i}})}filterTobeUnSubscribedTracks(e,t){const r=[],i=this.remoteUserMap.get(e);if(!i)return r;if(t){const n=i.get(t);if(!n)return r;r.push([e,{kind:t,id:n}])}else{var n;Jr(n=Bd(Dd(i).call(i))).call(n,([t,i])=>{r.push([e,{kind:t,id:i}])})}return r}createUnsubscribeMessage(e){const t=[];return Jr(e).call(e,([e,{kind:r,id:i}])=>{switch(r){case ku.VIDEO:return void(e._videoSSRC&&t.push({stream_type:ku.VIDEO,ssrcId:e._videoSSRC}));case ku.AUDIO:return void(e._audioSSRC&&t.push({stream_type:ku.AUDIO,ssrcId:e._audioSSRC}))}}),t}withdrawRemoteTracks(e){Jr(e).call(e,([e,{kind:t}])=>{const r=this.remoteUserMap.get(e);r&&(r.delete(t),0===Bd(Dd(r).call(r)).length&&this.remoteUserMap.delete(e))})}async updateBitrateLimit(e){const t=this.localTrackMap.get(Ou.LocalVideoTrack),r=this.localTrackMap.get(Ou.LocalVideoLowTrack);t&&await t.track.setBitrateLimit(e.uplink),r&&e.low_stream_uplink&&await r.track.setBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0})}isP2PDisconnected(){return!this.connection||"connected"!==this.connection.peerConnectionState}mapPubResToRemoteConfig(e,t){return vo(e).call(e,({stream_type:e},r)=>{var i;return null===(i=Qo(t).call(t,({stream_type:t})=>e===t))||void 0===i?void 0:i.attributes})}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>{var e;return Bd(Dd(e=this.localTrackMap).call(e))},this.statsUploader.requestRemoteMedia=()=>{var e;return Bd(Dd(e=this.remoteUserMap).call(e))},this.statsUploader.requestVideoIsReady=e=>{var t;return!(null===(t=this.connection)||void 0===t||!t.getRemoteVideoIsReady(e))},this.statsUploader.requestUpload=(e,t)=>this.emit(Lu.RequestUploadStats,e,t)}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await Ip(Yd(this.dtlsFailedCount,Zd)),this.emit(Lu.RequestReconnect)}async reconnectP2P(){var e,t;const r=Bd(Dd(e=this.localTrackMap).call(e)),i=this.createGatewayUnpublishMessage(r);Bd(Dd(t=this.remoteUserMap).call(t)),i.length>0&&await Dp(this,Lu.RequestUnpublishForReconnectPC,i),this.disconnectForReconnect(),this.emit(Lu.RequestReconnectPC)}canPublishLowStream(){var e;return this.localTrackMap.has(Ou.LocalVideoTrack)||as(e=this.pendingLocalTracks).call(e,e=>e instanceof Tv)}throwIfTrackTypeNotMatch(e){if(ji(e).call(e,e=>e instanceof Tv).length>1)throw new pl(ll.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(ji(e).call(e,e=>e instanceof jh).length>1&&(as(e).call(e,e=>e instanceof jh&&e._bypassWebAudio)||!Fu().webAudioMediaStreamDest))throw new pl(ll.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const n of e){var t,r,i;if(n instanceof Tv&&as(t=this.pendingLocalTracks).call(t,e=>e instanceof Tv))throw new pl(ll.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(n instanceof jh&&as(r=this.pendingLocalTracks).call(r,e=>e instanceof jh)&&(!Fu().webAudioMediaStreamDest||n._bypassWebAudio||as(i=this.pendingLocalTracks).call(i,e=>e instanceof jh&&e._bypassWebAudio)))throw new pl(ll.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(e,t){const r=Fu().supportDualStreamEncoding,i=$E({},{width:160,height:120,framerate:15,bitrate:50},{},t);let n;n=r?e._mediaStreamTrack.clone():jE(e,i);const o=new Tv(n,$E({},r&&{scaleResolutionDownBy:Ap(i,e)},{frameRate:i.framerate,bitrateMax:i.bitrate,bitrateMin:i.bitrate}));return o._hints.push(Eu.LOW_STREAM),o}}function tA(e,t,r){const i=e[t];if("function"!=typeof i)throw new Error("Cannot use mutex on object property.");return r.value=async function(...e){const r=this.mutex,n=await r.lock("From P2PChannel.".concat(t));try{return await i.apply(this,e)}finally{n()}},r}JE([tA,XE("design:type",Function),XE("design:paramtypes",[Object]),XE("design:returntype",fo)],eA.prototype,"startP2PConnection",null),JE([tA,XE("design:type",Function),XE("design:paramtypes",[Object,Object,Array,Object,String,String,String,String]),XE("design:returntype",fo)],eA.prototype,"connect",null),JE([tA,XE("design:type",Function),XE("design:paramtypes",[Array]),XE("design:returntype",fo)],eA.prototype,"unpublish",null),JE([tA,XE("design:type",Function),XE("design:paramtypes",[]),XE("design:returntype",fo)],eA.prototype,"unpublishLowStream",null),JE([tA,XE("design:type",Function),XE("design:paramtypes",[Iv,String,Number,Array]),XE("design:returntype",fo)],eA.prototype,"subscribe",null),JE([tA,XE("design:type",Function),XE("design:paramtypes",[Iv,String]),XE("design:returntype",fo)],eA.prototype,"unsubscribe",null),JE([tA,XE("design:type",Function),XE("design:paramtypes",[Iv,String]),XE("design:returntype",fo)],eA.prototype,"muteRemote",null),JE([tA,XE("design:type",Function),XE("design:paramtypes",[Iv,String]),XE("design:returntype",fo)],eA.prototype,"unmuteRemote",null),JE([tA,XE("design:type",Function),XE("design:paramtypes",[]),XE("design:returntype",fo)],eA.prototype,"disconnectForReconnect",null),JE([tA,XE("design:type",Function),XE("design:paramtypes",[]),XE("design:returntype",fo)],eA.prototype,"reEstablish",null),JE([tA,XE("design:type",Function),XE("design:paramtypes",[Object]),XE("design:returntype",fo)],eA.prototype,"updateBitrateLimit",null);var rA=s((function(){tr(1)}));Q({target:"Object",stat:!0,forced:rA,sham:!Jt},{getPrototypeOf:function(e){return tr(Ae(e))}});var iA=M.Object.getPrototypeOf,nA=Dv;function oA(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var sA,aA="function"==typeof nA&&nA.observable||"@@observable",cA=function(){return Math.random().toString(36).substring(7).split("").join(".")},lA={INIT:"@@redux/INIT"+cA(),REPLACE:"@@redux/REPLACE"+cA(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+cA()}};function uA(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==iA(t);)t=iA(t);return iA(e)===t}function dA(e,t,r){var i;if("function"==typeof t&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error(oA(0));if("function"==typeof t&&void 0===r&&(r=t,t=void 0),void 0!==r){if("function"!=typeof r)throw new Error(oA(1));return r(dA)(e,t)}if("function"!=typeof e)throw new Error(oA(2));var n=e,o=t,s=[],a=s,c=!1;function l(){a===s&&(a=Uo(s).call(s))}function u(){if(c)throw new Error(oA(3));return o}function d(e){if("function"!=typeof e)throw new Error(oA(4));if(c)throw new Error(oA(5));var t=!0;return l(),a.push(e),function(){if(t){if(c)throw new Error(oA(6));t=!1,l();var r=Lo(a).call(a,e);bo(a).call(a,r,1),s=null}}}function h(e){if(!uA(e))throw new Error(oA(7));if(void 0===e.type)throw new Error(oA(8));if(c)throw new Error(oA(9));try{c=!0,o=n(o,e)}finally{c=!1}for(var t=s=a,r=0;r<t.length;r++)(0,t[r])();return e}function p(e){if("function"!=typeof e)throw new Error(oA(10));n=e,h({type:lA.REPLACE})}function f(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(oA(11));function r(){e.next&&e.next(u())}return r(),{unsubscribe:t(r)}}})[aA]=function(){return this},e}return h({type:lA.INIT}),(i={dispatch:h,subscribe:d,getState:u,replaceReducer:p})[aA]=f,i}function hA(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function pA(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=hA(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=hA(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}!function(e){e.SET_SESSION_ID="SET_SESSION_ID",e.SET_P2P_ID="SET_P2P_id",e.SET_UID="SET_UID",e.SET_PUB_ID="SET_PUB_ID",e.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",e.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",e.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",e.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",e.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",e.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",e.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",e.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",e.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_START",e.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",e.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE"}(sA||(sA={}));class fA{constructor(e,t,r){const i={codec:e,mode:t,clientId:r,sessionId:null,p2pId:0,pubId:0,subId:0,keyMetrics:{publish:[],subscribe:[]}};this.reducer=function(e=i,t){switch(t.type){case sA.SET_SESSION_ID:return pA({},e,{sessionId:t.sessionId});case sA.SET_P2P_ID:return pA({},e,{p2pId:t.p2pId});case sA.SET_UID:return pA({},e,{uid:t.uid});case sA.SET_PUB_ID:return pA({},e,{pubId:t.pubId});case sA.KEY_METRIC_CLIENT_CREATED:return pA({},e,{keyMetrics:pA({},e.keyMetrics,{clientCreated:t.metric})});case sA.KEY_METRIC_JOIN_START:return pA({},e,{keyMetrics:pA({},e.keyMetrics,{joinStart:t.metric})});case sA.KEY_METRIC_JOIN_END:return pA({},e,{keyMetrics:pA({},e.keyMetrics,{joinEnd:t.metric})});case sA.KEY_METRIC_REQUEST_AP_START:return pA({},e,{keyMetrics:pA({},e.keyMetrics,{requestAPStart:t.metric})});case sA.KEY_METRIC_REQUEST_AP_END:return pA({},e,{keyMetrics:pA({},e.keyMetrics,{requestAPEnd:t.metric})});case sA.KEY_METRIC_JOIN_GATEWAY_START:return pA({},e,{keyMetrics:pA({},e.keyMetrics,{joinGatewayStart:t.metric})});case sA.KEY_METRIC_JOIN_GATEWAY_END:return pA({},e,{keyMetrics:pA({},e.keyMetrics,{joinGatewayEnd:t.metric})});case sA.KEY_METRIC_PEER_CONNECTION_START:return pA({},e,{keyMetrics:pA({},e.keyMetrics,{peerConnectionStart:t.metric})});case sA.KEY_METRIC_PEER_CONNECTION_END:return pA({},e,{keyMetrics:pA({},e.keyMetrics,{peerConnectionEnd:t.metric})});case sA.KEY_METRIC_PUBLISH:{const r=e.keyMetrics.publish,i=Lv(r).call(r,e=>e.trackId===t.metric.trackId);return-1!==i?(r[i]=pA({},r[i],{},t.metric),pA({},e,{keyMetrics:pA({},e.keyMetrics,{publish:[...r]})})):pA({},e,{keyMetrics:pA({},e.keyMetrics,{publish:[...e.keyMetrics.publish,t.metric]})})}case sA.KEY_METRIC_SUBSCRIBE:{const r=e.keyMetrics.subscribe,i=Lv(r).call(r,e=>e.userId===t.metric.userId&&e.type===t.metric.type);return-1!==i?(r[i]=pA({},r[i],{},t.metric),pA({},e,{keyMetrics:pA({},e.keyMetrics,{subscribe:[...r]})})):pA({},e,{keyMetrics:pA({},e.keyMetrics,{subscribe:[...e.keyMetrics.subscribe,t.metric]})})}default:return e}},this.store=dA(this.reducer)}set sessionId(e){this.store.dispatch({type:sA.SET_SESSION_ID,sessionId:e})}get sessionId(){return this.store.getState().sessionId}get codec(){return this.store.getState().codec}get clientId(){return this.store.getState().clientId}set p2pId(e){this.store.dispatch({type:sA.SET_P2P_ID,p2pId:e})}get p2pId(){return this.store.getState().p2pId}set uid(e){this.store.dispatch({type:sA.SET_UID,uid:e})}get uid(){return this.store.getState().uid}set pubId(e){this.store.dispatch({type:sA.SET_PUB_ID,pubId:e})}get pubId(){return this.store.getState().pubId}clientCreated(){this.store.dispatch({type:sA.KEY_METRIC_CLIENT_CREATED,metric:performance.now()})}joinStart(){this.store.dispatch({type:sA.KEY_METRIC_JOIN_START,metric:performance.now()})}joinEnd(){this.store.dispatch({type:sA.KEY_METRIC_JOIN_END,metric:performance.now()})}requestAPStart(){this.store.dispatch({type:sA.KEY_METRIC_REQUEST_AP_START,metric:performance.now()})}requestAPEnd(){this.store.dispatch({type:sA.KEY_METRIC_REQUEST_AP_END,metric:performance.now()})}joinGatewayStart(){this.store.dispatch({type:sA.KEY_METRIC_JOIN_GATEWAY_START,metric:performance.now()})}joinGatewayEnd(){this.store.dispatch({type:sA.KEY_METRIC_JOIN_GATEWAY_END,metric:performance.now()})}peerConnectionStart(){this.store.dispatch({type:sA.KEY_METRIC_PEER_CONNECTION_START,metric:performance.now()})}peerConnectionEnd(){this.store.dispatch({type:sA.KEY_METRIC_PEER_CONNECTION_END,metric:performance.now()})}publish(e,t,r,i){this.store.dispatch({type:sA.KEY_METRIC_PUBLISH,metric:pA({trackId:e,type:t},r&&{publishStart:r},{},i&&{publishEnd:i})})}subscribe(e,t,r,i,n){this.store.dispatch({type:sA.KEY_METRIC_SUBSCRIBE,metric:pA({userId:e,type:t},r&&{subscribeStart:r},{},i&&{subscribeEnd:i},{},n&&{firstFrame:n})})}get keyMetrics(){return this.store.getState().keyMetrics}}let gA;const mA=()=>"HTTPS"===(gA||gA||(gA=(window.location.protocol.split(":")[0]||"").toUpperCase(),gA)),_A=()=>void 0!==window.isSecureContext;class vA{constructor(e,t){var r;this.name=e,this.time=performance.now(),this.sequence=Lo(r=Bu[t]).call(r,e)}setElapse(e){this.elapse=e}}const EA=new Mr;function AA(e,t){const r=new yA(e,t);return EA.set(e,r),r}class yA{constructor(e,t){this.records=[],this._id=e,this._group=t,this._localTimeStamp=Ma(),this._performanceTimeStamp=performance.now()}checkPoint(e){var t;const r=new vA(e,this._group);-1===r.sequence&&Rc.warning("[".concat(this._id,"] check point record failed, cannot get the sequence")),this.records.push(r);const i=Qo(t=this.records).call(t,e=>e.sequence===r.sequence-1);i&&r.setElapse(r.time-i.time)}getRecord(e){var t;return Qo(t=this.records).call(t,t=>t&&t.name===e)}resetRecords(){this.records.length=0}}function SA(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function CA(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=SA(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=SA(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}var TA,bA,IA,RA,wA,kA,OA=function(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Bi(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&di(t,r,s),s},NA=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class LA extends Mu{constructor(e){var t,r,i,n;let o;if(super(),this._users=[],this._sessionId=null,this._leaveMutex=new ah("client-leave"),this._publishMutex=new ah("client-publish"),this._renewTokenMutex=new ah("client-renewtoken"),this._subscribeMutex=new Mr,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._turnServer={servers:[],mode:"auto"},this._cloudProxyServerMode="disabled",this._isDualStreamEnabled=!1,this._streamFallbackTypeCacheMap=new Mr,this._remoteStreamTypeCacheMap=new Mr,this._axiosCancelSource=Sc.CancelToken.source(),this._networkQualitySensitivity="normal",this._useLocalAccessPoint=!1,this._joinAndNotLeaveYet=!1,this._handleLocalTrackEnable=(e,t,r)=>{this.publish(e,!1).then(t).catch(r)},this._handleLocalTrackDisable=(e,t,r)=>{this.unpublish(e,!1).then(t).catch(r)},this._handleUserOnline=e=>{var t;this.isStringUID&&"string"!=typeof e.uid&&Rc.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));const r=Qo(t=this._users).call(t,t=>t.uid===e.uid);if(r)r._trust_in_room_=!0;else{const t=new Iv(e.uid,e.uint_id||e.uid);this._users.push(t),Rc.debug("[".concat(this._clientId,"] user online"),e.uid),this.emit(Vl.USER_JOINED,t)}},this._handleUserOffline=e=>{var t;const r=Qo(t=this._users).call(t,t=>t.uid===e.uid);r&&(this._handleRemoveStream(e),Up(this._users,r),this._remoteStreamTypeCacheMap.delete(r.uid),this._streamFallbackTypeCacheMap.delete(r.uid),Rc.debug("[".concat(this._clientId,"] user offline"),e.uid,"reason:",e.reason),this.emit(Vl.USER_LEAVED,r,e.reason))},this._handleAddAudioOrVideoStream=(e,t,r,i,n,o)=>{var s,a,c;const l=Qo(s=this._users).call(s,e=>e.uid===t);if(!l)return void Rc.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));Rc.debug(Je(a=Je(c="[".concat(this._clientId,"] stream added with uid ")).call(c,t,", type ")).call(a,e));const u="audio"===e?l.hasAudio:l.hasVideo;var d,h;l._uintid||(l._uintid=n||t),l._trust_stream_added_state_=!0,"audio"===e?(l._audio_added_=!0,void 0!==r&&(l._audioSSRC=r),void 0!==i&&(l._cname=i),o&&(l._audioOrtc=o)):(l._video_added_=!0,void 0!==r&&(l._videoSSRC=r),void 0!==i&&(l._cname=i),o&&(l._videoOrtc=o)),("audio"===e?l.hasAudio:l.hasVideo)&&!u&&(Rc.info(Je(d=Je(h="[".concat(this._clientId,"] remote user ")).call(h,l.uid," published ")).call(d,e)),this.emit(Vl.USER_PUBLISHED,l,e)),"video"===e?nh.onGatewayStream(this._sessionId,wl.ON_ADD_VIDEO_STREAM,kl.ON_ADD_VIDEO_STREAM,{peer:n||t}):nh.onGatewayStream(this._sessionId,wl.ON_ADD_AUDIO_STREAM,kl.ON_ADD_AUDIO_STREAM,{peer:n||t}),this._p2pChannel.hasPendingRemoteMedia(l,e)&&this.subscribe(l,e).catch(e=>{Rc.error("[".concat(this._clientId,"] resubscribe error"),e.toString())})},this._handleRemoveStream=async e=>{var t,r;const i=Qo(t=this._users).call(t,t=>t.uid===e.uid);if(!i)return void Rc.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));Rc.debug(Je(r="[".concat(this._clientId,"] stream removed with uid ")).call(r,e.uid));let n=()=>{};i.hasAudio&&i.hasVideo?n=()=>{var e,t;Rc.info(Je(e="[".concat(this._clientId,"] remote user ")).call(e,i.uid," unpublished audio track")),this.emit(Vl.USER_UNPUBLISHED,i,"audio"),Rc.info(Je(t="[".concat(this._clientId,"] remote user ")).call(t,i.uid," unpublished video track")),this.emit(Vl.USER_UNPUBLISHED,i,"video")}:i.hasVideo?n=()=>{var e;Rc.info(Je(e="[".concat(this._clientId,"] remote user ")).call(e,i.uid," unpublished video track")),this.emit(Vl.USER_UNPUBLISHED,i,"video")}:i.hasAudio&&(n=()=>{var e;Rc.info(Je(e="[".concat(this._clientId,"] remote user ")).call(e,i.uid," unpublished audio track")),this.emit(Vl.USER_UNPUBLISHED,i,"audio")}),i._trust_stream_added_state_=!0,i._audio_added_=!1,i._video_added_=!1;const o=await this._p2pChannel.unsubscribe(i);o&&await this._gateway.unsubscribe(o,i.uid),i._audioSSRC=void 0,i._videoSSRC=void 0,i._audioOrtc=void 0,i._videoOrtc=void 0,nh.onGatewayStream(this._sessionId,wl.ON_REMOVE_STREAM,kl.ON_REMOVE_STREAM,{peer:e.uint_id||e.uid}),n()},this._handleSetStreamLocalEnable=async(e,t,r)=>{var i,n,o,s;const a=Qo(i=this._users).call(i,e=>e.uid===t);if(!a)return void Rc.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));Rc.debug(Je(n=Je(o=Je(s="[".concat(this._clientId,"] local ")).call(s,e," ")).call(o,r?"enabled":"disabled"," with uid ")).call(n,t));const c="audio"===e?a.hasAudio:a.hasVideo;if("audio"===e){a._trust_audio_enabled_state_=!0;const e=a._audio_enabled_;if(a._audio_enabled_=r,a._audio_enabled_===e)return;{var l,u;const e=a._audio_enabled_?"enable-local-audio":"disable-local-audio";Rc.debug(Je(l=Je(u="[".concat(this._clientId,"] user-info-updated, uid: ")).call(u,t,", msg: ")).call(l,e)),this.emit(Vl.USER_INFO_UPDATED,t,e)}}else{a._trust_video_enabled_state_=!0;const e=a._video_enabled_;if(a._video_enabled_=r,a._video_enabled_===e)return;{var d,h;const e=a._video_enabled_?"enable-local-video":"disable-local-video";Rc.debug(Je(d=Je(h="[".concat(this._clientId,"] user-info-update, uid: ")).call(h,t,", msg: ")).call(d,e)),this.emit(Vl.USER_INFO_UPDATED,t,e)}}const p="audio"===e?a.hasAudio:a.hasVideo;var f,g,m,_;return c!==p?!c&&p?(Rc.info(Je(f=Je(g="[".concat(this._clientId,"] remote user ")).call(g,t," published ")).call(f,e)),void this.emit(Vl.USER_PUBLISHED,a,e)):("video"===e&&a._videoTrack&&a._videoTrack._destroy(),"audio"===e&&a._audioTrack,await this._p2pChannel.muteRemote(a,e),Rc.info(Je(m=Je(_="[".concat(this._clientId,"] remote user ")).call(_,t," unpublished ")).call(m,e)),void this.emit(Vl.USER_UNPUBLISHED,a,e)):void 0},this._handleMuteStream=async(e,t,r)=>{var i;Rc.debug("[".concat(this._clientId,"] receive mute message"),e,t,r);const n=Qo(i=this._users).call(i,t=>t.uid===e);var o;if(!n)return void Rc.warning(Je(o="[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ")).call(o,e));const s="audio"===t?n.hasAudio:n.hasVideo;if("audio"===t){n._trust_audio_mute_state_=!0;const t=n._audio_muted_;if(n._audio_muted_=r,n._audio_muted_===t)return;{var a,c;const t=n._audio_muted_?"mute-audio":"unmute-audio";Rc.debug(Je(a=Je(c="[".concat(this._clientId,"] user-info-update, uid: ")).call(c,e,", msg: ")).call(a,t)),this.emit(Vl.USER_INFO_UPDATED,e,t)}}else{n._trust_video_mute_state_=!0;const t=n._video_muted_;if(n._video_muted_=r,n._video_muted_===t)return;{var l,u;const t=n._video_muted_?"mute-video":"unmute-video";Rc.debug(Je(l=Je(u="[".concat(this._clientId,"] user-info-update, uid: ")).call(u,e,", msg: ")).call(l,t)),this.emit(Vl.USER_INFO_UPDATED,e,t)}}const d="audio"===t?n.hasAudio:n.hasVideo;var h,p,f,g;return s!==d?!s&&d?(Rc.info(Je(h=Je(p="[".concat(this._clientId,"] remote user ")).call(p,e," published ")).call(h,t)),void this.emit(Vl.USER_PUBLISHED,n,t)):("video"===t&&n._videoTrack&&n._videoTrack._destroy(),"audio"===t&&n._audioTrack,await this._p2pChannel.muteRemote(n,t),Rc.info(Je(f=Je(g="[".concat(this._clientId,"] remote user ")).call(g,e," unpublished ")).call(f,t)),void this.emit(Vl.USER_UNPUBLISHED,n,t)):void 0},this._handleP2PLost=async e=>{Rc.debug("[".concat(this._clientId,"] receive p2p lost"),e),Si(e.p2pid,10)===this.store.p2pId?await this._p2pChannel.requestReconnect():Rc.warning("P2PLost stream not found",e)},this._handleTokenWillExpire=()=>{Rc.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.emit(Vl.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)},this._handleBeforeUnload=e=>{"beforeunload"===e.type&&void 0!==e.returnValue&&""!==e.returnValue||(this.leave(),Rc.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")))},this._handleUpdateNetworkQuality=()=>{if("normal"===this._networkQualitySensitivity)return;if(navigator&&void 0!==navigator.onLine&&!navigator.onLine)return void this.emit(Vl.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const e={downlinkNetworkQuality:0,uplinkNetworkQuality:0};e.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),e.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.emit(Vl.NETWORK_QUALITY,e)},this._codec=e.codec,this._mode=e.mode,e.proxyServer&&(this._proxyServer=e.proxyServer,nh.setProxyServer(this._proxyServer),Rc.setProxyServer(this._proxyServer)),e.turnServer&&(this._turnServer=CA({},this._turnServer,{mode:"manual"},e.turnServer)),this._clientId=kp(5,"client-"),this.store=new fA(e.codec,e.mode,this._clientId),this.store.clientCreated(),Rc.info(Je(t=Je(r=Je(i=Je(n="[".concat(this._clientId,"] Initializing AgoraRTC client v")).call(n,kc," build: ")).call(i,wc,", mode: ")).call(r,this._mode,", codec: ")).call(t,this._codec)),this._performanceRecorder=AA(this._clientId,"join"),e.clientRoleOptions)try{Jl(e.clientRoleOptions),o=ri({},e.clientRoleOptions)}catch(e){var s;Rc.warning(Je(s="[".concat(this._clientId,"] ")).call(s,e.toString()))}this._statsCollector=new Kh(this.store),this._statsCollector.onStatsException=(e,t,r)=>{var i,n,o;Rc.debug(Je(i=Je(n=Je(o="[".concat(this._clientId,"] receive exception msg, code: ")).call(o,e,", msg: ")).call(n,t,", uid: ")).call(i,r)),this.emit(Vl.EXCEPTION,{code:e,msg:t,uid:r})},this._statsCollector.onUploadPublishDuration=(e,t,r,i)=>{var n;const o=Qo(n=this._users).call(n,t=>t.uid===e);o&&nh.peerPublishStatus(this._sessionId,{subscribeElapse:i,audioPublishDuration:t,videoPublishDuration:r,peer:o._uintid})},this._gateway=new Yf(this.store,{clientId:this._clientId,mode:this._mode,codec:this._codec,websocketRetryConfig:e.websocketRetryConfig||Zd,httpRetryConfig:e.httpRetryConfig||Zd,forceWaitGatewayResponse:void 0===e.forceWaitGatewayResponse||e.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:e.role,clientRoleOptions:o}),this._config=e,this._configDistribute=new L_,this._p2pChannel=new eA(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents()}get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}async join(e,t,r,i,n){var o;this._performanceRecorder.checkPoint("startJoin"),this.store.joinStart();const s=mA(),a=_A()?window.isSecureContext:"Browser Not Support",c=()=>{Rc.warning("The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser")};_A()?window.isSecureContext||c():s||c();const l=nh.reportApiInvoke(this._sessionId,{name:Nl.JOIN,options:[e,t,r,i],states:{isHttps:s,isSecureContext:a},tag:Ll.TRACER});try{if(!r&&null!==r)throw new pl(ll.INVALID_PARAMS,"Invalid token: ".concat(r,". If you don not use token, set it to null"));r&&_l(r,"token",1,2047),_l(e,"appid",1,2047),El(t),i&&Al(i),n&&_l(n,"optionalInfo",1,2047)}catch(e){throw l.onError(e),e}if(Rc.info(Je(o="[".concat(this._clientId,"] start join channel ")).call(o,t)),this._leaveMutex.isLocked&&(Rc.debug("[".concat(this._clientId,"] join: waiting leave operation")),(await this._leaveMutex.lock())(),Rc.debug("[".concat(this._clientId,"] join: continue"))),this._joinAndNotLeaveYet=!0,"DISCONNECTED"!==this.connectionState){const e=new pl(ll.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw l.onError(e),e}this._sessionId||(this._sessionId=Op(),this.store.sessionId=this._sessionId),this._gateway.state="CONNECTING";const u={clientId:this._clientId,appId:e,sid:this._sessionId,cname:t,uid:"string"!=typeof i?i:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:r||e,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:n,useLocalAccessPoint:this._useLocalAccessPoint};if("string"==typeof i&&(u.stringUid=i,this._uintUid?(u.uid=this._uintUid,this._uintUid=void 0):u.uid=0),"none"!==this._encryptionMode&&this._encryptionSecret){if(u.aesmode=this._encryptionMode,u.aespassword=await ap(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new pl(ll.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(u.aessalt=this._encryptionSalt)}this._startSession(this._sessionId,{channel:t,appId:e}),Fa(()=>{"CONNECTING"===this.connectionState&&nh.joinChannelTimeout(this._sessionId,5)},5e3);try{var d;let i;if("443only"===u.cloudProxyServer)u.proxyServer=jc("PROXY_SERVER_TYPE2");else if("proxy3"===u.cloudProxyServer||"proxy4"===u.cloudProxyServer||"proxy5"===u.cloudProxyServer){const e=jc("PROXY_SERVER_TYPE3");hl(e)?u.proxyServer=e[0]:u.proxyServer=e}if(nh.setProxyServer(u.proxyServer),Rc.setProxyServer(u.proxyServer),this._performanceRecorder.checkPoint("startRequestAp"),this.store.requestAPStart(),u.stringUid&&!u.uid&&"normal"===u.cloudProxyServer){var h;await C_(u,this._axiosCancelSource.token,this._config.httpRetryConfig||Zd,!1);const e=await T_(u.stringUid,u,this._axiosCancelSource.token,this._config.httpRetryConfig||Zd);Rc.debug(Je(h="getUserAccount Success ".concat(u.stringUid," => ")).call(h,e)),u.uid=e,i=await S_(u,this._axiosCancelSource.token,this._config.httpRetryConfig||Zd)}else if(u.stringUid&&!u.uid){var p;const e=await T_(u.stringUid,u,this._axiosCancelSource.token,this._config.httpRetryConfig||Zd);Rc.debug(Je(p="getUserAccount Success ".concat(u.stringUid," => ")).call(p,e)),u.uid=e,i=await C_(u,this._axiosCancelSource.token,this._config.httpRetryConfig||Zd,!0)}else i=await C_(u,this._axiosCancelSource.token,this._config.httpRetryConfig||Zd,!0);if(!this._joinAndNotLeaveYet)throw new pl(ll.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this.store.requestAPEnd(),this._performanceRecorder.checkPoint("startJoinGateway"),this._configDistribute.startGetConfigDistribute(u,this._axiosCancelSource.token),this._configDistribute.on(Ru.UPDATE_BITRATE_LIMIT,e=>{this._p2pChannel.updateBitrateLimit(e)}),this._key=r||e,this._joinInfo=CA({},u,{cid:i.gatewayInfo.cid,uid:u.uid?u.uid:i.gatewayInfo.uid,vid:i.gatewayInfo.vid,apResponse:i.gatewayInfo.res,uni_lbs_ip:i.gatewayInfo.uni_lbs_ip,gatewayAddrs:i.gatewayInfo.gatewayAddrs});const n=await this._gateway.join(this._joinInfo,this._key);if(!this._joinAndNotLeaveYet)throw new pl(ll.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));return l.onSuccess(n),this._appId=e,this._channelName=u.cname,this._uid=n,this.store.uid=n,this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener(ba()?"beforeunload":"pagehide",this._handleBeforeUnload),Rc.info(Je(d="[".concat(this._clientId,"] Joining channel success: ")).call(d,t)),Fa(()=>{Rc.startUpload()},5e3),this._performanceRecorder.checkPoint("finishJoin"),this.store.joinEnd(),$c(this),n}catch(e){const t=hl(e)?e[0]:e;throw Rc.error("[".concat(this._clientId,"] Joining channel failed, rollback"),t),t.code!==ll.OPERATION_ABORTED&&(this._gateway.state="DISCONNECTED",this._reset()),l.onError(t),t}}async leave(){const e=nh.reportApiInvoke(this._sessionId,{name:Nl.LEAVE,options:[],tag:Ll.TRACER});Rc.info("[".concat(this._clientId,"] Leaving channel")),window.removeEventListener(ba()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),Jc(this);const t=await this._leaveMutex.lock();if("DISCONNECTED"===this.connectionState)return Rc.info("[".concat(this._clientId,"] Leaving channel repeated, success")),t(),e.onSuccess();await this._gateway.leave("CONNECTED"!==this.connectionState),Rc.info("[".concat(this._clientId,"] Leaving channel success")),this._joinAndNotLeaveYet=!1,t(),e.onSuccess()}async publish(e,t=!0){var r;hl(e)||(e=[e]);const i=nh.reportApiInvoke(this._sessionId,{name:Nl.PUBLISH,options:vo(e).call(e,e=>e?Object(e).toString():"null"),tag:Ll.TRACER});if(0===e.length){const e=new pl(ll.INVALID_PARAMS,"track list is empty");return i.onError(e),e.throw()}if("audience"===this._gateway.role){const e=new pl(ll.INVALID_OPERATION,"audience can not publish stream");return i.onError(e),e.throw()}for(const s of e){if(!(s instanceof lh)){const e=new pl(ll.INVALID_PARAMS,"parameter is not local track");return i.onError(e),e.throw()}if(!s._enabled&&t){const e=new pl(ll.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(s.getTrackId()));return i.onError(e),e.throw()}}Rc.info(Je(r="[".concat(this._clientId,"] Publishing tracks, id ")).call(r,vo(e).call(e,e=>"".concat(e.getTrackId()," ")))),await this._configDistribute.awaitConfigDistributeComplete(),t&&Jr(e).call(e,e=>{const t=this._configDistribute.getBitrateLimit();e instanceof Tv&&t&&e.setBitrateLimit(t.uplink)});const n=await this._publishMutex.lock();try{var o;await this._publishHighStream(e),i.onSuccess(vo(e).call(e,e=>e.trackMediaType+":"+e.getTrackLabel()).toString()),Rc.info(Je(o="[".concat(this._clientId,"] Publish success, id ")).call(o,vo(e).call(e,e=>"".concat(e.getTrackId()," "))))}catch(e){throw i.onError(e),Rc.error("[".concat(this._clientId,"] publish error"),e.toString()),e}finally{n()}}async unpublish(e,t=!0){var r;if(!this._joinInfo||void 0===this._uid)throw new pl(ll.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");e?hl(e)||(e=[e]):e=this._p2pChannel.getAllTracks();const i=nh.reportApiInvoke(this._sessionId,{name:Nl.UNPUBLISH,options:vo(e).call(e,e=>e.getTrackId()),tag:Ll.TRACER});Rc.info(Je(r="[".concat(this._clientId,"] Unpublish tracks, tracks ")).call(r,vo(e).call(e,e=>"".concat(e.getTrackId()," "))," "));const n=await this._publishMutex.lock();try{var o;const t=await this._p2pChannel.unpublish(e);t&&await this._gateway.unpublish(t,this._uid),Rc.info(Je(o="[".concat(this._clientId,"] Unpublish success,tracks ")).call(o,vo(e).call(e,e=>"".concat(e.getTrackId())))),i.onSuccess()}catch(e){throw i.onError(e),Rc.error("[".concat(this._clientId,"] unpublish error"),e.toString()),e}finally{n&&n()}}async subscribe(e,t){var r,i,n;gl(t,"mediaType",["audio","video"]);const o=nh.reportApiInvoke(this._sessionId,{name:Nl.SUBSCRIBE,options:[e.uid,t],tag:Ll.TRACER});if(!this._joinInfo){const e=new pl(ll.INVALID_OPERATION,"Can't subscribe stream, not joined");throw o.onError(e),e}if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState){const e=new pl(ll.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));throw o.onError(e),e}if(!Qo(r=this._users).call(r,t=>t===e)){var s;const t=new pl(ll.INVALID_REMOTE_USER,"user is not in the channel");throw Rc.error(Je(s="[".concat(this._clientId,"] can not subscribe ")).call(s,e.uid,", this user is not in the channel")),o.onError(t),t}if(!e.hasAudio&&!e.hasVideo){var a;const t=new pl(ll.INVALID_REMOTE_USER,"user is not published");throw Rc.error(Je(a="[".concat(this._clientId,"] can not subscribe ")).call(a,e.uid,", user is not published")),o.onError(t),t}if("audio"===t&&(!e.hasAudio||void 0===e._audioSSRC)||"video"===t&&(!e.hasVideo||void 0===e._videoSSRC)){var c,l;const r=new pl(ll.REMOTE_USER_IS_NOT_PUBLISHED);throw Rc.error(Je(c=Je(l="[".concat(this._clientId,"] can not subscribe ")).call(l,e.uid," with mediaType ")).call(c,t,", remote track is not published")),o.onError(r),r}const u="audio"===t?e._audioSSRC:e._videoSSRC,d="audio"===t?e._audioOrtc:e._videoOrtc,h={stream_type:"audio"===t?ku.AUDIO:ku.VIDEO,ssrcId:u};let p=this._subscribeMutex.get(e.uid);p||(p=new ah("sub-".concat(e.uid)),this._subscribeMutex.set(e.uid,p)),Rc.info(Je(i=Je(n="[".concat(this._clientId,"] subscribe user ")).call(n,e.uid,", mediaType: ")).call(i,t));const f=await p.lock();try{var g,m;if(this._p2pChannel.hasRemoteMedia(e,t))await this._p2pChannel.unmuteRemote(e,t);else try{zh.markSubscribeStart(this.store.clientId,u),this.store.subscribe(e.uid,t,performance.now()),await this._p2pChannel.subscribe(e,t,u,d),await this._gateway.subscribe(e.uid,h,!0),this.store.subscribe(e.uid,t,void 0,performance.now()),this._p2pChannel.reportSubscribeEvent(!0,null,e,t)}catch(r){if(this._p2pChannel.reportSubscribeEvent(!1,null==r?void 0:r.code,e,t),(null==r?void 0:r.code)!==ll.WS_ABORT)throw r;this._p2pChannel.setPendingRemoteMedia(e,t)}Rc.info(Je(g=Je(m="[".concat(this._clientId,"] subscribe success user ")).call(m,e.uid,", mediaType: ")).call(g,t)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(e.uid,this._defaultStreamFallbackType).catch(e=>{Rc.warning("[".concat(this._clientId,"] auto set fallback failed"),e)});const i="audio"===t?e._audioTrack:e._videoTrack;if(!i){const e=new pl(ll.UNEXPECTED_ERROR,"can not find remote track in user object");return o.onError(e),e.throw()}return o.onSuccess(i.getTrackId()),i}catch(t){var _;throw o.onError(t),Rc.error(Je(_="[".concat(this._clientId,"] subscribe user ")).call(_,e.uid," error"),t),t}finally{f()}}async unsubscribe(e,t){var r,i,n;if(t&&gl(t,"mediaType",["audio","video"]),!this._joinInfo)throw new pl(ll.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");const o=nh.reportApiInvoke(this._sessionId,{name:Nl.UNSUBSCRIBE,options:[e.uid,t],tag:Ll.TRACER});if(!Qo(r=this._users).call(r,t=>t===e)){var s;const t=new pl(ll.INVALID_REMOTE_USER,"user is not in the channel");throw Rc.error(Je(s="[".concat(this._clientId,"] can not subscribe ")).call(s,e.uid,", user is not in the channel")),o.onError(t),t}Rc.info(Je(i=Je(n="[".concat(this._clientId,"] unsubscribe uid: ")).call(n,e.uid,", mediaType: ")).call(i,t));let a=this._subscribeMutex.get(e.uid);a||(a=new ah("sub-".concat(e.uid)),this._subscribeMutex.set(e.uid,a));const c=await a.lock();try{var l,u;const r=await this._p2pChannel.unsubscribe(e,t);r&&await this._gateway.unsubscribe(r,e.uid),Rc.info(Je(l=Je(u="[".concat(this._clientId,"] unsubscribe success uid: ")).call(u,e.uid,", mediaType: ")).call(l,t)),o.onSuccess()}catch(t){if(t.code===ll.DISCONNECT_P2P)return void Rc.warning("disconnecting p2p, abort unsubscribe request.");var d;throw Rc.error(Je(d="[".concat(this._clientId,"] unsubscribe user ")).call(d,e.uid," error"),t.toString()),t}finally{c()}}setLowStreamParameter(e){!function(e){if(!e)throw new pl(ll.INVALID_PARAMS);yl(e.width)||ml(e.width,"streamParameter.width"),yl(e.height)||ml(e.height,"streamParameter.height"),yl(e.framerate)||ml(e.framerate,"streamParameter.framerate"),yl(e.bitrate)||ml(e.bitrate,"streamParameter.bitrate")}(e);const t=nh.reportApiInvoke(this._sessionId,{name:Nl.SET_LOW_STREAM_PARAMETER,options:[e],tag:Ll.TRACER});(!e.width&&e.height||e.width&&!e.height)&&Rc.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),Rc.info("[".concat(this._clientId,"] set low stream parameter to"),ve(e));const r=this._configDistribute.getLowStreamConfigDistribute();r&&r.bitrate&&e.bitrate&&r.bitrate<e.bitrate&&(e.bitrate=r.bitrate),this._lowStreamParameter=e,t.onSuccess()}async enableDualStream(){const e=nh.reportApiInvoke(this._sessionId,{name:Nl.ENABLE_DUAL_STREAM,options:[],tag:Ll.TRACER});if(!Fu().supportDualStream){nh.streamSwitch(this._sessionId,{lts:Ma(),isdual:!0,succ:!1});const t=new pl(ll.NOT_SUPPORTED,"Your browser is not support dual stream");throw e.onError(t),t}if(this._isDualStreamEnabled){const t=new pl(ll.INVALID_OPERATION,"Dual stream is already enabled");throw e.onError(t),t}if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(i){throw nh.streamSwitch(this._sessionId,{lts:Ma(),isdual:!0,succ:!1}),e.onError(i),i}this._isDualStreamEnabled=!0,nh.streamSwitch(this._sessionId,{lts:Ma(),isdual:!0,succ:!0}),Rc.info("[".concat(this._clientId,"] enable dual stream")),e.onSuccess()}async disableDualStream(){if(!this._isDualStreamEnabled)return;if(!this._joinInfo)throw new pl(ll.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");const e=nh.reportApiInvoke(this._sessionId,{name:Nl.DISABLE_DUAL_STREAM,options:[],tag:Ll.TRACER});if(this._p2pChannel.getLocalMedia(Ou.LocalVideoLowTrack))try{const e=await this._p2pChannel.unpublishLowStream();e&&await this._gateway.unpublish(e,this._joinInfo.stringUid||this._joinInfo.uid)}catch(i){throw nh.streamSwitch(this._sessionId,{lts:Ma(),isdual:!1,succ:!1}),e.onError(i),i}this._isDualStreamEnabled=!1,nh.streamSwitch(this._sessionId,{lts:Ma(),isdual:!1,succ:!0}),Rc.info("[".concat(this._clientId,"] disable dual stream")),e.onSuccess()}async setClientRole(e,t){!function(e){gl(e,"role",["audience","host"])}(e),t&&Jl(t);const r=nh.reportApiInvoke(this._sessionId,{name:Nl.SET_CLIENT_ROLE,options:[e,t],tag:Ll.TRACER});if("rtc"===this._mode){Rc.warning("[".concat(this._clientId,"]rtc mode can not use setClientRole"));const e=new pl(ll.INVALID_OPERATION,"rtc mode can not use setClientRole");return r.onError(e),e.throw()}if(t&&t.level&&"host"===e){const e=new pl(ll.INVALID_OPERATION,"host mode can not set audience latency level");return r.onError(e),e.throw()}try{var i,n;if("audience"===e&&this._p2pChannel.hasLocalMedia()){const e=new pl(ll.INVALID_OPERATION,"can not set client role to audience when publishing stream");return r.onError(e),e.throw()}await this._gateway.setClientRole(e,t),Rc.info(Je(i=Je(n="[".concat(this._clientId,"] set client role to ")).call(n,e,", level: ")).call(i,t&&t.level)),r.onSuccess()}catch(e){throw r.onError(e),e}}setProxyServer(e){if(_l(e,"proxyServer"),"DISCONNECTED"!==this.connectionState)throw new pl(ll.INVALID_OPERATION,"Set proxy server before join channel");if("disabled"!==this._cloudProxyServerMode||this._useLocalAccessPoint)throw new pl(ll.INVALID_OPERATION,"You have already set the proxy");this._proxyServer=e,nh.setProxyServer(this._proxyServer),Rc.setProxyServer(this._proxyServer)}setTurnServer(e){if(hl(e)||(e=[e]),"DISCONNECTED"!==this.connectionState)throw new pl(ll.INVALID_OPERATION,"Set turn server before join channel");if("disabled"!==this._cloudProxyServerMode||this._useLocalAccessPoint)throw new pl(ll.INVALID_OPERATION,"You have already set the proxy");var t;if(Kl(e))return this._turnServer={servers:e,mode:"original-manual"},void Rc.info(Je(t="[".concat(this._clientId,"] Set original turnserver success: ")).call(t,vo(e).call(e,e=>e.urls).join(","),"."));Jr(e).call(e,e=>$l(e)),this._turnServer={servers:e,mode:"manual"},Rc.info("[".concat(this._clientId,"] Set turnserver success."))}startProxyServer(e){const t=nh.reportApiInvoke(this._sessionId,{name:Nl.START_PROXY_SERVER,options:[],tag:Ll.TRACER});if("DISCONNECTED"!==this.connectionState){const e=new pl(ll.INVALID_OPERATION,"Start proxy server before join channel");throw t.onError(e),e}if(this._proxyServer||"manual"===this._turnServer.mode||this._useLocalAccessPoint){const e=new pl(ll.INVALID_OPERATION,"You have already set the proxy");throw t.onError(e),e}const r=[1,2,3,4,5];switch(void 0===e&&(e=1),e){case 1:this._cloudProxyServerMode="normal";break;case 2:this._cloudProxyServerMode="443only";break;case 3:this._cloudProxyServerMode="proxy3";break;case 4:this._cloudProxyServerMode="proxy4";break;case 5:this._cloudProxyServerMode="proxy5";break;default:{const e=new pl(ll.INVALID_PARAMS,"proxy server mode must be ".concat(r.join("|")));throw t.onError(e),e}}Rc.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),t.onSuccess()}stopProxyServer(){const e=nh.reportApiInvoke(this._sessionId,{name:Nl.STOP_PROXY_SERVER,options:[],tag:Ll.TRACER});if("DISCONNECTED"!==this.connectionState)throw new pl(ll.INVALID_OPERATION,"Stop proxy server after leave channel");nh.setProxyServer(),Rc.setProxyServer(),this._cloudProxyServerMode="disabled",Rc.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]},e.onSuccess()}setLocalAccessPoints(e,t){if(vl(e,"serverList"),_l(t,"domain"),this._proxyServer||"disabled"!==this._cloudProxyServerMode)throw new pl(ll.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const r=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;e=vo(e).call(e,e=>{var i;return r.test(e)?Je(i="".concat(e.replace(/\./g,"-"),".")).call(i,t):e}),this._useLocalAccessPoint=!0,Vc("WEBCS_DOMAIN",e),Vc("WEBCS_DOMAIN_BACKUP_LIST",e),Vc("GATEWAY_DOMAINS",[t]),Vc("EVENT_REPORT_DOMAIN",e[0]),Vc("EVENT_REPORT_BACKUP_DOMAIN",e[1]||e[0]),Vc("LOG_UPLOAD_SERVER","".concat(e[0],":6444")),Rc.info("set local access point success")}async setRemoteVideoStreamType(e,t){var r,i;gl(t,"streamType",[0,1]);const n=nh.reportApiInvoke(this._sessionId,{name:Nl.SET_REMOTE_VIDEO_STREAM_TYPE,options:[e,t],tag:Ll.TRACER});try{await this._gateway.setRemoteVideoStreamType(e,t),Fa(()=>{var t;const r=Qo(t=this._users).call(t,t=>t.uid===e);r&&r.videoTrack&&r.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(e){throw n.onError(e),Rc.error("[".concat(this._clientId,"] set remote video stream type error"),e.toString()),e}Rc.info(Je(r=Je(i="[".concat(this._clientId,"] set remote ")).call(i,e," video stream type to ")).call(r,t)),this._remoteStreamTypeCacheMap.set(e,t),n.onSuccess()}async setStreamFallbackOption(e,t){var r,i;gl(t,"fallbackType",[0,1,2]);const n=nh.reportApiInvoke(this._sessionId,{name:Nl.SET_STREAM_FALLBACK_OPTION,options:["too long to show",t],tag:Ll.TRACER});try{await this._gateway.setStreamFallbackOption(e,t)}catch(e){throw n.onError(e),Rc.error("[".concat(this._clientId,"] set stream fallback option"),e.toString()),e}Rc.info(Je(r=Je(i="[".concat(this._clientId,"] set remote ")).call(i,e," stream fallback type to ")).call(r,t)),this._streamFallbackTypeCacheMap.set(e,t),n.onSuccess()}setEncryptionConfig(e,t,r){!function(e){gl(e,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])}(e),_l(t,"secret");const i=["aes-128-gcm2","aes-256-gcm2"];if(is(i).call(i,e)){if(!r||!(r instanceof Uint8Array&&32===r.length))throw new pl(ll.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(r)throw new pl(ll.INVALID_PARAMS,"current encrypt mode does not need salt");new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'\"|{}\\[\\]])(?=.{8,})").test(t)||Rc.warning("The secret is not strong:\n      The secret must contain at least 1 lowercase alphabetical character,\n      The secret must contain at least 1 uppercase alphabetical character,\n      The secret must contain at least 1 numeric character,\n      The secret must contain at least one special character,\n      The secret must be eight characters or longer.\n      "),this._encryptionMode=e,this._encryptionSecret=t,r&&(this._encryptionSalt=Wp(r))}async renewToken(e){_l(e,"token",1,2047);const t=nh.reportApiInvoke(this._sessionId,{name:Nl.RENEW_TOKEN,options:[e],tag:Ll.TRACER});if(!this._key||!this._joinInfo){const e=new pl(ll.INVALID_OPERATION,"renewToken should not be called before user join");return t.onError(e),e.throw()}const r=this._key;this._key=e,this._joinInfo&&(this._joinInfo.token=e);const i=await this._renewTokenMutex.lock();try{if(jc("USE_NEW_TOKEN")){Rc.debug("start renew token with ticket from unilbs");const t=await k_(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||Zd);Rc.debug("[".concat(this._clientId,"] get ticket from unilbs success")),await this._gateway.renewToken({token:e,ticket:t})}else Rc.debug("start renew token without ticket"),await this._gateway.renewToken({token:e});Rc.debug("[".concat(this._clientId,"] renewToken success")),t.onSuccess()}catch(e){throw this._key=r,this._joinInfo.token=r,t.onError(e),Rc.error("[".concat(this._clientId,"] renewToken failed"),e.toString()),e}finally{i()}}enableAudioVolumeIndicator(){const e=nh.reportApiInvoke(this._sessionId,{name:Nl.ENABLE_AUDIO_VOLUME_INDICATOR,options:[],tag:Ll.TRACER});if(this._audioVolumeIndicationInterval)return Rc.warning("you have already enabled audio volume indicator!"),e.onSuccess();this._audioVolumeIndicationInterval=window.setInterval(()=>{const e=this._p2pChannel.getAudioLevels();this.emit(Vl.VOLUME_INDICATOR,e)},jc("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3),e.onSuccess()}getRTCStats(){const e=this._statsCollector.getRTCStats(),t=this._gateway.getInChannelInfo();return e.Duration=Math.round(t.duration/1e3),e}startLiveStreaming(e,t){const r=nh.reportApiInvoke(this._sessionId,{name:Nl.START_LIVE_STREAMING,options:[e,t],tag:Ll.TRACER});if(!t){if("h264"!==this._codec){const e=new pl(ll.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");return r.onError(e),fo.reject(e)}if(!this._p2pChannel.hasLocalMedia()){const e=new pl(ll.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming");return r.onError(e),fo.reject(e)}}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(e)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(e)){const e=new pl(ll.LIVE_STREAMING_TASK_CONFLICT);return r.onError(e),fo.reject(e)}const i=t?ou.TRANSCODE:ou.RAW;return this._createLiveStreamingClient(i).startLiveStreamingTask(e,i).then(()=>r.onSuccess()).catch(e=>{throw r.onError(e),e})}setLiveTranscoding(e){const t=nh.reportApiInvoke(this._sessionId,{name:Nl.SET_LIVE_TRANSCODING,options:[e],tag:Ll.TRACER});return this._createLiveStreamingClient(ou.TRANSCODE).setTranscodingConfig(e).then(()=>t.onSuccess()).catch(e=>{throw t.onError(e),e})}stopLiveStreaming(e){var t;const r=nh.reportApiInvoke(this._sessionId,{name:Nl.STOP_LIVE_STREAMING,options:[e],tag:Ll.TRACER}),i=ji(t=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient]).call(t,t=>t&&t.hasUrl(e));if(!i.length){const e=new pl(ll.INVALID_PARAMS,"can not find live streaming url to stop");return r.onError(e),fo.reject(e)}return fo.all(vo(i).call(i,t=>t&&t.stopLiveStreamingTask(e))).then(()=>r.onSuccess()).catch(e=>{throw r.onError(e),e})}async addInjectStreamUrl(e,t){const r=nh.reportApiInvoke(this._sessionId,{name:Nl.ADD_INJECT_STREAM_URL,options:[e,t],tag:Ll.TRACER});try{if(!this._joinInfo)throw new pl(ll.INVALID_OPERATION,"can not addInjectStreamUrl, no joininfo");const r=this._createLiveStreamingClient(ou.INJECT);r.setInjectStreamConfig(t,0),await r.startLiveStreamingTask(e,ou.INJECT)}catch(e){throw r.onError(e),e}r.onSuccess()}async removeInjectStreamUrl(){const e=nh.reportApiInvoke(this._sessionId,{name:Nl.REMOVE_INJECT_STREAM_URL,options:[],tag:Ll.TRACER});try{var t,r;const e=this._createLiveStreamingClient(ou.INJECT),i=Qo(t=Bd(Jp(r=e.streamingTasks).call(r))).call(t,e=>e.mode===ou.INJECT);if(!this._joinInfo||!i)throw new pl(ll.INVALID_OPERATION,"can remove addInjectStreamUrl, no joininfo or inject task");await e.stopLiveStreamingTask(i.url)}catch(t){throw e.onError(t),t}e.onSuccess()}async startChannelMediaRelay(e){const t=nh.reportApiInvoke(this._sessionId,{name:Nl.START_CHANNEL_MEDIA_RELAY,options:[e],tag:Ll.TRACER});try{V_(e);const t=this._createChannelMediaRelayClient();await t.startChannelMediaRelay(e)}catch(e){return t.onError(e),e.throw()}t.onSuccess()}async updateChannelMediaRelay(e){const t=nh.reportApiInvoke(this._sessionId,{name:Nl.UPDATE_CHANNEL_MEDIA_RELAY,options:[e],tag:Ll.TRACER});try{V_(e);const t=this._createChannelMediaRelayClient();await t.updateChannelMediaRelay(e)}catch(e){return t.onError(e),e.throw()}t.onSuccess()}async stopChannelMediaRelay(){const e=nh.reportApiInvoke(this._sessionId,{name:Nl.STOP_CHANNEL_MEDIA_RELAY,options:[],tag:Ll.TRACER});try{const e=this._createChannelMediaRelayClient();await e.stopChannelMediaRelay()}catch(i){return e.onError(i),i.throw()}e.onSuccess()}sendStreamMessage(e,t=!0){if(!this._joinInfo)throw new pl(ll.INVALID_OPERATION,"can not send data stream, not joined");if("string"==typeof e&&(e=(new TextEncoder).encode(e)),new Blob([e]).size>1024)throw new pl(ll.INVALID_PARAMS,"stream message out of range.");return this._gateway.signal.request(Ql.DATA_STREAM,{payload:Wp(e)},!t)}sendMetadata(e){if(!this._joinInfo)throw new pl(ll.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([e]).size>1024)throw new pl(ll.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(Ql.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:Wp(e)})}async sendCustomReportMessage(e){hl(e)||(e=[e]),Jr(e).call(e,Il);const t=nh.reportApiInvoke(this._sessionId,{name:Nl.SEND_CUSTOM_REPORT_MESSAGE,options:[ve(e)],tag:Ll.TRACER});if(!this._joinInfo){const e=new pl(ll.INVALID_OPERATION,"can not send custom report, not joined");return t.onError(e),e.throw()}await nh.sendCustomReportMessage(this._joinInfo.sid,e),t.onSuccess()}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}async pickSVCLayer(e,t){gl(t.spatialLayer,"spatialLayer",[0,1,2,3]),gl(t.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(e,t)}catch(e){throw Rc.error("[".concat(this._clientId,"] pick SVC layer failed"),e.toString()),e}}_reset(){var e;Rc.debug("[".concat(this._clientId,"] reset client")),this._axiosCancelSource.cancel(),this._axiosCancelSource=Sc.CancelToken.source(),this._streamFallbackTypeCacheMap=new Mr,this._remoteStreamTypeCacheMap=new Mr,this._configDistribute.stopGetConfigDistribute(),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,Jr(e=this._users).call(e,e=>{e._audioTrack&&e._audioTrack._destroy(),e._videoTrack&&e._videoTrack._destroy()}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),this._p2pChannel.reset(),this._publishMutex=new ah("client-publish"),this._subscribeMutex=new Mr,this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._injectStreamingClient&&(this._injectStreamingClient.terminate(),this._injectStreamingClient.removeAllListeners(),this._injectStreamingClient=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0)}_startSession(e,t){var r,i,n;const o=e||Op();e?Rc.debug(Je(r="[".concat(this._clientId,"] new Session ")).call(r,o)):Rc.debug(Je(i=Je(n="[".concat(this._clientId,"] renewSession ")).call(n,this._sessionId," => ")).call(i,o)),this._sessionId=o,this.store.sessionId=o,t?nh.sessionInit(this._sessionId,{lts:(new Date).getTime(),cname:t.channel,appid:t.appId,mode:this._mode}):this._joinInfo?nh.sessionInit(this._sessionId,{lts:(new Date).getTime(),cname:this._joinInfo.cname,appid:this._joinInfo.appId,mode:this._mode}):this._gateway.joinInfo&&nh.sessionInit(this._sessionId,{lts:(new Date).getTime(),cname:this._gateway.joinInfo.cname,appid:this._gateway.joinInfo.appId,mode:this._mode}),this._joinInfo&&(this._joinInfo.sid=o),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=o)}async _publishHighStream(e){if(!this._joinInfo||void 0===this._uid)throw new pl(ll.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new pl(ll.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if("auto"===this._turnServer.mode&&jc("FORCE_TURN")&&!jc("TURN_ENABLE_TCP")&&!jc("TURN_ENABLE_UDP"))throw new pl(ll.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");Rc.debug("[".concat(this._clientId,"] publish high stream"));try{const r=await this._p2pChannel.publish(e,this._isDualStreamEnabled,this._lowStreamParameter),i=(await r.next()).value;if(i){var t;let n;try{n=await this._gateway.publish(this._uid,i,!0)}catch(e){if(e.code!==ll.DISCONNECT_P2P)throw r.throw(e),e}await r.next((null===(t=n)||void 0===t?void 0:t.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(const t of e)t.muted&&await this._p2pChannel.muteLocalTrack(t)}catch(t){if(this._p2pChannel.reportPublishEvent(!1,null==t?void 0:t.code,e),(null==t?void 0:t.code)===ll.WS_ABORT)return;throw t}}async _publishLowStream(){if(!this._joinInfo||void 0===this._uid)throw new pl(ll.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new pl(ll.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));Rc.debug("[".concat(this._clientId,"] publish low stream"));const e=this._configDistribute.getLowStreamConfigDistribute();e&&e.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&e.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=e.bitrate));try{const e=await this._p2pChannel.publishLowStream(this._lowStreamParameter),r=(await e.next()).value;if(r){var t;let i;try{i=await this._gateway.publish(this._uid,r,!0)}catch(t){if(t.code!==ll.DISCONNECT_P2P)throw e.throw(t),t}e.next((null===(t=i)||void 0===t?void 0:t.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(e){if(this._p2pChannel.reportPublishEvent(!1,null==e?void 0:e.code,void 0,!0),(null==e?void 0:e.code)===ll.WS_ABORT)return;throw e}}_createLiveStreamingClient(e){if(!this._joinInfo||!this._appId)return new pl(ll.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const t=()=>new U_(this._joinInfo,this._config.websocketRetryConfig||Zd,this._config.httpRetryConfig||Zd),r=e=>{e.onLiveStreamError=(e,t)=>{nh.reportApiInvoke(this._sessionId,{name:Nl.ON_LIVE_STREAM_ERROR,options:[e,t],tag:Ll.TRACER}).onSuccess(),this.emit(Vl.LIVE_STREAMING_ERROR,e,t)},e.onLiveStreamWarning=(e,t)=>{nh.reportApiInvoke(this._sessionId,{name:Nl.ON_LIVE_STREAM_WARNING,options:[e,t],tag:Ll.TRACER}).onSuccess(),this.emit(Vl.LIVE_STREAMING_WARNING,e,t)},e.on(hu.REQUEST_WORKER_MANAGER_LIST,(e,t,r)=>{if(!this._joinInfo)return r(new pl(ll.INVALID_OPERATION,"can not find join info to get worker manager"));R_(e,this._joinInfo,this._axiosCancelSource.token,Zd).then(t).catch(r)})};switch(e){case ou.RAW:return this._liveRawStreamingClient||(this._liveRawStreamingClient=t(),r(this._liveRawStreamingClient)),this._liveRawStreamingClient;case ou.TRANSCODE:return this._liveTranscodeStreamingClient||(this._liveTranscodeStreamingClient=t(),r(this._liveTranscodeStreamingClient)),this._liveTranscodeStreamingClient;case ou.INJECT:return this._injectStreamingClient||(this._injectStreamingClient=t(),this._injectStreamingClient.on(hu.REQUEST_WORKER_MANAGER_LIST,(e,t,r)=>{if(!this._joinInfo)return r(new pl(ll.INVALID_OPERATION,"can not find join info to get worker manager"));R_(e,this._joinInfo,this._axiosCancelSource.token,Zd).then(t).catch(r)}),this._injectStreamingClient.onInjectStatusChange=(e,t,r)=>{this.emit(Vl.INJECT_STREAM_STATUS,e,t,r)}),this._injectStreamingClient}}_createChannelMediaRelayClient(){return this._joinInfo?(this._channelMediaRelayClient||(this._channelMediaRelayClient=new G_(this._joinInfo,this._clientId,this._config.websocketRetryConfig||Zd,this._config.httpRetryConfig||Zd),this._channelMediaRelayClient.on("state",e=>{"RELAY_STATE_FAILURE"===e&&this._channelMediaRelayClient&&this._channelMediaRelayClient.dispose(),this.emit(Vl.CHANNEL_MEDIA_RELAY_STATE,e)}),this._channelMediaRelayClient.on("event",e=>{this.emit(Vl.CHANNEL_MEDIA_RELAY_EVENT,e)})),this._channelMediaRelayClient):new pl(ll.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw()}_handleGatewayEvents(){this._gateway.on(_u.DISCONNECT_P2P,async()=>{await this._p2pChannel.disconnectForReconnect()}),this._gateway.on(_u.CONNECTION_STATE_CHANGE,(e,t,r)=>{var i,n;const o=()=>{this.emit(Vl.CONNECTION_STATE_CHANGE,e,t,r)};if(nh.reportApiInvoke(this._sessionId,{name:Nl.CONNECTION_STATE_CHANGE,options:[e,t,r],tag:Ll.TRACER}).onSuccess(ve({cur:e,prev:t,reason:r})),Rc.info(Je(i=Je(n="[".concat(this._clientId,"] connection state change: ")).call(n,t," -> ")).call(i,e)),"DISCONNECTED"===e)return this._reset(),void o();var s;if("RECONNECTING"===e)Jr(s=this._users).call(s,e=>{e._trust_in_room_=!1,e._trust_audio_enabled_state_=!1,e._trust_video_enabled_state_=!1,e._trust_audio_mute_state_=!1,e._trust_video_mute_state_=!1,e._trust_stream_added_state_=!1}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if("CONNECTED"===e){var a,c;Jr(a=this._streamFallbackTypeCacheMap).call(a,(e,t)=>{this._gateway.setStreamFallbackOption(t,e).catch(e=>Rc.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),e))}),Jr(c=this._remoteStreamTypeCacheMap).call(c,(e,t)=>{this._gateway.setRemoteVideoStreamType(t,e).catch(e=>Rc.warning("[".concat(this._clientId,"] auto set remote stream type failed"),e))}),this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{var e;if("CONNECTED"!==this.connectionState)return;this._userOfflineTimeout=void 0;const t=ji(e=this._users).call(e,e=>!e._trust_in_room_);Jr(t).call(t,e=>{var t;Rc.debug(Je(t="[".concat(this._clientId,"] user offline timeout, emit user offline ")).call(t,e.uid)),this._handleUserOffline({uid:e.uid})})},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{var e;"CONNECTED"===this.connectionState&&(this._streamRemovedTimeout=void 0,Jr(e=this._users).call(e,e=>{var t,r,i,n,o;e._trust_audio_mute_state_||(Rc.debug(Je(t="[".concat(this._clientId,"] auto dispatch audio unmute event ")).call(t,e.uid)),this._handleMuteStream(e.uid,"audio",!1)),e._trust_video_mute_state_||(Rc.debug(Je(r="[".concat(this._clientId,"] auto dispatch video unmute event ")).call(r,e.uid)),this._handleMuteStream(e.uid,"video",!1)),e._trust_audio_enabled_state_||(Rc.debug(Je(i="[".concat(this._clientId,"] auto dispatch enable local audio ")).call(i,e.uid)),this._handleSetStreamLocalEnable("audio",e.uid,!0)),!e._trust_video_enabled_state_&&e._video_enabled_&&(Rc.debug(Je(n="[".concat(this._clientId,"] auto dispatch enable local video ")).call(n,e.uid)),this._handleSetStreamLocalEnable("video",e.uid,!0)),e._trust_stream_added_state_||(Rc.debug(Je(o="[".concat(this._clientId,"] auto dispatch stream remove ")).call(o,e.uid)),this._handleRemoveStream({uid:e.uid,uint_id:e._uintid}))}))},1e3)}o()}),this._gateway.on(_u.REQUEST_NEW_GATEWAY_LIST,(e,t)=>{if(!this._joinInfo)return t(new pl(ll.UNEXPECTED_ERROR,"can not recover, no join info"));S_(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||Zd).then(t=>{var r;this._joinInfo&&(this._joinInfo.apResponse=t.gatewayInfo.res),e(vo(r=t.gatewayInfo.gatewayAddrs).call(r,e=>{if(this._joinInfo&&this._joinInfo.proxyServer){var t,r;const i=e.split(":");return Je(t=Je(r="wss://".concat(this._joinInfo.proxyServer,"/ws/?h=")).call(r,i[0],"&p=")).call(t,i[1])}return"wss://".concat(e)}))}).catch(t)}),this._gateway.on(_u.NETWORK_QUALITY,e=>{"normal"===this._networkQualitySensitivity&&this.emit(Vl.NETWORK_QUALITY,e)}),this._gateway.on(_u.STREAM_TYPE_CHANGE,(e,t)=>{this.emit(Vl.STREAM_TYPE_CHANGED,e,t),nh.reportApiInvoke(this._sessionId,{name:Nl.STREAM_TYPE_CHANGE,options:[e,t],tag:Ll.TRACER}).onSuccess(ve({uid:e,streamType:t}))}),this._gateway.on(_u.IS_P2P_DISCONNECTED,e=>{this._p2pChannel.isP2PDisconnected()?e(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?e(!1):e(!0)}),this._gateway.on(_u.NEED_RENEW_SESSION,()=>{this._startSession()}),this._gateway.on(_u.REQUEST_P2P_CONNECTION_PARAMS,async(e,t,r)=>{try{t(await this._p2pChannel.startP2PConnection(e))}catch(e){r(e)}}),this._gateway.on(_u.JOIN_RESPONSE,e=>{const{dtlsParameters:t,iceParameters:r,candidates:i,rtpCapabilities:n,setup:o,cname:s,defaultIp:a,defaultPort:c}=rE(e.ortc);this._p2pChannel.connect(r,t,i,n,o,s,a,c)}),this._gateway.signal.on(ql.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(ql.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(ql.ON_ADD_AUDIO_STREAM,e=>this._handleAddAudioOrVideoStream("audio",e.uid,e.ssrcId,e.cname,e.uint_id,e.ortc)),this._gateway.signal.on(ql.ON_ADD_VIDEO_STREAM,e=>this._handleAddAudioOrVideoStream("video",e.uid,e.ssrcId,e.cname,e.uint_id,e.ortc)),this._gateway.signal.on(ql.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(ql.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(ql.MUTE_AUDIO,e=>this._handleMuteStream(e.uid,"audio",!0)),this._gateway.signal.on(ql.UNMUTE_AUDIO,e=>this._handleMuteStream(e.uid,"audio",!1)),this._gateway.signal.on(ql.MUTE_VIDEO,e=>this._handleMuteStream(e.uid,"video",!0)),this._gateway.signal.on(ql.UNMUTE_VIDEO,e=>this._handleMuteStream(e.uid,"video",!1)),this._gateway.signal.on(ql.RECEIVE_METADATA,e=>{const t=Qp(e.metadata);this.emit(Vl.RECEIVE_METADATA,e.uid,t)}),this._gateway.signal.on(ql.ON_DATA_STREAM,e=>{e.seq&&delete e.seq,e.payload=Qp(e.payload),this.emit(Vl.STREAM_MESSAGE,e.uid,e.payload),this.onStreamMessage&&this.onStreamMessage(e)}),this._gateway.signal.on(ql.ON_CRYPT_ERROR,()=>{Hp(()=>{Rc.warning("[".concat(this._clientId,"] on crypt error")),this.emit(Vl.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(ql.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(ql.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{Rc.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._gateway.leave(!0),this.emit(Vl.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(ql.ON_STREAM_FALLBACK_UPDATE,e=>{var t,r;Rc.debug(Je(t=Je(r="[".concat(this._clientId,"] stream fallback peerId: ")).call(r,e.stream_id,", attr: ")).call(t,e.stream_type)),this.emit(Vl.STREAM_FALLBACK,e.stream_id,1===e.stream_type?"fallback":"recover")}),this._gateway.signal.on(ql.ON_PUBLISH_STREAM,e=>{var t;this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,ve({proxy:e.proxy})),Rc.info(Je(t="[".concat(this._clientId,"] on publish stream, ")).call(t,ve(e))),void 0!==e.proxy&&this.emit(Vl.IS_USING_CLOUD_PROXY,!!e.proxy))}),this._gateway.signal.on(ql.ENABLE_LOCAL_VIDEO,e=>{this._handleSetStreamLocalEnable("video",e.uid,!0)}),this._gateway.signal.on(ql.DISABLE_LOCAL_VIDEO,e=>{this._handleSetStreamLocalEnable("video",e.uid,!1)}),this._gateway.signal.on(Hl.REQUEST_TIMEOUT,(e,t)=>{if(this._joinInfo)switch(e){case Ql.PUBLISH:{if(!t)return;const e=(t=t).ortc;if(e){var r,i,n,o;const s=as(e).call(e,({stream_type:e})=>e===mu.Audio),a=as(e).call(e,({stream_type:e})=>e!==mu.Audio),c=as(e).call(e,({stream_type:e})=>e===mu.Screen||e===mu.ScreenLow);"offer"===t.state&&nh.publish(this._joinInfo.sid,{eventElapse:zh.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:ll.TIMEOUT,audio:s,video:a,p2pid:t.p2p_id,publishRequestid:this.store.pubId,screenshare:c,audioName:s?null===(r=Qo(e).call(e,({stream_type:e})=>e===mu.Audio))||void 0===r||null===(i=r.ssrcs[0])||void 0===i?void 0:i.ssrcId.toString():void 0,videoName:a?null===(n=Qo(e).call(e,({stream_type:e})=>e!==mu.Audio))||void 0===n||null===(o=n.ssrcs[0])||void 0===o?void 0:o.ssrcId.toString():void 0})}break}case Ql.SUBSCRIBE:(t=t)&&nh.subscribe(this._joinInfo.sid,{succ:!1,ec:ll.TIMEOUT,audio:t.stream_type===ku.AUDIO,video:t.stream_type===ku.VIDEO,peerid:t.stream_id,subscribeRequestid:t.ssrcId,p2pid:this.store.p2pId,eventElapse:zh.measureFromSubscribeStart(this.store.clientId,t.ssrcId)})}}),this._gateway.signal.on(ql.ON_P2P_OK,e=>{this.uid===this._uid&&void 0!==e.proxy&&this.emit(Vl.IS_USING_CLOUD_PROXY,!!e.proxy)})}_handleP2PChannelEvents(){this._p2pChannel.on(Lu.RequestMuteLocal,async(e,t,r)=>{if(this._joinInfo)try{await this._gateway.muteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(e){e.code===ll.DISCONNECT_P2P?t():r(e)}else t()}),this._p2pChannel.on(Lu.RequestUnmuteLocal,async(e,t,r)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(e){e.code===ll.DISCONNECT_P2P?t():r(e)}else t()}),this._p2pChannel.on(Lu.RequestRePublish,(e,t,r)=>{this.publish(e,!1).then(t).catch(r)}),this._p2pChannel.on(Lu.RequestReSubscribe,async(e,t,r)=>{try{for(const{user:t,kind:r}of e)r===ku.VIDEO?await this.subscribe(t,"video"):await this.subscribe(t,"audio");t()}catch(e){r(e)}}),this._p2pChannel.on(Lu.RequestUploadStats,(e,t)=>{this._gateway.uploadStats(e,t)}),this._p2pChannel.on(Lu.MediaReconnectStart,e=>{this.emit(Vl.MEDIA_RECONNECT_START,e)}),this._p2pChannel.on(Lu.MediaReconnectEnd,e=>{this.emit(Vl.MEDIA_RECONNECT_END,e)}),this._p2pChannel.on(Lu.NeedSignalRTT,e=>{e(this._gateway.getSignalRTT())}),this._p2pChannel.on(Lu.RequestRestartICE,async()=>{const e=await this._p2pChannel.reEstablish();if(e){const{response:t}=await this._gateway.restartICE({iceParameters:e.iceParameters}),{candidates:r,iceParameters:i,defaultIp:n,defaultPort:o}=function(e){const t=e.ice,{candidates:r,defaultIp:i,defaultPort:n}=cE(t.candidates);return{candidates:r,iceParameters:{iceUfrag:t.iceUfrag,icePwd:t.icePwd},defaultIp:i,defaultPort:n}}(t);await e.restartICE(i,r,n,o)}}),this._p2pChannel.on(Lu.RequestReconnect,async()=>{this._gateway.reconnect()}),this._p2pChannel.on(Lu.RequestReconnectPC,async()=>{var e;const{iceParameters:t,dtlsParameters:r,rtpCapabilities:i}=await this._p2pChannel.startP2PConnection({turnServer:null===(e=this._joinInfo)||void 0===e?void 0:e.turnServer}),{gatewayEstablishParams:n}=await this._gateway.reconnectPC({iceParameters:t,dtlsParameters:r,rtpCapabilities:i}),{dtlsParameters:o,iceParameters:s,candidates:a,rtpCapabilities:c,setup:l,cname:u,defaultIp:d,defaultPort:h}=rE(n);await this._p2pChannel.connect(s,o,a,c,l,u,d,h),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()}),this._p2pChannel.on(Lu.RequestUnpublishForReconnectPC,async(e,t,r)=>{this._joinInfo&&void 0!==this._uid?(await this._gateway.unpublish(e,this._uid),t()):r()}),this._p2pChannel.on(Lu.P2PLost,()=>{this.emit(Vl.P2P_LOST,this.store.uid)})}getKeyMetrics(){return this.store.keyMetrics}}function PA(e){return ml(e.timeout,"config.timeout",0,1e5),ml(e.timeoutFactor,"config.timeoutFactor",0,100,!1),ml(e.maxRetryCount,"config.maxRetryConfig",0,1/0),ml(e.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}function DA(e){return _l(e.turnServerURL,"turnServerURL"),_l(e.username,"username"),_l(e.password,"password"),e.udpport&&ml(e.udpport,"udpport",1,99999,!0),e.forceturn&&fl(e.forceturn,"forceturn"),e.security&&fl(e.security,"security"),e.tcpport&&ml(e.tcpport,"tcpport",1,99999,!0),!0}function MA(e){return void 0!==e.level&&gl(e.level,"level",[1,2,3]),!0}function xA(e){return _l(e.reportId,"params.reportId",0,100,!1),_l(e.category,"params.category",0,100,!1),_l(e.event,"params.event",0,100,!1),_l(e.label,"params.label",0,100,!1),ml(e.value,"params.value",bl,Tl,!1),!0}OA([rh({report:nh}),NA("design:type",Function),NA("design:paramtypes",[String]),NA("design:returntype",void 0)],LA.prototype,"setProxyServer",null),OA([rh(),NA("design:type",Function),NA("design:paramtypes",[Object]),NA("design:returntype",void 0)],LA.prototype,"setTurnServer",null),OA([rh({report:nh}),NA("design:type",Function),NA("design:paramtypes",[Array,String]),NA("design:returntype",void 0)],LA.prototype,"setLocalAccessPoints",null),OA([rh({report:nh}),NA("design:type",Function),NA("design:paramtypes",[String,String,Uint8Array]),NA("design:returntype",void 0)],LA.prototype,"setEncryptionConfig",null),OA([ih({report:nh}),NA("design:type",Function),NA("design:paramtypes",[Object,Object]),NA("design:returntype",fo)],LA.prototype,"pickSVCLayer",null),function(e){e.CONNECTION_STATE_CHANGE="connection-state-change",e.MEDIA_RECONNECT_START="media-reconnect-start",e.MEDIA_RECONNECT_END="media-reconnect-end",e.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",e.USER_JOINED="user-joined",e.USER_LEAVED="user-left",e.USER_PUBLISHED="user-published",e.USER_UNPUBLISHED="user-unpublished",e.USER_INFO_UPDATED="user-info-updated",e.CLIENT_BANNED="client-banned",e.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",e.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",e.VOLUME_INDICATOR="volume-indicator",e.CRYPT_ERROR="crypt-error",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGED="stream-type-changed",e.STREAM_FALLBACK="stream-fallback",e.RECEIVE_METADATA="receive-metadata",e.STREAM_MESSAGE="stream-message",e.LIVE_STREAMING_ERROR="live-streaming-error",e.LIVE_STREAMING_WARNING="live-streaming-warning",e.INJECT_STREAM_STATUS="stream-inject-status",e.EXCEPTION="exception",e.ERROR="error",e.P2P_LOST="p2p_lost"}(TA||(TA={})),function(e){e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.MULTI_IP="MULTI_IP",e.TIMEOUT="TIMEOUT",e.OFFLINE="OFFLINE",e.LEAVE="LEAVE"}(bA||(bA={})),function(e){e.WIN_10="Windows 10",e.WIN_81="Windows 8.1",e.WIN_8="Windows 8",e.WIN_7="Windows 7",e.WIN_VISTA="Windows Vista",e.WIN_SERVER_2003="Windows Server 2003",e.WIN_XP="Windows XP",e.WIN_2000="Windows 2000",e.ANDROID="Android",e.OPEN_BSD="Open BSD",e.SUN_OS="Sun OS",e.LINUX="Linux",e.IOS="iOS",e.MAC_OS="Mac OS",e.QNX="QNX",e.UNIX="UNIX",e.BEOS="BeOS",e.OS_2="OS/2",e.SEARCH_BOT="Search Bot"}(IA||(IA={})),function(e){e.CHROME="Chrome",e.SAFARI="Safari",e.EDGE="Edge",e.FIREFOX="Firefox",e.OPERA="OPR",e.QQ="QQBrowser",e.WECHAT="MicroMessenger"}(RA||(RA={})),function(e){e.FREE="free",e.UPLOADING="uploading"}(wA||(wA={})),function(e){e.NONE="none",e.INIT="init",e.CANPLAY="canplay",e.PLAYING="playing",e.PAUSED="paused",e.SUSPEND="suspend",e.STALLED="stalled",e.WAITING="waiting",e.ERROR="error",e.DESTROYED="destroyed",e.ABORT="abort",e.ENDED="ended",e.EMPTIED="emptied"}(kA||(kA={}));const BA={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};var UA,FA,VA,jA,GA,HA,QA,WA,qA,zA,ZA,YA,KA,$A,JA,XA,ey,ty,ry;!function(e){e.PUBLISH="publish",e.SUBSCRIBE="subscribe",e.SESSION_INIT="session_init",e.JOIN_CHOOSE_SERVER="join_choose_server",e.REQ_USER_ACCOUNT="req_user_account",e.JOIN_GATEWAY="join_gateway",e.STREAM_SWITCH="stream_switch",e.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",e.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",e.FIRST_VIDEO_RECEIVED="first_video_received",e.FIRST_AUDIO_RECEIVED="first_audio_received",e.FIRST_VIDEO_DECODE="first_video_decode",e.FIRST_AUDIO_DECODE="first_audio_decode",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_UPDATE_STREAM="on_update_stream",e.ON_REMOVE_STREAM="on_remove_stream",e.USER_ANALYTICS="req_user_analytics"}(UA||(UA={})),function(e){e.SESSION="io.agora.pb.Wrtc.Session",e.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",e.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",e.JOIN_GATEWAT="io.agora.pb.Wrtc.JoinGateway",e.PUBLISH="io.agora.pb.Wrtc.Publish",e.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",e.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",e.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",e.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",e.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",e.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",e.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",e.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",e.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",e.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",e.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",e.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",e.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",e.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",e.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",e.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",e.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",e.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",e.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",e.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",e.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",e.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics"}(FA||(FA={})),function(e){e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"}(VA||(VA={})),function(e){e.CREATE_CLIENT="createClient",e.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",e.SET_AREA="setArea",e.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",e.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",e.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",e.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",e.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",e.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",e.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",e.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",e.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",e.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",e.START_PROXY_SERVER="Client.startProxyServer",e.STOP_PROXY_SERVER="Client.stopProxyServer",e.SET_PROXY_SERVER="Client.setProxyServer",e.SET_TURN_SERVER="Client.setTurnServer",e.SET_CLIENT_ROLE="Client.setClientRole",e.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",e.ENABLE_DUAL_STREAM="Client.enableDualStream",e.DISABLE_DUAL_STREAM="Client.disableDualStream",e.JOIN="Client.join",e.LEAVE="Client.leave",e.PUBLISH="Client.publish",e.UNPUBLISH="Client.unpublish",e.SUBSCRIBE="Client.subscribe",e.UNSUBSCRIBE="Client.unsubscribe",e.RENEW_TOKEN="Client.renewToken",e.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",e.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",e.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",e.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",e.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",e.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",e.START_LIVE_STREAMING="Client.startLiveStreaming",e.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",e.STOP_LIVE_STREAMING="Client.stopLiveStreaming",e.ADD_INJECT_STREAM_URL="Client.addInjectStreamUrl",e.REMOVE_INJECT_STREAM_URL="Client.removeInjectStreamUrl",e.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",e.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",e.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",e.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",e.SET_CONFIG_DISTRIBUTE="_configDistribute",e.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",e.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",e.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",e.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",e.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",e.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",e.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",e.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",e.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",e.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",e.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",e.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",e.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",e.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",e.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",e.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",e.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",e.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",e.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",e.STREAM_TYPE_CHANGE="streamTypeChange"}(jA||(jA={})),function(e){e.TRACER="tracer"}(GA||(GA={})),function(e){e.IDLE="IDLE",e.INITING="INITING",e.INITEND="INITEND"}(HA||(HA={})),function(e){e.STATE_CHANGE="state_change",e.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",e.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",e.CAMERA_DEVICE_CHANGED="cameraDeviceChanged"}(QA||(QA={})),function(e){e[e.ACCESS_POINT=101]="ACCESS_POINT",e[e.UNILBS=201]="UNILBS",e[e.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR"}(WA||(WA={})),function(e){e[e.IIIEGAL_APPID=1]="IIIEGAL_APPID",e[e.IIIEGAL_UID=2]="IIIEGAL_UID",e[e.INTERNAL_ERROR=3]="INTERNAL_ERROR"}(qA||(qA={})),function(e){e[e.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",e[e.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",e[e.INTERNAL_ERROR=8]="INTERNAL_ERROR",e[e.NO_AUTHORIZED=9]="NO_AUTHORIZED",e[e.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",e[e.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",e[e.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",e[e.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",e[e.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",e[e.USER_OVERLOAD=16]="USER_OVERLOAD",e[e.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",e[e.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND"}(zA||(zA={})),function(e){e[e.NO_FLAG_SET=100]="NO_FLAG_SET",e[e.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",e[e.INVALID_FALG_SET=102]="INVALID_FALG_SET",e[e.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",e[e.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",e[e.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",e[e.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",e[e.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",e[e.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",e[e.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",e[e.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",e[e.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",e[e.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",e[e.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",e[e.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",e[e.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",e[e.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV"}(ZA||(ZA={})),function(e){e[e.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",e[e.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",e[e.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",e[e.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",e[e.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",e[e.K_TICKET_INVALID=7]="K_TICKET_INVALID",e[e.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",e[e.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",e[e.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",e[e.K_UID_BANNED=14]="K_UID_BANNED",e[e.K_IP_BANNED=15]="K_IP_BANNED",e[e.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",e[e.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",e[e.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",e[e.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",e[e.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",e[e.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",e[e.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",e[e.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",e[e.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",e[e.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",e[e.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",e[e.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",e[e.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",e[e.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",e[e.ERR_INVALID_UID=117]="ERR_INVALID_UID",e[e.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",e[e.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",e[e.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",e[e.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",e[e.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",e[e.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",e[e.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",e[e.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",e[e.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",e[e.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",e[e.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",e[e.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",e[e.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",e[e.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",e[e.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",e[e.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",e[e.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",e[e.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",e[e.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",e[e.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",e[e.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",e[e.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",e[e.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",e[e.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",e[e.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",e[e.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",e[e.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",e[e.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",e[e.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY"}(YA||(YA={})),function(e){e.CONNECTING="connecting",e.CONNECTED="connected",e.RECONNECTING="reconnecting",e.CLOSED="closed"}(KA||(KA={})),function(e){e.WS_CONNECTED="ws_connected",e.WS_RECONNECTING="ws_reconnecting",e.WS_CLOSED="ws_closed",e.ON_BINARY_DATA="on_binary_data",e.REQUEST_RECOVER="request_recover",e.REQUEST_JOIN_INFO="request_join_info",e.REQUEST_REJOIN_INFO="req_rejoin_info",e.IS_P2P_DISCONNECTED="is_p2p_dis",e.DISCONNECT_P2P="dis_p2p",e.NEED_RENEW_SESSION="need-sid",e.REPORT_JOIN_GATEWAY="report_join_gateway",e.REQUEST_TIMEOUT="request_timeout",e.REQUEST_SUCCESS="request_success"}($A||($A={})),function(e){e.PING="ping",e.PING_BACK="ping_back",e.JOIN="join_v2",e.REJOIN="rejoin",e.LEAVE="leave",e.SET_CLIENT_ROLE="set_client_role",e.PUBLISH="publish",e.UNPUBLISH="unpublish",e.SUBSCRIBE="subscribe",e.UNSUBSCRIBE="unsubscribe",e.SUBSCRIBE_CHANGE="subscribe_change",e.TRAFFIC_STATS="traffic_stats",e.RENEW_TOKEN="renew_token",e.SWITCH_VIDEO_STREAM="switch_video_stream",e.SET_FALLBACK_OPTION="set_fallback_option",e.GATEWAY_INFO="gateway_info",e.CONTROL="control",e.SEND_METADATA="send_metadata",e.DATA_STREAM="data_stream",e.PICK_SVC_LAYER="pick_svc_layer"}(JA||(JA={})),function(e){e.PUBLISH_STATS="publish_stats",e.PUBLISH_RELATED_STATS="publish_related_stats",e.SUBSCRIBE_STATS="subscribe_stats",e.SUBSCRIBE_RELATED_STATS="subscribe_related_stats",e.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length"}(XA||(XA={})),function(e){e.ON_USER_ONLINE="on_user_online",e.ON_USER_OFFLINE="on_user_offline",e.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",e.ON_PUBLISH_STREAM="on_publish_stream",e.ON_UPLINK_STATS="on_uplink_stats",e.ON_P2P_LOST="on_p2p_lost",e.ON_REMOVE_STREAM="on_remove_stream",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",e.ON_USER_BANNED="on_user_banned",e.ON_NOTIFICATION="on_notification",e.ON_CRYPT_ERROR="on_crypt_error",e.MUTE_AUDIO="mute_audio",e.MUTE_VIDEO="mute_video",e.UNMUTE_AUDIO="unmute_audio",e.UNMUTE_VIDEO="unmute_video",e.RECEIVE_METADATA="receive_metadata",e.ON_DATA_STREAM="on_data_stream",e.ENABLE_LOCAL_VIDEO="enable_local_video",e.DISABLE_LOCAL_VIDEO="disable_local_video",e.ENABLE_LOCAL_AUDIO="enable_local_audio",e.DISABLE_LOCAL_AUDIO="disable_local_audio"}(ey||(ey={})),function(e){e.CONNECTION_STATE_CHANGE="CONNECTION_STATE_CHANGE",e.NEED_ANSWER="NEED_ANSWER",e.NEED_RENEGOTIATE="NEED_RENEGOTIATE",e.P2P_LOST="P2P_LOST",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NEED_UNPUB="NEED_UNPUB",e.NEED_UNSUB="NEED_UNSUB",e.NEED_UPLOAD="NEED_UPLOAD",e.NEED_CONTROL="NEED_CONTROL",e.START_RECONNECT="START_RECONNECT",e.END_RECONNECT="END_RECONNECT",e.NEED_SIGNAL_RTT="NEED_SIGNAL_RTT"}(ty||(ty={})),function(e){e.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",e.RECEIVE_TRACK_BUFFER="receive_track_buffer",e.ON_AUDIO_BUFFER="on_audio_buffer"}(ry||(ry={}));const iy={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,currentPacketLossRate:0},ny={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},oy={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},sy={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};var ay,cy,ly,uy,dy,hy,py,fy,gy,my,_y,vy,Ey,Ay;!function(e){e.CONNECTED="websocket:connected",e.RECONNECTING="websocket:reconnecting",e.WILL_RECONNECT="websocket:will_reconnect",e.CLOSED="websocket:closed",e.FAILED="websocket:failed",e.ON_MESSAGE="websocket:on_message",e.REQUEST_NEW_URLS="websocket:request_new_urls"}(ay||(ay={})),function(e){e.TRANSCODE="mix_streaming",e.RAW="raw_streaming",e.INJECT="inject_streaming"}(cy||(cy={})),function(e){e.WARNING="@live_uap-warning",e.ERROR="@line_uap-error",e.PUBLISH_STREAM_STATUS="@live_uap-publish-status",e.INJECT_STREAM_STATUS="@live_uap-inject-status",e.WORKER_STATUS="@live_uap-worker-status",e.REQUEST_NEW_ADDRESS="@live_uap-request-address"}(ly||(ly={})),function(e){e.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager"}(uy||(uy={})),function(e){e[e.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",e[e.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",e[e.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",e[e.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",e[e.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",e[e.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",e[e.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",e[e.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",e[e.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",e[e.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",e[e.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",e[e.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",e[e.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",e[e.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",e[e.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",e[e.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN"}(dy||(dy={})),function(e){e.UNEXPECTED_ERROR="UNEXPECTED_ERROR",e.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",e.TIMEOUT="TIMEOUT",e.INVALID_PARAMS="INVALID_PARAMS",e.NOT_READABLE="NOT_READABLE",e.NOT_SUPPORTED="NOT_SUPPORTED",e.INVALID_OPERATION="INVALID_OPERATION",e.OPERATION_ABORTED="OPERATION_ABORTED",e.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",e.NETWORK_ERROR="NETWORK_ERROR",e.NETWORK_TIMEOUT="NETWORK_TIMEOUT",e.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",e.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",e.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",e.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",e.ELECTRON_IS_NULL="ELECTRON_IS_NULL",e.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",e.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",e.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",e.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",e.PERMISSION_DENIED="PERMISSION_DENIED",e.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",e.TRACK_IS_DISABLED="TRACK_IS_DISABLED",e.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",e.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",e.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",e.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",e.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",e.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",e.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",e.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",e.UID_CONFLICT="UID_CONFLICT",e.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",e.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",e.INVALID_TRACK="INVALID_TRACK",e.SENDER_NOT_FOUND="SENDER_NOT_FOUND",e.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",e.SET_ANSWER_FAILED="SET_ANSWER_FAILED",e.ICE_FAILED="ICE_FAILED",e.PC_CLOSED="PC_CLOSED",e.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",e.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",e.CAN_NOT_PUBLISH_MULTIPLE_AUDIO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_AUDIO_TRACKS",e.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",e.INVALID_REMOTE_USER="INVALID_REMOTE_USER",e.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",e.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",e.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",e.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",e.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",e.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",e.WS_ABORT="WS_ABORT",e.WS_DISCONNECT="WS_DISCONNECT",e.WS_ERR="WS_ERR",e.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",e.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",e.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",e.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",e.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",e.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",e.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",e.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",e.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",e.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",e.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",e.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",e.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",e.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",e.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",e.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",e.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",e.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",e.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",e.INVALID_PLUGIN="INVALID_PLUGIN"}(hy||(hy={})),function(e){e.CONNECT_FAILED="connect failed",e.CONNECT_TIMEOUT="connect timeout",e.WS_DISCONNECTED="websocket disconnected",e.REQUEST_TIMEOUT="request timeout",e.REQUEST_FAILED="request failed",e.WAIT_STATUS_TIMEOUT="wait status timeout",e.WAIT_STATUS_ERROR="wait status error",e.BAD_STATE="bad state",e.WS_ABORT="ws abort",e.AP_REQUEST_TIMEOUT="AP request timeout",e.AP_JSON_PARSE_ERROR="AP json parse error",e.AP_REQUEST_ERROR="AP request error",e.AP_REQUEST_ABORT="AP request abort"}(py||(py={})),function(e){e[e.SetSdkProfile=0]="SetSdkProfile",e[e.SetSourceChannel=1]="SetSourceChannel",e[e.SetSourceUserId=2]="SetSourceUserId",e[e.SetDestChannel=3]="SetDestChannel",e[e.StartPacketTransfer=4]="StartPacketTransfer",e[e.StopPacketTransfer=5]="StopPacketTransfer",e[e.UpdateDestChannel=6]="UpdateDestChannel",e[e.Reconnect=7]="Reconnect",e[e.SetVideoProfile=8]="SetVideoProfile"}(fy||(fy={})),function(e){e.DISCONNECT="disconnect",e.CONNECTION_STATE_CHANGE="connection-state-change",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGE="stream-type-change",e.IS_P2P_DISCONNECTED="is-p2p-dis",e.DISCONNECT_P2P="dis-p2p",e.REQUEST_NEW_GATEWAY_LIST="req-gate-url",e.NEED_RENEW_SESSION="need-sid"}(gy||(gy={})),function(e){e.NEED_RENEGOTIATE="@need_renegotiate",e.NEED_REPLACE_TRACK="@need_replace_track",e.NEED_CLOSE="@need_close",e.NEED_ADD_TRACK="@need_add_track",e.NEED_REMOVE_TRACK="@need_remove_track",e.NEED_SESSION_ID="@need_sid",e.SET_OPTIMIZATION_MODE="@set_optimization_mode",e.GET_STATS="@get_stats",e.GET_LOW_VIDEO_TRACK="@get_low_video_track",e.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",e.SET_VIDEO_TRACK_MUTED="@set_video_track_muted",e.SET_AUDIO_TRACK_MUTED="@set_audio_track_muted"}(my||(my={})),function(e){e.SCREEN_TRACK="screen_track",e.LOW_STREAM="low_stream"}(_y||(_y={})),function(e){e.SOURCE_STATE_CHANGE="source-state-change",e.TRACK_ENDED="track-ended",e.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload"}(vy||(vy={})),function(e){e.FIRST_FRAME_DECODED="first-frame-decoded"}(Ey||(Ey={})),function(e){e.CHINA="CN",e.ASIA="AS",e.NORTH_AMERICA="NA",e.EUROPE="EU",e.JAPAN="JP",e.INDIA="IN",e.KOREA="KR",e.OCEANIA="OC",e.SOUTH_AMERICA="SA",e.AFRICA="AF",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL"}(Ay||(Ay={}));const yy={CHINA:{},ASIA:{CODE:Ay.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:Ay.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:Ay.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:Ay.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","\tuap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:Ay.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:Ay.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:Ay.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:Ay.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:Ay.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:Ay.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:Ay.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]}};var Sy,Cy,Ty;function by(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function Iy(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=by(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=by(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}function Ry(e={report:ky}){return function(t,r,i){const n=t[r];if("function"==typeof n){const o="AgoraRTCClient"===t.constructor.name?"Client":t.constructor.name;i.value=function(...t){var i;const s=e.report.reportApiInvoke(this._sessionId||null,{name:Je(i="".concat(o,".")).call(i,r),options:t,tag:GA.TRACER});try{const e=n.apply(this,t);return s.onSuccess(),e}catch(e){throw s.onError(e),e}}}return i}}function wy(e={report:ky}){return function(t,r,i){const n=t[r];if("function"==typeof n){const o="AgoraRTCClient"===t.constructor.name?"Client":t.constructor.name;i.value=async function(...t){var i;const s=e.report.reportApiInvoke(this._sessionId||null,{name:Je(i="".concat(o,".")).call(i,r),options:t,tag:GA.TRACER});try{const e=await n.apply(this,t);return s.onSuccess(),e}catch(e){throw s.onError(e),e}}}return i}}Oc&&(yy.CHINA={CODE:Ay.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]}),function(e){e.UPDATE_BITRATE_LIMIT="update_bitrate_limit"}(Sy||(Sy={})),function(e){e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(Cy||(Cy={})),function(e){e.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(Ty||(Ty={}));const ky=new class{constructor(){var e,t;this.baseInfoMap=new Mr,this.clientList=Yc,this.keyEventUploadPendingItems=[],this.normalEventUploadPendingItems=[],this.apiInvokeUploadPendingItems=[],this.apiInvokeCount=0,this.ltsList=[],this.lastSendNormalEventTime=Ma(),this.customReportCount=0,this.eventUploadTimer=window.setInterval($o(e=this.doSend).call(e,this),jc("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval($o(t=this.appendSessionId).call(t,this),jc("EVENT_REPORT_SEND_INTERVAL"))}reportApiInvoke(e,t,r){t.timeout=t.timeout||6e4,t.reportResult=void 0===t.reportResult||t.reportResult;const i=Ma();this.apiInvokeCount+=1;const n=this.apiInvokeCount,o=()=>({tag:t.tag,invokeId:n,sid:e,name:t.name,apiInvokeTime:i,options:t.options,states:t.states||null}),s=!!jc("SHOW_REPORT_INVOKER_LOG");s&&Rc.info("".concat(t.name," start"),t.options);let a=!1;Ip(t.timeout).then(()=>{a||(this.sendApiInvoke(Iy({},o(),{error:ll.API_INVOKE_TIMEOUT,success:!1})),Rc.debug("".concat(t.name," timeout")))});const c=new pl(ll.UNEXPECTED_ERROR,"".concat(t.name,": this api invoke is end"));return{onSuccess:e=>{const i=()=>{if(a)throw c;return a=!0,this.sendApiInvoke(Iy({},o(),{success:!0},t.reportResult&&{result:e})),s&&Rc.info("".concat(t.name," onSuccess")),e};return r?zp(i,t.name+"Success",r,()=>a=!0):i()},onError:e=>{const i=()=>{if(a)throw e;a=!0,this.sendApiInvoke(Iy({},o(),{success:!1,error:e.toString()})),s&&Rc.info("".concat(t.name," onFailure"),e.toString())};return r?zp(i,t.name+"Error",r,()=>a=!0):i()}}}sessionInit(e,t){if(this.baseInfoMap.has(e))return;const r=Ma(),i=this.createBaseInfo(e,r);i.cname=t.cname;const n=ri({},{willUploadConsoleLog:jc("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:Oc?"global":"oversea",areas:jc("AREAS")&&jc("AREAS").join(",")},t.extend),o=Ma(),s=Iy({},i,{eventType:UA.SESSION_INIT,appid:t.appid,browser:navigator.userAgent,build:wc,lts:o,elapse:o-r,extend:ve(n),mode:t.mode,process:jc("PROCESS_ID"),success:!0,version:kc});this.send({type:FA.SESSION,data:s},!0)}joinChooseServer(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,n=Ma(),o=Iy({},i,{eventType:UA.JOIN_CHOOSE_SERVER,lts:n,eventElapse:n-t.lts,chooseServerAddr:t.csAddr,errorCode:t.ec,elapse:n-r.startTime,success:t.succ,chooseServerAddrList:ve(t.serverList),uid:t.uid?Si(t.uid):null,cid:t.cid?Si(t.cid):null,chooseServerIp:t.csIp||"",opid:t.opid,unilbsServerIds:t.unilbsServerIds,extend:t.extend||void 0});this.send({type:FA.JOIN_CHOOSE_SERVER,data:o},!0)}reqUserAccount(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,n=Ma(),o=Iy({},i,{eventType:UA.REQ_USER_ACCOUNT,lts:n,success:t.success,serverAddress:t.serverAddr,stringUid:t.stringUid,uid:t.uid,errorCode:t.errorCode,elapse:n-r.startTime,eventElapse:n-t.lts,extend:ve(t.extend)});this.send({type:FA.REQ_USER_ACCOUNT,data:o},!0)}joinGateway(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info;t.vid&&(i.vid=t.vid),i.uid=t.uid,i.cid=t.cid;const n=Ma(),o=Iy({},i,{eventType:UA.JOIN_GATEWAY,lts:n,gatewayAddr:t.addr,success:t.succ,errorCode:t.ec,elapse:n-r.startTime,eventElapse:n-t.lts});t.succ&&(r.lastJoinSuccessTime=n),this.send({type:FA.JOIN_GATEWAT,data:o},!0)}joinChannelTimeout(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=Ma(),n=Iy({},r.info,{lts:i,timeout:t,elapse:i-r.startTime});this.send({type:FA.JOIN_CHANNEL_TIMEOUT,data:n},!0)}publish(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,n=Ma(),o=Iy({},i,{eventType:UA.PUBLISH,lts:n,eventElapse:n-t.lts,elapse:n-r.startTime,success:t.succ,errorCode:t.ec,videoName:t.videoName,audioName:t.audioName,screenName:t.screenName,screenshare:t.screenshare,audio:t.audio,video:t.video,p2pid:t.p2pid,publishRequestid:t.publishRequestid});this.send({type:FA.PUBLISH,data:o},!0)}subscribe(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,n=Ma(),o=Iy({},i,{eventType:UA.SUBSCRIBE,lts:n,eventElapse:n-t.lts,elapse:n-r.startTime,success:t.succ,errorCode:t.ec,video:t.video,audio:t.audio,subscribeRequestid:t.subscribeRequestid,p2pid:t.p2pid});"string"==typeof t.peerid?o.peerSuid=t.peerid:o.peer=t.peerid,this.send({type:FA.SUBSCRIBE,data:o},!0)}firstRemoteFrame(e,t,r,i){const n=this.baseInfoMap.get(e);if(!n)return;const o=n.info,s=Ma(),a=Iy({},o,{},i,{elapse:s-n.startTime,eventType:t,lts:s});this.send({type:r,data:a},!0)}onGatewayStream(e,t,r,i){const n=this.baseInfoMap.get(e);if(!n)return;const o=Iy({},n.info,{},i,{eventType:t,lts:Ma()});this.send({type:r,data:o},!0)}streamSwitch(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,n=Ma(),o=Iy({},i,{eventType:UA.STREAM_SWITCH,lts:n,isDual:t.isdual,elapse:n-r.startTime,success:t.succ});this.send({type:FA.STREAM_SWITCH,data:o},!0)}requestProxyAppCenter(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,n=Ma(),o=Iy({},i,{eventType:UA.REQUEST_PROXY_APPCENTER,lts:n,eventElapse:n-t.lts,elapse:n-r.startTime,APAddr:t.APAddr,workerManagerList:t.workerManagerList,response:t.response,errorCode:t.ec,success:t.succ});this.send({type:FA.REQUEST_PROXY_APPCENTER,data:o},!0)}requestProxyWorkerManager(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,n=Ma(),o=Iy({},i,{eventType:UA.REQUEST_PROXY_WORKER_MANAGER,lts:n,eventElapse:n-t.lts,elapse:n-r.startTime,workerManagerAddr:t.workerManagerAddr,response:t.response,errorCode:t.ec,success:t.succ});this.send({type:FA.REQUEST_PROXY_WORKER_MANAGER,data:o},!0)}setProxyServer(e){this.proxyServer=e,e?Rc.debug("reportProxyServerurl: ".concat(e)):Rc.debug("disable reportProxyServerurl: ".concat(e))}peerPublishStatus(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,n=Ma(),o=Iy({},i,{subscribeElapse:t.subscribeElapse,peer:t.peer,peerPublishDuration:Math.max(t.audioPublishDuration,t.videoPublishDuration),audiotag:t.audioPublishDuration>0?1:-1,videotag:t.videoPublishDuration>0?1:-1,lts:n,elapse:n-r.startTime,joinChannelSuccessElapse:n-(r.lastJoinSuccessTime||n)});this.send({type:FA.PEER_PUBLISH_STATUS,data:o},!0)}workerEvent(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,n=Ma(),o=bp(Iy({},i,{},t,{elapse:n-r.startTime,lts:n,productType:"WebRTC"}),"payload",1300);Jr(o).call(o,e=>this.send({type:FA.WORKER_EVENT,data:e},!0))}apworkerEvent(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,n=Ma(),o=Iy({},i,{},t,{elapse:n-r.startTime,lts:n});this.send({type:FA.AP_WORKER_EVENT,data:o},!0)}joinWebProxyAP(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,n=Ma(),o=Iy({},i,{},t,{elapse:n-r.startTime,lts:n,extend:t.extend||void 0});this.send({type:FA.JOIN_WEB_PROXY_AP,data:o},!0)}WebSocketQuit(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,n=Ma(),o=Iy({},i,{},t,{elapse:n-r.startTime,lts:n});this.send({type:FA.WEBSOCKET_QUIT,data:o},!0)}async sendCustomReportMessage(e,t){if(this.customReportCount+=t.length,this.customReportCount>jc("CUSTOM_REPORT_LIMIT"))throw new pl(ll.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval(()=>{this.customReportCount=0},5e3));const r=vo(t).call(t,t=>({type:FA.USER_ANALYTICS,data:Iy({sid:e},t)})),i={msgType:"EventMessages",sentTs:Math.round(Ma()/1e3),payloads:vo(r).call(r,e=>ve(e))};try{await this.postDataToStatsCollector(i)}catch(e){throw Rc.error("send custom report message failed",e.toString()),new pl(ll.CUSTOM_REPORT_SEND_FAILED,e.message)}}sendApiInvoke(e){const t=jc("NOT_REPORT_EVENT");if(e.tag&&is(t)&&is(t).call(t,e.tag))return!1;if(null===e.sid)return this.apiInvokeUploadPendingItems.push(e),!1;const r=this.baseInfoMap.get(e.sid);if(!r)return this.apiInvokeUploadPendingItems.push(e),!1;const{cname:i,uid:n,cid:o}=r.info;e.lts=e.lts||Ma();const s={invokeId:e.invokeId,sid:e.sid,cname:i,cid:o,uid:n,lts:e.lts,success:e.success,elapse:e.lts-r.startTime,execElapse:e.lts-e.apiInvokeTime,apiName:e.name,options:e.options?ve(e.options):void 0,execStates:e.states?ve(e.states):void 0,execResult:e.result?ve(e.result):void 0,errorCode:e.error?ve(e.error):void 0};return this.send({type:FA.API_INVOKE,data:s},!1),!0}appendSessionId(){var e;Jr(e=this.clientList).call(e,e=>{if(e._sessionId){const t=this.apiInvokeUploadPendingItems.length;for(let r=0;r<t;r++){const t=this.apiInvokeUploadPendingItems.shift();t&&(t.sid=e._sessionId,this.sendApiInvoke(ri({},t)))}}})}send(e,t){if(t)return this.keyEventUploadPendingItems.push(e),void this.sendItems(this.keyEventUploadPendingItems,!0);var r;this.normalEventUploadPendingItems.push(e),this.normalEventUploadPendingItems.length>jc("NORMAL_EVENT_QUEUE_CAPACITY")&&bo(r=this.normalEventUploadPendingItems).call(r,0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Ma()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(e,t){const r=[],i=[];for(;e.length;){const t=e.shift();r.length<20?r.push(t):i.push(t)}e.push(...i);for(const a of[...r]){var n,o;-1!==Lo(n=this.ltsList).call(n,a.data.lts)?(a.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(a.data.lts)):(this.ltsList.push(a.data.lts),cl(o=this.ltsList).call(o,(e,t)=>e-t))}t||(this.lastSendNormalEventTime=Ma());const s={msgType:"EventMessages",sentTs:Math.round(Ma()/1e3),payloads:vo(r).call(r,e=>ve(e)),vid:(e=>{const t=e&&e.data.sid&&this.baseInfoMap.get(e.data.sid);return t&&t.info.vid&&+t.info.vid||0})(r[0])};return r.length&&this.postDataToStatsCollector(s).catch((e=>r=>{var i,n,o;jc("EVENT_REPORT_RETRY")&&(t?this.keyEventUploadPendingItems=Je(i=this.keyEventUploadPendingItems).call(i,e):(this.normalEventUploadPendingItems=Je(n=this.normalEventUploadPendingItems).call(n,e),this.normalEventUploadPendingItems.length>jc("NORMAL_EVENT_QUEUE_CAPACITY")&&(bo(o=this.normalEventUploadPendingItems).call(o,0,this.normalEventUploadPendingItems.length-jc("NORMAL_EVENT_QUEUE_CAPACITY")),Rc.warning("report: drop normal events"))))})(r)),e}async postDataToStatsCollector(e,t=!1){var r,i,n;zd.networkState===Cy.OFFLINE&&await fo.race([zd.onlineWaiter,Ip(2*Zd.maxRetryTimeout)]);const o=t?"/events/proto-raws":"/events/messages";let s=this.url||(this.proxyServer?Je(r=Je(i="https://".concat(this.proxyServer,"/rs/?h=")).call(i,jc("EVENT_REPORT_DOMAIN"),"&p=6443&d=")).call(r,o):Je(n="https://".concat(jc("EVENT_REPORT_DOMAIN"),":6443")).call(n,o));for(let u=0;u<2;u+=1){var a,c,l;1===u&&(s=this.backupUrl||(this.proxyServer?Je(a=Je(c="https://".concat(this.proxyServer,"/rs/?h=")).call(c,jc("EVENT_REPORT_BACKUP_DOMAIN"),"&p=6443&d=")).call(a,o):Je(l="https://".concat(jc("EVENT_REPORT_BACKUP_DOMAIN"),":6443")).call(l,o)));try{t?await qd(s,{timeout:1e4,data:e}):await Wd(s,{timeout:1e4,data:e})}catch(e){if(1===u)throw e;continue}return}}createBaseInfo(e,t){const r=ri({},BA);return r.sid=e,this.baseInfoMap.set(e,{info:r,startTime:t}),r}};class Oy extends Mu{constructor(e){super(),this._connectionState=KA.CLOSED,this.openConnectionTime=Ma(),this.lastMsgTime=Ma(),this.uploadCache=[],this.rttRolling=new Qf(5),this.pingpongTimeoutCount=0,this.onWebsocketMessage=e=>{if(e.data instanceof ArrayBuffer)return void this.emit($A.ON_BINARY_DATA,e.data);const t=JSON.parse(e.data);if(this.lastMsgTime=Ma(),Object.prototype.hasOwnProperty.call(t,"_id")){const e="res-@".concat(t._id);this.emit(e,t._result,t._message)}else if(Object.prototype.hasOwnProperty.call(t,"_type")&&(this.emit(t._type,t._message),t._type===ey.ON_NOTIFICATION&&this.handleNotification(t._message),t._type===ey.ON_USER_BANNED))switch(t._message.error_code){case 14:this.close("UID_BANNED");break;case 15:this.close("IP_BANNED");break;case 16:this.close("CHANNEL_BANNED")}},this.clientId=e.clientId,this.spec=e,this.websocket=new Hf("gateway-".concat(this.clientId),this.spec.retryConfig,!0),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===KA.CONNECTED&&this.reconnect("retry",bA.OFFLINE)})}get connectionState(){return this._connectionState}set connectionState(e){e!==this._connectionState&&(this._connectionState=e,e===KA.CONNECTED?this.emit($A.WS_CONNECTED):e===KA.RECONNECTING?this.emit($A.WS_RECONNECTING,this._websocketReconnectReason):e===KA.CLOSED&&this.emit($A.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket?this.websocket.url:null}get rtt(){return this.rttRolling.mean()}async request(e,t,r,i){var n,o,s,a,c;const l=kp(6,""),u={_id:l,_type:e,_message:t},d=this.websocket.connectionID,h=()=>new fo((e,t)=>{if(this.connectionState===KA.CONNECTED)return e();const r=()=>{this.off($A.WS_CLOSED,i),e()},i=()=>{this.off($A.WS_CONNECTED,r),t(new pl(hy.WS_ABORT))};this.once($A.WS_CONNECTED,r),this.once($A.WS_CLOSED,i)});if(this.connectionState!==KA.CONNECTING&&this.connectionState!==KA.RECONNECTING||e===JA.JOIN||e===JA.REJOIN||await h(),this.websocket.sendMessage(u,!0),i)return;const p=new fo((r,i)=>{let n=!1;const o=(i,o)=>{n=!0,r({isSuccess:"success"===i,message:o||{}}),this.off($A.WS_CLOSED,s),this.off($A.WS_RECONNECTING,s),this.emit($A.REQUEST_SUCCESS,e,t)};this.once("res-@".concat(l),o);const s=()=>{i(new pl(hy.WS_ABORT,"type: ".concat(e))),this.off($A.WS_CLOSED,s),this.off($A.WS_RECONNECTING,s),this.off("res-@".concat(l),o)};this.once($A.WS_CLOSED,s),this.once($A.WS_RECONNECTING,s),Ip(jc("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==d||n||(Rc.warning("ws request timeout, type: ".concat(e)),this.emit($A.REQUEST_TIMEOUT,e,t))})});let f=null;try{f=await p}catch(i){if(this.connectionState===KA.CLOSED||e===JA.LEAVE)throw new pl(hy.WS_ABORT);return!this.spec.forceWaitGatewayResponse||r?i.throw():e===JA.JOIN||e===JA.REJOIN?null:(await h(),await this.request(e,t))}if(f.isSuccess)return f.message;const g=Number(f.message.error_code||f.message.code),m=rf(g),_=new pl(hy.UNEXPECTED_RESPONSE,Je(n="".concat(m.desc,": ")).call(n,f.message.error_str),{code:g,data:f.message});return"success"===m.action?f.message:(Rc.warning(Je(o=Je(s=Je(a=Je(c="[".concat(this.websocket.connectionID,"] unexpected response from type ")).call(c,e,", error_code: ")).call(a,g,", message: ")).call(s,m.desc,", action: ")).call(o,m.action)),"failed"===m.action?_.throw():"quit"===m.action?(this.initError=_,this.close(),_.throw()):(g===YA.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=f.message.option,Rc.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",bA.MULTI_IP)):this.reconnect(m.action,bA.SERVER_ERROR),e===JA.JOIN||e===JA.REJOIN?null:await this.request(e,t)))}waitMessage(e,t){return new fo(r=>{const i=n=>{(!t||t(n))&&(this.off(e,i),r(n))};this.on(e,i)})}upload(e,t){const r={_type:e,_message:t};try{this.websocket.sendMessage(r)}catch(e){const t=jc("MAX_UPLOAD_CACHE")||50;var i;this.uploadCache.push(r),this.uploadCache.length>t&&bo(i=this.uploadCache).call(i,0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{var e;if(this.connectionState!==KA.CONNECTED)return;const t=bo(e=this.uploadCache).call(e,0,1)[0];0===this.uploadCache.length&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(t._type,t._message)},jc("UPLOAD_CACHE_INTERVAL")||2e3))}}send(e,t){const r={_type:e,_message:t};this.websocket.sendMessage(r)}init(e){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,new fo((t,r)=>{this.once($A.WS_CONNECTED,()=>t(this.joinResponse)),this.once($A.WS_CLOSED,()=>r(this.initError||new pl(hy.WS_ABORT))),this.connectionState=KA.CONNECTING,this.websocket.init(e).catch(r),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4)})}close(e){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=e||"LEAVE",this.connectionState=KA.CLOSED,this.websocket.close()}async join(){var e;if(!this.joinResponse){const e=Bp(this,$A.REQUEST_JOIN_INFO),t=await this.request(JA.JOIN,e);if(!t)return this.emit($A.REPORT_JOIN_GATEWAY,hy.TIMEOUT,this.url||""),!1;this.joinResponse=t,this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=KA.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval($o(e=this.handlePingPong).call(e,this),3e3),!0}async rejoin(){var e,t;if(!this.reconnectToken)throw new pl(hy.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const r=Bp(this,$A.REQUEST_REJOIN_INFO);r.token=this.reconnectToken;const i=await this.request(JA.REJOIN,r);return!!i&&(this.connectionState=KA.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval($o(e=this.handlePingPong).call(e,this),3e3),i.peers&&Jr(t=i.peers).call(t,e=>{this.emit(ey.ON_USER_ONLINE,{uid:e.uid}),e.audio_mute?this.emit(ey.MUTE_AUDIO,{uid:e.uid}):this.emit(ey.UNMUTE_AUDIO,{uid:e.uid}),e.video_mute?this.emit(ey.MUTE_VIDEO,{uid:e.uid}):this.emit(ey.UNMUTE_VIDEO,{uid:e.uid}),e.audio_enable_local?this.emit(ey.ENABLE_LOCAL_AUDIO,{uid:e.uid}):this.emit(ey.DISABLE_LOCAL_AUDIO,{uid:e.uid}),e.video_enable_local?this.emit(ey.ENABLE_LOCAL_VIDEO,{uid:e.uid}):this.emit(ey.DISABLE_LOCAL_VIDEO,{uid:e.uid}),e.audio||e.video||this.emit(ey.ON_REMOVE_STREAM,{uid:e.uid,uint_id:e.uint_id}),e.audio&&this.emit(ey.ON_ADD_AUDIO_STREAM,{uid:e.uid,uint_id:e.uint_id,audio:!0}),e.video&&this.emit(ey.ON_ADD_VIDEO_STREAM,{uid:e.uid,uint_id:e.uint_id,video:!0})}),!0)}reconnect(e,t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(e,t)}handleNotification(e){Rc.debug("[".concat(this.clientId,"] receive notification: "),e);const t=rf(e.code);if("success"!==t.action){if("failed"!==t.action)return"quit"===t.action?("ERR_REPEAT_JOIN_CHANNEL"===t.desc&&this.close("UID_BANNED"),void this.close()):void this.reconnect(t.action,bA.SERVER_ERROR);Rc.error("[".concat(this.clientId,"] ignore error: "),t.desc)}}handlePingPong(){if(!this.websocket||"connected"!==this.websocket.state)return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const e=jc("PING_PONG_TIME_OUT"),t=Ma();this.pingpongTimeoutCount>=e&&(Rc.warning("PINGPONG Timeout. Last Socket Message: ".concat(t-this.lastMsgTime,"ms")),t-this.lastMsgTime>jc("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",bA.TIMEOUT):this.request(JA.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const e=Ma()-t;this.rttRolling.add(e),jc("REPORT_STATS")&&this.send(JA.PING_BACK,{pingpongElapse:e})}).catch(e=>{})}handleWsInflateData(){const{wsInflateLength:e,wsDeflateLength:t}=this.websocket.getWsInflateData();0!==e&&0!==t&&this.upload(XA.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:t,ws_inflate_length:e})}handleWebsocketEvents(){this.websocket.on(ay.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(ay.CLOSED,()=>{this.connectionState=KA.CLOSED}),this.websocket.on(ay.FAILED,()=>{this._disconnectedReason="NETWORK_ERROR",this.connectionState=KA.CLOSED}),this.websocket.on(ay.RECONNECTING,e=>{this._websocketReconnectReason=e,this.joinResponse=void 0,this.connectionState===KA.CONNECTED?this.connectionState=KA.RECONNECTING:this.connectionState=KA.CONNECTING}),this.websocket.on(ay.WILL_RECONNECT,(e,t)=>{if(Bp(this,$A.IS_P2P_DISCONNECTED)&&"retry"===e)return this.reconnectToken=void 0,this.emit($A.NEED_RENEW_SESSION),this.emit($A.DISCONNECT_P2P),t("tryNext");"retry"!==e&&(this.reconnectToken=void 0,this.emit($A.NEED_RENEW_SESSION),this.emit($A.DISCONNECT_P2P)),t(e)}),this.websocket.on(ay.CONNECTED,()=>{this.openConnectionTime=Ma(),this.reconnectToken?this.rejoin().catch(e=>{var t;Rc.warning(Je(t="[".concat(this.clientId,"] rejoin failed ")).call(t,e)),this.reconnect("tryNext",bA.SERVER_ERROR)}):this.join().catch(e=>{if(this.emit($A.REPORT_JOIN_GATEWAY,e.message||e.code,this.url||""),e instanceof pl&&e.code===hy.UNEXPECTED_RESPONSE&&e.data.code===YA.ERR_NO_AUTHORIZED)return Rc.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",bA.SERVER_ERROR);Rc.error("[".concat(this.clientId,"] join gateway request failed"),e.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",bA.SERVER_ERROR):(this.initError=e,this.close())})}),this.websocket.on(ay.REQUEST_NEW_URLS,(e,t)=>{Dp(this,$A.REQUEST_RECOVER,this.multiIpOption).then(e).catch(t)})}}var Ny,Ly;!function(e){e[e.CHOOSE_SERVER=11]="CHOOSE_SERVER",e[e.CLOUD_PROXY=18]="CLOUD_PROXY",e[e.CLOUD_PROXY_5=20]="CLOUD_PROXY_5"}(Ny||(Ny={}));class Py extends Mu{constructor(e,t){super(),this._hints=[],this._isClosed=!1,this._ID=t||kp(8,"track-"),this._originMediaStreamTrack=e,this._mediaStreamTrack=e,Xc(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(e){if(!e){const e=ky.reportApiInvoke(null,{name:jA.GET_MEDIA_STREAM_TRACK,options:[],tag:GA.TRACER});this._mediaStreamTrack&&"string"==typeof this._mediaStreamTrack.label?e.onSuccess(this._mediaStreamTrack.label):e.onSuccess("")}return this._mediaStreamTrack}close(){this._isClosed=!0,el(this)}}class Dy extends Py{constructor(e,t){super(e,t),this._enabled=!0,this._muted=!1,this._isClosed=!1,this._trackProcessors=[],this._handleTrackEnded=()=>{this.onTrackEnded()},this._enabledMutex=new ah("".concat(t)),e.addEventListener("ended",this._handleTrackEnded)}get muted(){return this._muted}get enabled(){return this._enabled}getTrackLabel(){return this._originMediaStreamTrack.label}close(){var e;this._isClosed||(this.stop(),Jr(e=this._trackProcessors).call(e,e=>e.destroy()),this._trackProcessors=[],this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,Rc.debug("[".concat(this.getTrackId(),"] close")),this.emit(vu.NEED_CLOSE),super.close())}async _registerTrackProcessor(e){var t;if(-1!==Lo(t=this._trackProcessors).call(t,e))return;const r=this._trackProcessors[this._trackProcessors.length-1];this._trackProcessors.push(e),e.onOutputChange=async()=>{const t=e.output||this._originMediaStreamTrack;this._mediaStreamTrack=t,this._updatePlayerSource(),await Mp(this,vu.NEED_REPLACE_TRACK,this._mediaStreamTrack)},r?(r.onOutputChange=async()=>{r.output&&await e.setInput(r.output)},await e.setInput(r.output||r.input||this._originMediaStreamTrack)):await e.setInput(this._originMediaStreamTrack)}_getOutputFromProcessors(){if(0===this._trackProcessors.length)return this._originMediaStreamTrack;const e=this._trackProcessors[this._trackProcessors.length-1];return e.output||e.input||this._originMediaStreamTrack}async _updateOriginMediaStreamTrack(e,t){if(e!==this._originMediaStreamTrack){if(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),t&&this._originMediaStreamTrack.stop(),e.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=e,this._trackProcessors.length>0){await this._trackProcessors[0].setInput(e);const t=this._getOutputFromProcessors();this._mediaStreamTrack=t}else this._mediaStreamTrack=this._originMediaStreamTrack;this._updatePlayerSource(),await Mp(this,vu.NEED_REPLACE_TRACK,this._mediaStreamTrack)}}_getDefaultPlayerConfig(){return{}}onTrackEnded(){Rc.debug("[".concat(this.getTrackId(),"] track ended")),this.emit(Au.TRACK_ENDED)}stateCheck(e,t){var r,i,n;if(Rc.debug(Je(r=Je(i=Je(n="check track state, [muted: ".concat(this._muted,", enabled: ")).call(n,this._enabled,"] to [")).call(i,e,": ")).call(r,t,"]")),"muted"===e&&!Fu().webAudioMediaStreamDest)throw new pl(ll.NOT_SUPPORTED,"current environment does not support set mute").print();if(fl(t,e),this._enabled&&this._muted&&"enabled"===e&&!1===t)throw new pl(ll.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print();if(!this._enabled&&!this._muted&&"muted"===e&&!0===t)throw new pl(ll.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print()}}function My(){return function(e,t,r){const i=e[t];"function"==typeof i&&(r.value=function(...e){this._isClosed&&new pl(ll.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning");const t=i.apply(this,e);return t instanceof fo?new fo((e,r)=>{t.then(e).catch(r)}):t})}}function xy(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function By(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=xy(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=xy(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}!function(e){e.IOS_15_INTERRUPTION_START="ios15-interruption-start",e.IOS_15_INTERRUPTION_END="ios15-interruption-end",e.IOS_INTERRUPTION_START="ios-interruption-start",e.IOS_INTERRUPTION_END="ios-interruption-end"}(Ly||(Ly={}));var Uy=function(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Bi(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&di(t,r,s),s},Fy=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class Vy extends Dy{constructor(e,t,r){super(e,r),this.trackMediaType="audio",this._enabled=!0,this._volume=100,this._useAudioElement=!1,this._bypassWebAudio=!1,this._encoderConfig=t,this._source=new Ah(e)}get isPlaying(){return this._useAudioElement?Mh.isPlaying(this.getTrackId()):this._source.isPlayed}setVolume(e){ml(e,"volume",0,1e3);const t=nh.reportApiInvoke(null,{tag:GA.TRACER,name:jA.LOCAL_AUDIO_TRACK_SET_VOLUME,options:[this.getTrackId(),e]},300);this._volume=e,this._source.setVolume(e/100),this._useAudioElement&&Mh.setVolume(this.getTrackId(),e);try{if(this._bypassWebAudio)return void Rc.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio."));const e=this._source.createOutputTrack();this._mediaStreamTrack!==e&&(this._mediaStreamTrack=e,Mp(this,my.NEED_REPLACE_TRACK,this._mediaStreamTrack).then(()=>{Rc.debug("[".concat(this.getTrackId(),"] replace web audio track success"))}).catch(e=>{Rc.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),e)}))}catch(e){}t.onSuccess()}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}async setPlaybackDevice(e){const t=nh.reportApiInvoke(null,{tag:GA.TRACER,name:jA.REMOTE_AUDIO_SET_OUTPUT_DEVICE,options:[this.getTrackId(),e]});if(!this._useAudioElement)throw new pl(ll.NOT_SUPPORTED,"your browser does not support setting the audio output device");try{await Mh.setSinkID(this.getTrackId(),e)}catch(e){throw t.onError(e),e}t.onSuccess()}async setEnabled(e,t,r){var i;if(!r){if(e===this._enabled)return;this.stateCheck("enabled",e)}Rc.info("[".concat(this.getTrackId(),"] start setEnabled"),e);const n=await this._enabledMutex.lock();if(!e){this._originMediaStreamTrack.enabled=!1;try{await Mp(this,my.NEED_REMOVE_TRACK,this)}catch(e){throw Rc.error("[".concat(this.getTrackId(),"] setEnabled to false error"),e.toString()),n(),e}return r||(this._enabled=!1),n()}this._originMediaStreamTrack.enabled=!0;try{await Mp(this,my.NEED_ADD_TRACK,this)}catch(e){throw Rc.error("[".concat(this.getTrackId(),"] setEnabled to true error"),e.toString()),n(),e}Rc.info(Je(i="[".concat(this.getTrackId(),"] setEnabled to ")).call(i,e," success")),r||(this._enabled=!0),n()}async setMuted(e){var t,r;if(this._bypassWebAudio)return Rc.debug(Je(r="[".concat(this.getTrackId(),"] setMuted:")).call(r,e," fallback to setEnabled because no pass through.")),void await this.setEnabled(!e);if(e!==this._muted){if(this.stateCheck("muted",e),this._muted=e,ma().name===RA.FIREFOX)return Rc.debug("[".concat(this.getTrackId(),"] firefox set mute fallback to set enabled")),void await this.setEnabled(!e,void 0,!0);this._mediaStreamTrack.enabled=!e,Rc.debug(Je(t="[".concat(this.getTrackId(),"] start set muted: ")).call(t,e)),await Mp(this,my.SET_AUDIO_TRACK_MUTED,{track:this,muted:e})}}getStats(){Hp(()=>{Rc.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning");const e=xp(this,my.GET_STATS);return e||By({},iy)}setAudioFrameCallback(e,t=4096){if(!e)return this._source.removeAllListeners(ry.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(t),this._source.removeAllListeners(ry.ON_AUDIO_BUFFER),this._source.on(ry.ON_AUDIO_BUFFER,t=>e(t))}play(){const e=nh.reportApiInvoke(null,{tag:GA.TRACER,name:jA.LOCAL_AUDIO_TRACK_PLAY,options:[this.getTrackId()]});Rc.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(Rc.debug("[".concat(this.getTrackId(),"] start audio playback in element")),Mh.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play(),e.onSuccess()}stop(){const e=nh.reportApiInvoke(null,{tag:GA.TRACER,name:jA.LOCAL_AUDIO_TRACK_STOP,options:[this.getTrackId()]});Rc.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?Mh.stop(this.getTrackId()):this._source.stop(),e.onSuccess()}close(){super.close(),this._source.destroy()}_updatePlayerSource(){Rc.debug("[".concat(this.getTrackId(),"] update player source track")),this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&Mh.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(e,t){this._originMediaStreamTrack!==e&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),e.addEventListener("ended",this._handleTrackEnded),t&&this._originMediaStreamTrack.stop(),this._originMediaStreamTrack=e,this._source.updateTrack(this._originMediaStreamTrack),this._mediaStreamTrack!==this._source.outputTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Mp(this,my.NEED_REPLACE_TRACK,this._mediaStreamTrack)))}renewMediaStreamTrack(){return fo.resolve(void 0)}}Uy([My(),Fy("design:type",Function),Fy("design:paramtypes",[String]),Fy("design:returntype",fo)],Vy.prototype,"setPlaybackDevice",null),Uy([My(),Fy("design:type",Function),Fy("design:paramtypes",[Boolean,Object,Boolean]),Fy("design:returntype",fo)],Vy.prototype,"setEnabled",null),Uy([My(),ih({report:nh}),Fy("design:type",Function),Fy("design:paramtypes",[Boolean]),Fy("design:returntype",fo)],Vy.prototype,"setMuted",null),Uy([My(),Fy("design:type",Function),Fy("design:paramtypes",[]),Fy("design:returntype",Object)],Vy.prototype,"getStats",null),Uy([My(),Fy("design:type",Function),Fy("design:paramtypes",[Object,Number]),Fy("design:returntype",void 0)],Vy.prototype,"setAudioFrameCallback",null),Uy([My(),Fy("design:type",Function),Fy("design:paramtypes",[]),Fy("design:returntype",void 0)],Vy.prototype,"play",null),Uy([My(),Fy("design:type",Function),Fy("design:paramtypes",[]),Fy("design:returntype",void 0)],Vy.prototype,"stop",null);class jy extends Vy{constructor(e,t,r,i){super(e,t.encoderConfig?Fc(t.encoderConfig):{},i),this._deviceName="default",this._enabled=!0,this._config=t,this._constraints=r,this._deviceName=e.label,"boolean"==typeof t.bypassWebAudio&&(this._bypassWebAudio=t.bypassWebAudio),wa()&&ph.bindInterruptDetectorTrack(this)}async setDevice(e){var t,r;const i=nh.reportApiInvoke(null,{tag:GA.TRACER,name:jA.MIC_AUDIO_TRACK_SET_DEVICE,options:[this.getTrackId(),e]});if(Rc.info(Je(t="[".concat(this.getTrackId(),"] start set device to ")).call(t,e)),this._enabled)try{const t=await Ph.getDeviceById(e),r={};r.audio=By({},this._constraints),r.audio.deviceId={exact:e},this._originMediaStreamTrack.stop();let i=null;try{i=await kh(r,this.getTrackId())}catch(e){throw Rc.error("[".concat(this.getTrackId(),"] setDevice failed"),e.toString()),i=await kh({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(i.getAudioTracks()[0],!1),e}await this._updateOriginMediaStreamTrack(i.getAudioTracks()[0],!1),this._deviceName=t.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(e){throw i.onError(e),Rc.error("[".concat(this.getTrackId(),"] setDevice error"),e.toString()),e}else try{const t=await Ph.getDeviceById(e);this._deviceName=t.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(e){throw i.onError(e),Rc.error("[".concat(this.getTrackId(),"] setDevice error"),e.toString()),e}i.onSuccess(),Rc.info(Je(r="[".concat(this.getTrackId(),"] set device to ")).call(r,e," success"))}async setEnabled(e,t,r){if(t)return Rc.debug("[".concat(this.getTrackId,"] setEnabled false (do not close microphone)")),await super.setEnabled(e);if(!r){if(e===this._enabled)return;this.stateCheck("enabled",e)}Rc.info("[".concat(this.getTrackId(),"] start setEnabled"),e);const i=await this._enabledMutex.lock();if(!e){this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),r||(this._enabled=!1);try{await Mp(this,my.NEED_REMOVE_TRACK,this)}catch(e){throw Rc.error("[".concat(this.getTrackId(),"] setEnabled false failed"),e.toString()),i(),e}return void i()}const n=By({},this._constraints),o=Ph.searchDeviceIdByName(this._deviceName);o&&!n.deviceId&&(n.deviceId=o);try{const e=await kh({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(e.getAudioTracks()[0],!1),await Mp(this,my.NEED_ADD_TRACK,this)}catch(e){throw i(),Rc.error("[".concat(this.getTrackId(),"] setEnabled true failed"),e.toString()),e}r||(this._enabled=!0),Rc.info("[".concat(this.getTrackId(),"] setEnabled success")),i()}close(){super.close(),wa()&&ph.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((Ra()||Na())&&this._enabled&&!this._isClosed&&ph.duringInterruption){const e=async()=>{ph.off(Ly.IOS_INTERRUPTION_END,e),this._enabled&&!this._isClosed&&(Rc.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};ph.on(Ly.IOS_INTERRUPTION_END,e)}else Rc.debug("[".concat(this.getTrackId(),"] track ended")),this.emit(vy.TRACK_ENDED)}async renewMediaStreamTrack(){const e=By({},this._constraints),t=Ph.searchDeviceIdByName(this._deviceName);t&&!e.deviceId&&(e.deviceId=t);const r=await kh({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(r.getAudioTracks()[0],!0)}}Uy([My(),Fy("design:type",Function),Fy("design:paramtypes",[String]),Fy("design:returntype",fo)],jy.prototype,"setDevice",null),Uy([My(),Fy("design:type",Function),Fy("design:paramtypes",[Boolean,Boolean,Boolean]),Fy("design:returntype",fo)],jy.prototype,"setEnabled",null);class Gy extends Vy{constructor(e,t,r,i){super(t.createOutputTrack(),r,i),this.source=e,this._bufferSource=t,this._bufferSource.on(ry.AUDIO_SOURCE_STATE_CHANGE,e=>{this.emit(vy.SOURCE_STATE_CHANGE,e)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch(e){}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(e){const t=nh.reportApiInvoke(null,{tag:GA.TRACER,name:jA.BUFFER_AUDIO_TRACK_START,options:[this.getTrackId(),e,this.duration]});e&&this._bufferSource.updateOptions(e),this._bufferSource.startProcessAudioBuffer(),t.onSuccess()}pauseProcessAudioBuffer(){const e=nh.reportApiInvoke(null,{tag:GA.TRACER,name:jA.BUFFER_AUDIO_TRACK_PAUSE,options:[this.getTrackId()]});this._bufferSource.pauseProcessAudioBuffer(),e.onSuccess()}seekAudioBuffer(e){const t=nh.reportApiInvoke(null,{tag:GA.TRACER,name:jA.BUFFER_AUDIO_TRACK_SEEK,options:[this.getTrackId()]});this._bufferSource.seekAudioBuffer(e),t.onSuccess()}resumeProcessAudioBuffer(){const e=nh.reportApiInvoke(null,{tag:GA.TRACER,name:jA.BUFFER_AUDIO_TRACK_RESUME,options:[this.getTrackId()]});this._bufferSource.resumeProcessAudioBuffer(),e.onSuccess()}stopProcessAudioBuffer(){const e=nh.reportApiInvoke(null,{tag:GA.TRACER,name:jA.BUFFER_AUDIO_TRACK_STOP,options:[this.getTrackId()]});this._bufferSource.stopProcessAudioBuffer(),e.onSuccess()}}Uy([My(),Fy("design:type",Function),Fy("design:paramtypes",[Object]),Fy("design:returntype",void 0)],Gy.prototype,"startProcessAudioBuffer",null),Uy([My(),Fy("design:type",Function),Fy("design:paramtypes",[]),Fy("design:returntype",void 0)],Gy.prototype,"pauseProcessAudioBuffer",null),Uy([My(),Fy("design:type",Function),Fy("design:paramtypes",[Number]),Fy("design:returntype",void 0)],Gy.prototype,"seekAudioBuffer",null),Uy([My(),Fy("design:type",Function),Fy("design:paramtypes",[]),Fy("design:returntype",void 0)],Gy.prototype,"resumeProcessAudioBuffer",null),Uy([My(),Fy("design:type",Function),Fy("design:paramtypes",[]),Fy("design:returntype",void 0)],Gy.prototype,"stopProcessAudioBuffer",null);class Hy extends Vy{constructor(){const e=gh().createMediaStreamDestination();super(e.stream.getAudioTracks()[0],void 0,kp(8,"track-mix-"));try{this._mediaStreamTrack=this._source.createOutputTrack()}catch(e){}this.destNode=e,this.trackList=[]}get isActive(){var e;return!(!this.trackList.length||!Qo(e=this.trackList).call(e,e=>!e.muted))}getSubTrackLabels(){var e;return vo(e=this.trackList).call(e,e=>e.getTrackLabel())}hasAudioTrack(e){var t;return-1!==Lo(t=this.trackList).call(t,e)}addAudioTrack(e){var t;-1===Lo(t=this.trackList).call(t,e)?(Rc.debug("add ".concat(e.getTrackId()," to mixing track")),e._source.outputNode.connect(this.destNode),this.trackList.push(e),this.updateEncoderConfig()):Rc.debug("track ".concat(e.getTrackId()," is already added"))}removeAudioTrack(e){var t;if(-1!==Lo(t=this.trackList).call(t,e)){Rc.debug("remove ".concat(e.getTrackId()," from mixing track"));try{e._source.outputNode.disconnect(this.destNode)}catch(e){}Up(this.trackList,e),this.updateEncoderConfig()}}updateEncoderConfig(){var e;const t={};Jr(e=this.trackList).call(e,e=>{e._encoderConfig&&((e._encoderConfig.bitrate||0)>(t.bitrate||0)&&(t.bitrate=e._encoderConfig.bitrate),(e._encoderConfig.sampleRate||0)>(t.sampleRate||0)&&(t.sampleRate=e._encoderConfig.sampleRate),(e._encoderConfig.sampleSize||0)>(t.sampleSize||0)&&(t.sampleSize=e._encoderConfig.sampleSize),e._encoderConfig.stereo&&(t.stereo=!0))}),this._encoderConfig=t}}class Qy extends Mu{constructor(){super(...arguments),this.resultStorage=new Mr}setLocalAudioStats(e,t,r){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",e,this.checkAudioInputLevel(r,t)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",e,this.checkSendAudioBitrate(r,t))}setLocalVideoStats(e,t,r){this.record("SEND_VIDEO_BITRATE_TOO_LOW",e,this.checkSendVideoBitrate(r,t)),this.record("FRAMERATE_INPUT_TOO_LOW",e,this.checkFramerateInput(r,t)),this.record("FRAMERATE_SENT_TOO_LOW",e,this.checkFramerateSent(r))}setRemoteAudioStats(e,t){const r=e.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",r,this.checkAudioOutputLevel(t))}setRemoteVideoStats(e,t){const r=e.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",r,this.checkVideoDecode(t))}record(e,t,r){this.resultStorage.has(e)||this.resultStorage.set(e,{result:[],isPrevNormal:!0});const i=this.resultStorage.get(e);if(i&&(i.result.push(r),i.result.length>=5)){var n;const r=is(n=i.result).call(n,!0);i.isPrevNormal&&!r&&this.emit("exception",Wy[e],e,t),!i.isPrevNormal&&r&&this.emit("exception",Wy[e]+2e3,e+"_RECOVER",t),i.isPrevNormal=r,i.result=[]}}checkAudioOutputLevel(e){return!(e.receiveBitrate>0&&0===e.receiveLevel)}checkAudioInputLevel(e,t){return t instanceof Hy&&!t.isActive||!!t.muted||0!==e.sendVolumeLevel}checkFramerateInput(e,t){let r=null;t._encoderConfig&&t._encoderConfig.frameRate&&(r=Xy(t._encoderConfig.frameRate));const i=e.captureFrameRate;return!r||!i||!(r>10&&i<5||r<10&&r>=5&&i<=1)}checkFramerateSent(e){return!(e.captureFrameRate&&e.sendFrameRate&&e.captureFrameRate>5&&e.sendFrameRate<=1)}checkSendVideoBitrate(e,t){return!!t.muted||0!==e.sendBitrate}checkSendAudioBitrate(e,t){return t instanceof Hy&&!t.isActive||!!t.muted||0!==e.sendBitrate}checkVideoDecode(e){return 0===e.receiveBitrate||0!==e.decodeFrameRate}}const Wy={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003};function qy(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function zy(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=qy(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=qy(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}class Zy{constructor(e){this.localConnectionsMap=new Mr,this.remoteConnectionsMap=new Mr,this.trafficStatsPeerList=[],this.updateStats=()=>{var e,t;Jr(e=this.remoteConnectionsMap).call(e,e=>{var t;const r=e.audioStats,i=e.videoStats,n=e.pcStats,o=zy({},tu),s=zy({},iu),a=zy({},ru),c=e.connection.pc.getStats(),l=c.audioRecv[0],u=c.videoRecv[0],d=n?n.videoRecv[0]:void 0,h=!0===e.connection.pc._statsFilter.videoIsReady,p=this.trafficStats&&Qo(t=this.trafficStats.peer_delay).call(t,t=>t.peer_uid===e.connection.getUserId());if(l){"opus"!==l.codec&&"aac"!==l.codec||(o.codecType=l.codec),l.outputLevel?o.receiveLevel=Math.round(32767*l.outputLevel):e.connection.user.audioTrack&&(o.receiveLevel=Math.round(32767*e.connection.user.audioTrack.getVolumeLevel())),o.receiveBytes=l.bytes,o.receivePackets=l.packets,o.receivePacketsLost=l.packetsLost,o.packetLossRate=o.receivePacketsLost/(o.receivePackets+o.receivePacketsLost),o.receiveBitrate=r?8*Math.max(0,o.receiveBytes-r.receiveBytes):0,o.totalDuration=r?r.totalDuration+1:1,o.totalFreezeTime=r?r.totalFreezeTime:0,o.freezeRate=o.totalFreezeTime/o.totalDuration,o.receiveDelay=l.jitterBufferMs;const t=e.connection.user.audioTrack;o.totalDuration>10&&Zy.isRemoteAudioFreeze(t)&&(o.totalFreezeTime+=1)}if(u){"H264"!==u.codec&&"VP8"!==u.codec&&"VP9"!==u.codec&&"AV1X"!==u.codec||(s.codecType=u.codec),s.receiveBytes=u.bytes,s.receiveBitrate=i?8*Math.max(0,s.receiveBytes-i.receiveBytes):0,s.decodeFrameRate=u.decodeFrameRate,s.renderFrameRate=u.decodeFrameRate,u.outputFrame&&(s.renderFrameRate=u.outputFrame.frameRate),u.receivedFrame?(s.receiveFrameRate=u.receivedFrame.frameRate,s.receiveResolutionHeight=u.receivedFrame.height,s.receiveResolutionWidth=u.receivedFrame.width):e.connection.user.videoTrack&&(s.receiveResolutionHeight=e.connection.user.videoTrack._videoHeight||0,s.receiveResolutionWidth=e.connection.user.videoTrack._videoWidth||0),void 0!==u.framesRateFirefox&&(s.receiveFrameRate=Math.round(u.framesRateFirefox)),s.receivePackets=u.packets,s.receivePacketsLost=u.packetsLost,s.packetLossRate=s.receivePacketsLost/(s.receivePackets+s.receivePacketsLost),s.totalDuration=i?i.totalDuration+1:1,s.totalFreezeTime=i?i.totalFreezeTime:0,s.receiveDelay=u.jitterBufferMs||0;const t=e.connection.user.videoTrack;e.connection.subscribeOptions.video&&h&&Zy.isRemoteVideoFreeze(t,u,d)&&(s.totalFreezeTime+=1),s.freezeRate=s.totalFreezeTime/s.totalDuration}p&&(o.end2EndDelay=p.B_ad,s.end2EndDelay=p.B_vd,o.transportDelay=p.B_ed,s.transportDelay=p.B_ed,o.currentPacketLossRate=p.B_ealr4/100,s.currentPacketLossRate=p.B_evlr4/100,a.uplinkNetworkQuality=p.B_punq?p.B_punq:0,a.downlinkNetworkQuality=p.B_pdnq?p.B_punq:0),e.audioStats=o,e.videoStats=s,e.pcStats=c,e.networkStats=a,e.connection.user.audioTrack&&this.exceptionMonitor.setRemoteAudioStats(e.connection.user.audioTrack,o),e.connection.user.videoTrack&&this.exceptionMonitor.setRemoteVideoStats(e.connection.user.videoTrack,s)}),Jr(t=this.localConnectionsMap).call(t,e=>{const t=e.audioStats,r=e.videoStats,i=zy({},Xl),n=zy({},eu),o=e.connection.pc.getStats(),s=o.audioSend[0],a=o.videoSend[0],c=e.connection.getUserId();s&&("opus"!==s.codec&&"aac"!==s.codec||(i.codecType=s.codec),s.inputLevel?i.sendVolumeLevel=Math.round(32767*s.inputLevel):e.connection.audioTrack&&(i.sendVolumeLevel=Math.round(32767*e.connection.audioTrack.getVolumeLevel())),i.sendBytes=s.bytes,i.sendPackets=s.packets,i.sendPacketsLost=s.packetsLost,i.sendBitrate=t?8*Math.max(0,i.sendBytes-t.sendBytes):0),a&&("H264"!==a.codec&&"VP8"!==a.codec&&"VP9"!==a.codec&&"AV1X"!==a.codec||(n.codecType=a.codec),n.sendBytes=a.bytes,n.sendBitrate=r?8*Math.max(0,n.sendBytes-r.sendBytes):0,a.inputFrame?(n.captureFrameRate=a.inputFrame.frameRate,n.captureResolutionHeight=a.inputFrame.height,n.captureResolutionWidth=a.inputFrame.width):e.connection.videoTrack&&(n.captureResolutionWidth=e.connection.videoTrack._videoWidth||0,n.captureResolutionHeight=e.connection.videoTrack._videoHeight||0),a.sentFrame?(n.sendFrameRate=a.sentFrame.frameRate,n.sendResolutionHeight=a.sentFrame.height,n.sendResolutionWidth=a.sentFrame.width):e.connection.videoTrack&&(n.sendResolutionWidth=e.connection.videoTrack._videoWidth||0,n.sendResolutionHeight=e.connection.videoTrack._videoHeight||0),a.avgEncodeMs&&(n.encodeDelay=a.avgEncodeMs),e.connection.videoTrack&&e.connection.videoTrack._encoderConfig&&e.connection.videoTrack._encoderConfig.bitrateMax&&(n.targetSendBitrate=1e3*e.connection.videoTrack._encoderConfig.bitrateMax),n.sendPackets=a.packets,n.sendPacketsLost=a.packetsLost,n.totalDuration=r?r.totalDuration+1:1,n.totalFreezeTime=r?r.totalFreezeTime:0,this.isLocalVideoFreeze(a)&&(n.totalFreezeTime+=1)),this.trafficStats&&(i.sendPacketsLost=this.trafficStats.B_palr4/100,n.sendPacketsLost=this.trafficStats.B_pvlr4/100),e.audioStats=i,e.videoStats=n,e.audioStats&&e.connection.audioTrack&&this.exceptionMonitor.setLocalAudioStats(c,e.connection.audioTrack,e.audioStats),e.videoStats&&e.connection.videoTrack&&this.exceptionMonitor.setLocalVideoStats(c,e.connection.videoTrack,e.videoStats)})},this.clientId=e,this.updateStatsInterval=window.setInterval(this.updateStats,1e3),this.exceptionMonitor=new Qy,this.exceptionMonitor.on("exception",(e,t,r)=>{this.onStatsException&&this.onStatsException(e,t,r)})}reset(){this.localConnectionsMap=new Mr,this.remoteConnectionsMap=new Mr,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(e){const t=this.localConnectionsMap.get(e);return t&&t.audioStats?t.audioStats:zy({},Xl)}getLocalVideoTrackStats(e){const t=this.localConnectionsMap.get(e);return t&&t.videoStats?t.videoStats:zy({},eu)}getRemoteAudioTrackStats(e){var t;const r=this.remoteConnectionsMap.get(e);if(!r||!r.audioStats)return zy({},tu);if(!this.trafficStats)return r.audioStats;const i=Qo(t=this.trafficStats.peer_delay).call(t,e=>e.peer_uid===r.connection.user.uid);return i&&(r.audioStats.publishDuration=i.B_ppad+(Ma()-this.trafficStats.timestamp)),r.audioStats}getRemoteNetworkQualityStats(e){const t=this.remoteConnectionsMap.get(e);return t&&t.networkStats?t.networkStats:zy({},ru)}getRemoteVideoTrackStats(e){var t;const r=this.remoteConnectionsMap.get(e);if(!r||!r.videoStats)return zy({},iu);if(!this.trafficStats)return r.videoStats;const i=Qo(t=this.trafficStats.peer_delay).call(t,e=>e.peer_uid===r.connection.user.uid);return i&&(r.videoStats.publishDuration=i.B_ppvd+(Ma()-this.trafficStats.timestamp)),r.videoStats}getRTCStats(){var e,t;let r=0,i=0,n=0,o=0;Jr(e=this.localConnectionsMap).call(e,e=>{e.audioStats&&(r+=e.audioStats.sendBytes,i+=e.audioStats.sendBitrate),e.videoStats&&(r+=e.videoStats.sendBytes,i+=e.videoStats.sendBitrate)}),Jr(t=this.remoteConnectionsMap).call(t,e=>{e.audioStats&&(n+=e.audioStats.receiveBytes,o+=e.audioStats.receiveBitrate),e.videoStats&&(n+=e.videoStats.receiveBytes,o+=e.videoStats.receiveBitrate)});let s=1;return this.trafficStats&&(s+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:s,SendBitrate:i,SendBytes:r,RecvBytes:n,RecvBitrate:o,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}removeConnection(e){this.localConnectionsMap.delete(e),this.remoteConnectionsMap.delete(e)}addLocalConnection(e){const t=e.connectionId;this.localConnectionsMap.has(t)||this.localConnectionsMap.set(t,{connection:e})}addRemoteConnection(e){const t=e.connectionId;this.remoteConnectionsMap.has(t)||this.remoteConnectionsMap.set(t,{connection:e})}updateTrafficStats(e){var t;const r=ji(t=e.peer_delay).call(t,e=>{var t;return-1===Lo(t=this.trafficStatsPeerList).call(t,e.peer_uid)});Jr(r).call(r,e=>{var t,r;const i=Qo(t=Bd(Jp(r=this.remoteConnectionsMap).call(r))).call(t,t=>t.connection._userId===e.peer_uid);void 0!==e.B_ppad&&void 0!==e.B_ppvd&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(e.peer_uid,e.B_ppad,e.B_ppvd,i?Ma()-i.connection.startTime:0),this.trafficStatsPeerList.push(e.peer_uid))}),this.trafficStats=e}updateUplinkStats(e){var t;this.uplinkStats&&this.uplinkStats.B_fir!==e.B_fir&&Rc.debug(Je(t="[".concat(this.clientId,"]: Period fir changes to ")).call(t,e.B_fir)),this.uplinkStats=e}static isRemoteVideoFreeze(e,t,r){if(!e)return!1;const i=!!r&&t.framesDecodeFreezeTime>r.framesDecodeFreezeTime,n=!r||t.framesDecodeCount>r.framesDecodeCount;return i||!n}static isRemoteAudioFreeze(e){return!!e&&e._isFreeze()}isLocalVideoFreeze(e){return!(!e.inputFrame||!e.sentFrame)&&e.inputFrame.frameRate>5&&e.sentFrame.frameRate<3}}function Yy(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function Ky(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=Yy(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=Yy(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}function $y(e){if(!e.address||!e.tcp)throw new pl(ll.UNEXPECTED_RESPONSE,"Invalid address format ".concat(e));return e.address.match(/^[\.\:\d]+$/)?"".concat(e.address.replace(/[^\d]/g,"-"),".edge.agora.io"):(Rc.info("Cannot recognized as IP address ".concat(e.address,". Used As Host instead")),Je(t="".concat(e.address,":")).call(t,e.tcp));var t}function Jy(e,t){var r;const i=jc("GATEWAY_DOMAINS");let n=i[1]&&-1!==Lo(t).call(t,i[1])?1:0;return e.addresses=e.addresses||[],{gatewayAddrs:vo(r=e.addresses).call(r,e=>{var t,r,o;return e.ip.match(/^[\.\:\d]+$/)?Je(t=Je(r="".concat(e.ip.replace(/[^\d]/g,"-"),".")).call(r,i[n++%i.length],":")).call(t,e.port):(Rc.info("Cannot recognized as IP address ".concat(e.ip,". Used As Host instead")),Je(o="".concat(e.ip,":")).call(o,e.port))}),uid:e.uid,cid:e.cid,vid:e.detail&&e.detail[8],uni_lbs_ip:e.detail&&e.detail[1],res:e,csIp:e.detail&&e.detail[502]}}function Xy(e){return"number"==typeof e?e:e.exact||e.ideal||e.max||e.min||0}function eS(e,t){const r=e.videoSend[0];if(!r)return null;const i=t&&t.videoSend[0]?t.videoSend[0].inputFrame:void 0,n={id:kp(10,""),timestamp:new Date(e.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:r.ssrc.toString()};return r.inputFrame&&(i&&r.inputFrame.height===i.height||(n.A_fhi=r.inputFrame.height?r.inputFrame.height.toString():"0"),i&&r.inputFrame.width===i.width||(n.A_fwi=r.inputFrame.width?r.inputFrame.width.toString():"0"),i&&r.inputFrame.frameRate===i.frameRate||(n.A_fri=r.inputFrame.frameRate?r.inputFrame.frameRate.toString():"0")),n}function tS(e){return e>=0&&e<.17?1:e>=.17&&e<.36?2:e>=.36&&e<.59?3:e>=.59&&e<=1?4:e>1?5:0}function rS(e,t){const r={};if(e.height&&e.width){const i=t._videoHeight||t.getMediaStreamTrack(!0).getSettings().height;r.scaleResolutionDownBy=i?i/Xy(e.height):4}return r.maxFramerate=e.framerate?Xy(e.framerate):void 0,r.maxBitrate=e.bitrate?1e3*e.bitrate:void 0,r}function iS(e,t){var r;let i,n,o=void 0;switch(t){case Ny.CHOOSE_SERVER:i=4096,n="choose server";break;case Ny.CLOUD_PROXY:i=1048576,n="proxy";break;case Ny.CLOUD_PROXY_5:i=4194304,n="proxy5";break;default:throw new pl(ll.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:e.detail&&e.detail[502],retry:!1})}if(Jr(r=e.response_body).call(r,t=>{var r;t.buffer&&t.buffer.flag===i&&(o={code:t.buffer.code,addresses:vo(r=t.buffer.edges_services).call(r,e=>Ky({},e,{ticket:t.buffer.cert})),server_ts:e.enter_ts,uid:t.buffer.uid,cid:t.buffer.cid,cname:t.buffer.cname,detail:Ky({},t.buffer.detail,{},e.detail),flag:t.buffer.flag,opid:e.opid})}),!o)throw new pl(ll.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(n," from multi unilbs response"),{csIp:e.detail&&e.detail[502]});return o}function nS(e){var t;return vo(t=e.addresses).call(t,e=>({address:e.ip,tcpport:e.port,udpport:e.port,username:Nc.username,password:Nc.password}))}function oS(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function sS(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=oS(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=oS(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}const aS=new Mr;class cS extends Mu{constructor(e){super(),this.inChannelInfo={joinAt:null,duration:0},this._state="DISCONNECTED",this.needToSendUnpubUnsub=new Mr,this.isSignalRecover=!1,this.hasChangeBGPAddress=!1,this.joinGatewayStartTime=0,this._signalTimeout=!1,this.clientId=e.clientId,this.spec=e,this.signal=new Oy(sS({},e,{retryConfig:e.websocketRetryConfig})),this._statsCollector=e.statsCollector,this.role=e.role||"audience",this._clientRoleOptions=e.clientRoleOptions,this.handleSignalEvents()}get state(){return this._state}set state(e){if(e===this._state)return;const t=this._state;this._state=e,"DISCONNECTED"===e&&this._disconnectedReason?this.emit(gy.CONNECTION_STATE_CHANGE,e,t,this._disconnectedReason):this.emit(gy.CONNECTION_STATE_CHANGE,e,t)}async join(e,t){var r,i;"disabled"!==e.cloudProxyServer&&(this.hasChangeBGPAddress=!0);const n=Ma();let o=aS.get(e.cname);if(o||(o=new Mr,aS.set(e.cname,o)),o.has(e.uid)){const t=new pl(ll.UID_CONFLICT);throw ky.joinGateway(e.sid,{lts:n,succ:!1,ec:t.message,addr:null,uid:e.uid,cid:e.cid}),t}o.set(e.uid,!0),this.joinInfo=e,this.key=t;const s=e.proxyServer?vo(r=e.gatewayAddrs).call(r,t=>{var r,i;const n=t.split(":");return Je(r=Je(i="wss://".concat(e.proxyServer,"/ws/?h=")).call(i,n[0],"&p=")).call(r,n[1])}):vo(i=e.gatewayAddrs).call(i,e=>"wss://".concat(e));let a=0;this.joinGatewayStartTime=n;try{a=(await this.signal.init(s)).uid}catch(t){throw Rc.error("[".concat(this.clientId,"] User join failed"),t.toString()),ky.joinGateway(e.sid,{lts:n,succ:!1,ec:t.message,addr:this.signal.url,uid:e.uid,cid:e.cid}),o.delete(e.uid),this.signal.close(),t}return this.state="CONNECTED",this.inChannelInfo.joinAt=Ma(),Rc.debug("[".concat(this.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval(()=>{this.updateTrafficStats().catch(e=>{Rc.warning("[".concat(this.clientId,"] get traffic stats error"),e.toString())})},3e3),this.networkQualityInterval=window.setInterval(()=>{navigator&&void 0!==navigator.onLine&&!navigator.onLine?this.emit(gy.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(gy.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):"CONNECTED"===this.state&&this._statsCollector.trafficStats?this.emit(gy.NETWORK_QUALITY,{uplinkNetworkQuality:tS(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:tS(this._statsCollector.trafficStats.B_dnq)}):this.emit(gy.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),a}async leave(e=!1){if("DISCONNECTED"!==this.state){this.state="DISCONNECTING";try{e||this.signal.connectionState!==KA.CONNECTED||await wp(this.signal.request(JA.LEAVE,void 0,!0),3e3)}catch(e){Rc.warning("[".concat(this.clientId,"] leave request failed, ignore"),e)}this.signal.close(),this.reset(),this.state="DISCONNECTED"}}async publish(e,t){if(!this.joinInfo)throw new pl(ll.UNEXPECTED_ERROR,"publish no joinInfo");const r=e.getUserId(),i=e.videoTrack?function(e){var t;const r=e._encoderConfig;if(!r)return{};const i={resolution:r.width&&r.height?Je(t="".concat(Xy(r.width),"x")).call(t,Xy(r.height)):void 0,maxVideoBW:r.bitrateMax,minVideoBW:r.bitrateMin};return"number"==typeof r.frameRate?(i.maxFrameRate=r.frameRate,i.minFrameRate=r.frameRate):r.frameRate&&(i.maxFrameRate=r.frameRate.max||r.frameRate.ideal||r.frameRate.exact||r.frameRate.min,i.minFrameRate=r.frameRate.min||r.frameRate.ideal||r.frameRate.exact||r.frameRate.max),i}(e.videoTrack):{};if(e.on(ty.NEED_ANSWER,(n,o,s)=>{var a;const c={state:"offer",stream_type:t,p2p_id:e.pc.ID,sdp:ve(n),audio:!!e.audioTrack,video:!!e.videoTrack,screen:e.videoTrack&&-1!==Lo(a=e.videoTrack._hints).call(a,Eu.SCREEN_TRACK),attributes:i,dtx:e.audioTrack instanceof jy&&e.audioTrack._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1,mode:this.spec.mode,codec:this.spec.codec,extend:jc("PUB_EXTEND")};if(e.audioTrack&&e.audioTrack instanceof Hy&&e.audioTrack){const t={stream_id:this.joinInfo&&(this.joinInfo.stringUid||this.joinInfo.uid),action:""};e.audioTrack.isActive?t.action="unmute_local_audio":t.action="mute_local_audio",this.sendControl(t)}if(e.videoTrack){const t={stream_id:this.joinInfo&&(this.joinInfo.stringUid||this.joinInfo.uid),action:""};e.videoTrack.muted?t.action="mute_local_video":t.action="unmute_local_video",this.sendControl(t)}this.signal.request(JA.PUBLISH,c,!0).then(e=>{r&&this.needToSendUnpubUnsub.set(r,!0),o(JSON.parse(e.sdp))}).catch(t=>{if(n.retry&&t.data&&t.data.code===YA.ERR_PUBLISH_REQUEST_INVALID)return Rc.warning("[".concat(this.clientId,"] receiver publish error code, retry"),t.toString()),Dp(e,ty.NEED_UNPUB).then(()=>{n.retry=!1,Dp(e,ty.NEED_ANSWER,n).then(o).catch(s)});t.code!==ll.WS_ABORT&&s(t)})}),e.on(ty.NEED_RENEGOTIATE,(r,i,n)=>{const o={state:"negotiation",stream_type:t,p2p_id:e.pc.ID,sdp:r};this.signal.request(JA.PUBLISH,o,!0).then(e=>{i(JSON.parse(e.sdp))}).catch(e=>{e.code!==ll.WS_ABORT&&n(e)})}),e.on(ty.NEED_UNPUB,i=>r&&!this.needToSendUnpubUnsub.has(r)?i(!1):"RECONNECTING"===this.state?i(!0):void this.signal.request(JA.UNPUBLISH,{stream_id:e.getUserId(),stream_type:t},!0).then(()=>i(!1)).catch(e=>{Rc.warning("unpublish warning: ",e),i(!0)})),e.on(ty.NEED_UPLOAD,(e,r)=>{this.signal.upload(e,{stream_type:t,stats:r})}),e.on(ty.NEED_SIGNAL_RTT,e=>{e(this.signal.rtt)}),e.on(ty.NEED_CONTROL,(e,t,r)=>{let i;if("video"===e.type&&e.muted)i="mute_local_video";else if("video"!==e.type||e.muted)if("audio"===e.type&&e.muted)i="mute_local_audio";else{if("audio"!==e.type||e.muted)return;i="unmute_local_audio"}else i="unmute_local_video";const n={stream_id:this.joinInfo&&(this.joinInfo.stringUid||this.joinInfo.uid),action:i};this.sendControl(n).then(t).catch(r)}),"RECONNECTING"!==this.state){if("CONNECTED"!==this.state)return new pl(ll.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state)).throw();await e.startP2PConnection()}else e.readyToReconnectPC()}async subscribe(e){if(!this.joinInfo)throw new pl(ll.UNEXPECTED_ERROR,"subscribe no joinInfo");const t=e.getUserId();if(e.on(ty.NEED_ANSWER,(r,i,n)=>{const o=e.subscribeOptions,s={stream_id:e.getUserId(),audio:!!o.audio,video:!!o.video,mode:this.spec.mode,codec:this.spec.codec,p2p_id:e.pc.ID,sdp:ve(r),tcc:!!jc("SUBSCRIBE_TCC"),extend:jc("SUB_EXTEND")};this.signal.request(JA.SUBSCRIBE,s,!0).then(e=>{this.needToSendUnpubUnsub.set(t,!0),i(JSON.parse(e.sdp))}).catch(t=>{if(r.retry&&t.data&&t.data.code===YA.ERR_SUBSCRIBE_REQUEST_INVALID)return Rc.warning("[".concat(this.clientId,"] receiver subscribe error code, retry"),t.toString()),Dp(e,ty.NEED_UNSUB).then(()=>{r.retry=!1,Dp(e,ty.NEED_ANSWER,r).then(i).catch(n)});t.code!==ll.WS_ABORT&&n(t)})}),e.on(ty.NEED_UNSUB,r=>this.needToSendUnpubUnsub.has(t)?"RECONNECTING"===this.state?r(!0):void this.signal.request(JA.UNSUBSCRIBE,{stream_id:e.getUserId()},!0).then(()=>r(!1)).catch(e=>{Rc.warning("unsubscribe warning",e),r(!0)}):r(!1)),e.on(ty.NEED_UPLOAD,(t,r)=>{this.signal.upload(t,{stream_id:e.getUserId(),stats:r})}),e.on(ty.NEED_SIGNAL_RTT,e=>{e(this.signal.rtt)}),"RECONNECTING"!==this.state){if("CONNECTED"!==this.state)return new pl(ll.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state)).throw();await e.startP2PConnection()}else e.readyToReconnectPC()}async subscribeChange(e,t){var r,i;if(!this.joinInfo)throw new pl(ll.UNEXPECTED_ERROR,"subscribe no joinInfo");if(await e.setSubscribeOptions(t),"RECONNECTING"!==this.state){if("CONNECTED"!==this.state)return new pl(ll.INVALID_OPERATION,"can not subscribe change when connection state is ".concat(this.state)).throw();Rc.debug(Je(r=Je(i="[".concat(this.clientId,"] send subscribe change, audio: ")).call(i,t.audio,", video: ")).call(r,t.video)),await this.signal.request(JA.SUBSCRIBE_CHANGE,{stream_id:e.getUserId(),audio:!!t.audio,video:!!t.video},!0)}}async sendControl(e){this.signal.request(JA.CONTROL,e,!0,!0)}async unsubscribe(e){await e.closeP2PConnection()}getGatewayInfo(){return this.signal.request(JA.GATEWAY_INFO)}renewToken(e){return this.signal.request(JA.RENEW_TOKEN,{token:e})}async setClientRole(e,t){if(t&&(this._clientRoleOptions=ri({},t)),"CONNECTED"!==this.state)return void(this.role=e);let r=void 0;r="audience"===e?this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:0,await this.signal.request(JA.SET_CLIENT_ROLE,{role:e,level:r}),this.role=e}async setRemoteVideoStreamType(e,t){await this.signal.request(JA.SWITCH_VIDEO_STREAM,{stream_id:e,stream_type:t})}async setStreamFallbackOption(e,t){await this.signal.request(JA.SET_FALLBACK_OPTION,{stream_id:e,fallback_type:t})}async pickSVCLayer(e,t){await this.signal.request(JA.PICK_SVC_LAYER,{stream_id:e,spatial_layer:t.spatialLayer,temporal_layer:t.temporalLayer})}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Ma()-this.inChannelInfo.joinAt),sS({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request(JA.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Ma()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const e=aS.get(this.joinInfo.cname);e&&e.delete(this.joinInfo.uid)}this.needToSendUnpubUnsub=new Mr,this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const e=function(e){const t=e.match(/(wss\:\/\/)?([^:]+):(\d+)/);return t?{username:Nc.username,password:Nc.password,turnServerURL:t[2],tcpport:Si(t[3])+30,udpport:Si(t[3])+30,forceturn:!1}:null}(("disabled"===this.joinInfo.cloudProxyServer?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex])||"");this.joinInfo.turnServer.serversFromGateway=[],e&&"off"!==this.joinInfo.turnServer.mode&&"disabled"===this.joinInfo.cloudProxyServer&&this.joinInfo.turnServer.serversFromGateway.push(sS({},Nc,{turnServerURL:e.turnServerURL,tcpport:e.tcpport,udpport:e.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){var e;if("CONNECTED"!==this.state)return;const t=await this.signal.request(JA.TRAFFIC_STATS,void 0,!0);t.timestamp=Ma(),Jr(e=t.peer_delay).call(e,e=>{var t;const r=this._statsCollector.trafficStats&&Qo(t=this._statsCollector.trafficStats.peer_delay).call(t,t=>t.peer_uid===e.peer_uid);r&&r.B_st!==e.B_st&&Vp(()=>{this.emit(gy.STREAM_TYPE_CHANGE,e.peer_uid,e.B_st)})}),this._statsCollector.updateTrafficStats(t)}getJoinMessage(){if(!this.joinInfo||!this.key)throw new pl(ll.UNEXPECTED_ERROR,"can not generate join message, no join info");const e=ri({},this.joinInfo.apResponse);let t=jc("REPORT_APP_SCENARIO");if("string"!=typeof t)try{t=ve(t)}catch(e){t=void 0}t&&t.length>128&&(t=void 0);const r={session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:kc,browser:navigator.userAgent,process_id:jc("PROCESS_ID"),mode:this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:e,extend:jc("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:"proxy3"===this.joinInfo.cloudProxyServer?"1":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:t};return this.joinInfo.stringUid&&(r.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(r.aes_mode=this.joinInfo.aesmode,jc("ENCRYPT_AES")?(r.aes_secret=this.joinInfo.aespassword,r.aes_encrypt=!0):r.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(r.aes_salt=this.joinInfo.aessalt)),e.addresses[this.signal.websocket.currentURLIndex]&&(r.ap_response.ticket=e.addresses[this.signal.websocket.currentURLIndex].ticket,delete e.addresses),r}getRejoinMessage(){if(!this.joinInfo)throw new pl(ll.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on($A.WS_RECONNECTING,e=>{this.joinInfo&&ky.WebSocketQuit(this.joinInfo.sid,{lts:Ma(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:e||bA.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",ky.sessionInit(this.joinInfo.sid,{lts:(new Date).getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode}),this.isSignalRecover=!1,this.joinGatewayStartTime=Ma())}),this.signal.on($A.WS_CLOSED,e=>{let t;switch(e){case"LEAVE":t=bA.LEAVE;break;case"UID_BANNED":case"IP_BANNED":case"CHANNEL_BANNED":case"SERVER_ERROR":t=bA.SERVER_ERROR;break;default:t=bA.NETWORK_ERROR}Rc.debug("[signal] websocket closed, reason: ".concat(t||"undefined -> "+bA.NETWORK_ERROR)),this.joinInfo&&ky.WebSocketQuit(this.joinInfo.sid,{lts:Ma(),succ:"LEAVE"===e?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:t}),this.reset(),this._disconnectedReason=e,this.state="DISCONNECTED"}),this.signal.on($A.WS_CONNECTED,()=>{var e,t,r;if((this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo)&&("audience"===this.role&&this._clientRoleOptions&&this._clientRoleOptions.level&&(Rc.debug(Je(e=Je(t=Je(r="[".concat(this.clientId,"] patch to send set client role, role: ")).call(r,this.role,", mode: ")).call(t,this.spec.mode,", level: ")).call(e,this._clientRoleOptions&&this._clientRoleOptions.level)),this.setClientRole(this.role,this._clientRoleOptions)),ky.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid}),this.joinInfo.useLocalAccessPoint)){const e=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);var i;if(!e)return void Rc.error(Je(i="[".concat(this.clientId,"] set local access point after joined failed: ")).call(i,e));Vc("EVENT_REPORT_DOMAIN",e[1]),Vc("EVENT_REPORT_BACKUP_DOMAIN",e[1]),Vc("LOG_UPLOAD_SERVER","".concat(e[1],":6444"))}}),this.signal.on(ey.ON_UPLINK_STATS,e=>{this._statsCollector.updateUplinkStats(e)}),this.signal.on($A.REQUEST_RECOVER,(e,t,r)=>{if(!this.joinInfo)return r(new pl(ll.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));e&&(this.joinInfo.multiIP=e,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,Dp(this,gy.REQUEST_NEW_GATEWAY_LIST).then(t).catch(r)}),this.signal.on($A.REQUEST_JOIN_INFO,e=>{e(this.getJoinMessage())}),this.signal.on($A.REQUEST_REJOIN_INFO,e=>{e(this.getRejoinMessage())}),this.signal.on($A.REPORT_JOIN_GATEWAY,(e,t)=>{this.joinInfo&&ky.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:e,addr:t,uid:this.joinInfo.uid,cid:this.joinInfo.cid})}),this.signal.on($A.IS_P2P_DISCONNECTED,e=>{e(Bp(this,gy.IS_P2P_DISCONNECTED))}),this.signal.on($A.DISCONNECT_P2P,()=>{this.needToSendUnpubUnsub=new Mr,this.emit(gy.DISCONNECT_P2P)}),this.signal.on($A.NEED_RENEW_SESSION,()=>{this.emit(gy.NEED_RENEW_SESSION)}),this.signal.on($A.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on($A.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0})}}function lS(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}let uS=1;function dS(e,t,r,i,n){uS+=1;const o={sid:r.sid,command:"convergeAllocateEdge",uid:"666",appId:r.appId,ts:Math.floor(Ma()/1e3),seq:uS,requestId:uS,version:kc,cname:r.cname},s={service_name:t,json_body:ve(o)};let a,c,l=e[0];return Kd(async()=>{a=Ma();const e=await Wd(l,{data:s,cancelToken:i,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(c=Ma()-a,0!==e.code){const t=new pl(ll.UNEXPECTED_RESPONSE,"live streaming ap error, code"+e.code,{retry:!0,responseTime:c});throw Rc.error(t.toString()),t}const r=JSON.parse(e.json_body);if(200!==r.code){var n;const e=new pl(ll.UNEXPECTED_RESPONSE,Je(n="live streaming app center error, code: ".concat(r.code,", reason: ")).call(n,r.reason),{code:r.code,responseTime:c});throw Rc.error(e.toString()),e}if(!r.servers||0===r.servers.length){const e=new pl(ll.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:r.code,responseTime:c});throw Rc.error(e.toString()),e}const o=function(e,t){var r;return{addressList:vo(r=e.servers).call(r,e=>{var r,i;return Je(r=Je(i="wss://".concat(e.address.replace(/\./g,"-"),".edge.agora.io:")).call(i,e.wss,"?serviceName=")).call(r,encodeURIComponent(t))}),workerToken:e.workerToken,vid:e.vid}}(r,t);return jc("LIVE_STREAMING_ADDRESS")&&(o.addressList=jc("LIVE_STREAMING_ADDRESS")instanceof Array?jc("LIVE_STREAMING_ADDRESS"):[jc("LIVE_STREAMING_ADDRESS")]),function(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=lS(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=lS(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}({},o,{responseTime:c})},(i,n)=>(ky.apworkerEvent(r.sid,{success:!0,sc:200,serviceName:t,responseDetail:ve(i.addressList),firstSuccess:0===n,responseTime:c,serverIp:e[n%e.length]}),!1),(i,n)=>(ky.apworkerEvent(r.sid,{success:!1,sc:i.data&&i.data.code||200,serviceName:t,responseTime:c,serverIp:e[n%e.length]}),!!(i.code!==ll.OPERATION_ABORTED&&i.code!==ll.UNEXPECTED_RESPONSE||i.data&&i.data.retry)&&(l=e[(n+1)%e.length],!0)),n)}function hS({url:e,areaCode:t},r,i,n){const o=Ma(),[s,a]=mS(r,t,[Ny.CHOOSE_SERVER]);let c=zd.networkState;return Kd(async()=>{c&&zd.networkState===Cy.OFFLINE&&zd.onlineWaiter&&await fo.race([zd.onlineWaiter,Ip(n&&n.maxRetryTimeout||Zd.maxRetryTimeout)]),c=zd.networkState;const t=await Wd(e,{data:s,cancelToken:i,headers:{"Content-Type":"multipart/form-data;"}},!0);fS(t,e,r,o,[Ny.CHOOSE_SERVER]);const a=iS(t,Ny.CHOOSE_SERVER);return gS(a),Jy(a,e)},t=>(t&&ky.joinChooseServer(r.sid,{lts:o,succ:!0,csAddr:e,opid:a,serverList:t.gatewayAddrs,ec:null,cid:t.cid.toString(),uid:t.uid.toString(),csIp:t.csIp,unilbsServerIds:[Ny.CHOOSE_SERVER].toString()}),!1),t=>t.code!==ll.OPERATION_ABORTED&&(t.code===ll.CAN_NOT_GET_GATEWAY_SERVER?t.data.retry:(ky.joinChooseServer(r.sid,{lts:o,succ:!1,csAddr:e,serverList:null,opid:a,ec:t.code,csIp:t.data&&t.data.csIp,unilbsServerIds:[Ny.CHOOSE_SERVER].toString(),extend:ve({networkState:c})}),Rc.warning("[".concat(r.clientId,"] Choose server network error, retry"),t),!0)),n)}function pS({url:e,areaCode:t,serviceIds:r},i,n,o){const s=Ma(),[a,c]=mS(i,t,r);let l=void 0;return Kd(async()=>{l&&zd.networkState===Cy.OFFLINE&&zd.onlineWaiter&&await fo.race([zd.onlineWaiter,Ip(o&&o.maxRetryTimeout||Zd.maxRetryTimeout)]),l=zd.networkState;const t=await Wd(e,{data:a,cancelToken:n,headers:{"Content-Type":"multipart/form-data;"}},!0);fS(t,e,i,s,r);const c=iS(t,Ny.CHOOSE_SERVER),u=iS(t,"proxy5"===i.cloudProxyServer?Ny.CLOUD_PROXY_5:Ny.CLOUD_PROXY);return gS(c),{gatewayInfo:Jy(c,e),proxyInfo:u,url:e}},t=>{var n;return t.gatewayInfo&&ky.joinChooseServer(i.sid,{lts:s,succ:!0,csAddr:e,serverList:t.gatewayInfo.gatewayAddrs,ec:null,opid:c,cid:t.gatewayInfo.cid.toString(),uid:t.gatewayInfo.uid.toString(),csIp:t.gatewayInfo.csIp,unilbsServerIds:r.toString()}),t.proxyInfo&&ky.joinWebProxyAP(i.sid,{lts:s,sucess:1,apServerAddr:e,turnServerAddrList:vo(n=t.proxyInfo.addresses).call(n,e=>e.ip).join(","),errorCode:null,eventType:i.cloudProxyServer,unilbsServerIds:r.toString()}),!1},t=>t.code!==ll.OPERATION_ABORTED&&(t.code===ll.CAN_NOT_GET_GATEWAY_SERVER?t.data.retry:(ky.joinWebProxyAP(i.sid,{lts:s,sucess:0,apServerAddr:e,turnServerAddrList:null,errorCode:t.code,eventType:i.cloudProxyServer,unilbsServerIds:r.toString(),extend:ve({networkState:l})}),Rc.warning("[".concat(i.clientId,"] multi unilbs network error, retry"),t),!0)),o)}const fS=(e,t,r,i,n)=>{var o,s,a;const c=[];if(Jr(o=e.response_body).call(o,o=>{const s=o.buffer.code;if(0!==s){const a=ef(s),l={error:new pl(ll.CAN_NOT_GET_GATEWAY_SERVER,a.desc,{retry:a.retry,csIp:e.detail[502]}),flag:o.buffer.flag};c.push(l),4096===l.flag?ky.joinChooseServer(r.sid,{lts:i,succ:!1,csAddr:t,opid:e.opid,serverList:null,ec:l.error.message,csIp:l.error.data&&l.error.data.csIp,unilbsServerIds:n.toString()}):1048576!==l.flag&&4194304!==l.flag||ky.joinWebProxyAP(r.sid,{lts:i,sucess:0,apServerAddr:t,turnServerAddrList:null,errorCode:l.error.code,eventType:r.cloudProxyServer,unilbsServerIds:n.toString()})}}),c.length)throw Rc.warning(Je(s=Je(a="[".concat(r.clientId,"] multi unilbs ")).call(a,t," failed, ")).call(s,vo(c).call(c,e=>{var t,r;return Je(t=Je(r="flag: ".concat(e.flag,", message: ")).call(r,e.error.message,", retry: ")).call(t,e.error.data.retry)}).join(" | "))),new pl(ll.CAN_NOT_GET_GATEWAY_SERVER,vo(c).call(c,e=>{var t;return Je(t="flag: ".concat(e.flag,", message: ")).call(t,e.error.message)}).join(" | "),{retry:!!Qo(c).call(c,e=>e.error.data.retry),csIp:e.detail[502]})},gS=e=>{if(e.addresses&&0===e.addresses.length&&0===e.code)throw new pl(ll.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:e.detail&&e.detail[502]});if(jc("GATEWAY_ADDRESS")&&jc("GATEWAY_ADDRESS").length>0){var t;Rc.debug("assign gateway address to",jc("GATEWAY_ADDRESS"));const r=vo(t=jc("GATEWAY_ADDRESS")).call(t,t=>({ip:t.ip,port:t.port,ticket:e.addresses[0]&&e.addresses[0].ticket}));e.addresses=r}},mS=(e,t,r)=>{var i;const n=Math.floor(Math.random()*10**12),o={appid:e.appId,client_ts:Ma(),opid:n,sid:e.sid,request_bodies:[{uri:22,buffer:{cname:e.cname,detail:{6:e.stringUid,11:t},key:e.token,service_ids:r,uid:e.uid||0}}]};Jr(i=o.request_bodies).call(i,t=>{e.multiIP&&e.multiIP.gateway_ip&&(t.buffer.detail[5]=ve({vocs_ip:[e.multiIP.uni_lbs_ip],vos_ip:[e.multiIP.gateway_ip]}))});const s=new FormData;return s.append("request",ve(o)),[s,n]};async function _S(e,t,r){const i=async function(e,t,r){var i,n;const o=vo(i=Uo(n=jc("WEBCS_DOMAIN")).call(n,0,jc("AJAX_REQUEST_CONCURRENT"))).call(i,t=>{var r;return{url:e.proxyServer?Je(r="https://".concat(e.proxyServer,"/ap/?url=")).call(r,t+"/api/v2/transpond/webrtc?v=2"):"https://".concat(t,"/api/v2/transpond/webrtc?v=2"),areaCode:g_()}});let s=null;const a=[],c=async()=>await Zp({fragementLength:jc("FRAGEMENT_LENGTH"),referenceList:o,asyncMapHandler:i=>(Rc.debug("[".concat(e.clientId,"] Connect to choose_server:"),i.url),hS(i,e,t,r)),allFailedhandler:e=>{throw e[0]},promisesCollector:a}),l=async()=>{var i;if(await Ip(1e3),null!==s)return s;const n=vo(i=jc("WEBCS_DOMAIN_BACKUP_LIST")).call(i,t=>{var r;return{url:e.proxyServer?Je(r="https://".concat(e.proxyServer,"/ap/?url=")).call(r,t+"/api/v2/transpond/webrtc?v=2"):"https://".concat(t,"/api/v2/transpond/webrtc?v=2"),areaCode:g_()}});return await Zp({fragementLength:jc("FRAGEMENT_LENGTH"),referenceList:n,asyncMapHandler:i=>(Rc.debug("[".concat(e.clientId,"] Connect to backup choose_server:"),i.url),hS(i,e,t,r)),allFailedhandler:e=>{throw e[0]},promisesCollector:a})};return s=await Pp([c(),l()]),a.length&&Jr(a).call(a,e=>e.cancel&&"function"==typeof e.cancel&&e.cancel()),s}(e,t,r);return{gatewayInfo:await i}}async function vS(e,t,r,i){var n,o;if("disabled"===e.cloudProxyServer)return i?await _S(e,t,r):void 0;let s;if("443only"===e.cloudProxyServer||"normal"===e.cloudProxyServer){var a;let n;i?"normal"!==e.cloudProxyServer?[n,s]=await fo.all([AS(e,t,r),_S(e,t,r)]):(n=await AS(e,t,r),e.proxyServer=n.addresses[0],ky.setProxyServer(e.proxyServer),Rc.setProxyServer(e.proxyServer),s=await _S(e,t,r)):(s=void 0,"normal"!==e.cloudProxyServer?n=await AS(e,t,r):(n=await AS(e,t,r),e.proxyServer=n.addresses[0],ky.setProxyServer(e.proxyServer),Rc.setProxyServer(e.proxyServer))),e.turnServer={mode:"manual",servers:vo(a=n.addresses).call(a,t=>({turnServerURL:t,tcpport:"proxy3"===e.cloudProxyServer?void 0:n.serverResponse.tcpport?n.serverResponse.tcpport:Nc.tcpport,udpport:"proxy4"===e.cloudProxyServer?void 0:n.serverResponse.udpport?n.serverResponse.udpport:Nc.udpport,username:n.serverResponse.username||Nc.username,password:n.serverResponse.password||Nc.password,forceturn:"proxy4"!==e.cloudProxyServer&&"proxy5"!==e.cloudProxyServer,security:"proxy5"===e.cloudProxyServer}))}}else{const{proxyInfo:i,gatewayInfo:n}=await async function(e,t,r){var i,n;const o=jc("PROXY_SERVER_TYPE3"),s=(e,t)=>{var r;let i=o;return hl(i)&&(i=t%2==0?o[1]:o[0]),Je(r="https://".concat(i,"/ap/?url=")).call(r,e)},a=vo(i=Uo(n=jc("WEBCS_DOMAIN")).call(n,0,jc("AJAX_REQUEST_CONCURRENT"))).call(i,(t,r)=>({url:s("".concat(t,"/api/v2/transpond/webrtc?v=2"),r),areaCode:g_(),serviceIds:[Ny.CHOOSE_SERVER,"proxy5"===e.cloudProxyServer?Ny.CLOUD_PROXY_5:Ny.CLOUD_PROXY]}));let c=null;const l=[],u=async()=>await Zp({fragementLength:jc("FRAGEMENT_LENGTH"),referenceList:a,asyncMapHandler:i=>(Rc.debug("[".concat(e.clientId,"] Connect to choose_server:"),i.url),pS(i,e,t,r)),allFailedhandler:e=>{throw e[0]},promisesCollector:l}),d=async()=>{var i;if(await Ip(1e3),null!==c)return c;const n=vo(i=jc("WEBCS_DOMAIN_BACKUP_LIST")).call(i,(e,t)=>({url:s("".concat(e,"/api/v2/transpond/webrtc?v=2"),t),areaCode:g_(),serviceIds:[11,18]}));return await Zp({fragementLength:jc("FRAGEMENT_LENGTH"),referenceList:n,asyncMapHandler:i=>(Rc.debug("[".concat(e.clientId,"] Connect to backup choose_server:"),i.url),pS(i,e,t,r)),allFailedhandler:e=>{throw e[0]},promisesCollector:l})},{gatewayInfo:h,proxyInfo:p,url:f}=await Pp([u(),d()]);if(l.length&&Jr(l).call(l,e=>e.cancel&&"function"==typeof e.cancel&&e.cancel()),!h||!p)throw new pl(ll.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(hl(o)&&f){const t=new i_(f).host;is(o).call(o,t)&&(e.proxyServer=t,Rc.setProxyServer(t),ky.setProxyServer(t))}return c={gatewayInfo:h,proxyInfo:nS(p)},c}(e,t,r);s={gatewayInfo:n},e.turnServer={mode:"manual",servers:vo(i).call(i,t=>({turnServerURL:t.address,tcpport:"proxy3"===e.cloudProxyServer?void 0:t.tcpport?t.tcpport:Nc.tcpport,udpport:"proxy4"===e.cloudProxyServer?void 0:t.udpport?t.udpport:Nc.udpport,username:t.username||Nc.username,password:t.password||Nc.password,forceturn:"proxy4"!==e.cloudProxyServer&&"proxy5"!==e.cloudProxyServer,security:"proxy5"===e.cloudProxyServer}))}}return Rc.debug(Je(n=Je(o="[".concat(e.clientId,"] set proxy server: ")).call(o,e.proxyServer,", mode: ")).call(n,e.cloudProxyServer)),s}async function ES(e,t,r,i){var n;const o=Uo(n=jc("ACCOUNT_REGISTER")).call(n,0,jc("AJAX_REQUEST_CONCURRENT"));let s=[];return s=t.proxyServer?vo(o).call(o,e=>{var r;return Je(r="https://".concat(t.proxyServer,"/ap/?url=")).call(r,e+"/api/v1")}):vo(o).call(o,e=>"https://".concat(e,"/api/v1")),(await async function(e,t,r,i,n){const o=Ma(),s={sid:r.sid,opid:10,appid:r.appId,string_uid:t};let a=e[0];const c=await Kd(()=>Wd(a+"".concat(-1===Lo(a).call(a,"?")?"?":"&","action=stringuid"),{data:s,cancelToken:i,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(r,i)=>{if(0===r.code){var n;if(r.uid<=0||r.uid>=Math.pow(2,32))throw Rc.error(Je(n="Invalid Uint Uid ".concat(t," => ")).call(n,r.uid),r),ky.reqUserAccount(s.sid,{lts:o,success:!1,serverAddr:a,stringUid:s.string_uid,uid:r.uid,errorCode:ll.INVALID_UINT_UID_FROM_STRING_UID,extend:s}),new pl(ll.INVALID_UINT_UID_FROM_STRING_UID);return ky.reqUserAccount(s.sid,{lts:o,success:!0,serverAddr:a,stringUid:s.string_uid,uid:r.uid,errorCode:null,extend:s}),!1}const c=ef(r.code);return c.retry&&(a=e[(i+1)%e.length]),ky.reqUserAccount(s.sid,{lts:o,success:!1,serverAddr:a,stringUid:s.string_uid,uid:r.uid,errorCode:c.desc,extend:s}),c.retry},(t,r)=>t.code!==ll.OPERATION_ABORTED&&(ky.reqUserAccount(s.sid,{lts:o,success:!1,serverAddr:a,stringUid:s.string_uid,uid:null,errorCode:t.code,extend:s}),a=e[(r+1)%e.length],!0),n);if(0!==c.code){const e=ef(c.code);throw new pl(ll.UNEXPECTED_RESPONSE,e.desc)}return c}(s,e,t,r,i)).uid}async function AS(e,t,r){var i,n;let o=Ma();const s=vo(i=jc("normal"===e.cloudProxyServer?"PROXY_CS":"WEBCS_DOMAIN")).call(i,t=>{var r;return e.proxyServer?Je(r="https://".concat(e.proxyServer,"/ap/?url=")).call(r,t+"/api/v1"):"https://".concat(t,"/api/v1")});if("proxy3"===e.cloudProxyServer||"proxy4"===e.cloudProxyServer||"proxy5"===e.cloudProxyServer){const i=vo(s).call(s,e=>({url:e,areaCode:g_()}));let n=null;n=await Zp({fragementLength:jc("FRAGEMENT_LENGTH"),referenceList:i,asyncMapHandler:i=>function({url:e,areaCode:t},r,i,n){const o=Ma(),s={opid:133,flag:"proxy5"===r.cloudProxyServer?4194304:1048576,ts:+new Date,key:r.token,cname:r.cname,sid:r.sid,detail:{6:r.stringUid,11:t},uid:r.uid||0};return Kd(async()=>await Wd(e,{data:s,cancelToken:i,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":69}}),t=>{var i;if(0===t.code)return ky.joinWebProxyAP(r.sid,{lts:o,sucess:1,apServerAddr:e,turnServerAddrList:vo(i=t.addresses).call(i,e=>e.ip).join(","),errorCode:null,eventType:r.cloudProxyServer}),!1;const n=ef(t.code);throw new pl(ll.CAN_NOT_GET_GATEWAY_SERVER,n.desc,{retry:n.retry})},t=>{return t.code!==ll.OPERATION_ABORTED&&(t.code===ll.CAN_NOT_GET_GATEWAY_SERVER?(ky.joinWebProxyAP(s.sid,{lts:o,sucess:0,apServerAddr:e,turnServerAddrList:null,errorCode:t.code,eventType:r.cloudProxyServer}),Rc.warning(Je(i=Je(n=Je(a="[".concat(r.clientId,"] proxy ap server ")).call(a,e," failed, message: ")).call(n,t.message,", retry: ")).call(i,t.data.retry)),t.data.retry):(ky.joinWebProxyAP(s.sid,{lts:o,sucess:0,apServerAddr:e,turnServerAddrList:null,errorCode:t.code,eventType:r.cloudProxyServer}),!0));var i,n,a},n)}(i,e,t,r),allFailedhandler:()=>{throw Rc.error("[".concat(e.clientId,"] can not get proxy server after trying several times")),new pl(ll.CAN_NOT_GET_PROXY_SERVER)}});const o=n.addresses;if(!o||0===o.length)throw Rc.error("[".concat(e.clientId,"] can not get proxy server, empty proxy server list")),new pl(ll.CAN_NOT_GET_PROXY_SERVER,"empty proxy server list");return{addresses:vo(o).call(o,e=>e.ip),serverResponse:{tcpport:o[0].port||443,udpport:o[0].port||Nc.udpport,username:Nc.username,password:Nc.password}}}let a=null;a=await Zp({fragementLength:jc("FRAGEMENT_LENGTH"),referenceList:s,asyncMapHandler:i=>function(e,t,r,i){const n=Ma(),o={command:"convergeAllocateEdge",sid:t.sid,appId:t.appId,token:t.token,uid:t.uid,cname:t.cname,ts:Math.floor(Ma()/1e3),version:kc,seq:0,requestId:1};return Kd(async()=>({res:await Wd(e,{data:{service_name:"webrtc_proxy",json_body:ve(o)},cancelToken:r,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}}),url:e}),e=>{if(!e.res.json_body)throw Rc.debug("[".concat(t.clientId,"] Get proxy server failed: no json_body")),new pl(ll.UNEXPECTED_RESPONSE,ve(e.res));const r=JSON.parse(e.res.json_body);var i,n;if(200!==r.code)throw Rc.debug(Je(i=Je(n="[".concat(t.clientId,"] Get proxy server failed: response code [")).call(n,r.code,"], reason [")).call(i,r.reason,"]")),new pl(ll.UNEXPECTED_RESPONSE,ve(e.res));return Rc.debug("[".concat(t.clientId,"] App return server length"),r.servers.length),!1},t=>t.code!==ll.OPERATION_ABORTED&&(ky.requestProxyAppCenter(o.sid,{lts:n,succ:!1,APAddr:e,workerManagerList:null,ec:t.code,response:t.message}),!0),i)}(i,e,t,r),allFailedhandler:()=>{throw Rc.error("[".concat(e.clientId,"] can not get proxy server after trying several times")),new pl(ll.CAN_NOT_GET_PROXY_SERVER)}});const c=JSON.parse(a.res.json_body),l=vo(n=c.servers).call(n,$y);if("443only"===e.cloudProxyServer)return{addresses:l,serverResponse:{tcpport:443,udpport:Nc.udpport,username:Nc.username,password:Nc.password}};ky.requestProxyAppCenter(e.sid,{lts:o,succ:!0,APAddr:a.url,workerManagerList:ve(l),ec:null,response:ve(a.res)}),o=Ma();const u=vo(l).call(l,i=>function(e,t,r,i){const n=Ma();let o=e;Is(e).call(e,"http")||(o="https://".concat(e,":4000/v2/machine"));const s={command:"request",gatewayType:"http",appId:t.appId,cname:t.cname,uid:(t.uid||"").toString(),sdkVersion:"2.3.1",sid:t.sid,seq:1,ts:Ma(),requestId:3,clientRequest:{appId:t.appId,cname:t.cname,uid:(t.uid||"").toString(),sid:t.sid}};return Kd(async()=>({res:await Wd(o,{data:s,cancelToken:r}),url:e}),e=>{if(!e.res.serverResponse)throw new pl(ll.UNEXPECTED_RESPONSE,"requeet worker manager server failed: serverResponse is undefined");return!1},t=>t.code!==ll.OPERATION_ABORTED&&(ky.requestProxyWorkerManager(s.sid,{lts:n,succ:!1,workerManagerAddr:e,ec:t.code,response:t.message}),!0),i)}(i,e,t,r));let d=null;try{d=await Pp(u)}catch(t){throw Rc.error("[".concat(e.clientId,"] can not get worker manager after trying several times")),new pl(ll.CAN_NOT_GET_PROXY_SERVER)}return Jr(u).call(u,e=>e.cancel()),ky.requestProxyWorkerManager(e.sid,{lts:o,succ:!0,workerManagerAddr:d.url,ec:null,response:ve(d.res)}),{addresses:[d.url],serverResponse:d.res.serverResponse}}async function yS(e,t,r,i){var n,o;const s=vo(n=Uo(o=jc("UAP_AP")).call(o,0,jc("AJAX_REQUEST_CONCURRENT"))).call(n,e=>{var r;return t.proxyServer?Je(r="https://".concat(t.proxyServer,"/ap/?url=")).call(r,e+"/api/v1?action=uap"):"https://".concat(e,"/api/v1?action=uap")});return await dS(s,e,t,r,i)}Q({target:"Number",stat:!0},{isNaN:function(e){return e!=e}});var SS=M.Number.isNaN,CS=zv;Q({target:"Object",stat:!0,sham:!a},{create:qt});var TS=M.Object,bS=function(e,t){return TS.create(e,t)};Q({target:"Object",stat:!0},{setPrototypeOf:ar});var IS=M.Object.setPrototypeOf,RS=i((function(e,t){!function(e){function t(e){if(hl(e))return vo(e).call(e,(function(e){return e}));if(!r(e))return e;var i={};for(var n in e)r(e[n])||hl(e[n])?i[n]=t(e[n]):i[n]=e[n];return i}function r(e){return!("object"!=typeof e||hl(e)||!e)}function i(){var e=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i);return e&&e[0]?Number(e[0].split("/")[1]):null}function n(e){return!!window.RTCStatsReport&&e.getStats()instanceof fo}var o=function(){function e(e){this.input=[],this.size=e}return e.prototype.add=function(e){var t;this.input.push(e),this.input.length>this.size&&bo(t=this.input).call(t,0,1)},e.prototype.diffMean=function(){return 0===this.input.length?0:(this.input[this.input.length-1]-this.input[0])/this.input.length},e}(),s=function(e,t){return(s=IS||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};
/*! *****************************************************************************
	    Copyright (c) Microsoft Corporation. All rights reserved.
	    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	    this file except in compliance with the License. You may obtain a copy of the
	    License at http://www.apache.org/licenses/LICENSE-2.0
	       THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	    MERCHANTABLITY OR NON-INFRINGEMENT.
	       See the Apache Version 2.0 License for specific language governing permissions
	    and limitations under the License.
	    ***************************************************************************** */function a(e,t){function r(){this.constructor=e}s(e,t),e.prototype=null===t?bS(t):(r.prototype=t.prototype,new r)}var c=function(){return(c=ri||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function l(e,t,r,i){return new(r||(r=fo))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(s,a)}c((i=i.apply(e,t||[])).next())}))}function u(e,t){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof nA&&(o[CS]=function(){return this}),o;function a(e){return function(t){return c([e,t])}}function c(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}var d,h={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[]},p={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0},f={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0},g={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0},m={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0},_=function(){function e(e,r){var i=this;this.videoIsReady=!1,this.stats=t(h),this.isFirstVideoReceived=!1,this.isFirstVideoDecoded=!1,this.isFirstAudioReceived=!1,this.isFirstAudioDecoded=!1,this.lossRateWindowStats=[],this.pc=e,this.options=r,this.intervalTimer=window.setInterval((function(){return l(i,void 0,void 0,(function(){return u(this,(function(e){return this.updateStats(),[2]}))}))}),this.options.updateInterval)}return e.prototype.getStats=function(){return this.stats},e.prototype.setVideoIsReady=function(e){this.videoIsReady=e},e.prototype.setIsFirstAudioDecoded=function(e){this.isFirstAudioDecoded=e},e.prototype.destroy=function(){window.clearInterval(this.intervalTimer),this.pc=void 0},e.prototype.calcLossRate=function(e){var t,r=this;this.lossRateWindowStats.push(e),this.lossRateWindowStats.length>this.options.lossRateInterval&&bo(t=this.lossRateWindowStats).call(t,0,1);for(var i=this.lossRateWindowStats.length,n=0,o=0,s=0,a=0,c=function(t){var c;Jr(c=e[t]).call(c,(function(e,c){if(r.lossRateWindowStats[i-1][t][c]&&r.lossRateWindowStats[0][t][c]){var l=r.lossRateWindowStats[i-1][t][c].packets-r.lossRateWindowStats[0][t][c].packets,u=r.lossRateWindowStats[i-1][t][c].packetsLost-r.lossRateWindowStats[0][t][c].packetsLost;"videoSend"===t||"audioSend"===t?(n+=l,s+=u):(o+=l,a+=u),SS(l)||SS(l)?e.packetLostRate=0:e.packetLostRate=l<=0||u<=0?0:u/(l+u)}}))},l=0,u=["videoSend","audioSend","videoRecv","audioRecv"];l<u.length;l++)c(u[l]);e.sendPacketLossRate=n<=0||s<=0?0:s/(n+s),e.recvPacketLossRate=o<=0||a<=0?0:a/(o+a)},e}(),v=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t._stats=h,t.lastDecodeVideoReceiverStats=new Mr,t}return a(r,e),r.prototype.updateStats=function(){return l(this,void 0,void 0,(function(){var e,r,i,n;return u(this,(function(o){switch(o.label){case 0:return[4,this._getStats()];case 1:return e=o.sent(),r=this.statsResponsesToObjects(e),this._stats=t(h),i=ji(r).call(r,(function(e){return"ssrc"===e.type})),this.processSSRCStats(i),(n=Qo(r).call(r,(function(e){return"VideoBwe"===e.type})))&&this.processBandwidthStats(n),this._stats.timestamp=Ma(),this.calcLossRate(this._stats),this.stats=this._stats,[2]}}))}))},r.prototype.processBandwidthStats=function(e){this._stats.bitrate={actualEncoded:Number(e.googActualEncBitrate),targetEncoded:Number(e.googTargetEncBitrate),retransmit:Number(e.googRetransmitBitrate),transmit:Number(e.googTransmitBitrate)},this._stats.sendBandwidth=Number(e.googAvailableSendBandwidth)},r.prototype.processSSRCStats=function(e){var r=this;Jr(e).call(e,(function(e){var i,n=is(i=e.id).call(i,"send");switch(e.mediaType+"_"+(n?"send":"recv")){case"video_send":var o=t(f);o.codec=e.googCodecName,o.adaptionChangeReason="none",e.googCpuLimitedResolution&&(o.adaptionChangeReason="cpu"),e.googBandwidthLimitedResolution&&(o.adaptionChangeReason="bandwidth"),o.avgEncodeMs=Number(e.googAvgEncodeMs),o.inputFrame={width:Number(e.googFrameWidthInput)||Number(e.googFrameWidthSent),height:Number(e.googFrameHeightInput)||Number(e.googFrameHeightSent),frameRate:Number(e.googFrameRateInput)},o.sentFrame={width:Number(e.googFrameWidthSent),height:Number(e.googFrameHeightSent),frameRate:Number(e.googFrameRateInput)},o.firsCount=Number(e.googFirReceived),o.nacksCount=Number(e.googNacksReceived),o.plisCount=Number(e.googPlisReceived),o.frameCount=Number(e.framesEncoded),o.bytes=Number(e.bytesSent),o.packets=Number(e.packetsSent),o.packetsLost=Number(e.packetsLost),o.ssrc=Number(e.ssrc),o.rttMs=Number(e.googRtt||0),r._stats.videoSend.push(o),r._stats.rtt=o.rttMs;break;case"video_recv":var s=t(p),a=r.lastDecodeVideoReceiverStats.get(Number(e.ssrc));if(s.codec=e.googCodecName,s.targetDelayMs=Number(e.googTargetDelayMs),s.renderDelayMs=Number(e.googRenderDelayMs),s.currentDelayMs=Number(e.googCurrentDelayMs),s.minPlayoutDelayMs=Number(e.googMinPlayoutDelayMs),s.decodeMs=Number(e.googDecodeMs),s.maxDecodeMs=Number(e.googMaxDecodeMs),s.receivedFrame={width:Number(e.googFrameWidthReceived),height:Number(e.googFrameHeightReceived),frameRate:Number(e.googFrameRateReceived)},s.decodedFrame={width:Number(e.googFrameWidthReceived),height:Number(e.googFrameHeightReceived),frameRate:Number(e.googFrameRateDecoded)},s.outputFrame={width:Number(e.googFrameWidthReceived),height:Number(e.googFrameHeightReceived),frameRate:Number(e.googFrameRateOutput)},s.jitterBufferMs=Number(e.googJitterBufferMs),s.firsCount=Number(e.googFirsSent),s.nacksCount=Number(e.googNacksSent),s.plisCount=Number(e.googPlisSent),s.framesDecodeCount=Number(e.framesDecoded),s.bytes=Number(e.bytesReceived),s.packets=Number(e.packetsReceived),s.packetsLost=Number(e.packetsLost),s.ssrc=Number(e.ssrc),s.packets>0&&!r.isFirstVideoReceived&&(r.onFirstVideoReceived&&r.onFirstVideoReceived(),r.isFirstVideoReceived=!0),s.framesDecodeCount>0&&!r.isFirstVideoDecoded&&(r.onFirstVideoDecoded&&r.onFirstVideoDecoded(s.decodedFrame.width,s.decodedFrame.height),r.isFirstVideoDecoded=!0),a){var l=a.stats,u=Ma()-a.lts;s.framesDecodeFreezeTime=l.framesDecodeFreezeTime,s.framesDecodeInterval=l.framesDecodeInterval,s.framesDecodeCount>l.framesDecodeCount&&r.isFirstVideoDecoded?(a.lts=Ma(),s.framesDecodeInterval=u,s.framesDecodeInterval>=r.options.freezeRateLimit&&(r.videoIsReady?s.framesDecodeFreezeTime+=s.framesDecodeInterval:r.setVideoIsReady(!0))):s.framesDecodeCount<a.stats.framesDecodeCount&&(s.framesDecodeInterval=0)}r.lastDecodeVideoReceiverStats.set(s.ssrc,{stats:c({},s),lts:Ma()}),r._stats.videoRecv.push(s);break;case"audio_recv":var d=t(m);d.codec=e.googCodecName,d.outputLevel=Math.abs(Number(e.audioOutputLevel))/32767,d.decodingCNG=Number(e.googDecodingCNG),d.decodingCTN=Number(e.googDecodingCTN),d.decodingCTSG=Number(e.googDecodingCTSG),d.decodingNormal=Number(e.googDecodingNormal),d.decodingPLC=Number(e.googDecodingPLC),d.decodingPLCCNG=Number(e.googDecodingPLCCNG),d.expandRate=Number(e.googExpandRate),d.accelerateRate=Number(e.googAccelerateRate),d.preemptiveExpandRate=Number(e.googPreemptiveExpandRate),d.secondaryDecodedRate=Number(e.googSecondaryDecodedRate),d.speechExpandRate=Number(e.googSpeechExpandRate),d.preferredJitterBufferMs=Number(e.googPreferredJitterBufferMs),d.jitterBufferMs=Number(e.googJitterBufferMs),d.jitterMs=Number(e.googJitterReceived),d.bytes=Number(e.bytesReceived),d.packets=Number(e.packetsReceived),d.packetsLost=Number(e.packetsLost),d.ssrc=Number(e.ssrc),d.receivedFrames=Number(e.googDecodingCTN)||Number(e.packetsReceived),d.droppedFrames=Number(e.googDecodingPLC)+Number(e.googDecodingPLCCNG)||Number(e.packetsLost),d.receivedFrames>0&&!r.isFirstAudioReceived&&(r.onFirstAudioReceived&&r.onFirstAudioReceived(),r.isFirstAudioReceived=!0),d.decodingNormal>0&&!r.isFirstAudioDecoded&&(r.onFirstAudioDecoded&&r.onFirstAudioDecoded(),r.isFirstAudioDecoded=!0),r._stats.audioRecv.push(d);break;case"audio_send":var h=t(g);h.codec=e.googCodecName,h.inputLevel=Math.abs(Number(e.audioInputLevel))/32767,h.aecReturnLoss=Number(e.googEchoCancellationReturnLoss||0),h.aecReturnLossEnhancement=Number(e.googEchoCancellationReturnLossEnhancement||0),h.residualEchoLikelihood=Number(e.googResidualEchoLikelihood||0),h.residualEchoLikelihoodRecentMax=Number(e.googResidualEchoLikelihoodRecentMax||0),h.bytes=Number(e.bytesSent),h.packets=Number(e.packetsSent),h.packetsLost=Number(e.packetsLost),h.ssrc=Number(e.ssrc),h.rttMs=Number(e.googRtt||0),r._stats.rtt=h.rttMs,r._stats.audioSend.push(h)}}))},r.prototype._getStats=function(){var e=this;return new fo((function(t,r){e.pc.getStats(t,r)}))},r.prototype.statsResponsesToObjects=function(e){var t=[],r=e.result();return Jr(r).call(r,(function(e){var r,i={id:e.id,timestamp:e.timestamp.valueOf().toString(),type:e.type};Jr(r=e.names()).call(r,(function(t){i[t]=e.stat(t)})),t.push(i)})),t},r}(_);!function(e){e.CERTIFICATE="certificate",e.CODEC="codec",e.CANDIDATE_PAIR="candidate-pair",e.LOCAL_CANDIDATE="local-candidate",e.REMOTE_CANDIDATE="remote-candidate",e.INBOUND="inbound-rtp",e.TRACK="track",e.OUTBOUND="outbound-rtp",e.PC="peer-connection",e.REMOTE_INBOUND="remote-inbound-rtp",e.REMOTE_OUTBOUND="remote-outbound-rtp",e.TRANSPORT="transport",e.CSRC="csrc",e.DATA_CHANNEL="data-channel",e.STREAM="stream",e.SENDER="sender",e.RECEIVER="receiver"}(d||(d={}));var E=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t._stats=h,t.lastDecodeVideoReceiverStats=new Mr,t.lastVideoFramesRecv=new Mr,t.lastVideoFramesSent=new Mr,t.lastVideoFramesDecode=new Mr,t.lastVideoJBDelay=new Mr,t.lastAudioJBDelay=new Mr,t.mediaBytesSent=new Mr,t.mediaBytesRetransmit=new Mr,t.mediaBytesTargetEncode=new Mr,t.lastEncoderMs=new Mr,t}return a(r,e),r.prototype.updateStats=function(){return l(this,void 0,void 0,(function(){var e,r=this;return u(this,(function(i){var n;switch(i.label){case 0:return e=this,[4,this.pc.getStats()];case 1:return e.report=i.sent(),this._stats=t(h),Jr(n=this.report).call(n,(function(e){switch(e.type){case d.OUTBOUND:"audio"===e.mediaType?r.processAudioOutboundStats(e):"video"===e.mediaType&&r.processVideoOutboundStats(e);break;case d.INBOUND:"audio"===e.mediaType?r.processAudioInboundStats(e):"video"===e.mediaType&&r.processVideoInboundStats(e);break;case d.TRANSPORT:var t=r.report.get(e.selectedCandidatePairId);t&&r.processCandidatePairStats(t);break;case d.CANDIDATE_PAIR:e.selected&&r.processCandidatePairStats(e)}})),this.updateSendBitrate(),this._stats.timestamp=Ma(),this.calcLossRate(this._stats),this.stats=this._stats,[2]}}))}))},r.prototype.processCandidatePairStats=function(e){var t,r;this._stats.sendBandwidth=e.availableOutgoingBitrate||0,e.currentRoundTripTime&&(this._stats.rtt=1e3*e.currentRoundTripTime),Jr(t=this._stats.videoSend).call(t,(function(t){!t.rttMs&&e.currentRoundTripTime&&(t.rttMs=1e3*e.currentRoundTripTime)})),Jr(r=this._stats.audioSend).call(r,(function(t){!t.rttMs&&e.currentRoundTripTime&&(t.rttMs=1e3*e.currentRoundTripTime)}))},r.prototype.processAudioInboundStats=function(e){var r,i=Qo(r=this._stats.audioRecv).call(r,(function(t){return t.ssrc===e.ssrc}));i||(i=t(m),this._stats.audioRecv.push(i)),i.ssrc=e.ssrc,i.packets=e.packetsReceived,i.packetsLost=e.packetsLost,i.bytes=e.bytesReceived,i.jitterMs=1e3*e.jitter,e.trackId&&this.processAudioTrackReceiverStats(e.trackId,i),e.codecId&&(i.codec=this.getCodecFromCodecStats(e.codecId)),i.receivedFrames||(i.receivedFrames=e.packetsReceived),i.droppedFrames||(i.droppedFrames=e.packetsLost),i.receivedFrames>0&&!this.isFirstAudioReceived&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(),this.isFirstAudioReceived=!0),i.outputLevel&&i.outputLevel>0&&!this.isFirstAudioDecoded&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(),this.isFirstAudioDecoded=!0)},r.prototype.processVideoInboundStats=function(e){var r,i=Qo(r=this._stats.videoRecv).call(r,(function(t){return t.ssrc===e.ssrc}));i||(i=t(p),this._stats.videoRecv.push(i)),i.ssrc=e.ssrc,i.packets=e.packetsReceived,i.packetsLost=e.packetsLost,i.bytes=e.bytesReceived,i.firsCount=e.firCount,i.nacksCount=e.nackCount,i.plisCount=e.pliCount,i.framesDecodeCount=e.framesDecoded;var n=this.lastDecodeVideoReceiverStats.get(i.ssrc),o=this.lastVideoFramesDecode.get(i.ssrc),s=Ma();if(i.framesDecodeCount>0&&!this.isFirstVideoDecoded){var a=i.decodedFrame?i.decodedFrame.width:0,l=i.decodedFrame?i.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(a,l),this.isFirstVideoDecoded=!0}if(n){var u=n.stats,d=s-n.lts;i.framesDecodeFreezeTime=u.framesDecodeFreezeTime,i.framesDecodeInterval=u.framesDecodeInterval,i.framesDecodeCount>u.framesDecodeCount&&this.isFirstVideoDecoded?(n.lts=Ma(),i.framesDecodeInterval=d,i.framesDecodeInterval>=this.options.freezeRateLimit&&(this.videoIsReady?i.framesDecodeFreezeTime+=i.framesDecodeInterval:this.setVideoIsReady(!0))):i.framesDecodeCount<u.framesDecodeCount&&(i.framesDecodeInterval=0)}o&&s-o.lts>=800?(i.decodeFrameRate=Math.round((i.framesDecodeCount-o.count)/((s-o.lts)/1e3)),this.lastVideoFramesDecode.set(i.ssrc,{count:i.framesDecodeCount,lts:s,rate:i.decodeFrameRate})):o?i.decodeFrameRate=o.rate:this.lastVideoFramesDecode.set(i.ssrc,{count:i.framesDecodeCount,lts:s,rate:0}),e.totalDecodeTime&&(i.decodeMs=1e3*e.totalDecodeTime),e.trackId&&this.processVideoTrackReceiverStats(e.trackId,i),e.codecId&&(i.codec=this.getCodecFromCodecStats(e.codecId)),e.framerateMean&&(i.framesRateFirefox=e.framerateMean),i.packets>0&&!this.isFirstVideoReceived&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(),this.isFirstVideoReceived=!0),this.lastDecodeVideoReceiverStats.set(i.ssrc,{stats:c({},i),lts:n?n.lts:Ma()})},r.prototype.processVideoOutboundStats=function(e){var r,i=Qo(r=this._stats.videoSend).call(r,(function(t){return t.ssrc===e.ssrc}));i||(i=t(f),this._stats.videoSend.push(i));var n=this.mediaBytesSent.get(e.ssrc);if(n?n.add(e.bytesSent):((a=new o(10)).add(e.bytesSent),this.mediaBytesSent.set(e.ssrc,a)),void 0!==e.retransmittedBytesSent){var s=this.mediaBytesRetransmit.get(e.ssrc);s?s.add(e.retransmittedBytesSent):((a=new o(10)).add(e.retransmittedBytesSent),this.mediaBytesRetransmit.set(e.ssrc,a))}if(e.totalEncodedBytesTarget){var a,c=this.mediaBytesTargetEncode.get(e.ssrc);c?c.add(e.totalEncodedBytesTarget):((a=new o(10)).add(e.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(e.ssrc,a))}if(i.ssrc=e.ssrc,i.bytes=e.bytesSent,i.packets=e.packetsSent,i.firsCount=e.firCount,i.nacksCount=e.nackCount,i.plisCount=e.pliCount,i.frameCount=e.framesEncoded,i.adaptionChangeReason=e.qualityLimitationReason,e.totalEncodeTime&&e.framesEncoded){var l=this.lastEncoderMs.get(e.ssrc);if(!l||l.lastFrameCount>e.framesEncoded)i.avgEncodeMs=1e3*e.totalEncodeTime/e.framesEncoded;else{var u=e.framesEncoded-l.lastFrameCount,h=e.totalEncodeTime-l.lastEncoderTime;i.avgEncodeMs=1e3*h/u}this.lastEncoderMs.set(e.ssrc,{lastFrameCount:e.framesEncoded,lastEncoderTime:e.totalEncodeTime,lts:Ma()})}if(e.codecId&&(i.codec=this.getCodecFromCodecStats(e.codecId)),e.mediaSourceId&&this.processVideoMediaSource(e.mediaSourceId,i),e.trackId&&this.processVideoTrackSenderStats(e.trackId,i),e.remoteId)this.processRemoteInboundStats(e.remoteId,i);else{var p=this.findRemoteStatsId(e.ssrc,d.REMOTE_INBOUND);p&&this.processRemoteInboundStats(p,i)}},r.prototype.processAudioOutboundStats=function(e){var r,i=Qo(r=this._stats.audioSend).call(r,(function(t){return t.ssrc===e.ssrc}));if(i||(i=t(g),this._stats.audioSend.push(i)),i.ssrc=e.ssrc,i.packets=e.packetsSent,i.bytes=e.bytesSent,e.mediaSourceId&&this.processAudioMediaSource(e.mediaSourceId,i),e.codecId&&(i.codec=this.getCodecFromCodecStats(e.codecId)),e.trackId&&this.processAudioTrackSenderStats(e.trackId,i),e.remoteId)this.processRemoteInboundStats(e.remoteId,i);else{var n=this.findRemoteStatsId(e.ssrc,d.REMOTE_INBOUND);n&&this.processRemoteInboundStats(n,i)}},r.prototype.findRemoteStatsId=function(e,t){var r,i,n=Qo(r=Bd(Jp(i=this.report).call(i))).call(r,(function(r){return r.type===t&&r.ssrc===e}));return n?n.id:null},r.prototype.processVideoMediaSource=function(e,t){var r=this.report.get(e);r&&r.width&&r.height&&r.framesPerSecond&&(t.inputFrame={width:r.width,height:r.height,frameRate:r.framesPerSecond})},r.prototype.processAudioMediaSource=function(e,t){var r=this.report.get(e);r&&(t.inputLevel=r.audioLevel)},r.prototype.processVideoTrackSenderStats=function(e,t){var r=this.report.get(e);if(r){var i=0,n=Ma(),o=this.lastVideoFramesSent.get(t.ssrc);o&&n-o.lts>=800?(i=Math.round((r.framesSent-o.count)/((n-o.lts)/1e3)),this.lastVideoFramesSent.set(t.ssrc,{count:r.framesSent,lts:n,rate:i})):o?i=o.rate:this.lastVideoFramesSent.set(t.ssrc,{count:r.framesSent,lts:n,rate:0}),t.sentFrame={width:r.frameWidth,height:r.frameHeight,frameRate:i}}},r.prototype.processVideoTrackReceiverStats=function(e,t){var r=this.report.get(e);if(r){var i=this.lastVideoFramesRecv.get(t.ssrc),n=Ma();t.framesReceivedCount=r.framesReceived;var o=0;if(i&&n-i.lts>=800?(o=Math.round((r.framesReceived-i.count)/((n-i.lts)/1e3)),this.lastVideoFramesRecv.set(t.ssrc,{count:r.framesReceived,lts:n,rate:o})):i?o=i.rate:this.lastVideoFramesRecv.set(t.ssrc,{count:r.framesReceived,lts:n,rate:0}),t.receivedFrame={width:r.frameWidth||0,height:r.frameHeight||0,frameRate:o||0},t.decodedFrame={width:r.frameWidth||0,height:r.frameHeight||0,frameRate:t.decodeFrameRate||0},t.outputFrame={width:r.frameWidth||0,height:r.frameHeight||0,frameRate:t.decodeFrameRate||0},r.jitterBufferDelay&&r.jitterBufferEmittedCount){var s=this.lastVideoJBDelay.get(t.ssrc);this.lastVideoJBDelay.set(t.ssrc,{jitterBufferDelay:r.jitterBufferDelay,jitterBufferEmittedCount:r.jitterBufferEmittedCount}),s||(s={jitterBufferDelay:0,jitterBufferEmittedCount:0});var a=1e3*(r.jitterBufferDelay-s.jitterBufferDelay)/(r.jitterBufferEmittedCount-s.jitterBufferEmittedCount);t.jitterBufferMs=a,t.currentDelayMs=Math.round(a)}}},r.prototype.processAudioTrackSenderStats=function(e,t){var r=this.report.get(e);r&&(t.aecReturnLoss=r.echoReturnLoss||0,t.aecReturnLossEnhancement=r.echoReturnLossEnhancement||0)},r.prototype.processAudioTrackReceiverStats=function(e,t){var r=this.report.get(e);if(r){if(r.removedSamplesForAcceleration&&r.totalSamplesReceived&&(t.accelerateRate=r.removedSamplesForAcceleration/r.totalSamplesReceived),r.jitterBufferDelay&&r.jitterBufferEmittedCount){var i=this.lastAudioJBDelay.get(t.ssrc);this.lastAudioJBDelay.set(t.ssrc,{jitterBufferDelay:r.jitterBufferDelay,jitterBufferEmittedCount:r.jitterBufferEmittedCount}),i||(i={jitterBufferDelay:0,jitterBufferEmittedCount:0});var n=1e3*(r.jitterBufferDelay-i.jitterBufferDelay)/(r.jitterBufferEmittedCount-i.jitterBufferEmittedCount);t.jitterBufferMs=Math.round(n)}t.outputLevel=r.audioLevel;var o=1920;r.totalSamplesDuration&&r.totalSamplesReceived&&(o=r.totalSamplesReceived/r.totalSamplesDuration/50,t.receivedFrames=Math.round(r.totalSamplesReceived/o)),r.concealedSamples&&(t.droppedFrames=Math.round(r.concealedSamples/o))}},r.prototype.processRemoteInboundStats=function(e,t){var r=this.report.get(e);r&&(t.packetsLost=r.packetsLost,r.roundTripTime&&(t.rttMs=1e3*r.roundTripTime))},r.prototype.getCodecFromCodecStats=function(e){var t=this.report.get(e);if(!t)return"";var r=t.mimeType.match(/\/(.*)$/);return r&&r[1]?r[1]:""},r.prototype.updateSendBitrate=function(){var e,t,r,i=0,n=null,o=null;Jr(e=this.mediaBytesSent).call(e,(function(e){i+=e.diffMean()})),Jr(t=this.mediaBytesRetransmit).call(t,(function(e){n=null===n?e.diffMean():n+e.diffMean()})),Jr(r=this.mediaBytesTargetEncode).call(r,(function(e){o=null===o?e.diffMean():o+e.diffMean()}));var s=null!==n?i-n:i;this._stats.bitrate={actualEncoded:8*s/(this.options.updateInterval/1e3),transmit:8*i/(this.options.updateInterval/1e3)},null!==n&&(this._stats.bitrate.retransmit=8*n/(this.options.updateInterval/1e3)),null!==o&&(this._stats.bitrate.targetEncoded=8*o/(this.options.updateInterval/1e3))},r}(_),A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.updateStats=function(){return fo.resolve()},t}(_);function y(e,t,r,o){void 0===t&&(t=250),void 0===r&&(r=8),void 0===o&&(o=500);var s=i();return s?s<76?new v(e,{updateInterval:t,lossRateInterval:r,freezeRateLimit:o}):new E(e,{updateInterval:t,lossRateInterval:r,freezeRateLimit:o}):n(e)?new E(e,{updateInterval:t,lossRateInterval:r,freezeRateLimit:o}):new A(e,{updateInterval:t,lossRateInterval:r,freezeRateLimit:o})}e.createWebRTCStatsFilter=y,e.AgoraWebRTCStatsFilter=_,di(e,"__esModule",{value:!0})}(t)}));class wS{constructor(e){this.localCandidateCount=0,this.allCandidateReceived=!1,this.audioTrack=null,this.videoTrack=null,this.mediaStream=new MediaStream,this.ID=NS,NS+=1,this.spec=e,this.createPeerConnection(),this.statsFilter=RS.createWebRTCStatsFilter(this.pc,void 0,void 0,Ia()?1200:void 0)}get _statsFilter(){return this.statsFilter}getStats(){return this.statsFilter.getStats()}async createOfferSDP(){try{const e=await this.pc.createOffer(this.offerOptions);if(!e.sdp)throw new Error("offer sdp is empty");return e.sdp}catch(e){throw Rc.error("create offer error:",e.toString()),new pl(ll.CREATE_OFFER_FAILED,e.toString())}}async setOfferSDP(e){try{await this.pc.setLocalDescription({type:"offer",sdp:e})}catch(e){throw Rc.error("set local offer error",e.toString()),new pl(ll.CREATE_OFFER_FAILED,e.toString())}}async setAnswerSDP(e){try{await this.pc.setRemoteDescription({type:"answer",sdp:e})}catch(e){if("InvalidStateError"!==e.name||"stable"!==this.pc.signalingState)throw Rc.error("set remote answer error",e.toString()),new pl(ll.SET_ANSWER_FAILED,e.toString());Rc.debug("[pc-".concat(this.ID,"] ignore invalidstate error"))}}close(){this.onICEConnectionStateChange=void 0,this.onConnectionStateChange=void 0;try{this.pc.oniceconnectionstatechange=null,this.pc.onconnectionstatechange=null,this.pc.onsignalingstatechange=null,this.pc.onicecandidateerror=null,this.pc.onicecandidate=null,this.pc.close(),this.pc=null,this.audioTransceiver=void 0,this.videoTransceiver=void 0}catch(e){}this.statsFilter.destroy()}createPeerConnection(){const e={iceServers:[]},t=e=>{const t=[];return Jr(e).call(e,e=>{var r,i,n,o;e.security?e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:Je(r="turns:".concat((o=e.turnServerURL,o.match(/^[\.\:\d]+$/)?"".concat(o.replace(/[^\d]/g,"-"),".edge.agora.io"):(Rc.info("Cannot recognized as IP address ".concat(o,". Used As Host instead")),o)),":")).call(r,e.tcpport,"?transport=tcp")}):(e.udpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:Je(i="turn:".concat(e.turnServerURL,":")).call(i,e.udpport,"?transport=udp")}),e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:Je(n="turn:".concat(e.turnServerURL,":")).call(n,e.tcpport,"?transport=tcp")}))}),t};var r,i;this.spec.iceServers?e.iceServers=this.spec.iceServers:this.spec.turnServer&&"off"!==this.spec.turnServer.mode&&(Kl(this.spec.turnServer.servers)?e.iceServers=this.spec.turnServer.servers:(e.iceServers&&e.iceServers.push(...t(this.spec.turnServer.servers)),e.iceServers&&this.spec.turnServer.serversFromGateway&&e.iceServers.push(...t(this.spec.turnServer.serversFromGateway)),Jr(r=Je(i=this.spec.turnServer.servers).call(i,this.spec.turnServer.serversFromGateway||[])).call(r,t=>{t.forceturn&&(e.iceTransportPolicy="relay")}))),jc("CHROME_FORCE_PLAN_B")&&Da()&&(e.sdpSemantics="plan-b",Fu().supportUnifiedPlan=!1),this.pc=new RTCPeerConnection(e,{optional:[{googDscp:!0}]}),this.pc.oniceconnectionstatechange=()=>{this.onICEConnectionStateChange&&this.onICEConnectionStateChange(this.pc.iceConnectionState)},this.pc.onconnectionstatechange=()=>{this.onConnectionStateChange&&this.onConnectionStateChange(this.pc.connectionState)},this.pc.onsignalingstatechange=()=>{this.pc&&"closed"===this.pc.connectionState&&this.onConnectionStateChange&&this.onConnectionStateChange(this.pc.connectionState)},this.pc.onicecandidate=e=>{if(!e.candidate)return this.pc.onicecandidate=null,this.allCandidateReceived=!0,void Rc.debug("[pc-".concat(this.ID,"] local candidate count"),this.localCandidateCount);this.localCandidateCount+=1},Fa(()=>{this.allCandidateReceived||(this.allCandidateReceived=!0,Rc.debug("[pc-".concat(this.ID,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},jc("CANDIDATE_TIMEOUT"))}}class kS extends wS{constructor(e){super(e)}async setOfferSDP(e){const t=jc("CUSTOM_PUB_OFFER_MODIFIER");return t&&(e=t(e)),await super.setOfferSDP(e)}async setAnswerSDP(e){const t=jc("CUSTOM_PUB_ANSWER_MODIFIER");return t&&(e=t(e)),await super.setAnswerSDP(e)}getAnswerSDP(){return this.pc.remoteDescription}getOfferSDP(){return this.pc.localDescription}async addStream(e){const t=e.getTracks();for(const r of t)await this.addTrack(r)}async replaceTrack(e){var t;if(!Fu().supportReplaceTrack){const t="audio"===e.kind?this.audioTrack:this.videoTrack;if(!t)throw new pl(ll.UNEXPECTED_ERROR,"can not find replaced track");return await this.removeTrack(t),await this.addTrack(e),!0}const r=this.getSender(e.kind),i=Qo(t=this.mediaStream.getTracks()).call(t,t=>t.kind===e.kind);i&&this.mediaStream.removeTrack(i),this.mediaStream.addTrack(e);try{await r.replaceTrack(e),"audio"===e.kind?this.audioTrack=e:this.videoTrack=e}catch(e){throw new pl(ll.SENDER_REPLACE_FAILED,e.toString())}return!1}async removeTrack(e){const t=this.getSender(e.kind);this.mediaStream.removeTrack(e);try{const e=ma();"Safari"===e.name&&"11"===e.version&&await t.replaceTrack(null),this.pc.removeTrack(t)}catch(e){Rc.warning("[pc-".concat(this.ID,"] remove track error, ignore"),e)}"audio"===e.kind?(this.audioTrack=null,this.audioSender=void 0,this.audioTransceiver&&(this.audioTransceiver.direction="inactive"),this.audioTransceiver=void 0):(this.videoTrack=null,this.videoSender=void 0,this.videoTransceiver&&(this.videoTransceiver.direction="inactive"),this.videoTransceiver=void 0)}onOfferSettled({videoActive:e,audioActive:t}){if(Ia())Rc.debug("firefox do not set sender parameter");else{if(this.audioSender){const e={networkQuality:void 0,active:!0};jc("DSCP_TYPE")&&(e.networkQuality=jc("DSCP_TYPE")),this.audioTrack&&(e.active=!!t),this.setAudioRtpEncodingParameters(e).catch(e=>{Rc.debug("set audio sender`s network priority failed")})}if(this.videoSender){const t={networkQuality:void 0,active:!0};jc("DSCP_TYPE")&&(t.networkQuality=jc("DSCP_TYPE")),this.videoTrack&&(t.active=!!e),this.setVideoRtpEncodingParameters(t).catch(e=>{Rc.debug("set video sender`s network priority failed")})}}}async addTrack(e){const t=Fu();if("audio"===e.kind&&this.audioTrack||"video"===e.kind&&this.videoTrack)throw new pl(ll.UNEXPECTED_ERROR,"Can't add multiple stream");let r,i;this.mediaStream.addTrack(e),t.supportUnifiedPlan?(r=await async function(e,t,r){var i;const n=Qo(i=e.getTransceivers()).call(i,e=>"inactive"===e.direction&&e.receiver.track.kind===t.kind);return n?(n.direction="sendrecv",await n.sender.replaceTrack(t),n):e.addTransceiver(t,{direction:"sendrecv",streams:[r]})}(this.pc,e,this.mediaStream),i=r.sender):i=this.pc.addTrack(e,this.mediaStream),"audio"===e.kind?(this.audioTrack=e,this.audioSender=i,this.audioTransceiver=r):(this.videoTrack=e,this.videoSender=i,this.videoTransceiver=r)}async setRtpSenderParameters(e,t){const r=this.videoSender||(this.videoTransceiver?this.videoTransceiver.sender:void 0);if(!r)return;const i=r.getParameters();i.degradationPreference=t;try{await r.setParameters(i)}catch(e){Rc.debug("[".concat(this.ID,"] ignore RtpSender.setParameters"),e.toString())}}async setVideoRtpEncodingParameters(e){const t=this.videoSender||(this.videoTransceiver?this.videoTransceiver.sender:void 0);if(!t)throw new pl(ll.LOW_STREAM_ENCODING_ERROR,"Low stream has no video sender.");const r=t.getParameters();if(!r.encodings||!r.encodings[0])throw new pl(ll.LOW_STREAM_ENCODING_ERROR,"Low stream RtpEncodingParameters is empty.");e.scaleResolutionDownBy&&(r.encodings[0].scaleResolutionDownBy=e.scaleResolutionDownBy),e.maxBitrate&&(r.encodings[0].maxBitrate=e.maxBitrate),e.maxFramerate&&(r.encodings[0].maxFramerate=e.maxFramerate),void 0!==e.active&&(Rc.debug("set video sender encoding active:",e.active),r.encodings[0].active=e.active);const i=["very-low","low","medium","high"];return e.networkPriority&&is(i).call(i,e.networkPriority)&&(Rc.debug("set video sender network quality:",e.networkPriority),r.encodings[0].networkPriority=e.networkPriority),await t.setParameters(r),t.getParameters()}async setAudioRtpEncodingParameters(e){const t=this.audioSender||(this.audioTransceiver?this.audioTransceiver.sender:void 0);if(!t)throw new pl(ll.SET_ENCODING_PARAMETER_ERROR,"pc has no audio sender.");const r=t.getParameters();if(!r.encodings||!r.encodings[0])throw new pl(ll.SET_ENCODING_PARAMETER_ERROR,"pc RtpEncodingParameters is empty.");void 0!==e.active&&(Rc.debug("set audio sender encoding active:",e.active),r.encodings[0].active=e.active);const i=["very-low","low","medium","high"];return e.networkPriority&&is(i).call(i,e.networkPriority)&&(Rc.debug("set audio sender network quality:",e.networkPriority),r.encodings[0].networkPriority=e.networkPriority),await t.setParameters(r),t.getParameters()}getSender(e){let t=null;if(Fu().supportUnifiedPlan){var r;const i=Qo(r=this.pc.getTransceivers()).call(r,t=>t.sender.track&&t.sender.track.kind===e);t=i?i.sender:null}else{var i;t=Qo(i=this.pc.getSenders()).call(i,t=>t.track&&t.track.kind===e)||null}if(!t)throw new pl(ll.SENDER_NOT_FOUND);return t}close(){this.audioSender=void 0,this.videoSender=void 0,super.close()}}class OS extends wS{constructor(e){super(e),this.statsFilter.onFirstAudioDecoded=()=>this.onFirstAudioDecoded&&this.onFirstAudioDecoded(),this.statsFilter.onFirstVideoDecoded=(e,t)=>this.onFirstVideoDecoded&&this.onFirstVideoDecoded(e,t),this.statsFilter.onFirstAudioReceived=()=>this.onFirstAudioReceived&&this.onFirstAudioReceived(),this.statsFilter.onFirstVideoReceived=()=>this.onFirstVideoReceived&&this.onFirstVideoReceived(),Fu().supportUnifiedPlan?(this.audioTransceiver=this.pc.addTransceiver("audio",{direction:"recvonly"}),this.videoTransceiver=this.pc.addTransceiver("video",{direction:"recvonly"})):this.offerOptions={offerToReceiveAudio:!0,offerToReceiveVideo:!0},this.pc.ontrack=e=>{"audio"===e.track.kind?this.audioTrack=e.track:this.videoTrack=e.track,this.onTrack&&this.onTrack(e.track,e.streams[0])}}async setOfferSDP(e){const t=jc("CUSTOM_SUB_OFFER_MODIFIER");return t&&(e=t(e)),await super.setOfferSDP(e)}async setAnswerSDP(e){const t=jc("CUSTOM_SUB_ANSWER_MODIFIER");return t&&(e=t(e)),await super.setAnswerSDP(e)}}let NS=1,LS=1;class PS extends Mu{constructor(e,t){super(),this.startTime=Ma(),this.createTime=Ma(),this.readyToReconnect=!1,this._connectionState="disconnected",this.currentReconnectCount=0,this.ID=LS,LS+=1,this.joinInfo=e,this._userId=t,this.createPC()}get connectionState(){return this._connectionState}set connectionState(e){e!==this._connectionState&&(this.emit(ty.CONNECTION_STATE_CHANGE,e,this._connectionState),this._connectionState=e)}get connectionId(){var e,t;return Je(e=Je(t="".concat(this.joinInfo.clientId,"-")).call(t,this.type?this.type:"sub(".concat(this._userId,")"),"-")).call(e,this.ID)}getUserId(){return this._userId}startUploadStats(){this.statsUploadInterval=window.setInterval(()=>{const e=this.pc.getStats();this.uploadStats(e,this.lastUploadPCStats),this.lastUploadPCStats=e},3e3),this.statsUploadSlowInterval=window.setInterval(()=>{const e=this.pc.getStats();this.uploadSlowStats(e)},6e4),this.relatedStatsUploadInterval=window.setInterval(()=>{const e=this.pc.getStats();this.uploadRelatedStats(e,this.lastRelatedPcStats),this.lastRelatedPcStats=e},1e3)}stopUploadStats(){this.statsUploadInterval&&window.clearInterval(this.statsUploadInterval),this.relatedStatsUploadInterval&&window.clearInterval(this.relatedStatsUploadInterval),this.statsUploadInterval=void 0,this.relatedStatsUploadInterval=void 0}createWaitConnectionConnectedPromise(){return new fo((e,t)=>{"disconnected"===this.connectionState?t():"connected"===this.connectionState?e():this.once(ty.CONNECTION_STATE_CHANGE,r=>{"connected"===r?e():t()})})}async reconnectPC(e){if(this.readyToReconnect=!1,e&&this.onPCDisconnected(e),this.currentReconnectCount>1/0)throw Rc.debug("[".concat(this.connectionId,"] cannot reconnect pc")),e||new pl(hy.UNEXPECTED_ERROR);if(this.stopUploadStats(),Rc.debug("[".concat(this.connectionId,"] start reconnect pc")),this.connectionState="connecting",this.currentReconnectCount+=1,await this.closePC())return Rc.debug("[".concat(this.connectionId,"] abort reconnect pc, wait ws")),void this.readyToReconnectPC();this.createPC(),await this.startP2PConnection(),this.currentReconnectCount=0}readyToReconnectPC(){this.stopUploadStats(),this.readyToReconnect=!0,this.pc.onICEConnectionStateChange=void 0,this.connectionState="connecting"}updateICEPromise(){this.removeAllListeners(ty.GATEWAY_P2P_LOST),this.icePromise=new fo((e,t)=>{let r=!0;this.pc.onICEConnectionStateChange=i=>{var n,o;Rc.info(Je(n=Je(o="[".concat(this.connectionId,"] ice-state: ")).call(o,this.type," p2p ")).call(n,i)),"connected"===i&&e(),"failed"!==i&&"closed"!==i||(r&&this.emit(ty.P2P_LOST),r=!1,this.reconnectPC(new pl(hy.ICE_FAILED)).catch(e=>{t(e)}))},this.pc.onConnectionStateChange=e=>{var i,n;Rc.info(Je(i=Je(n="[".concat(this.connectionId,"] connection-state: ")).call(n,this.type," p2p ")).call(i,e)),"failed"!==e&&"closed"!==e||(r&&this.emit(ty.P2P_LOST),r=!1,this.reconnectPC(new pl(hy.PC_CLOSED)).catch(e=>{t(e)}))},this.removeAllListeners(ty.GATEWAY_P2P_LOST),this.once(ty.GATEWAY_P2P_LOST,e=>{var i;if(this.pc.ID.toString()===e.toString()){if(Rc.info(Je(i="[".concat(this.connectionId,"] ")).call(i,this.type," p2p gateway lost")),r&&this.emit(ty.P2P_LOST),r=!1,this.pc.allCandidateReceived&&0===this.pc.localCandidateCount)return this.disconnectedReason=new pl(hy.NO_ICE_CANDIDATE,"can not get candidate in this pc"),void this.closeP2PConnection(!0);this.reconnectPC(new pl(hy.GATEWAY_P2P_LOST)).catch(e=>{t(e)})}})})}}function DS(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function MS(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=DS(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=DS(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}var xS=function(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Bi(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&di(t,r,s),s},BS=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class US extends Dy{constructor(e,t,r,i,n){super(e,n),this.trackMediaType="video",this._scalabiltyMode={numSpatialLayers:1,numTemporalLayers:1},this._enabled=!0,this.updateMediaStreamTrackResolution(),this._encoderConfig=t,this._scalabiltyMode=r,this._optimizationMode=i}get isPlaying(){return!(!this._player||this._player.videoElementStatus!==kA.PLAYING)}play(e,t={}){const r=ky.reportApiInvoke(null,{tag:GA.TRACER,name:jA.LOCAL_VIDEO_TRACK_PLAY,options:[this.getTrackId(),"string"==typeof e?e:"HTMLElement",t]});if(!(e instanceof HTMLElement)){const t=document.getElementById(e.toString());var i;t?e=t:(Rc.warning(Je(i="[".concat(this.getTrackId(),'] can not find "#')).call(i,e,'" element, use document.body')),e=document.body)}Rc.debug("[".concat(this.getTrackId(),"] start video playback"),ve(t));const n=MS({},this._getDefaultPlayerConfig(),{},t,{trackId:this.getTrackId(),element:e});this._player?this._player.updateConfig(n):(this._player=new H_(n),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),r.onSuccess()}stop(){const e=ky.reportApiInvoke(null,{tag:GA.TRACER,name:jA.LOCAL_VIDEO_TRACK_STOP,options:[this.getTrackId()]});if(!this._player)return e.onSuccess();this._player.destroy(),this._player=void 0,Rc.debug("[".concat(this.getTrackId(),"] stop video playback")),e.onSuccess()}async setEnabled(e,t){if(!t){if(e===this._enabled)return;this.stateCheck("enabled",e)}Rc.info("[".concat(this.getTrackId(),"] start setEnabled"),e);const r=await this._enabledMutex.lock();if(!e){this._originMediaStreamTrack.enabled=!1;try{await Mp(this,my.NEED_REMOVE_TRACK,this)}catch(e){throw Rc.error("[".concat(this.getTrackId(),"] setEnabled to false error"),e.toString()),r(),e}return t||(this._enabled=!1),Rc.info("[".concat(this.getTrackId(),"] setEnabled to false success")),r()}this._originMediaStreamTrack.enabled=!0;try{await Mp(this,my.NEED_ADD_TRACK,this)}catch(e){throw Rc.error("[".concat(this.getTrackId(),"] setEnabled to true error"),e.toString()),r(),e}Rc.info("[".concat(this.getTrackId(),"] setEnabled to true success")),t||(this._enabled=!0),r()}async setMuted(e){var t;if(e!==this._muted){if(this.stateCheck("muted",e),this._muted=e,ma().name===RA.FIREFOX)return Rc.debug("[".concat(this.getTrackId(),"] firefox set mute fallback to set enabled")),void await this.setEnabled(!e,!0);this._mediaStreamTrack.enabled=!e,Rc.debug(Je(t="[".concat(this.getTrackId(),"] start set muted: ")).call(t,e)),await Mp(this,my.SET_VIDEO_TRACK_MUTED,{track:this,muted:e})}}getStats(){Hp(()=>{Rc.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning");const e=xp(this,my.GET_STATS);return e||MS({},ny)}async setBeautyEffect(e,t={}){const r=ky.reportApiInvoke(null,{tag:GA.TRACER,name:jA.LOCAL_VIDEO_TRACK_BEAUTY,options:[this.getTrackId(),e,t]});if(e||this._videoBeautyProcessor){if(Aa()===IA.IOS||Aa()===IA.ANDROID){const e=new pl(ll.INVALID_OPERATION,"can not enable beauty effect on mobile device");throw r.onError(e),e}if(!this._enabled&&e){const e=new pl(ll.TRACK_IS_DISABLED,"can not enable beauty effect when track is disabled");throw r.onError(e),e}Rc.info("[".concat(this.getTrackId(),"] start setBeautyEffect"),e,ve(t));try{this._videoBeautyProcessor?await this._videoBeautyProcessor.setBeautyEffectOptions(e,t):(this._videoBeautyProcessor=new pv,this._videoBeautyProcessor.onOverload=()=>{Vp(()=>this.emit(vy.BEAUTY_EFFECT_OVERLOAD))},await this._videoBeautyProcessor.setBeautyEffectOptions(e,t),await this._registerTrackProcessor(this._videoBeautyProcessor))}catch(e){throw Rc.error("[".concat(this.getTrackId(),"] setBeautyEffect error"),e.toString()),r.onError(e),e}Rc.info("[".concat(this.getTrackId(),"] setBeautyEffect success")),r.onSuccess()}}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}clone(e,t,r,i){const n=this._mediaStreamTrack.clone();return new US(n,e,t,r,i)}async setBitrateLimit(e){var t;if(Rc.debug(Je(t="[".concat(this.getTrackId(),"] set bitrate limit, ")).call(t,ve(e))),e){this._forceBitrateLimit=e,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<e.max_bitrate?this._encoderConfig.bitrateMax:e.max_bitrate:this._encoderConfig.bitrateMax=e.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=e.min_bitrate);try{await Mp(this,my.NEED_RESET_REMOTE_SDP)}catch(e){return e.throw()}}}async setOptimizationMode(e){var t;if("motion"===e||"detail"===e||"balanced"===e){try{this._optimizationMode=e,await Mp(this,my.SET_OPTIMIZATION_MODE,e)}catch(e){throw Rc.error("[".concat(this.getTrackId(),"] set optimization mode failed"),e.toString()),e}Rc.info(Je(t="[".concat(this.getTrackId(),"] set optimization mode success (")).call(t,e,")"))}else Rc.error(ll.INVALID_PARAMS,"optimization mode must be motion, detail or balanced")}setScalabiltyMode(e){var t;if(1===e.numSpatialLayers&&1!==e.numTemporalLayers)return Rc.error(ll.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabiltyMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabiltyMode=e,Rc.info(Je(t="[".concat(this.getTrackId(),"] set scalability mode success (")).call(t,e,")"))}updateMediaStreamTrackResolution(){Lp(this._originMediaStreamTrack).then(([e,t])=>{this._videoHeight=t,this._videoWidth=e}).catch(Np)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}async renewMediaStreamTrack(){}}xS([My(),BS("design:type",Function),BS("design:paramtypes",[Object,Object]),BS("design:returntype",void 0)],US.prototype,"play",null),xS([My(),BS("design:type",Function),BS("design:paramtypes",[Boolean,Boolean]),BS("design:returntype",fo)],US.prototype,"setEnabled",null),xS([My(),wy({report:ky}),BS("design:type",Function),BS("design:paramtypes",[Boolean]),BS("design:returntype",fo)],US.prototype,"setMuted",null),xS([My(),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",Object)],US.prototype,"getStats",null),xS([My(),BS("design:type",Function),BS("design:paramtypes",[Boolean,Object]),BS("design:returntype",fo)],US.prototype,"setBeautyEffect",null),xS([My(),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",ImageData)],US.prototype,"getCurrentFrameData",null),xS([My(),BS("design:type",Function),BS("design:paramtypes",[Object]),BS("design:returntype",fo)],US.prototype,"setBitrateLimit",null),xS([My(),BS("design:type",Function),BS("design:paramtypes",[String]),BS("design:returntype",fo)],US.prototype,"setOptimizationMode",null),xS([My(),BS("design:type",Function),BS("design:paramtypes",[Object]),BS("design:returntype",void 0)],US.prototype,"setScalabiltyMode",null),xS([My(),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],US.prototype,"updateMediaStreamTrackResolution",null);class FS extends US{constructor(e,t,r,i,n,o){super(e,t.encoderConfig?Mc(t.encoderConfig):{},i,n,o),this._enabled=!0,this._deviceName="default",this.tryResumeVideoForIOS15WeChat=async()=>{wa()&&La()&&this._mediaStreamTrack.muted&&this._enabled&&!this._isClosed&&(Rc.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.setEnabled(!1),await this.setEnabled(!0))},this._config=t,this._constraints=r,this._deviceName=e.label,this._config.encoderConfig&&(this._encoderConfig=Mc(this._config.encoderConfig)),ph.on(uh.IOS_15_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat)}async setDevice(e){var t;const r=ky.reportApiInvoke(null,{tag:GA.TRACER,name:jA.CAM_VIDEO_TRACK_SET_DEVICE,options:[this.getTrackId(),e]});if(Rc.info(Je(t="[".concat(this.getTrackId(),"] set device to ")).call(t,e)),this._enabled)try{const t=await Ph.getDeviceById(e),r={};r.video=MS({},this._constraints),r.video.deviceId={exact:e},r.video.facingMode=void 0,this._originMediaStreamTrack.stop();let i=null;try{i=await kh(r,this.getTrackId())}catch(e){throw Rc.error("[".concat(this.getTrackId(),"] setDevice failed"),e.toString()),i=await kh({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(i.getVideoTracks()[0],!1),e}await this._updateOriginMediaStreamTrack(i.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=t.label,this._config.cameraId=e,this._constraints.deviceId={exact:e}}catch(e){throw r.onError(e),Rc.error("[".concat(this.getTrackId(),"] setDevice error"),e.toString()),e}else try{const t=await Ph.getDeviceById(e);this._deviceName=t.label,this._config.cameraId=e,this._constraints.deviceId={exact:e}}catch(e){throw r.onError(e),Rc.error("[".concat(this.getTrackId(),"] setDevice error"),e.toString()),e}Rc.info("[".concat(this.getTrackId(),"] setDevice success")),r.onSuccess()}async setEnabled(e,t){if(!t){if(e===this._enabled)return;this.stateCheck("enabled",e)}Rc.info("[".concat(this.getTrackId(),"] start setEnabled"),e);const r=await this._enabledMutex.lock();if(!e){this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),t||(this._enabled=!1);try{await Mp(this,my.NEED_REMOVE_TRACK,this)}catch(e){throw Rc.error("[".concat(this.getTrackId(),"] setEnabled to false error"),e.toString()),r(),e}return Rc.info("[".concat(this.getTrackId(),"] setEnabled to false success")),r()}const i=MS({},this._constraints),n=Ph.searchDeviceIdByName(this._deviceName);n&&!i.deviceId&&(i.deviceId={exact:n});try{const e=await kh({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(e.getVideoTracks()[0],!1),await Mp(this,my.NEED_ADD_TRACK,this)}catch(e){throw Rc.error("[".concat(this.getTrackId(),"] setEnabled true error"),e.toString()),r(),e}this.updateMediaStreamTrackResolution(),Rc.info("[".concat(this.getTrackId(),"] setEnabled to true success")),t||(this._enabled=!0),r()}async setEncoderConfiguration(e,t){const r=ky.reportApiInvoke(null,{tag:GA.TRACER,name:jA.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG,options:[this.getTrackId(),e]});if(!this._enabled){const e=new pl(ll.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");throw r.onError(e),e}e=Mc(e),this._forceBitrateLimit&&(e.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:e.bitrateMax,e.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:e.bitrateMin);const i=jp(this._config);i.encoderConfig=e;const n=fv(i);Rc.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),ve(e),ve(n));try{await this._originMediaStreamTrack.applyConstraints(n),this.updateMediaStreamTrackResolution()}catch(e){const t=new pl(ll.UNEXPECTED_ERROR,e.toString());throw Rc.error("[".concat(this.getTrackId(),"] applyConstraints error"),t.toString()),r.onError(t),t}this._config=i,this._constraints=n,this._encoderConfig=e;try{await Mp(this,my.NEED_RENEGOTIATE)}catch(e){return r.onError(e),e.throw()}r.onSuccess()}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((Ra()||Na())&&this._enabled&&!this._isClosed&&ph.duringInterruption){const e=async()=>{ph.off(uh.IOS_INTERRUPTION_END,e),this._enabled&&!this._isClosed&&(Rc.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};ph.on(uh.IOS_INTERRUPTION_END,e)}else Rc.debug("[".concat(this.getTrackId(),"] track ended")),this.emit(vy.TRACK_ENDED)}async renewMediaStreamTrack(){const e=MS({},this._constraints),t=Ph.searchDeviceIdByName(this._deviceName);t&&!e.deviceId&&(e.deviceId={exact:t});const r=await kh({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(r.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}close(){super.close(),ph.off(uh.IOS_15_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat)}}function VS(e,t){const r=e.match(/a=rtpmap:(\d+) opus/);if(!r||!r[0]||!r[1])return e;const i=r[1],n=e.match("a=fmtp:".concat(i,".*\r\n"));if(!n||!n[0])return e;let o="a=fmtp:".concat(i," minptime=10;useinbandfec=1;");var s;return t.bitrate&&!Ia()&&(o+="maxaveragebitrate=".concat(Math.floor(1e3*t.bitrate),";")),t.sampleRate&&(o+=Je(s="maxplaybackrate=".concat(t.sampleRate,";sprop-maxcapturerate=")).call(s,t.sampleRate,";")),t.stereo&&(o+="stereo=1;sprop-stereo-1;"),o+="\r\n",e.replace(n[0],o)}function jS(e){return e.replace("minptime=10","minptime=10;stereo=1;sprop-stereo=1")}function GS(e,t,r){let i=!1;switch(t){case"h264":return e;case"vp8":if(!jc("SIMULCAST"))return e;i=!0,r&&(r.numSpatialLayers=2);case"vp9":i=!0;case"av1":i=!0}if(i){var n;const t=$o(n=RegExp.prototype.test).call(n,/^([a-z])=(.*)/),i=e.split("m=");let v,E,A=null,y=null,S=null,C=[],T=[],b=[],I=[],R=null,w=null,k=0;const O=[],N=[];for(let e=0;e<i.length;++e)if(A=i[e].match(/a=msid-semantic:/),A){A=i[e];break}for(let e=0;e<i.length;++e)if(y=i[e].match(/audio /),y){v=e,y="m="+i[e];break}for(let e=0;e<i.length;++e)if(S=i[e].match(/video /),S){E=e,S="m="+i[e];break}var o,s;if(A&&(C=ji(o=A.split(/(\r\n|\r|\n)/)).call(o,t)),C.length>0&&(I=Je(I).call(I,C)),y&&(T=ji(s=y.split(/(\r\n|\r|\n)/)).call(s,t)),!S)return e;{var a;b=ji(a=S.split(/(\r\n|\r|\n)/)).call(a,t);for(let e=0;e<b.length;++e)if(null===R&&(R=b[e].match(/cname:/),null!==R)){R="cname:"+b[e].split("cname:")[1];break}for(let e=0;e<b.length;++e)if(null===w&&(w=b[e].match(/a=msid:/),null!==w&&(w="msid:"+b[e].split(":")[1])),b[e].match(/a=ssrc-group:FID/)){const t=b[e].split(" ");k=e,O.push(Number(t[1])),t[2]&&N.push(Number(t[2])),b.length=k;break}for(let e=1;e<r.numSpatialLayers;++e)O.push(O[0]+e),N.length>0&&N.push(N[0]+e);let i="a=ssrc-group:SIM ";const n="a=ssrc-group:FID ";for(let e=0;e<O.length;++e)i=Je(i).call(i,String(O[e])),e<O.length-1&&(i=Je(i).call(i," "));b.push(i);for(let e=0;e<r.numSpatialLayers;++e){var c,l;const t=Je(c=Je(l=Je(n).call(n,String(O[e]))).call(l," ")).call(c,String(N[e]));b.push(t)}for(let t=0;t<r.numSpatialLayers;++t){var u,d,h,p;if(null===R||null===w)return e;const r=Je(u=Je(d="a=ssrc:".concat(String(O[t]))).call(d," ")).call(u,R),i=Je(h=Je(p="a=ssrc:".concat(String(O[t]))).call(p," ")).call(h,w);b.push(r),b.push(i)}for(let t=0;t<r.numSpatialLayers;++t){var f,g,m,_;if(null===R||null===w)return e;const r=Je(f=Je(g="a=ssrc:".concat(String(N[t]))).call(g," ")).call(f,R),i=Je(m=Je(_="a=ssrc:".concat(String(N[t]))).call(_," ")).call(m,w);b.push(r),b.push(i)}}v&&E&&v>E?(I=Je(I).call(I,b),I=Je(I).call(I,T)):(I=Je(I).call(I,T),I=Je(I).call(I,b)),e=I.join("\r\n")+"\r\n"}return e}xS([My(),BS("design:type",Function),BS("design:paramtypes",[String]),BS("design:returntype",fo)],FS.prototype,"setDevice",null),xS([My(),BS("design:type",Function),BS("design:paramtypes",[Boolean,Boolean]),BS("design:returntype",fo)],FS.prototype,"setEnabled",null),xS([My(),BS("design:type",Function),BS("design:paramtypes",[Object,Boolean]),BS("design:returntype",fo)],FS.prototype,"setEncoderConfiguration",null);const HS=(e,t)=>{let r=null;if("h264"===t?r=e.match(/a=rtpmap:(\d+) H264.*\r\n/)||e.match(/a=rtpmap:(\d+) H264.*\n/):"vp8"===t?r=e.match(/a=rtpmap:(\d+) VP8.*\r\n/)||e.match(/a=rtpmap:(\d+) VP8.*\n/):"vp9"===t?r=e.match(/a=rtpmap:(\d+) VP9.*\r\n/)||e.match(/a=rtpmap:(\d+) VP9.*\n/):"av1"===t&&(r=e.match(/a=rtpmap:(\d+) AV1.*\r\n/)||e.match(/a=rtpmap:(\d+) AV1.*\n/)),r&&r[1])return r[1]};function QS(e,t){const r=(e,t)=>{const n=HS(e,t);return n?r(i(e,n),t):e},i=(e,t)=>{var r,i;const n=$o(r=RegExp.prototype.test).call(r,/^([a-z])=(.*)/),o=["a=rtpmap:".concat(t),"a=rtcp-fb:".concat(t),"a=fmtp:".concat(t)],s=ji(i=e.split(/(\r\n|\r|\n)/)).call(i,n),a=[];Jr(s).call(s,(e,t)=>{Jr(o).call(o,r=>{is(e).call(e,r)&&a.push(t)})});const c=Lv(s).call(s,e=>is(e).call(e,"apt=".concat(t)));let l;if(c){a.push(c,c-1);const e=s[c-1].match(/a=rtpmap:(\d+) rtx.*/);l=e&&e[1]}Jr(a).call(a,e=>{s[e]=""});const u=Lv(s).call(s,e=>is(e).call(e,"m=video"));return s[u]=s[u].replace(" ".concat(t),""),l&&(s[u]=s[u].replace(" ".concat(l),"")),ji(s).call(s,e=>!!e).join("\r\n")+"\r\n"};return Jr(t).call(t,t=>{e=r(e,t)}),e}function WS(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function qS(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=WS(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=WS(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}class zS extends PS{constructor(e,t,r,i){super(t,t.stringUid||t.uid),this.suspendTracks=[],this.type="pub",this.detecting=!1,this._waitingSuccessResponse=!1,this.handleMuteVideoTrack=({track:e,muted:t},r,i)=>{this.setVideoTrackMuteState(t).then(r).catch(i)},this.handleMuteAudioTrack=({track:e,muted:t},r,i)=>{this.setAudioTrackMuteState(t,e).then(r).catch(i)},this.renegotiateWithGateway=async()=>(Rc.debug("[pc-".concat(this.pc.ID,"] renegotiate start")),new fo(async(e,t)=>{this.connectionState="connecting";const r=i=>{"connected"===i&&(this.off(ty.CONNECTION_STATE_CHANGE,r),e()),"disconnected"===i&&(this.off(ty.CONNECTION_STATE_CHANGE,r),t(new pl(hy.OPERATION_ABORTED,"renegotiate abort")))};this.on(ty.CONNECTION_STATE_CHANGE,r),Ia()&&jc("SIMULCAST")&&this.videoTrack&&this.videoTrack._scalabiltyMode&&await this.addSimulcast4Firefox(this.videoTrack._scalabiltyMode);let i=await this.pc.createOfferSDP();if(this.audioTrack&&this.audioTrack._encoderConfig&&(i=VS(i,this.audioTrack._encoderConfig)),this.videoTrack&&this.videoTrack._scalabiltyMode&&("vp9"!==this.codec&&"vp8"!==this.codec?(this.videoTrack._scalabiltyMode.numSpatialLayers=1,this.videoTrack._scalabiltyMode.numTemporalLayers=1):(this.videoTrack._scalabiltyMode.numSpatialLayers>1||this.videoTrack._scalabiltyMode.numTemporalLayers>1)&&(i=GS(i,this.codec,this.videoTrack._scalabiltyMode)),Rc.debug("renegoation spatial layers: ",this.videoTrack._scalabiltyMode.numSpatialLayers)),await this.pc.setOfferSDP(i),this.audioTrack instanceof Hy){const e={videoActive:this.videoTrack&&!this.videoTrack.muted,audioActive:this.audioTrack&&this.audioTrack.isActive};this.pc.onOfferSettled(e)}const n=await Dp(this,ty.NEED_RENEGOTIATE,i);this.videoTrack&&!Ia()&&jc("SIMULCAST")&&this.videoTrack._scalabiltyMode&&this.setSimulcastVideoRtpEncodingParameters(this.videoTrack._scalabiltyMode);const o=function(e,t){var r,i,n;const o=$o(r=RegExp.prototype.test).call(r,/^([a-z])=(.*)/),s=ji(i=e.split(/(\r\n|\r|\n)/)).call(i,o),a=ji(n=t.split(/(\r\n|\r|\n)/)).call(n,o);let c=null;const l=new Mr;return Jr(s).call(s,e=>{const t=e.match(/m=(audio|video)/);if(t&&t[1])return void(c=t[1]);if(!c)return;const r=e.match(/\=(sendrecv|recvonly|sendonly|inactive)/);r&&r[1]&&l.set(c,r[1])}),c=null,vo(a).call(a,e=>{const t=e.match(/m=(audio|video)/);if(t&&t[1])return c=t[1],e;if(!c)return e;const r=e.match(/\=(sendrecv|recvonly|sendonly|inactive)/);if(r&&r[1]){const t=l.get(c);if(t&&t!==r[1])return e.replace(r[1],t)}return e}).join("\r\n")+"\r\n"}(i,this.updateAnswerSDP(n.sdp));await this.pc.setAnswerSDP(o),Rc.debug("[pc-".concat(this.pc.ID,"] renegotiate success")),this.connectionState="connected"})),this.handleStreamRenegotiate=(e,t)=>{"connected"===this.connectionState?this.renegotiateWithGateway().then(e).catch(t):e()},this.handleReplaceTrack=(e,t,r)=>{if(this.audioTrack instanceof Hy&&"audio"===e.kind)return t();this.pc.replaceTrack(e).then(e=>e?this.renegotiateWithGateway():fo.resolve()).then(t).catch(r)},this.handleCloseAudioTrack=e=>{},this.handleCloseVideoTrack=()=>{this.lowStreamConnection&&this.lowStreamConnection.videoTrack&&this.lowStreamConnection.videoTrack.close()},this.handleGetSessionID=e=>{e(this.joinInfo.sid)},this.handleGetLocalVideoStats=e=>{e(this.statsCollector.getLocalVideoTrackStats(this.connectionId))},this.handleGetLocalAudioStats=e=>{e(this.statsCollector.getLocalAudioTrackStats(this.connectionId))},this.handleSetOptimizationMode=(e,t,r)=>{this.videoTrack&&this.setRtpSenderParametersByTrackConfig(this.videoTrack).then(t).catch(r)},this.isLowStreamConnection=!!i,this.codec=r,this.statsCollector=e,this.statsCollector.addLocalConnection(this)}getAllTracks(){let e=[];return this.videoTrack&&e.push(this.videoTrack),this.audioTrack&&this.audioTrack instanceof Hy?e=Je(e).call(e,this.audioTrack.trackList):this.audioTrack&&e.push(this.audioTrack),e.push(...this.suspendTracks),e}async addTracks(e){const t=Fu();if("connecting"===this.connectionState)try{return await this.createWaitConnectionConnectedPromise(),await this.addTracks(e)}catch(e){throw new pl(hy.OPERATION_ABORTED,"publish abort")}let r=!1;const i=this.getAllTracks();e=Fp(e=ji(e).call(e,e=>-1===Lo(i).call(i,e)));for(let n=0;n<e.length;n+=1){const i=e[n];if(!(i instanceof Dy))return new pl(hy.INVALID_LOCAL_TRACK).throw();if(i instanceof US&&this.disabledVideoTrack){if(this.disabledVideoTrack!==i)return new pl(hy.EXIST_DISABLED_VIDEO_TRACK).throw();this.disabledVideoTrack=void 0}if(i instanceof US&&this.videoTrack)return new pl(hy.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw();if(i instanceof Vy){if(this.audioTrack&&this.audioTrack._bypassWebAudio)throw Rc.error("One of the audio track was created with config bypassWebAudio set to true, there is no way to publish multiple audio tracks."),new pl(hy.CAN_NOT_PUBLISH_MULTIPLE_AUDIO_TRACKS);if(this.audioTrack instanceof Hy)0===this.audioTrack.trackList.length&&await this.pc.setAudioRtpEncodingParameters({active:!0}),this.audioTrack.addAudioTrack(i);else if(t.webAudioMediaStreamDest)if(i._bypassWebAudio){if(this.audioTrack)throw Rc.error("Can not publish another audio track with bypassWebAudio set to true."),new pl(hy.CAN_NOT_PUBLISH_MULTIPLE_AUDIO_TRACKS);Rc.debug("[".concat(this.connectionId,"] audio track doesn't not pass through WebAudio, use original audio track to publish")),r=await this.addTrackWithPC(i)}else{const e=new Hy;i.muted?this.suspendTracks.push(i):e.addAudioTrack(i),r=await this.addTrackWithPC(e)}else Rc.debug("[".concat(this.connectionId,"] your browser does not support mixing track, use original audio track to publish")),r=await this.addTrackWithPC(i)}else if(i instanceof US&&this.isLowStreamConnection){const e=qS({},{width:160,height:120,framerate:15,bitrate:50},{},this.lowStreamParameter);let n;if(t.supportDualStreamEncoding)Rc.debug("[".concat(this.connectionId,"] creating low stream using rtp encoding.")),this.lowStreamEncoding=rS(e,i),n=i.clone({bitrateMax:e.bitrate,bitrateMin:e.bitrate});else{Rc.debug("[".concat(this.connectionId,"] creating low stream using canvas."));const t=jE(i,e);n=new US(t,{bitrateMax:e.bitrate,bitrateMin:e.bitrate})}n._hints.push(_y.LOW_STREAM),r=await this.addTrackWithPC(n),this.bindTrackEvents(n)}else this.detecting=!0,Fa(()=>{this.detecting=!1},8e3),r=await this.addTrackWithPC(i)}await this.updateControlMessage(),r&&await this.renegotiateWithGateway(),Jr(e).call(e,e=>this.bindTrackEvents(e))}async removeTracks(e,t){const r=this.getAllTracks();e=Fp(e=ji(e).call(e,e=>-1!==Lo(r).call(r,e)||e===this.disabledVideoTrack));const i=[];for(let o=0;o<e.length;o+=1){const r=e[o];if(this.unbindTrackEvents(r),this.audioTrack instanceof Hy&&r instanceof Vy)this.audioTrack.removeAudioTrack(r),Up(this.suspendTracks,r),0===this.audioTrack.trackList.length&&(i.push(this.audioTrack),this.audioTrack=void 0);else if(r instanceof Vy)i.push(r),this.audioTrack=void 0;else if(r instanceof US){if(t){if(this.disabledVideoTrack===r)return void(this.disabledVideoTrack=void 0)}else this.disabledVideoTrack=this.videoTrack;i.push(r),this.isLowStreamConnection&&r.close(),this.videoTrack=void 0}}if(this.videoTrack||this.audioTrack){if(0===i.length)return;if("connecting"===this.connectionState)try{await this.createWaitConnectionConnectedPromise()}catch(e){return}for(const e of i){var n;Rc.debug(Je(n="[".concat(this.connectionId,"] remove ")).call(n,e.trackMediaType," from pc")),await this.pc.removeTrack(e._mediaStreamTrack);const t=ma();"Safari"===t.name&&"11"===t.version&&await e.renewMediaStreamTrack()}await this.renegotiateWithGateway()}else await this.closeP2PConnection()}async updateControlMessage(){this.audioTrack instanceof Hy&&"connected"===this.connectionState&&(this.audioTrack&&await Dp(this,ty.NEED_CONTROL,{type:"audio",muted:!this.audioTrack.isActive}),this.videoTrack&&await Dp(this,ty.NEED_CONTROL,{type:"video",muted:this.videoTrack.muted}))}async setSimulcastVideoRtpEncodingParameters(e){const t=this.pc.getSender("video");if(!t)throw new pl(hy.LOW_STREAM_ENCODING_ERROR,"Low stream has no video sender.");const r=t.getParameters();if(!r.encodings||!r.encodings[0])throw new pl(hy.LOW_STREAM_ENCODING_ERROR,"Low stream RtpEncodingParameters is empty.");if(this.videoTrack&&this.videoTrack._encoderConfig&&this.videoTrack._encoderConfig.bitrateMax&&this.videoTrack._encoderConfig.bitrateMax>200&&e.numSpatialLayers>1){const e={high:1e3*(this.videoTrack._encoderConfig.bitrateMax-50),medium:5e4};r.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:e.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:e.medium,scaleResolutionDownBy:4}]}await t.setParameters(r)}startP2PConnection(){return new fo(async(e,t)=>{if(!this.audioTrack&&!this.videoTrack)return t(new pl(hy.UNEXPECTED_ERROR,"no track to publish"));const r=i=>{if("connected"===i&&(this.off(ty.CONNECTION_STATE_CHANGE,r),e()),"disconnected"===i){if(this.off(ty.CONNECTION_STATE_CHANGE,r),this.disconnectedReason)return t(this.disconnectedReason);t(new pl(hy.OPERATION_ABORTED,"publish abort"))}};this.on(ty.CONNECTION_STATE_CHANGE,r),this.disconnectedReason=void 0,this.connectionState="connecting",this._waitingSuccessResponse=!0,this.startTime=Ma();try{var i;!this.pc.audioTrack&&this.audioTrack&&await this.pc.addTrack(this.audioTrack._mediaStreamTrack),!this.pc.videoTrack&&this.videoTrack&&await this.pc.addTrack(this.videoTrack._mediaStreamTrack),Ia()&&jc("SIMULCAST")&&this.videoTrack&&this.videoTrack._scalabiltyMode&&await this.addSimulcast4Firefox(this.videoTrack._scalabiltyMode);let e=await this.pc.createOfferSDP();jc("REMOVE_NEW_CODECS")&&(e="vp9"===this.codec?QS(e,["av1"]):"av1"===this.codec?QS(e,["vp9"]):QS(e,["vp9","av1"]));const t=function(e){const t={video:[],audio:[]};return e.match(/ VP8/i)&&t.video.push("VP8"),e.match(/ VP9/i)&&t.video.push("VP9"),e.match(/ AV1X/i)&&t.video.push("AV1"),e.match(/ H264/i)&&t.video.push("H264"),e.match(/ opus/i)&&t.audio.push("OPUS"),t}(e);if(this.videoTrack&&!is(i=t.video).call(i,this.codec.toUpperCase())&&Rc.warning("current codec is not supported, support list: ".concat(t.video.join(","))),this.audioTrack&&this.audioTrack._encoderConfig&&(e=VS(e,this.audioTrack._encoderConfig)),this.videoTrack&&!Ia()&&this.videoTrack._scalabiltyMode&&("vp9"!==this.codec&&"vp8"!==this.codec?(this.videoTrack._scalabiltyMode.numSpatialLayers=1,this.videoTrack._scalabiltyMode.numTemporalLayers=1):(this.videoTrack._scalabiltyMode.numSpatialLayers>1||this.videoTrack._scalabiltyMode.numTemporalLayers>1)&&(e=GS(e,this.codec,this.videoTrack._scalabiltyMode)),Rc.debug("spatial layers: ",this.videoTrack._scalabiltyMode.numSpatialLayers)),await this.pc.setOfferSDP(e),this.audioTrack instanceof Hy){const e={videoActive:this.videoTrack&&!this.videoTrack.muted,audioActive:this.audioTrack&&this.audioTrack.isActive};this.pc.onOfferSettled(e)}this.videoTrack&&this.setRtpSenderParametersByTrackConfig(this.videoTrack),Rc.debug("[".concat(this.connectionId,"] create and set offer success"));const r={messageType:"OFFER",sdp:e,offererSessionId:104,retry:!0};Fu().supportDualStreamEncoding&&this.isLowStreamConnection&&this.lowStreamEncoding&&this.videoTrack&&await this.setLowStreamEncoding(this.lowStreamEncoding,this.videoTrack),this.videoTrack&&!Ia()&&jc("SIMULCAST")&&this.videoTrack._scalabiltyMode&&this.setSimulcastVideoRtpEncodingParameters(this.videoTrack._scalabiltyMode);const n=await Dp(this,ty.NEED_ANSWER,r),o=this.updateAnswerSDP(n.sdp);await this.pc.setAnswerSDP(o),Rc.debug("[".concat(this.connectionId,"] set answer success")),await this.icePromise,this.connectionState="connected",this.startUploadStats()}catch(e){this.off(ty.CONNECTION_STATE_CHANGE,r),this.connectionState="disconnected",this.reportPublishEvent(!1,e.code),Rc.error("[".concat(this.connectionId,"] connection error"),e.toString()),t(e)}})}reportPublishEvent(e,t,r){var i;this._waitingSuccessResponse=!1,ky.publish(this.joinInfo.sid,{lts:this.startTime,succ:e,ec:t,audioName:this.audioTrack&&(this.audioTrack instanceof Hy?this.audioTrack.getSubTrackLabels().join(","):this.audioTrack.getTrackLabel()),videoName:this.videoTrack&&this.videoTrack.getTrackLabel(),screenshare:!(!this.videoTrack||-1===Lo(i=this.videoTrack._hints).call(i,_y.SCREEN_TRACK)),audio:!!this.audioTrack,video:!!this.videoTrack,p2pid:this.pc.ID,publishRequestid:this.ID,extend:r})}async closeP2PConnection(e){const t=this.getAllTracks();var r;Jr(t).call(t,e=>{this.unbindTrackEvents(e)}),this.isLowStreamConnection&&this.videoTrack&&this.videoTrack.close(),this.videoTrack=void 0,this.audioTrack instanceof Hy&&(Jr(r=this.audioTrack.trackList).call(r,e=>{this.audioTrack.removeAudioTrack(e)}),this.audioTrack.close()),this.audioTrack=void 0,this.stopUploadStats(),this.statsCollector.removeConnection(this.connectionId),await this.closePC(e),this.connectionState="disconnected",this.removeAllListeners()}getNetworkQuality(){var e;const t=this.pc.getStats();if(!t.videoSend[0]&&!t.audioSend[0])return 1;const r=xp(this,ty.NEED_SIGNAL_RTT),i=t.videoSend[0]?t.videoSend[0].rttMs:void 0,n=t.audioSend[0]?t.audioSend[0].rttMs:void 0,o=i&&n?(i+n)/2:i||n,s=(o&&r?(o+r)/2:o||r)||0,a=100*t.sendPacketLossRate*.7/50+.3*s/1500,c=a<.17?1:a<.36?2:a<.59?3:a<.1?4:5;if(this.videoTrack&&this.videoTrack._encoderConfig&&-1===Lo(e=this.videoTrack._hints).call(e,_y.SCREEN_TRACK)){const e=this.videoTrack._encoderConfig.bitrateMax,r=t.bitrate.actualEncoded;if(e&&r){const t=(1e3*e-r)/(1e3*e);return Zc[t<.15?0:t<.3?1:t<.45?2:t<.6?3:4][c]}}return c}handleUpdateBitrateLimit(e){this.videoTrack&&this.videoTrack.setBitrateLimit(e)}async setAudioTrackMuteState(e,t){if(!(this.audioTrack instanceof Hy))return void Rc.debug("[".concat(this.connectionId,"] set audio mute in unsupported environment"));const r=this.audioTrack;try{var i;if(e)r.removeAudioTrack(t),0===r.trackList.length&&(Rc.debug(Je(i="[".concat(this.connectionId,"] set audio encoding active, id: ")).call(i,t.getTrackId(),", state: ",!1)),await this.pc.setAudioRtpEncodingParameters({active:!1})),this.suspendTracks.push(t);else await this.pc.setAudioRtpEncodingParameters({active:!0}),r.addAudioTrack(t),Up(this.suspendTracks,t)}catch(e){var n;Rc.warning(Je(n="[".concat(this.connectionId,"] set audio muted error ")).call(n,e,", fallback to set enabled"))}await Dp(this,ty.NEED_CONTROL,{type:"audio",muted:!(!this.audioTrack||this.audioTrack.isActive)})}async setVideoTrackMuteState(e){const t=!e;let r=!1;if(ma().name===RA.FIREFOX)r=!0;else try{var i,n;Rc.debug(Je(i=Je(n="[".concat(this.connectionId,"] set video encoding active, id: ")).call(n,this.videoTrack&&this.videoTrack.getTrackId(),", state: ")).call(i,t)),await this.pc.setVideoRtpEncodingParameters({active:t})}catch(e){var o;Rc.warning(Je(o="[".concat(this.connectionId,"] set video encoding active error ")).call(o,e,", fallback to set enabled")),r=!0}var s,a;r&&this.videoTrack&&(Rc.debug(Je(s=Je(a="[".concat(this.connectionId,"] set video encoding active fallback to enabled on firefox, type: ")).call(a,this.videoTrack&&this.videoTrack.getTrackId(),", state: ")).call(s,t)),this.videoTrack.getMediaStreamTrack().enabled=t),this.lowStreamConnection&&this.lowStreamConnection.setVideoTrackMuteState(e),!this.isLowStreamConnection&&await Dp(this,ty.NEED_CONTROL,{type:"video",muted:e})}uploadStats(e,t){const r=this.audioTrack?function(e,t){const r=e.audioSend[0];if(!r)return null;const i={id:kp(10,""),timestamp:new Date(e.timestamp).toISOString(),mediaType:"audio",type:"ssrc",ssrc:r.ssrc.toString()};return i.A_astd=t._originMediaStreamTrack.enabled&&t._mediaStreamTrack.enabled?"0":"1",r.inputLevel?i.A_ail=Math.round(100*r.inputLevel).toString():i.A_ail=Math.round(100*t._source.getAccurateVolumeLevel()).toString(),i.A_apil=Math.round(100*t._source.getAccurateVolumeLevel()).toString(),i}(e,this.audioTrack):void 0,i=this.videoTrack?function(e,t){const r=e.videoSend[0];if(!r)return null;const i={id:kp(10,""),timestamp:new Date(e.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:r.ssrc.toString()};switch(i.A_vstd=t._originMediaStreamTrack&&!t._originMediaStreamTrack.enabled||!t._mediaStreamTrack.enabled?"1":"0",r.sentFrame&&(i.A_fhs=r.sentFrame.height.toString(),i.A_frs=r.sentFrame.frameRate.toString(),i.A_fws=r.sentFrame.width.toString()),r.adaptionChangeReason){case"none":i.A_ac="0";break;case"cpu":i.A_ac="1";break;case"bandwidth":i.A_ac="2";break;case"other":i.A_ac="3"}return i.A_nr=r.nacksCount.toString(),r.avgEncodeMs&&(i.A_aem=r.avgEncodeMs.toFixed(0).toString()),i}(e,this.videoTrack):void 0,n=eS(e,t),o=function(e){const t={id:"bweforvideo",timestamp:new Date(e.timestamp).toISOString(),type:"VideoBwe"};return e.bitrate.retransmit&&(t.A_rb=e.bitrate.retransmit.toString()),e.bitrate.targetEncoded&&(t.A_teb=e.bitrate.targetEncoded.toString()),t.A_aeb=e.bitrate.actualEncoded.toString(),t.A_tb=e.bitrate.transmit.toString(),void 0!==e.sendBandwidth&&(t.A_asb=e.sendBandwidth.toString()),t}(e);r&&Vp(()=>this.emit(ty.NEED_UPLOAD,XA.PUBLISH_STATS,r)),i&&Vp(()=>this.emit(ty.NEED_UPLOAD,XA.PUBLISH_STATS,qS({},i,{},n))),o&&Vp(()=>this.emit(ty.NEED_UPLOAD,XA.PUBLISH_STATS,o))}uploadSlowStats(e){const t=eS(e);t&&Vp(()=>this.emit(ty.NEED_UPLOAD,XA.PUBLISH_STATS,t))}uploadRelatedStats(e){const t=function(e){const t=e.videoSend[0];return t?{mediaType:"video",isVideoMute:!1,frameRateInput:t.inputFrame&&t.inputFrame.frameRate.toString(),frameRateSent:t.sentFrame&&t.sentFrame.frameRate.toString(),googRtt:t.rttMs.toString()}:null}(e);t&&(t.isVideoMute=!(!this.videoTrack||!this.videoTrack.muted),Vp(()=>{this.emit(ty.NEED_UPLOAD,XA.PUBLISH_RELATED_STATS,t)}))}async addSimulcast4Firefox(e){if(Ia()&&this.videoTrack&&this.videoTrack._encoderConfig&&this.videoTrack._encoderConfig.bitrateMax&&this.videoTrack._encoderConfig.bitrateMax>200&&e.numSpatialLayers>1&&"vp8"===this.codec){const e=this.pc.getSender("video");if(e){const t=e.getParameters();Rc.debug("getParameters : ",t),t||Rc.error("[".concat(this.connectionId,"] get sender parameter error."));const r={high:1e3*(this.videoTrack._encoderConfig.bitrateMax-50),medium:5e4};t.encodings=[{rid:"m",active:!0,maxBitrate:r.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:r.high}],await e.setParameters(t),Rc.debug("setParameters : ",t)}}}bindTrackEvents(e){var t;e.addListener(my.NEED_RESET_REMOTE_SDP,$o(t=this.handleResetRemoteSdp).call(t,this)),this.isLowStreamConnection||(e instanceof Vy?(e.addListener(my.GET_STATS,this.handleGetLocalAudioStats),e.addListener(my.NEED_CLOSE,this.handleCloseAudioTrack),e.addListener(my.SET_AUDIO_TRACK_MUTED,this.handleMuteAudioTrack)):e instanceof US&&(e.addListener(my.GET_STATS,this.handleGetLocalVideoStats),e.addListener(my.NEED_CLOSE,this.handleCloseVideoTrack),e.addListener(my.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),e.addListener(my.SET_VIDEO_TRACK_MUTED,this.handleMuteVideoTrack)),e.addListener(my.NEED_RENEGOTIATE,this.handleStreamRenegotiate),e.addListener(my.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.addListener(my.NEED_SESSION_ID,this.handleGetSessionID))}unbindTrackEvents(e){this.isLowStreamConnection||(e instanceof Vy?(e.off(my.GET_STATS,this.handleGetLocalAudioStats),e.off(my.NEED_CLOSE,this.handleCloseAudioTrack),e.off(my.SET_AUDIO_TRACK_MUTED,this.handleMuteAudioTrack)):e instanceof US&&(e.off(my.GET_STATS,this.handleGetLocalVideoStats),e.off(my.NEED_CLOSE,this.handleCloseVideoTrack),e.off(my.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),e.off(my.SET_VIDEO_TRACK_MUTED,this.handleMuteVideoTrack)),e.off(my.NEED_RENEGOTIATE,this.handleStreamRenegotiate),e.off(my.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(my.NEED_SESSION_ID,this.handleGetSessionID))}async addTrackWithPC(e){if("connecting"===this.connectionState)return new pl(hy.INVALID_OPERATION,"last publish operation has not finished").throw();const t=this.videoTrack;let r=!1;return this.audioTrack&&e instanceof Hy?(this.audioTrack=e,Rc.debug("[".concat(this.connectionId,"] replace pc audio track")),r=await this.pc.replaceTrack(e._mediaStreamTrack)):this.videoTrack&&e instanceof US?(this.videoTrack=e,Rc.debug("[".concat(this.connectionId,"] replace pc video track")),r=await this.pc.replaceTrack(e._mediaStreamTrack)):e instanceof Vy?(this.audioTrack=e,Rc.debug("[".concat(this.connectionId,"] add audio track to pc")),await this.pc.addTrack(e._mediaStreamTrack),r=!0):e instanceof US&&(this.videoTrack=e,Rc.debug("[".concat(this.connectionId,"] add video track to pc")),await this.pc.addTrack(e._mediaStreamTrack),r=!0),"connected"===this.connectionState&&this.videoTrack!==t&&this.videoTrack&&await this.setRtpSenderParametersByTrackConfig(this.videoTrack),"disconnected"!==this.connectionState&&r}handleResetRemoteSdp(){return new fo((e,t)=>{var r;Rc.info("[pc-".concat(this.pc.ID,"] start reset remote sdp"));const i=this.pc.getOfferSDP(),n=this.pc.getAnswerSDP();if(!n||!i)return e();const o=n.sdp;let s;this.videoTrack&&this.videoTrack._encoderConfig&&-1===Lo(r=this.videoTrack._hints).call(r,_y.SCREEN_TRACK)&&(s=function(e,t){var r,i;const n=t.bitrateMin;let o=t.bitrateMax;const s=$o(r=RegExp.prototype.test).call(r,/^([a-z])=(.*)/),a=ji(i=e.split(/(\r\n|\r|\n)/)).call(i,s);if(o){let e="AS";ma().name===ha.FIREFOX&&(o=1e3*(o>>>0),e="TIAS");const t=Lv(a).call(a,t=>is(t).call(t,e));var c;t>0&&(a[t]=Je(c="b=".concat(e,":")).call(c,o))}if(n){const e=Lv(a).call(a,e=>is(e).call(e,"x-google-min-bitrate"));e>0&&(a[e]=a[e].replace(/x-google-min-bitrate=(.*)/,"x-google-min-bitrate=".concat(n)))}return a.join("\r\n")+"\r\n"}(o,this.videoTrack._encoderConfig)),o!==s?this.pc.setOfferSDP(i.sdp).then(()=>{if(s)return this.pc.setAnswerSDP(s)}).then(e).catch(e=>{var r;Rc.error(Je(r="[pc-".concat(this.pc.ID,"] reset remote sdp error, ")).call(r,e)),t(e)}):Rc.debug("[pc-".concat(this.pc.ID,"] remote sdp have no not changed"))})}async setRtpSenderParametersByTrackConfig(e){if(!Fu().supportSetRtpSenderParameters)return void Rc.debug("[".concat(this.connectionId,"] do not support set pc rtp sender, skip"));const t={};let r="balanced";"motion"===e._optimizationMode?r="maintain-framerate":"detail"===e._optimizationMode&&(r="maintain-resolution"),Rc.debug("[".concat(this.connectionId,"] set pc rtp sender"),t,r),await this.pc.setRtpSenderParameters(t,r)}updateAnswerSDP(e){var t,r;return e=e.replace(/a=x-google-flag:conference\r\n/g,""),this.videoTrack&&Lo(t=this.videoTrack._hints).call(t,_y.SCREEN_TRACK),this.videoTrack&&this.videoTrack._encoderConfig&&-1===Lo(r=this.videoTrack._hints).call(r,_y.SCREEN_TRACK)&&(e=function(e,t,r){const i=Fu(),n=r.bitrateMin;let o=r.bitrateMax;const s=e.match(/m=video.*\r\n/)||e.match(/m=video.*\n/);if(s&&s.length>0&&i.supportMinBitrate&&n){const r=HS(e,t);if(r)if(jc("SIMULCAST")){var a,c;const t=o?.7*o:300;e=e.replace(s[0],Je(a=Je(c="".concat(s[0],"a=fmtp:")).call(c,r," x-google-start-bitrate=")).call(a,t,"\r\n"))}else{var l,u;e=e.replace(s[0],Je(l=Je(u="".concat(s[0],"a=fmtp:")).call(u,r," x-google-min-bitrate=")).call(l,n,"\r\n"))}}if(s&&s.length>0&&o){var d,h;let t="AS";ma().name===ha.FIREFOX&&(o=1e3*(o>>>0),t="TIAS"),e=e.replace(s[0],Je(d=Je(h="".concat(s[0],"b=")).call(h,t,":")).call(d,o,"\r\n"))}return e}(e,this.codec,this.videoTrack._encoderConfig)),this.audioTrack&&this.audioTrack._encoderConfig&&(e=VS(e,this.audioTrack._encoderConfig)),function(e){const t=ma();return t.name!==ha.SAFARI&&t.os!==da.IOS?e:e.replace(/a=.*video-orientation\r\n/g,"")}(e)}createPC(){this.pc=new kS({turnServer:this.joinInfo.turnServer}),this.updateICEPromise()}async closePC(e){return this.pc.onICEConnectionStateChange=void 0,this.pc.close(),!e&&await Dp(this,ty.NEED_UNPUB)}onPCDisconnected(e){this.reportPublishEvent(!1,e.code)}async setLowStreamEncoding(e,t){try{const r=await this.pc.setVideoRtpEncodingParameters(e),i=t.getMediaStreamTrack();if(e.scaleResolutionDownBy&&r.encodings[0].scaleResolutionDownBy!==e.scaleResolutionDownBy){const r=t._videoHeight||i.getSettings().height,n=t._videoWidth||i.getSettings().width;r&&n&&await i.applyConstraints({height:r/e.scaleResolutionDownBy,width:n/e.scaleResolutionDownBy})}e.maxFramerate&&r.encodings[0].maxFramerate!==e.maxFramerate&&await i.applyConstraints({frameRate:e.maxFramerate})}catch(e){if(e instanceof pl)throw e;throw new pl(hy.LOW_STREAM_ENCODING_ERROR,e.message)}}}function ZS(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function YS(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=ZS(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=ZS(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}class KS extends Py{constructor(e,t,r,i){var n,o,s;super(e,Je(n=Je(o=Je(s="track-".concat(e.kind,"-")).call(s,t,"-")).call(o,i,"_")).call(n,kp(5,""))),this._isDestroyed=!1,this._userId=t,this._uintId=r}getUserId(){return this._userId}_updateOriginMediaStreamTrack(e){this._originMediaStreamTrack=e,this._mediaStreamTrack=e,this._updatePlayerSource()}_destroy(){this._isDestroyed=!0,Rc.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}}class $S extends KS{constructor(e,t,r,i){super(e,t,r,i),this.trackMediaType="video",this.updateMediaStreamTrackResolution()}get isPlaying(){return!(!this._player||this._player.videoElementStatus!==kA.PLAYING)}getStats(){return Hp(()=>{Rc.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),xp(this,my.GET_STATS)||YS({},sy)}play(e,t={}){const r=ky.reportApiInvoke(null,{tag:GA.TRACER,name:Nl.REMOTE_VIDEO_TRACK_PLAY,options:[this.getTrackId(),"string"==typeof e?e:"HTMLElement",t]});if("string"==typeof e){const t=document.getElementById(e);var i;t?e=t:(Rc.warning(Je(i="[".concat(this.getTrackId(),'] can not find "#')).call(i,e,'" element, use document.body')),e=document.body)}Rc.debug("[".concat(this.getTrackId(),"] start video playback"),ve(t));const n=YS({fit:"cover"},t,{trackId:this.getTrackId(),element:e});this._player?this._player.updateConfig(n):(this._player=new H_(n),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.emit(Ey.FIRST_FRAME_DECODED)}),this._player.play(),r.onSuccess()}stop(){const e=ky.reportApiInvoke(null,{tag:GA.TRACER,name:Nl.REMOTE_VIDEO_TRACK_STOP,options:[this.getTrackId()]});if(!this._player)return e.onSuccess();this._player.destroy(),this._player=void 0,Rc.debug("[".concat(this.getTrackId(),"] stop video playback")),e.onSuccess()}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){Lp(this._originMediaStreamTrack).then(([e,t])=>{this._videoHeight=t,this._videoWidth=e}).catch(Np)}_updatePlayerSource(){Rc.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var e,t;const r=null==this||null===(e=this._player)||void 0===e?void 0:e.getContainerElement(),i={track:this,element:null==this||null===(t=this._player)||void 0===t?void 0:t.getVideoElement(),slot:null==r?void 0:r.parentElement},{element:n,slot:o}=i;if(this.isPlaying&&n instanceof HTMLVideoElement&&o instanceof HTMLElement){const e=Ev.checkOneElementVisible(n),t=ri({},e);return t.visible||ky.reportApiInvoke(null,{tag:GA.TRACER,name:Nl.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]}).onSuccess("Not visible because of ".concat(t.reason)),t}return}catch(e){throw new pl(ll.GET_VIDEO_ELEMENT_VISIBLE_ERROR,e.message)}}}class JS extends KS{constructor(e,t,r,i){super(e,t,r,i),this.trackMediaType="audio",this._useAudioElement=!0,this._volume=100,this._source=new Ah(e,!0),this._source.once(ry.RECEIVE_TRACK_BUFFER,()=>{this.emit(Ey.FIRST_FRAME_DECODED)})}get isPlaying(){return this._useAudioElement?Mh.isPlaying(this.getTrackId()):this._source.isPlayed}setAudioFrameCallback(e,t=4096){if(!e)return this._source.removeAllListeners(ry.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(t),this._source.removeAllListeners(ry.ON_AUDIO_BUFFER),this._source.on(ry.ON_AUDIO_BUFFER,t=>e(t))}setVolume(e){const t=ky.reportApiInvoke(null,{tag:GA.TRACER,name:Nl.REMOTE_AUDIO_SET_VOLUME,options:[this.getTrackId(),e]},300);this._volume=e,this._useAudioElement?Mh.setVolume(this.getTrackId(),e):this._source.setVolume(e/100),t.onSuccess()}async setPlaybackDevice(e){const t=ky.reportApiInvoke(null,{tag:GA.TRACER,name:Nl.REMOTE_AUDIO_SET_OUTPUT_DEVICE,options:[this.getTrackId(),e]});if(!this._useAudioElement)throw new pl(ll.NOT_SUPPORTED,"your browser does not support setting the audio output device");try{await Mh.setSinkID(this.getTrackId(),e)}catch(e){throw t.onError(e),e}t.onSuccess()}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return Hp(()=>{Rc.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),xp(this,my.GET_STATS)||YS({},oy)}play(){const e=ky.reportApiInvoke(null,{tag:GA.TRACER,name:Nl.REMOTE_AUDIO_TRACK_PLAY,options:[this.getTrackId()]});Rc.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(Rc.debug("[".concat(this.getTrackId(),"] use audio element to play")),Mh.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play(),e.onSuccess()}stop(){const e=ky.reportApiInvoke(null,{tag:GA.TRACER,name:Nl.REMOTE_AUDIO_TRACK_STOP,options:[this.getTrackId()]});Rc.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?Mh.stop(this.getTrackId()):this._source.stop(),e.onSuccess()}_destroy(){super._destroy(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){Rc.debug("[".concat(this.getTrackId(),"] update player source track")),this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&Mh.updateTrack(this.getTrackId(),this._mediaStreamTrack)}}class XS extends PS{constructor(e,t,r,i){super(r,e.uid),this.type="sub",this.unusedTracks=[],this.onTrack=e=>{var t,r;if("audio"===e.kind&&!this.subscribeOptions.audio||"video"===e.kind&&!this.subscribeOptions.video)return this.unusedTracks.push(e),void Rc.debug(Je(r="[".concat(this.connectionId,"] unused ontrack event, kind: ")).call(r,e.kind));Rc.debug(Je(t="[".concat(this.connectionId,"] emit pc ontrack after subscribe ")).call(t,e.kind),e);const i="audio"===e.kind?this.user._audioTrack:this.user._videoTrack;var n,o;i?i._updateOriginMediaStreamTrack(e):"audio"===e.kind?(this.pc._statsFilter.setIsFirstAudioDecoded(!1),this.user._audioTrack=new JS(e,this.getUserId(),this.user._uintid,this.joinInfo.clientId),Rc.info(Je(n="[".concat(this.connectionId,"] create remote audio track: ")).call(n,this.user._audioTrack.getTrackId())),this.bindTrackEvents(this.user._audioTrack)):(this.user._videoTrack=new $S(e,this.getUserId(),this.user._uintid,this.joinInfo.clientId),Rc.info(Je(o="[".concat(this.connectionId,"] create remote video track: ")).call(o,this.user._videoTrack.getTrackId())),this.bindTrackEvents(this.user._videoTrack))},this.handleGetRemoteAudioStats=e=>{e(this.statsCollector.getRemoteAudioTrackStats(this.connectionId))},this.handleGetRemoteVideoStats=e=>{e(this.statsCollector.getRemoteVideoTrackStats(this.connectionId))},this.handleGetSessionID=e=>{e(this.joinInfo.sid)},this.user=e,this.statsCollector=t,this.statsCollector.addRemoteConnection(this),this.subscribeOptions=i}async startP2PConnection(){return new fo(async(e,t)=>{const r=i=>{if("connected"===i&&(ky.subscribe(this.joinInfo.sid,{lts:this.startTime,succ:!0,video:this.subscribeOptions.video,audio:this.subscribeOptions.audio,peerid:this.user.uid,ec:null,subscribeRequestid:this.ID,p2pid:this.pc.ID}),this.off(ty.CONNECTION_STATE_CHANGE,r),e()),"disconnected"===i){if(this.off(ty.CONNECTION_STATE_CHANGE,r),this.disconnectedReason)return t(this.disconnectedReason);t(new pl(ll.OPERATION_ABORTED,"subscribe abort"))}};if(this.on(ty.CONNECTION_STATE_CHANGE,r),this.disconnectedReason=void 0,this.connectionState="connecting",this.startTime=Ma(),!this.subscribeOptions)return void t(new pl(ll.UNEXPECTED_ERROR,"no subscribe options"));const i=new MediaStream,n=new fo(e=>{this.pc.onTrack=(t,r)=>{var n,o;if("audio"===t.kind&&!this.subscribeOptions.audio||"video"===t.kind&&!this.subscribeOptions.video)return this.unusedTracks.push(t),void Rc.debug(Je(o="[".concat(this.connectionId,"] unused ontrack event ")).call(o,t.kind));i.addTrack(t);const s={audio:i.getAudioTracks().length>0,video:i.getVideoTracks().length>0};Rc.debug(Je(n="[".concat(this.connectionId,"] subscribe ontrack: ")).call(n,t.kind),r,t),function(e,t){var r,i;const n=cl(r=ni(e)).call(r),o=cl(i=ni(t)).call(i);for(let s=0;s<n.length;s+=1){if(n[s]!==o[s])return!1;if(e[n[s]]!==t[n[s]])return!1}return!0}(s,this.subscribeOptions)&&(this.pc.onTrack=this.onTrack,Rc.debug("[".concat(this.connectionId,"] get all subscribed tracks")),e(i))}});try{const e=function(e){return ma().name!==ha.FIREFOX?e:e.replace("/recvonly http://www.webrtc.org/experiments/rtp-hdrext/playout-delay"," http://www.webrtc.org/experiments/rtp-hdrext/playout-delay")}(jS(await this.pc.createOfferSDP()));await this.pc.setOfferSDP(e),Rc.debug("[".concat(this.connectionId,"] create and set offer success"));const t={messageType:"OFFER",sdp:e,offererSessionId:104,retry:!0},r=await Dp(this,ty.NEED_ANSWER,t);await this.pc.setAnswerSDP(jS(r.sdp)),Rc.debug("[".concat(this.connectionId,"] set answer success"));const i=await fo.all([n,this.icePromise]),a=i[0].getAudioTracks()[0],c=i[0].getVideoTracks()[0];var o,s;a&&(this.user._audioTrack?this.user._audioTrack._updateOriginMediaStreamTrack(a):(this.user._audioTrack=new JS(a,this.getUserId(),this.user._uintid,this.joinInfo.clientId),Rc.info(Je(o="[".concat(this.connectionId,"] create remote audio track: ")).call(o,this.user._audioTrack.getTrackId())),this.bindTrackEvents(this.user._audioTrack))),c&&(this.user._videoTrack?this.user._videoTrack._updateOriginMediaStreamTrack(c):(this.user._videoTrack=new $S(c,this.getUserId(),this.user._uintid,this.joinInfo.clientId),Rc.info(Je(s="[".concat(this.connectionId,"] create remote video track: ")).call(s,this.user._videoTrack.getTrackId())),this.bindTrackEvents(this.user._videoTrack))),this.connectionState="connected",this.startUploadStats()}catch(e){this.off(ty.CONNECTION_STATE_CHANGE,r),this.connectionState="disconnected",ky.subscribe(this.joinInfo.sid,{lts:this.startTime,succ:!1,video:this.subscribeOptions.video,audio:this.subscribeOptions.audio,peerid:this.user.uid,ec:e.code,subscribeRequestid:this.ID,p2pid:this.pc.ID}),t(e)}})}async closeP2PConnection(e){"disconnected"!==this.connectionState&&(this.stopUploadStats(),this.statsCollector.removeConnection(this.connectionId),this.connectionState="disconnected",await this.setSubscribeOptions({audio:!1,video:!1}),await this.closePC(e),this.removeAllListeners())}getNetworkQuality(){const e=this.pc.getStats();if(!e.audioRecv[0]&&!e.videoRecv[0])return 1;const t=xp(this,ty.NEED_SIGNAL_RTT),r=e.rtt,i=(r&&t?(r+t)/2:r||t)||0,n=e.audioRecv[0]?e.audioRecv[0].jitterMs:void 0,o=e.recvPacketLossRate;let s=.7*o*100/50+.3*i/1500;return n&&(s=.6*o*100/50+.2*i/1500+.2*n/400),s<.1?1:s<.17?2:s<.36?3:s<.59?4:5}uploadStats(e){const t=this.user.audioTrack?function(e,t){const r=e.audioRecv[0];if(!r)return null;const i={id:kp(10,""),timestamp:new Date(e.timestamp).toISOString(),mediaType:"audio",type:"ssrc",ssrc:r.ssrc.toString()};return i.bytesReceived=r.bytes.toString(),i.packetsLost=r.packetsLost.toString(),i.packetsReceived=r.packets.toString(),r.outputLevel?i.A_aol=Math.round(100*r.outputLevel).toString():i.A_aol=Math.round(100*t._source.getAccurateVolumeLevel()).toString(),i.A_apol=Math.round(100*t._source.getAccurateVolumeLevel()).toString(),t&&(i.A_artd=t._originMediaStreamTrack.enabled&&t._mediaStreamTrack.enabled?"0":"1"),i.A_jr=r.jitterMs.toString(),i.A_jbm=Math.floor(r.jitterBufferMs).toString(),i.A_cdm=Math.floor(r.jitterBufferMs).toString(),i}(e,this.user.audioTrack):void 0,r=this.user.videoTrack?function(e,t){const r=e.videoRecv[0];if(!r)return null;const i={id:kp(10,""),timestamp:new Date(e.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:r.ssrc.toString()};var n;return i.bytesReceived=r.bytes.toString(),i.packetsLost=r.packetsLost.toString(),i.packetsReceived=r.packets.toString(),r.framesRateFirefox&&(i.A_frr=r.framesRateFirefox.toString()),r.receivedFrame&&(i.A_frr=r.receivedFrame.frameRate.toString()),i.A_frd=r.decodeFrameRate.toString(),r.outputFrame&&(i.A_fro=r.outputFrame.frameRate.toString()),void 0!==r.jitterBufferMs&&(i.A_jbm=Math.floor(r.jitterBufferMs).toString()),void 0!==r.currentDelayMs&&(i.A_cdm=Math.floor(r.currentDelayMs).toString()),i.A_fs=r.firsCount.toString(),i.A_ns=r.nacksCount.toString(),i.A_ps=r.plisCount.toString(),t&&(i.A_vrtd=t._originMediaStreamTrack.enabled&&t._mediaStreamTrack.enabled?"0":"1"),t._player&&t._player.freezeTimeCounterList.length>0&&(i.A_vrft=bo(n=t._player.freezeTimeCounterList).call(n,0,1)[0].toString()),i}(e,this.user.videoTrack):void 0;t&&Vp(()=>this.emit(ty.NEED_UPLOAD,XA.SUBSCRIBE_STATS,t)),r&&Vp(()=>this.emit(ty.NEED_UPLOAD,XA.SUBSCRIBE_STATS,r))}uploadSlowStats(e){}uploadRelatedStats(e,t){const r=!0===this.pc._statsFilter.videoIsReady,i=function(e,t,r){const i=e.audioRecv[0];if(!i)return null;const n=Zy.isRemoteAudioFreeze(r);return{mediaType:"audio",isAudioMute:!1,peerId:t,googJitterReceived:i.jitterMs.toString(),isFreeze:n,bytesReceived:i.bytes.toString(),packetsReceived:i.packets.toString(),packetsLost:i.packetsLost.toString(),frameReceived:i.receivedFrames.toString(),frameDropped:i.droppedFrames.toString()}}(e,this.getUserId(),this.user.audioTrack),n=function(e,t,r,i,n){const o=t.videoRecv[0],s=i?i.videoRecv[0]:void 0;if(!o)return null;const a=Zy.isRemoteVideoFreeze(n,o,s)&&e,c={mediaType:"video",isVideoMute:!1,peerId:r,frameRateReceived:o.receivedFrame&&o.receivedFrame.frameRate.toString(),frameRateDecoded:o.decodedFrame&&o.decodedFrame.frameRate.toString(),isFreeze:a,bytesReceived:o.bytes.toString(),packetsReceived:o.packets.toString(),packetsLost:o.packetsLost.toString()};return o.framesRateFirefox&&(c.frameRateDecoded=o.framesRateFirefox.toString(),c.frameRateReceived=o.framesRateFirefox.toString()),c}(r,e,this.getUserId(),t,this.user.videoTrack);i&&Vp(()=>{this.emit(ty.NEED_UPLOAD,XA.SUBSCRIBE_RELATED_STATS,i)}),n&&Vp(()=>{this.emit(ty.NEED_UPLOAD,XA.SUBSCRIBE_RELATED_STATS,n)})}emitOnTrackFromUnusedTracks(){if(!this.subscribeOptions)return;const e=this.subscribeOptions.video;if(this.subscribeOptions.audio){var t;const e=Qo(t=this.unusedTracks).call(t,e=>"audio"===e.kind&&"live"===e.readyState);Up(this.unusedTracks,e),e&&this.onTrack(e)}if(e){var r;const e=Qo(r=this.unusedTracks).call(r,e=>"video"===e.kind&&"live"===e.readyState);Up(this.unusedTracks,e),e&&this.onTrack(e)}}async setSubscribeOptions(e){var t,r,i,n;if(e.audio!==this.subscribeOptions.audio||e.video!==this.subscribeOptions.video){if("connecting"===this.connectionState)try{await this.createWaitConnectionConnectedPromise()}catch(e){throw new pl(ll.OPERATION_ABORTED,"can not update subscribe options, operation abort")}e.audio===this.subscribeOptions.audio&&e.video===this.subscribeOptions.video||(Rc.debug(Je(t=Je(r=Je(i=Je(n="[".concat(this.connectionId,"] update subscribe options [a: ")).call(n,this.subscribeOptions.audio,", v: ")).call(i,this.subscribeOptions.video,"] -> [a: ")).call(r,e.audio,", v: ")).call(t,e.video,"]")),this.subscribeOptions=e,!e.audio&&this.user._audioTrack&&(this.unusedTracks.push(this.user._audioTrack._originMediaStreamTrack),this.user._audioTrack._destroy(),this.unbindTrackEvents(this.user._audioTrack),this.user._audioTrack=void 0),!e.video&&this.user._videoTrack&&(this.unusedTracks.push(this.user._videoTrack._originMediaStreamTrack),this.user._videoTrack._destroy(),this.unbindTrackEvents(this.user._videoTrack),this.user._videoTrack=void 0),this.emitOnTrackFromUnusedTracks())}}createPC(){this.pc=new OS({turnServer:this.joinInfo.turnServer}),this.pc.onFirstAudioDecoded=()=>{this.user.audioTrack&&this.user.audioTrack.emit(Ey.FIRST_FRAME_DECODED),ky.firstRemoteFrame(this.joinInfo.sid,UA.FIRST_AUDIO_DECODE,FA.FIRST_AUDIO_DECODE,{peer:this.user._uintid,subscribeElapse:Ma()-this.startTime,subscribeRequestid:this.ID,p2pid:this.pc.ID})},this.pc.onFirstAudioReceived=()=>{ky.firstRemoteFrame(this.joinInfo.sid,UA.FIRST_AUDIO_RECEIVED,FA.FIRST_AUDIO_RECEIVED,{peer:this.user._uintid,subscribeElapse:Ma()-this.startTime,subscribeRequestid:this.ID,p2pid:this.pc.ID})},this.pc.onFirstVideoDecoded=(e,t)=>{ky.firstRemoteFrame(this.joinInfo.sid,UA.FIRST_VIDEO_DECODE,FA.FIRST_VIDEO_DECODE,{peer:this.user._uintid,videowidth:e,videoheight:t,subscribeElapse:Ma()-this.startTime,subscribeRequestid:this.ID,p2pid:this.pc.ID})},this.pc.onFirstVideoReceived=()=>{ky.firstRemoteFrame(this.joinInfo.sid,UA.FIRST_VIDEO_RECEIVED,FA.FIRST_VIDEO_RECEIVED,{peer:this.user._uintid,subscribeElapse:Ma()-this.startTime,subscribeRequestid:this.ID,p2pid:this.pc.ID})},this.updateICEPromise()}async closePC(e){return this.pc.audioTrack&&this.pc.audioTrack.stop(),this.pc.videoTrack&&this.pc.videoTrack.stop(),this.pc.onTrack=void 0,this.pc.onICEConnectionStateChange=void 0,this.pc.close(),!e&&await Dp(this,ty.NEED_UNSUB)}onPCDisconnected(e){ky.subscribe(this.joinInfo.sid,{lts:this.startTime,succ:!1,video:this.subscribeOptions.video,audio:this.subscribeOptions.audio,peerid:this.user.uid,ec:e.code,subscribeRequestid:this.ID,p2pid:this.pc.ID})}bindTrackEvents(e){e instanceof JS?e.addListener(my.GET_STATS,this.handleGetRemoteAudioStats):e instanceof $S&&e.addListener(my.GET_STATS,this.handleGetRemoteVideoStats)}unbindTrackEvents(e){e instanceof JS?e.off(my.GET_STATS,this.handleGetRemoteAudioStats):e instanceof $S&&e.off(my.GET_STATS,this.handleGetRemoteVideoStats)}}class eC{constructor(e,t){this._trust_in_room_=!0,this._trust_audio_enabled_state_=!0,this._trust_video_enabled_state_=!0,this._trust_audio_mute_state_=!0,this._trust_video_mute_state_=!0,this._trust_stream_added_state_=!0,this._audio_muted_=!1,this._video_muted_=!1,this._audio_enabled_=!0,this._video_enabled_=!0,this._audio_added_=!1,this._video_added_=!1,this.uid=e,this._uintid=t}get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio)return this._audioTrack}get videoTrack(){if(this.hasVideo)return this._videoTrack}}function tC(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function rC(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=tC(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=tC(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}var iC=function(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Bi(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&di(t,r,s),s},nC=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class oC extends Mu{constructor(e){var t,r,i,n;let o;if(super(),this._users=[],this._sessionId=null,this._bindEnabledTracks=[],this._leaveMutex=new ah("client-leave"),this._publishMutex=new ah("client-publish"),this._subscribeMutex=new Mr,this._remoteStream=new Mr,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._turnServer={servers:[],mode:"auto"},this._cloudProxyServerMode="disabled",this._isDualStreamEnabled=!1,this._streamFallbackTypeCacheMap=new Mr,this._remoteStreamTypeCacheMap=new Mr,this._axiosCancelSource=Sc.CancelToken.source(),this._networkQualitySensitivity="normal",this._useLocalAccessPoint=!1,this._handleLocalTrackEnable=(e,t,r)=>{this.publish(e,!1).then(t).catch(r)},this._handleLocalTrackDisable=(e,t,r)=>{this.unpublish(e,!1).then(t).catch(r)},this._handleUserOnline=e=>{var t;this.isStringUID&&"string"!=typeof e.uid&&Rc.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));const r=Qo(t=this._users).call(t,t=>t.uid===e.uid);if(r)r._trust_in_room_=!0;else{const t=new eC(e.uid,e.uint_id||e.uid);this._users.push(t),Rc.debug("[".concat(this._clientId,"] user online"),e.uid),this.emit(TA.USER_JOINED,t)}},this._handleUserOffline=e=>{var t;const r=Qo(t=this._users).call(t,t=>t.uid===e.uid);r&&(this._handleRemoveStream(e),Up(this._users,r),this._remoteStreamTypeCacheMap.delete(r.uid),this._streamFallbackTypeCacheMap.delete(r.uid),Rc.debug("[".concat(this._clientId,"] user offline"),e.uid,"reason:",e.reason),this.emit(TA.USER_LEAVED,r,e.reason))},this._handleAddAudioOrVideoStream=(e,t,r)=>{var i,n,o;const s=Qo(i=this._users).call(i,e=>e.uid===t);if(!s)return void Rc.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));Rc.debug(Je(n=Je(o="[".concat(this._clientId,"] stream added with uid ")).call(o,t,", type ")).call(n,e));const a="audio"===e?s.hasAudio:s.hasVideo;var c,l;s._uintid||(s._uintid=r||t),s._trust_stream_added_state_=!0,"audio"===e?s._audio_added_=!0:s._video_added_=!0,("audio"===e?s.hasAudio:s.hasVideo)&&!a&&(Rc.info(Je(c=Je(l="[".concat(this._clientId,"] remote user ")).call(l,s.uid," published ")).call(c,e)),this.emit(TA.USER_PUBLISHED,s,e)),"video"===e?ky.onGatewayStream(this._sessionId,UA.ON_ADD_VIDEO_STREAM,FA.ON_ADD_VIDEO_STREAM,{peer:r||t}):ky.onGatewayStream(this._sessionId,UA.ON_ADD_AUDIO_STREAM,FA.ON_ADD_AUDIO_STREAM,{peer:r||t});const u=this._remoteStream.get(t);u&&u.readyToReconnect&&"connecting"===u.connectionState&&u.reconnectPC().catch(e=>{Rc.error("[".concat(this._clientId,"] resubscribe error"),e.toString())})},this._handleRemoveStream=e=>{var t,r;const i=Qo(t=this._users).call(t,t=>t.uid===e.uid);if(!i)return void Rc.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));Rc.debug(Je(r="[".concat(this._clientId,"] stream removed with uid ")).call(r,e.uid));let n=()=>{};i.hasAudio&&i.hasVideo?n=()=>{var e,t;Rc.info(Je(e="[".concat(this._clientId,"] remote user ")).call(e,i.uid," unpublished audio track")),this.emit(TA.USER_UNPUBLISHED,i,"audio"),Rc.info(Je(t="[".concat(this._clientId,"] remote user ")).call(t,i.uid," unpublished video track")),this.emit(TA.USER_UNPUBLISHED,i,"video")}:i.hasVideo?n=()=>{var e;Rc.info(Je(e="[".concat(this._clientId,"] remote user ")).call(e,i.uid," unpublished video track")),this.emit(TA.USER_UNPUBLISHED,i,"video")}:i.hasAudio&&(n=()=>{var e;Rc.info(Je(e="[".concat(this._clientId,"] remote user ")).call(e,i.uid," unpublished audio track")),this.emit(TA.USER_UNPUBLISHED,i,"audio")}),i._trust_stream_added_state_=!0,i._audio_added_=!1,i._video_added_=!1;const o=this._remoteStream.get(i.uid);o&&(o.closeP2PConnection(),this._remoteStream.delete(i.uid)),ky.onGatewayStream(this._sessionId,UA.ON_REMOVE_STREAM,FA.ON_REMOVE_STREAM,{peer:e.uint_id||e.uid}),n()},this._handleSetStreamLocalEnable=(e,t,r)=>{var i,n,o,s,a,c;const l=Qo(i=this._users).call(i,e=>e.uid===t);if(!l)return void Rc.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));Rc.debug(Je(n=Je(o=Je(s="[".concat(this._clientId,"] local ")).call(s,e," ")).call(o,r?"enabled":"disabled"," with uid ")).call(n,t));const u="audio"===e?l.hasAudio:l.hasVideo;if("audio"===e){l._trust_audio_enabled_state_=!0;const e=l._audio_enabled_;if(l._audio_enabled_=r,l._audio_enabled_===e)return;{var d,h;const e=l._audio_enabled_?"enable-local-audio":"disable-local-audio";Rc.debug(Je(d=Je(h="[".concat(this._clientId,"] user-info-updated, uid: ")).call(h,t,", msg: ")).call(d,e)),this.emit(TA.USER_INFO_UPDATED,t,e)}}else{l._trust_video_enabled_state_=!0;const e=l._video_enabled_;if(l._video_enabled_=r,l._video_enabled_===e)return;{var p,f;const e=l._video_enabled_?"enable-local-video":"disable-local-video";Rc.debug(Je(p=Je(f="[".concat(this._clientId,"] user-info-update, uid: ")).call(f,t,", msg: ")).call(p,e)),this.emit(TA.USER_INFO_UPDATED,t,e)}}const g="audio"===e?l.hasAudio:l.hasVideo;if(u===g)return;var m,_;if(!u&&g)return Rc.info(Je(m=Je(_="[".concat(this._clientId,"] remote user ")).call(_,t," published ")).call(m,e)),void this.emit(TA.USER_PUBLISHED,l,e);const v=this._remoteStream.get(t);if(v){const e=rC({},v.subscribeOptions);e.audio=!!l.hasAudio&&e.audio,e.video=!!l.hasVideo&&e.video,e.audio||e.video?v.setSubscribeOptions(e):(v.closeP2PConnection().catch(e=>{Rc.warning("close sub pc error",e)}),this._remoteStream.delete(l.uid))}Rc.info(Je(a=Je(c="[".concat(this._clientId,"] remote user ")).call(c,l.uid," unpublished ")).call(a,e)),this.emit(TA.USER_UNPUBLISHED,l,e)},this._handleMuteStream=(e,t,r)=>{var i,n,o;Rc.debug("[".concat(this._clientId,"] receive mute message"),e,t,r);const s=Qo(i=this._users).call(i,t=>t.uid===e);var a;if(!s)return void Rc.warning(Je(a="[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ")).call(a,e));const c="audio"===t?s.hasAudio:s.hasVideo;if("audio"===t){s._trust_audio_mute_state_=!0;const t=s._audio_muted_;if(s._audio_muted_=r,s._audio_muted_===t)return;{var l,u;const t=s._audio_muted_?"mute-audio":"unmute-audio";Rc.debug(Je(l=Je(u="[".concat(this._clientId,"] user-info-update, uid: ")).call(u,e,", msg: ")).call(l,t)),this.emit(TA.USER_INFO_UPDATED,e,t)}}else{s._trust_video_mute_state_=!0;const t=s._video_muted_;if(s._video_muted_=r,s._video_muted_===t)return;{var d,h;const t=s._video_muted_?"mute-video":"unmute-video";Rc.debug(Je(d=Je(h="[".concat(this._clientId,"] user-info-update, uid: ")).call(h,e,", msg: ")).call(d,t)),this.emit(TA.USER_INFO_UPDATED,e,t)}}const p="audio"===t?s.hasAudio:s.hasVideo;if(c===p)return;var f,g;if(!c&&p)return Rc.info(Je(f=Je(g="[".concat(this._clientId,"] remote user ")).call(g,e," published ")).call(f,t)),void this.emit(TA.USER_PUBLISHED,s,t);const m=this._remoteStream.get(e);if(m){const e=rC({},m.subscribeOptions);e.audio=!!s.hasAudio&&e.audio,e.video=!!s.hasVideo&&e.video,"video"===t&&m.pc._statsFilter.setVideoIsReady(!1),e.audio||e.video?m.setSubscribeOptions(e):(m.closeP2PConnection().catch(e=>{Rc.warning("close sub pc error",e)}),this._remoteStream.delete(s.uid))}Rc.info(Je(n=Je(o="[".concat(this._clientId,"] remote user ")).call(o,e," unpublished ")).call(n,t)),this.emit(TA.USER_UNPUBLISHED,s,t)},this._handleP2PLost=e=>{Rc.debug("[".concat(this._clientId,"] receive p2p lost"),e);let t=null;if(this._highStream&&this._highStream.pc.ID===e.p2pid)t=this._highStream;else if(this._lowStream&&this._lowStream.pc.ID===e.p2pid)t=this._lowStream;else{var r;Jr(r=this._remoteStream).call(r,r=>{r.pc.ID===e.p2pid&&(t=r)})}t?t.emit(ty.GATEWAY_P2P_LOST,e.p2pid):Rc.warning("P2PLost stream not found",e)},this._handleTokenWillExpire=()=>{Rc.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.emit(TA.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)},this._handleBeforeUnload=e=>{void 0!==e.returnValue&&""!==e.returnValue||(this.leave(),Rc.info("[".concat(this._clientId,"] auto leave onbeforeunload")))},this._handleUpdateNetworkQuality=()=>{var e;if("normal"===this._networkQualitySensitivity)return;if(navigator&&void 0!==navigator.onLine&&!navigator.onLine)return void this.emit(TA.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const t={downlinkNetworkQuality:0,uplinkNetworkQuality:0};this._highStream&&!this._highStream.detecting&&(t.uplinkNetworkQuality=this._highStream.getNetworkQuality());let r=0;Jr(e=this._remoteStream).call(e,e=>r+=e.getNetworkQuality()),this._remoteStream.size>0&&(t.downlinkNetworkQuality=Math.round(r/this._remoteStream.size)),this.emit(TA.NETWORK_QUALITY,t)},this._codec=e.codec,this._mode=e.mode,e.proxyServer&&(this._proxyServer=e.proxyServer,ky.setProxyServer(this._proxyServer),Rc.setProxyServer(this._proxyServer)),e.turnServer&&(this._turnServer=rC({},this._turnServer,{mode:"manual"},e.turnServer)),this._clientId=kp(5,"client-"),Rc.info(Je(t=Je(r=Je(i=Je(n="[".concat(this._clientId,"] Initializing AgoraRTC client v")).call(n,kc," build: ")).call(i,wc,", mode: ")).call(r,this._mode,", codec: ")).call(t,this._codec)),this._performanceRecorder=AA(this._clientId,"join"),e.clientRoleOptions)try{MA(e.clientRoleOptions),o=ri({},e.clientRoleOptions)}catch(e){var s;Rc.warning(Je(s="[".concat(this._clientId,"] ")).call(s,e.toString()))}this._statsCollector=new Zy(this._clientId),this._statsCollector.onStatsException=(e,t,r)=>{var i,n,o;Rc.debug(Je(i=Je(n=Je(o="[".concat(this._clientId,"] receive exception msg, code: ")).call(o,e,", msg: ")).call(n,t,", uid: ")).call(i,r)),this.emit(TA.EXCEPTION,{code:e,msg:t,uid:r})},this._statsCollector.onUploadPublishDuration=(e,t,r,i)=>{var n;const o=Qo(n=this._users).call(n,t=>t.uid===e);o&&ky.peerPublishStatus(this._sessionId,{subscribeElapse:i,audioPublishDuration:t,videoPublishDuration:r,peer:o._uintid})},this._gateway=new cS({clientId:this._clientId,mode:this._mode,codec:this._codec,websocketRetryConfig:e.websocketRetryConfig||Zd,httpRetryConfig:e.httpRetryConfig||Zd,forceWaitGatewayResponse:void 0===e.forceWaitGatewayResponse||e.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:e.role,clientRoleOptions:o}),this._config=e,this._configDistribute=new L_,this._handleGatewayEvents()}get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._highStream?this._highStream.getAllTracks():[]}get uid(){return this._uid}get channelName(){return this._channelName}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}async join(e,t,r,i,n){var o;this._performanceRecorder.checkPoint("startJoin");const s=mA(),a=_A()?window.isSecureContext:"Browser Not Support",c=()=>{Rc.warning("The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser")};_A()?window.isSecureContext||c():s||c();const l=ky.reportApiInvoke(this._sessionId,{name:jA.JOIN,options:[e,t,r,i],states:{isHttps:s,isSecureContext:a},tag:GA.TRACER});try{if(!r&&null!==r)throw new pl(ll.INVALID_PARAMS,"Invalid token: ".concat(r,". If you don not use token, set it to null"));r&&_l(r,"token",1,2047),_l(e,"appid",1,2047),El(t),i&&Al(i),n&&_l(n,"optionalInfo",1,2047)}catch(e){throw l.onError(e),e}if(Rc.info(Je(o="[".concat(this._clientId,"] start join channel ")).call(o,t)),this._leaveMutex.isLocked&&(Rc.debug("[".concat(this._clientId,"] join: waiting leave operation")),(await this._leaveMutex.lock())(),Rc.debug("[".concat(this._clientId,"] join: continue"))),"DISCONNECTED"!==this.connectionState){const e=new pl(ll.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw l.onError(e),e}this._sessionId||(this._sessionId=Op()),this._gateway.state="CONNECTING";const u={clientId:this._clientId,appId:e,sid:this._sessionId,cname:t,uid:"string"!=typeof i?i:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:r||e,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:n,useLocalAccessPoint:this._useLocalAccessPoint};"string"==typeof i&&(u.stringUid=i,this._uintUid?(u.uid=this._uintUid,this._uintUid=void 0):u.uid=0),"none"!==this._encryptionMode&&this._encryptionSecret&&(u.aesmode=this._encryptionMode,u.aespassword=await ap(this._encryptionSecret),this._encryptionSalt&&(u.aessalt=this._encryptionSalt)),this._startSession(this._sessionId,{channel:t,appId:e}),Fa(()=>{"CONNECTING"===this.connectionState&&ky.joinChannelTimeout(this._sessionId,5)},5e3);try{var d;let i;if("443only"===u.cloudProxyServer)u.proxyServer=jc("PROXY_SERVER_TYPE2");else if("proxy3"===u.cloudProxyServer||"proxy4"===u.cloudProxyServer||"proxy5"===u.cloudProxyServer){const e=jc("PROXY_SERVER_TYPE3");hl(e)?u.proxyServer=e[0]:u.proxyServer=e}if(ky.setProxyServer(u.proxyServer),Rc.setProxyServer(u.proxyServer),this._performanceRecorder.checkPoint("startRequestAp"),u.stringUid&&!u.uid&&"normal"===u.cloudProxyServer){var h;await vS(u,this._axiosCancelSource.token,this._config.httpRetryConfig||Zd,!1);const e=await ES(u.stringUid,u,this._axiosCancelSource.token,this._config.httpRetryConfig||Zd);Rc.debug(Je(h="getUserAccount Success ".concat(u.stringUid," => ")).call(h,e)),u.uid=e,i=await _S(u,this._axiosCancelSource.token,this._config.httpRetryConfig||Zd)}else if(u.stringUid&&!u.uid){var p;const e=await ES(u.stringUid,u,this._axiosCancelSource.token,this._config.httpRetryConfig||Zd);Rc.debug(Je(p="getUserAccount Success ".concat(u.stringUid," => ")).call(p,e)),u.uid=e,i=await vS(u,this._axiosCancelSource.token,this._config.httpRetryConfig||Zd,!0)}else i=await vS(u,this._axiosCancelSource.token,this._config.httpRetryConfig||Zd,!0);this._performanceRecorder.checkPoint("startJoinGateway"),this._configDistribute.startGetConfigDistribute(u,this._axiosCancelSource.token),this._configDistribute.on(Sy.UPDATE_BITRATE_LIMIT,e=>{this._highStream&&this._highStream.handleUpdateBitrateLimit(e.uplink),e.low_stream_uplink&&this._lowStream&&this._lowStream.handleUpdateBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0})}),this._key=r||e,this._joinInfo=rC({},u,{cid:i.gatewayInfo.cid,uid:u.uid?u.uid:i.gatewayInfo.uid,vid:i.gatewayInfo.vid,apResponse:i.gatewayInfo.res,uni_lbs_ip:i.gatewayInfo.uni_lbs_ip,gatewayAddrs:i.gatewayInfo.gatewayAddrs});const n=await this._gateway.join(this._joinInfo,this._key);return l.onSuccess(n),this._appId=e,this._channelName=u.cname,this._uid=n,this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener("beforeunload",this._handleBeforeUnload),Rc.info(Je(d="[".concat(this._clientId,"] Joining channel success: ")).call(d,t)),Fa(()=>{Rc.startUpload()},5e3),this._performanceRecorder.checkPoint("finishJoin"),$c(this),n}catch(e){const t=hl(e)?e[0]:e;throw Rc.error("[".concat(this._clientId,"] Joining channel failed, rollback"),t),t.code!==ll.OPERATION_ABORTED&&(this._gateway.state="DISCONNECTED",this._reset()),l.onError(t),t}}async leave(){const e=ky.reportApiInvoke(this._sessionId,{name:jA.LEAVE,options:[],tag:GA.TRACER});Rc.info("[".concat(this._clientId,"] Leaving channel")),window.removeEventListener("beforeunload",this._handleBeforeUnload),this._reset(),Jc(this);const t=await this._leaveMutex.lock();if("DISCONNECTED"===this.connectionState)return Rc.info("[".concat(this._clientId,"] Leaving channel repeated, success")),t(),e.onSuccess();await this._gateway.leave("CONNECTED"!==this.connectionState),Rc.info("[".concat(this._clientId,"] Leaving channel success")),t(),e.onSuccess()}async publish(e,t=!0){var r,i;hl(e)||(e=[e]);const n=ky.reportApiInvoke(this._sessionId,{name:jA.PUBLISH,options:vo(e).call(e,e=>e?Object(e).toString():"null"),tag:GA.TRACER});if(0===e.length){const e=new pl(ll.INVALID_PARAMS,"track list is empty");return n.onError(e),e.throw()}if("audience"===this._gateway.role){const e=new pl(ll.INVALID_OPERATION,"audience can not publish stream");return n.onError(e),e.throw()}for(const s of e){if(!(s instanceof Dy)){const e=new pl(ll.INVALID_PARAMS,"pamameter is not local track");return n.onError(e),e.throw()}if(!s._enabled&&t){const e=new pl(ll.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(s.getTrackId()));return n.onError(e),e.throw()}}if(Rc.info(Je(r="[".concat(this._clientId,"] Publishing tracks, id ")).call(r,vo(e).call(e,e=>"".concat(e.getTrackId()," ")))),await this._configDistribute.awaitConfigDistributeComplete(),t&&Jr(e).call(e,e=>{var t;const r=this._configDistribute.getBitrateLimit();var i;e instanceof US&&r&&e.setBitrateLimit(r.uplink),-1===Lo(t=this._bindEnabledTracks).call(t,e)&&(e.addListener(my.NEED_ADD_TRACK,this._handleLocalTrackEnable),e.addListener(my.NEED_REMOVE_TRACK,this._handleLocalTrackDisable),this._bindEnabledTracks.push(e),Ia()&&e.muted&&Rc.debug(Je(i="[".concat(this._clientId,"] on firefox publish a muted track ")).call(i,e.getTrackId(),", skip the pub operation and wait unmute")))}),Ia()&&0===(e=ji(e).call(e,e=>!e.muted)).length)return void n.onSuccess(vo(e).call(e,e=>e.trackMediaType+":"+e.getTrackLabel()).toString());const o=await this._publishMutex.lock();try{const t=await this._publishHighStream(e),r=(t.audioTrack,t.videoTrack);this._isDualStreamEnabled&&r&&!this._lowStream&&await this._publishLowStream(r),o(),n.onSuccess(vo(e).call(e,e=>e.trackMediaType+":"+e.getTrackLabel()).toString())}catch(r){throw o(),t&&Jr(e).call(e,e=>{var t,r;const i=Lo(t=this._bindEnabledTracks).call(t,e);-1!==i&&(e.off(my.NEED_ADD_TRACK,this._handleLocalTrackEnable),e.off(my.NEED_REMOVE_TRACK,this._handleLocalTrackDisable),bo(r=this._bindEnabledTracks).call(r,i,1))}),n.onError(r),Rc.error("[".concat(this._clientId,"] publish error"),r.toString()),r}Rc.info(Je(i="[".concat(this._clientId,"] Publish success, id ")).call(i,vo(e).call(e,e=>"".concat(e.getTrackId()," "))))}async unpublish(e,t=!0){var r;const i=await this._publishMutex.lock();let n,o,s;try{var a,c;if(!this._highStream)return Rc.warning("[".concat(this._clientId,"] Could not find tracks to unpublish")),void(i&&i());if(n=this._highStream.getAllTracks(),e?hl(e)||(e=[e]):e=this._highStream.getAllTracks(),o=function(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r+=1){const i=e[r];if(ji(e).call(e,e=>e===i).length!==ji(t).call(t,e=>e===i).length)return!1}return!0}(n,e),s=ky.reportApiInvoke(this._sessionId,{name:jA.UNPUBLISH,options:vo(e).call(e,e=>e.getTrackId()),tag:GA.TRACER}),Rc.info(Je(a=Je(c="[".concat(this._clientId,"] Unpublish tracks, tracks ")).call(c,vo(e).call(e,e=>"".concat(e.getTrackId()," ")),", isClosePC: ")).call(a,o)),!this._highStream)return Rc.warning("[".concat(this._clientId,"] Could not find tracks to unpublish")),void(i&&i())}catch(e){throw i&&i(),e}try{this._lowStream&&ji(e).call(e,e=>"video"===e.trackMediaType).length>0&&(await this._lowStream.closeP2PConnection(),this._lowStream=void 0),o?await this._highStream.closeP2PConnection():await this._highStream.removeTracks(e,t),i&&i()}catch(e){if(e.code!==ll.OPERATION_ABORTED)throw s.onError(e),Rc.error("[".concat(this._clientId,"] unpublish error"),e.toString()),i&&i(),e;Rc.debug("[".concat(this._clientId,"] ignore unpub operation abort")),i&&i()}this._highStream&&"disconnected"===this._highStream.connectionState&&(this._highStream=void 0,this._lowStream=void 0),t&&Jr(e).call(e,e=>{var t,r;const i=Lo(t=this._bindEnabledTracks).call(t,e);-1!==i&&(e.off(my.NEED_ADD_TRACK,this._handleLocalTrackEnable),e.off(my.NEED_REMOVE_TRACK,this._handleLocalTrackDisable),bo(r=this._bindEnabledTracks).call(r,i,1))}),Rc.info(Je(r="[".concat(this._clientId,"] Unpublish success,tracks ")).call(r,vo(e).call(e,e=>"".concat(e.getTrackId())))),s.onSuccess()}async subscribe(e,t){var r,i,n,o,s;gl(t,"mediaType",["audio","video"]);const a=ky.reportApiInvoke(this._sessionId,{name:jA.SUBSCRIBE,options:[e.uid,t],tag:GA.TRACER});if(!this._joinInfo){const e=new pl(ll.INVALID_OPERATION,"Can't subscribe stream, not joined");throw a.onError(e),e}if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState){const e=new pl(ll.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));throw a.onError(e),e}if(!Qo(r=this._users).call(r,t=>t===e)){var c;const t=new pl(ll.INVALID_REMOTE_USER,"user is not in the channel");throw Rc.error(Je(c="[".concat(this._clientId,"] can not subscribe ")).call(c,e.uid,", this user is not in the channel")),a.onError(t),t}if(!e.hasAudio&&!e.hasVideo){var l;const t=new pl(ll.INVALID_REMOTE_USER,"user is not published");throw Rc.error(Je(l="[".concat(this._clientId,"] can not subscribe ")).call(l,e.uid,", user is not published")),a.onError(t),t}const u={audio:"audio"===t,video:"video"===t};if(!e.hasAudio&&u.audio||!e.hasVideo&&u.video){var d,h;const r=new pl(ll.REMOTE_USER_IS_NOT_PUBLISHED);throw Rc.error(Je(d=Je(h="[".concat(this._clientId,"] can not subscribe ")).call(h,e.uid," with mediaType ")).call(d,t,", remote track is not published")),a.onError(r),r}let p=this._subscribeMutex.get(e.uid);p||(p=new ah("sub-".concat(e.uid)),this._subscribeMutex.set(e.uid,p)),Rc.info(Je(i=Je(n="[".concat(this._clientId,"] subscribe user ")).call(n,e.uid,", mediaType: ")).call(i,t));const f=await p.lock();let g=this._remoteStream.get(e.uid);try{if(g)u.audio=u.audio||g.subscribeOptions.audio,u.video=u.video||g.subscribeOptions.video,await this._gateway.subscribeChange(g,u);else{g=new XS(e,this._statsCollector,this._joinInfo,u),this._remoteStream.set(e.uid,g);try{await this._gateway.subscribe(g)}catch(t){throw this._remoteStream.delete(e.uid),t}g.on(ty.CONNECTION_STATE_CHANGE,(t,r)=>{"connecting"===t?this.emit(TA.MEDIA_RECONNECT_START,e.uid):"connected"===t&&this.emit(TA.MEDIA_RECONNECT_END,e.uid)})}f()}catch(t){var m;throw a.onError(t),f(),Rc.error(Je(m="[".concat(this._clientId,"] subscribe user ")).call(m,e.uid," error"),t),t}Rc.info(Je(o=Je(s="[".concat(this._clientId,"] subscribe success user ")).call(s,e.uid,", mediaType: ")).call(o,t)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(e.uid,this._defaultStreamFallbackType).catch(e=>{Rc.warning("[".concat(this._clientId,"] auto set fallback failed"),e)});const _="audio"===t?e.audioTrack:e.videoTrack;if(!_){const e=new pl(ll.UNEXPECTED_ERROR,"can not find remote track in user object");return a.onError(e),e.throw()}return a.onSuccess(_.getTrackId()),_}async unsubscribe(e,t){var r,i,n,o,s;t&&gl(t,"mediaType",["audio","video"]);const a=ky.reportApiInvoke(this._sessionId,{name:jA.UNSUBSCRIBE,options:[e.uid,t],tag:GA.TRACER});if(!Qo(r=this._users).call(r,t=>t===e)){var c;const t=new pl(ll.INVALID_REMOTE_USER,"user is not in the channel");throw Rc.error(Je(c="[".concat(this._clientId,"] can not subscribe ")).call(c,e.uid,", user is not in the channel")),a.onError(t),t}Rc.info(Je(i=Je(n="[".concat(this._clientId,"] unsubscribe uid: ")).call(n,e.uid,", mediaType: ")).call(i,t));let l=this._subscribeMutex.get(e.uid);l||(l=new ah("sub-".concat(e.uid)),this._subscribeMutex.set(e.uid,l));const u=await l.lock(),d=this._remoteStream.get(e.uid);var h;if(!d)return Rc.warning(Je(h="[".concat(this._clientId,"]: you have not subscribe the remote user ")).call(h,e.uid)),a.onSuccess(),void u();const p=rC({},d.subscribeOptions);"audio"===t?p.audio=!1:"video"===t?(p.video=!1,d.pc._statsFilter.setVideoIsReady(!1)):(p.audio=!1,p.video=!1);try{p.audio||p.video?await this._gateway.subscribeChange(d,p):(await d.closeP2PConnection(),this._remoteStream.delete(e.uid)),u()}catch(t){var f;if(t.code!==ll.OPERATION_ABORTED)throw a.onError(t),u(),Rc.error(Je(f="[".concat(this._clientId,"] unsubscribe user ")).call(f,e.uid," error"),t.toString()),t;u(),Rc.debug("[".concat(this._clientId,"] ignore unsub operation abort"))}Rc.info(Je(o=Je(s="[".concat(this._clientId,"] unsubscribe success uid: ")).call(s,e.uid,", mediaType: ")).call(o,t)),a.onSuccess()}setLowStreamParameter(e){!function(e){if(!e)throw new pl(hy.INVALID_PARAMS);yl(e.width)||ml(e.width,"streamParameter.width"),yl(e.height)||ml(e.height,"streamParameter.height"),yl(e.framerate)||ml(e.framerate,"streamParameter.framerate"),yl(e.bitrate)||ml(e.bitrate,"streamParameter.bitrate")}(e);const t=ky.reportApiInvoke(this._sessionId,{name:jA.SET_LOW_STREAM_PARAMETER,options:[e],tag:GA.TRACER});(!e.width&&e.height||e.width&&!e.height)&&Rc.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),Rc.info("[".concat(this._clientId,"] set low stream parameter to"),ve(e));const r=this._configDistribute.getLowStreamConfigDistribute();r&&r.bitrate&&e.bitrate&&r.bitrate<e.bitrate&&(e.bitrate=r.bitrate),this._lowStreamParameter=e,t.onSuccess()}async enableDualStream(){const e=ky.reportApiInvoke(this._sessionId,{name:jA.ENABLE_DUAL_STREAM,options:[],tag:GA.TRACER});if(!Fu().supportDualStream){ky.streamSwitch(this._sessionId,{lts:Ma(),isdual:!0,succ:!1});const t=new pl(ll.NOT_SUPPORTED,"Your browser is not support dual stream");throw e.onError(t),t}if(this._isDualStreamEnabled){const t=new pl(ll.INVALID_OPERATION,"Dual stream is already enabled");throw e.onError(t),t}if(this._highStream&&"connected"===this._highStream.connectionState&&this._highStream.videoTrack)try{await this._publishLowStream(this._highStream.videoTrack)}catch(i){throw ky.streamSwitch(this._sessionId,{lts:Ma(),isdual:!0,succ:!1}),e.onError(i),i}this._isDualStreamEnabled=!0,ky.streamSwitch(this._sessionId,{lts:Ma(),isdual:!0,succ:!0}),Rc.info("[".concat(this._clientId,"] enable dual stream")),e.onSuccess()}async disableDualStream(){const e=ky.reportApiInvoke(this._sessionId,{name:jA.DISABLE_DUAL_STREAM,options:[],tag:GA.TRACER});if(this._lowStream)try{await this._lowStream.closeP2PConnection()}catch(i){throw ky.streamSwitch(this._sessionId,{lts:Ma(),isdual:!1,succ:!1}),e.onError(i),i}this._lowStream=void 0,this._isDualStreamEnabled=!1,this._highStream&&(this._highStream.lowStreamConnection=void 0),ky.streamSwitch(this._sessionId,{lts:Ma(),isdual:!1,succ:!0}),Rc.info("[".concat(this._clientId,"] disable dual stream")),e.onSuccess()}async setClientRole(e,t){!function(e){gl(e,"role",["audience","host"])}(e),t&&MA(t);const r=ky.reportApiInvoke(this._sessionId,{name:jA.SET_CLIENT_ROLE,options:[e,t],tag:GA.TRACER});if("rtc"===this._mode){Rc.warning("[".concat(this._clientId,"]rtc mode can not use setClientRole"));const e=new pl(ll.INVALID_OPERATION,"rtc mode can not use setClientRole");return r.onError(e),e.throw()}if(t&&t.level&&"host"===e){const e=new pl(ll.INVALID_OPERATION,"host mode can not set audience latency level");return r.onError(e),e.throw()}try{var i,n;if("audience"===e&&this._highStream){const e=new pl(ll.INVALID_OPERATION,"can not set client role to audience when publishing stream");return r.onError(e),e.throw()}await this._gateway.setClientRole(e,t),Rc.info(Je(i=Je(n="[".concat(this._clientId,"] set client role to ")).call(n,e,", level: ")).call(i,t&&t.level)),r.onSuccess()}catch(e){throw r.onError(e),e}}setProxyServer(e){if(_l(e,"proxyServer"),"DISCONNECTED"!==this.connectionState)throw new pl(ll.INVALID_OPERATION,"Set proxy server before join channel");if("disabled"!==this._cloudProxyServerMode||this._useLocalAccessPoint)throw new pl(ll.INVALID_OPERATION,"You have already set the proxy");this._proxyServer=e,ky.setProxyServer(this._proxyServer),Rc.setProxyServer(this._proxyServer)}setTurnServer(e){if(hl(e)||(e=[e]),"DISCONNECTED"!==this.connectionState)throw new pl(ll.INVALID_OPERATION,"Set turn server before join channel");if("disabled"!==this._cloudProxyServerMode||this._useLocalAccessPoint)throw new pl(ll.INVALID_OPERATION,"You have already set the proxy");var t;if(function(e){if(!hl(e)||e.length<1)return!1;try{Jr(e).call(e,e=>{if(!e.urls)throw Error()})}catch(e){return!1}return!0}(e))return this._turnServer={servers:e,mode:"original-manual"},void Rc.info(Je(t="[".concat(this._clientId,"] Set original turnserver success: ")).call(t,vo(e).call(e,e=>e.urls).join(","),"."));Jr(e).call(e,e=>DA(e)),this._turnServer={servers:e,mode:"manual"},Rc.info("[".concat(this._clientId,"] Set turnserver success."))}startProxyServer(e){const t=ky.reportApiInvoke(this._sessionId,{name:jA.START_PROXY_SERVER,options:[],tag:GA.TRACER});if("DISCONNECTED"!==this.connectionState){const e=new pl(ll.INVALID_OPERATION,"Start proxy server before join channel");throw t.onError(e),e}if(this._proxyServer||"manual"===this._turnServer.mode||this._useLocalAccessPoint){const e=new pl(ll.INVALID_OPERATION,"You have already set the proxy");throw t.onError(e),e}const r=[1,2,3,4,5];switch(void 0===e&&(e=1),e){case 1:this._cloudProxyServerMode="normal";break;case 2:this._cloudProxyServerMode="443only";break;case 3:this._cloudProxyServerMode="proxy3";break;case 4:this._cloudProxyServerMode="proxy4";break;case 5:this._cloudProxyServerMode="proxy5";break;default:{const e=new pl(ll.INVALID_PARAMS,"proxy server mode must be ".concat(r.join("|")));throw t.onError(e),e}}Rc.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),t.onSuccess()}stopProxyServer(){const e=ky.reportApiInvoke(this._sessionId,{name:jA.STOP_PROXY_SERVER,options:[],tag:GA.TRACER});if("DISCONNECTED"!==this.connectionState)throw new pl(ll.INVALID_OPERATION,"Stop proxy server after leave channel");ky.setProxyServer(),Rc.setProxyServer(),this._cloudProxyServerMode="disabled",Rc.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]},e.onSuccess()}setLocalAccessPoints(e,t){if(vl(e,"serverList"),_l(t,"domain"),this._proxyServer||"disabled"!==this._cloudProxyServerMode)throw new pl(ll.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const r=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;e=vo(e).call(e,e=>{var i;return r.test(e)?Je(i="".concat(e.replace(/\./g,"-"),".")).call(i,t):e}),this._useLocalAccessPoint=!0,Vc("WEBCS_DOMAIN",e),Vc("WEBCS_DOMAIN_BACKUP_LIST",e),Vc("GATEWAY_DOMAINS",[t]),Vc("EVENT_REPORT_DOMAIN",e[0]),Vc("EVENT_REPORT_BACKUP_DOMAIN",e[1]||e[0]),Vc("LOG_UPLOAD_SERVER","".concat(e[0],":6444")),Rc.info("set local access point success")}async setRemoteVideoStreamType(e,t){var r,i;gl(t,"streamType",[0,1]);const n=ky.reportApiInvoke(this._sessionId,{name:jA.SET_REMOTE_VIDEO_STREAM_TYPE,options:[e,t],tag:GA.TRACER});try{await this._gateway.setRemoteVideoStreamType(e,t),Fa(()=>{var t;const r=Qo(t=this._users).call(t,t=>t.uid===e);r&&r.videoTrack&&r.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(e){throw n.onError(e),Rc.error("[".concat(this._clientId,"] set remote video stream type error"),e.toString()),e}Rc.info(Je(r=Je(i="[".concat(this._clientId,"] set remote ")).call(i,e," video stream type to ")).call(r,t)),this._remoteStreamTypeCacheMap.set(e,t),n.onSuccess()}async setStreamFallbackOption(e,t){var r,i;gl(t,"fallbackType",[0,1,2]);const n=ky.reportApiInvoke(this._sessionId,{name:jA.SET_STREAM_FALLBACK_OPTION,options:["too long to show",t],tag:GA.TRACER});try{await this._gateway.setStreamFallbackOption(e,t)}catch(e){throw n.onError(e),Rc.error("[".concat(this._clientId,"] set stream fallback option"),e.toString()),e}Rc.info(Je(r=Je(i="[".concat(this._clientId,"] set remote ")).call(i,e," stream fallback type to ")).call(r,t)),this._streamFallbackTypeCacheMap.set(e,t),n.onSuccess()}setEncryptionConfig(e,t,r){!function(e){gl(e,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])}(e),_l(t,"secret");const i=["aes-128-gcm2","aes-256-gcm2"];if(is(i).call(i,e)){if(!r||!(r instanceof Uint8Array&&32===r.length))throw new pl(ll.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(r)throw new pl(ll.INVALID_PARAMS,"current encrypt mode does not need salt");new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'\"|{}\\[\\]])(?=.{8,})").test(t)||Rc.warning("The secret is not strong:\n      The secret must contain at least 1 lowercase alphabetical character,\n      The secret must contain at least 1 uppercase alphabetical character,\n      The secret must contain at least 1 numeric character,\n      The secret must contain at least one special character,\n      The secret must be eight characters or longer.\n      "),this._encryptionMode=e,this._encryptionSecret=t,r&&(this._encryptionSalt=Wp(r))}async renewToken(e){_l(e,"token",1,2047);const t=ky.reportApiInvoke(this._sessionId,{name:jA.RENEW_TOKEN,options:[e],tag:GA.TRACER});if(!this._key){const e=new pl(ll.INVALID_OPERATION,"renewToken should not be called before user join");return t.onError(e),e.throw()}this._key=e;try{await this._gateway.renewToken(e)}catch(e){throw t.onError(e),Rc.error("[".concat(this._clientId,"] renewToken failed"),e.toString()),e}Rc.debug("[".concat(this._clientId,"] renewToken success")),t.onSuccess()}enableAudioVolumeIndicator(){const e=ky.reportApiInvoke(this._sessionId,{name:jA.ENABLE_AUDIO_VOLUME_INDICATOR,options:[],tag:GA.TRACER});if(this._audioVolumeIndicationInterval)return Rc.warning("you have already enabled audio volume indicator!"),e.onSuccess();this._audioVolumeIndicationInterval=window.setInterval(()=>{var e,t,r;let i=cl(e=vo(t=Bd(Jp(r=this._remoteStream).call(r))).call(t,e=>({level:e.user.audioTrack?100*e.user.audioTrack._source.getAccurateVolumeLevel():0,uid:e.getUserId()}))).call(e,(e,t)=>e.level-t.level);this._highStream&&this._highStream.audioTrack&&(i.push({level:100*this._highStream.audioTrack._source.getAccurateVolumeLevel(),uid:this._highStream._userId}),i=cl(i).call(i,(e,t)=>e.level-t.level)),this.emit(TA.VOLUME_INDICATOR,i)},jc("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3),e.onSuccess()}getRTCStats(){const e=this._statsCollector.getRTCStats(),t=this._gateway.getInChannelInfo();return e.Duration=Math.round(t.duration/1e3),e}startLiveStreaming(e,t){const r=ky.reportApiInvoke(this._sessionId,{name:jA.START_LIVE_STREAMING,options:[e,t],tag:GA.TRACER});if(!t){if("h264"!==this._codec){const e=new pl(ll.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");return r.onError(e),fo.reject(e)}if(!this._highStream){const e=new pl(ll.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming");return r.onError(e),fo.reject(e)}}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(e)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(e)){const e=new pl(ll.LIVE_STREAMING_TASK_CONFLICT);return r.onError(e),fo.reject(e)}const i=t?cy.TRANSCODE:cy.RAW;return this._createLiveStreamingClient(i).startLiveStreamingTask(e,i).then(()=>r.onSuccess()).catch(e=>{throw r.onError(e),e})}setLiveTranscoding(e){const t=ky.reportApiInvoke(this._sessionId,{name:jA.SET_LIVE_TRANSCODING,options:[e],tag:GA.TRACER});return this._createLiveStreamingClient(cy.TRANSCODE).setTranscodingConfig(e).then(()=>t.onSuccess()).catch(e=>{throw t.onError(e),e})}stopLiveStreaming(e){var t;const r=ky.reportApiInvoke(this._sessionId,{name:jA.STOP_LIVE_STREAMING,options:[e],tag:GA.TRACER}),i=ji(t=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient]).call(t,t=>t&&t.hasUrl(e));if(!i.length){const e=new pl(ll.INVALID_PARAMS,"can not find live streaming url to stop");return r.onError(e),fo.reject(e)}return fo.all(vo(i).call(i,t=>t&&t.stopLiveStreamingTask(e))).then(()=>r.onSuccess()).catch(e=>{throw r.onError(e),e})}async addInjectStreamUrl(e,t){const r=ky.reportApiInvoke(this._sessionId,{name:jA.ADD_INJECT_STREAM_URL,options:[e,t],tag:GA.TRACER});try{if(!this._joinInfo)throw new pl(ll.INVALID_OPERATION,"can not addInjectStreamUrl, no joininfo");const r=this._createLiveStreamingClient(cy.INJECT);r.setInjectStreamConfig(t,0),await r.startLiveStreamingTask(e,cy.INJECT)}catch(e){throw r.onError(e),e}r.onSuccess()}async removeInjectStreamUrl(){const e=ky.reportApiInvoke(this._sessionId,{name:jA.REMOVE_INJECT_STREAM_URL,options:[],tag:GA.TRACER});try{var t,r;const e=this._createLiveStreamingClient(cy.INJECT),i=Qo(t=Bd(Jp(r=e.streamingTasks).call(r))).call(t,e=>e.mode===cy.INJECT);if(!this._joinInfo||!i)throw new pl(ll.INVALID_OPERATION,"can remove addInjectStreamUrl, no joininfo or inject task");await e.stopLiveStreamingTask(i.url)}catch(t){throw e.onError(t),t}e.onSuccess()}async startChannelMediaRelay(e){const t=ky.reportApiInvoke(this._sessionId,{name:jA.START_CHANNEL_MEDIA_RELAY,options:[e],tag:GA.TRACER});try{V_(e);const t=this._createChannelMediaRelayClient();await t.startChannelMediaRelay(e)}catch(e){return t.onError(e),e.throw()}t.onSuccess()}async updateChannelMediaRelay(e){const t=ky.reportApiInvoke(this._sessionId,{name:jA.UPDATE_CHANNEL_MEDIA_RELAY,options:[e],tag:GA.TRACER});try{V_(e);const t=this._createChannelMediaRelayClient();await t.updateChannelMediaRelay(e)}catch(e){return t.onError(e),e.throw()}t.onSuccess()}async stopChannelMediaRelay(){const e=ky.reportApiInvoke(this._sessionId,{name:jA.STOP_CHANNEL_MEDIA_RELAY,options:[],tag:GA.TRACER});try{const e=this._createChannelMediaRelayClient();await e.stopChannelMediaRelay()}catch(i){return e.onError(i),i.throw()}e.onSuccess()}sendStreamMessage(e,t=!0){if(!this._joinInfo)throw new pl(ll.INVALID_OPERATION,"can not send data stream, not joined");if("string"==typeof e&&(e=(new TextEncoder).encode(e)),new Blob([e]).size>1024)throw new pl(ll.INVALID_PARAMS,"stream message out of range.");return this._gateway.signal.request(JA.DATA_STREAM,{payload:Wp(e)},!t)}sendMetadata(e){if(!this._joinInfo)throw new pl(ll.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([e]).size>1024)throw new pl(ll.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(JA.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:Wp(e)})}async sendCustomReportMessage(e){hl(e)||(e=[e]),Jr(e).call(e,xA);const t=ky.reportApiInvoke(this._sessionId,{name:jA.SEND_CUSTOM_REPORT_MESSAGE,options:[ve(e)],tag:GA.TRACER});if(!this._joinInfo){const e=new pl(ll.INVALID_OPERATION,"can not send custom report, not joined");return t.onError(e),e.throw()}await ky.sendCustomReportMessage(this._joinInfo.sid,e),t.onSuccess()}getLocalAudioStats(){if(!this._highStream)return iy;const e=this._statsCollector.getLocalAudioTrackStats(this._highStream.connectionId);return ba()&&this._highStream&&this._highStream.audioTrack&&(this._highStream.audioTrack instanceof Hy?!this._highStream.audioTrack.isActive:!this._highStream.audioTrack.enabled)&&(e.sendVolumeLevel=0),e}getRemoteAudioStats(){var e;const t={};return Jr(e=this._remoteStream).call(e,(e,r)=>{t[r]=this._statsCollector.getRemoteAudioTrackStats(e.connectionId)}),t}getLocalVideoStats(){return this._highStream?this._statsCollector.getLocalVideoTrackStats(this._highStream.connectionId):ny}getRemoteVideoStats(){var e;const t={};return Jr(e=this._remoteStream).call(e,(e,r)=>{t[r]=this._statsCollector.getRemoteVideoTrackStats(e.connectionId)}),t}getRemoteNetworkQuality(){var e;const t={};return Jr(e=this._remoteStream).call(e,(e,r)=>{t[r]=this._statsCollector.getRemoteNetworkQualityStats(e.connectionId)}),t}async pickSVCLayer(e,t){gl(t.spatialLayer,"spatialLayer",[0,1,2,3]),gl(t.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(e,t)}catch(e){throw Rc.error("[".concat(this._clientId,"] pick SVC layer failed"),e.toString()),e}}_reset(){var e,t,r;Rc.debug("[".concat(this._clientId,"] reset client")),this._axiosCancelSource.cancel(),this._axiosCancelSource=Sc.CancelToken.source(),this._streamFallbackTypeCacheMap=new Mr,this._remoteStreamTypeCacheMap=new Mr,this._configDistribute.stopGetConfigDistribute(),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,Jr(e=this._users).call(e,e=>{e.audioTrack&&(e.audioTrack.stop(),e.audioTrack._isDestroyed=!0),e.videoTrack&&(e.videoTrack.stop(),e.videoTrack._isDestroyed=!0)}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),this._highStream&&(this._highStream.closeP2PConnection(!0),this._highStream=void 0),Jr(t=this._bindEnabledTracks).call(t,e=>{e.off(my.NEED_ADD_TRACK,this._handleLocalTrackEnable),e.off(my.NEED_REMOVE_TRACK,this._handleLocalTrackDisable)}),this._bindEnabledTracks=[],this._lowStream&&(this._lowStream.closeP2PConnection(!0),this._lowStream=void 0),Jr(r=this._remoteStream).call(r,e=>{e.closeP2PConnection(!0)}),this._remoteStream=new Mr,this._publishMutex=new ah("client-publish"),this._subscribeMutex=new Mr,this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._injectStreamingClient&&(this._injectStreamingClient.terminate(),this._injectStreamingClient.removeAllListeners(),this._injectStreamingClient=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0)}_startSession(e,t){var r,i,n;const o=e||Op();e?Rc.debug(Je(r="[".concat(this._clientId,"] new Session ")).call(r,o)):Rc.debug(Je(i=Je(n="[".concat(this._clientId,"] renewSession ")).call(n,this._sessionId," => ")).call(i,o)),this._sessionId=o,t?ky.sessionInit(this._sessionId,{lts:(new Date).getTime(),cname:t.channel,appid:t.appId,mode:this._mode}):this._joinInfo?ky.sessionInit(this._sessionId,{lts:(new Date).getTime(),cname:this._joinInfo.cname,appid:this._joinInfo.appId,mode:this._mode}):this._gateway.joinInfo&&ky.sessionInit(this._sessionId,{lts:(new Date).getTime(),cname:this._gateway.joinInfo.cname,appid:this._gateway.joinInfo.appId,mode:this._mode}),this._joinInfo&&(this._joinInfo.sid=o),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=o)}async _publishHighStream(e){if(!this._joinInfo)throw new pl(ll.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new pl(ll.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if("auto"===this._turnServer.mode&&jc("FORCE_TURN")&&!jc("TURN_ENABLE_TCP")&&!jc("TURN_ENABLE_UDP"))throw new pl(ll.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");if(Rc.debug("[".concat(this._clientId,"] publish high stream")),this._highStream)return await this._highStream.addTracks(e),this._highStream;this._highStream=new zS(this._statsCollector,this._joinInfo,this._codec),this._highStream.on(ty.P2P_LOST,()=>{this._highStream&&this.emit(TA.P2P_LOST,this._highStream.getUserId())}),await this._highStream.addTracks(e);try{await this._gateway.publish(this._highStream,"high")}catch(e){throw this._highStream=void 0,e}return this._highStream.on(ty.CONNECTION_STATE_CHANGE,(e,t)=>{this._highStream&&("connected"===e?this.emit(TA.MEDIA_RECONNECT_END,this._highStream.getUserId()):"connecting"===e&&this.emit(TA.MEDIA_RECONNECT_START,this._highStream.getUserId()))}),this._highStream}async _publishLowStream(e){if(!this._joinInfo)throw new pl(ll.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new pl(ll.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if(!this._highStream||"connected"!==this._highStream.connectionState)throw new pl(ll.UNEXPECTED_ERROR,"Could not find high stream");if(this._lowStream)return new pl(ll.UNEXPECTED_ERROR,"[".concat(this._clientId,"] Can't publish low stream when stream already publish")).throw();Rc.debug("[".concat(this._clientId,"] publish low stream")),this._lowStream=new zS(this._statsCollector,this._joinInfo,this._codec,!0);const t=this._configDistribute.getLowStreamConfigDistribute();t&&t.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&t.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=t.bitrate)),this._lowStream.lowStreamParameter=this._lowStreamParameter,await this._lowStream.addTracks([e]);try{await this._gateway.publish(this._lowStream,"low")}catch(e){throw this._lowStream=void 0,e}this._highStream.lowStreamConnection=this._lowStream}_createLiveStreamingClient(e){if(!this._joinInfo||!this._appId)return new pl(ll.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const t=()=>new U_(this._joinInfo,this._config.websocketRetryConfig||Zd,this._config.httpRetryConfig||Zd),r=e=>{e.onLiveStreamError=(e,t)=>{ky.reportApiInvoke(this._sessionId,{name:jA.ON_LIVE_STREAM_ERROR,options:[e,t],tag:GA.TRACER}).onSuccess(),this.emit(TA.LIVE_STREAMING_ERROR,e,t)},e.onLiveStreamWarning=(e,t)=>{ky.reportApiInvoke(this._sessionId,{name:jA.ON_LIVE_STREAM_WARNING,options:[e,t],tag:GA.TRACER}).onSuccess(),this.emit(TA.LIVE_STREAMING_WARNING,e,t)},e.on(uy.REQUEST_WORKER_MANAGER_LIST,(e,t,r)=>{if(!this._joinInfo)return r(new pl(ll.INVALID_OPERATION,"can not find join info to get worker manager"));yS(e,this._joinInfo,this._axiosCancelSource.token,Zd).then(t).catch(r)})};switch(e){case cy.RAW:return this._liveRawStreamingClient||(this._liveRawStreamingClient=t(),r(this._liveRawStreamingClient)),this._liveRawStreamingClient;case cy.TRANSCODE:return this._liveTranscodeStreamingClient||(this._liveTranscodeStreamingClient=t(),r(this._liveTranscodeStreamingClient)),this._liveTranscodeStreamingClient;case cy.INJECT:return this._injectStreamingClient||(this._injectStreamingClient=t(),this._injectStreamingClient.on(uy.REQUEST_WORKER_MANAGER_LIST,(e,t,r)=>{if(!this._joinInfo)return r(new pl(ll.INVALID_OPERATION,"can not find join info to get worker manager"));yS(e,this._joinInfo,this._axiosCancelSource.token,Zd).then(t).catch(r)}),this._injectStreamingClient.onInjectStatusChange=(e,t,r)=>{this.emit(TA.INJECT_STREAM_STATUS,e,t,r)}),this._injectStreamingClient}}_createChannelMediaRelayClient(){return this._joinInfo?(this._channelMediaRelayClient||(this._channelMediaRelayClient=new G_(this._joinInfo,this._clientId,this._config.websocketRetryConfig||Zd,this._config.httpRetryConfig||Zd),this._channelMediaRelayClient.on("state",e=>{"RELAY_STATE_FAILURE"===e&&this._channelMediaRelayClient&&this._channelMediaRelayClient.dispose(),this.emit(TA.CHANNEL_MEDIA_RELAY_STATE,e)}),this._channelMediaRelayClient.on("event",e=>{this.emit(TA.CHANNEL_MEDIA_RELAY_EVENT,e)})),this._channelMediaRelayClient):new pl(ll.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw()}_handleGatewayEvents(){this._gateway.on(_u.DISCONNECT_P2P,()=>{var e;Rc.debug("[".concat(this._clientId,"] start full reconnect")),this._highStream&&"disconnected"!==this._highStream.connectionState&&(Rc.debug("[".concat(this._clientId,"] ready to reconnect high stream")),this._highStream.readyToReconnectPC()),this._lowStream&&"disconnected"!==this._lowStream.connectionState&&(Rc.debug("[".concat(this._clientId,"] ready to reconnect low stream")),this._lowStream.readyToReconnectPC()),Jr(e=this._remoteStream).call(e,(e,t)=>{var r;Rc.debug(Je(r="[".concat(this._clientId,"] ready to reconnect remote stream ")).call(r,t)),e.readyToReconnectPC()})}),this._gateway.on(_u.CONNECTION_STATE_CHANGE,(e,t,r)=>{var i,n;const o=()=>{this.emit(TA.CONNECTION_STATE_CHANGE,e,t,r)};if(Rc.info(Je(i=Je(n="[".concat(this._clientId,"] connection state change: ")).call(n,t," -> ")).call(i,e)),"DISCONNECTED"===e)return this._reset(),void o();var s,a;if("RECONNECTING"===e)this._highStream&&"connecting"===this._highStream.connectionState&&(Rc.debug("[".concat(this._clientId,"] ready to reconnect high stream")),this._highStream.readyToReconnectPC()),this._lowStream&&"connecting"===this._lowStream.connectionState&&(Rc.debug("[".concat(this._clientId,"] ready to reconnect low stream")),this._lowStream.readyToReconnectPC()),Jr(s=this._remoteStream).call(s,(e,t)=>{var r;"connecting"===e.connectionState&&(Rc.debug(Je(r="[".concat(this._clientId,"] ready to reconnect remote stream ")).call(r,t)),e.readyToReconnectPC())}),Jr(a=this._users).call(a,e=>{e._trust_in_room_=!1,e._trust_audio_enabled_state_=!1,e._trust_video_enabled_state_=!1,e._trust_audio_mute_state_=!1,e._trust_video_mute_state_=!1,e._trust_stream_added_state_=!1}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if("CONNECTED"===e){var c,l;Jr(c=this._streamFallbackTypeCacheMap).call(c,(e,t)=>{this._gateway.setStreamFallbackOption(t,e).catch(e=>Rc.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),e))}),Jr(l=this._remoteStreamTypeCacheMap).call(l,(e,t)=>{this._gateway.setRemoteVideoStreamType(t,e).catch(e=>Rc.warning("[".concat(this._clientId,"] auto set remote stream type failed"),e))}),this._highStream&&"connecting"===this._highStream.connectionState?this._highStream.reconnectPC().then(()=>{this._lowStream&&"connecting"===this._lowStream.connectionState&&this._lowStream.reconnectPC().catch(e=>{Rc.error("[".concat(this._clientId,"] republish low stream error"),e.toString()),this.emit(TA.ERROR,{reason:e})})}).catch(e=>{Rc.error("[".concat(this._clientId,"] republish high stream error"),e.toString()),this.emit(TA.ERROR,{reason:e})}):this._lowStream&&"connecting"===this._lowStream.connectionState&&this._lowStream.reconnectPC().catch(e=>{Rc.error("[".concat(this._clientId,"] republish low stream error"),e.toString()),this.emit(TA.ERROR,{reason:e})}),this._userOfflineTimeout=window.setTimeout(()=>{var e;if("CONNECTED"!==this.connectionState)return;this._userOfflineTimeout=void 0;const t=ji(e=this._users).call(e,e=>!e._trust_in_room_);Jr(t).call(t,e=>{var t;Rc.debug(Je(t="[".concat(this._clientId,"] user offline timeout, emit user offline ")).call(t,e.uid)),this._handleUserOffline({uid:e.uid})})},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{var e;"CONNECTED"===this.connectionState&&(this._streamRemovedTimeout=void 0,Jr(e=this._users).call(e,e=>{var t,r,i,n,o;e._trust_audio_mute_state_||(Rc.debug(Je(t="[".concat(this._clientId,"] auto dispatch audio unmute event ")).call(t,e.uid)),this._handleMuteStream(e.uid,"audio",!1)),e._trust_video_mute_state_||(Rc.debug(Je(r="[".concat(this._clientId,"] auto dispatch video unmute event ")).call(r,e.uid)),this._handleMuteStream(e.uid,"video",!1)),e._trust_audio_enabled_state_||(Rc.debug(Je(i="[".concat(this._clientId,"] auto dispatch enable local audio ")).call(i,e.uid)),this._handleSetStreamLocalEnable("audio",e.uid,!0)),!e._trust_video_enabled_state_&&e._video_enabled_&&(Rc.debug(Je(n="[".concat(this._clientId,"] auto dispatch enable local video ")).call(n,e.uid)),this._handleSetStreamLocalEnable("video",e.uid,!0)),e._trust_stream_added_state_||(Rc.debug(Je(o="[".concat(this._clientId,"] auto dispatch stream remove ")).call(o,e.uid)),this._handleRemoveStream({uid:e.uid,uint_id:e._uintid}))}))},1e3)}o()}),this._gateway.on(_u.REQUEST_NEW_GATEWAY_LIST,(e,t)=>{if(!this._joinInfo)return t(new pl(ll.UNEXPECTED_ERROR,"can not recover, no join info"));_S(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||Zd).then(t=>{var r;this._joinInfo&&(this._joinInfo.apResponse=t.gatewayInfo.res),e(vo(r=t.gatewayInfo.gatewayAddrs).call(r,e=>{if(this._joinInfo&&this._joinInfo.proxyServer){var t,r;const i=e.split(":");return Je(t=Je(r="wss://".concat(this._joinInfo.proxyServer,"/ws/?h=")).call(r,i[0],"&p=")).call(t,i[1])}return"wss://".concat(e)}))}).catch(t)}),this._gateway.on(_u.NETWORK_QUALITY,e=>{"normal"===this._networkQualitySensitivity&&this.emit(TA.NETWORK_QUALITY,e)}),this._gateway.on(_u.STREAM_TYPE_CHANGE,(e,t)=>{this.emit(TA.STREAM_TYPE_CHANGED,e,t),ky.reportApiInvoke(this._sessionId,{name:jA.STREAM_TYPE_CHANGE,options:[e,t],tag:GA.TRACER}).onSuccess(ve({uid:e,streamType:t}))}),this._gateway.on(_u.IS_P2P_DISCONNECTED,e=>{var t,r,i;const n=[];return this._highStream&&n.push(this._highStream),Jr(t=this._remoteStream).call(t,e=>n.push(e)),0===n.length||0===ji(n).call(n,e=>"connected"===e.connectionState).length?e(!0):(Rc.debug(Je(r="[".concat(this._clientId,"] ")).call(r,vo(i=ji(n).call(n,e=>"connected"===e.connectionState)).call(i,e=>e.connectionId)," is connected")),void e(!1))}),this._gateway.on(_u.NEED_RENEW_SESSION,()=>{this._startSession()}),this._gateway.signal.on(ey.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(ey.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(ey.ON_ADD_AUDIO_STREAM,e=>this._handleAddAudioOrVideoStream("audio",e.uid,e.uint_id)),this._gateway.signal.on(ey.ON_ADD_VIDEO_STREAM,e=>this._handleAddAudioOrVideoStream("video",e.uid,e.uint_id)),this._gateway.signal.on(ey.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(ey.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(ey.MUTE_AUDIO,e=>this._handleMuteStream(e.uid,"audio",!0)),this._gateway.signal.on(ey.UNMUTE_AUDIO,e=>this._handleMuteStream(e.uid,"audio",!1)),this._gateway.signal.on(ey.MUTE_VIDEO,e=>this._handleMuteStream(e.uid,"video",!0)),this._gateway.signal.on(ey.UNMUTE_VIDEO,e=>this._handleMuteStream(e.uid,"video",!1)),this._gateway.signal.on(ey.RECEIVE_METADATA,e=>{const t=Qp(e.metadata);this.emit(TA.RECEIVE_METADATA,e.uid,t)}),this._gateway.signal.on(ey.ON_DATA_STREAM,e=>{e.seq&&delete e.seq,e.payload=Qp(e.payload),this.emit(TA.STREAM_MESSAGE,e.uid,e.payload),this.onStreamMessage&&this.onStreamMessage(e)}),this._gateway.signal.on(ey.ON_CRYPT_ERROR,()=>{Hp(()=>{Rc.warning("[".concat(this._clientId,"] on crypt error")),this.emit(TA.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(ey.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(ey.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{Rc.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._reset(),this._gateway.leave(!0),this.emit(TA.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}),this._gateway.signal.on(ey.ON_STREAM_FALLBACK_UPDATE,e=>{var t,r;Rc.debug(Je(t=Je(r="[".concat(this._clientId,"] stream fallback peerId: ")).call(r,e.stream_id,", attr: ")).call(t,e.stream_type)),this.emit(TA.STREAM_FALLBACK,e.stream_id,1===e.stream_type?"fallback":"recover")}),this._gateway.signal.on(ey.ON_PUBLISH_STREAM,e=>{var t;this.uid===this._uid&&(this._highStream&&this._highStream._waitingSuccessResponse&&"connected"===this._highStream.connectionState?(this._highStream.reportPublishEvent(!0,null,ve({proxy:e.proxy})),Rc.info(Je(t="[".concat(this._clientId,"] on publish stream, ")).call(t,ve(e))),void 0!==e.proxy&&this.emit(TA.IS_USING_CLOUD_PROXY,!!e.proxy)):this._lowStream?this._lowStream.reportPublishEvent(!0,null,ve({proxy:e.proxy})):Rc.warning("get on_publish_stream message but cannot handle"))}),this._gateway.signal.on(ey.ENABLE_LOCAL_VIDEO,e=>{this._handleSetStreamLocalEnable("video",e.uid,!0)}),this._gateway.signal.on(ey.DISABLE_LOCAL_VIDEO,e=>{this._handleSetStreamLocalEnable("video",e.uid,!1)}),this._gateway.signal.on($A.REQUEST_TIMEOUT,(e,t)=>{if(this._joinInfo)switch(e){case JA.PUBLISH:{var r;if(!t)return;const e="high"===t.stream_type?this._highStream:this._lowStream;if(!e)return;"offer"===t.state&&ky.publish(this._joinInfo.sid,{lts:e.startTime,succ:!1,ec:ll.TIMEOUT,audio:t.audio,video:t.video,p2pid:t.p2p_id,publishRequestid:e.ID,screenshare:!(!e.videoTrack||-1===Lo(r=e.videoTrack._hints).call(r,_y.SCREEN_TRACK)),audioName:e.audioTrack&&(e.audioTrack instanceof Hy?e.audioTrack.getSubTrackLabels().join(","):e.audioTrack.getTrackLabel()),videoName:e.videoTrack&&e.videoTrack.getTrackLabel()});break}case JA.SUBSCRIBE:{const e=t.stream_id,r=this._remoteStream.get(e);if(!r)return;t&&ky.subscribe(this._joinInfo.sid,{lts:r.startTime,succ:!1,ec:ll.TIMEOUT,audio:!!t.audio,video:!!t.video,peerid:t.stream_id,subscribeRequestid:r.ID,p2pid:r.pc.ID});break}}})}}async function sC(){let e={audio:[],video:[]};try{let t=new RTCPeerConnection;t.addTransceiver("video",{direction:"recvonly"}),t.addTransceiver("audio",{direction:"recvonly"});const r=(await t.createOffer()).sdp;if(!r)return e;t.close(),t=null,e=function(e){const t={video:[],audio:[]};return e.match(/ VP8/i)&&t.video.push("VP8"),e.match(/ VP9/i)&&t.video.push("VP9"),e.match(/ AV1X/i)&&t.video.push("AV1"),e.match(/ H264/i)&&t.video.push("H264"),e.match(/ opus/i)&&t.audio.push("OPUS"),t}(r)}catch(e){throw new pl(ll.CREATE_OFFER_FAILED,e.toString&&e.toString()).print()}return e}function aC(){const e=nh.reportApiInvoke(null,{name:Nl.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:Ll.TRACER});let t=!1;try{const e=window.RTCPeerConnection,r=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,i=window.WebSocket;t=!!(e&&r&&i)}catch(e){return Rc.error("check system requirement failed: ",e),!1}let r=!1;const i=ma();i.name===ha.CHROME&&Number(i.version)>=58&&(!Ca()||Sa())&&(r=!0),i.name===ha.FIREFOX&&Number(i.version)>=56&&(r=!0),i.name===ha.OPERA&&Number(i.version)>=45&&(r=!0),i.name===ha.SAFARI&&Number(i.version)>=11&&(r=!0),(La()||ma().name===ha.QQ)&&(r=!0),Rc.debug("checkSystemRequirements, api:",t,"browser",r);const n=t&&r;return e.onSuccess(n),n}iC([Ry({report:ky}),nC("design:type",Function),nC("design:paramtypes",[String]),nC("design:returntype",void 0)],oC.prototype,"setProxyServer",null),iC([Ry(),nC("design:type",Function),nC("design:paramtypes",[Object]),nC("design:returntype",void 0)],oC.prototype,"setTurnServer",null),iC([Ry({report:ky}),nC("design:type",Function),nC("design:paramtypes",[Array,String]),nC("design:returntype",void 0)],oC.prototype,"setLocalAccessPoints",null),iC([Ry({report:ky}),nC("design:type",Function),nC("design:paramtypes",[String,String,Uint8Array]),nC("design:returntype",void 0)],oC.prototype,"setEncryptionConfig",null),iC([wy({report:ky}),nC("design:type",Function),nC("design:paramtypes",[Object,Object]),nC("design:returntype",fo)],oC.prototype,"pickSVCLayer",null);class cC extends Eh{constructor(e,t={}){super(),this.startPlayTime=0,this.startPlayOffset=0,this.pausePlayTime=0,this.currentLoopCount=0,this._currentState="stopped",this.audioBuffer=e,this.options=t,this.startPlayOffset=this.options.startPlayTime||0}set currentState(e){e!==this._currentState&&(this._currentState=e,this.emit(Zl.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer.duration}get currentTime(){return"stopped"===this.currentState?0:"paused"===this.currentState?this.pausePlayTime:(this.context.currentTime-this.startPlayTime+this.startPlayOffset)%this.audioBuffer.duration}updateOptions(e){"stopped"===this.currentState?(this.options=e,this.startPlayOffset=this.options.startPlayTime||0):Rc.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&"playing"===this.currentState&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(e){this.sourceNode&&(this.sourceNode.onended=null,"playing"===this.currentState&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),"playing"===this.currentState?(this.startPlayOffset=e,this.startSourceNode()):"paused"===this.currentState&&(this.pausePlayTime=e))}resumeProcessAudioBuffer(){"paused"===this.currentState&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch(e){}this.reset()}}startSourceNode(){var e;this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=$o(e=this.handleSourceNodeEnded).call(e,this))}createSourceNode(){const e=this.context.createBufferSource();return e.buffer=this.audioBuffer,e.loop=!!this.options.loop,e.connect(this.outputNode),e}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const lC=new Mr;async function uC(e,t){let r=null;if("string"==typeof e){const t=lC.get(e);if(t)return Rc.debug("use cached audio resource: ",e),t;try{r=(await Kd(()=>Sc.get(e,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch(e){throw new pl(ll.FETCH_AUDIO_FILE_FAILED,e.toString())}}else{const t=new fo((t,r)=>{const i=new FileReader;i.onload=e=>{e.target?t(e.target.result):r(new pl(ll.READ_LOCAL_AUDIO_FILE_ERROR))},i.onerror=()=>{r(new pl(ll.READ_LOCAL_AUDIO_FILE_ERROR))},i.readAsArrayBuffer(e)});r=await t}const i=await function(e){const t=gh();return new fo((r,i)=>{t.decodeAudioData(e,e=>{r(e)},e=>{i(new pl(ll.DECODE_AUDIO_FILE_FAILED,e.toString()))})})}(r);return"string"==typeof e&&t&&lC.set(e,i),i}function dC(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function hC(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=dC(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=dC(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}function pC(e,t,r,i){r.optimizationMode&&(i&&i.width&&i.height?(r.encoderConfig=hC({},i,{bitrateMin:i.bitrateMin,bitrateMax:i.bitrateMax}),"motion"!==r.optimizationMode&&"detail"!==r.optimizationMode||(t.contentHint=r.optimizationMode,t.contentHint===r.optimizationMode?Rc.debug("[".concat(e,"] set content hint to"),r.optimizationMode):Rc.debug("[".concat(e,"] set content hint failed")))):Rc.warning("[".concat(e,"] can not apply optimization mode bitrate config, no encoderConfig")))}function fC(e,t){var r=ni(e);if(wd){var i=wd(e);t&&(i=ji(i).call(i,(function(t){return Bi(e,t).enumerable}))),r.push.apply(r,i)}return r}function gC(e){for(var t=1;t<arguments.length;t++){var r,i=null!=arguments[t]?arguments[t]:{};if(t%2)Jr(r=fC(Object(i),!0)).call(r,(function(t){Od(e,t,i[t])}));else if(Hu)ae(e,Hu(i));else{var n;Jr(n=fC(Object(i))).call(n,(function(t){di(e,t,Bi(i,t))}))}}return e}function mC(e,t,r,i){r.optimizationMode&&(i&&i.width&&i.height?(r.encoderConfig=gC({},i,{bitrateMin:i.bitrateMin,bitrateMax:i.bitrateMax}),"motion"!==r.optimizationMode&&"detail"!==r.optimizationMode||(t.contentHint=r.optimizationMode,t.contentHint===r.optimizationMode?Rc.debug("[".concat(e,"] set content hint to"),r.optimizationMode):Rc.debug("[".concat(e,"] set content hint failed")))):Rc.warning("[".concat(e,"] can not apply optimization mode bitrate config, no encoderConfig")))}var _C=M.setInterval;const vC=ma().name,EC=ma().name;class AC{constructor(e,t){this.id=0,AC.count+=1,this.id=AC.count,this.element=e,this.context=t}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=e=>{const t=document.createElement("audio");t.srcObject=new MediaStream([e.track]),t.play(),this.audioPlayerElement=t}}async switchSdp(){if(!this.peerPair)return;const e=async(e,t)=>{const r="offer"===t?await e.createOffer():await e.createAnswer();return await e.setLocalDescription(r),"complete"===e.iceGatheringState?e.localDescription:new fo(t=>{e.onicegatheringstatechange=()=>{"complete"===e.iceGatheringState&&t(e.localDescription)}})},t=async(e,t)=>await e.setRemoteDescription(t);try{const r=await e(this.peerPair[0],"offer");await t(this.peerPair[1],r);const i=await e(this.peerPair[1],"answer");await t(this.peerPair[0],i)}catch(e){throw new pl(ll.LOCAL_AEC_ERROR,e.toString()).print()}}async getTracksFromMediaElement(e){if(this.audioTrack)return this.audioTrack;let t;try{e instanceof HTMLVideoElement&&(e.captureStream?e.captureStream():e.mozCaptureStream()),t=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(e).connect(t)}catch(e){throw new pl(ll.LOCAL_AEC_ERROR,e.toString()).print()}if(!t)throw new pl(ll.LOCAL_AEC_ERROR,"no dest node when local aec").print();const r=t.stream.getAudioTracks()[0];return this.audioTrack=r,r}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();const e=this.element,t=await this.getTracksFromMediaElement(e);this.peerPair&&this.peerPair[0].addTrack(t),await this.switchSdp()}close(){var e;Rc.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&Jr(e=this.peerPair).call(e,e=>{e.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}}AC.count=0;var yC=function(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Bi(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&di(t,r,s),s},SC=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const CC=window.AudioContext||window.webkitAudioContext;class TC{constructor(){this.units=[]}processExternalMediaAEC(e){var t;if(!this._doesEnvironmentNeedAEC())return Rc.debug("the system does not need to process local aec"),-1;this.context||(this.context=new CC);let r=Qo(t=this.units).call(t,t=>t&&t.getElement()===e);return r||(r=new AC(e,this.context),this.units.push(r)),r.startEchoCancellation(),Rc.debug("start processing local audio echo cancellation, id is",r.id),r.id}_doesEnvironmentNeedAEC(){return ma().name!==ha.SAFARI}}yC([rh({report:nh}),SC("design:type",Function),SC("design:paramtypes",[HTMLAudioElement]),SC("design:returntype",Number)],TC.prototype,"processExternalMediaAEC",null);const bC=new TC;var IC,RC,wC,kC;function OC(e){return Ph.enumerateDevices(!0,!0,e)}function NC(e){return Ph.getRecordingDevices(e)}function LC(e){return Ph.getCamerasDevices(e)}function PC(e){return Ph.getSpeakers(e)}function DC(){return new F_}function MC(e){Rc.setLogLevel(e)}function xC(){Rc.enableLogUpload()}function BC(){Rc.disableLogUpload()}async function UC(e,t){var r;if(Rc.debug(Je(r="loadModule: ".concat(e.name,", loadOption: ")).call(r,ve(t))),!e.moduleInit)throw Rc.debug("Invalid Plugin"),new pl(ll.INVALID_PLUGIN,"invalid plugin");try{await e.moduleInit({logger:Rc,report:nh},t)}catch(e){throw new pl(ll.UNEXPECTED_ERROR,"unexpected error in loadModule",e)}}function FC(e){bC.processExternalMediaAEC(e)}Vc("PROCESS_ID",Je(IC=Je(RC=Je(wC=Je(kC="process-".concat(kp(8,""),"-")).call(kC,kp(4,""),"-")).call(wC,kp(4,""),"-")).call(RC,kp(4,""),"-")).call(IC,kp(12,""))),function(){const e=ma();Uu.getDisplayMedia=function(e){return!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia)}(),Uu.getStreamFromExtension=e.name===ha.CHROME&&Number(e.version)>34,Uu.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver)return!1;if(!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const e=new RTCPeerConnection;let t=!1;try{e.addTransceiver("audio"),t=!0}catch(e){}return e.close(),t}(),Uu.supportMinBitrate=e.name===ha.CHROME||e.name===ha.EDGE,Uu.supportSetRtpSenderParameters=function(){const e=ma();return!!(window.RTCRtpSender&&window.RTCRtpSender.prototype.setParameters&&window.RTCRtpSender.prototype.getParameters)&&(!!Da()||!(!ba()&&!ya())||e.name===ha.FIREFOX&&Number(e.version)>=64)}(),e.name===ha.SAFARI&&(Number(e.version)>=14?Uu.supportDualStream=!0:Uu.supportDualStream=!1),Uu.webAudioMediaStreamDest=function(){const e=ma();return!(e.name===ha.SAFARI&&Number(e.version)<12)}(),Uu.supportReplaceTrack=function(){return!!window.RTCRtpSender&&"function"==typeof RTCRtpSender.prototype.replaceTrack}(),Uu.supportWebGL="undefined"!=typeof WebGLRenderingContext,Uu.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,Da()||(Uu.webAudioWithAEC=!0),Uu.supportShareAudio=function(){const e=ma();return(e.os===da.WIN_10||e.os===da.WIN_81||e.os===da.WIN_7||e.os===da.LINUX||e.os===da.MAC_OS)&&e.name===ha.CHROME&&Number(e.version)>=74}(),Uu.supportDualStreamEncoding=function(){const e=ma();return"Safari"===e.name&&Number(e.version)>=14}(),Rc.info("browser compatibility",ve(Uu),ve(e))}(),function(){const e=window.localStorage.getItem("websdk_ng_global_parameter");if(e)try{var t;const r=JSON.parse(window.atob(e)),i=Ma();Rc.debug("Loading global parameters from cache",r),Jr(t=ni(r)).call(t,e=>{if(Object.prototype.hasOwnProperty.call(Gc,e)){const{value:t,expires:n}=r[e];if(n&&n<=i)return;Hc[e]=t,Gc[e]=t}})}catch(t){Rc.error("Error loading mutableParamsCache: ".concat(e),t.message)}}();const VC={__CLIENT_LIST__:Yc,__TRACK_LIST__:Kc,VERSION:kc,BUILD:wc,setParameter:Vc,getParameter:jc,getSupportedCodec:sC,checkSystemRequirements:aC,getDevices:OC,getMicrophones:NC,getCameras:LC,getElectronScreenSources:Ch,getPlaybackDevices:PC,createClient:function(e={codec:"vp8",mode:"rtc"}){const t=nh.reportApiInvoke(null,{name:Nl.CREATE_CLIENT,options:[e],tag:Ll.TRACER});try{!function(e){gl(e.codec,"config.codec",["vp8","vp9","av1","h264"]),gl(e.mode,"config.mode",["rtc","live"]),void 0!==e.proxyServer&&_l(e.proxyServer,"config.proxyServer",1,1e4),void 0!==e.turnServer&&$l(e.turnServer),void 0!==e.httpRetryConfig&&Yl(e.httpRetryConfig),void 0!==e.websocketRetryConfig&&Yl(e.websocketRetryConfig)}(e)}catch(e){throw t.onError(e),e}return t.onSuccess(),new LA(CA({forceWaitGatewayResponse:!0},e,{role:"rtc"===e.mode?"host":e.role}))},createCameraVideoTrack:async function(e={encoderConfig:"480p_1"}){const t=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.CREATE_CAM_VIDEO_TRACK,options:[hC({},e)]}),r=fv(e),i=kp(8,"track-cam-");let n=null;Rc.info("start create camera video track with config",ve(e),"trackId",i);try{n=(await kh({video:r},i)).getVideoTracks()[0]||null}catch(e){throw t.onError(e),e}if(!n){const e=new pl(ll.UNEXPECTED_ERROR,"can not find track in media stream");return t.onError(e),e.throw()}e.optimizationMode&&pC(i,n,e,e.encoderConfig&&Mc(e.encoderConfig));const o=new bv(n,e,r,e.scalabiltyMode?Bc(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,i);return t.onSuccess(o.getTrackId()),Rc.info("create camera video success, trackId:",i),o},createCustomVideoTrack:function(e){const t=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.CREATE_CUSTOM_VIDEO_TRACK,options:[e]}),r=new Tv(e.mediaStreamTrack,{bitrateMax:e.bitrateMax,bitrateMin:e.bitrateMin},e.scalabiltyMode?Bc(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode);return t.onSuccess(r.getTrackId()),Rc.info("create custom video track success with config",e,"trackId",r.getTrackId()),r},createScreenVideoTrack:async function(e={},t="disable"){const r=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.CREATE_SCREEN_VIDEO_TRACK,options:[hC({},e),t]});e.encoderConfig?"string"==typeof e.encoderConfig||e.encoderConfig.width&&e.encoderConfig.height||(e.encoderConfig.width={max:1920},e.encoderConfig.height={max:1080}):e.encoderConfig="1080p_2";const i=gv(e),n=kp(8,"track-scr");let o=null,s=null;const a=Fu();if(!a.supportShareAudio&&"enable"===t){const e=new pl(ll.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return r.onError(e),e.throw()}Rc.info("start create screen video track with config",e,"withAudio",t,"trackId",n);try{const e=await kh({screen:i,screenAudio:"auto"===t?a.supportShareAudio:"enable"===t},n);o=e.getVideoTracks()[0]||null,s=e.getAudioTracks()[0]||null}catch(e){throw r.onError(e),e}if(!o){const e=new pl(ll.UNEXPECTED_ERROR,"can not find track in media stream");return r.onError(e),e.throw()}if(!s&&"enable"===t){o&&o.stop();const e=new pl(ll.SHARE_AUDIO_NOT_ALLOWED);return r.onError(e),e.throw()}e.optimizationMode||(e.optimizationMode="detail"),e.optimizationMode&&(pC(n,o,e,e.encoderConfig&&xc(e.encoderConfig)),e.encoderConfig&&"string"!=typeof e.encoderConfig&&(e.encoderConfig.bitrateMin=e.encoderConfig.bitrateMax));const c=new Tv(o,e.encoderConfig?xc(e.encoderConfig):{},e.scalabiltyMode?Bc(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,n);if(c._hints.push(Eu.SCREEN_TRACK),!s)return r.onSuccess(c.getTrackId()),Rc.info("create screen video track success","video:",c.getTrackId()),c;const l=new jh(s);return r.onSuccess([c.getTrackId(),l.getTrackId()]),Rc.info("create screen video track success","video:",c.getTrackId(),"audio:",l.getTrackId()),[c,l]},createMicrophoneAndCameraTracks:async function(e={},t={encoderConfig:"480p_1"}){var r,i,n,o;const s=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.CREATE_MIC_AND_CAM_TRACKS,options:[e,t]}),a=fv(t),c=mv(e),l=kp(8,"track-mic-"),u=kp(8,"track-cam-");let d=null,h=null;Rc.info(Je(r=Je(i=Je(n="start create camera video track(".concat(u,") and microphone audio track(")).call(n,l,") with config, audio: ")).call(i,ve(e),", video: ")).call(r,ve(t)));try{var p;const e=await kh({audio:c,video:a},Je(p="".concat(l,"-")).call(p,u));d=e.getAudioTracks()[0],h=e.getVideoTracks()[0]}catch(e){throw s.onError(e),e}if(!d||!h){const e=new pl(ll.UNEXPECTED_ERROR,"can not find tracks in media stream");return s.onError(e),e.throw()}t.optimizationMode&&pC(u,h,t,t.encoderConfig&&Mc(t.encoderConfig));const f=new Gh(d,e,c,l),g=new bv(h,t,a,t.scalabiltyMode?Bc(t.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},t.optimizationMode,u);return s.onSuccess([f.getTrackId(),g.getTrackId()]),Rc.info(Je(o="create camera video track(".concat(u,") and microphone audio track(")).call(o,l,") success")),[f,g]},createMicrophoneAudioTrack:async function(e={}){const t=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.CREATE_MIC_AUDIO_TRACK,options:[e]}),r=mv(e),i=kp(8,"track-mic-");let n=null;Rc.info("start create microphone audio track with config",ve(e),"trackId",i);try{n=(await kh({audio:r},i)).getAudioTracks()[0]||null}catch(e){throw t.onError(e),e}if(!n){const e=new pl(ll.UNEXPECTED_ERROR,"can not find track in media stream");return t.onError(e),e.throw()}const o=new Gh(n,e,r,i);return t.onSuccess(o.getTrackId()),Rc.info("create microphone audio track success, trackId:",i),o},createCustomAudioTrack:function(e){const t=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.CREATE_CUSTOM_AUDIO_TRACK,options:[e]}),r=new jh(e.mediaStreamTrack,e.encoderConfig?Fc(e.encoderConfig):{});return Rc.info("create custom audio track success with config",e,"trackId",r.getTrackId()),t.onSuccess(r.getTrackId()),r},createBufferSourceAudioTrack:async function(e){const t=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.CREATE_BUFFER_AUDIO_TRACK,options:[e]}),r=kp(8,"track-buf-");Rc.info("start create buffer source audio track with config",ve(e),"trackId",r);const i=e.source;if(!(e.source instanceof AudioBuffer))try{e.source=await uC(e.source,e.cacheOnlineFile)}catch(e){return t.onError(e),e.throw()}const n=new cC(e.source),o=new Hh(i,n,e.encoderConfig?Fc(e.encoderConfig):{},r);return Rc.info("create buffer source audio track success, trackId:",r),t.onSuccess(o.getTrackId()),o},setLogLevel:MC,enableLogUpload:xC,disableLogUpload:BC,createChannelMediaRelayConfiguration:DC,checkAudioTrackIsActive:async function(e,t=5e3){const r=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[t]});if(!(e instanceof jh||e instanceof qE)){const e=new pl(ll.INVALID_TRACK,"the parameter is not a audio track");return r.onError(e),e.throw()}t&&t<1e3&&(t=1e3);const i=e instanceof jh?e.getTrackLabel():"remote_track",n=e.getVolumeLevel();let o=n,s=n;const a=Ma();return new fo(n=>{const c=_C(()=>{const l=e.getVolumeLevel();o=l>o?l:o,s=l<s?l:s;const u=o-s>1e-4,d=Ma()-a;if(u||d>t){var h;clearInterval(c);const t=u,s={duration:d,deviceLabel:i,maxVolumeLevel:o,result:t};Rc.info(Je(h="[track-".concat(e.getTrackId(),"] check audio track active completed. ")).call(h,ve(s))),r.onSuccess(s),n(t)}},200)})},checkVideoTrackIsActive:async function(e,t=5e3){var r;const i=nh.reportApiInvoke(null,{tag:Ll.TRACER,name:Nl.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[t]});if(!(e instanceof Tv||e instanceof WE)){const e=new pl(ll.INVALID_TRACK,"the parameter is not a video track");return i.onError(e),e.throw()}t&&t<1e3&&(t=1e3);const n=e instanceof Tv?e.getTrackLabel():"remote_track",o=e.getMediaStreamTrack(!0),s=document.createElement("video");s.style.width="1px",s.style.height="1px",s.setAttribute("muted",""),s.muted=!0,s.setAttribute("playsinline",""),s.controls=!1,(ba()||ya())&&(s.style.opacity="0.01",s.style.position="fixed",s.style.left="0",s.style.top="0",document.body.appendChild(s)),s.srcObject=new MediaStream([o]),s.play();const a=document.createElement("canvas");a.width=160,a.height=120;let c=0,l=0;try{const e=Ma();c=await function(e,t,r,i){let n,o=0,s=null;return new fo((a,c)=>{function l(){o>i&&n&&(n(),a(o));const t=r.getContext("2d");if(!t){const e=new pl(ll.UNEXPECTED_ERROR,"can not get canvas 2d context.");return Rc.error(e.toString()),void c(e)}t.drawImage(e,0,0,160,120);const l=t.getImageData(0,0,r.width,r.height),u=Math.floor(l.data.length/3);if(s){for(let e=0;e<u;e+=3)if(l.data[e]!==s[e])return o+=1,void(s=l.data);s=l.data}else s=l.data}Fa(()=>{n&&(n(),a(o))},t),n=vh(()=>{l()},30)})}(s,t,a,4),l=Ma()-e}catch(e){throw i.onError(e),e}vC===ha.SAFARI&&(s.pause(),s.remove()),s.srcObject=null;const u=c>4,d={duration:l,changedPicNum:c,deviceLabel:n,result:u};return Rc.info(Je(r="[track-".concat(e.getTrackId(),"] check video track active completed. ")).call(r,ve(d))),i.onSuccess(d),u},setArea:y_,loadModule:UC,processExternalMediaAEC:FC},jC={__CLIENT_LIST__:Yc,__TRACK_LIST__:Kc,VERSION:kc,BUILD:wc,setParameter:Vc,getParameter:jc,getSupportedCodec:sC,checkSystemRequirements:aC,getDevices:OC,getMicrophones:NC,getCameras:LC,getElectronScreenSources:Ch,getPlaybackDevices:PC,createClient:function(e={codec:"vp8",mode:"rtc"}){const t=ky.reportApiInvoke(null,{name:jA.CREATE_CLIENT,options:[e],tag:GA.TRACER});try{!function(e){gl(e.codec,"config.codec",["vp8","vp9","av1","h264"]),gl(e.mode,"config.mode",["rtc","live"]),void 0!==e.proxyServer&&_l(e.proxyServer,"config.proxyServer",1,1e4),void 0!==e.turnServer&&DA(e.turnServer),void 0!==e.httpRetryConfig&&PA(e.httpRetryConfig),void 0!==e.websocketRetryConfig&&PA(e.websocketRetryConfig)}(e)}catch(e){throw t.onError(e),e}return t.onSuccess(),new oC(rC({forceWaitGatewayResponse:!0},e,{role:"rtc"===e.mode?"host":e.role}))},createCameraVideoTrack:async function(e={encoderConfig:"480p_1"}){const t=ky.reportApiInvoke(null,{tag:GA.TRACER,name:jA.CREATE_CAM_VIDEO_TRACK,options:[gC({},e)]}),r=fv(e),i=kp(8,"track-cam-");let n=null;Rc.info("start create camera video track with config",ve(e),"trackId",i);try{n=(await kh({video:r},i)).getVideoTracks()[0]||null}catch(e){throw t.onError(e),e}if(!n){const e=new pl(hy.UNEXPECTED_ERROR,"can not find track in media stream");return t.onError(e),e.throw()}e.optimizationMode&&mC(i,n,e,e.encoderConfig&&Mc(e.encoderConfig));const o=new FS(n,e,r,e.scalabiltyMode?Bc(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,i);return t.onSuccess(o.getTrackId()),Rc.info("create camera video success, trackId:",i),o},createCustomVideoTrack:function(e){const t=ky.reportApiInvoke(null,{tag:GA.TRACER,name:jA.CREATE_CUSTOM_VIDEO_TRACK,options:[e]}),r=new US(e.mediaStreamTrack,{bitrateMax:e.bitrateMax,bitrateMin:e.bitrateMin},e.scalabiltyMode?Bc(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode);return t.onSuccess(r.getTrackId()),Rc.info("create custom video track success with config",e,"trackId",r.getTrackId()),r},createScreenVideoTrack:async function(e={},t="disable"){const r=ky.reportApiInvoke(null,{tag:GA.TRACER,name:jA.CREATE_SCREEN_VIDEO_TRACK,options:[gC({},e),t]});e.encoderConfig?"string"==typeof e.encoderConfig||e.encoderConfig.width&&e.encoderConfig.height||(e.encoderConfig.width={max:1920},e.encoderConfig.height={max:1080}):e.encoderConfig="1080p_2";const i=gv(e),n=kp(8,"track-scr");let o=null,s=null;const a=Fu();if(!a.supportShareAudio&&"enable"===t){const e=new pl(hy.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return r.onError(e),e.throw()}Rc.info("start create screen video track with config",e,"withAudio",t,"trackId",n);try{const e=await kh({screen:i,screenAudio:"auto"===t?a.supportShareAudio:"enable"===t},n);o=e.getVideoTracks()[0]||null,s=e.getAudioTracks()[0]||null}catch(e){throw r.onError(e),e}if(!o){const e=new pl(hy.UNEXPECTED_ERROR,"can not find track in media stream");return r.onError(e),e.throw()}if(!s&&"enable"===t){o&&o.stop();const e=new pl(hy.SHARE_AUDIO_NOT_ALLOWED);return r.onError(e),e.throw()}e.optimizationMode||(e.optimizationMode="detail"),e.optimizationMode&&(mC(n,o,e,e.encoderConfig&&xc(e.encoderConfig)),e.encoderConfig&&"string"!=typeof e.encoderConfig&&(e.encoderConfig.bitrateMin=e.encoderConfig.bitrateMax));const c=new US(o,e.encoderConfig?xc(e.encoderConfig):{},e.scalabiltyMode?Bc(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,n);if(c._hints.push(_y.SCREEN_TRACK),!s)return r.onSuccess(c.getTrackId()),Rc.info("create screen video track success","video:",c.getTrackId()),c;const l=new Vy(s);return r.onSuccess([c.getTrackId(),l.getTrackId()]),Rc.info("create screen video track success","video:",c.getTrackId(),"audio:",l.getTrackId()),[c,l]},createMicrophoneAndCameraTracks:async function(e={},t={encoderConfig:"480p_1"}){var r,i,n,o;const s=ky.reportApiInvoke(null,{tag:GA.TRACER,name:jA.CREATE_MIC_AND_CAM_TRACKS,options:[e,t]}),a=fv(t),c=mv(e),l=kp(8,"track-mic-"),u=kp(8,"track-cam-");let d=null,h=null;Rc.info(Je(r=Je(i=Je(n="start create camera video track(".concat(u,") and microphone audio track(")).call(n,l,") with config, audio: ")).call(i,ve(e),", video: ")).call(r,ve(t)));try{var p;const e=await kh({audio:c,video:a},Je(p="".concat(l,"-")).call(p,u));d=e.getAudioTracks()[0],h=e.getVideoTracks()[0]}catch(e){throw s.onError(e),e}if(!d||!h){const e=new pl(hy.UNEXPECTED_ERROR,"can not find tracks in media stream");return s.onError(e),e.throw()}t.optimizationMode&&mC(u,h,t,t.encoderConfig&&Mc(t.encoderConfig));const f=new jy(d,e,c,l),g=new FS(h,t,a,t.scalabiltyMode?Bc(t.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},t.optimizationMode,u);return s.onSuccess([f.getTrackId(),g.getTrackId()]),Rc.info(Je(o="create camera video track(".concat(u,") and microphone audio track(")).call(o,l,") success")),[f,g]},createMicrophoneAudioTrack:async function(e={}){const t=ky.reportApiInvoke(null,{tag:GA.TRACER,name:jA.CREATE_MIC_AUDIO_TRACK,options:[e]}),r=mv(e),i=kp(8,"track-mic-");let n=null;Rc.info("start create microphone audio track with config",ve(e),"trackId",i);try{n=(await kh({audio:r},i)).getAudioTracks()[0]||null}catch(e){throw t.onError(e),e}if(!n){const e=new pl(hy.UNEXPECTED_ERROR,"can not find track in media stream");return t.onError(e),e.throw()}const o=new jy(n,e,r,i);return t.onSuccess(o.getTrackId()),Rc.info("create microphone audio track success, trackId:",i),o},createCustomAudioTrack:function(e){const t=ky.reportApiInvoke(null,{tag:GA.TRACER,name:jA.CREATE_CUSTOM_AUDIO_TRACK,options:[e]}),r=new Vy(e.mediaStreamTrack,e.encoderConfig?Fc(e.encoderConfig):{});return Rc.info("create custom audio track success with config",e,"trackId",r.getTrackId()),t.onSuccess(r.getTrackId()),r},createBufferSourceAudioTrack:async function(e){const t=ky.reportApiInvoke(null,{tag:GA.TRACER,name:jA.CREATE_BUFFER_AUDIO_TRACK,options:[e]}),r=kp(8,"track-buf-");Rc.info("start create buffer source audio track with config",ve(e),"trackId",r);const i=e.source;if(!(e.source instanceof AudioBuffer))try{e.source=await uC(e.source,e.cacheOnlineFile)}catch(e){return t.onError(e),e.throw()}const n=new cC(e.source),o=new Gy(i,n,e.encoderConfig?Fc(e.encoderConfig):{},r);return Rc.info("create buffer source audio track success, trackId:",r),t.onSuccess(o.getTrackId()),o},setLogLevel:MC,enableLogUpload:xC,disableLogUpload:BC,createChannelMediaRelayConfiguration:DC,checkAudioTrackIsActive:async function(e,t=5e3){const r=ky.reportApiInvoke(null,{tag:GA.TRACER,name:jA.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[t]});if(!(e instanceof Vy||e instanceof JS)){const e=new pl(hy.INVALID_TRACK,"the parameter is not a audio track");return r.onError(e),e.throw()}t&&t<1e3&&(t=1e3);const i=e instanceof Vy?e.getTrackLabel():"remote_track",n=e.getVolumeLevel();let o=n,s=n;const a=Ma();return new fo(n=>{const c=_C(()=>{const l=e.getVolumeLevel();o=l>o?l:o,s=l<s?l:s;const u=o-s>1e-4,d=Ma()-a;if(u||d>t){var h;clearInterval(c);const t=u,s={duration:d,deviceLabel:i,maxVolumeLevel:o,result:t};Rc.info(Je(h="[track-".concat(e.getTrackId(),"] check audio track active completed. ")).call(h,ve(s))),r.onSuccess(s),n(t)}},200)})},checkVideoTrackIsActive:async function(e,t=5e3){var r;const i=ky.reportApiInvoke(null,{tag:GA.TRACER,name:jA.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[t]});if(!(e instanceof US||e instanceof $S)){const e=new pl(hy.INVALID_TRACK,"the parameter is not a video track");return i.onError(e),e.throw()}t&&t<1e3&&(t=1e3);const n=e instanceof US?e.getTrackLabel():"remote_track",o=e.getMediaStreamTrack(!0),s=document.createElement("video");s.style.width="1px",s.style.height="1px",s.setAttribute("muted",""),s.muted=!0,s.setAttribute("playsinline",""),s.controls=!1,(ba()||ya())&&(s.style.opacity="0.01",s.style.position="fixed",s.style.left="0",s.style.top="0",document.body.appendChild(s)),s.srcObject=new MediaStream([o]),s.play();const a=document.createElement("canvas");a.width=160,a.height=120;let c=0,l=0;try{const e=Ma();c=await function(e,t,r,i){let n,o=0,s=null;return new fo((a,c)=>{function l(){o>i&&n&&(n(),a(o));const t=r.getContext("2d");if(!t){const e=new pl(hy.UNEXPECTED_ERROR,"can not get canvas 2d context.");return Rc.error(e.toString()),void c(e)}t.drawImage(e,0,0,160,120);const l=t.getImageData(0,0,r.width,r.height),u=Math.floor(l.data.length/3);if(s){for(let e=0;e<u;e+=3)if(l.data[e]!==s[e])return o+=1,void(s=l.data);s=l.data}else s=l.data}Fa(()=>{n&&(n(),a(o))},t),n=vh(()=>{l()},30)})}(s,t,a,4),l=Ma()-e}catch(e){throw i.onError(e),e}EC===RA.SAFARI&&(s.pause(),s.remove()),s.srcObject=null;const u=c>4,d={duration:l,changedPicNum:c,deviceLabel:n,result:u};return Rc.info(Je(r="[track-".concat(e.getTrackId(),"] check video track active completed. ")).call(r,ve(d))),i.onSuccess(d),u},setArea:y_,loadModule:UC,processExternalMediaAEC:FC},GC=jc("SDK_FALLBACK")?jC:VC;return ae(GC,{onAudioAutoplayFailed:{get:()=>Jd.onAudioAutoplayFailed,set:e=>{Jd.onAudioAutoplayFailed=e}},onAutoplayFailed:{get:()=>Jd.onAutoplayFailed,set:e=>{Jd.onAutoplayFailed=e}}}),Ph.on(Dl.CAMERA_DEVICE_CHANGED,e=>{Rc.info("camera device changed",ve(e)),GC.onCameraChanged&&GC.onCameraChanged(e)}),Ph.on(Dl.RECORDING_DEVICE_CHANGED,e=>{Rc.info("microphone device changed",ve(e)),GC.onMicrophoneChanged&&GC.onMicrophoneChanged(e)}),Ph.on(Dl.PLAYOUT_DEVICE_CHANGED,e=>{Rc.debug("playout device changed",ve(e)),GC.onPlaybackDeviceChanged&&GC.onPlaybackDeviceChanged(e)}),Mh.onAutoplayFailed=()=>{Rc.info("detect audio element autoplay failed"),Jd.onAudioAutoplayFailed&&Jd.onAudioAutoplayFailed()},ph.on("autoplay-failed",()=>{Rc.info("detect webaudio autoplay failed"),Jd.onAudioAutoplayFailed&&Jd.onAudioAutoplayFailed()}),window&&(window.__ARTC__=GC),GC}))}).call(this,r("c8ba"),r("4362"))},e683:function(e,t,r){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},e6cf:function(e,t,r){"use strict";var i,n,o,s,a=r("23e7"),c=r("c430"),l=r("da84"),u=r("d066"),d=r("c65b"),h=r("fea9"),p=r("6eeb"),f=r("e2cc"),g=r("d2bb"),m=r("d44e"),_=r("2626"),v=r("59ed"),E=r("1626"),A=r("861d"),y=r("19aa"),S=r("8925"),C=r("2266"),T=r("1c7e"),b=r("4840"),I=r("2cf4").set,R=r("b575"),w=r("cdf9"),k=r("44de"),O=r("f069"),N=r("e667"),L=r("01b4"),P=r("69f3"),D=r("94ca"),M=r("b622"),x=r("6069"),B=r("605d"),U=r("2d00"),F=M("species"),V="Promise",j=P.getterFor(V),G=P.set,H=P.getterFor(V),Q=h&&h.prototype,W=h,q=Q,z=l.TypeError,Z=l.document,Y=l.process,K=O.f,$=K,J=!!(Z&&Z.createEvent&&l.dispatchEvent),X=E(l.PromiseRejectionEvent),ee="unhandledrejection",te="rejectionhandled",re=0,ie=1,ne=2,oe=1,se=2,ae=!1,ce=D(V,(function(){var e=S(W),t=e!==String(W);if(!t&&66===U)return!0;if(c&&!q["finally"])return!0;if(U>=51&&/native code/.test(e))return!1;var r=new W((function(e){e(1)})),i=function(e){e((function(){}),(function(){}))},n=r.constructor={};return n[F]=i,ae=r.then((function(){}))instanceof i,!ae||!t&&x&&!X})),le=ce||!T((function(e){W.all(e)["catch"]((function(){}))})),ue=function(e){var t;return!(!A(e)||!E(t=e.then))&&t},de=function(e,t){var r,i,n,o=t.value,s=t.state==ie,a=s?e.ok:e.fail,c=e.resolve,l=e.reject,u=e.domain;try{a?(s||(t.rejection===se&&me(t),t.rejection=oe),!0===a?r=o:(u&&u.enter(),r=a(o),u&&(u.exit(),n=!0)),r===e.promise?l(z("Promise-chain cycle")):(i=ue(r))?d(i,r,c,l):c(r)):l(o)}catch(h){u&&!n&&u.exit(),l(h)}},he=function(e,t){e.notified||(e.notified=!0,R((function(){var r,i=e.reactions;while(r=i.get())de(r,e);e.notified=!1,t&&!e.rejection&&fe(e)})))},pe=function(e,t,r){var i,n;J?(i=Z.createEvent("Event"),i.promise=t,i.reason=r,i.initEvent(e,!1,!0),l.dispatchEvent(i)):i={promise:t,reason:r},!X&&(n=l["on"+e])?n(i):e===ee&&k("Unhandled promise rejection",r)},fe=function(e){d(I,l,(function(){var t,r=e.facade,i=e.value,n=ge(e);if(n&&(t=N((function(){B?Y.emit("unhandledRejection",i,r):pe(ee,r,i)})),e.rejection=B||ge(e)?se:oe,t.error))throw t.value}))},ge=function(e){return e.rejection!==oe&&!e.parent},me=function(e){d(I,l,(function(){var t=e.facade;B?Y.emit("rejectionHandled",t):pe(te,t,e.value)}))},_e=function(e,t,r){return function(i){e(t,i,r)}},ve=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=ne,he(e,!0))},Ee=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw z("Promise can't be resolved itself");var i=ue(t);i?R((function(){var r={done:!1};try{d(i,t,_e(Ee,r,e),_e(ve,r,e))}catch(n){ve(r,n,e)}})):(e.value=t,e.state=ie,he(e,!1))}catch(n){ve({done:!1},n,e)}}};if(ce&&(W=function(e){y(this,q),v(e),d(i,this);var t=j(this);try{e(_e(Ee,t),_e(ve,t))}catch(r){ve(t,r)}},q=W.prototype,i=function(e){G(this,{type:V,done:!1,notified:!1,parent:!1,reactions:new L,rejection:!1,state:re,value:void 0})},i.prototype=f(q,{then:function(e,t){var r=H(this),i=K(b(this,W));return r.parent=!0,i.ok=!E(e)||e,i.fail=E(t)&&t,i.domain=B?Y.domain:void 0,r.state==re?r.reactions.add(i):R((function(){de(i,r)})),i.promise},catch:function(e){return this.then(void 0,e)}}),n=function(){var e=new i,t=j(e);this.promise=e,this.resolve=_e(Ee,t),this.reject=_e(ve,t)},O.f=K=function(e){return e===W||e===o?new n(e):$(e)},!c&&E(h)&&Q!==Object.prototype)){s=Q.then,ae||(p(Q,"then",(function(e,t){var r=this;return new W((function(e,t){d(s,r,e,t)})).then(e,t)}),{unsafe:!0}),p(Q,"catch",q["catch"],{unsafe:!0}));try{delete Q.constructor}catch(Ae){}g&&g(Q,q)}a({global:!0,wrap:!0,forced:ce},{Promise:W}),m(W,V,!1,!0),_(V),o=u(V),a({target:V,stat:!0,forced:ce},{reject:function(e){var t=K(this);return d(t.reject,void 0,e),t.promise}}),a({target:V,stat:!0,forced:c||ce},{resolve:function(e){return w(c&&this===o?W:this,e)}}),a({target:V,stat:!0,forced:le},{all:function(e){var t=this,r=K(t),i=r.resolve,n=r.reject,o=N((function(){var r=v(t.resolve),o=[],s=0,a=1;C(e,(function(e){var c=s++,l=!1;a++,d(r,t,e).then((function(e){l||(l=!0,o[c]=e,--a||i(o))}),n)})),--a||i(o)}));return o.error&&n(o.value),r.promise},race:function(e){var t=this,r=K(t),i=r.reject,n=N((function(){var n=v(t.resolve);C(e,(function(e){d(n,t,e).then(r.resolve,i)}))}));return n.error&&i(n.value),r.promise}})},e772:function(e,t,r){e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=53)}({0:function(e,t,r){"use strict";function i(e,t,r,i,n,o,s,a){var c,l="function"===typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=r,l._compiled=!0),i&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),s?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},l._ssrRegister=c):n&&(c=a?function(){n.call(this,this.$root.$options.shadowRoot)}:n),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(e,t){return c.call(t),u(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,c):[c]}return{exports:e,options:l}}r.d(t,"a",(function(){return i}))},3:function(e,t){e.exports=r("8122")},33:function(e,t,r){"use strict";var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"el-select-dropdown__item",class:{selected:e.itemSelected,"is-disabled":e.disabled||e.groupDisabled||e.limitReached,hover:e.hover},on:{mouseenter:e.hoverItem,click:function(t){return t.stopPropagation(),e.selectOptionClick(t)}}},[e._t("default",[r("span",[e._v(e._s(e.currentLabel))])])],2)},n=[];i._withStripped=!0;var o=r(4),s=r.n(o),a=r(3),c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l={mixins:[s.a],name:"ElOption",componentName:"ElOption",inject:["select"],props:{value:{required:!0},label:[String,Number],created:Boolean,disabled:{type:Boolean,default:!1}},data:function(){return{index:-1,groupDisabled:!1,visible:!0,hitState:!1,hover:!1}},computed:{isObject:function(){return"[object object]"===Object.prototype.toString.call(this.value).toLowerCase()},currentLabel:function(){return this.label||(this.isObject?"":this.value)},currentValue:function(){return this.value||this.label||""},itemSelected:function(){return this.select.multiple?this.contains(this.select.value,this.value):this.isEqual(this.value,this.select.value)},limitReached:function(){return!!this.select.multiple&&(!this.itemSelected&&(this.select.value||[]).length>=this.select.multipleLimit&&this.select.multipleLimit>0)}},watch:{currentLabel:function(){this.created||this.select.remote||this.dispatch("ElSelect","setSelected")},value:function(e,t){var r=this.select,i=r.remote,n=r.valueKey;if(!this.created&&!i){if(n&&"object"===("undefined"===typeof e?"undefined":c(e))&&"object"===("undefined"===typeof t?"undefined":c(t))&&e[n]===t[n])return;this.dispatch("ElSelect","setSelected")}}},methods:{isEqual:function(e,t){if(this.isObject){var r=this.select.valueKey;return Object(a["getValueByPath"])(e,r)===Object(a["getValueByPath"])(t,r)}return e===t},contains:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];if(this.isObject){var r=this.select.valueKey;return e&&e.some((function(e){return Object(a["getValueByPath"])(e,r)===Object(a["getValueByPath"])(t,r)}))}return e&&e.indexOf(t)>-1},handleGroupDisabled:function(e){this.groupDisabled=e},hoverItem:function(){this.disabled||this.groupDisabled||(this.select.hoverIndex=this.select.options.indexOf(this))},selectOptionClick:function(){!0!==this.disabled&&!0!==this.groupDisabled&&this.dispatch("ElSelect","handleOptionClick",[this,!0])},queryChange:function(e){this.visible=new RegExp(Object(a["escapeRegexpString"])(e),"i").test(this.currentLabel)||this.created,this.visible||this.select.filteredOptionsCount--}},created:function(){this.select.options.push(this),this.select.cachedOptions.push(this),this.select.optionsCount++,this.select.filteredOptionsCount++,this.$on("queryChange",this.queryChange),this.$on("handleGroupDisabled",this.handleGroupDisabled)},beforeDestroy:function(){var e=this.select,t=e.selected,r=e.multiple,i=r?t:[t],n=this.select.cachedOptions.indexOf(this),o=i.indexOf(this);n>-1&&o<0&&this.select.cachedOptions.splice(n,1),this.select.onOptionDestroy(this.select.options.indexOf(this))}},u=l,d=r(0),h=Object(d["a"])(u,i,n,!1,null,null,null);h.options.__file="packages/select/src/option.vue";t["a"]=h.exports},4:function(e,t){e.exports=r("d010")},53:function(e,t,r){"use strict";r.r(t);var i=r(33);i["a"].install=function(e){e.component(i["a"].name,i["a"])},t["default"]=i["a"]}})},e893:function(e,t,r){var i=r("1a2d"),n=r("56ef"),o=r("06cf"),s=r("9bf2");e.exports=function(e,t,r){for(var a=n(t),c=s.f,l=o.f,u=0;u<a.length;u++){var d=a[u];i(e,d)||r&&i(r,d)||c(e,d,l(t,d))}}},e8b5:function(e,t,r){var i=r("c6b6");e.exports=Array.isArray||function(e){return"Array"==i(e)}},e91f:function(e,t,r){"use strict";var i=r("ebb5"),n=r("4d64").indexOf,o=i.aTypedArray,s=i.exportTypedArrayMethod;s("indexOf",(function(e){return n(o(this),e,arguments.length>1?arguments[1]:void 0)}))},e95a:function(e,t,r){var i=r("b622"),n=r("3f8c"),o=i("iterator"),s=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||s[o]===e)}},e974:function(e,t,r){"use strict";t.__esModule=!0;var i=r("2b0e"),n=s(i),o=r("5128");function s(e){return e&&e.__esModule?e:{default:e}}var a=n.default.prototype.$isServer?function(){}:r("6167"),c=function(e){return e.stopPropagation()};t.default={props:{transformOrigin:{type:[Boolean,String],default:!0},placement:{type:String,default:"bottom"},boundariesPadding:{type:Number,default:5},reference:{},popper:{},offset:{default:0},value:Boolean,visibleArrow:Boolean,arrowOffset:{type:Number,default:35},appendToBody:{type:Boolean,default:!0},popperOptions:{type:Object,default:function(){return{gpuAcceleration:!1}}}},data:function(){return{showPopper:!1,currentPlacement:""}},watch:{value:{immediate:!0,handler:function(e){this.showPopper=e,this.$emit("input",e)}},showPopper:function(e){this.disabled||(e?this.updatePopper():this.destroyPopper(),this.$emit("input",e))}},methods:{createPopper:function(){var e=this;if(!this.$isServer&&(this.currentPlacement=this.currentPlacement||this.placement,/^(top|bottom|left|right)(-start|-end)?$/g.test(this.currentPlacement))){var t=this.popperOptions,r=this.popperElm=this.popperElm||this.popper||this.$refs.popper,i=this.referenceElm=this.referenceElm||this.reference||this.$refs.reference;!i&&this.$slots.reference&&this.$slots.reference[0]&&(i=this.referenceElm=this.$slots.reference[0].elm),r&&i&&(this.visibleArrow&&this.appendArrow(r),this.appendToBody&&document.body.appendChild(this.popperElm),this.popperJS&&this.popperJS.destroy&&this.popperJS.destroy(),t.placement=this.currentPlacement,t.offset=this.offset,t.arrowOffset=this.arrowOffset,this.popperJS=new a(i,r,t),this.popperJS.onCreate((function(t){e.$emit("created",e),e.resetTransformOrigin(),e.$nextTick(e.updatePopper)})),"function"===typeof t.onUpdate&&this.popperJS.onUpdate(t.onUpdate),this.popperJS._popper.style.zIndex=o.PopupManager.nextZIndex(),this.popperElm.addEventListener("click",c))}},updatePopper:function(){var e=this.popperJS;e?(e.update(),e._popper&&(e._popper.style.zIndex=o.PopupManager.nextZIndex())):this.createPopper()},doDestroy:function(e){!this.popperJS||this.showPopper&&!e||(this.popperJS.destroy(),this.popperJS=null)},destroyPopper:function(){this.popperJS&&this.resetTransformOrigin()},resetTransformOrigin:function(){if(this.transformOrigin){var e={top:"bottom",bottom:"top",left:"right",right:"left"},t=this.popperJS._popper.getAttribute("x-placement").split("-")[0],r=e[t];this.popperJS._popper.style.transformOrigin="string"===typeof this.transformOrigin?this.transformOrigin:["top","bottom"].indexOf(t)>-1?"center "+r:r+" center"}},appendArrow:function(e){var t=void 0;if(!this.appended){for(var r in this.appended=!0,e.attributes)if(/^_v-/.test(e.attributes[r].name)){t=e.attributes[r].name;break}var i=document.createElement("div");t&&i.setAttribute(t,""),i.setAttribute("x-arrow",""),i.className="popper__arrow",e.appendChild(i)}}},beforeDestroy:function(){this.doDestroy(!0),this.popperElm&&this.popperElm.parentNode===document.body&&(this.popperElm.removeEventListener("click",c),document.body.removeChild(this.popperElm))},deactivated:function(){this.$options.beforeDestroy[0].call(this)}}},e9c4:function(e,t,r){var i=r("23e7"),n=r("da84"),o=r("d066"),s=r("2ba4"),a=r("e330"),c=r("d039"),l=n.Array,u=o("JSON","stringify"),d=a(/./.exec),h=a("".charAt),p=a("".charCodeAt),f=a("".replace),g=a(1..toString),m=/[\uD800-\uDFFF]/g,_=/^[\uD800-\uDBFF]$/,v=/^[\uDC00-\uDFFF]$/,E=function(e,t,r){var i=h(r,t-1),n=h(r,t+1);return d(_,e)&&!d(v,n)||d(v,e)&&!d(_,i)?"\\u"+g(p(e,0),16):e},A=c((function(){return'"\\udf06\\ud834"'!==u("\udf06\ud834")||'"\\udead"'!==u("\udead")}));u&&i({target:"JSON",stat:!0,forced:A},{stringify:function(e,t,r){for(var i=0,n=arguments.length,o=l(n);i<n;i++)o[i]=arguments[i];var a=s(u,null,o);return"string"==typeof a?f(a,m,E):a}})},ea34:function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},eac5:function(e,t,r){var i=r("861d"),n=Math.floor;e.exports=Number.isInteger||function(e){return!i(e)&&isFinite(e)&&n(e)===e}},ebb5:function(e,t,r){"use strict";var i,n,o,s=r("a981"),a=r("83ab"),c=r("da84"),l=r("1626"),u=r("861d"),d=r("1a2d"),h=r("f5df"),p=r("0d51"),f=r("9112"),g=r("6eeb"),m=r("9bf2").f,_=r("3a9b"),v=r("e163"),E=r("d2bb"),A=r("b622"),y=r("90e3"),S=c.Int8Array,C=S&&S.prototype,T=c.Uint8ClampedArray,b=T&&T.prototype,I=S&&v(S),R=C&&v(C),w=Object.prototype,k=c.TypeError,O=A("toStringTag"),N=y("TYPED_ARRAY_TAG"),L=y("TYPED_ARRAY_CONSTRUCTOR"),P=s&&!!E&&"Opera"!==h(c.opera),D=!1,M={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},x={BigInt64Array:8,BigUint64Array:8},B=function(e){if(!u(e))return!1;var t=h(e);return"DataView"===t||d(M,t)||d(x,t)},U=function(e){if(!u(e))return!1;var t=h(e);return d(M,t)||d(x,t)},F=function(e){if(U(e))return e;throw k("Target is not a typed array")},V=function(e){if(l(e)&&(!E||_(I,e)))return e;throw k(p(e)+" is not a typed array constructor")},j=function(e,t,r,i){if(a){if(r)for(var n in M){var o=c[n];if(o&&d(o.prototype,e))try{delete o.prototype[e]}catch(s){try{o.prototype[e]=t}catch(l){}}}R[e]&&!r||g(R,e,r?t:P&&C[e]||t,i)}},G=function(e,t,r){var i,n;if(a){if(E){if(r)for(i in M)if(n=c[i],n&&d(n,e))try{delete n[e]}catch(o){}if(I[e]&&!r)return;try{return g(I,e,r?t:P&&I[e]||t)}catch(o){}}for(i in M)n=c[i],!n||n[e]&&!r||g(n,e,t)}};for(i in M)n=c[i],o=n&&n.prototype,o?f(o,L,n):P=!1;for(i in x)n=c[i],o=n&&n.prototype,o&&f(o,L,n);if((!P||!l(I)||I===Function.prototype)&&(I=function(){throw k("Incorrect invocation")},P))for(i in M)c[i]&&E(c[i],I);if((!P||!R||R===w)&&(R=I.prototype,P))for(i in M)c[i]&&E(c[i].prototype,R);if(P&&v(b)!==R&&E(b,R),a&&!d(R,O))for(i in D=!0,m(R,O,{get:function(){return u(this)?this[N]:void 0}}),M)c[i]&&f(c[i],N,i);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:P,TYPED_ARRAY_CONSTRUCTOR:L,TYPED_ARRAY_TAG:D&&N,aTypedArray:F,aTypedArrayConstructor:V,exportTypedArrayMethod:j,exportTypedArrayStaticMethod:G,isView:B,isTypedArray:U,TypedArray:I,TypedArrayPrototype:R}},eedf:function(e,t,r){e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=86)}({0:function(e,t,r){"use strict";function i(e,t,r,i,n,o,s,a){var c,l="function"===typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=r,l._compiled=!0),i&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),s?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},l._ssrRegister=c):n&&(c=a?function(){n.call(this,this.$root.$options.shadowRoot)}:n),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(e,t){return c.call(t),u(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,c):[c]}return{exports:e,options:l}}r.d(t,"a",(function(){return i}))},86:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("button",{staticClass:"el-button",class:[e.type?"el-button--"+e.type:"",e.buttonSize?"el-button--"+e.buttonSize:"",{"is-disabled":e.buttonDisabled,"is-loading":e.loading,"is-plain":e.plain,"is-round":e.round,"is-circle":e.circle}],attrs:{disabled:e.buttonDisabled||e.loading,autofocus:e.autofocus,type:e.nativeType},on:{click:e.handleClick}},[e.loading?r("i",{staticClass:"el-icon-loading"}):e._e(),e.icon&&!e.loading?r("i",{class:e.icon}):e._e(),e.$slots.default?r("span",[e._t("default")],2):e._e()])},n=[];i._withStripped=!0;var o={name:"ElButton",inject:{elForm:{default:""},elFormItem:{default:""}},props:{type:{type:String,default:"default"},size:String,icon:{type:String,default:""},nativeType:{type:String,default:"button"},loading:Boolean,disabled:Boolean,plain:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean},computed:{_elFormItemSize:function(){return(this.elFormItem||{}).elFormItemSize},buttonSize:function(){return this.size||this._elFormItemSize||(this.$ELEMENT||{}).size},buttonDisabled:function(){return this.disabled||(this.elForm||{}).disabled}},methods:{handleClick:function(e){this.$emit("click",e)}}},s=o,a=r(0),c=Object(a["a"])(s,i,n,!1,null,null,null);c.options.__file="packages/button/src/button.vue";var l=c.exports;l.install=function(e){e.component(l.name,l)};t["default"]=l}})},ef08:function(e,t){var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},f069:function(e,t,r){"use strict";var i=r("59ed"),n=function(e){var t,r;this.promise=new e((function(e,i){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=i})),this.resolve=i(t),this.reject=i(r)};e.exports.f=function(e){return new n(e)}},f0d9:function(e,t,r){"use strict";t.__esModule=!0,t.default={el:{colorpicker:{confirm:"确定",clear:"清空"},datepicker:{now:"此刻",today:"今天",cancel:"取消",clear:"清空",confirm:"确定",selectDate:"选择日期",selectTime:"选择时间",startDate:"开始日期",startTime:"开始时间",endDate:"结束日期",endTime:"结束时间",prevYear:"前一年",nextYear:"后一年",prevMonth:"上个月",nextMonth:"下个月",year:"年",month1:"1 月",month2:"2 月",month3:"3 月",month4:"4 月",month5:"5 月",month6:"6 月",month7:"7 月",month8:"8 月",month9:"9 月",month10:"10 月",month11:"11 月",month12:"12 月",weeks:{sun:"日",mon:"一",tue:"二",wed:"三",thu:"四",fri:"五",sat:"六"},months:{jan:"一月",feb:"二月",mar:"三月",apr:"四月",may:"五月",jun:"六月",jul:"七月",aug:"八月",sep:"九月",oct:"十月",nov:"十一月",dec:"十二月"}},select:{loading:"加载中",noMatch:"无匹配数据",noData:"无数据",placeholder:"请选择"},cascader:{noMatch:"无匹配数据",loading:"加载中",placeholder:"请选择",noData:"暂无数据"},pagination:{goto:"前往",pagesize:"条/页",total:"共 {total} 条",pageClassifier:"页"},messagebox:{title:"提示",confirm:"确定",cancel:"取消",error:"输入的数据不合法!"},upload:{deleteTip:"按 delete 键可删除",delete:"删除",preview:"查看图片",continue:"继续上传"},table:{emptyText:"暂无数据",confirmFilter:"筛选",resetFilter:"重置",clearFilter:"全部",sumText:"合计"},tree:{emptyText:"暂无数据"},transfer:{noMatch:"无匹配数据",noData:"无数据",titles:["列表 1","列表 2"],filterPlaceholder:"请输入搜索内容",noCheckedFormat:"共 {total} 项",hasCheckedFormat:"已选 {checked}/{total} 项"},image:{error:"加载失败"},pageHeader:{title:"返回"},popconfirm:{confirmButtonText:"确定",cancelButtonText:"取消"},empty:{description:"暂无数据"}}}},f183:function(e,t,r){var i=r("23e7"),n=r("e330"),o=r("d012"),s=r("861d"),a=r("1a2d"),c=r("9bf2").f,l=r("241c"),u=r("057f"),d=r("4fad"),h=r("90e3"),p=r("bb2f"),f=!1,g=h("meta"),m=0,_=function(e){c(e,g,{value:{objectID:"O"+m++,weakData:{}}})},v=function(e,t){if(!s(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,g)){if(!d(e))return"F";if(!t)return"E";_(e)}return e[g].objectID},E=function(e,t){if(!a(e,g)){if(!d(e))return!0;if(!t)return!1;_(e)}return e[g].weakData},A=function(e){return p&&f&&d(e)&&!a(e,g)&&_(e),e},y=function(){S.enable=function(){},f=!0;var e=l.f,t=n([].splice),r={};r[g]=1,e(r).length&&(l.f=function(r){for(var i=e(r),n=0,o=i.length;n<o;n++)if(i[n]===g){t(i,n,1);break}return i},i({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:u.f}))},S=e.exports={enable:y,fastKey:v,getWeakData:E,onFreeze:A};o[g]=!0},f36a:function(e,t,r){var i=r("e330");e.exports=i([].slice)},f3ad:function(e,t,r){e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=73)}({0:function(e,t,r){"use strict";function i(e,t,r,i,n,o,s,a){var c,l="function"===typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=r,l._compiled=!0),i&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),s?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},l._ssrRegister=c):n&&(c=a?function(){n.call(this,this.$root.$options.shadowRoot)}:n),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(e,t){return c.call(t),u(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,c):[c]}return{exports:e,options:l}}r.d(t,"a",(function(){return i}))},11:function(e,t){e.exports=r("2bb5")},21:function(e,t){e.exports=r("d397")},4:function(e,t){e.exports=r("d010")},73:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:["textarea"===e.type?"el-textarea":"el-input",e.inputSize?"el-input--"+e.inputSize:"",{"is-disabled":e.inputDisabled,"is-exceed":e.inputExceed,"el-input-group":e.$slots.prepend||e.$slots.append,"el-input-group--append":e.$slots.append,"el-input-group--prepend":e.$slots.prepend,"el-input--prefix":e.$slots.prefix||e.prefixIcon,"el-input--suffix":e.$slots.suffix||e.suffixIcon||e.clearable||e.showPassword}],on:{mouseenter:function(t){e.hovering=!0},mouseleave:function(t){e.hovering=!1}}},["textarea"!==e.type?[e.$slots.prepend?r("div",{staticClass:"el-input-group__prepend"},[e._t("prepend")],2):e._e(),"textarea"!==e.type?r("input",e._b({ref:"input",staticClass:"el-input__inner",attrs:{tabindex:e.tabindex,type:e.showPassword?e.passwordVisible?"text":"password":e.type,disabled:e.inputDisabled,readonly:e.readonly,autocomplete:e.autoComplete||e.autocomplete,"aria-label":e.label},on:{compositionstart:e.handleCompositionStart,compositionupdate:e.handleCompositionUpdate,compositionend:e.handleCompositionEnd,input:e.handleInput,focus:e.handleFocus,blur:e.handleBlur,change:e.handleChange}},"input",e.$attrs,!1)):e._e(),e.$slots.prefix||e.prefixIcon?r("span",{staticClass:"el-input__prefix"},[e._t("prefix"),e.prefixIcon?r("i",{staticClass:"el-input__icon",class:e.prefixIcon}):e._e()],2):e._e(),e.getSuffixVisible()?r("span",{staticClass:"el-input__suffix"},[r("span",{staticClass:"el-input__suffix-inner"},[e.showClear&&e.showPwdVisible&&e.isWordLimitVisible?e._e():[e._t("suffix"),e.suffixIcon?r("i",{staticClass:"el-input__icon",class:e.suffixIcon}):e._e()],e.showClear?r("i",{staticClass:"el-input__icon el-icon-circle-close el-input__clear",on:{mousedown:function(e){e.preventDefault()},click:e.clear}}):e._e(),e.showPwdVisible?r("i",{staticClass:"el-input__icon el-icon-view el-input__clear",on:{click:e.handlePasswordVisible}}):e._e(),e.isWordLimitVisible?r("span",{staticClass:"el-input__count"},[r("span",{staticClass:"el-input__count-inner"},[e._v("\n            "+e._s(e.textLength)+"/"+e._s(e.upperLimit)+"\n          ")])]):e._e()],2),e.validateState?r("i",{staticClass:"el-input__icon",class:["el-input__validateIcon",e.validateIcon]}):e._e()]):e._e(),e.$slots.append?r("div",{staticClass:"el-input-group__append"},[e._t("append")],2):e._e()]:r("textarea",e._b({ref:"textarea",staticClass:"el-textarea__inner",style:e.textareaStyle,attrs:{tabindex:e.tabindex,disabled:e.inputDisabled,readonly:e.readonly,autocomplete:e.autoComplete||e.autocomplete,"aria-label":e.label},on:{compositionstart:e.handleCompositionStart,compositionupdate:e.handleCompositionUpdate,compositionend:e.handleCompositionEnd,input:e.handleInput,focus:e.handleFocus,blur:e.handleBlur,change:e.handleChange}},"textarea",e.$attrs,!1)),e.isWordLimitVisible&&"textarea"===e.type?r("span",{staticClass:"el-input__count"},[e._v(e._s(e.textLength)+"/"+e._s(e.upperLimit))]):e._e()],2)},n=[];i._withStripped=!0;var o=r(4),s=r.n(o),a=r(11),c=r.n(a),l=void 0,u="\n  height:0 !important;\n  visibility:hidden !important;\n  overflow:hidden !important;\n  position:absolute !important;\n  z-index:-1000 !important;\n  top:0 !important;\n  right:0 !important\n",d=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function h(e){var t=window.getComputedStyle(e),r=t.getPropertyValue("box-sizing"),i=parseFloat(t.getPropertyValue("padding-bottom"))+parseFloat(t.getPropertyValue("padding-top")),n=parseFloat(t.getPropertyValue("border-bottom-width"))+parseFloat(t.getPropertyValue("border-top-width")),o=d.map((function(e){return e+":"+t.getPropertyValue(e)})).join(";");return{contextStyle:o,paddingSize:i,borderSize:n,boxSizing:r}}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;l||(l=document.createElement("textarea"),document.body.appendChild(l));var i=h(e),n=i.paddingSize,o=i.borderSize,s=i.boxSizing,a=i.contextStyle;l.setAttribute("style",a+";"+u),l.value=e.value||e.placeholder||"";var c=l.scrollHeight,d={};"border-box"===s?c+=o:"content-box"===s&&(c-=n),l.value="";var p=l.scrollHeight-n;if(null!==t){var f=p*t;"border-box"===s&&(f=f+n+o),c=Math.max(f,c),d.minHeight=f+"px"}if(null!==r){var g=p*r;"border-box"===s&&(g=g+n+o),c=Math.min(g,c)}return d.height=c+"px",l.parentNode&&l.parentNode.removeChild(l),l=null,d}var f=r(9),g=r.n(f),m=r(21),_={name:"ElInput",componentName:"ElInput",mixins:[s.a,c.a],inheritAttrs:!1,inject:{elForm:{default:""},elFormItem:{default:""}},data:function(){return{textareaCalcStyle:{},hovering:!1,focused:!1,isComposing:!1,passwordVisible:!1}},props:{value:[String,Number],size:String,resize:String,form:String,disabled:Boolean,readonly:Boolean,type:{type:String,default:"text"},autosize:{type:[Boolean,Object],default:!1},autocomplete:{type:String,default:"off"},autoComplete:{type:String,validator:function(e){return!0}},validateEvent:{type:Boolean,default:!0},suffixIcon:String,prefixIcon:String,label:String,clearable:{type:Boolean,default:!1},showPassword:{type:Boolean,default:!1},showWordLimit:{type:Boolean,default:!1},tabindex:String},computed:{_elFormItemSize:function(){return(this.elFormItem||{}).elFormItemSize},validateState:function(){return this.elFormItem?this.elFormItem.validateState:""},needStatusIcon:function(){return!!this.elForm&&this.elForm.statusIcon},validateIcon:function(){return{validating:"el-icon-loading",success:"el-icon-circle-check",error:"el-icon-circle-close"}[this.validateState]},textareaStyle:function(){return g()({},this.textareaCalcStyle,{resize:this.resize})},inputSize:function(){return this.size||this._elFormItemSize||(this.$ELEMENT||{}).size},inputDisabled:function(){return this.disabled||(this.elForm||{}).disabled},nativeInputValue:function(){return null===this.value||void 0===this.value?"":String(this.value)},showClear:function(){return this.clearable&&!this.inputDisabled&&!this.readonly&&this.nativeInputValue&&(this.focused||this.hovering)},showPwdVisible:function(){return this.showPassword&&!this.inputDisabled&&!this.readonly&&(!!this.nativeInputValue||this.focused)},isWordLimitVisible:function(){return this.showWordLimit&&this.$attrs.maxlength&&("text"===this.type||"textarea"===this.type)&&!this.inputDisabled&&!this.readonly&&!this.showPassword},upperLimit:function(){return this.$attrs.maxlength},textLength:function(){return"number"===typeof this.value?String(this.value).length:(this.value||"").length},inputExceed:function(){return this.isWordLimitVisible&&this.textLength>this.upperLimit}},watch:{value:function(e){this.$nextTick(this.resizeTextarea),this.validateEvent&&this.dispatch("ElFormItem","el.form.change",[e])},nativeInputValue:function(){this.setNativeInputValue()},type:function(){var e=this;this.$nextTick((function(){e.setNativeInputValue(),e.resizeTextarea(),e.updateIconOffset()}))}},methods:{focus:function(){this.getInput().focus()},blur:function(){this.getInput().blur()},getMigratingConfig:function(){return{props:{icon:"icon is removed, use suffix-icon / prefix-icon instead.","on-icon-click":"on-icon-click is removed."},events:{click:"click is removed."}}},handleBlur:function(e){this.focused=!1,this.$emit("blur",e),this.validateEvent&&this.dispatch("ElFormItem","el.form.blur",[this.value])},select:function(){this.getInput().select()},resizeTextarea:function(){if(!this.$isServer){var e=this.autosize,t=this.type;if("textarea"===t)if(e){var r=e.minRows,i=e.maxRows;this.textareaCalcStyle=p(this.$refs.textarea,r,i)}else this.textareaCalcStyle={minHeight:p(this.$refs.textarea).minHeight}}},setNativeInputValue:function(){var e=this.getInput();e&&e.value!==this.nativeInputValue&&(e.value=this.nativeInputValue)},handleFocus:function(e){this.focused=!0,this.$emit("focus",e)},handleCompositionStart:function(){this.isComposing=!0},handleCompositionUpdate:function(e){var t=e.target.value,r=t[t.length-1]||"";this.isComposing=!Object(m["isKorean"])(r)},handleCompositionEnd:function(e){this.isComposing&&(this.isComposing=!1,this.handleInput(e))},handleInput:function(e){this.isComposing||e.target.value!==this.nativeInputValue&&(this.$emit("input",e.target.value),this.$nextTick(this.setNativeInputValue))},handleChange:function(e){this.$emit("change",e.target.value)},calcIconOffset:function(e){var t=[].slice.call(this.$el.querySelectorAll(".el-input__"+e)||[]);if(t.length){for(var r=null,i=0;i<t.length;i++)if(t[i].parentNode===this.$el){r=t[i];break}if(r){var n={suffix:"append",prefix:"prepend"},o=n[e];this.$slots[o]?r.style.transform="translateX("+("suffix"===e?"-":"")+this.$el.querySelector(".el-input-group__"+o).offsetWidth+"px)":r.removeAttribute("style")}}},updateIconOffset:function(){this.calcIconOffset("prefix"),this.calcIconOffset("suffix")},clear:function(){this.$emit("input",""),this.$emit("change",""),this.$emit("clear")},handlePasswordVisible:function(){var e=this;this.passwordVisible=!this.passwordVisible,this.$nextTick((function(){e.focus()}))},getInput:function(){return this.$refs.input||this.$refs.textarea},getSuffixVisible:function(){return this.$slots.suffix||this.suffixIcon||this.showClear||this.showPassword||this.isWordLimitVisible||this.validateState&&this.needStatusIcon}},created:function(){this.$on("inputSelect",this.select)},mounted:function(){this.setNativeInputValue(),this.resizeTextarea(),this.updateIconOffset()},updated:function(){this.$nextTick(this.updateIconOffset)}},v=_,E=r(0),A=Object(E["a"])(v,i,n,!1,null,null,null);A.options.__file="packages/input/src/input.vue";var y=A.exports;y.install=function(e){e.component(y.name,y)};t["default"]=y},9:function(e,t){e.exports=r("7f4d")}})},f494:function(e,t,r){e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=108)}({0:function(e,t,r){"use strict";function i(e,t,r,i,n,o,s,a){var c,l="function"===typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=r,l._compiled=!0),i&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),s?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},l._ssrRegister=c):n&&(c=a?function(){n.call(this,this.$root.$options.shadowRoot)}:n),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(e,t){return c.call(t),u(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,c):[c]}return{exports:e,options:l}}r.d(t,"a",(function(){return i}))},108:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("label",{staticClass:"el-radio",class:[e.border&&e.radioSize?"el-radio--"+e.radioSize:"",{"is-disabled":e.isDisabled},{"is-focus":e.focus},{"is-bordered":e.border},{"is-checked":e.model===e.label}],attrs:{role:"radio","aria-checked":e.model===e.label,"aria-disabled":e.isDisabled,tabindex:e.tabIndex},on:{keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"]))return null;t.stopPropagation(),t.preventDefault(),e.model=e.isDisabled?e.model:e.label}}},[r("span",{staticClass:"el-radio__input",class:{"is-disabled":e.isDisabled,"is-checked":e.model===e.label}},[r("span",{staticClass:"el-radio__inner"}),r("input",{directives:[{name:"model",rawName:"v-model",value:e.model,expression:"model"}],ref:"radio",staticClass:"el-radio__original",attrs:{type:"radio","aria-hidden":"true",name:e.name,disabled:e.isDisabled,tabindex:"-1",autocomplete:"off"},domProps:{value:e.label,checked:e._q(e.model,e.label)},on:{focus:function(t){e.focus=!0},blur:function(t){e.focus=!1},change:[function(t){e.model=e.label},e.handleChange]}})]),r("span",{staticClass:"el-radio__label",on:{keydown:function(e){e.stopPropagation()}}},[e._t("default"),e.$slots.default?e._e():[e._v(e._s(e.label))]],2)])},n=[];i._withStripped=!0;var o=r(4),s=r.n(o),a={name:"ElRadio",mixins:[s.a],inject:{elForm:{default:""},elFormItem:{default:""}},componentName:"ElRadio",props:{value:{},label:{},disabled:Boolean,name:String,border:Boolean,size:String},data:function(){return{focus:!1}},computed:{isGroup:function(){var e=this.$parent;while(e){if("ElRadioGroup"===e.$options.componentName)return this._radioGroup=e,!0;e=e.$parent}return!1},model:{get:function(){return this.isGroup?this._radioGroup.value:this.value},set:function(e){this.isGroup?this.dispatch("ElRadioGroup","input",[e]):this.$emit("input",e),this.$refs.radio&&(this.$refs.radio.checked=this.model===this.label)}},_elFormItemSize:function(){return(this.elFormItem||{}).elFormItemSize},radioSize:function(){var e=this.size||this._elFormItemSize||(this.$ELEMENT||{}).size;return this.isGroup&&this._radioGroup.radioGroupSize||e},isDisabled:function(){return this.isGroup?this._radioGroup.disabled||this.disabled||(this.elForm||{}).disabled:this.disabled||(this.elForm||{}).disabled},tabIndex:function(){return this.isDisabled||this.isGroup&&this.model!==this.label?-1:0}},methods:{handleChange:function(){var e=this;this.$nextTick((function(){e.$emit("change",e.model),e.isGroup&&e.dispatch("ElRadioGroup","handleChange",e.model)}))}}},c=a,l=r(0),u=Object(l["a"])(c,i,n,!1,null,null,null);u.options.__file="packages/radio/src/radio.vue";var d=u.exports;d.install=function(e){e.component(d.name,d)};t["default"]=d},4:function(e,t){e.exports=r("d010")}})},f5df:function(e,t,r){var i=r("da84"),n=r("00ee"),o=r("1626"),s=r("c6b6"),a=r("b622"),c=a("toStringTag"),l=i.Object,u="Arguments"==s(function(){return arguments}()),d=function(e,t){try{return e[t]}catch(r){}};e.exports=n?s:function(e){var t,r,i;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=d(t=l(e),c))?r:u?s(t):"Object"==(i=s(t))&&o(t.callee)?"Arguments":i}},f6b4:function(e,t,r){"use strict";var i=r("c532");function n(){this.handlers=[]}n.prototype.use=function(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1},n.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},n.prototype.forEach=function(e){i.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=n},f772:function(e,t,r){var i=r("5692"),n=r("90e3"),o=i("keys");e.exports=function(e){return o[e]||(o[e]=n(e))}},f893:function(e,t,r){e.exports={default:r("8119"),__esModule:!0}},f8c9:function(e,t,r){var i=r("23e7"),n=r("da84"),o=r("d44e");i({global:!0},{Reflect:{}}),o(n.Reflect,"Reflect",!0)},f8cd:function(e,t,r){var i=r("da84"),n=r("5926"),o=i.RangeError;e.exports=function(e){var t=n(e);if(t<0)throw o("The argument can't be less than 0");return t}},faf5:function(e,t,r){e.exports=!r("0bad")&&!r("4b8b")((function(){return 7!=Object.defineProperty(r("05f5")("div"),"a",{get:function(){return 7}}).a}))},fb2c:function(e,t,r){var i=r("74e8");i("Uint32",(function(e){return function(t,r,i){return e(this,t,r,i)}}))},fb6a:function(e,t,r){"use strict";var i=r("23e7"),n=r("da84"),o=r("e8b5"),s=r("68ee"),a=r("861d"),c=r("23cb"),l=r("07fa"),u=r("fc6a"),d=r("8418"),h=r("b622"),p=r("1dde"),f=r("f36a"),g=p("slice"),m=h("species"),_=n.Array,v=Math.max;i({target:"Array",proto:!0,forced:!g},{slice:function(e,t){var r,i,n,h=u(this),p=l(h),g=c(e,p),E=c(void 0===t?p:t,p);if(o(h)&&(r=h.constructor,s(r)&&(r===_||o(r.prototype))?r=void 0:a(r)&&(r=r[m],null===r&&(r=void 0)),r===_||void 0===r))return f(h,g,E);for(i=new(void 0===r?_:r)(v(E-g,0)),n=0;g<E;g++,n++)g in h&&d(i,n,h[g]);return i.length=n,i}})},fc5e:function(e,t){var r=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:r)(e)}},fc6a:function(e,t,r){var i=r("44ad"),n=r("1d80");e.exports=function(e){return i(n(e))}},fcc3:function(module,exports,__webpack_require__){!function(e,t){module.exports=t(__webpack_require__("d2b2"))}("undefined"!=typeof self&&self,(function(__WEBPACK_EXTERNAL_MODULE__4119__){return function(){var __webpack_modules__={4537:function(e){"use strict";e.exports=function(e,t){for(var r=new Array(arguments.length-1),i=0,n=2,o=!0;n<arguments.length;)r[i++]=arguments[n++];return new Promise((function(n,s){r[i]=function(e){if(o)if(o=!1,e)s(e);else{for(var t=new Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];n.apply(null,t)}};try{e.apply(t||null,r)}catch(e){o&&(o=!1,s(e))}}))}},7419:function(e,t){"use strict";var r=t;r.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};for(var i=new Array(64),n=new Array(123),o=0;o<64;)n[i[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;r.encode=function(e,t,r){for(var n,o=null,s=[],a=0,c=0;t<r;){var l=e[t++];switch(c){case 0:s[a++]=i[l>>2],n=(3&l)<<4,c=1;break;case 1:s[a++]=i[n|l>>4],n=(15&l)<<2,c=2;break;case 2:s[a++]=i[n|l>>6],s[a++]=i[63&l],c=0}a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0)}return c&&(s[a++]=i[n],s[a++]=61,1===c&&(s[a++]=61)),o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var s="invalid encoding";r.decode=function(e,t,r){for(var i,o=r,a=0,c=0;c<e.length;){var l=e.charCodeAt(c++);if(61===l&&a>1)break;if(void 0===(l=n[l]))throw Error(s);switch(a){case 0:i=l,a=1;break;case 1:t[r++]=i<<2|(48&l)>>4,i=l,a=2;break;case 2:t[r++]=(15&i)<<4|(60&l)>>2,i=l,a=3;break;case 3:t[r++]=(3&i)<<6|l,a=0}}if(1===a)throw Error(s);return r-o},r.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},9211:function(e){"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],i=0;i<r.length;)r[i].fn===t?r.splice(i,1):++i;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],i=1;i<arguments.length;)r.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,r)}return this}},945:function(e){"use strict";function t(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),i=128===r[3];function n(e,i,n){t[0]=e,i[n]=r[0],i[n+1]=r[1],i[n+2]=r[2],i[n+3]=r[3]}function o(e,i,n){t[0]=e,i[n]=r[3],i[n+1]=r[2],i[n+2]=r[1],i[n+3]=r[0]}function s(e,i){return r[0]=e[i],r[1]=e[i+1],r[2]=e[i+2],r[3]=e[i+3],t[0]}function a(e,i){return r[3]=e[i],r[2]=e[i+1],r[1]=e[i+2],r[0]=e[i+3],t[0]}e.writeFloatLE=i?n:o,e.writeFloatBE=i?o:n,e.readFloatLE=i?s:a,e.readFloatBE=i?a:s}():function(){function t(e,t,r,i){var n=t<0?1:0;if(n&&(t=-t),0===t)e(1/t>0?0:2147483648,r,i);else if(isNaN(t))e(2143289344,r,i);else if(t>34028234663852886e22)e((n<<31|2139095040)>>>0,r,i);else if(t<11754943508222875e-54)e((n<<31|Math.round(t/1401298464324817e-60))>>>0,r,i);else{var o=Math.floor(Math.log(t)/Math.LN2);e((n<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,r,i)}}function s(e,t,r){var i=e(t,r),n=2*(i>>31)+1,o=i>>>23&255,s=8388607&i;return 255===o?s?NaN:n*(1/0):0===o?1401298464324817e-60*n*s:n*Math.pow(2,o-150)*(s+8388608)}e.writeFloatLE=t.bind(null,r),e.writeFloatBE=t.bind(null,i),e.readFloatLE=s.bind(null,n),e.readFloatBE=s.bind(null,o)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),i=128===r[7];function n(e,i,n){t[0]=e,i[n]=r[0],i[n+1]=r[1],i[n+2]=r[2],i[n+3]=r[3],i[n+4]=r[4],i[n+5]=r[5],i[n+6]=r[6],i[n+7]=r[7]}function o(e,i,n){t[0]=e,i[n]=r[7],i[n+1]=r[6],i[n+2]=r[5],i[n+3]=r[4],i[n+4]=r[3],i[n+5]=r[2],i[n+6]=r[1],i[n+7]=r[0]}function s(e,i){return r[0]=e[i],r[1]=e[i+1],r[2]=e[i+2],r[3]=e[i+3],r[4]=e[i+4],r[5]=e[i+5],r[6]=e[i+6],r[7]=e[i+7],t[0]}function a(e,i){return r[7]=e[i],r[6]=e[i+1],r[5]=e[i+2],r[4]=e[i+3],r[3]=e[i+4],r[2]=e[i+5],r[1]=e[i+6],r[0]=e[i+7],t[0]}e.writeDoubleLE=i?n:o,e.writeDoubleBE=i?o:n,e.readDoubleLE=i?s:a,e.readDoubleBE=i?a:s}():function(){function t(e,t,r,i,n,o){var s=i<0?1:0;if(s&&(i=-i),0===i)e(0,n,o+t),e(1/i>0?0:2147483648,n,o+r);else if(isNaN(i))e(0,n,o+t),e(2146959360,n,o+r);else if(i>17976931348623157e292)e(0,n,o+t),e((s<<31|2146435072)>>>0,n,o+r);else{var a;if(i<22250738585072014e-324)e((a=i/5e-324)>>>0,n,o+t),e((s<<31|a/4294967296)>>>0,n,o+r);else{var c=Math.floor(Math.log(i)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(a=i*Math.pow(2,-c))>>>0,n,o+t),e((s<<31|c+1023<<20|1048576*a&1048575)>>>0,n,o+r)}}}function s(e,t,r,i,n){var o=e(i,n+t),s=e(i,n+r),a=2*(s>>31)+1,c=s>>>20&2047,l=4294967296*(1048575&s)+o;return 2047===c?l?NaN:a*(1/0):0===c?5e-324*a*l:a*Math.pow(2,c-1075)*(l+4503599627370496)}e.writeDoubleLE=t.bind(null,r,0,4),e.writeDoubleBE=t.bind(null,i,4,0),e.readDoubleLE=s.bind(null,n,0,4),e.readDoubleBE=s.bind(null,o,4,0)}(),e}function r(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function i(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function n(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function o(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},7199:function(module){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},6662:function(e){"use strict";e.exports=function(e,t,r){var i=r||8192,n=i>>>1,o=null,s=i;return function(r){if(r<1||r>n)return e(r);s+r>i&&(o=e(i),s=0);var a=t.call(o,s,s+=r);return 7&s&&(s=1+(7|s)),a}}},4997:function(e,t){"use strict";var r=t;r.length=function(e){for(var t=0,r=0,i=0;i<e.length;++i)(r=e.charCodeAt(i))<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(i+1))?(++i,t+=4):t+=3;return t},r.read=function(e,t,r){if(r-t<1)return"";for(var i,n=null,o=[],s=0;t<r;)(i=e[t++])<128?o[s++]=i:i>191&&i<224?o[s++]=(31&i)<<6|63&e[t++]:i>239&&i<365?(i=((7&i)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[s++]=55296+(i>>10),o[s++]=56320+(1023&i)):o[s++]=(15&i)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,o)),s=0);return n?(s&&n.push(String.fromCharCode.apply(String,o.slice(0,s))),n.join("")):String.fromCharCode.apply(String,o.slice(0,s))},r.write=function(e,t,r){for(var i,n,o=r,s=0;s<e.length;++s)(i=e.charCodeAt(s))<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=63&i|128):55296==(64512&i)&&56320==(64512&(n=e.charCodeAt(s+1)))?(i=65536+((1023&i)<<10)+(1023&n),++s,t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=63&i|128):(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=63&i|128);return r-o}},2100:function(e,t,r){"use strict";e.exports=r(9482)},9482:function(e,t,r){"use strict";var i=t;function n(){i.util._configure(),i.Writer._configure(i.BufferWriter),i.Reader._configure(i.BufferReader)}i.build="minimal",i.Writer=r(1173),i.BufferWriter=r(3155),i.Reader=r(1408),i.BufferReader=r(593),i.util=r(9693),i.rpc=r(5994),i.roots=r(5054),i.configure=n,n()},1408:function(e,t,r){"use strict";e.exports=c;var i,n=r(9693),o=n.LongBits,s=n.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var l,u="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},d=function(){return n.Buffer?function(e){return(c.create=function(e){return n.Buffer.isBuffer(e)?new i(e):u(e)})(e)}:u};function h(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function p(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw a(this,8);return new o(p(this.buf,this.pos+=4),p(this.buf,this.pos+=4))}c.create=d(),c.prototype._slice=n.Array.prototype.subarray||n.Array.prototype.slice,c.prototype.uint32=(l=4294967295,function(){if(l=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return l;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return l}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return p(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|p(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=n.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=n.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)},c.prototype.string=function(){var e=this.bytes();return s.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){i=e,c.create=d(),i._configure();var t=n.Long?"toLong":"toNumber";n.merge(c.prototype,{int64:function(){return h.call(this)[t](!1)},uint64:function(){return h.call(this)[t](!0)},sint64:function(){return h.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},593:function(e,t,r){"use strict";e.exports=o;var i=r(1408);(o.prototype=Object.create(i.prototype)).constructor=o;var n=r(9693);function o(e){i.call(this,e)}o._configure=function(){n.Buffer&&(o.prototype._slice=n.Buffer.prototype.slice)},o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},o._configure()},5054:function(e){"use strict";e.exports={}},5994:function(e,t,r){"use strict";t.Service=r(7948)},7948:function(e,t,r){"use strict";e.exports=n;var i=r(9693);function n(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");i.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}(n.prototype=Object.create(i.EventEmitter.prototype)).constructor=n,n.prototype.rpcCall=function e(t,r,n,o,s){if(!o)throw TypeError("request must be specified");var a=this;if(!s)return i.asPromise(e,a,t,r,n,o);if(a.rpcImpl)try{return a.rpcImpl(t,r[a.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,r){if(e)return a.emit("error",e,t),s(e);if(null!==r){if(!(r instanceof n))try{r=n[a.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return a.emit("error",e,t),s(e)}return a.emit("data",r,t),s(null,r)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){s(e)}),0)}else setTimeout((function(){s(Error("already ended"))}),0)},n.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},1945:function(e,t,r){"use strict";e.exports=n;var i=r(9693);function n(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=n.zero=new n(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var s=n.zeroHash="\0\0\0\0\0\0\0\0";n.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var r=e>>>0,i=(e-r)/4294967296>>>0;return t&&(i=~i>>>0,r=~r>>>0,++r>4294967295&&(r=0,++i>4294967295&&(i=0))),new n(r,i)},n.from=function(e){if("number"==typeof e)return n.fromNumber(e);if(i.isString(e)){if(!i.Long)return n.fromNumber(parseInt(e,10));e=i.Long.fromString(e)}return e.low||e.high?new n(e.low>>>0,e.high>>>0):o},n.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},n.prototype.toLong=function(e){return i.Long?new i.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;n.fromHash=function(e){return e===s?o:new n((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},n.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},n.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},n.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},n.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}},9693:function(e,t,r){"use strict";var i=t;function n(e,t,r){for(var i=Object.keys(t),n=0;n<i.length;++n)void 0!==e[i[n]]&&r||(e[i[n]]=t[i[n]]);return e}function o(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&n(this,r)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}i.asPromise=r(4537),i.base64=r(7419),i.EventEmitter=r(9211),i.float=r(945),i.inquire=r(7199),i.utf8=r(4997),i.pool=r(6662),i.LongBits=r(1945),i.isNode=Boolean(void 0!==r.g&&r.g&&r.g.process&&r.g.process.versions&&r.g.process.versions.node),i.global=i.isNode&&r.g||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,i.emptyArray=Object.freeze?Object.freeze([]):[],i.emptyObject=Object.freeze?Object.freeze({}):{},i.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},i.isString=function(e){return"string"==typeof e||e instanceof String},i.isObject=function(e){return e&&"object"==typeof e},i.isset=i.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},i.Buffer=function(){try{var e=i.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),i._Buffer_from=null,i._Buffer_allocUnsafe=null,i.newBuffer=function(e){return"number"==typeof e?i.Buffer?i._Buffer_allocUnsafe(e):new i.Array(e):i.Buffer?i._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},i.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,i.Long=i.global.dcodeIO&&i.global.dcodeIO.Long||i.global.Long||i.inquire("long"),i.key2Re=/^true|false|0|1$/,i.key32Re=/^-?(?:0|[1-9][0-9]*)$/,i.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,i.longToHash=function(e){return e?i.LongBits.from(e).toHash():i.LongBits.zeroHash},i.longFromHash=function(e,t){var r=i.LongBits.fromHash(e);return i.Long?i.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))},i.merge=n,i.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},i.newError=o,i.ProtocolError=o("ProtocolError"),i.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},i.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},i.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},i._configure=function(){var e=i.Buffer;e?(i._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},i._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):i._Buffer_from=i._Buffer_allocUnsafe=null}},1173:function(e,t,r){"use strict";e.exports=d;var i,n=r(9693),o=n.LongBits,s=n.base64,a=n.utf8;function c(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function l(){}function u(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function d(){this.len=0,this.head=new c(l,0,0),this.tail=this.head,this.states=null}var h=function(){return n.Buffer?function(){return(d.create=function(){return new i})()}:function(){return new d}};function p(e,t,r){t[r]=255&e}function f(e,t){this.len=e,this.next=void 0,this.val=t}function g(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function m(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}d.create=h(),d.alloc=function(e){return new n.Array(e)},n.Array!==Array&&(d.alloc=n.pool(d.alloc,n.Array.prototype.subarray)),d.prototype._push=function(e,t,r){return this.tail=this.tail.next=new c(e,t,r),this.len+=t,this},f.prototype=Object.create(c.prototype),f.prototype.fn=function(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e},d.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new f((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},d.prototype.int32=function(e){return e<0?this._push(g,10,o.fromNumber(e)):this.uint32(e)},d.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},d.prototype.uint64=function(e){var t=o.from(e);return this._push(g,t.length(),t)},d.prototype.int64=d.prototype.uint64,d.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this._push(g,t.length(),t)},d.prototype.bool=function(e){return this._push(p,1,e?1:0)},d.prototype.fixed32=function(e){return this._push(m,4,e>>>0)},d.prototype.sfixed32=d.prototype.fixed32,d.prototype.fixed64=function(e){var t=o.from(e);return this._push(m,4,t.lo)._push(m,4,t.hi)},d.prototype.sfixed64=d.prototype.fixed64,d.prototype.float=function(e){return this._push(n.float.writeFloatLE,4,e)},d.prototype.double=function(e){return this._push(n.float.writeDoubleLE,8,e)};var _=n.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var i=0;i<e.length;++i)t[r+i]=e[i]};d.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(p,1,0);if(n.isString(e)){var r=d.alloc(t=s.length(e));s.decode(e,r,0),e=r}return this.uint32(t)._push(_,t,e)},d.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(p,1,0)},d.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new c(l,0,0),this.len=0,this},d.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(l,0,0),this.len=0),this},d.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},d.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},d._configure=function(e){i=e,d.create=h(),i._configure()}},3155:function(e,t,r){"use strict";e.exports=o;var i=r(1173);(o.prototype=Object.create(i.prototype)).constructor=o;var n=r(9693);function o(){i.call(this)}function s(e,t,r){e.length<40?n.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}o._configure=function(){o.alloc=n._Buffer_allocUnsafe,o.writeBytesBuffer=n.Buffer&&n.Buffer.prototype instanceof Uint8Array&&"set"===n.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var i=0;i<e.length;)t[r++]=e[i++]}},o.prototype.bytes=function(e){n.isString(e)&&(e=n._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(o.writeBytesBuffer,t,e),this},o.prototype.string=function(e){var t=n.Buffer.byteLength(e);return this.uint32(t),t&&this._push(s,t,e),this},o._configure()},8835:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoRealTimeSequentialDataManager=void 0;var i=r(3504),n=function(){function e(e,t){this.dataChannelManager=new i.DataChannelListener(e,t)}return e.prototype.startBroadcasting=function(e){return this.dataChannelManager.startBroadcasting(e)},e.prototype.stopBroadcasting=function(e){return this.dataChannelManager.stopBroadcasting(e)},e.prototype.sendRealTimeSequentialData=function(e,t){return this.dataChannelManager.sendRealTimeSequentialData(e,t)},e.prototype.startSubscribing=function(e){return this.dataChannelManager.startSubscribing(e)},e.prototype.stopSubscribing=function(e){return this.dataChannelManager.stopSubscribing(e)},e.prototype.on=function(e,t){this.dataChannelManager.on(e,t)},e.prototype.off=function(e,t){this.dataChannelManager.off(e,t)},e}();t.ZegoRealTimeSequentialDataManager=n},1297:function(e,t){"use strict";var r,i,n;Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoRangeAudioMode=t.ZegoRangeAudioMicrophoneState=t.ZegoMixStreamRenderMode=void 0,(n=t.ZegoMixStreamRenderMode||(t.ZegoMixStreamRenderMode={}))[n.AspectFill=0]="AspectFill",n[n.AspectFit=1]="AspectFit",(i=t.ZegoRangeAudioMicrophoneState||(t.ZegoRangeAudioMicrophoneState={}))[i.Off=0]="Off",i[i.TurningOn=1]="TurningOn",i[i.On=2]="On",(r=t.ZegoRangeAudioMode||(t.ZegoRangeAudioMode={}))[r.World=0]="World",r[r.Team=1]="Team"},3116:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoExpressRangeAudio=void 0;var n=i(r(2760)),o=function(){function e(e){this.zegoAudioListener=n.default.getInstance(e)}return e.getInstance=function(t){if(!e.instance){if(!t)throw Error("create instance failed.");e.instance=new e(t)}return e.instance},e.prototype.on=function(e,t){return this.zegoAudioListener.on(e,t)},e.prototype.off=function(e,t){return this.zegoAudioListener.off(e,t)},e.prototype.setAudioReceiveRange=function(e){this.zegoAudioListener.setAudioReceiveRange(e)},e.prototype.updateSelfPosition=function(e,t,r,i){this.zegoAudioListener.updateSelfPosition(e,t,r,i)},e.prototype.updateAudioSource=function(e,t){this.zegoAudioListener.updateAudioSource(e,t)},e.prototype.enableSpatializer=function(e){return this.zegoAudioListener.enableSpatializer(e)},e.prototype.enableMicrophone=function(e){return this.zegoAudioListener.enableMicrophone(e)},e.prototype.enableSpeaker=function(e){return this.zegoAudioListener.enableSpeaker(e)},e.prototype.setRangeAudioMode=function(e){this.zegoAudioListener.setRangeAudioMode(e)},e.prototype.setTeamID=function(e){this.zegoAudioListener.setRangeAudioTeamID(e)},e.prototype.isAudioContextRunning=function(){return"running"===this.zegoAudioListener.getAudioContextState()},e.prototype.resumeAudioContext=function(){return this.zegoAudioListener.resumeAudioContext()},e}();t.ZegoExpressRangeAudio=o},4780:function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoExpressEngine=t.ClientUtil=void 0;var s=r(9880),a=o(r(3126)),c=o(r(9869)),l=o(r(3824)),u=o(r(7526)),d=o(r(577)),h=r(2777),p=r(4897),f=r(957);s.ZegoExpressEngine.use(a.default),s.ZegoExpressEngine.use(c.default),s.ZegoExpressEngine.use(l.default),s.ZegoExpressEngine.use(u.default),s.ZegoExpressEngine.use(d.default),s.ZegoExpressEngine.use(h.RangeAudio),s.ZegoExpressEngine.use(p.DataChannel),s.ZegoExpressEngine.use(f.BeautyEffect);var g=r(9880);Object.defineProperty(t,"ClientUtil",{enumerable:!0,get:function(){return g.ClientUtil}});var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(s.ZegoExpressEngine);t.ZegoExpressEngine=m},9880:function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.ClientUtil=t.ZegoExpressEngine=void 0;var o=r(4119),s=r(5321),a=function(e){function t(t,r){var i=this;return o.ZegoExpressWebRTMEngine.version="2.13.0",(i=e.call(this,t,r)||this).zegoWebRTC=new s.ZegoWebRTC(i.logger,i.dataReport,i.zegoWebRTM),i}return n(t,e),t.use=function(e){o.ZegoExpressWebRTMEngine.use(e),s.ZegoWebRTC.use(e)},t.prototype.checkSystemRequirements=function(e,t){return void 0===t&&(t=0),this.zegoWebRTC.checkSystemRequirements(t,e)},t.prototype.off=function(e,t){return this.zegoWebRTM.stateCenter.listenerList[e]?this.zegoWebRTM.off(e,t):!!this.zegoWebRTC.stateCenter.listenerList[e]&&this.zegoWebRTC.off(e,t)},t.prototype.on=function(e,t){return this.zegoWebRTM.stateCenter.listenerList[e]?this.zegoWebRTM.on(e,t):!!this.zegoWebRTC.stateCenter.listenerList[e]&&this.zegoWebRTC.on(e,t)},t.prototype.createStream=function(e){return this.zegoWebRTC.createStream(e)},t.prototype.getElectronScreenSources=function(){return this.zegoWebRTC.getElectronScreenSources()},t.prototype.destroyStream=function(e){return this.zegoWebRTC.destroyStream(e)},t.prototype.startPublishingStream=function(e,t,r){return this.zegoWebRTC.startPublishingStream(e,t,r)},t.prototype.stopPublishingStream=function(e){return this.zegoWebRTC.stopPublishingStream(e)},t.prototype.setVideoConfig=function(e,t){return this.zegoWebRTC.setVideoConfig(e,t)},t.prototype.setAudioConfig=function(e,t){return this.zegoWebRTC.setAudioConfig(e,t)},t.prototype.replaceTrack=function(e,t){return this.zegoWebRTC.replaceTrack(e,t)},t.prototype.setCaptureVolume=function(e,t){return this.zegoWebRTC.setCaptureVolume(e,t)},t.prototype.setStreamExtraInfo=function(e,t){return this.zegoWebRTC.setStreamExtraInfo(e,t)},t.prototype.addPublishCdnUrl=function(e,t){return 3===arguments.length?this.zegoWebRTC.addPublishCdnUrl(arguments[0],arguments[2]):this.zegoWebRTC.addPublishCdnUrl(e,t)},t.prototype.removePublishCdnUrl=function(e,t){return 3===arguments.length?this.zegoWebRTC.removePublishCdnUrl(arguments[0],arguments[2]):this.zegoWebRTC.removePublishCdnUrl(e,t)},t.prototype.mutePublishStreamVideo=function(e,t,r){return this.zegoWebRTC.mutePublishStreamVideo(e,t,r)},t.prototype.mutePublishStreamAudio=function(e,t){return this.zegoWebRTC.mutePublishStreamAudio(e,t)},t.prototype.setEffectsBeauty=function(e,t,r){return this.zegoWebRTC.setBeautyEffect(e,t,r)},t.prototype.startPlayingStream=function(e,t){return this.zegoWebRTC.startPlayingStream(e,t)},t.prototype.stopPlayingStream=function(e){return this.zegoWebRTC.stopPlayingStream(e)},t.prototype.mutePlayStreamVideo=function(e,t){return this.zegoWebRTC.mutePlayStreamVideo(e,t)},t.prototype.mutePlayStreamAudio=function(e,t){return this.zegoWebRTC.mutePlayStreamAudio(e,t)},t.prototype.startMixerTask=function(e){return this.zegoWebRTC.startMixerTask(e)},t.prototype.stopMixerTask=function(e){return this.zegoWebRTC.stopMixerTask(e)},t.prototype.setMixerTaskConfig=function(e){return this.zegoWebRTC.setMixerTaskConfig(e)},t.prototype.startMixingAudio=function(e,t){return this.zegoWebRTC.startMixingAudio(e,t)},t.prototype.stopMixingAudio=function(e,t){return this.zegoWebRTC.stopMixingAudio(e,t)},t.prototype.setMixingAudioVolume=function(e,t,r){return this.zegoWebRTC.setMixingAudioVolume(e,t,r)},t.prototype.enumDevices=function(){return this.zegoWebRTC.enumDevices()},t.prototype.useVideoDevice=function(e,t){return this.zegoWebRTC.useVideoDevice(e,t)},t.prototype.useAudioDevice=function(e,t){return this.zegoWebRTC.useAudioDevice(e,t)},t.prototype.setSoundLevelDelegate=function(e,t){return this.zegoWebRTC.setSoundLevelDelegate(e,t)},t.prototype.isMicrophoneMuted=function(){return this.zegoWebRTC.isMicrophoneMuted()},t.prototype.muteMicrophone=function(e){return this.zegoWebRTC.muteMicrophone(e)},t.prototype.createRangeAudioInstance=function(){return this.zegoWebRTC.createRangeAudioInstance()},t.prototype.createRealTimeSequentialDataManager=function(e){return this.zegoWebRTC.createRealTimeSequentialDataManager(e)},t.prototype.destroyRealTimeSequentialDataManager=function(e){this.zegoWebRTC.destroyRealTimeSequentialDataManager(e)},t}(o.ZegoExpressWebRTMEngine);t.ZegoExpressEngine=a;var c=r(608);Object.defineProperty(t,"ClientUtil",{enumerable:!0,get:function(){return c.ClientUtil}})},1089:function(e,t){"use strict";var r,i;Object.defineProperty(t,"__esModule",{value:!0}),t.ZEGO_WECHATMINI_ACTION=t.ZEGO_WEBRTC_ACTION=void 0,(i=t.ZEGO_WEBRTC_ACTION||(t.ZEGO_WEBRTC_ACTION={})).CONSTRUCTOR="zc.0",i.CHECK_SUPPORT="zc.csr",i.CREATE_STREAM="zc.cs",i.DESTROY_STREAM="zc.ds",i.START_PUBLISHING_STREAM="zc.sps.0",i.START_PLAYING_STREAM="zc.sps.1",i.STOP_PUBLISHING_STREAM="zc.sps.0.0",i.STOP_PLAYING_STREAM="zc.sps.1.0",i.ON_STREAM="zc.os",i.ON_PUSH_STREAM_UPDATE="zc.opsu",i.BIND_WINDOW_LISTENER="zc.wl",i.SET_AUDIO_OUTPUT="zc.sao",i.SET_CUSTOM_SIGNAL_URL="zc.scsu",i.SET_TURN_OVER_TCP_ONLY="zc.stoto",i.RDH_ACTIVE="zc.rdh.a",i.RDH_MAX_TIME="zc.rdh.m",i.RDH_WEBRTC_URL_RSP="zc.rdh.hfwur",i.PUBLISH_STATE_HANDLE="zc.psh.0",i.PLAY_STATE_HANDLE="zc.psh.1",i.STATECENTER_ACTION_LISTENER="zc.sc.al",i.STATECENTER_SET_SETTING="zc.sc.ss",i.SIGNAL_SET_SESSION_INFO="zc.s.ssi",i.SIGNAL_RESET_CONNECT_TIMER="zc.s.rct",i.SIGNAL_BIND_WEBSOCKET_HANDLE="zc.s.bwh",i.SIGNAL_RESET_CHECK_MESSAGE="zc.s.rcm",i.SIGNAL_UPDATE_TOKEN="zc.s.ut",i.SIGNAL_SEND_MESSAGE_WITH_CALLBACK="zc.s.smwc",i.SIGNAL_CONNECT_SERVER="zc.s.cs.0",i.SIGNAL_START_CONNECT_TIMER="zc.s.sct",i.SIGNAL_DISCONNECT_SERVER="zc.s.dc",i.SIGNAL_CREATE_SESSION="zc.s.cs.1",i.SIGNAL_REMOVE_SESSION="zc.s.rs",i.SIGNAL_SEND_REMOVE_SESSION="zc.s.srs",i.SIGNAL_SEND_MESSAGE="zc.s.sm",i.SIGNAL_HANDLE_RESPOND_DATA="zc.s.hrd",i.SIGNAL_ADD_SESSION="zc.s.as",i.SIGNAL_HANDLE_PUSH_DATA="zc.s.hpd",i.SIGNAL_HANDLE_PUSH_RESET_SESSION_DATA="zc.s.hprsd",i.SIGNAL_SEND_MEDIA_DESC="zc.s.smd",i.SIGNAL_SEND_CANDIDATE_INFO="zc.s.sci",i.SIGNAL_SEND_MEDIA_DESC_ACK="zc.s.smda",i.SIGNAL_SEND_CANDIDATE_INFO_ACK="zc.s.scia",i.SIGNAL_SEND_CLOSE_SESSION_ACK="zc.s.scsa",i.SIGNAL_SEND_RESET_SESSION_ACK="zc.s.srsa",i.SIGNAL_REGISTER_PUSH_CALLBACK="zc.s.rpc",i.SIGNAL_CHECK_MESSAGE_TIMEOUT="zc.s.cmt",i.SIGNAL_SEND_HEARTBEAT="zc.s.sh",i.SIGNAL_QUALITY_REPORT="zc.s.qr",i.SIGNAL_SEND_STREAM_STATUS="zc.s.sss",i.SIGNAL_ACTIVE_PLAY_VIDEO_STREAM="zc.s.apvs",i.SIGNAL_ACTIVE_PLAY_AUDIO_STREAM="zc.s.apas",i.SIGNAL_SEND_BROADCAST_STATUS="zc.s.sbs",i.SIGNAL_SEND_NET_PROBE="zc.s.snp",i.SIGNAL_SEND_NET_QUALITY_INFO_PUSH_ACK="zc.s.npa",i.PUBLISHER_START_PUBLISH="zc.p.0.sp.0",i.PUBLISHER_PUBLISH_SUCCESS="zc.p.ps",i.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS="zc.p.0.ocpss",i.PUBLISHER_HANDLE_CREATE_SESSION_WITH_SDP="zc.p.0.hcsws",i.PUBLISHER_ON_CREATE_OFFER_SUCCESS="zc.p.0.ocos",i.PUBLISHER_ON_SET_LOCAL_DESCRIPTION_SUCCESS="zc.p.0.oslds",i.PUBLISHER_ON_GET_REMOTE_DESCRIPTION="zc.p.0.ogrd",i.PUBLISHER_ON_RECV_MEDIA_DESC="zc.p.0.ormd",i.PUBLISHER_ON_RECV_CANDIDATE_INFO="zc.p.0.orci.0",i.PUBLISHER_ON_RECV_PUBLISH_EVENT="zc.p.0.orpe",i.PUBLISHER_ON_RECV_CLIENT_INFO="zc.p.0.orci.1",i.PUBLISHER_ON_ICE_CANDIDATE="zc.p.0.oic",i.PUBLISHER_ON_CONNECTION_STATE_CHANGE="zc.p.0.ocsc",i.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE="zc.p.0.oicsc",i.PUBLISHER_RESET_PUBLISH="zc.p.0.rp",i.PUBLISHER_SET_PLAYER_QUALITY_TIMER="zc.p.0.spqt",i.PUBLISHER_UPLOAD_PUBLISH_QUALITY="zc.p.0.upq",i.PUBLISHER_ON_RECV_RESET_SESSION="zc.p.0.orrs",i.PUBLISHER_ON_RECV_CLOSE_SESSION="zc.p.0.orcs",i.PUBLISHER_SEND_CANDIDATE_INFO="zc.p.0.sci",i.PUBLISHER_STATE_ERROR="zc.p.0.psr",i.PUBLISHER_STOP_PUBLISH="zc.p.0.sp.1",i.PUBLISHER_ON_DISCONNECT="zc.p.0.od",i.PUBLISHER_START_SOUND_LEVEL="zc.p.0.ssl.0",i.PUBLISHER_STOP_SOUND_LEVEL="zc.p.0.ssl.1",i.PUBLISHER_HANDLE_ENC_BITRATE="zc.p.0.heb",i.PUBLISHER_ON_RECV_NET_QUALITY_INFO="zc.p.0.nqi",i.PUBLISHER_ON_RECV_UPDATE_MEDIA_DESC="zc.p.0.orumd",i.PLAYER_START_PLAY="zc.p.1.sp.0",i.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS="zc.p.ocpss.1",i.PLAYER_HANDLE_CREATE_SESSION_WITH_SDP="zc.p.hcsws.1",i.PLAYER_ON_CREATE_OFFER_SUCCESS="zc.p.ocos.1",i.PLAYER_ON_SET_LOCAL_DESCRIPTION_SUCCESS="zc.p.oslds.1",i.PLAYER_ON_RECV_MEDIA_DESC="zc.p.ormd.1",i.PLAYER_ON_RECV_CANDIDATE_INFO="zc.p.orci.1",i.PLAYER_ON_RECV_PLAY_EVENT="zc.p.orpe.1",i.PLAYER_ON_RECV_CLIENT_INFO="zc.p.orci.1.1",i.PLAYER_ON_ICE_CANDIDATE="zc.p.oic.1",i.PLAYER_ON_CONNECTION_STATE_CHANGE="zc.p.ocsc.1",i.PLAYER_ON_ICE_CONNECTION_STATE_CHANGE="zc.p.oicsc.1",i.PLAYER_RESET_PLAY="zc.p.rp.1",i.PLAYER_SET_PLAYER_QUALITY_TIMER="zc.p.spqt.1",i.PLAYER_UPLOAD_PLAYER_QUALITY="zc.p.upq.1",i.PLAYER_ON_RECV_RESET_SESSION="zc.p.orrs.1",i.PLAYER_ON_RECV_CLOSE_SESSION="zc.p.orcs.1",i.PLAYER_ON_RECV_STREAM_STATUS="zc.p.orss.1",i.PLAYER_ON_GOT_REMOTE_STREAM="zc.p.ogrs.1",i.PLAYER_SEND_CANDIDATE_INFO="zc.p.sci.1",i.PLAYER_STATE_ERROR="zc.p.psr.1",i.PLAYER_STOP_PLAY="zc.p.1.sp.1",i.PLAYER_ON_DISCONNECT="zc.p.od.1",i.PLAYER_START_SOUND_LEVEL="zc.p.ssl.1",i.PLAYER_STOP_SOUND_LEVEL="zc.p.ssl.1.1",i.PLAYER_ON_RECV_NET_QUALITY_INFO="zc.p.1.nqi",i.PUBLISH_SET_CAPTURE_VOLUME="zc.p.scv",i.PUBLISH_SET_BEAUTY_EFFECT="zc.p.0.sbe",i.STREAMHANDLER_MERGE_STREAM_BY_STREAM_SEQ="zc.sh.msbss",i.STREAMHANDLER_MERGE_STREAM="zc.sh.ms",i.STREAMHANDLER_PATCH_STREAM_LIST="zc.sh.psl",(r=t.ZEGO_WECHATMINI_ACTION||(t.ZEGO_WECHATMINI_ACTION={})).ADD_PUBLISH_CDN_URL="zw.apcu",r.REMOVE_PUBLISH_CDN_URL="zw.rpcu",r.STOP_MIXER_TASK="zw.smt",r.ON_STREAM="zw.os",r.ON_PUSH_STREAM_UPDATE="zw.opsu",r.ON_PUBLISH_STATE_UPDATE="zw.w.opsu",r.ON_PUBLISH_STATE_UPDATE_HANDLE="zw.w.opsuh",r.WECHATMINI_SETPREFERPLAYSOURCETYPE="zw.w.sppst.1",r.WECHATMINI_BIND_LISTENER="zw.w.bl",r.WECHATMINI_DELETE_LISTENER="zw.w.dl",r.WECHATMINI_UPDATE_PLAYER_STATE="zw.w.ups",r.WECHATMINI_UPDATE_PLAYER_NET_STATUS="zw.w.upns",r.WECHATMINI_SET_CUSTOM_SIGNAL_URL="zw.w.scsu",r.WECHATMINI_GET_NEXT_URL="zw.w.gnu",r.WECHATMINI_BIND_STREAM_CENTER_HANDLER="zw.w.bsch",r.WECHATMINI_BIND_RTM_LISTENER="zw.w.brl",r.PUBLISHMODULE_SET_PREFER_PUBLISH_SOURCE_TYPE="zw.pu.sppst.0",r.PUBLISHMODULE_START_PUBLISHING_STREAM="zw.pu.sps.0",r.PUBLISHMODULE_STOP_PUBLISHING_STREAM="zw.pu.sps.0.0",r.PUBLISHMODULE_FETCH_PUBLISH_STREAM_URL="zw.pu.fpsu.0",r.PUBLISHMODULE_HANDLE_FETCH_STREAM_PUBLISH_URL_RSP="zw.pu.hfspur.0",r.PUBLISHMODULE_DO_PUBLISH_STREAM="zw.pu.dps.0",r.PUBLISHMODULE_UPDATE_STREAM_INFO="zw.pu.upi",r.PUBLISHMODULE_HANDLE_STREAM_UPDATE_RSP="zw.pu.hsur",r.PLAYMODULE_START_PLAYING_STREAM="zw.pl.sps.1",r.PLAYMODULE_STOP_PLAYING_STREAM="zw.pl.sps.1.0",r.PLAYMODULE_START_PLAYING_STREAM_FROM_CDN="zw.pl.spsfc",r.PLAYMODULE_START_PLAYING_STREAM_FROM_BGP="zw.pl.spsfb",r.PLAYMODULE_DO_PLAY_STREAM="zw.pl.dps",r.PLAYMODULE_FETCH_PLAY_STREAM_URL="zw.pl.fpsu",r.PLAYMODULE_HANDLE_FETCH_STREAM_URL_RSP="zw.pl.hfsur",r.STREAMCENTERWECHAT_RESET="zw.scw.r.0",r.STREAMCENTERWECHAT_START_PUBLISHING_STREAM="zw.scw.sps.0",r.STREAMCENTERWECHAT_START_PLAYING_STREAM="zw.scw.sps.1",r.STREAMCENTERWECHAT_START_PLAYER="zw.scw.sp.0",r.STREAMCENTERWECHAT_ON_STREAM_URL_UPDATE="zw.scw.opuu.0",r.STREAMCENTERWECHAT_UPDATE_PLAYER_STATE="zw.scw.ups.0",r.STREAMCENTERWECHAT_UPDATE_PLAYER_NET_STATUS="zw.scw.upns",r.STREAMCENTERWECHAT_UPDATE_PUBLISHING_STATE="zw.scw.ups.0.0",r.STREAMCENTERWECHAT_UPDATE_PLAYING_STATE="zw.scw.ups.1.0",r.STREAMCENTERWECHAT_GET_NEXT_URL="zw.scw.gnu",r.STREAMCENTERWECHAT_STOP_PUBLISHING_STREAM="zw.scw.sps.0.0",r.STREAMCENTERWECHAT_STOP_PLAYING_STREAM="zw.scw.sps.1.0",r.STREAMCENTERWECHAT_STOP_PLAYER="zw.scw.sp.1",r.STREAMCENTERWECHAT_ON_PLAY_START="zw.scw.ops.0",r.STREAMCENTERWECHAT_ON_PLAY_STOP="zw.scw.ops.1",r.STREAMCENTERWECHAT_ON_PLAY_RETRY="zw.scw.opr",r.PLAYWECHAT_TRY_START_PLAYER="zw.pw.tsp.0",r.PLAYWECHAT_UPDATE_EVENT="zw.pw.ue",r.PLAYWECHAT_GET_PLAY_URL="zw.pw.gpu"},9595:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RTC=t.ZegoSettingConfig=void 0;var r=function(){function e(){this.defaultSetting={publish_video_codec:"H264",camera_video_bitrate:800,screen_video_bitrate:1500,custom_video_bitrate:0,l3_play_buffer_ms:500,AEC:!0,AGC:!0,ANS:!0,resource_mode:0,bitrate_mode:"default"},this.setting=JSON.parse(JSON.stringify(this.defaultSetting))}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.setSetting=function(e,t){var r=Array.isArray(t)&&t.length>0;for(var i in e)for(var n in e[i])if(!n.endsWith("_ctrlmode")){if(r&&-1==t.indexOf(n))continue;var o=e[i][n+"_ctrlmode"];1===o||2===o?this.setting[n]=e[i][n]:this.defaultSetting[n]&&(this.setting[n]=this.defaultSetting[n]),"number"==typeof o&&(this.setting[n+"_ctrlmode"]=e[i][n+"_ctrlmode"])}},e.prototype.getSetting=function(e,t){return void 0===t&&(t=!1),t?2==this.setting[e+"_ctrlmode"]?this.setting[e]:void 0:this.setting[e]},e}();t.ZegoSettingConfig=r,t.RTC="rtc"},7325:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StateCenter=void 0;var i=r(6706),n=r(608),o=r(1089),s=r(9595),a=r(6706),c=r(3529),l=function(){function e(e,t){this.logger=e,this.dataReport=t,this.debug=!1,this.testEnvironment=!1,this.pullLimited=!0,this.configOK=!1,this.relateService=[],this.role=2,this.maxMemberCount=0,this.roomCreateFlag=1,this.callbackList={},this.publishStreamList={},this.streamUrlMap={},this.cmdCallback={},this.customUrl=[],this.customPlayUrl=[],this.turnOverTcpOnly=!1,this.customSetTcpOrUdp=!1,this.supportUdp=!1,this.audioEffectBuffer={},this.audioBitRate=48e3,this.cdnSeq=0,this.listenerList={roomStreamUpdate:[],streamExtraInfoUpdate:[],playerStateUpdate:[],publisherStateUpdate:[],screenSharingEnded:[],publishQualityUpdate:[],playQualityUpdate:[],remoteCameraStatusUpdate:[],remoteMicStatusUpdate:[],soundLevelUpdate:[],capturedSoundLevelUpdate:[],videoDeviceStateChanged:[],audioDeviceStateChanged:[],deviceError:[],_deviceError:[],_remoteCameraStatusUpdate:[],_remoteMicStatusUpdate:[],_streamUpdated:[],receiveRealTimeSequentialData:[],beautyEffectOverload:[]},this.reportList={},this.reportSeqList={startPublish:{},rePublish:{},startPlay:{},rePlay:{},stopPublish:{},stopPlay:{}},this.streamTrigger={},this.audioStreamList={},this.deviceInfos=null,this.deviceChangeTimer=null,this.deviceStateOut=!1,this.networkState=a.ENUM_NETWORK_STATE.offline,this.streamRetryTime=300,this.checkList=[],this.anchor_info={anchor_id:"",anchor_id_name:"",anchor_nick_name:""},this.streamConnectTime=0,this.clientIP="",this.type="PUBLIC",this.roomList=[],this.isMultiRoom=!1,this.browser="",this.logReportCallback=n.ClientUtil.logReportCallback,this.unregisterCallback=n.ClientUtil.unregisterCallback,this.checkIllegalCharacters=n.ClientUtil.checkIllegalCharacters,this.decodeServerError=n.ClientUtil.decodeServerError,this.getLiveRoomError=n.ClientUtil.getLiveRoomError,this.getServerError=n.ClientUtil.getServerError,this.mergeStreamList=n.ClientUtil.mergeStreamList,this.checkInteger=n.ClientUtil.checkInteger,this.isUrl=n.ClientUtil.isUrl,this.actionSuccessCallback=n.ClientUtil.actionSuccessCallback,this.checkValidNumber=n.ClientUtil.checkValidNumber,this.getDevices=n.ClientUtil.getDevices,this.settingConfig=new s.ZegoSettingConfig}return e.prototype.getRequestId=function(){return this.idName+"-"+a.getSeq()},e.prototype.getSignalCmdContent=function(e,t,r,i){var n={request_id:t,room_id:e,from_userid:this.idName,from_username:this.nickName,to_userid:r};return null!=i&&(n.result=i),JSON.stringify(n)},e.prototype.actionListener=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];if(!["playQualityUpdate","publishQualityUpdate","soundLevelUpdate","capturedSoundLevelUpdate"].includes(e)&&this.listenerList[e]){var s=i.getReportSeq();this.dataReport.newReport(s,c.ZegoRTCLogEvent.kZegoListener.event),this.dataReport.addMsgInfo(s,{listener:e,params:r}),this.dataReport.uploadReport(s)}this.listenerList[e]&&this.listenerList[e].forEach((function(i){try{setTimeout((function(){i.apply(void 0,r)}),0)}catch(r){t.logger.error(o.ZEGO_WEBRTC_ACTION.STATECENTER_ACTION_LISTENER+" "+e+" "+r)}}))},e.prototype.getRoomByRoomID=function(e){return this.roomList.find((function(t){return t.roomID==e}))},e.prototype.getPlayRoom=function(e){return this.roomList.find((function(t){return!!t.streamList.find((function(t){return t.stream_id==e}))}))},e}();t.StateCenter=l},5740:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoStreamCenter=void 0,t.ZegoStreamCenter=function(){this.publisherList={},this.playerList={}}},7560:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamHandler=void 0;var i=r(6706),n=r(2752),o=r(1089),s=function(){function e(e,t,r,i,n){this.logger=e,this.stateCenter=t,this.rtm=r,this.streamCenter=i,this.roomID=n,this.minStreamSeq=0,this.streamSeq=0,this.streamQuerying=!1,this.streamSeqMergeMap=null,this.streamListHBMergeInterval=2e3,this.streamListMergeInterval=5e3}return e.prototype.setCDNInfo=function(e,t){e.urlFlv=t.urls_flv instanceof Array?t.urls_flv[0]:"string"==typeof t.urls_flv?t.urls_flv:"",e.urlHls=t.urls_m3u8 instanceof Array?t.urls_m3u8[0]:"string"==typeof t.urls_m3u8?t.urls_m3u8:"",e.urlHttpsFlv=t.urls_https_flv instanceof Array?t.urls_https_flv[0]:"string"==typeof t.urls_https_flv?t.urls_https_flv:"",e.urlHttpsHls=t.urls_https_m3u8 instanceof Array?t.urls_https_m3u8[0]:"string"==typeof t.urls_https_m3u8?t.urls_https_m3u8:"",e.urlRtmp=t.urls_rtmp instanceof Array?t.urls_rtmp[0]:"string"==typeof t.urls_rtmp?t.urls_rtmp:""},e.prototype.onStreamUpdated=function(e,t,r){},e.prototype.onStreamExtraInfoUpdated=function(e,t){},e.prototype.handleStreamStart=function(e,t){this.logger.info("zb.sh.hss call stream update"),this.room=t,e.body?(this.streamListHBMergeInterval=e.body.stream_list_hb_wait_merge_time||2e3,this.streamListMergeInterval=e.body.stream_list_push_merge_timeout||5e3,this.streamQuerying=!1,this.handleFullUpdateStream(e.body.stream_seq,e.body.stream_info||[]),this.handleReconnectStream(e.body.stream_info),this.logger.info("zb.sh.hss call end")):this.logger.error("zb.sh.hss server response wrong")},e.prototype.onPublishStateUpdate=function(e,t,r){},e.prototype.updateStreamInfo=function(e,t,r,o){var s,a,c,l=this;if(void 0===r&&(r=""),this.logger.info("zb.sh.usi call"),"PUBLIC"===this.stateCenter.type){var u={stream_id:e,extra_info:r},d=JSON.stringify(u);a={sub_cmd:t,stream_msg:d,third_token:null===(s=this.room)||void 0===s?void 0:s.token},c="stream"}else a={room_header:{room_id:this.roomID,room_sid:this.rtm.getRoomSid()||"0",room_user_session_id:this.rtm.getRoomSessionID()||"0"},stream_id:e,extra_info:r,title:"",stream_sid:this.stateCenter.publishStreamList[e].sid},c=t;var h=this.room;this.room.streamInfoList[e]={},this.room.streamInfoList[e].seq=this.rtm.service.sendMessage(c,a,(function(e,t){l.handleStreamUpdateRsp(e)}),(function(s,a){var c=l.room;if(c&&!c.isResetRoom&&!l.rtm.service.isDisConnect()&&s.code&&s.code==n.errorCodeList.TIMEOUT.code&&c.streamInfoList[e].seq==a)2001==t&&l.stateCenter.publishStreamList[e]&&l.stateCenter.publishStreamList[e].state==i.ENUM_PUBLISH_STREAM_STATE.update_info||2002==t?setTimeout((function(){l.updateStreamInfo(e,t,r,o)}),0):o&&o(n.errorCodeList.TIMEOUT);else if(s.body&&s.body.err_code){var u=l.stateCenter.getServerError(s.body.err_code);[1011,1000002002].includes(u.code)&&(u=n.errorCodeList.TOKEN_EXPIRED),o&&o(u,a),t===i.ENUM_STREAM_SUB_CMD.liveBegin&&l.onPublishStateUpdate(i.ENUM_PUBLISH_STATE_UPDATE.error,e,u)}}),void 0,{sessionID:null==h?void 0:h.sessionID,roomID:null==h?void 0:h.roomID,roomSessionID:null==h?void 0:h.roomSessionID}),this.logger.info("zb.sh.usi call success cmd "+t)},e.prototype.handleStreamUpdateRsp=function(e){var t,r,n;if(this.rtm.service.isDisConnect())this.logger.error("zb.sh.hsur not login");else if(0==e.body.err_code){this.logger.info("zb.sh.hsur stream seq "+this.streamSeq+" server seq "+e.body.stream_seq),"PUBLIC"===this.stateCenter.type?this.streamSeq=e.body.stream_seq:this.streamSeq++;var o=this.room;if(o)if("PUBLIC"===this.stateCenter.type){(null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.token_remain_time)&&(this.stateCenter.getRoomByRoomID(null===(r=null==e?void 0:e.header)||void 0===r?void 0:r.room_id)?this.rtm.resetRoomTokenTimer(e.header.room_id,e.body.token_remain_time):this.logger.error("zb.sh.hsur room no found ignore "+JSON.stringify(null===(n=e.header)||void 0===n?void 0:n.room_id)));for(var s=function(t){var r=e.body.stream_info[t].stream_id,n=a.stateCenter.publishStreamList[r];if(!n)return a.logger.info("hsur.0 stream is not exist"),{value:void 0};n.state==i.ENUM_PUBLISH_STREAM_STATE.update_info&&(n.state=i.ENUM_PUBLISH_STREAM_STATE.publishing,o.streamList.find((function(e){return e.stream_id==r}))||o.streamList.push(e.body.stream_info[t]),a.onPublishStateUpdate(i.ENUM_PUBLISH_STATE_UPDATE.start,r,{code:0,message:""})),delete o.streamInfoList[r]},a=this,c=0;c<e.body.stream_info.length;c++){var l=s(c);if("object"==typeof l)return l.value}}else{var u=e.body.stream_id;this.stateCenter.publishStreamList[u]&&this.stateCenter.publishStreamList[u].state==i.ENUM_PUBLISH_STREAM_STATE.update_info&&(this.stateCenter.publishStreamList[u].state=i.ENUM_PUBLISH_STREAM_STATE.publishing,this.stateCenter.publishStreamList[u].sid=e.body.stream_sid,this.stateCenter.publishStreamList[u].ver=e.body.stream_ver,o.streamList.find((function(e){return e.stream_id==u}))||o.streamList.push({stream_id:e.body.stream_id,stream_seq:e.body.stream_seq,stream_sid:e.body.stream_sid,stream_ver:e.body.stream_ver,user_id:"",user_name:""}),this.onPublishStateUpdate(0,u,{code:0,message:""})),delete o.streamInfoList[u]}else this.logger.info("hsur.0 room no found")}else this.logger.error("zb.sh.hsur stream update error "+e.body.err_code)},e.prototype.handleFetchStreamListRsp=function(e){this.logger.info("zb.sh.hfslr call"),this.streamQuerying=!1,0===e.body.err_code?this.streamSeq!==e.body.stream_seq?(this.handleFullUpdateStream(e.body.stream_seq,e.body.stream_info),this.logger.info("zb.sh.hfslr call success")):this.logger.info("zb.sh.hfslr same seq"):this.logger.info("zb.sh.hfslr server error=",e.body.err_code)},e.prototype.handleFullUpdateStream=function(e,t){var r=this;this.logger.info("zb.sh.hfus call"),this.streamSeq=e,this.logger.debug("zb.sh.hfus server seq "+this.streamSeq),this.stateCenter.mergeStreamList(this.stateCenter.idName,this.room.streamList,t,(function(e,t,n){0!==e.length&&(r.logger.debug("zb.sh.hfus callback addstream"),r.onStreamUpdated(r.roomID,i.ENUM_STREAM_UPDATE_TYPE.added,r.makeCallbackStreamList(e))),0!==t.length&&(r.logger.debug("zb.sh.hfus callback delstream"),r.onStreamUpdated(r.roomID,i.ENUM_STREAM_UPDATE_TYPE.deleted,r.makeCallbackStreamList(t))),0!==n.length&&(r.logger.debug("zb.sh.hfus callback updatestream"),r.onStreamExtraInfoUpdated(r.roomID,r.makeCallbackStreamList(n)))})),this.logger.info("zb.sh.hfus call success")},e.prototype.handlePushStreamUpdateMsg=function(e){if(this.logger.info("zb.sh.hpsum call"),e.body.stream_info&&0!==e.body.stream_info.length){if(e.body.stream_info.length+this.streamSeq!==e.body.stream_seq)return this.logger.info("zb.sh.hpsum call updatestream"),void this.fetchStreamList();switch(this.streamSeq=e.body.stream_seq,e.body.stream_cmd){case i.ENUM_STREAM_UPDATE_CMD.added:this.handleAddedStreamList(e.body.stream_info);break;case i.ENUM_STREAM_UPDATE_CMD.deleted:this.handleDeletedStreamList(e.body.stream_info);break;case i.ENUM_STREAM_UPDATE_CMD.updated:this.handleUpdatedStreamList(e.body.stream_info)}this.logger.info("zb.sh.hpsum call success")}else this.logger.info("zb.sh.hpsum, emtpy list")},e.prototype.handlePriPushStreamUpdateMsg=function(e){if(this.logger.info("zb.sh.hpsum call"),e.body.streams_info&&0!==e.body.streams_info.length){if(e.body.streams_info.length+this.streamSeq!==e.body.stream_seq)return this.logger.info("zb.sh.hpsum call updatestream"),void this.mergeStreamByStreamSeq(e.body.stream_cmd,e.body.stream_seq,e.body.streams_info);switch(this.streamSeq=e.body.stream_seq,e.body.stream_cmd){case i.ENUM_STREAM_UPDATE_CMD_PRI.added:this.handleAddedStreamList(e.body.streams_info);break;case i.ENUM_STREAM_UPDATE_CMD_PRI.deleted:this.handleDeletedStreamList(e.body.streams_info);break;case i.ENUM_STREAM_UPDATE_CMD_PRI.updated:this.handleUpdatedStreamList(e.body.streams_info)}this.logger.info("zb.sh.hpsum call success")}else this.logger.info("zb.sh.hpsum, emtpy list")},e.prototype.handleAddedStreamList=function(e){this.logger.debug("zb.sh.hasl call");for(var t,r=[],n=0;n<e.length;n++)if(e[n].anchor_id_name!=this.stateCenter.idName&&e[n].user_id!==this.stateCenter.idName){t=!1;for(var o=0;o<this.room.streamList.length;o++)if(e[n].stream_id===this.room.streamList[o].stream_id){t=!0;break}t||r.push(e[n])}else this.logger.debug("hdsl.0 have self stream added");if(0!==r.length){this.logger.debug("zb.sh.hasl callback addstream");for(var s=0;s<r.length;s++)this.room.streamList.push(r[s]);this.onStreamUpdated(this.roomID,i.ENUM_STREAM_UPDATE_TYPE.added,this.makeCallbackStreamList(r))}this.logger.info("zb.sh.hasl call success")},e.prototype.handleDeletedStreamList=function(e){this.logger.debug("zb.sh.hdsl call");for(var t=[],r=0;r<e.length;r++)if(e[r].anchor_id_name!=this.stateCenter.idName&&e[r].user_id!==this.stateCenter.idName){for(var n=this.room.streamList.length-1;n>=0;n--)if(e[r].stream_id===this.room.streamList[n].stream_id){this.room.streamList.splice(n--,1),t.push(e[r]);break}}else this.logger.debug("zb.sh.hdsl have self stream deleted");0!==t.length&&(this.logger.debug("zb.sh.hdsl callback delstream"),this.onStreamUpdated(this.roomID,i.ENUM_STREAM_UPDATE_TYPE.deleted,this.makeCallbackStreamList(t))),this.logger.info("zb.sh.hdsl call")},e.prototype.handleUpdatedStreamList=function(e){this.logger.debug("zb.sh.husl call");for(var t=[],r=0;r<e.length;r++)if(e[r].anchor_id_name!=this.stateCenter.idName&&e[r].user_id!==this.stateCenter.idName){for(var i=0;i<this.room.streamList.length;i++)if(e[r].stream_id===this.room.streamList[i].stream_id){e[r].extra_info!==this.room.streamList[i].extra_info&&(this.room.streamList[i]=e[r],t.push(e[r]));break}}else this.logger.debug("hsul.0 have self stream updated");0!==t.length&&(this.logger.debug("zb.sh.husl callback updatestream"),this.onStreamExtraInfoUpdated(this.roomID,this.makeCallbackStreamList(t))),this.logger.info("zb.sh.husl call success")},e.prototype.fetchStreamList=function(){if(this.logger.info("zb.sh.fsl call"),this.rtm.service.isDisConnect())this.logger.info("zb.sh.fsl state error");else if(this.streamQuerying)this.logger.info("zb.sh.fsl already doing");else if(this.streamQuerying=!0,this.logger.debug("zb.sh.fsl send fetch request"),"PUBLIC"===this.stateCenter.type){var e={reserve:0},t=this.room;this.rtm.service.sendMessage("stream_info",e,this.handleFetchStreamListRsp.bind(this),(function(e,t){}),void 0,{roomID:null==t?void 0:t.roomID,sessionID:null==t?void 0:t.sessionID,roomSessionID:null==t?void 0:t.roomSessionID}),this.logger.info("zb.sh.fsl call success")}else{if(!this.rtm.isLogin(this.roomID))return void this.logger.info("zb.sh.fsl room state error");e={room_header:{room_id:this.roomID,room_sid:this.rtm.getRoomSid()||"0",room_user_session_id:this.rtm.getRoomSessionID()||"0"}},this.rtm.service.sendMessage("zegochat_js.room_info_req",e,this.handleFetchStreamListRsp.bind(this),(function(e,t){}))}},e.prototype.handleReconnectStream=function(e){this.logger.info("zb.sh.hrs call");var t=this.streamCenter.publisherList,r=this.streamCenter.playerList,n=function(r){if(t[r].roomID!==o.roomID)return"continue";if(t[r].publisher.state!=i.ENUM_PUBLISH_STATE.publishing||e.find((function(e){return e.stream_id==r}))){if(t[r].publisher.state==i.ENUM_PUBLISH_STATE.stop&&e.find((function(e){return e.stream_id==r}))){s=void 0,s="PUBLIC"===o.stateCenter.type?i.ENUM_STREAM_SUB_CMD.liveEnd:i.ENUM_STREAM_CMD_PRI.liveEnd,o.updateStreamInfo(r,s);for(var n=0;n<o.room.streamList.length;n++)if(o.room.streamList[n].stream_id==r){o.room.streamList.splice(n--,1);break}}}else{var s=void 0;s="PUBLIC"===o.stateCenter.type?i.ENUM_STREAM_SUB_CMD.liveBegin:i.ENUM_STREAM_CMD_PRI.liveBegin,o.updateStreamInfo(r,s,o.stateCenter.publishStreamList[r].extra_info)}},o=this;for(var s in t)n(s);for(var s in t)t[s].roomID===this.roomID&&t[s].isReDispatch&&(this.logger.info("zb.sh.hrs "+s+"retry dispatch"),(a=t[s].retryDispatchHandler).stopMaxTime(),a.invalid(),a.initStream(s,t[s].publishOption,!0),a.active(0),t[s].isReDispatch=!1);for(var s in r){var a;r[s].roomID===this.roomID&&r[s].isReDispatch&&(this.logger.info("zb.sh.hrs "+s+"retry dispatch"),(a=r[s].retryDispatchHandler).stopMaxTime(),a.invalid(),a.initStream(s,r[s].playOption,!1),a.active(0),r[s].isReDispatch=!1)}this.logger.info("zb.sh.hrs end")},e.prototype.makeCallbackStreamList=function(e){var t=[];if("PUBLIC"===this.stateCenter.type){if(e&&e.length>0)for(var r=0;r<e.length;r++){var i={user:{userID:e[r].anchor_id_name,userName:e[r].anchor_nick_name},extraInfo:e[r].extra_info,streamID:e[r].stream_id,roomID:"",urlFlv:"",urlRtmp:"",urlHls:"",urlHttpsFlv:"",urlHttpsHls:"",streamGID:e[r].stream_gid,closeType:e[r].close_type};this.setCDNInfo(i,e[r]),t.push(i)}}else if(e&&e.length>0)for(r=0;r<e.length;r++)i={user_id:e[r].user_id,user_name:e[r].user_name,stream_id:e[r].stream_id,stream_sid:e[r].stream_sid,extra_info:e[r].extra_info,title:e[r].title,stream_ver:e[r].stream_ver},t.push(i);return t},e.prototype.sendBizChannelRequest=function(e,t,r,i){var n=this;void 0===i&&(i=!1),e=Object.assign(e,{is_retry_req:i?1:0});var o=this.room;this.rtm.service.sendMessage("biz_channel",e,(function(e,r){t(e.header.seq,e.body.cmd,e.body.rsp_body)}),(function(i,o){var s=i.body.err_code,a=i.body.rsp_body;"number"!=typeof s||2002!==s?r(s,o,a):n.sendBizChannelRequest(e,t,r,!0)}),void 0,{roomID:null==o?void 0:o.roomID,sessionID:null==o?void 0:o.sessionID,roomSessionID:null==o?void 0:o.roomSessionID})},e.prototype.updateStreamExtraInfo=function(e,t,r,i){},e.prototype.setStreamExtraInfo=function(e,t,r,i){},e.prototype._publishTarget=function(e,t,r){},e.prototype.patchStreamList=function(e){var t=this;e.body.stream_seq===this.streamSeq||this.streamSeqMergeMap||(this.logger.info(o.ZEGO_WEBRTC_ACTION.STREAMHANDLER_PATCH_STREAM_LIST+" call update stream "+this.streamSeq+" server "+e.body.stream_seq),this.streamSeqMergeTimer&&clearTimeout(this.streamSeqMergeTimer),this.streamSeqMergeTimer=setTimeout((function(){t.handleMergeTimeout()}),this.streamListHBMergeInterval)),this.minStreamSeq=e.body.stream_seq},e.prototype.mergeStreamByStreamSeq=function(e,t,r){var i=this;this.streamSeqMergeMap||(this.logger.warn(o.ZEGO_WEBRTC_ACTION.STREAMHANDLER_MERGE_STREAM_BY_STREAM_SEQ+" new merge stream list "+this.streamSeq+" server "+t),this.streamSeqMergeMap={},this.streamSeqMergeTimer&&clearTimeout(this.streamSeqMergeTimer),this.streamSeqMergeTimer=setTimeout((function(){i.handleMergeTimeout()}),this.streamListMergeInterval)),this.logger.info(o.ZEGO_WEBRTC_ACTION.STREAMHANDLER_MERGE_STREAM_BY_STREAM_SEQ+" "+this.streamSeqMergeMap+" "+e+" "+t+" "+r),this.streamSeqMergeMap[t]={cmd:e,streamList:r}},e.prototype.handleMergeTimeout=function(){if(this.streamSeqMergeMap){var e=Object.keys(this.streamSeqMergeMap).map((function(e){return+e})).sort((function(e,t){return e-t}));e[e.length-1]-e[0]+1===e.length||e[e.length-1]>=this.minStreamSeq?this.mergeStream(e):(this.streamSeqMergeMap=null,this.fetchStreamList())}},e.prototype.mergeStream=function(e){var t=this;this.logger.info(o.ZEGO_WEBRTC_ACTION.STREAMHANDLER_MERGE_STREAM+" merge streamList "+this.streamSeq+" streamSeqList "+e.join(","));var r=e[e.length-1],n=[];e.forEach((function(e){if(t.streamSeqMergeMap&&t.streamSeqMergeMap[e])switch(t.streamSeqMergeMap[e].cmd){case i.ENUM_STREAM_UPDATE_CMD.added:t.streamSeqMergeMap[e].streamList.forEach((function(e){var t=n.findIndex((function(t){return t.stream_id==e.stream_id}));-1!==t&&n.splice(t),n.push(e)}));break;case i.ENUM_STREAM_UPDATE_CMD.deleted:t.streamSeqMergeMap[e].streamList.forEach((function(e){var t=n.findIndex((function(t){return t.stream_id==e.stream_id}));-1!==t&&n.splice(t)}));break;case i.ENUM_STREAM_UPDATE_CMD.updated:t.streamSeqMergeMap[e].streamList.forEach((function(e){var t=n.findIndex((function(t){return t.stream_id==e.stream_id}));-1!==t&&n.splice(t),n.push(e)}))}})),this.streamSeqMergeMap=null,this.logger.info(o.ZEGO_WEBRTC_ACTION.STREAMHANDLER_MERGE_STREAM+" "+n),this.handleFullUpdateStream(r,n)},e.prototype.reset=function(){this.minStreamSeq=0,this.streamSeqMergeMap=null,this.streamSeqMergeTimer&&(clearTimeout(this.streamSeqMergeTimer),this.streamSeqMergeTimer=void 0),this.streamListHBMergeInterval=2e3,this.streamListMergeInterval=5e3},e.prototype.getRoomInfo=function(){var e=this;return new Promise((function(t,r){if(e.rtm.isLogin(e.roomID)){var i=function(e,i){if(0!==e.body.code)r({errorCode:e.body.code,extendData:e.body.message});else{var n=e.body.streams_info.map((function(e){return{streamID:e.stream_id,user:{userID:e.user_id,userName:e.user_name},extraInfo:e.extra_info}}));t({streamList:n})}},n={room_header:{room_id:e.roomID,room_sid:e.rtm.getRoomSid()||"0",room_user_session_id:e.rtm.getRoomSessionID()||"0"}};e.rtm.service.sendMessage("zegochat_js.room_info_req",n,i,i)}else e.logger.error("zn.rh.gri no enter room")}))},e}();t.StreamHandler=s},6706:function(e,t,r){"use strict";var i,n,o,s,a,c,l,u,d,h,p,f;Object.defineProperty(t,"__esModule",{value:!0}),t.ENUM_PUBLISH_STATE_UPDATE=t.LinkedList=t.ListNode=t.E_CLIENT_TYPE=t.ENUM_SOURCE_TYPE=t.ENUM_DISPATCH_TYPE=t.ENUM_BROADCASTER_STATUS=t.ENUM_PLAY_SOURCE_TYPE=t.ENUM_PUBLISH_STATE_NEGO=t.ENUM_PUSH_SIGNAL_SUB_CMD=t.ENUM_SIGNAL_SUB_CMD=t.QUALITYLEVEL=t.SERVER_ERROR_CODE=t.ENUM_STREAM_UPDATE_CMD_PRI=t.ENUM_STREAM_UPDATE_CMD=t.MINIUM_HEARTBEAT_INTERVAL=t.STREAM_DELETE_REASON=t.ENUM_NETWORK_STATE=t.ENUM_RUN_STATE=t.ENUM_STREAM_UPDATE_TYPE=t.ENUM_STREAM_CMD_PRI=t.ENUM_STREAM_SUB_CMD=t.ENUM_PUBLISH_STREAM_STATE=t.MAX_RETRY_CONNECT_INTERVAL=t.MAX_TRANS_DATA_LENGTH=t.MAX_TRANS_TYPE_LENGTH=t.MAX_MESSAGE_LENGTH=t.MAX_ROOM_ID_LENGTH=t.MAX_USER_NAME_LENGTH=t.MAX_USER_ID_LENGTH=t.MAX_STREAM_ID_LENGTH=t.MAX_TRY_HEARTBEAT_COUNT=t.SEND_MSG_TIMEOUT=t.SEND_MSG_RESET=t.MAX_TRY_CONNECT_COUNT=t.ENUM_CONNECT_STATE=t.ENUM_PROBE_STATE=t.ENUM_PLAY_STATE_NEGO=t.ENUM_PLAYER_STATE=t.ENUM_PLAY_STATE=t.ENUM_PUBLISH_STATE=t.ENUM_SCREEM_RESOLUTION_TYPE=t.ENUM_RESOLUTION_TYPE=t.ENUM_SIGNAL_STATE=t.ERROR_CODES=t.ENUM_REMOTE_TYPE=t.LOG_LEVEL=t.ENUM_LOG_LEVEL=t.ROOMVERSION=t.PROTO_VERSION=void 0,t.ZegoExpressWebRTM=t.ZegoDataReport=t.ZegoLogger=t.ZegoExpressWebRTMEngine=t.getReportSeq=t.getSeq=t.QUALITY_CONSTANT=t.QualityGrade=t.REPORT_ACTION=t.ENUM_RETRY_STATE=t.ENUM_PLAY_STATE_UPDATE=void 0,t.PROTO_VERSION="2.13.0",t.ROOMVERSION="V1",(f=t.ENUM_LOG_LEVEL||(t.ENUM_LOG_LEVEL={}))[f.debug=0]="debug",f[f.info=1]="info",f[f.warn=2]="warn",f[f.error=3]="error",f[f.report=99]="report",f[f.disable=100]="disable",t.LOG_LEVEL={debug:0,info:1,warn:2,error:3,report:99,disable:100},(p=t.ENUM_REMOTE_TYPE||(t.ENUM_REMOTE_TYPE={}))[p.disable=0]="disable",p[p.websocket=1]="websocket",p[p.https=2]="https",t.ERROR_CODES={ROOM_SESSION_ID_ERR:1000000152,FETCH_TRANS_UNKNOWN_CHANNEL:1000001108,FETCH_TRANS_UNKNOWN_TYPE:1000001109,FETCH_TRANS_WRONG_SEQ:1000001110},(h=t.ENUM_SIGNAL_STATE||(t.ENUM_SIGNAL_STATE={}))[h.disconnected=0]="disconnected",h[h.connecting=1]="connecting",h[h.connected=2]="connected",t.ENUM_RESOLUTION_TYPE={LOW:{width:320,height:240,frameRate:15,bitRate:300},MEDIUM:{width:640,height:480,frameRate:15,bitRate:800},HIGH:{width:1280,height:720,frameRate:20,bitRate:1500}},t.ENUM_SCREEM_RESOLUTION_TYPE={LOW:{frameRate:20,bitRate:800},MEDIUM:{frameRate:15,bitRate:1500},HIGH:{frameRate:5,bitRate:2e3}},t.ENUM_PUBLISH_STATE={start:0,waitingSessionRsp:1,waitingOfferRsp:2,waitingServerAnswer:3,waitingServerICE:4,connecting:5,publishing:6,stop:7,didNotStart:8},t.ENUM_PLAY_STATE={start:0,waitingSessionRsp:1,waitingOfferRsp:2,waitingServerAnswer:3,waitingServerICE:4,connecting:5,playing:6,stop:7,didNotStart:8},t.ENUM_PLAYER_STATE={start:0,playing:1,stop:2},t.ENUM_PLAY_STATE_NEGO={stop:0,start:1,waiterAnswer:2,waitingCandidate:3,sendCandidate:4,iceConnected:5,iceDisconnected:6,iceClosed:7,iceFailed:8},(d=t.ENUM_PROBE_STATE||(t.ENUM_PROBE_STATE={}))[d.tryProbe=0]="tryProbe",d[d.probed=2]="probed",t.ENUM_CONNECT_STATE={disconnect:0,connecting:1,connected:2},t.MAX_TRY_CONNECT_COUNT=3,t.SEND_MSG_RESET=2,t.SEND_MSG_TIMEOUT=1,t.MAX_TRY_HEARTBEAT_COUNT=5,t.MAX_STREAM_ID_LENGTH=256,t.MAX_USER_ID_LENGTH=64,t.MAX_USER_NAME_LENGTH=256,t.MAX_ROOM_ID_LENGTH=128,t.MAX_MESSAGE_LENGTH=1024,t.MAX_TRANS_TYPE_LENGTH=128,t.MAX_TRANS_DATA_LENGTH=4096,t.MAX_RETRY_CONNECT_INTERVAL=12,t.ENUM_PUBLISH_STREAM_STATE={waiting_url:1,tryPublish:2,update_info:3,publishing:4,stop:5,retryPublish:6},t.ENUM_STREAM_SUB_CMD={liveNone:0,liveBegin:2001,liveEnd:2002,liveUpdate:2003},t.ENUM_STREAM_CMD_PRI={liveBegin:"zegochat_js.room_stream_create_req",liveEnd:"zegochat_js.room_stream_delete_req",liveUpdate:"zegochat_js.room_stream_update_req"},t.ENUM_STREAM_UPDATE_TYPE={added:1,deleted:0},(u=t.ENUM_RUN_STATE||(t.ENUM_RUN_STATE={}))[u.logout=0]="logout",u[u.trylogin=1]="trylogin",u[u.login=2]="login",(l=t.ENUM_NETWORK_STATE||(t.ENUM_NETWORK_STATE={}))[l.offline=0]="offline",l[l.online=1]="online",t.STREAM_DELETE_REASON={0:{code:1,description:"user_stop_publishing_stream_normal"},1:{code:2,description:"user_heart_beat_timeout"},2:{code:3,description:"user_repeat_login"},3:{code:4,description:"user_kicked_out"},4:{code:5,description:"user_offline"},100:{code:6,description:"remove_by_server"}},t.MINIUM_HEARTBEAT_INTERVAL=3e3,t.ENUM_STREAM_UPDATE_CMD={added:12001,deleted:12002,updated:12003},t.ENUM_STREAM_UPDATE_CMD_PRI={added:1,updated:2,deleted:3},t.SERVER_ERROR_CODE=1e4,(c=t.QUALITYLEVEL||(t.QUALITYLEVEL={}))[c.low=1]="low",c[c.stantard=2]="stantard",c[c.hight=3]="hight",c[c.custome=4]="custome",t.ENUM_SIGNAL_SUB_CMD={none:0,joinLiveRequest:1001,joinLiveResult:1002,joinLiveInvite:1003,joinLiveStop:1004},t.ENUM_PUSH_SIGNAL_SUB_CMD={none:0,pushJoinLiveRequest:11001,pushJoinLiveResult:11002,pushJoinLiveInvite:11003,pushJoinLiveStop:11004},t.ENUM_PUBLISH_STATE_NEGO={stop:0,start:1,waiterAnswer:2,waitingCandidate:3,sendCandidate:4,iceConnected:5,iceDisconnected:6,iceClosed:7,iceFailed:8},(a=t.ENUM_PLAY_SOURCE_TYPE||(t.ENUM_PLAY_SOURCE_TYPE={}))[a.cdn=0]="cdn",a[a.ultra=1]="ultra",(s=t.ENUM_BROADCASTER_STATUS||(t.ENUM_BROADCASTER_STATUS={}))[s.stop=0]="stop",s[s.start=1]="start",(o=t.ENUM_DISPATCH_TYPE||(t.ENUM_DISPATCH_TYPE={}))[o.cdn=0]="cdn",o[o.ultra=1]="ultra",o[o.customUrl=2]="customUrl",(n=t.ENUM_SOURCE_TYPE||(t.ENUM_SOURCE_TYPE={}))[n.CDN=0]="CDN",n[n.BGP=1]="BGP",(i=t.E_CLIENT_TYPE||(t.E_CLIENT_TYPE={}))[i.ClientType_None=0]="ClientType_None",i[i.ClientType_H5=1]="ClientType_H5",i[i.ClientType_SmallPragram=2]="ClientType_SmallPragram",i[i.ClientType_Webrtc=3]="ClientType_Webrtc";var g=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this._id=null,this.next=null,this.prev=null,this._id=e,this._data=t}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id?this._id:null},set:function(e){this._id=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!1,configurable:!0}),e.prototype.hasNext=function(){return this.next&&this.next.id},e.prototype.hasPrev=function(){return this.prev&&this.prev.id},e}();t.ListNode=g;var m,_,v=function(){function e(){this.start=new g,this.end=new g,this._idCounter=0,this._numNodes=0,this.start.next=this.end,this.start.prev=null,this.end.prev=this.start,this.end.next=null}return e.prototype.insertBefore=function(e,t){var r=new g(this._idCounter,t);return r.next=e,r.prev=e.prev,e.prev&&(e.prev.next=r),e.prev=r,++this._idCounter,++this._numNodes,r},e.prototype.addLast=function(e){return this.insertBefore(this.end,e)},e.prototype.add=function(e){return this.addLast(e)},e.prototype.getFirst=function(){return 0===this._numNodes?null:this.start.next},e.prototype.getLast=function(){return 0===this._numNodes?null:this.end.prev},e.prototype.size=function(){return this._numNodes},e.prototype.getFromFirst=function(e){var t=0,r=this.start.next;if(e>=0)for(;t<e&&null!==r;)r=r.next,++t;else r=null;if(null===r)throw"Index out of bounds.";return r},e.prototype.get=function(e){return 0===e?this.getFirst():e===this._numNodes-1?this.getLast():this.getFromFirst(e)},e.prototype.remove=function(e){return e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),--this._numNodes,e},e.prototype.removeFirst=function(){var e=null;return this._numNodes>0&&this.start.next&&(e=this.remove(this.start.next)),e},e.prototype.removeLast=function(){var e=null;return this._numNodes>0&&this.end.prev&&(e=this.remove(this.end.prev)),e},e.prototype.removeAll=function(){this.start.next=this.end,this.end.prev=this.start,this._numNodes=0,this._idCounter=0},e.prototype.each=function(e){for(var t=this.start;t.hasNext();)e(t=t.next)},e.prototype.find=function(e){for(var t=this.start,r=!1,i=null;t.hasNext()&&!r;)e(t=t.next)&&(i=t,r=!0);return i},e.prototype.map=function(e){for(var t=this.start,r=[];t.hasNext();)e(t=t.next)&&r.push(t);return r},e.prototype.push=function(e){return this.addLast(e)},e.prototype.unshift=function(e){this._numNodes>0?this.insertBefore(this.start.next,e):this.insertBefore(this.end,e)},e.prototype.pop=function(){return this.removeLast()},e.prototype.shift=function(){return this.removeFirst()},e}();t.LinkedList=v,t.ENUM_PUBLISH_STATE_UPDATE={start:0,error:1,retry:2},t.ENUM_PLAY_STATE_UPDATE={start:0,error:1,retry:2,stop:3},t.ENUM_RETRY_STATE={didNotStart:0,retrying:1,finished:2},t.REPORT_ACTION={eventStart:"eventStart",eventEndWithMsgInfo:"eventEndWithMsgInfo",addEventMsg:"addEventMsg",addEvent:"addEvent",eventEnd:"eventEnd",addMsgInfo:"addMsgInfo"},(_=t.QualityGrade||(t.QualityGrade={}))[_.Unknown=-1]="Unknown",_[_.Excellent=0]="Excellent",_[_.Good=1]="Good",_[_.Middle=2]="Middle",_[_.Poor=3]="Poor",_[_.Die=4]="Die",(m=t.QUALITY_CONSTANT||(t.QUALITY_CONSTANT={}))[m.MinQuality=0]="MinQuality",m[m.DieQuality=0]="DieQuality",m[m.PoorMinQuality=1]="PoorMinQuality",m[m.MiddleMinQuality=30]="MiddleMinQuality",m[m.GoodMinQuality=60]="GoodMinQuality",m[m.ExcellentMinQuality=85]="ExcellentMinQuality",m[m.MaxQuality=100]="MaxQuality";var E=r(4119);Object.defineProperty(t,"getSeq",{enumerable:!0,get:function(){return E.getSeq}}),Object.defineProperty(t,"getReportSeq",{enumerable:!0,get:function(){return E.getReportSeq}}),Object.defineProperty(t,"ZegoExpressWebRTMEngine",{enumerable:!0,get:function(){return E.ZegoExpressWebRTMEngine}}),Object.defineProperty(t,"ZegoLogger",{enumerable:!0,get:function(){return E.ZegoLogger}}),Object.defineProperty(t,"ZegoDataReport",{enumerable:!0,get:function(){return E.ZegoDataReport}}),Object.defineProperty(t,"ZegoExpressWebRTM",{enumerable:!0,get:function(){return E.ZegoExpressWebRTM}})},2752:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCodeList=void 0,t.errorCodeList={NOT_LOGIN:{code:1000002,message:"not login room"},STREAMID_TOO_LONG:{code:1000014,message:"stream ID is too long"},STREAM_ID_NULL:{code:1000015,message:"streamID is empty"},STREAM_ID_INVALID_CHARACTER:{code:1000016,message:"stream ID contains illegal characters"},NETWORK_BROKEN:{code:1000017,message:"network is broken"},LOCALSTREAM_WRONG:{code:1000018,message:"local stream wrong"},INPUT_PARAM:{code:1100001,message:"input param error."},TIMEOUT:{code:1100002,message:"network timeout."},SOCKET_CLOSE:{code:1100003,msg:"socket close"},INIT_SDK_WRONG:{code:1101e3,message:"init sdk wrong"},WX_GET_SETTING_FAIL:{code:1101001,message:"wx get setting fail"},USER_ID_NULL:{code:1002005,message:"user ID is empty"},USER_ID_INVALID_CHARACTER:{code:1002006,message:"user ID contains illegal characters"},USER_ID_TOO_LONG:{code:1002007,message:"user ID is too long"},USER_NAME_NULL:{code:1002008,message:"username is empty"},USER_NAME_TOO_LONG:{code:1002010,message:"username is too long"},ROOM_ID_NULL:{code:1002011,message:"room ID is empty"},ROOM_ID_INVALID_CHARACTER:{code:1002012,message:"room ID contains illegal characters"},ROOM_ID_TOO_LONG:{code:1002013,message:"room ID is too long"},LOGIN_TIMEOUT:{code:1002031,message:"login timeout"},ROOM_MAX_USER_COUNT:{code:1002034,message:"users logging into the room exceeds the maximum number"},MULTIPLE_LOGIN_KICKOUT:{code:1002050,message:"kickout may be the same user ID login other"},ROOM_RETRY_TIMEOUT:{code:1002053,message:"network is broken and login fail."},MANUAL_KICKOUT:{code:1002055,message:"server has sent a signal to kick out"},ROOM_INNER_ERROR:{code:1002099,message:"room inner error"},HEARTBEAT_TIMEOUT:{code:1102001,message:"heartbeat timeout."},PARSE_JSON_ERROR:{code:1102011,message:"parse json error."},LOGIN_PROCESSING:{code:1102012,message:"login is processing."},LIVEROOM_REQUEST_ERROR:{code:1102013,message:"liveroom request error."},ZPUSH_REQUEST_FAIL:{code:1102014,message:"zpush request fail."},LOGIN_STATE_WRONG:{code:1102015,message:"user login state is wrong."},TOKEN_ERROR:{code:1102016,message:"token error"},DISPATCH_ERROR:{code:1102017,message:"dispatch error"},TOKEN_EXPIRED:{code:1102018,message:"token expired"},SUBCMD_ERROR:{code:1102019,message:"subcmd error."},ZEGO_AUTH_ERROR:{code:1102020,message:"zego auth error."},BIZ_CHANNEL_ERROR:{code:1102021,message:"biz channel error."},DISPATCH_TIMEOUT:{code:1102022,message:"dispatch request timeout"},CONNECT_FAILED:{code:1102023,message:"connect signal fail"},PUBLISHER_MEDIA_SERVER_FORBID:{code:1003025,message:"stream is forbided by media server"},PUBLISHER_EXTRA_INFO_TOO_LONG:{code:1003051,message:"stream extra info is too long"},PUBLISHER_PARAM:{code:1103001,message:"input param error"},PUBLISHER_BROWSER_NOT_SUPPORT:{code:1103002,message:"browser do not support"},PUBLISHER_DISPATCH_FAIL:{code:1103003,message:"dispatch request error"},PUBLISHER_SCREEN_FAILED:{code:1103010,message:"screen fail"},ENUMERATE_DEVICES_FAIL:{code:1103011,message:"enumerate devices fail"},PUBLISHER_DISPATCH_REQUEST_FAIL:{code:1103020,message:"dispatch request fail"},PUBLISHER_SESSION_REQUEST_FAIL:{code:1103021,message:"session request fail"},PUBLISHER_CREATE_OFFER_ERROR:{code:1103022,message:"create offer error"},PUBLISHER_SET_LOCAL_DESC_ERROR:{code:1103023,message:"setLocalDescription error"},PUBLISHER_MEDIA_DESC_ERROR:{code:1103024,message:"mediaDesc error"},PUBLISHER_SET_REMOTE_DESC_ERROR:{code:1103025,message:"other side offer error"},PUBLISHER_CANDIDATE_ERROR:{code:1103026,message:"candidate error"},PUBLISHER_SESSION_CLOSED:{code:1103027,message:"server session closed"},PUBLISHER_MEDIA_CONNECTION_ERROR:{code:1103028,message:"ice connection error"},PUBLISHER_SERVER_NEGO_TIMEOUT:{code:1103030,message:"negotiation timeout"},PUBLISH_DEVICE_OUT_ERR:{code:1103041,message:"device change "},PUBLISH_SCREEN_CANCELED:{code:1103042,message:"screen canceled"},PUBLISH_SCREEN_NOT_SUPPORT:{code:1103043,message:"screen not support"},PUBLISH_NO_PREVIEW:{code:1103044,message:"stream is not from zego"},REPEATED_PULL:{code:1103049,message:"repeated pull same stream"},PUBLISHER_WEBSOCKET_DISCONNECTED:{code:1103050,message:"websocket disconnected"},PUBLISHER_RETRY_TIMEOUT:{code:1103051,message:"publisher retry timeout"},PUBLISHER_HTTPS_REQUIRED:{code:1103053,message:"https is required"},PUBLISHER_NO_PREVIEW:{code:1103054,message:"no preview"},PUBLISHER_STREAM_NO_FOUND:{code:1103055,message:"publish stream no found"},PUBLISHER_IS_PUBLISHING:{code:1103056,message:"publish is publishing"},PUBLISHER_CLIENT_IP_CHANGED:{code:1103058,message:"client ip changed"},PUBLISHER_TTL_OVERTIME:{code:1103059,message:"ttl over time"},PUBLISHER_SESSION_TIMEOUT:{code:1103060,message:"session request timeout"},PUBLISHER_GET_USER_MEDIA_FAIL:{code:1103061,message:"get media fail"},PUBLISHER_DEVICE_NO_ALLOWED:{code:1103064,message:"get device not allowed"},PUBLISHER_DEVICE_NO_READABLE:{code:1103065,message:"device is not readable"},PUBLISHER_OVER_CONSTRAINED:{code:1103066,message:"device does not meet constraints"},PUBLISHER_UPDATE_SDP_TIMEOUT:{code:1103067,message:"update sdp time out"},PUBLISHER_UPDATE_SDP_FAIL:{code:1103068,message:"update sdp fail"},PLAYER_PARAM:{code:1104001,message:"input parm error"},PLAYER_DISPATCH_REQUEST_FAIL:{code:1104020,message:"dispatch request fail"},PLAYER_SESSION_REQUEST_FAIL:{code:1104021,message:"session request fail"},PLAYER_CREATE_OFFER_ERROR:{code:1104022,message:"create offer error"},PLAYER_SET_LOCAL_DESC_ERROR:{code:1104023,message:"setLocalDescription error"},PLAYER_MEDIA_DESC_ERROR:{code:1104024,message:"mediaDesc error"},PLAYER_SET_REMOTE_DESC_ERROR:{code:1104025,message:"other side offer error"},PLAYER_CANDIDATE_ERROR:{code:1104026,message:"candidate error"},PLAYER_SESSION_CLOSED:{code:1104027,message:"server session closed"},PLAYER_MEDIA_CONNECTION_ERROR:{code:1104028,message:"ice connection error"},PLAYER_WEBSOCKET_DISCONNECTED:{code:1104029,message:"websocket disconnected"},PLAYER_SERVER_NEGO_TIMEOUT:{code:1104030,message:"negotiation timeout"},PLAYER_RETRY_TIMEOUT:{code:1104031,message:"player retry timeout"},PLAYER_IS_PLAYING:{code:1104032,message:"player is playing"},PLAYER_CLIENT_IP_CHANGED:{code:1104033,message:"client ip changed"},PLAYER_TTL_OVERTIME:{code:1104034,message:"ttl is over time"},PLAYER_SESSION_RESET:{code:1104035,message:"reset session push"},PLAYER_SESSION_TIMEOUT:{code:1104036,message:"session request timeout"},PLAYER_PROBE_TIMEOUT:{code:1104037,message:"probe time out"},PLAYER_UNSUPPORTED_PROTOCOL:{code:1104038,message:"resource mode is not supported"},DEVICE_ERROR_TYPE_UNPLUGGED:{code:1006006,message:"the device is unplugged"},IM_CONTENT_NULL:{code:1009001,message:"message content is empty"},IM_CONTENT_TOO_LONG:{code:1009002,message:"message content is too long"},IM_SEND_FAILED:{code:1009010,message:"failed to send message"},FREQ_LIMITED:{code:1109001,message:"frequency limited."}}},3529:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoWechatLogEvent=t.ZegoRTCLogEvent=void 0;var i=r(2752),n=function(e){return e};t.ZegoRTCLogEvent={kZegoTaskCreateStream:{event:"/sdk/create_stream",error:{kBrowserNotSupportError:i.errorCodeList.PUBLISHER_BROWSER_NOT_SUPPORT,kParamError:i.errorCodeList.PUBLISHER_PARAM,kScreenCancelError:i.errorCodeList.PUBLISH_SCREEN_CANCELED,kScreenFailedError:i.errorCodeList.PUBLISHER_SCREEN_FAILED,kScreenNotSupportError:i.errorCodeList.PUBLISH_SCREEN_NOT_SUPPORT,kHttpsRequiredError:i.errorCodeList.PUBLISHER_HTTPS_REQUIRED,kGetUserMediaError:i.errorCodeList.PUBLISHER_GET_USER_MEDIA_FAIL,kDeviceNoAllowedError:i.errorCodeList.PUBLISHER_DEVICE_NO_ALLOWED,kDeviceNoReadableError:i.errorCodeList.PUBLISHER_DEVICE_NO_READABLE,kDeviceOverConstrainedError:i.errorCodeList.PUBLISHER_OVER_CONSTRAINED},stream_type:n,screen:n,camera:n,custom:n},kZegoTaskPublishStart:{event:"/sdk/api/publish_request",error:{kPublishParamError:i.errorCodeList.PUBLISHER_PARAM,kPublishNetworkTimeoutError:i.errorCodeList.TIMEOUT,kPublishDispatchTimeoutError:i.errorCodeList.DISPATCH_TIMEOUT,kPublishDispatchError:i.errorCodeList.DISPATCH_ERROR,kPublishNetworkBrokenError:i.errorCodeList.NETWORK_BROKEN,kPublishNoPreviewError:i.errorCodeList.PUBLISH_NO_PREVIEW,kPublishNoLoginError:i.errorCodeList.NOT_LOGIN,kPublishRetryTimeoutError:i.errorCodeList.PUBLISHER_RETRY_TIMEOUT,kMediaServerForbidError:i.errorCodeList.PUBLISHER_MEDIA_SERVER_FORBID,kPublishTokenExpiredError:i.errorCodeList.TOKEN_EXPIRED,kPublishSessionClosedError:i.errorCodeList.PUBLISHER_SESSION_CLOSED,kPublishNegoTimeoutError:i.errorCodeList.PUBLISHER_SERVER_NEGO_TIMEOUT,kCreateOfferError:i.errorCodeList.PUBLISHER_CREATE_OFFER_ERROR,kSetLocalDescError:i.errorCodeList.PUBLISHER_SET_LOCAL_DESC_ERROR,kSessionTimeoutError:i.errorCodeList.PUBLISHER_SESSION_TIMEOUT,kSessionRequestError:i.errorCodeList.PUBLISHER_SESSION_REQUEST_FAIL,kSetRemoteDescError:i.errorCodeList.PUBLISHER_SET_REMOTE_DESC_ERROR,kMediaConnectionError:i.errorCodeList.PUBLISHER_MEDIA_CONNECTION_ERROR,kWebsocketDisconnectedError:i.errorCodeList.PUBLISHER_WEBSOCKET_DISCONNECTED,kMediaDescError:i.errorCodeList.PUBLISHER_MEDIA_DESC_ERROR,kCandidateError:i.errorCodeList.PUBLISHER_CANDIDATE_ERROR,kIsPublishing:i.errorCodeList.PUBLISHER_IS_PUBLISHING,kClientIPChangedError:i.errorCodeList.PUBLISHER_CLIENT_IP_CHANGED,kTTLOverTimeError:i.errorCodeList.PUBLISHER_TTL_OVERTIME,kUpdateMediaDescriptionTimeOut:i.errorCodeList.PUBLISHER_UPDATE_SDP_TIMEOUT,kUpdateMediaDescriptionError:i.errorCodeList.PUBLISHER_UPDATE_SDP_FAIL},publishOption:n,message:n,session_id:n,stream:n,video_en_codec_id:n,cap_w:n,cap_h:n,w:n,h:n,video_en_fps:n,video_en_bps:n,audio_c_channel_count:n,audio_en_bps:n,aec_level:n,ans_level:n,agc:n,traffic_control_min_video_bitrate:n},kZegoTaskVideoCaptureSize:{event:"/sdk/api/publish_video_c_size",session_id:n,w:n,h:n},kZegoTaskVideoPlaySize:{event:"/sdk/play_video_size_changed",session_id:n,w:n,h:n},kZegoTaskRePublish:{event:"/sdk/republish",stream:n},kZegoTaskPublishStop:{event:"/sdk/stop_publish",error:{kParamError:i.errorCodeList.PUBLISHER_PARAM},stream:n},kZegoTaskPlayStart:{event:"/sdk/api/play_request",error:{kStreamIDNullError:i.errorCodeList.STREAM_ID_NULL,kPlayParamError:i.errorCodeList.PLAYER_PARAM,kPlayStreamIDToLongError:i.errorCodeList.STREAMID_TOO_LONG,kPlayStreamIDInvalidCharacterError:i.errorCodeList.STREAM_ID_INVALID_CHARACTER,kPlayNoLoginError:i.errorCodeList.NOT_LOGIN,kPlayRepeatedPullError:i.errorCodeList.REPEATED_PULL,kPlayNetworkTimeoutError:i.errorCodeList.TIMEOUT,kPlayDispatchTimeoutError:i.errorCodeList.DISPATCH_TIMEOUT,kPlayDispatchError:i.errorCodeList.DISPATCH_ERROR,kPlayNetworkBrokenError:i.errorCodeList.NETWORK_BROKEN,kPlayUnsupportedResourceMode:i.errorCodeList.PLAYER_UNSUPPORTED_PROTOCOL,kPlayRetryTimeoutError:i.errorCodeList.PLAYER_RETRY_TIMEOUT,kPlaySessionClosedError:i.errorCodeList.PLAYER_SESSION_CLOSED,kPlaySessionResetError:i.errorCodeList.PLAYER_SESSION_RESET,kPlayNegoTimeoutError:i.errorCodeList.PLAYER_SERVER_NEGO_TIMEOUT,kCreateOfferError:i.errorCodeList.PLAYER_CREATE_OFFER_ERROR,kSetLocalDescError:i.errorCodeList.PLAYER_SET_LOCAL_DESC_ERROR,kSessionRequestError:i.errorCodeList.PLAYER_SESSION_REQUEST_FAIL,kSessionTimeoutError:i.errorCodeList.PLAYER_SESSION_TIMEOUT,kSetRemoteDescError:i.errorCodeList.PLAYER_SET_REMOTE_DESC_ERROR,kMediaConnectionError:i.errorCodeList.PLAYER_MEDIA_CONNECTION_ERROR,kWebsocketDisconnectedError:i.errorCodeList.PLAYER_WEBSOCKET_DISCONNECTED,kCandidateError:i.errorCodeList.PLAYER_CANDIDATE_ERROR,kMediaDescError:i.errorCodeList.PLAYER_MEDIA_DESC_ERROR,kIsPlaying:i.errorCodeList.PLAYER_IS_PLAYING,kClientIPChangedError:i.errorCodeList.PLAYER_CLIENT_IP_CHANGED,kTTLOverTimeError:i.errorCodeList.PLAYER_TTL_OVERTIME,kProbeTimeOutError:i.errorCodeList.PLAYER_PROBE_TIMEOUT},playOption:n,message:n,session_id:n,stream:n,audio_activate:n,video_activate:n},kZegoTaskRePlay:{event:"/sdk/replay",stream:n},kZegoTaskPlayStop:{event:"/sdk/stop_play",error:{kParamError:i.errorCodeList.PUBLISHER_PARAM},stream:n},kZegoTaskEnumDevices:{event:"/device/list",error:{kBrowserNotSupportError:i.errorCodeList.PUBLISHER_BROWSER_NOT_SUPPORT,kEnumDevicesError:i.errorCodeList.ENUMERATE_DEVICES_FAIL},dev_list:n},kZegoTaskAudioOutput:{event:"/device/audio_capture",error:{kBrowserNotSupportError:i.errorCodeList.PUBLISHER_BROWSER_NOT_SUPPORT,kEnumDevicesError:i.errorCodeList.ENUMERATE_DEVICES_FAIL},session_id:n,device:n},kZegoTaskVideoCapture:{event:"/device/video_capture",error:{kBrowserNotSupportError:i.errorCodeList.PUBLISHER_BROWSER_NOT_SUPPORT,kEnumDevicesError:i.errorCodeList.ENUMERATE_DEVICES_FAIL},session_id:n,device:n},kZegoTaskDeviceInterrupt:{event:"/device/interrupt",error:{kBrowserNotSupportError:i.errorCodeList.PUBLISHER_BROWSER_NOT_SUPPORT,kEnumDevicesError:i.errorCodeList.ENUMERATE_DEVICES_FAIL},session_id:n,interrupt:n},kZegoTaskSetDebug:"/sdk/set_debug",kZegoTaskSetLog:"/sdk/set_log_config",kZegoTaskCheckSystemRequirements:{event:"/sdk/check_system",capability:n},kZegoTaskRemoteCameraUpdate:{event:"/sdk/remote_camera_update",stream:n,status:n},kZegoTaskRemoteMicUpdate:{event:"/sdk/remote_mic_update",stream:n,status:n},kZegoTaskDestroyStream:{event:"/sdk/destroy_stream",error:{kLocalStreamError:i.errorCodeList.LOCALSTREAM_WRONG}},kZegoTaskScreenSharingEnded:"/sdk/screen_share_end",kZegoTaskAudioOutputChanged:{event:"/device/api/audio_output",session_id:n,stream:n,device:n,reason:n},kZegoEventPublishStat:"/sdk/publish_stat_report",kZegoEventPlayStat:"/sdk/play_stat_report",kZegoTaskLiveRoomGetStreamUpdateInfo:{event:"/liveroom/get_stream_update_info",stream_update_type:n,update_stream:n},kZegoTaskLiveRoomGetStreamExtraInfo:{event:"/liveroom/get_stream_extra_info",update_stream:n},kZegoTaskPlayDecodeFirstVideoFrame:{event:"/sdk/play_decode_first_video_frame",session_id:n,fft_consumed:n},kZegoVisibilityChange:{event:"/app/background"},kZegoSetCaptureVolume:{event:"/sdk/set_capture_volume",error:{kParamError:i.errorCodeList.INPUT_PARAM}},kZegoListener:{event:"/sdk/listener"},kZegoNetProbe:{event:"/sdk/net_probe"},kZegoNetProbeResult:{event:"/sdk/net_probe_result"},kZegoTaskCloudSettingCache:{event:"/cloud_setting/cache"},kZegoTaskCloudSettingRefresh:{event:"/cloud_setting/refresh"}},t.ZegoWechatLogEvent={kZegoTaskCheckSystemRequirements:{event:"/sdk/check_system",error:{kCheckSystemGetSettingFailError:i.errorCodeList.WX_GET_SETTING_FAIL},capability:n},kZegoTaskPublishStart:{event:"/sdk/api/publish_request",error:{kPublishStreamIDNullError:i.errorCodeList.STREAM_ID_NULL,kPublishParamError:i.errorCodeList.PUBLISHER_PARAM,kPublishStreamIDTooLongError:i.errorCodeList.STREAMID_TOO_LONG,kPublishStreamIDInvalidCharacterError:i.errorCodeList.STREAM_ID_INVALID_CHARACTER,kPublishNetworkTimeoutError:i.errorCodeList.TIMEOUT,kPublishDispatchTimeoutError:i.errorCodeList.DISPATCH_TIMEOUT,kPublishDispatchError:i.errorCodeList.DISPATCH_ERROR,kPublishNetworkBrokenError:i.errorCodeList.NETWORK_BROKEN,kPublishNoLoginError:i.errorCodeList.NOT_LOGIN,kPublishRetryTimeoutError:i.errorCodeList.PUBLISHER_RETRY_TIMEOUT,kIsPublishing:i.errorCodeList.PUBLISHER_IS_PUBLISHING},publishOption:n,stream:n,message:n},kZegoTaskPlayStart:{event:"/sdk/api/play_request",error:{kPlayStreamIDNullError:i.errorCodeList.STREAM_ID_NULL,kPlayParamError:i.errorCodeList.PLAYER_PARAM,kPlayStreamIDTooLongError:i.errorCodeList.STREAMID_TOO_LONG,kPlayStreamIDInvalidCharacterError:i.errorCodeList.STREAM_ID_INVALID_CHARACTER,kPlayNoLoginError:i.errorCodeList.NOT_LOGIN,kPlayRepeatedPullError:i.errorCodeList.REPEATED_PULL,kPlayNetworkTimeoutError:i.errorCodeList.TIMEOUT,kPlayDispatchTimeoutError:i.errorCodeList.DISPATCH_TIMEOUT,kPlayDispatchError:i.errorCodeList.DISPATCH_ERROR,kPlayNetworkBrokenError:i.errorCodeList.NETWORK_BROKEN,kPlayRetryTimeoutError:i.errorCodeList.PLAYER_RETRY_TIMEOUT,kIsPlaying:i.errorCodeList.PLAYER_IS_PLAYING},playOption:n,message:n,session_id:n,stream:n,audio_activate:n,video_activate:n},kZegoEventPublishStat:"/sdk/publish_stat_report",kZegoEventPlayStat:"/sdk/play_stat_report",kZegoTaskRePublish:"/sdk/republish",kZegoTaskRePlay:"/sdk/replay",kZegoTaskPublishStop:{event:"/sdk/stop_publish",error:{kParamError:i.errorCodeList.PUBLISHER_PARAM},stream:n},kZegoTaskPlayStop:{event:"/sdk/stop_play",error:{kParamError:i.errorCodeList.PUBLISHER_PARAM},stream:n},kZegoTaskLiveRoomGetStreamUpdateInfo:{event:"/liveroom/get_stream_update_info",stream_update_type:n,update_stream:n},kZegoTaskLiveRoomGetStreamExtraInfo:{event:"/liveroom/get_stream_extra_info",update_stream:n}}},2367:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ZEGO_WEBRTC_ACTION=void 0,(r=t.ZEGO_WEBRTC_ACTION||(t.ZEGO_WEBRTC_ACTION={})).SET_VIDEO_CONFIG="zc.svc",r.SET_AUDIO_CONFIG="zc.sac",r.REPLACE_TRACK="zc.rp",r.SET_BEAUTY_EFFECT="zc.sbe",r.ENABLE_STREAM="zc.es",r.ENABLE_MIC_ONLY="zc.emo",r.ACTIVATE_SEI_INSERT="zc.asi",r.MUTE_PUBLISH_STREAM_VIDEO="zc.mpsv.0",r.MUTE_PUBLISH_STREAM_AUDIO="zc.mpsa.0",r.MUTE_MIC="zc.mm",r.MUTE_PLAY_STREAM_VIDEO="zc.mpsv.1",r.MUTE_PLAY_STREAM_AUDIO="zc.mpsa.1",r.ADD_TRACK="zc.at",r.REMOVE_TRACK="zc.rt",r.HANDLE_TRACK="zc.ht"},4495:function(e,t,r){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},n=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.AdvancedModule=void 0;var s=r(2367),a=r(5098),c=r(8706),l=function(){function e(e,t,r,i){this.logger=e,this.dataReport=t,this.streamCenter=r,this.stateCenter=i,this.screenShotReady=!1}return e.prototype.setVideoConfig=function(e,t){var r=this;return this.logger.info(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+" call"),new Promise((function(i,n){var o=r.stateCenter.getReportSeq();return r.dataReport.newReport(o,c.ZegoRTCLogEvent.kZegoSetVideoConfig.event),e instanceof MediaStream?t&&"object"==typeof t&&0!=Object.keys(t).length?t.width&&!r.stateCenter.checkValidNumber(t.width)?(r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+" constraints width integer number, range[1, 10000]"),r.dataReport.addMsgInfo(o,{error:c.ZegoRTCLogEvent.kZegoSetVideoConfig.error.kParamError.code,message:c.ZegoRTCLogEvent.kZegoSetVideoConfig.error.kParamError.message+" constraints width integer number, range[1, 10000]"}),r.dataReport.uploadReport(o),void n({errorCode:c.ZegoRTCLogEvent.kZegoSetVideoConfig.error.kParamError.code,extendedData:c.ZegoRTCLogEvent.kZegoSetVideoConfig.error.kParamError.message+" constraints wrong"})):t.height&&!r.stateCenter.checkValidNumber(t.height)?(r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+" constraints height integer number, range[1, 10000]"),r.dataReport.addMsgInfo(o,{error:c.ZegoRTCLogEvent.kZegoSetVideoConfig.error.kParamError.code,message:c.ZegoRTCLogEvent.kZegoSetVideoConfig.error.kParamError.message+" constraints height integer number, range[1, 10000]"}),r.dataReport.uploadReport(o),void n({errorCode:c.ZegoRTCLogEvent.kZegoSetVideoConfig.error.kParamError.code,extendedData:c.ZegoRTCLogEvent.kZegoSetVideoConfig.error.kParamError.message+" constraints wrong"})):void r.setPublishStreamConstraints(e,t,(function(e){r.dataReport.uploadReport(o),i(e)})):(r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+" constraints wrong"),r.dataReport.addMsgInfo(o,c.ZegoRTCLogEvent.kZegoSetVideoConfig.error.kParamError),r.dataReport.uploadReport(o),void n({errorCode:c.ZegoRTCLogEvent.kZegoSetVideoConfig.error.kParamError.code,extendedData:c.ZegoRTCLogEvent.kZegoSetVideoConfig.error.kParamError.message+" constraints wrong"})):(r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+" localStream not found"),r.dataReport.addMsgInfo(o,c.ZegoRTCLogEvent.kZegoSetVideoConfig.error.kLocalStreamError),r.dataReport.uploadReport(o),void n({errorCode:c.ZegoRTCLogEvent.kZegoSetVideoConfig.error.kParamError.code,extendedData:c.ZegoRTCLogEvent.kZegoSetVideoConfig.error.kParamError.message+" localStream no found"}))}))},e.prototype.setAudioConfig=function(e,t){var r=this;return this.logger.info(s.ZEGO_WEBRTC_ACTION.SET_AUDIO_CONFIG+" call"),new Promise((function(i){var n=r.stateCenter.getReportSeq();return r.dataReport.newReport(n,c.ZegoRTCLogEvent.kZegoSetAudioConfig.event),e instanceof MediaStream?!t||"object"!=typeof t||0==Object.keys(t).length||void 0!==t.AEC&&"boolean"!=typeof t.AEC||void 0!==t.AGC&&"boolean"!=typeof t.AGC||void 0!==t.ANS&&"boolean"!=typeof t.ANS?(r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_AUDIO_CONFIG+" constraints wrong"),r.dataReport.addMsgInfo(n,c.ZegoRTCLogEvent.kZegoSetAudioConfig.error.kParamError),r.dataReport.uploadReport(n),void i({errorCode:c.ZegoRTCLogEvent.kZegoSetAudioConfig.error.kParamError.code,extendedData:c.ZegoRTCLogEvent.kZegoSetAudioConfig.error.kParamError.message+" constraints wrong"})):void r.setPublishStreamConstraints(e,t,(function(e){r.dataReport.uploadReport(n),i(e)})):(r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_AUDIO_CONFIG+" localStream not found"),r.dataReport.addMsgInfo(n,c.ZegoRTCLogEvent.kZegoSetAudioConfig.error.kParamError),r.dataReport.uploadReport(n),void i({errorCode:c.ZegoRTCLogEvent.kZegoSetAudioConfig.error.kParamError.code,extendedData:c.ZegoRTCLogEvent.kZegoSetAudioConfig.error.kParamError.message+" localStream no found"}))}))},e.prototype.enableStream=function(e,t){if(this.logger.info(s.ZEGO_WEBRTC_ACTION.ENABLE_STREAM+" call"),"boolean"!=typeof t.video&&"boolean"!=typeof t.audio)return this.logger.error(s.ZEGO_WEBRTC_ACTION.ENABLE_STREAM+" option error"),!1;var r=!0,i=!0;return"boolean"==typeof t.video&&(r=this.enableCamera(e,t.video,t.retain)),"boolean"==typeof t.audio&&(i=this.enableMicrophone(e,t.audio)),r&&i},e.prototype.enableMicrophoneOnly=function(e){if(this.logger.info(s.ZEGO_WEBRTC_ACTION.ENABLE_MIC_ONLY+" call"),"boolean"!=typeof e)return!1;for(var t=0;t<this.streamCenter.previewStreamList.length;t++)if(!this.streamCenter.previewStreamList[t].enableMicrophoneOnly(e,this.streamCenter))return this.logger.error("zsc.emo.0 previewer "+t+" change mic mute state failed"),!1;return this.streamCenter.isMicEnabled=e,!0},e.prototype.replaceTrack=function(e,t){return n(this,void 0,void 0,(function(){var r,i;return o(this,(function(n){return r=this.stateCenter.getReportSeq(),this.dataReport.newReport(r,c.ZegoRTCLogEvent.kZegoReplaceTrack.event),e instanceof MediaStream?t&&t instanceof MediaStreamTrack?(i=this._replaceTrack(e,t),this.dataReport.uploadReport(r),[2,i]):(this.logger.error(s.ZEGO_WEBRTC_ACTION.REPLACE_TRACK+" mediastream track no found"),this.dataReport.uploadReport(r,void 0,c.ZegoRTCLogEvent.kZegoReplaceTrack.error.kParamError),[2,{errorCode:c.ZegoRTCLogEvent.kZegoReplaceTrack.error.kParamError.code,extendedData:c.ZegoRTCLogEvent.kZegoReplaceTrack.error.kParamError.message+" mediastream track no found"}]):(this.logger.error(s.ZEGO_WEBRTC_ACTION.REPLACE_TRACK+" localStream not found"),this.dataReport.uploadReport(r,void 0,c.ZegoRTCLogEvent.kZegoReplaceTrack.error.kParamError),[2,{errorCode:c.ZegoRTCLogEvent.kZegoReplaceTrack.error.kParamError.code,extendedData:c.ZegoRTCLogEvent.kZegoReplaceTrack.error.kParamError.message+" localStream no found"}])}))}))},e.prototype.setPublishStreamConstraints=function(e,t,r){var i=this,n=null;for(var o in this.logger.info("zsc.spsc.0 constraints",JSON.stringify(t)),this.streamCenter.publisherList)this.streamCenter.publisherList[o].localStream==e&&(n=this.streamCenter.publisherList[o]);if(!n)return this.logger.error("zsc.spsc.0 publisher not found"),void(r&&r({errorCode:a.errorCodeList.PUBLISH_NOT_PUBLISH.code,extendedData:a.errorCodeList.PUBLISH_NOT_PUBLISH.message}));this.logger.info("zsc.spsc.0 streamId ",n.streamID);var s=null==n?void 0:n.publisher.previewer;if(!s)return this.logger.error("zsc.spsc.0 preview no found"),void(r&&r({errorCode:a.errorCodeList.PUBLISH_NO_PREVIEW.code,extendedData:a.errorCodeList.PUBLISH_NO_PREVIEW.message}));var c=!1,l=!1;(t.width||t.height||t.frameRate)&&(s.mediaStreamConfig.videoQuality=4,c=!0),void 0===t.ANS&&void 0===t.AGC&&void 0===t.AEC||(l=!0);var u=s.localStream,d=s.videoTrack,h=s.audioTrack;c&&!d?(this.logger.error("zsc.spsc.0 video track not found"),r&&r({errorCode:a.errorCodeList.TRACK_NOT_FOUND.code,extendedData:a.errorCodeList.TRACK_NOT_FOUND.message})):t.video=!0,l&&!h?(this.logger.error("zsc.spsc.0 audio track not found"),r&&r({errorCode:a.errorCodeList.TRACK_NOT_FOUND.code,extendedData:a.errorCodeList.TRACK_NOT_FOUND.message})):t.audio=!0;var p=JSON.parse(JSON.stringify(s.mediaStreamConfig)),f=Object.assign(s.mediaStreamConfig,t),g=s.getMediaStreamConstraints(f,!0);this.logger.info("zsc.spsc.0 applyConstraints ",JSON.stringify(g));var m=[];if(c&&m.push(d.applyConstraints(g.video)),l&&(h.stop(),m.push(navigator.mediaDevices.getUserMedia({video:!1,audio:g.audio}))),t.maxBitrate){var _=n.publisher.peerConnection.getSenders().find((function(e){return e.track&&"video"===e.track.kind})),v=_.getParameters();_?(v.encodings||(v.encodings=[{}]),v.encodings[0].maxBitrate=1e3*t.maxBitrate,m.push(_.setParameters(v))):this.logger.error("zsc.spsc.0 video sender no found")}if(m.length>0)Promise.all(m).then((function(e){if(i.logger.info("zsc.spsc.0 set constraints success",e[1]),l){var o=(c?e[1]:e[0]).getAudioTracks()[0];o.enabled=0===n.publisher.mic_status;var s=n.publisher.peerConnection.getSenders().find((function(e){return"audio"===e.track.kind}));if(s&&(s.replaceTrack(o),u)){var a=i.streamCenter.checkPreview(u);a&&(a.replacePreviewTrack(o),a.gainNode=null)}}t.maxBitrate&&n.publisher&&(n.publisher.videoInfo.bitRate=t.maxBitrate),r&&r({errorCode:0,extendedData:""})})).catch((function(e){i.logger.error("zsc.spsc.0 fail reason ",e.name,JSON.stringify(e)),r&&r({errorCode:a.errorCodeList.PUBLISHER_CONSTRAINTS_ERROR.code,extendedData:e.name+" "+(e.constraint?"constraint:"+e.constraint:"")})}));else{if(this.logger.warn("zsc.spsc.0 constaints is no changes"),l){var E=s.getMediaStreamConstraints(p);this.logger.info("zsc.spsc.0 oldMediaStreamConstraints ",JSON.stringify(E)),navigator.mediaDevices.getUserMedia({video:!1,audio:E.audio}).then((function(e){var t=e.getAudioTracks()[0],r=(s.audioTrack,n.publisher.peerConnection.getSenders().find((function(e){return null!==e.track&&e.track.kind===h.kind})));if(r){r.replaceTrack(t);var o=i.streamCenter.checkPreview(u);o&&o.replacePreviewTrack(t)}i.logger.info("zsc.spsc.0.1 setbackup suc ")})).catch((function(e){i.logger.error("zsc.spsc.0.1 setbackup fail "+e.name)}))}r&&r({errorCode:a.errorCodeList.PUBLISHER_CONSTRAINTS_ERROR.code,extendedData:"constraints is no changes"})}},e.prototype.useVideoDevice=function(e,t){var r=this;return this.logger.info("zc.uvd.0 call"),new Promise((function(i){var n=r.stateCenter.getReportSeq();if(r.dataReport.newReport(n,c.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.event),r.dataReport.addMsgInfo(n,{device:c.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.device(t)}),!(e instanceof MediaStream))return r.logger.error("zc.uvd.0 localStream not found"),r.dataReport.addMsgInfo(n,c.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kLocalStreamError),r.dataReport.uploadReport(n),void i({errorCode:c.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kParamError.code,extendedData:c.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kParamError.message});if("string"!=typeof t)return r.logger.error("zc.uvd.0 deviceID must be string"),r.dataReport.addMsgInfo(n,{error:c.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kParamError.code,message:c.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kParamError.message+" deviceID must be string"}),r.dataReport.uploadReport(n),void i({errorCode:c.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kParamError.code,extendedData:c.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kParamError.message});var o=function(t){var o,s;r.dataReport.uploadReport(n);var a=r.streamCenter.checkPublish(e);a&&(a.cameraLabel=(null===(s=null===(o=a.publisher.previewer)||void 0===o?void 0:o.videoTrack)||void 0===s?void 0:s.label)||a.cameraLabel),i(t)};r.stateCenter.getDevices((function(n){if(!n.cameras.find((function(e){return e.deviceID==t})))return r.logger.error("zc.uvd.0 device is not found"),void i({errorCode:c.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kDevicesNoFoundError.code,extendedData:c.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kDevicesNoFoundError.message});r.switchDevice("video",e,t,o)}),(function(i){r.logger.warn("zc.uvd.0 getDevices err:",i),r.switchDevice("video",e,t,o)}))}))},e.prototype.useAudioDevice=function(e,t){var r=this;return this.logger.info("zc.uad.1 call"),new Promise((function(i){var n=r.stateCenter.getReportSeq();r.dataReport.newReport(n,c.ZegoRTCLogEvent.kZegoTaskUseAudioDevice.event),r.dataReport.addMsgInfo(n,{device:c.ZegoRTCLogEvent.kZegoTaskUseAudioDevice.device(t)});var o=function(e,t){r.logger.error("zc.uad.1 "+t);var o=e;o.message=o.message+(t?" "+t:""),r.dataReport.addMsgInfo(n,o),r.dataReport.uploadReport(n),i({errorCode:o.code,extendedData:o.message})},s=function(t){var o;r.dataReport.uploadReport(n);var s=r.streamCenter.checkPublish(e);s&&(s.microLabel=(null===(o=e.getAudioTracks()[0])||void 0===o?void 0:o.label)||s.microLabel),i(t)};e instanceof MediaStream?"string"==typeof t?r.stateCenter.getDevices((function(n){if(!n.microphones.find((function(e){return e.deviceID==t})))return r.logger.error("zc.uad.1 device is not found"),void i({errorCode:c.ZegoRTCLogEvent.kZegoTaskUseAudioDevice.error.kDevicesNoFoundError.code,extendedData:c.ZegoRTCLogEvent.kZegoTaskUseAudioDevice.error.kDevicesNoFoundError.message});r.switchDevice("audio",e,t,s)}),(function(i){r.logger.warn("zc.uad.1 getDevices err:",i),r.switchDevice("audio",e,t,s)})):o(c.ZegoRTCLogEvent.kZegoTaskUseAudioDevice.error.kParamError,"deviceID must be string"):o(c.ZegoRTCLogEvent.kZegoTaskUseAudioDevice.error.kLocalStreamError,"localStream not found")}))},e.prototype.publishTarget=function(e){var t=this,r=this.stateCenter.getReportSeq();switch(e.type){case"addpush":this.dataReport.newReport(r,c.ZegoRTCLogEvent.kZegoTaskAddPublishCdnUrl.event);break;case"delpush":case"clearpush":this.dataReport.newReport(r,c.ZegoRTCLogEvent.kZegoTaskRemovePublishCdnUrl.event)}return this.dataReport.addMsgInfo(r,{stream:c.ZegoRTCLogEvent.kZegoTaskRemovePublishCdnUrl.stream(e.streamID),target_url:c.ZegoRTCLogEvent.kZegoTaskRemovePublishCdnUrl.target_url(e.pushUrl)}),new Promise((function(i,n){var o=function(e,i){t.logger.error("zb.pt"+(i||e.message)),t.dataReport.addMsgInfo(r,{error:e.code,message:e.message+(i||"")}),t.dataReport.uploadReport(r),n({errorCode:e.code,extendedData:e.message+(i?" "+i:"")})};if(-1==["addpush","delpush","clearpush"].indexOf(e.type))return t.logger.error("zb.sh.pt cdn push type error"),void o(a.errorCodeList.PUBLISHER_CDN_PUSH_ERROR,"type error");if(e.streamID&&"string"==typeof e.streamID)if(e.pushUrl&&"string"==typeof e.pushUrl)if(t.stateCenter.publishStreamList[e.streamID]){var s=t.streamCenter.getRoomByStreamID(e.streamID);s?s.streamHandler._publishTarget(e,(function(e){t.dataReport.uploadReport(r),i(e)}),o):o(c.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kNoLoginError)}else o(c.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kPublishStreamNoFoundError);else o(c.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kParamError,"push url error");else o(c.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kParamError,"stream id type error")}))},e.prototype.handleTrack=function(e,t,r,i,c){var l;return n(this,void 0,void 0,(function(){var u,d,h,p,f,g,m,_,v,E,A=this;return o(this,(function(y){switch(y.label){case 0:return t instanceof MediaStream?r instanceof MediaStreamTrack&&"audio"!=r.kind?(u=this.streamCenter.checkPreview(t))?"video"===r.kind&&(null===(l=u.videoEffect)||void 0===l?void 0:l.enabled)?(this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" need to disable video beauty effect first"),c&&c({errorCode:a.errorCodeList.VIDEO_EFFECT_IS_RUNNING.code,extendedData:"need to disable video beauty effect before add or remove track"}),[2]):"ADD"==e&&(t.getTracks().length>=2||t.getTracks().find((function(e){return e.kind==r.kind})))?(this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" only stream which have one track and kind no exist can add track"),c&&c({errorCode:a.errorCodeList.TRACK_CAN_NOT_ADD.code,extendedData:a.errorCodeList.TRACK_CAN_NOT_ADD.message}),[2]):"REMOVE"!=e||1!=t.getTracks().length&&t.getTracks().includes(r)?!(d=this.streamCenter.checkPublish(t))||5===d.publisher.stateNego&&1!=d.publisher.isUpdateSDP?d?(h=d.publisher,p=u,f=d.publisher.peerConnection,h.isUpdateSDP=!0,"ADD"!=e?[3,1]:(f.addTrack(r,t),[3,4])):[3,6]:(this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" publish state wrong"),c&&c({errorCode:a.errorCodeList.PUBLISHER_STATE_WRONG.code,extendedData:a.errorCodeList.PUBLISHER_STATE_WRONG.message}),[2]):(this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" not supported"),c({errorCode:a.errorCodeList.HANDLE_TRACK_NOT_SUPPORTED.code,extendedData:a.errorCodeList.HANDLE_TRACK_NOT_SUPPORTED.message}),[2]):(this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" stream no found"),c&&c({errorCode:a.errorCodeList.PUBLISH_NO_PREVIEW.code,extendedData:a.errorCodeList.PUBLISH_NO_PREVIEW.message}),[2]):(this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" only can handle video track"),c({errorCode:a.errorCodeList.INPUT_PARAM.code,extendedData:a.errorCodeList.INPUT_PARAM.message}),[2]):(this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" stream wrong"),c({errorCode:a.errorCodeList.INPUT_PARAM.code,extendedData:a.errorCodeList.INPUT_PARAM.message}),[2]);case 1:return window.RTCPeerConnection&&window.RTCPeerConnection.prototype.getTransceivers&&window.RTCRtpTransceiver.prototype.stop?[4,f.getSenders().find((function(e){return e.track&&e.track==r}))]:(this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" not supported getTransceivers"),c({errorCode:a.errorCodeList.HANDLE_TRACK_NOT_SUPPORTED.code,extendedData:a.errorCodeList.HANDLE_TRACK_NOT_SUPPORTED.message}),[2]);case 2:return g=y.sent(),[4,f.getTransceivers().find((function(e){return e.sender==g}))];case 3:if(m=y.sent(),!(g&&m&&m.stop))return this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" sender no found"),c&&c({errorCode:a.errorCodeList.TRACK_NOT_FOUND.code,extendedData:a.errorCodeList.TRACK_NOT_FOUND.message}),[2];try{f.removeTrack(g),m.stop()}catch(e){this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" "+e),e&&e({errorCode:a.errorCodeList.PUBLISHER_UPDATE_SDP_FAIL.code,extendedData:a.errorCodeList.PUBLISHER_UPDATE_SDP_FAIL.message+" "+e})}y.label=4;case 4:return _={},v=this.streamCenter.previewStreamList.find((function(e){return e.localStream.getTracks().find((function(e){return e==r}))})),_=v&&"ADD"==e?v.videoInfo:{},[4,f.createOffer()];case 5:return E=y.sent(),h.onCreateOfferSuccess(E,!0,_,(function(s){return n(A,void 0,void 0,(function(){var n;return o(this,(function(o){return 0!==s?c&&c({errorCode:a.errorCodeList.PUBLISHER_UPDATE_SDP_FAIL.code,extendedData:a.errorCodeList.PUBLISHER_UPDATE_SDP_FAIL.message}):(n="video"==r.kind?"videoTrack":"audioTrack","ADD"==e?(t.addTrack(r),p[n]=r,"video"==r.kind&&1==r.enabled?h.sendStreamStatus(0,h.mic_status):1==r.enabled&&h.sendStreamStatus(h.camera_status,0)):("video"==r.kind?h.sendStreamStatus(2,h.mic_status):h.sendStreamStatus(h.camera_status,2),t.removeTrack(r),p[n]=null),u.mediaStreamConfig.video="ADD"==e,i({errorCode:0,extendedData:""})),[2]}))}))})),[3,7];case 6:"ADD"==e?t.addTrack(r):t.removeTrack(r),i({errorCode:0,extendedData:""}),u.mediaStreamConfig.video="ADD"==e,y.label=7;case 7:return[2]}}))}))},e.prototype.switchDevice=function(e,t,r,n){var o=this,s=this.streamCenter.checkPublish(t);if(s&&s.publisher&&5!==s.publisher.stateNego)return this.logger.error("zsc.sd.0 stream is publishing"),void(n&&n({errorCode:a.errorCodeList.PUBLISHER_STREAM_NO_FOUND.code,extendedData:a.errorCodeList.PUBLISHER_STREAM_NO_FOUND.message}));var c=this.streamCenter.checkPreview(t);if(!c)return this.logger.error("zsc.sd.0 preview no found"),void(n&&n({errorCode:a.errorCodeList.PUBLISH_NO_PREVIEW.code,extendedData:a.errorCodeList.PUBLISH_NO_PREVIEW.message}));if("video"===e&&0==c.mediaStreamConfig.video)return this.logger.error("zsc.sd.0 camera can not be changed when video is false"),void(n&&n({errorCode:a.errorCodeList.VIDEO_DEVICE_FALSE.code,extendedData:a.errorCodeList.VIDEO_DEVICE_FALSE.message}));if("audio"===e&&0==c.mediaStreamConfig.audio)return this.logger.error("zsc.sd.0 microphone can not be changed when audio is false"),void(n&&n({errorCode:a.errorCodeList.AUDIO_DEVICE_FALSE.code,extendedData:a.errorCodeList.AUDIO_DEVICE_FALSE.message}));c.mediaStreamConfig.videoInput!==r&&delete c.mediaStreamConfig.facingMode;var l,u={};"video"===e?(u.videoInput=r,l=c.videoTrack):(u.audioInput=r,l=c.audioTrack);var d=this.stateCenter.browser;this.logger.info("zsc.sd.0 browser "+d),"firefox"===d&&l.stop();var h=i(i({},c.mediaStreamConfig),u),p=c.getMediaStreamConstraints(h),f=function(t,r){r.getTracks().forEach((function(t){if(t.kind===e){var r=c["video"===e?"videoTrack":"audioTrack"];t.enabled=r.enabled,r&&r.stop(),s?s.publisher.replacePublishedTrack(t):c&&c.replacePreviewTrack(t)}})),c.restartSoundLevel()};"audio"==e?p.video=!1:p.audio=!1,navigator.mediaDevices.getUserMedia(p).then((function(t){Object.assign(c.mediaStreamConfig,u),f(0,t),o.logger.info("zsc.sd.0 swtich "+e+" device success"),n&&n({errorCode:0,extendedData:""})}),(function(t){var r,i;"video"==e?null===(r=c.videoTrack)||void 0===r||r.stop():null===(i=c.audioTrack)||void 0===i||i.stop(),o.logger.warn("zsc.sd.0 swtich "+e+" device failed, stop last device and retry. ",t+""),navigator.mediaDevices.getUserMedia(p).then((function(t){Object.assign(c.mediaStreamConfig,u),f(0,t),o.logger.info("zsc.sd.0 swtich "+e+" device success"),n&&n({errorCode:0,extendedData:""})}),(function(t){o.logger.warn("zsc.sd.0 swtich "+e+" device failed and recover last device. ",t+"");var r=c.getMediaStreamConstraints(c.mediaStreamConfig),i=a.errorCodeList.VIDEO_DEVICE_FALSE;"audio"===e&&(i=a.errorCodeList.AUDIO_DEVICE_FALSE),navigator.mediaDevices.getUserMedia(r).then((function(r){f(0,r),o.logger.info("zsc.sd.0 recover last "+e+" device success"),n&&n({errorCode:i.code,extendedData:i.message+" "+JSON.stringify(t)})}),(function(t){o.logger.error("zsc.sd.0 swtich "+e+" device and recover failed, please recreate stream. ",t+""),n&&n({errorCode:i.code,extendedData:i.message+" "+JSON.stringify(t)})}))}))}))},e.prototype._replaceTrack=function(e,t){var r=this.streamCenter.checkPreview(e),i=this.streamCenter.checkPublish(e);return i?i.publisher.replacePublishedTrack(t):r?r.localStream.getTracks().find((function(e){return e.kind===t.kind}))?(r.replacePreviewTrack(t),{errorCode:0,extendedData:""}):(this.logger.error("zc.rt.0 track no found"),{errorCode:a.errorCodeList.TRACK_NOT_FOUND.code,extendedData:a.errorCodeList.TRACK_NOT_FOUND.message}):(this.logger.error("zc.rt.0 preview no found"),{errorCode:a.errorCodeList.PUBLISH_NO_PREVIEW.code,extendedData:a.errorCodeList.PUBLISH_NO_PREVIEW.message})},e.prototype.enableMicrophone=function(e,t){var r=this.streamCenter.checkPreview(e);return r?r.enableMicrophone(t,this.streamCenter):(this.logger.error("zsc.em.0 no preview"),!1)},e.prototype.enableCamera=function(e,t,r){var i=this.streamCenter.checkPreview(e);return i?i.enableCamera(t,this.streamCenter,r):(this.logger.error("zsc.ec.0 no preview"),!1)},e.prototype.setBeautyEffect=function(e,t,r){var i=this;return new Promise((function(n,o){if(!(e instanceof MediaStream))return i.logger.error(s.ZEGO_WEBRTC_ACTION.SET_BEAUTY_EFFECT+" localStream not found"),void o({errorCode:c.ZegoRTCLogEvent.kZegoReplaceTrack.error.kParamError.code,extendedData:c.ZegoRTCLogEvent.kZegoReplaceTrack.error.kParamError.message+" localStream no found"});t=!!t;var l=function(e){n(e)},u=i.streamCenter.checkPreview(e);if(!u)return i.logger.error("zc.sbe.0 preview no found"),void l({errorCode:a.errorCodeList.PUBLISH_NO_PREVIEW.code,extendedData:a.errorCodeList.PUBLISH_NO_PREVIEW.message});u.setBeautyEffect(t,r).then((function(){l({errorCode:0,extendedData:""})})).catch((function(e){o({errorCode:-1,extendedData:e.toString()})}))}))},e}();t.AdvancedModule=l},4378:function(e,t,r){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},n=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.signal=t.publisher=t.publishModule=t.playModule=t.preview=t.streamHandler=t.zegoWebRTC=t.ENUM_PUBLISH_STREAM_STATE=t.ENUM_STREAM_CMD_PRI=t.ENUM_STREAM_SUB_CMD=t.PROTO_VERSION=void 0;var s=r(2367),a=r(5098),c=r(8706),l=r(7248);t.PROTO_VERSION="2.13.0",t.ENUM_STREAM_SUB_CMD={liveNone:0,liveBegin:2001,liveEnd:2002,liveUpdate:2003},t.ENUM_STREAM_CMD_PRI={liveBegin:"zegochat_js.room_stream_create_req",liveEnd:"zegochat_js.room_stream_delete_req",liveUpdate:"zegochat_js.room_stream_update_req"},t.ENUM_PUBLISH_STREAM_STATE={waiting_url:1,tryPublish:2,update_info:3,publishing:4,stop:5,retryPublish:6},t.zegoWebRTC={mutePublishStreamVideo:function(e,t,r){this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_PUBLISH_STREAM_VIDEO+" call");var i=this.stateCenter.getReportSeq();if(this.dataReport.newReport(i,c.ZegoRTCLogEvent.kZegoTaskMutePublishVideo),"boolean"!=typeof t||void 0!==r&&"boolean"!=typeof r)return this.logger.error(s.ZEGO_WEBRTC_ACTION.MUTE_PUBLISH_STREAM_VIDEO+" option error"),!1;var n=this.rtcModules.advancedModule.enableStream(e,{video:!t,retain:r});return this.dataReport.uploadReport(i),this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_PUBLISH_STREAM_VIDEO+" end"),n},mutePublishStreamAudio:function(e,t){this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_PUBLISH_STREAM_AUDIO+" call");var r=this.stateCenter.getReportSeq();if(this.dataReport.newReport(r,c.ZegoRTCLogEvent.kZegoTaskMutePublishAudio),"boolean"!=typeof t)return this.logger.error(s.ZEGO_WEBRTC_ACTION.MUTE_PUBLISH_STREAM_AUDIO+" option error"),!1;var i=this.rtcModules.advancedModule.enableStream(e,{audio:!t});return this.dataReport.uploadReport(r),this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_PUBLISH_STREAM_AUDIO+" end"),i},mutePlayStreamVideo:function(e,t){this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_PLAY_STREAM_VIDEO+" call "+e+" "+t);var r=this.stateCenter.getReportSeq();this.dataReport.newReport(r,c.ZegoRTCLogEvent.kZegoTaskMutePlayVideo);var i=this.rtcModules.playModule.mutePlayStream(e,"video",t);return this.dataReport.uploadReport(r),this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_PLAY_STREAM_VIDEO+" end"),i},mutePlayStreamAudio:function(e,t){this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_PLAY_STREAM_AUDIO+" call "+e+" "+t);var r=this.stateCenter.getReportSeq();this.dataReport.newReport(r,c.ZegoRTCLogEvent.kZegoTaskMutePlayAudio);var i=this.rtcModules.playModule.mutePlayStream(e,"audio",t);return this.dataReport.uploadReport(r),this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_PLAY_STREAM_AUDIO+"end"),i},muteMicrophone:function(e){this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_MIC+" call");var t=this.stateCenter.getReportSeq();if(this.dataReport.newReport(t,c.ZegoRTCLogEvent.kZegoTaskMuteMicrophone),"boolean"!=typeof e)return this.logger.error(s.ZEGO_WEBRTC_ACTION.MUTE_MIC+" option error"),!1;var r=this.rtcModules.advancedModule.enableMicrophoneOnly(!e);return this.dataReport.uploadReport(t),this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_MIC+" end"),r},activateSEIInsert:function(e){var t=e.stream,r=e.action,i=e.infoType;return this.rtcModules.publishModule.activateSEIInsert(t,r,i)},getAudioInfo:function(e,t,r){if(!e)return this.logger.error("localStream is empty!"),!1;var n=i({},r);return new l.MediaUtil(this.ac,n).connectToSource(e,(function(e){t(e)}))},startRecord:function(e){var t=this,r=this.streamCenter.checkPreview(e);if(r){var i=e.clone(),n=i.getAudioTracks();n.length>0&&r.hasEmptyAudioTrack&&n.forEach((function(e){i.removeTrack(e)})),this.recordedBlobs=[];var o={mimeType:"video/webm;codecs=vp9"};MediaRecorder.isTypeSupported(o.mimeType)||(o={mimeType:"video/webm;codecs=vp8,opus"},MediaRecorder.isTypeSupported(o.mimeType)||(o={mimeType:"video/webm;codecs=vp8"},MediaRecorder.isTypeSupported(o.mimeType)||(o={mimeType:"video/webm"},MediaRecorder.isTypeSupported(o.mimeType)||(o={mimeType:""}))));try{this.mediaRecorder=new MediaRecorder(i,o)}catch(e){return void this.logger.error("Exception while creating ZegoMediaRecorder:",e)}this.mediaRecorder.onstop=function(e){t.logger.warn("Recorder stopped: "+e)},this.mediaRecorder.ondataavailable=this.handleDataAvailable.bind(this),this.mediaRecorder.start(10)}else this.logger.error("stream is not from zego!")},stopRecord:function(){this.mediaRecorder?this.mediaRecorder.stop():this.logger.warn("please invoke startRecord first")},resumeRecord:function(){this.mediaRecorder?this.mediaRecorder.resume():this.logger.warn("please invoke startRecord first")},pauseRecord:function(){this.mediaRecorder?this.mediaRecorder.pause():this.logger.warn("please invoke startRecord first")},saveRecord:function(e){if(this.mediaRecorder&&this.recordedBlobs){var t=new Blob(this.recordedBlobs,{type:"video/webm"}),r=window.URL.createObjectURL(t),i=document.createElement("a");i.style.display="none",i.href=r,i.download=e+".webm",document.body.appendChild(i),i.click(),setTimeout((function(){document.body.removeChild(i),window.URL.revokeObjectURL(r)}),100)}else this.logger.warn("please invoke startRecord first")},handleDataAvailable:function(e){e.data&&e.data.size>0&&this.recordedBlobs.push(e.data)},takeSnapShot:function(e,t){if(e&&0!==e.videoHeight){var r=document.createElement("canvas");r.width=e.videoWidth,r.height=e.videoHeight;var i=r.getContext("2d");i&&i.drawImage(e,0,0,r.width,r.height),t.src=r.toDataURL("image/jpeg")}else this.logger.error("video can not empty")},saveSnapShot:function(e,t){if(e&&0!==e.videoHeight){var r=document.createElement("canvas");r.width=e.videoWidth,r.height=e.videoHeight;var i=r.getContext("2d");i&&i.drawImage(e,0,0,r.width,r.height),r.toBlob((function(e){var r=window.URL.createObjectURL(e),i=document.createElement("a");i.style.display="none",i.href=r,i.download=t+".jpeg",document.body.appendChild(i),i.click(),setTimeout((function(){document.body.removeChild(i),window.URL.revokeObjectURL(r)}),100)}))}else this.logger.error("video can not empty")},setStreamExtraInfo:function(e,t){var r=this;return new Promise((function(i,n){var o=r.stateCenter.getReportSeq();r.dataReport.newReport(o,c.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.event),r.dataReport.addMsgInfo(o,{stream:c.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.stream(e),stream_extra_info:c.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.stream_extra_info(t)});var s=function(e,t){r.logger.error("zb.ssei "+t),r.dataReport.addMsgInfo(o,{error:e.code,message:e.message+" "+t}),r.dataReport.uploadReport(o),n({errorCode:e.code,extendedData:e.message+" "+t})};if("string"==typeof e&&""!=e)if("string"==typeof t&&""!=t)if(r.RTM.service.isDisConnect())s(c.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.error.kNoLoginError,"not login");else if(r.stateCenter.publishStreamList[e]){var a=r.streamCenter.getRoomByStreamID(e);a?(r.dataReport.addMsgInfo(o,{room_sid:c.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.room_sid(a.sessionID)}),a.streamHandler.setStreamExtraInfo(e,t,i,s),r.dataReport.uploadReport(o)):s(c.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.error.kNoLoginError,"not login")}else s(c.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.error.kPublishStreamNoFoundError,"publish stream no found");else s(c.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.error.kParamError,"extraInfo must be string and no empty");else s(c.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.error.kParamError,"streamID must be string and not empty")}))},addTrack:function(e,t){var r=this;return new Promise((function(i,n){r.logger.info(s.ZEGO_WEBRTC_ACTION.ADD_TRACK+" call"),r.rtcModules.advancedModule.handleTrack("ADD",e,t,i,n)}))},removeTrack:function(e,t){var r=this;return new Promise((function(i,n){r.logger.info(s.ZEGO_WEBRTC_ACTION.REMOVE_TRACK+" call"),r.rtcModules.advancedModule.handleTrack("REMOVE",e,t,i,n)}))}},t.streamHandler={_publishTarget:function(e,r,i){var n=this;this.logger.info("zb.sh.ptcall");var o=Math.ceil((new Date).getTime()/1e3),s=e.streamID;this.stateCenter.testEnvironment&&(s="zegotest-"+this.stateCenter.appid+"-"+e.streamID);var l={appid:this.stateCenter.appid,biz_type:0,timestamp:o,seq:this.stateCenter.cdnSeq++,version:1*t.PROTO_VERSION,stream_id:s,pushurl:e.pushUrl},u={channel:"media",cmd:e.type,req_body:JSON.stringify(l)};this.logger.debug("zb.sh.pt send command"),this.sendBizChannelRequest(u,(function(t,o,s){if(n.logger.info("zb.sh.pt receive message"),0!=s.length){var l=JSON.parse(s),u=l.code,d=l.message;u&&0!=u?(n.logger.error("zb.sh.pt "+e.type+" error code: "+u+" "+d),i(a.errorCodeList.UNKNOWN_SERVER_ERROR," cmd: "+e.type+" "+u+" "+d)):(n.logger.info("zb.sh.pt "+e.type+" success"),r&&r({errorCode:0,extendedData:""}))}else i(c.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kNoResponseError)}),(function(t,r,o){n.logger.info("zb.sh.pt error: "+t);var s=c.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kUnknownServerError;2001==t?c.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kInvalidChannelError:2002==t&&(s=c.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kBizChannelError),n.logger.error("zb.sh.pt "),i(s," cmd: "+e.type+" "+t+"   ")}))},updateStreamExtraInfo:function(e,r,i,n){var o;this.logger.info("zb.sh.usei call"),o="PUBLIC"===this.stateCenter.type?t.ENUM_STREAM_SUB_CMD.liveUpdate:t.ENUM_STREAM_CMD_PRI.liveUpdate,this.stateCenter.publishStreamList[e]&&this.stateCenter.publishStreamList[e].state>=t.ENUM_PUBLISH_STREAM_STATE.update_info?(this.stateCenter.publishStreamList[e].extra_info=r,this.updateStreamInfo(e,o,r),i({errorCode:0})):n(c.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.error.kUpdateStreamInfoFailError)},setStreamExtraInfo:function(e,t,r,i){this.updateStreamExtraInfo(e,t,r,i)}},t.preview={enableCamera:function(e,t,r){var i,n,o,s=this;if(!this.localStream)return this.logger.error("zp.ec.2 no localStream"),!1;var a=this.videoTrack;if((!r||e)&&a&&(a.enabled=e,"chrome"===this.stateCenter.browser&&e&&void 0!==typeof a.getSettings().width&&a.getSettings().width>0)){var c=a.getSettings().width-1,l=a.getSettings().height-1;a.applyConstraints({width:c,height:l}),setTimeout((function(){a.applyConstraints({width:s.videoInfo.width,height:s.videoInfo.height})}),200)}var u=null===(i=t.checkPublish(this.localStream))||void 0===i?void 0:i.publisher;if(u){var d=null===(n=u.peerConnection)||void 0===n?void 0:n.getSenders().find((function(e){var t;return"video"===(null===(t=e.track)||void 0===t?void 0:t.kind)}));if(r&&!e){var h=this.videoTrack.clone();null==d||d.replaceTrack(h),h.stop()}else e&&((null===(o=this.videoEffect)||void 0===o?void 0:o.enabled)&&this.videoEffect.output?null==d||d.replaceTrack(this.videoEffect.output):null==d||d.replaceTrack(this.videoTrack));var p=e?0:20,f=this.isAudioEnabled&&t.isMicEnabled?0:20;u.camera_status===p&&u.mic_status===f||u.sendStreamStatus(p,f)}return this.logger.info("zp.ec.2 call success"),!0},enableMicrophone:function(e,t){var r;if(!this.localStream)return this.logger.error("zp.em.2 no localStream"),!1;this.localStream.getAudioTracks().forEach((function(t){t.enabled=e})),this.audioTrack&&(this.audioTrack.enabled=e&&t.isMicEnabled);var i=null===(r=t.checkPublish(this.localStream))||void 0===r?void 0:r.publisher;if(i&&i.signal){var n=i.camera_status,o=e&&t.isMicEnabled?0:20;i.camera_status===n&&i.mic_status===o||i.sendStreamStatus(n,o)}return this.isAudioEnabled=e,this.logger.debug("zp.em.2 call success"),!0},replacePreviewTrack:function(e,t){var r;return void 0===t&&(t=!1),n(this,void 0,void 0,(function(){var i,n;return o(this,(function(o){switch(o.label){case 0:return e&&e.kind&&this.localStream?(i="audio"===e.kind?"audioTrack":"videoTrack",t||!(null===(r=this.videoEffect)||void 0===r?void 0:r.enabled)||"video"!==e.kind?[3,2]:[4,this.videoEffect.setInput(e)]):[2];case 1:return o.sent(),[3,3];case 2:(n=this.localStream.getTracks().find((function(t){return t.kind===e.kind})))&&this.localStream.removeTrack(n),this.localStream.addTrack(e),o.label=3;case 3:return t||(this[i]=e),[2]}}))}))}},t.playModule={mutePlayStream:function(e,t,r){var i=this;return this.logger.info("zsc.mps.0 call "+t+" "+r),new Promise((function(n,o){if("string"!=typeof e||""==e)return i.logger.error("zsc.mps.0 streamID must be string and not empty"),void o(!1);if("boolean"!=typeof r)return i.logger.error("zsc.mps.0 mute must be boolean"),void o(!1);var s=i.streamCenter.playerList[e];if(!s)return i.logger.error("zsc.mps.0 player not found"),void o(!1);if("video"===t){if(s.playOption&&!1===s.playOption.video||s.player&&0!==s.player.cameraStatus)return i.logger.error("zsc.mps.0 stream no contain video"),void o(!1);s.player.signal.ActivatePlayVideoStream(i.stateCenter.getSeq(),s.player.sessionId,r,(function(){i.logger.info("zsc.mps.0 suc");var e=i.stateCenter.getReportSeq();s.player.playMediaStatus.video=!r,i.dataReport.newReport(e,c.ZegoRTCLogEvent.kZegoPlayContentChanged.event),i.dataReport.addMsgInfo(e,{session_id:c.ZegoRTCLogEvent.kZegoPlayContentChanged.session_id(s.player.sessionId),video_activate:c.ZegoRTCLogEvent.kZegoPlayContentChanged.video_activate(s.player.playMediaStatus.video?1:0),audio_activate:c.ZegoRTCLogEvent.kZegoPlayContentChanged.audio_activate(s.player.playMediaStatus.audio?1:0)}),i.playVideoStatus=i.dataReport.uploadReport(e),n(!0)}),(function(){i.logger.error("zsc.mps.0 fail"),o(!1)}))}else if("audio"===t){if(s.playOption&&!1===s.playOption.audio||s.player&&0!==s.player.micStatus)return i.logger.error("zsc.mps.0 stream no contain audio"),void o(!1);s.player.signal.ActivatePlayAudioStream(i.stateCenter.getSeq(),s.player.sessionId,r,(function(){i.logger.info("zsc.mps.0 suc");var e=i.stateCenter.getReportSeq();s.player.playMediaStatus.audio=!r,i.dataReport.newReport(e,c.ZegoRTCLogEvent.kZegoPlayContentChanged.event),i.dataReport.addMsgInfo(e,{session_id:c.ZegoRTCLogEvent.kZegoPlayContentChanged.session_id(s.player.sessionId),video_activate:c.ZegoRTCLogEvent.kZegoPlayContentChanged.video_activate(s.player.playMediaStatus.video?1:0),audio_activate:c.ZegoRTCLogEvent.kZegoPlayContentChanged.audio_activate(s.player.playMediaStatus.audio?1:0)}),i.dataReport.uploadReport(e),n(!0)}),(function(){i.logger.error("zsc.mps.0 fail"),o(!1)}))}else o(!1)}))},setStreamAudioOutput:function(e,t){var r=this;return!(null==t||0==t.length||!e||(this.logger.debug("zsc.ssao.0 device "+t),e?"undefined"!==e.sinkId?(e.setSinkId(t).then((function(){r.logger.info("zsc.ssao.0 success device: "+t)})).catch((function(e){r.logger.info("zsc.ssao.0 "+e.name)})),0):(this.logger.error("zsc.ssao.0 browser does not suppport"),1):(this.logger.error("zsc.ssao.0 no localVideo"),1)))}},t.publishModule={activateSEIInsert:function(e,t,r){void 0===r&&(r=0);var i=this.streamCenter.checkPreview(e);if(!i)return this.logger.error(s.ZEGO_WEBRTC_ACTION.ACTIVATE_SEI_INSERT+" stream is not created"),!1;if(0!==t&&1!==t)return this.logger.error(s.ZEGO_WEBRTC_ACTION.ACTIVATE_SEI_INSERT+" value of “action” should be 0 or 1"),!1;i.activatesSEIConfig={action:t,infoType:r};var n=this.streamCenter.checkPublish(e);return n&&(null==n||n.publisher.activateSEIInsert(t,r)),!0}},t.publisher={activateSEIInsert:function(e,t){var r=this;return new Promise((function(i,n){return r.signal?(r.signal&&r.signal.activateSEIInsert(r.stateCenter.getSeq(),r.sessionId,r.peerID,e,t,(function(e,t,n){var o=!1;0===n.result?(r.logger.info(s.ZEGO_WEBRTC_ACTION.ACTIVATE_SEI_INSERT+" called success"),o=!0):1===n.result?(r.logger.error(s.ZEGO_WEBRTC_ACTION.ACTIVATE_SEI_INSERT+" "+n.peer_id+" invalid param."),o=!1):2===n.result&&(r.logger.error(s.ZEGO_WEBRTC_ACTION.ACTIVATE_SEI_INSERT+" peer not exist"),o=!1),i(o)}),(function(e){1===e&&r.logger.error(s.ZEGO_WEBRTC_ACTION.ACTIVATE_SEI_INSERT+" request timeout")})),!1):i(!1)}))},replacePublishedTrack:function(e,t){var r,i;return void 0===t&&(t=!1),n(this,void 0,void 0,(function(){var n,s,c,l,u,d,h,p;return o(this,(function(o){switch(o.label){case 0:return n=this.localStream,s=this.previewer,c=s.videoEffect,l=e.kind,u=s[l+"Track"],d=null===(r=this.peerConnection)||void 0===r?void 0:r.getSenders().find((function(e){return e.track.kind===l})),u?(h=0,p=0,"video"===l?(h=t?!0===u.enabled?0:20:!0===e.enabled?0:20,p=n.getAudioTracks()[0]&&1==n.getAudioTracks()[0].enabled?0:20):"audio"===l&&(p=!0===e.enabled?0:20,h=1==(null===(i=s.videoTrack)||void 0===i?void 0:i.enabled)?0:20),[4,s.replacePreviewTrack(e,t)]):[3,2];case 1:return o.sent(),d?("audio"!==l&&!t&&(null==c?void 0:c.enabled)||d.replaceTrack(e),this.camera_status===h&&this.mic_status===p||this.sendStreamStatus(h,p)):this.logger.info("zc.rt.1 replace remote track will work after stream published"),this.logger.info("zc.rt.1 replace remote track success"),[2,{errorCode:0,extendedData:""}];case 2:return this.logger.error("zc.rt.1 publisher track no found"),[2,{errorCode:a.errorCodeList.TRACK_NOT_FOUND.code,extendedData:a.errorCodeList.TRACK_NOT_FOUND.message}]}}))}))}},t.signal={activateSEIInsert:function(e,t,r,i,n,o,a){this.logger.info(s.ZEGO_WEBRTC_ACTION.ACTIVATE_SEI_INSERT+" call "+t);var c={peer_id:r,action:i,info_type:n};this.sendMessageWithCallback("ActivateSEIInsertReq",e,t,c,o,a)}}},5098:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCodeList=void 0,t.errorCodeList={NOT_LOGIN:{code:1000002,message:"not login room"},INPUT_PARAM:{code:1100001,message:"input param error."},PUBLISH_NOT_PUBLISH:{code:1103040,message:"publisher not found"},PUBLISH_NO_PREVIEW:{code:1103044,message:"stream is not from zego"},TRACK_NOT_FOUND:{code:1103047,message:"track is not found"},DEVICE_NOT_FOUND:{code:1103048,message:"device is not found"},PUBLISHER_CONSTRAINTS_ERROR:{code:1103029,message:"constraint error"},PUBLISHER_CDN_PUSH_ERROR:{code:1103052,message:"publisher cdn push error"},VIDEO_DEVICE_FALSE:{code:1103045,message:"video is false"},AUDIO_DEVICE_FALSE:{code:1103046,message:"audio is false"},UNKNOWN_SERVER_ERROR:{code:1100999,message:"unknown server error"},LOCALSTREAM_WRONG:{code:1000018,message:"local stream wrong"},PUBLISHER_STREAM_NO_FOUND:{code:1103055,message:"publish stream no found"},PUBLISH_TARGET_NO_RESPONSE:{code:1103063,message:"publish target no response"},BIZ_CHANNEL_ERROR:{code:1102021,message:"biz channel error."},INVALID_CHANNEL:{code:1102024,message:"invalid channel"},PUBLISHER_EXTRA_INFO_NULL:{code:1003050,message:"extra info of publishing stream is null"},PUBLISHER_UPDATE_STREAM_INFO_FAIL:{code:1103062,message:"update stream info fail"},TRACK_CAN_NOT_ADD:{code:1103063,message:"only stream which have one track and kind no exist can add track"},TRACK_CAN_NOT_REMOVE:{code:1103064,message:"stream which only has one track can not remove "},PUBLISHER_UPDATE_SDP_FAIL:{code:1103068,message:"update sdp fail"},PUBLISHER_STATE_WRONG:{code:1103069,message:"publisher state wrong"},HANDLE_TRACK_NOT_SUPPORTED:{code:1103070,message:"not support remove track"},VIDEO_EFFECT_IS_RUNNING:{code:1103071,message:"video effect processor is running"}}},3824:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(4495),n=r(4378);t.default={type:"Advance",install:function(e,t,r,o,s,a,c,l){for(var u in Object.defineProperty(t.prototype,"initAdvance",{value:function(){this.advancedModule=new i.AdvancedModule(this.logger,this.dataReport,this.streamCenter,this.stateCenter)},writable:!1}),n.zegoWebRTC)Object.defineProperty(e.prototype,u,{value:n.zegoWebRTC[u],writable:!1});for(var u in n.streamHandler)Object.defineProperty(r.prototype,u,{value:n.streamHandler[u],writable:!1});for(var u in n.preview)Object.defineProperty(o.prototype,u,{value:n.preview[u],writable:!1});for(var u in n.playModule)Object.defineProperty(s.prototype,u,{value:n.playModule[u],writable:!1});for(var u in n.publishModule)Object.defineProperty(a.prototype,u,{value:n.publishModule[u],writable:!1});for(var u in n.publisher)Object.defineProperty(c.prototype,u,{value:n.publisher[u],writable:!1});for(var u in n.signal)Object.defineProperty(l.prototype,u,{value:n.signal[u],writable:!1})}}},8706:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoRTCLogEvent=void 0;var i=r(5098),n=function(e){return e};t.ZegoRTCLogEvent={kZegoSetVideoConfig:{event:"/sdk/set_video_config",error:{kParamError:i.errorCodeList.INPUT_PARAM,kLocalStreamError:i.errorCodeList.LOCALSTREAM_WRONG}},kZegoSetAudioConfig:{event:"/sdk/set_audio_config",error:{kParamError:i.errorCodeList.INPUT_PARAM}},kZegoReplaceTrack:{event:"/sdk/replace_track",error:{kParamError:i.errorCodeList.INPUT_PARAM}},kZegoTaskUseVideoDevice:{event:"/device/api/video_c",error:{kParamError:i.errorCodeList.INPUT_PARAM,kDevicesNoFoundError:i.errorCodeList.DEVICE_NOT_FOUND,kLocalStreamError:i.errorCodeList.LOCALSTREAM_WRONG},device:n},kZegoTaskUseAudioDevice:{event:"/device/api/audio_c",error:{kParamError:i.errorCodeList.INPUT_PARAM,kDevicesNoFoundError:i.errorCodeList.DEVICE_NOT_FOUND,kLocalStreamError:i.errorCodeList.LOCALSTREAM_WRONG},device:n},kZegoTaskPublishTarget:{event:"/sdk/publish_target",error:{kParamError:i.errorCodeList.INPUT_PARAM,kPublishStreamNoFoundError:i.errorCodeList.PUBLISHER_STREAM_NO_FOUND,kNoLoginError:i.errorCodeList.NOT_LOGIN,kNoResponseError:i.errorCodeList.PUBLISH_TARGET_NO_RESPONSE,kBizChannelError:i.errorCodeList.BIZ_CHANNEL_ERROR,kInvalidChannelError:i.errorCodeList.INVALID_CHANNEL,kUnknownServerError:i.errorCodeList.UNKNOWN_SERVER_ERROR}},kZegoTaskAddPublishCdnUrl:{event:"/sdk/add_publish_cdn_url",error:{kParamError:i.errorCodeList.INPUT_PARAM}},kZegoTaskRemovePublishCdnUrl:{event:"/sdk/remove_publish_cdn_url",error:{kParamError:i.errorCodeList.INPUT_PARAM},stream:n,target_url:n},kZegoTaskClearPublishCdnUrl:{event:"/sdk/clear_publish_cdn_url",error:{kParamError:i.errorCodeList.INPUT_PARAM}},kZegoPlayContentChanged:{event:"/sdk/play_content_changed",session_id:n,video_activate:n,audio_activate:n},kZegoTaskMutePublishVideo:"/sdk/mute_publish_video",kZegoTaskMutePublishAudio:"/sdk/mute_publish_audio",kZegoTaskMuteMicrophone:"/sdk/mute_microphone",kZegoTaskMutePlayVideo:"/sdk/mute_play_video",kZegoTaskMutePlayAudio:"/sdk/mute_play_audio",kZegoTaskLiveRoomSendStreamExtraInfo:{event:"/liveroom/send_stream_extra_info",error:{kParamError:i.errorCodeList.INPUT_PARAM,kExtraInfoNullError:i.errorCodeList.PUBLISHER_EXTRA_INFO_NULL,kNoLoginError:i.errorCodeList.NOT_LOGIN,kPublishStreamNoFoundError:i.errorCodeList.PUBLISHER_STREAM_NO_FOUND,kUpdateStreamInfoFailError:i.errorCodeList.PUBLISHER_UPDATE_STREAM_INFO_FAIL},stream:n,stream_extra_info:n,room_sid:n}}},7248:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediaUtil=void 0;var r=function(){function e(e,t){var r=this,i=t.type,n=t.channels,o=void 0===n?1:n,s=t.bufferSize,a=void 0===s?0:s,c=t.sampleBit,l=void 0===c?16:c,u=t.sampleRate,d=void 0===u?44100:u;this.instant=0,this.slow=0,this.clip=0,this.context=e,this.type=i,this.channels=o,this.bufferSize=a,this.sampleBit=l,this.sampleRate=d,this.script=e.createScriptProcessor(a,o,o),(new Date).getTime(),this.script.addEventListener("audioprocess",(function(e){var t,n=e.inputBuffer.getChannelData(0),o=0,s=0;for(t=0;t<n.length;++t)o+=n[t]*n[t],Math.abs(n[t])>.99&&(s+=1);if(r.instant=Math.sqrt(o/n.length),r.slow=.95*r.slow+.05*r.instant,r.clip=s/n.length,"pcm"===i||"wav"===i){for(var a=[],c=0;c<r.channels;c++)a.push(e.inputBuffer.getChannelData(c));r.recorderBuffer(a)}})),"pcm"!==i&&"wav"!==i||this.initRecorderBuffer(i)}return e.prototype.connectToSource=function(e,t){try{this.mic=this.context.createMediaStreamSource(e),this.mic.connect(this.script),this.script.connect(this.context.destination),void 0!==t&&t(null)}catch(e){console.error(e),void 0!==t&&t(e)}return this},e.prototype.recorderBuffer=function(e){this.worker.postMessage({command:"record",val:e})},e.prototype.initRecorderBuffer=function(e){var t=this;this.worker=this.inlineWorker((function(){var e,t,r,i,n,o,s=[];function a(e,t,r){for(var i=0;i<r.length;i++,t+=2){var n=Math.max(-1,Math.min(1,r[i]));e.setInt16(t,n<0?32768*n:32767*n,!0)}}function c(e,t,r){for(var i=0;i<r.length;i++,t++){var n=Math.max(-1,Math.min(1,r[i])),o=n<0?128*n:127*n;o+=128,e.setInt8(t,o)}}function l(e,t,r){for(var i=0;i<r.length;i++)e.setUint8(t+i,r.charCodeAt(i))}function u(e,t){for(var r=new Float32Array(t.length/e),i=0,n=0;i<r.length;)r[i]=t[n],n+=e,i++;return r}function d(e,t,r){for(var i=new Float32Array(t*e.length),n=0,o=0;o<r[0].length;o++)i.set(r[0][o],n),n+=r[0][o].length;return i}function h(e,t){for(var r=new Float32Array(e.length+t.length),i=0;i<e.length+t.length;i+=2)r[i]=e[i/2>>0],r[i+1]=t[i/2>>0];return r}function p(t){var r,i;if(1==e)r=d(s[0],n,s),1!=t&&(i=u(t,r));else if(2==e){var o=d(s[0],n,s),a=d(s[1],n,s);1!=t?i=h(u(t,o),u(t,a)):r=h(o,a)}return 1!=t?i:r}this.onmessage=function(u){switch(u.data.command){case"init":d=u.data.val,e=d.sampleChannel,t=d.sampleBit,r=d.sampleRate,i=d.oldSampleRate,n=d.bufferSize,o=d.type;break;case"record":!function(n){for(var u=0;u<e;u++)s[u]||(s[u]=[]),s[u].push(n[u]);var d=Math.round(i/r);"pcm"===o?function(e){var r=function(e,r){var i;8==r?i=e.length:16==r&&(i=e.length,i*=2);var n=new ArrayBuffer(i),o=new DataView(n);return 8==r?c(o,0,e):16==t&&a(o,0,e),o}(p(e),t);self.postMessage({command:"exportPcmLive",val:r})}(d):"wav"===o&&function(i){var n=function(i,n){var o;8==n?o=i.length:16==t&&(o=i.length,o*=2);var s=new ArrayBuffer(o+44),u=new DataView(s),d=r,h=t,p=e;return l(u,0,"RIFF"),u.setUint32(4,36+o,!0),l(u,8,"WAVE"),l(u,12,"fmt "),u.setUint32(16,16,!0),u.setUint16(20,1,!0),u.setUint16(22,p,!0),u.setUint32(24,d,!0),u.setUint32(28,d*p*(h/8),!0),u.setUint16(32,p*(h/8),!0),u.setUint16(34,h,!0),l(u,36,"data"),u.setUint32(40,o,!0),8==t?c(u,44,i):16==t&&a(u,44,i),u}(p(i),t);self.postMessage({command:"exportWav",val:n})}(d),s=[]}(u.data.val)}var d}})),this.worker.postMessage({command:"init",val:{sampleChannel:this.channels,sampleBit:this.sampleBit,sampleRate:this.sampleRate,oldSampleRate:this.context.sampleRate,bufferSize:this.bufferSize,type:e}}),this.worker.onmessage=function(e){switch(e.data.command){case"exportPcmLive":t.onReceiveBuffer(e.data.val);break;case"exportWav":t.onReceiveWav(e.data.val)}}},e.prototype.onReceiveBuffer=function(e){},e.prototype.onReceiveWav=function(e){},e.prototype.writeString=function(e,t,r){for(var i=0;i<r.length;i++)e.setUint8(t+i,r.charCodeAt(i))},e.prototype.writeBuffer=function(e,t,r){for(var i=0;i<r.byteLength;i++)e.setUint8(t+i,r[i])},e.prototype.concatenation=function(e){for(var t=0,r=0;r<e.length;++r)t+=e[r].buffer.byteLength;var i=new Uint8Array(t),n=0;for(r=0;r<e.length;++r)i.set(new Uint8Array(e[r].buffer),n),n+=e[r].buffer.byteLength;return i},e.prototype.encodeWave=function(e){var t=this.concatenation(e),r=t.byteLength,i=new ArrayBuffer(r+44),n=new DataView(i),o=this.sampleRate,s=this.sampleBit,a=this.channels;return this.writeString(n,0,"RIFF"),n.setUint32(4,36+r,!0),this.writeString(n,8,"WAVE"),this.writeString(n,12,"fmt "),n.setUint32(16,16,!0),n.setUint16(20,1,!0),n.setUint16(22,a,!0),n.setUint32(24,o,!0),n.setUint32(28,o*a*(s/8),!0),n.setUint16(32,a*(s/8),!0),n.setUint16(34,s,!0),this.writeString(n,36,"data"),n.setUint32(40,r,!0),this.writeBuffer(n,44,t),n},e.prototype.stop=function(){this.mic.disconnect(),this.script.disconnect()},e.prototype.inlineWorker=function(e){if(Worker&&e){var t=e.toString().trim().match(/^function\s*\w*\s*\([\w\s,]*\)\s*{([\w\W]*?)}$/)[1],r=URL.createObjectURL(new window.Blob([t],{type:"text/javascript"}));return new Worker(r)}return null},e}();t.MediaUtil=r},2523:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ZEGO_WEBRTC_ACTION=void 0,(r=t.ZEGO_WEBRTC_ACTION||(t.ZEGO_WEBRTC_ACTION={})).PRELOAD_EFFECT="zc.pe.0",r.PLAY_EFFECT="zc.pe.1",r.PAUSE_EFFECT="zc.pe.2",r.RESUME_EFFECT="zc.re",r.STOP_EFFECT="zc.se",r.UNLOAD_EFFECT="zc.ue",r.SET_EFFECT_VOLUME="zc.sev",r.START_MIXING_AUDIO="zc.sma.0",r.STOP_MIXING_AUDIO="zc.sma.1",r.MIXING_BUFFER="zc.mb",r.STOP_MIXING_BUFFER="zc.smb",r.SET_MIXING_AUDIO_VOLUME="zc.smav",r.PUBLISHER_PLAY_EFFECT="zc.p.0.pe.0",r.PUBLISHER_PAUSE_EFFECT="zc.p.0.pe.1",r.PUBLISHER_RESUME_EFFECT="zc.p.0.re",r.PUBLISHER_STOP_EFFECT="zc.p.0.se",r.PUBLISHER_START_MIXING_AUDIO="zc.p.0.sma.0",r.PUBLISHER_STOP_MIXING_AUDIO="zc.p.0.sma.1",r.PUBLISHER_MIXING_BUFFER="zc.p.0.mb",r.PUBLISHER_SET_MIXING_AUDIO_VOLUME="zc.p.0.smav"},4194:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AudioMix=void 0;var i=r(4853),n=function(){function e(e,t,r,i){this.logger=e,this.stateCenter=t,this.ac=r,this.mediaEleSources=i,this.audioBufferList=[],this.loop=!1,this.replace=!1,this.effectEndedCallBack=null,this.effectEndedListener=null,this.startTimes=0,this.startOffset=0,this.pauseTimes=0,this.resumeOffset=0,this.paused=!1,this.isMixAudio=!1,this.isMixingBuffer=!1,this.audioCurrentTimer=null}return e.prototype.preloadEffect=function(e,t){var r=this;this.logger.info("amu.pe.0 start preload effect");var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=function(){if(200==i.status||304==i.status){var e=i.response;r.ac.resume(),r.ac.decodeAudioData(e,(function(e){r.logger.info("amu.pe.0 effect preload success"),t("",e)}),(function(e){t(e)}))}else{var n=i.statusText;t(n)}},i.send()},e.prototype.playEffect=function(e,t,r,i,n){var o=this;!0!==this.isMixAudio?this.audioBuffer?(this.startOffset=e||0,this.loop=t||!1,this.replace=r||!1,this.effectEndedCallBack=n,this.mixEffect(this.audioBuffer,(function(){o.buffSource.loop=!!t,e?o.buffSource.start(0,e/1e3):o.buffSource.start(0),o.startTimes=Date.now(),o.effectEndedListener=o.effectEndedHandler.bind(o),o.buffSource.addEventListener("ended",o.effectEndedListener),i&&i()}))):this.logger.error("amu.pe.1 no audio buffer found"):this.logger.error("amu.pe.1 audio is mixing")},e.prototype.mixingBuffer=function(e,t){var r=this;!0!==this.isMixAudio||0!=this.audioBufferList.length||0!=this.isMixingBuffer?(this.ac.resume(),this.ac.decodeAudioData(e,(function(e){r.audioBufferList.push(e),1==r.audioBufferList.length&&r.playRealTimeEffect(r.audioBufferList[0]),r.isMixingBuffer=!0,t&&t()}),(function(e){r.logger.error("amu.mb.0 "+e),t&&t({code:i.errorCodeList.PUBLISHER_DECODE_AUDIO_FAIL.code,message:i.errorCodeList.PUBLISHER_DECODE_AUDIO_FAIL.message+" "+e})}))):this.logger.error("amu.mb.0 audio is mixing")},e.prototype.stopMingBuffer=function(){return this.isMixingBuffer=!1,this.stopMixingAudio()},e.prototype.playRealTimeEffect=function(e){var t=this;this.mixEffect(e,(function(){t.buffSource&&t.buffSource.start(0),t.buffSource&&t.buffSource.addEventListener("ended",(function(){t.audioBufferList.shift(),t.audioBufferList.length>0&&t.isMixAudio&&t.playRealTimeEffect(t.audioBufferList[0])}))}))},e.prototype.pauseEffect=function(){this.audioBufferList.length>0?this.logger.error("amu.pe.0 real time buffer can not be paused"):(this.stopMixingAudio(),this.resumeOffset=(this.pauseTimes-this.startTimes+this.startOffset)%(1e3*this.audioBuffer.duration),this.paused=!0)},e.prototype.resumeEffect=function(){this.audioBufferList.length>0?this.logger.error("amu.pe.0 real time buffer can not be resume"):(this.playEffect(this.resumeOffset,this.loop,this.replace,void 0,this.effectEndedCallBack),this.startOffset=this.resumeOffset,this.paused=!1)},e.prototype.mixEffect=function(e,t){this.localStream?(this.ac.resume(),this.gainNode=this.ac.createGain(),this.buffSource=this.ac.createBufferSource(),this.buffSource.buffer=e,this.buffSource.connect(this.gainNode),this.gainNode.connect(this.ac.destination),this.replaceTrack()&&t()):this.logger.error("amu.me.0 localStream can not be found")},e.prototype.startMixingAudio=function(e,t){if(this.replace=t||!1,this.isMixAudio)return this.logger.error("amu.sma.0 audio is mixing"),!1;if(!this.localStream)return this.logger.error("amu.sma.0 localStream can not be found"),!1;if(e.captureStream=e.captureStream||e.mozCaptureStream||e.webkitCaptureStream,this.ac.resume(),this.gainNode=this.ac.createGain(),"safari"===this.stateCenter.browser){var r=this.mediaEleSources.find((function(t){return t.audio===e}));if(r)this.mixAudio=r.node;else{var i=this.ac.createMediaElementSource(e);this.mixAudio=i,this.mediaEleSources.push({audio:e,node:i})}e.currentTime=e.currentTime,this.audioCurrentTimer=setInterval((function(){e.currentTime=e.currentTime+.45}),6e3)}else this.mixAudio=this.ac.createMediaStreamSource(e.captureStream());return this.mixAudio.connect(this.gainNode),this.replaceTrack()},e.prototype.replaceTrack=function(){this.streamSource=this.ac.createMediaStreamSource(this.localStream),this.destination=this.ac.createMediaStreamDestination(),!this.replace&&this.streamSource.connect(this.destination),this.gainNode.connect(this.destination);var e=this.destination.stream.getAudioTracks()[0],t=this.peerConnection.getSenders().find((function(t){return t.track.kind===e.kind}));return t?(this.micTrack=this.localStream.getAudioTracks()[0],t.replaceTrack(e),this.localStream.removeTrack(this.micTrack),this.localStream.addTrack(e),this.isMixAudio=!0,!0):(this.logger.error("amu.rt.0 no sender"),!1)},e.prototype.stopMixingAudio=function(){var e=this;return this.paused?(this.logger.info("amu.sma.1 audioEffect paused"),!0):this.isMixAudio?this.localStream?(this.peerConnection.getSenders().find((function(t){return t.track.kind===e.micTrack.kind})),this.mixAudio?(this.mixAudio.disconnect(this.gainNode),this.mixAudio=null,this.audioCurrentTimer&&(clearInterval(this.audioCurrentTimer),this.audioCurrentTimer=null)):this.buffSource&&(this.buffSource.removeEventListener("ended",this.effectEndedListener),this.buffSource.stop(),this.pauseTimes=Date.now(),this.buffSource.disconnect(this.gainNode),this.buffSource=null),this.gainNode.disconnect(this.destination),this.isMixAudio=!1,this.audioBufferList=[],!0):(this.logger.error("amu.sma.1 localStream can not be found"),!1):(this.logger.warn("amu.sma.1 no mixing audio found"),!0)},e.prototype.setMixingAudioVolume=function(e){return this.gainNode?(this.gainNode.gain.value=e,!0):(this.logger.error("amu.sma.2 no mixing audio found"),!1)},e.prototype.effectEndedHandler=function(){this.stopMixingAudio(),this.effectEndedCallBack&&this.effectEndedCallBack()},e}();t.AudioMix=n},6459:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AudioMixModule=void 0;var i=r(2523),n=r(4234),o=function(){function e(e,t,r,i,n){this.logger=e,this.dataReport=t,this.stateCenter=r,this.streamCenter=i,this.ac=n,this.buffer=null,this.blank=null,"safari"==this.stateCenter.browser&&null==this.blank&&null==this.buffer&&(this.ac.resume(),this.buffer=this.ac.createBuffer(1,1,this.ac.sampleRate),this.blank=this.ac.createBufferSource(),this.blank.buffer=this.buffer,this.blank.connect(this.ac.destination),this.blank.start())}return e.prototype.preloadEffect=function(e,t,r){e&&"string"==typeof e&&t&&"string"==typeof t?this.stateCenter.audioEffectBuffer[e]?this.logger.error(i.ZEGO_WEBRTC_ACTION.PRELOAD_EFFECT+" audio buffer already exists"):(this.logger.info(i.ZEGO_WEBRTC_ACTION.PRELOAD_EFFECT+" start preload effect"),this._preloadEffect(this.ac,e,t,r)):this.logger.error(i.ZEGO_WEBRTC_ACTION.PRELOAD_EFFECT+" params error")},e.prototype.playEffect=function(e,t,r){e.streamID&&"string"==typeof e.streamID&&e.effectID&&"string"==typeof e.effectID?this.stateCenter.audioEffectBuffer[e.effectID]?this._playEffect(e,t,r):this.logger.error(i.ZEGO_WEBRTC_ACTION.PLAY_EFFECT+" audio buffer doesn't exists"):this.logger.error(i.ZEGO_WEBRTC_ACTION.PLAY_EFFECT+" params error")},e.prototype.pauseEffect=function(e,t){return e&&"string"==typeof e?(t&&"string"!=typeof t&&this.logger.error(i.ZEGO_WEBRTC_ACTION.PAUSE_EFFECT+" effect "),this._pauseEffect(e,t)):(this.logger.error(i.ZEGO_WEBRTC_ACTION.PAUSE_EFFECT+" streamID format error"),!1)},e.prototype.resumeEffect=function(e,t){return e&&"string"==typeof e?(t&&"string"!=typeof t&&this.logger.error(i.ZEGO_WEBRTC_ACTION.RESUME_EFFECT+" effect "),this._resumeEffect(e,t)):(this.logger.error(i.ZEGO_WEBRTC_ACTION.RESUME_EFFECT+" streamID format error"),!1)},e.prototype.stopEffect=function(e,t){return e&&"string"==typeof e?(t&&"string"!=typeof t&&this.logger.error(i.ZEGO_WEBRTC_ACTION.STOP_EFFECT+" effect "),this._stopEffect(e,t)):(this.logger.error(i.ZEGO_WEBRTC_ACTION.STOP_EFFECT+" streamID format error"),!1)},e.prototype.unloadEffect=function(e){return e&&"string"==typeof e?(delete this.stateCenter.audioEffectBuffer[e],!0):(this.logger.error(i.ZEGO_WEBRTC_ACTION.UNLOAD_EFFECT+" params error"),!1)},e.prototype.setEffectVolume=function(e,t,r){if(!e||"string"!=typeof e)return this.logger.error(i.ZEGO_WEBRTC_ACTION.SET_EFFECT_VOLUME+" streamID format error"),!1;r&&"string"!=typeof r&&this.logger.error(i.ZEGO_WEBRTC_ACTION.SET_EFFECT_VOLUME+" effect ");var n=this.streamCenter.getPublisher(e);return n?n.setEffectVolume(t/100,r):(this.logger.error(i.ZEGO_WEBRTC_ACTION.SET_EFFECT_VOLUME+" publisher doesn't exist"),!1)},e.prototype.startMixingAudio=function(e,t){return this.logger.info(i.ZEGO_WEBRTC_ACTION.START_MIXING_AUDIO+" call "+e),e&&"string"==typeof e?t?(this.logger.info(i.ZEGO_WEBRTC_ACTION.START_MIXING_AUDIO+" end "+e),Array.isArray(t)&&0!==t.length?this._startMixingAudio(e,t):(this.logger.error(i.ZEGO_WEBRTC_ACTION.START_MIXING_AUDIO+" audio param type error"),!1)):(this.logger.error(i.ZEGO_WEBRTC_ACTION.START_MIXING_AUDIO+" no audio"),!1):(this.logger.error(i.ZEGO_WEBRTC_ACTION.START_MIXING_AUDIO+" stream id type error"),!1)},e.prototype.stopMixingAudio=function(e,t){return e&&"string"==typeof e?Array.isArray(t)&&0!==t.length||void 0===t?this._stopMixingAudio(e,t):(this.logger.error(i.ZEGO_WEBRTC_ACTION.STOP_MIXING_AUDIO+" audio param type error"),!1):(this.logger.error(i.ZEGO_WEBRTC_ACTION.STOP_MIXING_AUDIO+" param streamID format error"),!1)},e.prototype.mixingBuffer=function(e,t,r,n){this.logger.info(i.ZEGO_WEBRTC_ACTION.MIXING_BUFFER+" call streamID: "+e+" sourceID:"+t),e&&"string"==typeof e?t&&"string"==typeof t?(this._mixingBuffer(e,t,r,n),this.logger.info(i.ZEGO_WEBRTC_ACTION.MIXING_BUFFER+" end")):this.logger.error(i.ZEGO_WEBRTC_ACTION.MIXING_BUFFER+" param source id format error"):this.logger.error(i.ZEGO_WEBRTC_ACTION.MIXING_BUFFER+" param streamid format error")},e.prototype.stopMixingBuffer=function(e,t){return this.logger.info(i.ZEGO_WEBRTC_ACTION.STOP_MIXING_BUFFER+" call streamID: "+e+" sourceID:"+t),e&&"string"==typeof e?t&&"string"==typeof t?this._stopMixingBuffer(e,t):(this.logger.error(i.ZEGO_WEBRTC_ACTION.STOP_MIXING_BUFFER+" param source id format error"),!1):(this.logger.error(i.ZEGO_WEBRTC_ACTION.STOP_MIXING_BUFFER+" param streamid format error"),!1)},e.prototype.setMixingAudioVolume=function(e,t,r){return this.logger.info(i.ZEGO_WEBRTC_ACTION.SET_MIXING_AUDIO_VOLUME+" call"),"string"!=typeof e||""==e?(this.logger.error(i.ZEGO_WEBRTC_ACTION.SET_MIXING_AUDIO_VOLUME+" stream ID must be string and not empty"),!1):"number"!=typeof t||t<0||t>100?(this.logger.error(i.ZEGO_WEBRTC_ACTION.SET_MIXING_AUDIO_VOLUME+" volume must be a number between 0 and 100"),!1):r&&r instanceof HTMLMediaElement?this._setMixingAudioVolume(e,t,r):(this.logger.error(i.ZEGO_WEBRTC_ACTION.SET_MIXING_AUDIO_VOLUME+" no audio"),!1)},e.prototype.getSoundLevel=function(e,t,r){this.logger.info("zc.gsl call");var i=this.stateCenter.getReportSeq();this.dataReport.newReport(i,n.ZegoRTCLogEvent.kZegoTaskGetSoundLevel.event);try{this.ac.resume();var o=this.ac.createMediaStreamSource(e),s=this.ac.createScriptProcessor(4096,1,1);this.stateCenter.audioStreamList[e.id]={mic:o,script:s},o.connect(s),s.connect(this.ac.destination),s.onaudioprocess=function(e){for(var r=e.inputBuffer.getChannelData(0),i=0,n=0;n<r.length;n++)i<r[n]&&(i=r[n]);t(i)},this.dataReport.uploadReport(i)}catch(e){r(e),this.dataReport.addMsgInfo(i,n.ZegoRTCLogEvent.kZegoTaskGetSoundLevel.error.kGetSoundLevelError),this.dataReport.uploadReport(i)}this.logger.info("zc.gsl call success")},e.prototype.stopSoundLevel=function(e){this.logger.info("zc.ssl call");var t=this.stateCenter.getReportSeq();this.dataReport.newReport(t,n.ZegoRTCLogEvent.kZegoTaskStopSoundLevel);var r=this.stateCenter.audioStreamList[e.id];r.mic.disconnect(),r.script.disconnect(),delete this.stateCenter.audioStreamList[e.id],this.dataReport.uploadReport(t)},e.prototype._preloadEffect=function(e,t,r,i){var n=this,o=new XMLHttpRequest;o.open("GET",r,!0),o.responseType="arraybuffer",o.onload=function(){if(200==o.status||304==o.status){var r=o.response;e.decodeAudioData(r,(function(e){n.logger.info("zc.pe.0 effect preload success"),n.stateCenter.audioEffectBuffer[t]=e,i&&i()}),(function(e){n.logger.error("zc.pe.0 effect preload fail "+e),i&&i(e)}))}else{var s=o.statusText;n.logger.error("zc.pe.0 effect preload fail "+s),i&&i(s)}},o.send()},e.prototype._playEffect=function(e,t,r){var i=this.stateCenter.audioEffectBuffer[e.effectID],n=this.streamCenter.getPublisher(e.streamID);n?i?n.playEffect(e,i,t,r):this.logger.error("zc.pe.1 no audio buffer found"):this.logger.error("zc.pe.1 publisher doesn't exist")},e.prototype._pauseEffect=function(e,t){var r=this.streamCenter.getPublisher(e);return r?r.pauseEffect(t):(this.logger.error("zc.pe.2 publisher doesn't exist"),!1)},e.prototype._resumeEffect=function(e,t){var r=this.streamCenter.getPublisher(e);return r?r.resumeEffect(t):(this.logger.error("zc.re.0 publisher doesn't exist"),!1)},e.prototype._stopEffect=function(e,t){var r=this.streamCenter.getPublisher(e);return r?r.stopEffect(t):(this.logger.error("zc.re.0 publisher doesn't exist"),!1)},e.prototype._setMixingAudioVolume=function(e,t,r){var i=this.streamCenter.getPublisher(e);return i?i.setMixingAudioVolume(t/100,r):(this.logger.error("zc.sma.2 publisher doesn't exist"),!1)},e.prototype._startMixingAudio=function(e,t){var r=this.streamCenter.getPublisher(e);return r?r.startMixingAudio(t):(this.logger.error("zc.sma.0 publisher doesn't exist"),!1)},e.prototype._stopMixingAudio=function(e,t){var r=this.streamCenter.getPublisher(e);return r?r.stopMixingAudio(t):(this.logger.error("zc.sma.1 publisher doesn't exist"),!1)},e.prototype._mixingBuffer=function(e,t,r,i){var n=this.streamCenter.getPublisher(e);n?r instanceof ArrayBuffer?n.mixingBuffer(t,r,i):this.logger.error("zc.mb.0 array buffer not found"):this.logger.error("zc.mb.0 publisher doesn't exist")},e.prototype._stopMixingBuffer=function(e,t){var r=this.streamCenter.getPublisher(e);return r?r.stopMixingBuffer(t):(this.logger.error("zc.sma.1 publisher doesn't exist"),!1)},e}();t.AudioMixModule=o},6214:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.publisher=void 0;var i=r(2523),n=r(4194);t.publisher={playEffect:function(e,t,r,o){if(this.logger.info(i.ZEGO_WEBRTC_ACTION.PUBLISHER_PLAY_EFFECT+""+this.streamId+" call"),this.effectList.find((function(r){return r.effectID==e.effectID&&r.audioBuffer==t})))this.logger.warn(i.ZEGO_WEBRTC_ACTION.PUBLISHER_PLAY_EFFECT+""+this.streamId+" effect alreadly exist ");else{this.streamCenter.soundLevelDelegate&&this.stopSoundLevel();var s=new n.AudioMix(this.logger,this.stateCenter,this.ac,this.mediaEleSources);s.localStream=this.localStream,s.peerConnection=this.peerConnection,s.audioBuffer=t,this.effectList.push({audioMix:s,effectID:e.effectID,audioBuffer:t}),s.playEffect(e.playTime,e.loop,!1,r,o),this.streamCenter.soundLevelDelegate&&this.startSoundLevel(),this.logger.info(i.ZEGO_WEBRTC_ACTION.PUBLISHER_PLAY_EFFECT+""+this.streamId+" play effect "+e.effectID+" success")}},pauseEffect:function(e){var t=this.effectList.find((function(t){return t.effectID==e}));if(t)this.streamCenter.soundLevelDelegate&&this.stopSoundLevel(),t.audioMix.pauseEffect(),this.streamCenter.soundLevelDelegate&&this.startSoundLevel(),this.logger.info(i.ZEGO_WEBRTC_ACTION.PUBLISHER_PAUSE_EFFECT+" "+this.streamId+" pause "+e+" success");else{if(void 0!==e)return this.logger.error(i.ZEGO_WEBRTC_ACTION.PUBLISHER_PAUSE_EFFECT+" "+this.streamId+" no effect ID found"),!1;this.streamCenter.soundLevelDelegate&&this.stopSoundLevel(),this.effectList.forEach((function(e){return e.audioMix.pauseEffect()})),this.streamCenter.soundLevelDelegate&&this.startSoundLevel()}return!0},resumeEffect:function(e){var t=this.effectList.find((function(t){return t.effectID==e}));if(t)this.streamCenter.soundLevelDelegate&&this.stopSoundLevel(),t.audioMix.resumeEffect(),this.streamCenter.soundLevelDelegate&&this.startSoundLevel(),this.logger.info(i.ZEGO_WEBRTC_ACTION.PUBLISHER_RESUME_EFFECT+" "+this.streamId+" resume"+e+" success");else{if(void 0!==e)return this.logger.error(i.ZEGO_WEBRTC_ACTION.PUBLISHER_RESUME_EFFECT+" "+this.streamId+" no effect ID found"),!1;this.streamCenter.soundLevelDelegate&&this.stopSoundLevel(),this.effectList.forEach((function(e){return e.audioMix.resumeEffect()})),this.streamCenter.soundLevelDelegate&&this.startSoundLevel()}return!1},stopEffect:function(e){var t=this.effectList.find((function(t){return t.effectID==e}));if(t)this.streamCenter.soundLevelDelegate&&this.stopSoundLevel(),t.audioMix.stopMixingAudio(),this.effectList.splice(this.effectList.indexOf(t),1),this.streamCenter.soundLevelDelegate&&this.startSoundLevel(),this.logger.info(i.ZEGO_WEBRTC_ACTION.PUBLISHER_STOP_EFFECT+" "+this.streamId+" pause "+e+" success");else{if(void 0!==e)return this.logger.error(i.ZEGO_WEBRTC_ACTION.PUBLISHER_STOP_EFFECT+" "+this.streamId+" no effect ID found"),!1;this.streamCenter.soundLevelDelegate&&this.stopSoundLevel(),this.effectList.forEach((function(e){return e.audioMix.stopMixingAudio()})),this.effectList=[],this.streamCenter.soundLevelDelegate&&this.startSoundLevel()}return!0},setEffectVolume:function(e,t){var r=this.effectList.find((function(e){return e.effectID==t}));if(r)r.audioMix.setMixingAudioVolume(e),this.logger.info("zp.sev.0 "+this.streamId+" set volume "+t+" success");else{if(void 0!==t)return this.logger.error("zp.sev.0 "+this.streamId+" no effect ID found"),!1;this.effectList.forEach((function(t){return t.audioMix.setMixingAudioVolume(e)}))}return!0},startMixingAudio:function(e){var t=this;return this.logger.info(i.ZEGO_WEBRTC_ACTION.PUBLISHER_START_MIXING_AUDIO+" "+this.streamId+" call"),this.localStream?(this.micTrack||(this.micTrack=this.localStream.getAudioTracks().length>0?this.localStream.getAudioTracks()[0]:null),e.forEach((function(e){if(t.audioMixList.find((function(t){return t.media==e})))t.logger.info(i.ZEGO_WEBRTC_ACTION.PUBLISHER_START_MIXING_AUDIO+" "+t.streamId+" mix audio already exist");else{t.streamCenter.soundLevelDelegate&&t.stopSoundLevel();var r=new n.AudioMix(t.logger,t.stateCenter,t.ac,t.mediaEleSources);r.localStream=t.localStream,r.peerConnection=t.peerConnection,t.audioMixList.push({audioMix:r,media:e}),r.startMixingAudio(e),t.streamCenter.soundLevelDelegate&&t.startSoundLevel()}})),!0):(this.logger.error(i.ZEGO_WEBRTC_ACTION.PUBLISHER_START_MIXING_AUDIO+" localStream not found"),!1)},stopMixingAudio:function(e){var t=this;return this.logger.info(i.ZEGO_WEBRTC_ACTION.PUBLISHER_STOP_MIXING_AUDIO+" "+this.streamId+" call"),e?e.forEach((function(e){for(var r=0;r<t.audioMixList.length;r++)if(t.audioMixList[r].media==e){t.audioMixList[r].audioMix.stopMixingAudio()&&t.audioMixList.splice(r--,1);break}})):(this.audioMixList.forEach((function(e){return e.audioMix.stopMixingAudio()})),this.audioMixList=[]),!0},mixingBuffer:function(e,t,r){var o=this;if(this.logger.info(i.ZEGO_WEBRTC_ACTION.PUBLISHER_MIXING_BUFFER+" "+this.streamId+" call"),this.micTrack||(this.micTrack=this.localStream.getAudioTracks().length>0?this.localStream.getAudioTracks()[0]:null),this.arrayBufferMap[e])this.streamCenter.soundLevelDelegate&&this.stopSoundLevel(),this.arrayBufferMap[e].mixingBuffer(t,(function(){o.streamCenter.soundLevelDelegate&&o.startSoundLevel(),r&&r()}));else{this.streamCenter.soundLevelDelegate&&this.stopSoundLevel();var s=new n.AudioMix(this.logger,this.stateCenter,this.ac,this.mediaEleSources);s.localStream=this.localStream,s.peerConnection=this.peerConnection,this.arrayBufferMap[e]=s,s.mixingBuffer(t,(function(){o.streamCenter.soundLevelDelegate&&o.startSoundLevel(),r&&r()}))}},stopMixingBuffer:function(e){if(e&&this.arrayBufferMap[e])return this.streamCenter.soundLevelDelegate&&this.stopSoundLevel(),this.arrayBufferMap[e].stopMingBuffer(),delete this.arrayBufferMap[e],this.streamCenter.soundLevelDelegate&&this.startSoundLevel(),!0;if(void 0===e){for(var t in this.streamCenter.soundLevelDelegate&&this.stopSoundLevel(),this.arrayBufferMap)this.arrayBufferMap[t].stopMingBuffer();return this.streamCenter.soundLevelDelegate&&this.startSoundLevel(),!0}return this.logger.warn(i.ZEGO_WEBRTC_ACTION.PUBLISHER_MIXING_BUFFER+" "+this.streamId+" arrayBuffer no found"),!1},setMixingAudioVolume:function(e,t){this.logger.info(i.ZEGO_WEBRTC_ACTION.PUBLISHER_SET_MIXING_AUDIO_VOLUME+" "+this.streamId+" call");var r=this.audioMixList.find((function(e){return e.media===t}));return r?(r.audioMix.setMixingAudioVolume(e),this.logger.info(i.ZEGO_WEBRTC_ACTION.PUBLISHER_SET_MIXING_AUDIO_VOLUME+" "+this.streamId+" call success"),!0):(this.logger.error(i.ZEGO_WEBRTC_ACTION.PUBLISHER_SET_MIXING_AUDIO_VOLUME+" "+this.streamId+" audio is not mixing"),!1)}}},4853:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCodeList=void 0,t.errorCodeList={GET_SOUND_LEVEL_FAIL:{code:1000019,message:"get sound level error"},PUBLISHER_DECODE_AUDIO_FAIL:{code:1103057,message:"decode audio data fail"}}},7526:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(6459),n=r(6214);t.default={type:"AudioMix",install:function(e,t){for(var r in Object.defineProperty(e.prototype,"initAudioMix",{value:function(){this.audioMixModule=new i.AudioMixModule(this.logger,this.dataReport,this.stateCenter,this.streamCenter,this.ac)}}),n.publisher)Object.defineProperty(t.prototype,r,{value:n.publisher[r],writable:!1})}}},4234:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoRTCLogEvent=void 0;var i=r(4853);t.ZegoRTCLogEvent={kZegoTaskGetSoundLevel:{event:"/sdk/get_sound_level",error:{kGetSoundLevelError:i.errorCodeList.GET_SOUND_LEVEL_FAIL}},kZegoTaskStopSoundLevel:"/sdk/stop_sound_level"}},4897:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataChannel=void 0;var i=r(8835);t.DataChannel={type:"DataChannel",install:function(e){Object.defineProperty(e.prototype,"createRealTimeSequentialDataManager",{value:function(e){this.enableDataChannel(!0);var t=this.stateCenter.getRoomByRoomID(e);return t?t.dataChannelManager?null:(t.dataChannelManager=new i.ZegoRealTimeSequentialDataManager(this,e),t.dataChannelManager):(this.logger.error("zc.crsdm room no exist"),null)},writable:!1}),Object.defineProperty(e.prototype,"destroyRealTimeSequentialDataManager",{value:function(e){var t=this.stateCenter.roomList.find((function(t){return t.dataChannelManager==e}));t&&(e.dataChannelManager.reset(),t.dataChannelManager=null)},writable:!1})}}},3504:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.DataChannelListener=void 0;var n=function(){function e(e,t){this.zegoWebRTC=e,this.roomID=t,this.pubDataChannelList=[],this.subDataChannelList=[],this.listenerList={receiveRealTimeSequentialData:[]},this.logger=e.logger}return e.prototype.startBroadcasting=function(e,t){return r(this,void 0,void 0,(function(){var t,r,n,o;return i(this,(function(i){switch(i.label){case 0:return this.logger.info("dc.sb.0 call"),this.pubDataChannelList.includes(e)?(this.logger.error("dc.sb.0 datachannel already exist"),[2,!1]):(t=this.zegoWebRTC.streamCenter.publisherList[e])&&t.publisher.dataChannel?(this.pubDataChannelList.push(e),[2,!0]):t&&!t.publisher.dataChannel?(this.logger.error("dc.sb.0 publish datachannel no exist, try other stream ID"),[2,!1]):this.broadcastStream?[3,2]:(r=document.createElement("canvas"),n=this,[4,this.zegoWebRTC.createStream({custom:{source:r}})]);case 1:n.broadcastStream=i.sent(),i.label=2;case 2:return(o=this.zegoWebRTC.startPublishingStream(e,this.broadcastStream,{roomID:this.roomID},!0))&&this.pubDataChannelList.push(e),this.logger.info("dc.sb.0 end"),[2,o]}}))}))},e.prototype.stopBroadcasting=function(e){this.logger.info("dc.sb.1 call"),this.pubDataChannelList=this.pubDataChannelList.filter((function(t){return t!==e}));var t=this.zegoWebRTC.streamCenter.publisherList[e];return t?(t.room.roomID==this.roomID&&t.isDataChannel&&this.zegoWebRTC.stopPublishingStream(e),this.logger.info("dc.sb.1 end"),!0):(this.logger.error("dc.sb.1 datachannel no found"),!1)},e.prototype.sendRealTimeSequentialData=function(e,t){if(!t instanceof ArrayBuffer)return this.logger.error("dc.srsd data type wrong"),!1;var r=this.zegoWebRTC.streamCenter.publisherList[e];return r&&this.pubDataChannelList.includes(e)?this.sendBCMessage(r.publisher,t):(this.logger.error("dc.srsd datachannel no found"),!1)},e.prototype.sendBCMessage=function(e,t){var r;if(!e.dataChannelState)return!1;for(var i=new Uint8Array(t),n=0,o=t.byteLength,s=e.send_seq,a=0,c=(new Date).getTime(),l=0;o>0;){o>1151?l=1141:(l=o,a=1);var u=new Uint8Array(l+10);u[0]=1,u[1]=a,u[2]=e.send_seq>>8&255,u[3]=255&e.send_seq,u[4]=s>>8&255,u[5]=255&s,u[6]=c>>24&255,u[7]=c>>16&255,u[8]=c>>8&255,u[9]=255&c;for(var d=0;d<l;d++)u[d+10]=i[d+n];o-=l,n+=l,e.send_seq++,e.send_seq>=65536&&(e.send_seq=0),null===(r=e.dataChannel)||void 0===r||r.send(u)}return!0},e.prototype.startSubscribing=function(e,t){var n,o;return r(this,void 0,void 0,(function(){var t,r;return i(this,(function(i){switch(i.label){case 0:return this.logger.info("dc.ss.0 call"),this.subDataChannelList.includes(e)?(this.logger.error("dc.ss.0 datachannel already exist"),[2,!1]):(t=this.zegoWebRTC.streamCenter.playerList[e])?[3,2]:[4,this.zegoWebRTC.startPlayingStream(e,void 0,!0)];case 1:i.sent(),t=this.zegoWebRTC.streamCenter.playerList[e],i.label=2;case 2:return(r=t.player).dataChannel?(!(null===(n=r.onDataChannelList)||void 0===n?void 0:n.includes(this.onReceivedDataChannel.bind(this)))&&(null===(o=r.onDataChannelList)||void 0===o||o.push(this.onReceivedDataChannel.bind(this))),this.subDataChannelList.push(e),this.logger.info("dc.ss.0 end"),[2,!0]):(this.logger.error("dc.ss.0 datachannel no exist, try other stream ID"),[2,!1])}}))}))},e.prototype.stopSubscribing=function(e){this.logger.info("dc.ss.1 call"),this.subDataChannelList=this.subDataChannelList.filter((function(t){return t!==e}));var t=this.zegoWebRTC.streamCenter.playerList[e];return t?(t.room.roomID==this.roomID&&t.isDataChannel&&this.zegoWebRTC.stopPlayingStream(e),this.logger.info("dc.ss.1 end"),!0):(this.logger.error("dc.ss.1 datachannel no subscribe"),!1)},e.prototype.on=function(e,t){this.bindListener(e,t)},e.prototype.off=function(e,t){this.deleteListener(e,t)},e.prototype.bindListener=function(e,t){return this.listenerList[e]?"function"!=typeof t?(this.logger.error("zc.o.0 listener callBack must be funciton"),!1):(-1==this.listenerList[e].indexOf(t)&&this.listenerList[e].push(t),!0):(this.logger.error("dc.o.0 event "+e+" no found"),!1)},e.prototype.deleteListener=function(e,t){if(!this.listenerList[e])return this.logger.error("dc.o.1 listener no found"),!1;var r=this.listenerList[e];return t?r.splice(r.indexOf(t),1):this.listenerList[e]=[],!0},e.prototype.actionListener=function(e){for(var t=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];this.listenerList[e]&&this.listenerList[e].forEach((function(i){try{setTimeout((function(){i.apply(void 0,r)}),0)}catch(r){t.logger.error("dc.al "+e+" "+r)}}))},e.prototype.onReceivedDataChannel=function(e,t,r){this.actionListener("receiveRealTimeSequentialData",e,t,r)},e.prototype.reset=function(){var e=this;for(var t in this.logger.info("dc.rs call"),this.pubDataChannelList.forEach((function(t){var r=e.zegoWebRTC.streamCenter.publisherList[t];r&&r.room.roomID==e.roomID&&r.isDataChannel&&e.zegoWebRTC.stopPublishingStream(t)})),this.subDataChannelList.forEach((function(t){var r=e.zegoWebRTC.streamCenter.playerList[t];r&&r.room.roomID==e.roomID&&r.isDataChannel&&e.zegoWebRTC.stopPlayingStream(t)})),this.listenerList)this.listenerList[t]=[];this.broadcastStream&&this.zegoWebRTC.destroyStream(this.broadcastStream),this.broadcastStream=void 0,this.logger.info("dc.rs end")},e}();t.DataChannelListener=n},5906:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.streamHandler=t.zegoWebRTC=void 0;var i=r(817),n=r(6145),o="2.13.0",s=1e4,a={},c="addMsgInfo";function l(e){var t,r,n,o,a="",c=i.errorCodeList;return e.errorCode<2e9&&e.errorCode>1e9?(n={1:"MIXER_START_REQUEST_ERROR",2:"MIXER_START_REQUEST_ERROR",3:"MIXER_AUTHENTICATION_FAILED",150:"MIXER_INPUT_STREAM_NOT_EXISTS",151:"MIXER_START_REQUEST_ERROR",152:"MIXER_STOP_REQUEST_ERROR",153:"MIXER_INPUT_PARAMETERS_ERROR",154:"MIXER_EXCEED_MAX_OUTPUT_COUNT",155:"MIXER_INPUT_PARAMETERS_ERROR",156:"MIXER_VIDEO_CONFIG_INVALID",157:"MIXER_NO_SERVICES",158:"MIXER_EXCEED_MAX_INPUT_COUNT",159:"MIXER_START_REQUEST_ERROR",160:"MIXER_NOT_OWNER_STOPMIXER",170:"MIXER_WATERMARK_PARAMETERS_ERROR",171:"MIXER_WATERMARK_NULL",175:"MIXER_REPEAT_INPUT",190:"MIXER_START_REQUEST_ERROR"},o="MIXER_INNER_ERROR",(r=e.errorCode-s)>1e9&&n[r-1e9]&&(o=n[r-1e9]),t=c[a=o]):e.errorCode<1e6&&(t=this.stateCenter.decodeServerError(e.errorCode,e.extendedData),a=this.stateCenter.getLiveRoomError(e.errorCode)),{reportErr:t,actualError:c[a]}}t.zegoWebRTC={startMixerTask:function(e){var t=this;return new Promise((function(r,i){var o=t.stateCenter.getReportSeq();t.dataReport.newReport(o,n.ZegoRTCLogEvent.kZegoTaskMixStart.event),t.stateCenter.logReportCallback("kZegoTaskMixStart"+e.taskID,t.dataReport,o,t.stateCenter.reportList);var s={errorCode:1005027,extendedData:"mix stream input parameters are wrong"};if(null==e?void 0:e.inputList.find((function(e){return(void 0===e.streamID||null===e.streamID)&&(s.extendedData=s.extendedData+". streamID should be of string type",!0)})))return t.dataReport.addMsgInfo(o,s),t.dataReport.uploadReport(o),t.stateCenter.unregisterCallback("kZegoTaskMixStart"+e.taskID,t.stateCenter.reportList),void i(s);e.outputConfig&&e.outputConfig.outputFps&&(e.outputConfig.outputFPS=e.outputConfig.outputFps);var a=function(r){var n=l(r),s=n.reportErr,a=n.actualError;s?t.dataReport.addMsgInfo(o,s):t.dataReport.addMsgInfo(o,r),t.dataReport.uploadReport(o),t.stateCenter.unregisterCallback("kZegoTaskMixStart"+e.taskID,t.stateCenter.reportList),a&&(r.errorCode=null==a?void 0:a.code,r.extendedData=(null==a?void 0:a.message)||""),i(r)},c=t.stateCenter.roomList[0];c?c.streamHandler.updateMixStream(e,(function(i){t.dataReport.uploadReport(o),t.stateCenter.unregisterCallback("kZegoTaskMixStart"+e.taskID,t.stateCenter.reportList),r(i)}),a):a({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kNoLoginError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kNoLoginError.message})}))},setMixerTaskConfig:function(e){var t=this;return new Promise((function(r,i){var o=t.stateCenter.getReportSeq();t.dataReport.newReport(o,n.ZegoRTCLogEvent.kZegoTaskMixConfig.event),t.stateCenter.logReportCallback("kZegoTaskMixConfig",t.dataReport,o,t.stateCenter.reportList);var s=t.stateCenter.roomList[0];s?s.streamHandler.setMixerTaskConfig(e).then((function(e){t.dataReport.uploadReport(o),t.stateCenter.unregisterCallback("kZegoTaskMixConfig",t.stateCenter.reportList),r(e)})).catch((function(e){t.dataReport.addMsgInfo(o,e),t.dataReport.uploadReport(o),t.stateCenter.unregisterCallback("kZegoTaskMixConfig",t.stateCenter.reportList),i(e)})):i({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kNoLoginError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kNoLoginError.message})}))},stopMixerTask:function(e){var t=this;return new Promise((function(r,i){var o=t.stateCenter.getReportSeq();if(t.dataReport.newReport(o,n.ZegoRTCLogEvent.kZegoTaskMixStop.event),!e||"string"!=typeof e||e.length>256||!t.stateCenter.checkIllegalCharacters(e))return t.logger.error("zb.rh.lg taskID must be string less 256"),t.dataReport.addMsgInfo(o,{error:n.ZegoRTCLogEvent.kZegoTaskMixStop.error.kParamError.code,message:n.ZegoRTCLogEvent.kZegoTaskMixStop.error.kParamError.message+" param taskID error"}),t.dataReport.uploadReport(o),void i({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStop.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStop.error.kParamError.message+" param taskID error"});var s=function(e){var r=l(e),n=r.reportErr,s=r.actualError;n?t.dataReport.addMsgInfo(o,n):t.dataReport.addMsgInfo(o,e),t.dataReport.uploadReport(o),s&&(e.errorCode=null==s?void 0:s.code,e.extendedData=(null==s?void 0:s.message)||""),i(e)},a=t.stateCenter.roomList[0];a?a.streamHandler.stopMixStream(e,(function(e){t.dataReport.uploadReport(o),r(e)}),s):s({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStop.error.kNoLoginError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStop.error.kNoLoginError.message})}))}},t.streamHandler={setMixerTaskConfig:function(e){var t=this;return new Promise((function(r,i){var o,s={},l={};if(e&&e.videoCodec){var u=e.videoCodec.toLowerCase();if(-1==["vp8","h264"].indexOf(u))return t.logger.error("zb.sh.ums param videoCode error"),i({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kVideoConfigInvalidError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kVideoConfigInvalidError.message}),!1;s.videoCodec=u,l.video_codec=u}if(e.backgroundColor){if(!t.stateCenter.checkInteger(e.backgroundColor))return t.logger.error("zb.sh.ums param backgroundColor must be integer number"),i({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kParamError.message}),!1;s.backgroundColor=e.backgroundColor,l.background_color=e.backgroundColor}if(e.backgroundImage){if("string"!=typeof e.backgroundImage)return t.logger.error("zb.sh.ums param outputBgImage error"),i({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kParamError.message}),!1;if(!e.backgroundImage.startsWith("preset-id://")||!e.backgroundImage.endsWith(".jpg")&&!e.backgroundImage.endsWith(".png"))return t.logger.error("zb.sh.ums illegal input background image URL"),i({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kBackgroundImageUrlInvalidError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kBackgroundImageUrlInvalidError.message}),!1;s.backgroundImage=e.backgroundImage,l.background_image=e.backgroundImage}e.waterMark&&(s.waterMark=e.waterMark,l.water_mark=e.waterMark),e.extraParams&&(s.extraParams||(s.extraParams=[]),(o=s.extraParams).push.apply(o,e.extraParams)),s=a,t.stateCenter.actionSuccessCallback("kZegoTaskMixConfig",t.stateCenter.reportList)&&t.stateCenter.actionSuccessCallback("kZegoTaskMixConfig",t.stateCenter.reportList)(c,void 0,{config:n.ZegoRTCLogEvent.kZegoTaskMixConfig.config(l)}),r({errorCode:0,extendedData:""})}))},stopMixStream:function(e,t,r,a,c){var l=this;this.logger.info("zb.sh.sms call");var u={id_name:this.stateCenter.idName,live_channel:this.roomID,appid:this.stateCenter.appid,version:o};"string"==typeof e&&(u.task_id=e),null!=a?this.stateCenter.testEnvironment?u.stream_id="zegotest-"+this.stateCenter.appid+"-"+a:u.stream_id=a:null!=c&&(u.mixurl=c);var d={channel:"zeus",cmd:"stop_mix",req_body:JSON.stringify(u)};return this.sendBizChannelRequest(d,(function(){t&&t({errorCode:0})}),(function(e){var t;"number"==typeof e?r&&r({errorCode:l.stateCenter.getServerError(s+e).code,extendedData:""}):(l.logger.error("zb.sh.sms stop mix fail "+JSON.stringify(e)),t=e==i.errorCodeList.TIMEOUT?n.ZegoRTCLogEvent.kZegoTaskMixStop.error.kRequestError:n.ZegoRTCLogEvent.kZegoTaskMixStop.error.kInternalError,r&&r({errorCode:t.code,extendedData:t.message}))})),!0},updateMixStream:function(e,t,r){var l,u=this;if(this.logger.info("zb.sh.ums call"),!e.noTaskID&&!e.taskID)return this.logger.error("zb.sh.ums no taskId found"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kTaskIDNullError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kTaskIDNullError.message}),!1;if(!e.noTaskID&&"string"!=typeof e.taskID)return this.logger.error("zb.rh.lg taskId must be string"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message}),!1;if(!e.noTaskID&&e.taskID.length>256)return this.logger.error("zb.sh.ums taskId is too long"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kTaskIDToLongError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kTaskIDToLongError.message}),!1;if(!e.noTaskID&&!this.stateCenter.checkIllegalCharacters(e.taskID))return this.logger.error("zb.sh.ums task ID contains illegal characters"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kTaskIDInvalidCharacterError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kTaskIDInvalidCharacterError.message}),!1;if(!e.inputList||0==e.inputList.length)return this.logger.error("zb.sh.ums input list wrong"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kInputListNullError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kInputListNullError.message}),!1;e.inputList.forEach((function(e){"AUDIO"===e.contentType&&(!e.layout&&(e.layout={top:0,left:0,bottom:0,right:0}),e.layout.top=0,e.layout.left=0,e.layout.bottom=1,e.layout.right=1)}));for(var d=e.inputList.every((function(e){return"AUDIO"===e.contentType})),h=0;h<e.inputList.length;h++){var p=e.inputList[h],f={errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message};if("object"!=typeof p.layout)return this.logger.error("zb.sh.ums input layout must be object"),r(f),!1;if(!(this.stateCenter.checkInteger(p.layout.top,!1)&&this.stateCenter.checkInteger(p.layout.bottom,!1)&&this.stateCenter.checkInteger(p.layout.left,!1)&&this.stateCenter.checkInteger(p.layout.right,!1)))return this.logger.error("zb.sh.ums top、left、bottom、right must be integer number"),r(f),!1;if(void 0!==p.renderMode&&![0,1].includes(p.renderMode))return this.logger.error("zb.sh.ums render_mode is wrong"),r(f),!1}if(!e.outputList||0==e.outputList.length)return this.logger.error("zb.sh.ums no output list found"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kOutputListNullError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kOutputListNullError.message}),!1;if(e.outputList.some((function(e){return"string"==typeof e&&!u.stateCenter.isUrl(e)&&!u.stateCenter.checkIllegalCharacters(e)||"object"==typeof e&&e.target&&!u.stateCenter.isUrl(e.target)&&!u.stateCenter.checkIllegalCharacters(e.target)})))return this.logger.error("zb.sh.ums stream output target is incorrect"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kOutputTargetInvalidError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kOutputTargetInvalidError.message}),!1;if(!(d||e.outputConfig&&"object"==typeof e.outputConfig))return this.logger.error("zb.sh.ums no output config found"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kOutputNoTargetError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kOutputNoTargetError.message}),!1;if(d&&(void 0===e.outputConfig&&(e.outputConfig={outputBitrate:0,outputFPS:0,outputWidth:0,outputHeight:0}),e.outputConfig.outputBitrate=.001,e.outputConfig.outputFPS=1,e.outputConfig.outputWidth=1,e.outputConfig.outputHeight=1),!(d||e.outputConfig.outputBitrate&&this.stateCenter.checkInteger(e.outputConfig.outputBitrate)))return this.logger.error("zb.sh.ums bitrate param is required and must be integer number"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message}),!1;if(!e.outputConfig.outputFPS||!this.stateCenter.checkInteger(e.outputConfig.outputFPS))return this.logger.error("zb.sh.ums fps param is required and must be integer number"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message}),!1;if(!e.outputConfig.outputWidth||!this.stateCenter.checkInteger(e.outputConfig.outputWidth))return this.logger.error("zb.sh.ums width param is required and must be integer number"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message}),!1;if(!e.outputConfig.outputHeight||!this.stateCenter.checkInteger(e.outputConfig.outputHeight))return this.logger.error("zb.sh.ums height param is required and must be integer number"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message}),!1;if(void 0!==e.outputConfig.outputAudioCodecID&&!this.stateCenter.checkInteger(e.outputConfig.outputAudioCodecID,!1))return this.logger.error("zb.sh.ums AudioCodecID param must be integer number"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message}),!1;if(void 0!==e.outputConfig.outputAudioBitrate&&!this.stateCenter.checkInteger(e.outputConfig.outputAudioBitrate))return this.logger.error("zb.sh.ums AudioBitrate param must be integer number"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message}),!1;if(void 0!==e.outputConfig.outputAudioChannels&&!this.stateCenter.checkInteger(e.outputConfig.outputAudioChannels,!1))return this.logger.error("zb.sh.ums AudioChannels param must be integer number"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message}),!1;var g=0;e.outputConfig.singleStreamPassThrough&&"boolean"==typeof e.outputConfig.singleStreamPassThrough&&(g=e.outputConfig.singleStreamPassThrough?1:0);var m={task_id:e.taskID,id_name:this.stateCenter.idName,live_channel:this.roomID,appid:this.stateCenter.appid,version:o,bypass:g},_=a;_&&(_.videoCodec&&(m.extra_params=[{key:"video_encode",value:_.videoCodec}]),_.backgroundColor&&(m.output_bg_color=_.backgroundColor),_.backgroundImage&&(m.output_bg_image=_.backgroundImage),_.waterMark&&(m.watermark=_.waterMark),_.extraParams&&(!m.extra_params&&(m.extra_params=[]),(l=m.extra_params).push.apply(l,_.extraParams)));var v=[];for(h=0;h<e.inputList.length;h++){var E=e.inputList[h],A=E.streamID;this.stateCenter.testEnvironment&&(A="zegotest-"+this.stateCenter.appid+"-"+E.streamID),v.push({stream_id:A,content_control:"AUDIO"===E.contentType?1:0,rect:{layer:h,top:E.layout.top,left:E.layout.left,bottom:E.layout.bottom,right:E.layout.right},render_mode:E.renderMode})}m.MixInput=v,this.stateCenter.actionSuccessCallback("kZegoTaskMixStart"+e.taskID,this.stateCenter.reportList)&&this.stateCenter.actionSuccessCallback("kZegoTaskMixStart"+e.taskID,this.stateCenter.reportList)(c,void 0,{mix_stream_id:n.ZegoRTCLogEvent.kZegoTaskMixStart.mix_stream_id(e.taskID),stream_cnt:n.ZegoRTCLogEvent.kZegoTaskMixStart.stream_cnt(v.length),input_stream_list:n.ZegoRTCLogEvent.kZegoTaskMixStart.input_stream_list(v)});var y=[];e.outputList.forEach((function(t){var i={},o="";if("string"==typeof t)o=t;else{if("object"!=typeof t||!t.target)return u.logger.error("zb.sh.ums output target required"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kOutputTargetInvalidError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kOutputTargetInvalidError.message}),!1;o=t.target}o.startsWith("rtmp://")||o.startsWith("https://")&&o.endsWith(".flv")||o.startsWith("https://")&&o.endsWith(".m3u8")?i.mixurl=o:u.stateCenter.testEnvironment?i.stream_id="zegotest-"+u.stateCenter.appid+"-"+o:i.stream_id=o,i.bitrate=1e3*e.outputConfig.outputBitrate,i.fps=e.outputConfig.outputFPS,i.width=e.outputConfig.outputWidth,i.height=e.outputConfig.outputHeight,e.outputConfig.outputAudioCodecID&&(i.audio_enc_id=e.outputConfig.outputAudioCodecID),"vp8"===_.videoCodec?i.audio_enc_id=3:"h264"===_.videoCodec&&(i.audio_enc_id=0),e.outputConfig.outputAudioBitrate&&(i.audio_bitrate=1e3*e.outputConfig.outputAudioBitrate),e.outputConfig.outputAudioChannels&&(i.audio_channel_cnt=e.outputConfig.outputAudioChannels),u.stateCenter.testEnvironment?i.testenv=1:i.testenv=0,y.push(i)})),m.MixOutput=y,this.stateCenter.actionSuccessCallback("kZegoTaskMixStart"+e.taskID,this.stateCenter.reportList)&&this.stateCenter.actionSuccessCallback("kZegoTaskMixStart"+e.taskID,this.stateCenter.reportList)(c,void 0,{output_target_list:n.ZegoRTCLogEvent.kZegoTaskMixStart.output_target_list(y)});var S={channel:"zeus",cmd:"start_mix",req_body:JSON.stringify(m)};return this.logger.debug("zb.sh.ums send command"),this.sendBizChannelRequest(S,(function(e,i,n){u.logger.debug("zb.sh.ums receive message");var o="zegotest-"+u.stateCenter.appid+"-";if(0!=n.length){for(var s=JSON.parse(n),a=[],c=0;c<s.play.length;c++){var l={rtmpURL:"",hlsURL:"",flvURL:""},d=s.play[c].stream_alias||"";u.stateCenter.testEnvironment&&d&&d.startsWith(o)&&(d=d.slice(o.length)),l.streamID=d,s.play[c].rtmp_url&&s.play[c].rtmp_url.length>0&&(l.rtmpURL=s.play[c].rtmp_url),s.play[c].hls_url&&s.play[c].hls_url.length>0&&(l.hlsURL=s.play[c].hls_url),s.play[c].hdl_url&&s.play[c].hdl_url.length>0&&(l.flvURL=s.play[c].hdl_url),a.push(l)}if(t){var h={mixerOutputList:a};t({errorCode:0,extendedData:JSON.stringify(h)})}}else r&&r({errorCode:u.stateCenter.getServerError(10001).code,extendedData:""})}),(function(e,t,o){if("number"==typeof e){u.logger.debug("zb.sh.ums error: "+e);var a=[];if(1000000150==e&&0!=o.length)for(var c=JSON.parse(o),l="zegotest-"+u.stateCenter.appid+"-",d=0;d<c.non_exist_streams.length;d++){var h=c.non_exist_streams[d];u.stateCenter.testEnvironment&&h.startsWith(l)?a.push(h.slice(l.length)):a.push(h)}r&&r({errorCode:u.stateCenter.getServerError(s+e).code,extendedData:""})}else{var p;u.logger.debug("zb.sh.ums error code "+e.code),p=e==i.errorCodeList.TIMEOUT?n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kRequestError:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kInternalError,r&&r({errorCode:p.code,extendedData:p.message})}})),!0}}},817:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCodeList=void 0,t.errorCodeList={NOT_LOGIN:{code:1000002,message:"not login room"},INPUT_PARAM:{code:1100001,message:"input param error."},TIMEOUT:{code:1100002,message:"network timeout."},MIXER_NO_SERVICES:{code:1005e3,message:"no mix stream service"},MIXER_TASK_ID_NULL:{code:1005001,message:"mixer task is null"},MIXER_TASK_ID_TOO_LONG:{code:1005002,message:"task ID is too long"},MIXER_TASK_ID_INVALID_CHARACTER:{code:1005003,message:"task ID contains illegal characters"},MIXER_NO_OUTPUT_TARGET:{code:1005005,message:"task configuration does not specify output"},MIXER_OUTPUT_TARGET_INVALID:{code:1005006,message:"stream output target is incorrect"},MIXER_START_REQUEST_ERROR:{code:1005010,message:"start mixer task fail, possibly due to network reasons"},MIXER_STOP_REQUEST_ERROR:{code:1005011,message:"stop mixer task fail, possibly due to network reasons"},MIXER_NOT_OWNER_STOP_MIXER:{code:1005012,message:" maxed task must be stopped by the start user of the task"},MIXER_INPUTLIST_NULL:{code:1005020,message:"Mixed stream task input list is null"},MIXER_OUTPUTLIST_NULL:{code:1005021,message:"Mixed stream task output list is null"},MIXER_VIDEO_CONFIG_INVALID:{code:1005023,message:"invalid mixed stream task video configuration"},MIXER_EXCEED_MAX_INPUT_COUNT:{code:1005025,message:"more than the maximum number of input streams"},MIXER_INPUT_STREAM_NOT_EXISTS:{code:1005026,message:"Input stream does not exist"},MIXER_EXCEED_MAX_OUTPUT_COUNT:{code:1005030,message:"more than the maximum number of output streams"},MIXER_AUTHENTICATION_FAILED:{code:1005050,message:"mixed stream authentication failed"},MIXER_WATERMARK_NULL:{code:1005061,mag:"input watermark is null"},MIXER_WATERMARK_PARAMETERS_ERROR:{code:1005062,message:"input watermark parameter is wrong"},MIXER_WATERMARK_URL_INVALID:{code:1005063,message:"illegal input watermark URL"},MIXER_BACKGROUND_IMAGE_URL_INVALID:{code:1005067,message:"illegal input background image URL"},MIXER_REPEAT_INPUT:{code:1005099,message:"mix stream input repeat"},MIXER_INNER_ERROR:{code:1005099,message:"mixer internal error"}}},577:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(5906);t.default={type:"MixStream",install:function(e,t){for(var r in i.zegoWebRTC)Object.defineProperty(e.prototype,r,{value:i.zegoWebRTC[r],writable:!1});for(var r in i.streamHandler)Object.defineProperty(t.prototype,r,{value:i.streamHandler[r],writable:!1})}}},6145:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoRTCLogEvent=void 0;var i=r(817),n=function(e){return e};t.ZegoRTCLogEvent={kZegoTaskMixStart:{event:"/mix/start_mix",error:{kParamError:i.errorCodeList.INPUT_PARAM,kTaskIDNullError:i.errorCodeList.MIXER_TASK_ID_NULL,kTaskIDToLongError:i.errorCodeList.MIXER_TASK_ID_TOO_LONG,kTaskIDInvalidCharacterError:i.errorCodeList.MIXER_TASK_ID_INVALID_CHARACTER,kInputListNullError:i.errorCodeList.MIXER_INPUTLIST_NULL,kOutputListNullError:i.errorCodeList.MIXER_OUTPUTLIST_NULL,kOutputTargetInvalidError:i.errorCodeList.MIXER_OUTPUT_TARGET_INVALID,kOutputNoTargetError:i.errorCodeList.MIXER_NO_OUTPUT_TARGET,kRequestError:i.errorCodeList.MIXER_START_REQUEST_ERROR,kInternalError:i.errorCodeList.MIXER_INNER_ERROR,kNoLoginError:i.errorCodeList.NOT_LOGIN},mix_stream_id:n,stream_cnt:n,input_stream_list:n,output_target_list:n},kZegoTaskMixStop:{event:"/mix/stop_mix",error:{kParamError:i.errorCodeList.INPUT_PARAM,kTaskIDNullError:i.errorCodeList.MIXER_TASK_ID_NULL,kRequestError:i.errorCodeList.MIXER_STOP_REQUEST_ERROR,kInternalError:i.errorCodeList.MIXER_INNER_ERROR,kNoLoginError:i.errorCodeList.NOT_LOGIN}},kZegoTaskMixConfig:{event:"/mix/config_mix",error:{kParamError:i.errorCodeList.INPUT_PARAM,kVideoConfigInvalidError:i.errorCodeList.MIXER_VIDEO_CONFIG_INVALID,kBackgroundImageUrlInvalidError:i.errorCodeList.MIXER_BACKGROUND_IMAGE_URL_INVALID,kNoLoginError:i.errorCodeList.NOT_LOGIN},config:n}}},2760:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(r(2730)),a=o(r(5947)),c=o(r(1646)),l=o(r(1576)),u=r(7803),d=r(1297),h=function(){function e(e){var t=this;this.isSpatial=!1,this.audioSourceList=[],this.speakingUserIdList=[],this._audioCtx=null,this.zegoRTC=e,this.zegoRTC.on("roomStreamUpdate",(function(e,r,i){var n=i.map((function(e){return e.streamID}));"DELETE"===r?t.speakingUserIdList=t.speakingUserIdList.filter((function(e){var r=!n.includes(e);if(!r){var i=t.audioSourceMap[e];i&&i.isPlaying&&i.stopPlayingAudio()}return r})):"ADD"===r&&(t.speakingUserIdList=t.speakingUserIdList.concat(n),i.forEach((function(e){if(!t.audioSourceMap[e.streamID]){var r=t.getStreamInfo(e.extraInfo),i=r.teamID,n=r.sendMode,o=new s.default({userID:e.streamID,teamID:i,sendMode:n},{audioCtx:t.audioCtx,zegoRTC:t.zegoRTC,isSpatial:t.isSpatial,maxDistance:t.rangeListener.recvRange});t.audioSourceList.push(o),t.playStreamHandler.handlePlayAudioTask()}}))),t.playStreamHandler.setAudioSourceList(t.speakingAudioSourceList)})),this.zegoRTC.on("playerStateUpdate",(function(e){var r=t.audioSourceMap[e.streamID];r&&("NO_PLAY"===e.state?r.isPlaying=!1:r.isPlaying=!0)})),this.zegoRTC.on("streamExtraInfoUpdate",(function(e,r){r.forEach((function(e){var r=t.audioSourceMap[e.streamID];if(r){var i=t.getStreamInfo(e.extraInfo),n=i.teamID,o=i.sendMode;n!==r.teamID&&(r.teamID=n,t.enableSpatializer(t.isSpatial)),void 0!==o&&(r.sendMode=o),t.playStreamHandler.handlePlayAudioTask()}}))})),this.zegoRTC.RTM._on("_roomStateUpdate",(function(e,r){"CONNECTED"===r?(t.roomID=e,t.rangeListener.userID=t.zegoRTC.RTM.getUserID()):"DISCONNECTED"===r&&(t.roomID=void 0,t.rangeListener.reset(),t.audioSourceList=[])}));var r=window.AudioContext||window.webkitAudioContext;this._audioCtx=this.zegoRTC&&this.zegoRTC.ac||new r,this.rangeListener=a.default.getInstance(this.audioCtx,this.zegoRTC),this.playStreamHandler=c.default.getInstance(this.rangeListener),this.eventManager=l.default.getInstance()}return Object.defineProperty(e.prototype,"audioSourceMap",{get:function(){return this.audioSourceList.reduce((function(e,t){return t.userID&&(e[t.userID]=t),e}),{})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"speakingAudioSourceList",{get:function(){var e=this;return this.audioSourceList.filter((function(t){return!!e.speakingUserIdList.includes(t.userID)}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playingAudioSourceList",{get:function(){return this.audioSourceList.filter((function(e){return e.isPlaying}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"audioCtx",{get:function(){if(!this._audioCtx){var e=window.AudioContext||window.webkitAudioContext;this._audioCtx=new e}return this._audioCtx},enumerable:!1,configurable:!0}),e.getInstance=function(t){return e.instance||(e.instance=new e(t)),e.instance},e.prototype.resumeAudioContext=function(){return i(this,void 0,void 0,(function(){var e=this;return n(this,(function(t){return[2,new Promise((function(t){e.audioCtx.onstatechange=function(){"running"===e.audioCtx.state&&t(!0)},e.audioCtx.suspend(),e.audioCtx.resume(),setTimeout((function(){t(!1)}),3e3)}))]}))}))},e.prototype.getAudioContextState=function(){return this.audioCtx.state},e.prototype.getStreamInfo=function(e){var t=void 0,r=void 0;try{var i=JSON.parse(e);t=i.range_audio_team_id,[d.ZegoRangeAudioMode.World,d.ZegoRangeAudioMode.Team].includes(i.range_audio_mode)&&(r=i.range_audio_mode)}catch(e){}return{teamID:t,sendMode:r}},e.prototype.setAudioReceiveRange=function(e){if(!u.checkNumber(e))throw Error("Failed to execute 'setAudioReceiveRange': Argument 'range' requires to be type number.");if((e=Number(e))<0)throw Error("Failed to execute 'setAudioReceiveRange': Argument 'range' can not be less than 0.");this.rangeListener.recvRange=e,this.audioSourceList.forEach((function(t){t.setMaxDistance(e)}))},e.prototype.updateSelfPosition=function(e,t,r,i){var n=function(e){return"Failed to execute 'updateSelfPosition': Argument '"+e+"' requires an array of type number.\""};if(!u.checkCoordinate(e))throw new Error(n("position"));if(!u.checkCoordinate(t))throw new Error(n("axisForward"));if(!u.checkCoordinate(r))throw new Error(n("axisRight"));if(!u.checkCoordinate(i))throw new Error(n("axisUp"));this.rangeListener&&this.rangeListener.updateSelfPosition(e,t,i),this.playStreamHandler.setListener(this.rangeListener)},e.prototype.updateAudioSource=function(e,t){if(e=String(e),!u.checkCoordinate(t))throw new Error("Failed to execute 'updateAudioSource': Arguments 'position' must be an array of type number.");var r=this.audioSourceMap[e];r?r.setPosition(t):(r=new s.default({userID:e,position:t},{audioCtx:this.audioCtx,zegoRTC:this.zegoRTC,isSpatial:this.isSpatial,maxDistance:this.rangeListener.recvRange}),this.enableSpatializer(this.isSpatial),this.audioSourceList.push(r)),this.playStreamHandler.setAudioSourceList(this.speakingAudioSourceList)},e.prototype.enableMicrophone=function(e){if(void 0===e&&(e=!0),!this.rangeListener.userID)throw new Error("Enable mic failed. Please log in room first.");return e?this.rangeListener.startPublishingStream():this.rangeListener.stopPublishingStream()},e.prototype.enableSpeaker=function(e){if(void 0===e&&(e=!0),!this.roomID)throw new Error("Enable speaker failed. Please log in room first.");this.playStreamHandler.isEnable=e,e?(this.playStreamHandler.startPlayingAudioStream(),this.playStreamHandler.handlePlayAudioTask()):this.playStreamHandler.stopPlayingAudioStream()},e.prototype.enableSpatializer=function(e){var t=this;void 0===e&&(e=!0),this.isSpatial=!!e,this.audioSourceList.forEach((function(r){var i=!(![r.teamID,t.rangeListener.teamID].includes(void 0)&&t.rangeListener.teamID===r.teamID)&&e;r.enableSpatializer(i)})),e&&this.rangeListener.updateListenerEffect()},e.prototype.setRangeAudioTeamID=function(e){this.rangeListener.setTeamID(e),this.enableSpatializer(this.isSpatial),this.playStreamHandler.handlePlayAudioTask()},e.prototype.setRangeAudioMode=function(e){this.rangeListener.setSendMode(e),this.rangeListener.setRecvMode(e),this.playStreamHandler.handlePlayAudioTask()},e.prototype.on=function(e,t){return this.eventManager.addEventHandler(e,t)},e.prototype.off=function(e,t){return this.eventManager.removeEventHandler(e,t)},e}();t.default=h},2777:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RangeAudio=void 0;var i=r(3116);t.RangeAudio={type:"RangeAudio",install:function(e){Object.defineProperty(e.prototype,"createRangeAudioInstance",{value:function(){return this.rangeAudio||(this.rangeAudio=i.ZegoExpressRangeAudio.getInstance(this)),this.rangeAudio},writable:!1})}}},2730:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(1297),s=function(){function e(e,t){this.panner=null,this.isSpatial=!1,this.autoPlay=!0,this.position=null,this.stream=null,this.sourceNode=null,this.isPlaying=!1,this.distance=null,this.audioCtx=t.audioCtx,this.zegoRTC=t.zegoRTC,this.isSpatial=t.isSpatial,this.maxDistance=t.maxDistance||1e5,this.userID=e.userID,this.teamID=e.teamID,this.sendMode=void 0!==e.sendMode?e.sendMode:o.ZegoRangeAudioMode.World,e.position&&(this.position=e.position)}return Object.defineProperty(e.prototype,"audioWrapper",{get:function(){var e=document.getElementById("#zg-audio-source-wrapper");return e||((e=document.createElement("div")).setAttribute("id","zg-audio-source-wrapper"),document.body.appendChild(e)),e},enumerable:!1,configurable:!0}),e.prototype.createPanner=function(){var e=this.position||[0,0,0],t=this.maxDistance;return new PannerNode(this.audioCtx,{panningModel:"HRTF",distanceModel:"linear",refDistance:1,maxDistance:t,rolloffFactor:1,coneOuterGain:.4,positionX:e[1],positionY:e[0],positionZ:-e[0]})},e.prototype.startPlayingAudio=function(){return i(this,void 0,void 0,(function(){var e,t;return n(this,(function(r){switch(r.label){case 0:return(e=document.getElementById("zg-audio-source-"+this.userID))?[3,2]:((e=document.createElement("audio")).setAttribute("autoplay","autoplay"),e.setAttribute("id","zg-audio-source-"+this.userID),e.setAttribute("crossorigin","anonymous"),t=this,[4,this.zegoRTC.startPlayingStream(this.userID)]);case 1:t.stream=r.sent(),this.audioWrapper.appendChild(e),this.stream&&(e.srcObject=this.stream,this.sourceNode=this.audioCtx.createMediaStreamSource(this.stream)),this.panner||(this.panner=this.createPanner()),this.sourceNode&&this.enableSpatializer(this.isSpatial,!0),"suspended"===this.audioCtx.state&&this.audioCtx.resume(),r.label=2;case 2:return e&&e.parentNode&&e.parentNode.removeChild(e),[2]}}))}))},e.prototype.stopPlayingAudio=function(){this.isPlaying&&this.zegoRTC.stopPlayingStream(this.userID),this.stream=null,this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=null)},e.prototype.setPosition=function(e){this.position=e,this.panner&&(this.panner.positionX.value=e[1],this.panner.positionY.value=e[2],this.panner.positionZ.value=-e[0])},e.prototype.setMaxDistance=function(e){this.maxDistance=e,this.panner&&(this.panner.maxDistance=this.maxDistance)},e.prototype.getDistanceFromListener=function(e){var t=this.position,r=e.position;if(!r||!t)return null;var i=[t[0]-r[0],t[1]-r[1],t[2]-r[2]];return this.distance=Math.sqrt(Math.pow(i[0],2)+Math.pow(i[1],2)+Math.pow(i[2],2)),this.distance},e.prototype.enableSpatializer=function(e,t){void 0===t&&(t=!1),(t||this.isSpatial!==e)&&(this.isSpatial=e,this.sourceNode&&(e&&this.panner?(this.sourceNode.disconnect(),this.sourceNode.connect(this.panner).connect(this.audioCtx.destination)):e||(this.sourceNode.disconnect(),this.sourceNode.connect(this.audioCtx.destination))))},e}();t.default=s},1576:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.handlerListMap={microphoneStateUpdate:[]}}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addEventHandler=function(e,t){if(!this.handlerListMap[e])return!1;if("function"!=typeof t)throw new Error("Params callBack is not a Function");return-1==this.handlerListMap[e].indexOf(t)&&this.handlerListMap[e].push(t),!0},e.prototype.removeEventHandler=function(e,t){return!!this.handlerListMap[e]&&(this.handlerListMap[e]=t?this.handlerListMap[e].filter((function(e){return e!==t})):[],!0)},e.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.handlerListMap[e]&&this.handlerListMap[e].forEach((function(r){try{setTimeout((function(){r.apply(void 0,t)}),0)}catch(t){console.error("dispatch "+e+" "+t)}}))},e}();t.default=r},1646:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(1297),n=function(){function e(e){this.isEnable=!1,this.interval=3e3,this.timer=null,this.audioSourceList=[],this.hasChanged=!1,this.maxPlayingQuantity=20,this.rangeListener=e}return e.getInstance=function(t){return e.instance||(e.instance=new e(t)),e.instance},e.prototype.setListener=function(e){this.rangeListener=e,this.hasChanged=!0},e.prototype.setAudioSourceList=function(e){this.audioSourceList=e,this.hasChanged=!0},e.prototype.startPlayingAudioStream=function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.playAudioTask()},e.prototype.playAudioTask=function(){var e=this;this.hasChanged&&(this.hasChanged=!1,this.handlePlayAudioTask()),this.timer=window.setTimeout((function(){e.playAudioTask()}),this.interval)},e.prototype.handlePlayAudioTask=function(){var e=this;if(this.isEnable){var t=this.getTeamAudioSourceGroup(),r=t.teamList,n=t.otherList,o=0;r.forEach((function(t){o<e.maxPlayingQuantity&&(t.isPlaying||t.startPlayingAudio(),o++)}));var s=this.rangeListener.recvMode===i.ZegoRangeAudioMode.World;s&&(n.forEach((function(t){t.distance=t.getDistanceFromListener(e.rangeListener)})),n.sort((function(e,t){return null===e.distance?1:null===t.distance||e.distance<t.distance?-1:e.distance>t.distance?1:0}))),n.forEach((function(t){s&&o<e.maxPlayingQuantity&&t.sendMode!==i.ZegoRangeAudioMode.Team&&null!==t.distance&&(null===e.rangeListener.recvRange||t.distance<=e.rangeListener.recvRange)?(t.isPlaying||t.startPlayingAudio(),o++):t.stopPlayingAudio()}))}else this.stopPlayingAudioStream()},e.prototype.getTeamAudioSourceGroup=function(){var e=this,t=[],r=[];return this.audioSourceList.forEach((function(i){[i.teamID,e.rangeListener.teamID].includes(void 0)||i.teamID!==e.rangeListener.teamID?r.push(i):t.push(i)})),{teamList:t,otherList:r}},e.prototype.stopPlayingAudioStream=function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.audioSourceList.forEach((function(e){e.stopPlayingAudio()}))},e}();t.default=n},5947:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=r(1297),o=i(r(1576)),s=function(){function e(e,t){var r=this;this.recvMode=n.ZegoRangeAudioMode.World,this.sendMode=n.ZegoRangeAudioMode.World,this.recvRange=null,this.position=null,this.forwardAxis=[1,0,0],this.upAxis=[0,0,1],this.audioStream=null,this.isPublishing=!1,this.zegoRTC=t,this.audioCtx=e,this.audioListener=this.audioCtx.listener,this.eventHandler=o.default.getInstance(),this.zegoRTC.on("publisherStateUpdate",(function(e){var t=e.streamID,i=e.state,o=e.errorCode,s=e.extendedData;t===r.userID&&("NO_PUBLISH"===i?(r.isPublishing=!1,r.stopPublishingStream()):r.isPublishing=!0);var a={NO_PUBLISH:n.ZegoRangeAudioMicrophoneState.Off,PUBLISH_REQUESTING:n.ZegoRangeAudioMicrophoneState.TurningOn,PUBLISHING:n.ZegoRangeAudioMicrophoneState.On};r.eventHandler.emit("microphoneStateUpdate",a[i],o,s)}))}return e.getInstance=function(t,r){return e.instance||(e.instance=new e(t,r)),e.instance},e.prototype.updateSelfPosition=function(e,t,r){this.position=e,this.forwardAxis=t,Array.isArray(r)&&(this.upAxis=r),this.updateListenerEffect()},e.prototype.updateListenerEffect=function(){this.position&&(this.audioListener.positionX?(this.audioListener.positionX.value=this.position[1],this.audioListener.positionY.value=this.position[2],this.audioListener.positionZ.value=-this.position[0]):this.audioListener.setPosition(this.position[1],this.position[2],-this.position[0]),this.audioListener.forwardX?(this.audioListener.forwardX.value=this.forwardAxis[1],this.audioListener.forwardY.value=this.forwardAxis[2],this.audioListener.forwardZ.value=-this.forwardAxis[0],this.audioListener.upX.value=this.upAxis[1],this.audioListener.upY.value=this.upAxis[2],this.audioListener.upZ.value=-this.upAxis[0]):this.audioListener.setOrientation(this.forwardAxis[1],this.forwardAxis[2],-this.forwardAxis[0],this.upAxis[1],this.upAxis[2],-this.upAxis[0]))},e.prototype.startPublishingStream=function(){var e=this;this.zegoRTC.createStream({camera:{video:!1,audio:!0,audioBitrate:30}}).then((function(t){if(!e.userID)throw e.zegoRTC.destroyStream(t),Error("Enable mic failed. Please log in room first.");e.audioStream&&e.audioStream!==t&&e.zegoRTC.destroyStream(e.audioStream),e.audioStream=t;var r={range_audio_team_id:e.teamID,range_audio_mode:e.sendMode};e.zegoRTC.startPublishingStream(e.userID,t,{extraInfo:JSON.stringify(r)})})).catch((function(e){throw e}))},e.prototype.stopPublishingStream=function(){this.isPublishing&&this.userID&&this.zegoRTC.stopPublishingStream(this.userID),this.isPublishing=!1,this.audioStream&&(this.zegoRTC.destroyStream(this.audioStream),this.audioStream=null)},e.prototype.setRecvMode=function(e){this.recvMode=e},e.prototype.setSendMode=function(e){this.sendMode=e,this.updateSteamExtraInfo()},e.prototype.setTeamID=function(e){this.teamID=e,this.updateSteamExtraInfo()},e.prototype.updateSteamExtraInfo=function(){this.userID&&this.isPublishing&&this.zegoRTC.setStreamExtraInfo(this.userID,JSON.stringify({range_audio_team_id:this.teamID||void 0,range_audio_mode:this.sendMode}))},e.prototype.reset=function(){this.audioStream&&this.stopPublishingStream(),this.userID=void 0},e}();t.default=s},7803:function(e,t){"use strict";function r(e){return!isNaN(Number(e))&&Number.MAX_SAFE_INTEGER>=Number(e)&&Number(e)>=-Number.MAX_SAFE_INTEGER}Object.defineProperty(t,"__esModule",{value:!0}),t.checkCoordinate=t.checkBoolean=t.checkNumber=void 0,t.checkNumber=r,t.checkBoolean=function(e){return!1},t.checkCoordinate=function(e){if(Array.isArray(e)){for(var t=0;t<3;t++)if(!r(e[t]))return!1;return!0}return!1}},3524:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.preview=void 0;var s=o(r(954)),a=r(3471);t.preview={setBeautyEffect:function(e,t){return i(this,void 0,void 0,(function(){var r,o,c,l=this;return n(this,(function(u){switch(u.label){case 0:if(!this.videoTrack)return this.logger.error("zc.p.0.sbe.0 video track no found"),[2];if("undefined"==typeof WebGLRenderingContext)throw r=a.errorCodeList.VIDEO_EFFECT_NOT_SUPPORT,o=r.code,c=r.message,Error({errorCode:o,extendedData:c});return s.default?this.videoEffect?this.videoTrack===this.videoEffect.input?[3,2]:[4,this.videoEffect.setInput(this.videoTrack)]:[3,4]:[3,7];case 1:u.sent(),u.label=2;case 2:return[4,this.videoEffect.setBeautyEffectOptions(e,t)];case 3:return u.sent(),[3,6];case 4:return this.videoEffect=new s.default(this.logger,this.videoTrack),this.videoEffect.onOverload=function(e){l.stateCenter.actionListener("beautyEffectOverload",l.localStream,e)},this.videoEffect.onOutputChange=function(e){return i(l,void 0,void 0,(function(){var t,r,i;return n(this,(function(n){return this.videoTrack&&this.localStream&&(t=this.videoTrack,e&&(t=e),this.localStream.getVideoTracks()[0]!==t&&(void 0===(r=null===(i=this.streamCenter.checkPublish(this.localStream))||void 0===i?void 0:i.publisher)?this.replacePreviewTrack(t,!!e):r.replacePublishedTrack(t,!0))),[2]}))}))},[4,this.videoEffect.setBeautyEffectOptions(e,t)];case 5:u.sent(),u.label=6;case 6:return[3,8];case 7:this.logger.error("zc.p.0.sbe.0 beauty effect module no found"),u.label=8;case 8:return[2]}}))}))}}},3048:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PUBLISH_SET_BEAUTY_EFFECT=void 0;var s=o(r(8606)),a=o(r(5683)),c=o(r(8302));t.PUBLISH_SET_BEAUTY_EFFECT="zc.p.0.sbe.2";var l=function(){function e(e){this.logger=e,this.gl=null,this.effectConfig={sharpenIntensity:.5,whitenIntensity:.5,rosyIntensity:.5,smoothIntensity:.5},this.originResolution={width:0,height:0},this.shaderList=[],this.frameBufferList=[],this.outputTextureList=[],this.inputTexture=null,this.enableBeauty=!1}return e.prototype.setEnableBeauty=function(e){this.enableBeauty=!!e},e.prototype.init=function(e,r,o){return i(this,void 0,void 0,(function(){var i,l,u;return n(this,(function(n){return"undefined"!=typeof WebGLRenderingContext?(this.gl=o.getContext("webgl"),this.gl?(this.initGL(e,r),this.inputTexture?(this.canvasEl=o,(i=new s.default(this.gl,e,r)).setConstUniforms(),(l=new a.default(this.gl,e,r)).setConstUniforms(),(u=new c.default(this.gl,e,r)).setConstUniforms(),this.shaderList=[i,l,u],this.setEffectConfig(this.effectConfig),[2]):[2,this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" input texture not found")]):[2,this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" not get webgl context")]):[2,this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" not support webgl!")]}))}))},e.prototype.render=function(e){return i(this,void 0,void 0,(function(){var r,i,o,s,a=this;return n(this,(function(n){switch(n.label){case 0:return(r=this.gl)&&this.canvasEl?this.originResolution.height===e.videoHeight&&this.originResolution.width===e.videoWidth||!(Math.abs(this.originResolution.height-e.videoHeight)>2||Math.abs(this.originResolution.width-e.videoWidth)>2)?[3,3]:0===e.videoHeight||0===e.videoWidth?[2]:(this.canvasEl.width=e.videoWidth,this.canvasEl.height=e.videoHeight,e.setAttribute("width",e.videoWidth.toString()),e.setAttribute("height",e.videoHeight.toString()),!this.gl||this.gl.isContextLost()?[3,1]:(this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" resolution changed, reset resolution"),this.resetResolution(e.videoWidth,e.videoHeight),[3,3])):(this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" video effect manager is not init!"),[2]);case 1:return this.logger.warn(t.PUBLISH_SET_BEAUTY_EFFECT+" resolution changed and gl context lost, restart effect"),this.release(),[4,this.init(e.videoWidth,e.videoHeight,this.canvasEl)];case 2:n.sent(),n.label=3;case 3:return i=[-1,-1,0,1,-1,0,1,1,0,-1,1,0],o=[0,1,2,0,2,3],s=[0,0,1,0,1,1,0,1],r.viewport(0,0,e.width,e.height),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,this.inputTexture),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e),this.shaderList.forEach((function(e,t){var n=e.program;if(n){e.renderPreTextures&&e.renderPreTextures(i,o,s),r.useProgram(n),e.render();var c=r.getUniformLocation(n,"uTexture"),l=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,l),r.bufferData(r.ARRAY_BUFFER,new Float32Array(i),r.STATIC_DRAW);var u=r.createBuffer();r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,u),r.bufferData(r.ELEMENT_ARRAY_BUFFER,new Uint16Array(o),r.STATIC_DRAW);var d=r.getAttribLocation(n,"aPosition");r.enableVertexAttribArray(d),r.vertexAttribPointer(d,3,r.FLOAT,!1,0,0);var h=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,h),r.bufferData(r.ARRAY_BUFFER,new Float32Array(s),r.STATIC_DRAW);var p=r.getAttribLocation(n,"aTexCoordinate");r.enableVertexAttribArray(p),r.vertexAttribPointer(p,2,r.FLOAT,!1,0,0);var f=t===a.shaderList.length-1?null:a.outputTextureList[t],g=t===a.shaderList.length-1?null:a.frameBufferList[t];r.bindFramebuffer(r.FRAMEBUFFER,g),r.clearColor(0,0,0,1),r.clear(r.COLOR_BUFFER_BIT),r.drawElements(r.TRIANGLES,6,r.UNSIGNED_SHORT,0),r.activeTexture(r.TEXTURE0),f&&r.bindTexture(r.TEXTURE_2D,f),r.uniform1i(c,0)}})),[2]}}))}))},e.prototype.setEffectConfig=function(e){var t=this;isNaN(e.sharpenIntensity)||(this.effectConfig.sharpenIntensity=e.sharpenIntensity),isNaN(e.whitenIntensity)||(this.effectConfig.whitenIntensity=e.whitenIntensity),isNaN(e.rosyIntensity)||(this.effectConfig.rosyIntensity=e.rosyIntensity),isNaN(e.smoothIntensity)||(this.effectConfig.smoothIntensity=e.smoothIntensity),this.shaderList.forEach((function(e){e.setEffectConfig(t.effectConfig)}))},e.prototype.release=function(){var e=this;this.shaderList.forEach((function(t){var r;t.program&&(null===(r=e.gl)||void 0===r||r.deleteProgram(t.program))})),this.outputTextureList.forEach((function(t){var r;t&&(null===(r=e.gl)||void 0===r||r.deleteTexture(t))})),this.frameBufferList.forEach((function(t){var r;t&&(null===(r=e.gl)||void 0===r||r.deleteFramebuffer(t))})),this.inputTexture=this.gl=null,this.shaderList=[],this.outputTextureList=[],this.frameBufferList=[]},e.prototype.initGL=function(e,r){var i=this.gl;if(!i)return this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" webgl context not found");this.inputTexture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.inputTexture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR);for(var n=0;3>n;n++){var o=i.createTexture();if(!o)return this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" create texture failed");i.bindTexture(i.TEXTURE_2D,o),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,e,r,0,i.RGBA,i.UNSIGNED_BYTE,null);var s=i.createFramebuffer();if(!s)return this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" create frame buffer failed");i.bindFramebuffer(i.FRAMEBUFFER,s),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,o,0),this.outputTextureList.push(o),this.frameBufferList.push(s)}i.viewport(0,0,e,r),this.originResolution.width=e,this.originResolution.height=r},e.prototype.resetResolution=function(e,r){var i=this.gl;if(!i)return this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" can not find webgl context");this.outputTextureList.forEach((function(t){i.bindTexture(i.TEXTURE_2D,t),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,e,r,0,i.RGBA,i.UNSIGNED_BYTE,null)})),i.viewport(0,0,e,r),this.originResolution.width=e,this.originResolution.height=r},e}();t.default=l},3471:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCodeList=void 0,t.errorCodeList={VIDEO_EFFECT_NOT_SUPPORT:{code:1103072,message:"not support beauty effect"}}},957:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BeautyEffect=void 0;var i=r(3524);t.BeautyEffect={type:"BeautyEffect",install:function(e){for(var t in i.preview)Object.defineProperty(e.prototype,t,{value:i.preview[t],writable:!1})}}},836:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.logger=e,this.recordedFrameCount=0,this.targetFrameRate=0,this.recordingDuration=0}return e.prototype.startRecordBeautyEffectOutput=function(e){return r(this,void 0,void 0,(function(){var t,r,n,o,s=this;return i(this,(function(i){switch(i.label){case 0:return t=6,this.recordID?(this.logger.warn("zc.p.0.sbe.3 detector is already recording"),[2,{result:!0}]):(r=(new Date).getTime(),this.recordID=r,this.targetFrameRate=e,this.recordedFrameCount=0,this.recordingDuration=t,[4,new Promise((function(e){window.setTimeout(e,1e3*s.recordingDuration)}))]);case 1:return i.sent(),this.recordID!==r?(this.recordID=void 0,[2,{result:!0}]):(this.recordID=void 0,n=this.targetFrameRate*this.recordingDuration,o=this.recordedFrameCount/t,this.recordedFrameCount<n/2?(this.logger.warn("zc.p.0.sbe.3 detect effect overload: current fps: "+o),[2,{result:!1,targetFPS:this.targetFrameRate,currentFPS:o}]):(this.logger.info("zc.p.0.sbe.3 detect effect current fps: "+o),[2,{result:!0}]))}}))}))},e.prototype.stopRecordBeautyEffectOutput=function(){this.recordedFrameCount=this.targetFrameRate=0,this.recordID=void 0},e.prototype.addFrame=function(){this.recordID&&(this.recordedFrameCount+=1)},e}();t.default=n},5683:function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(r(6976)),a=r(1199),c=function(e){function t(t,r,i){var n=e.call(this,t)||this;return n.width=r,n.height=i,n.type="LightShader",n.uLightIntensity=null,n.uRedIntensity=null,n.whitenIntensity=.5,n.rosyIntensity=.5,n.program=n.makeProgram(a.lightVS,a.lightFS),n}return n(t,e),t.prototype.setEffectConfig=function(e){isNaN(e.whitenIntensity)||(this.whitenIntensity=e.whitenIntensity/100),isNaN(e.rosyIntensity)||(this.rosyIntensity=e.rosyIntensity/100)},t.prototype.render=function(){var e=this.gl;e.uniform1f(this.uLightIntensity,this.whitenIntensity),e.uniform1f(this.uRedIntensity,this.rosyIntensity)},t.prototype.setConstUniforms=function(){var e=this.program;if(e){var t=this.gl;t.useProgram(e),this.uLightIntensity=t.getUniformLocation(e,"intensity"),t.uniform1f(this.uLightIntensity,this.whitenIntensity),this.uRedIntensity=t.getUniformLocation(e,"rosyIntensity"),t.uniform1f(this.uRedIntensity,this.rosyIntensity);var r=t.getUniformLocation(e,"uPMVMatrix");t.uniformMatrix4fv(r,!1,[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])}},t}(s.default);t.default=c},6976:function(e,t){"use strict";function r(e){for(var t=e,r="",i=0;i<t.length;i++){var n=t.charCodeAt(i),o=n;n>=65&&n<=90&&(o=(n-65-13+26)%26+65),n>=97&&n<=122&&(o=(n-97-13+26)%26+97),r+=String.fromCharCode(o)}return r}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.gl=e,this.program=null,this.program=null}return e.prototype.setEffectConfig=function(e){},e.prototype.setConstUniforms=function(){},e.prototype.render=function(){},e.prototype.renderPreTextures=function(e,t,r){},e.prototype.makeProgram=function(e,t){var i=this.gl,n=r(e),o=r(t),s=this.makeShader(n,i.VERTEX_SHADER),a=this.makeShader(o,i.FRAGMENT_SHADER),c=i.createProgram();return i.attachShader(c,s),i.attachShader(c,a),i.linkProgram(c),i.getProgramParameter(c,i.LINK_STATUS),c},e.prototype.makeShader=function(e,t){var r=this.gl,i=r.createShader(t);return r.shaderSource(i,e),r.compileShader(i),r.getShaderParameter(i,r.COMPILE_STATUS),i},e}();t.default=i},8606:function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(r(6976)),a=r(1199),c=function(e){function t(t,r,i){var n=e.call(this,t)||this;return n.width=r,n.height=i,n.type="BlurShader",n.blurXProgram=null,n.blurYProgram=null,n.diffProgram=null,n.uIntensity=null,n.smoothIntensity=.5,n.blurTextureList=[],n.blurBufferList=[],n.blurXProgram=n.makeProgram(a.borderBlurVS,a.borderBlurFS),n.setBorderBlurProgram(n.blurXProgram,1/(r||1),0),n.blurYProgram=n.makeProgram(a.borderBlurVS,a.borderBlurFS),n.setBorderBlurProgram(n.blurYProgram,0,1/(i||1)),n.diffProgram=n.makeProgram(a.diffBlurVS,a.diffBlurFS),n.setDiffBlurProgram(n.diffProgram),n.program=n.makeProgram(a.mixBlurVS,a.mixBlurFS),n.initBlurBuffer(),n}return n(t,e),t.prototype.setEffectConfig=function(e){isNaN(e.smoothIntensity)||(this.smoothIntensity=e.smoothIntensity/100)},t.prototype.render=function(){this.gl.uniform1f(this.uIntensity,this.smoothIntensity)},t.prototype.initBlurBuffer=function(){var e=this.gl;this.blurTextureList=[],this.blurTextureList=[];for(var t=0;t<3;t++){var r=e.createTexture();if(!r)return;e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.width,this.height,0,e.RGBA,e.UNSIGNED_BYTE,null);var i=e.createFramebuffer();if(!i)return;e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0),this.blurTextureList.push(r),this.blurBufferList.push(i)}},t.prototype.renderPreTextures=function(e,t,r){var i=this,n=this.gl,o=[0,1,0],s=[1,1,2];[this.blurXProgram,this.blurYProgram,this.diffProgram].forEach((function(a,c){if(a){n.useProgram(a);var l=n.getUniformLocation(a,"uTexture");n.uniform1i(l,o[c]);var u=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,u),n.bufferData(n.ARRAY_BUFFER,new Float32Array(e),n.STATIC_DRAW);var d=n.createBuffer();n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,d),n.bufferData(n.ELEMENT_ARRAY_BUFFER,new Uint16Array(t),n.STATIC_DRAW);var h=n.getAttribLocation(a,"aPosition");n.enableVertexAttribArray(h),n.vertexAttribPointer(h,3,n.FLOAT,!1,0,0);var p=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,p),n.bufferData(n.ARRAY_BUFFER,new Float32Array(r),n.STATIC_DRAW);var f=n.getAttribLocation(a,"aTexCoordinate");n.enableVertexAttribArray(f),n.vertexAttribPointer(f,2,n.FLOAT,!1,0,0),n.bindFramebuffer(n.FRAMEBUFFER,i.blurBufferList[c]),n.clearColor(0,0,0,1),n.clear(n.COLOR_BUFFER_BIT),n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0),n.activeTexture(n.TEXTURE0+s[c]),n.bindTexture(n.TEXTURE_2D,i.blurTextureList[c])}}))},t.prototype.setConstUniforms=function(){var e=this.width,t=this.height,r=this.program;if(r){var i=this.gl;i.useProgram(r);var n=i.getUniformLocation(r,"widthOffset");i.uniform1f(n,1/e);var o=i.getUniformLocation(r,"heightOffset");i.uniform1f(o,1/t),this.uIntensity=i.getUniformLocation(r,"blurAlpha"),i.uniform1f(this.uIntensity,this.smoothIntensity);var s=i.getUniformLocation(r,"blurTexture");i.uniform1i(s,1);var a=i.getUniformLocation(r,"blurDiffTexture");i.uniform1i(a,2)}},t.prototype.setBorderBlurProgram=function(e,t,r){var i=this.gl;i.useProgram(e);var n=i.getUniformLocation(e,"texBlurWidthOffset");i.uniform1f(n,t);var o=i.getUniformLocation(e,"texBlurHeightOffset");i.uniform1f(o,r)},t.prototype.setDiffBlurProgram=function(e){var t=this.gl;t.useProgram(e);var r=t.getUniformLocation(e,"blurTexture");t.uniform1i(r,1)},t}(s.default);t.default=c},1199:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mixBlurFS=t.mixBlurVS=t.diffBlurFS=t.diffBlurVS=t.borderBlurFS=t.borderBlurVS=t.sharpnessFS=t.sharpnessVS=t.lightFS=t.lightVS=void 0,t.lightVS="cerpvfvba uvtuc sybng;\nnggevohgr irp2 nGrkPbbeqvangr;\nnggevohgr irp4 nCbfvgvba;\nhavsbez zng4 hCZIZngevk;\ninelvat irp2 iGrkPbbeq;\nibvq znva() {\n    ty_Cbfvgvba = hCZIZngevk * nCbfvgvba;\n    iGrkPbbeq = nGrkPbbeqvangr;\n}",t.lightFS="cerpvfvba uvtuc sybng;\ninelvat irp2 iGrkPbbeq;\nhavsbez fnzcyre2Q hGrkgher;\nhavsbez sybng vagrafvgl;\nhavsbez sybng ebflVagrafvgl;\nirp3 oevtugarffNaqPbagenfg(irp3 pbybe){\n  sybng v = vagrafvgl * 1.0;\n  sybng CV = 3.1415926;\n  sybng O = 0.12 * v;\n  sybng p = 0.1 * v;\n  sybng x = gna((45. + 44. * p) / 180.0 * CV);\n  pbybe = ((pbybe*255.0 - 127.5 * (1.0 - O)) * x + 127.5 * (1.0 + O)) / 255.0;\n  erghea pbybe;\n}\nibvq znva() {\n  irp4 grkgherPbybe = grkgher2Q(hGrkgher, iGrkPbbeq);\n  grkgherPbybe = irp4(oevtugarffNaqPbagenfg(grkgherPbybe.eto), grkgherPbybe.j);\n  grkgherPbybe.e = zva(grkgherPbybe.e + 0.06 * ebflVagrafvgl, 1.0);\n  ty_SentPbybe = grkgherPbybe;\n}",t.sharpnessVS="\nnggevohgr irp4 nCbfvgvba;\nnggevohgr irp4 nGrkPbbeqvangr;\nhavsbez sybng vzntrJvqguSnpgbe;\nhavsbez sybng vzntrUrvtugSnpgbe;\nhavsbez sybng funecarff; \ninelvat irp2 iGrkPbbeq;\ninelvat irp2 yrsgGrkgherPbbeqvangr;\ninelvat irp2 evtugGrkgherPbbeqvangr;\ninelvat irp2 gbcGrkgherPbbeqvangr;\ninelvat irp2 obggbzGrkgherPbbeqvangr;\ninelvat sybng pragreZhygvcyvre;\ninelvat sybng rqtrZhygvcyvre;\nibvq znva() {\n  ty_Cbfvgvba = nCbfvgvba;\n  irp2 jvqguFgrc = irp2(vzntrJvqguSnpgbe, 0.0);\n  irp2 urvtugFgrc = irp2(0.0, vzntrUrvtugSnpgbe);\n  iGrkPbbeq = nGrkPbbeqvangr.kl;\n  yrsgGrkgherPbbeqvangr = nGrkPbbeqvangr.kl - jvqguFgrc;\n  evtugGrkgherPbbeqvangr = nGrkPbbeqvangr.kl + jvqguFgrc;\n  gbcGrkgherPbbeqvangr = nGrkPbbeqvangr.kl + urvtugFgrc;\n  obggbzGrkgherPbbeqvangr = nGrkPbbeqvangr.kl - urvtugFgrc;\n  pragreZhygvcyvre = 1.0 + 4.0 * funecarff;\n  rqtrZhygvcyvre = funecarff;\n}\n",t.sharpnessFS="\ncerpvfvba uvtuc sybng;\ninelvat uvtuc irp2 iGrkPbbeq;\ninelvat uvtuc irp2 yrsgGrkgherPbbeqvangr;\ninelvat uvtuc irp2 evtugGrkgherPbbeqvangr;\ninelvat uvtuc irp2 gbcGrkgherPbbeqvangr;\ninelvat uvtuc irp2 obggbzGrkgherPbbeqvangr;\ninelvat uvtuc sybng pragreZhygvcyvre;\ninelvat uvtuc sybng rqtrZhygvcyvre;\nhavsbez fnzcyre2Q hGrkgher;\nibvq znva() {\n  zrqvhzc irp4 nPbybe = grkgher2Q(hGrkgher, iGrkPbbeq);\n  zrqvhzc irp3 grkgherPbybe = nPbybe.eto;\n  zrqvhzc irp3 yrsgGrkgherPbybe = grkgher2Q(hGrkgher, yrsgGrkgherPbbeqvangr).eto;\n  zrqvhzc irp3 evtugGrkgherPbybe = grkgher2Q(hGrkgher, evtugGrkgherPbbeqvangr).eto;\n  zrqvhzc irp3 gbcGrkgherPbybe = grkgher2Q(hGrkgher, gbcGrkgherPbbeqvangr).eto;\n  zrqvhzc irp3 obggbzGrkgherPbybe = grkgher2Q(hGrkgher, obggbzGrkgherPbbeqvangr).eto;\n  ty_SentPbybe = irp4((grkgherPbybe * pragreZhygvcyvre - (yrsgGrkgherPbybe * rqtrZhygvcyvre + evtugGrkgherPbybe * rqtrZhygvcyvre + gbcGrkgherPbybe * rqtrZhygvcyvre + obggbzGrkgherPbybe * rqtrZhygvcyvre)), nPbybe.n);\n}",t.borderBlurVS="nggevohgr irp4 nCbfvgvba;\nnggevohgr irp4 nGrkPbbeqvangr;\nhavsbez uvtuc sybng grkOyheJvqguBssfrg;\nhavsbez uvtuc sybng grkOyheUrvtugBssfrg;\ninelvat irp2 i_grkpbbeq0;\ninelvat irp4 grkgherFuvsg_1;\ninelvat irp4 grkgherFuvsg_2;\ninelvat irp4 grkgherFuvsg_3;\ninelvat irp4 grkgherFuvsg_4;\nibvq znva()\n{\n  ty_Cbfvgvba = nCbfvgvba;\n  i_grkpbbeq0 = nGrkPbbeqvangr.kl;\n\n  irp2 fvatyrFgrcBssfrg = irp2(grkOyheJvqguBssfrg, grkOyheUrvtugBssfrg)*2.5;\n\n  grkgherFuvsg_1 = irp4(nGrkPbbeqvangr.kl - fvatyrFgrcBssfrg, nGrkPbbeqvangr.kl + fvatyrFgrcBssfrg);\n  grkgherFuvsg_2 = irp4(nGrkPbbeqvangr.kl - 2.0 * fvatyrFgrcBssfrg, nGrkPbbeqvangr.kl + 2.0 * fvatyrFgrcBssfrg);\n  grkgherFuvsg_3 = irp4(nGrkPbbeqvangr.kl - 3.0 * fvatyrFgrcBssfrg, nGrkPbbeqvangr.kl + 3.0 * fvatyrFgrcBssfrg);\n  grkgherFuvsg_4 = irp4(nGrkPbbeqvangr.kl - 4.0 * fvatyrFgrcBssfrg, nGrkPbbeqvangr.kl + 4.0 * fvatyrFgrcBssfrg);\n}",t.borderBlurFS="cerpvfvba zrqvhzc sybng;\nhavsbez fnzcyre2Q hGrkgher;\ninelvat irp2 i_grkpbbeq0;\ninelvat uvtuc irp4 grkgherFuvsg_1;\ninelvat uvtuc irp4 grkgherFuvsg_2;\ninelvat uvtuc irp4 grkgherFuvsg_3;\ninelvat uvtuc irp4 grkgherFuvsg_4;\nibvq znva(ibvq) { \n  zrqvhzc irp3 fhz = grkgher2Q(hGrkgher, i_grkpbbeq0).eto;\n  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_1.kl).eto;\n  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_1.mj).eto;\n  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_2.kl).eto;\n  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_2.mj).eto;\n  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_3.kl).eto;\n  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_3.mj).eto;\n  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_4.kl).eto;\n  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_4.mj).eto;\n  ty_SentPbybe = irp4(fhz * 0.1111, 1.0); \n}",t.diffBlurVS="nggevohgr irp4 nCbfvgvba;\nnggevohgr irp4 nGrkPbbeqvangr;\nhavsbez zng4 hCZIZngevk;\ninelvat irp2 i_grkpbbeq0;\nibvq znva()\n{\n  // ty_Cbfvgvba = hCZIZngevk * nCbfvgvba;\n  ty_Cbfvgvba = nCbfvgvba;\n  i_grkpbbeq0 = nGrkPbbeqvangr.kl;\n}",t.diffBlurFS="cerpvfvba zrqvhzc sybng;\nhavsbez fnzcyre2Q hGrkgher;\ninelvat irp2 i_grkpbbeq0;\nhavsbez fnzcyre2Q oyheGrkgher;\nibvq znva(ibvq) {\n  irp4 vPbybe = grkgher2Q(oyheGrkgher, i_grkpbbeq0);\n  irp4 zrnaPbybe = grkgher2Q(hGrkgher, i_grkpbbeq0);\n  irp4 qvssPbybe = vPbybe - zrnaPbybe;\n  qvssPbybe.e = zva(qvssPbybe.e * 50.0 * qvssPbybe.e, 1.0);\n  qvssPbybe.t = zva(qvssPbybe.t * 50.0 * qvssPbybe.t, 1.0);\n  qvssPbybe.o = zva(qvssPbybe.o * 50.0 * qvssPbybe.o, 1.0);\n  ty_SentPbybe = irp4(qvssPbybe.eto, 1.0);\n}",t.mixBlurVS="\nnggevohgr irp4 nCbfvgvba;\nnggevohgr irp4 nGrkPbbeqvangr;\ninelvat irp2 i_grkpbbeq0;\nhavsbez sybng jvqguBssfrg;\nhavsbez sybng urvtugBssfrg;\ninelvat irp2 grkgherFuvsg_1;\ninelvat irp2 grkgherFuvsg_2;\ninelvat irp2 grkgherFuvsg_3;\ninelvat irp2 grkgherFuvsg_4;\nibvq znva()\n{\n  ty_Cbfvgvba = nCbfvgvba;\n  i_grkpbbeq0 = nGrkPbbeqvangr.kl;\n  grkgherFuvsg_1 = irp2(i_grkpbbeq0 + 0.5 * irp2(jvqguBssfrg,urvtugBssfrg));\n  grkgherFuvsg_2 = irp2(i_grkpbbeq0 + 0.5 * irp2(-jvqguBssfrg,-urvtugBssfrg));\n  grkgherFuvsg_3 = irp2(i_grkpbbeq0 + 0.5 * irp2(-jvqguBssfrg,urvtugBssfrg));\n  grkgherFuvsg_4 = irp2(i_grkpbbeq0 + 0.5 * irp2(jvqguBssfrg,-urvtugBssfrg));\n}\n",t.mixBlurFS="\ncerpvfvba zrqvhzc sybng;\nhavsbez fnzcyre2Q hGrkgher;\ninelvat irp2 i_grkpbbeq0;\nhavsbez fnzcyre2Q oyheGrkgher;\nhavsbez fnzcyre2Q oyheQvssGrkgher;\nhavsbez ybjc sybng oyheNycun;\nibvq znva(ibvq) {\n  ybjc irp4 vPbybe = grkgher2Q(hGrkgher, i_grkpbbeq0);\n  ybjc irp4 zrnaPbybe = grkgher2Q(oyheGrkgher, i_grkpbbeq0);\n  ybjc irp4 inePbybe = grkgher2Q(oyheQvssGrkgher, i_grkpbbeq0);\n  ybjc sybng nycun = oyheNycun * 1.0;\n  ybjc sybng gurgn = 0.1;\n  zrqvhzc sybng c = pynzc((zva(vPbybe.e, zrnaPbybe.e - 0.1) - 0.2) * 4.0, 0.0, 1.0);\n  zrqvhzc sybng zrnaIne = znk(znk(inePbybe.e, inePbybe.t), inePbybe.o);\n  zrqvhzc sybng xZva = 0.1;\n  ybjc irp3 erfhygPbybe;\n  xZva = (1.0 - zrnaIne / (zrnaIne + gurgn)) * c * nycun;\n  erfhygPbybe = zvk(vPbybe.eto, zrnaPbybe.eto, xZva);\n  erfhygPbybe = zvk(vPbybe.eto, erfhygPbybe, zva(1.0,nycun));\n  ty_SentPbybe = irp4(erfhygPbybe,1.0);\n}"},8302:function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(r(6976)),a=r(1199),c=function(e){function t(t,r,i){var n=e.call(this,t)||this;return n.width=r,n.height=i,n.type="SharpnessShader",n.uIntensity=null,n.sharpenIntensity=.5,n.program=n.makeProgram(a.sharpnessVS,a.sharpnessFS),n}return n(t,e),t.prototype.setEffectConfig=function(e){isNaN(e.sharpenIntensity)||(this.sharpenIntensity=e.sharpenIntensity/100)},t.prototype.render=function(){this.gl.uniform1f(this.uIntensity,.5*this.sharpenIntensity)},t.prototype.setConstUniforms=function(){var e=this.width,t=this.height,r=this.program;if(r){var i=this.gl;i.useProgram(r);var n=i.getUniformLocation(r,"imageWidthFactor");i.uniform1f(n,1/e);var o=i.getUniformLocation(r,"imageHeightFactor");i.uniform1f(o,1/t),this.uIntensity=i.getUniformLocation(r,"sharpness"),i.uniform1f(this.uIntensity,.5*this.sharpenIntensity)}},t}(s.default);t.default=c},954:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PUBLISH_SET_BEAUTY_EFFECT=void 0;var s=o(r(836)),a=o(r(3048));t.PUBLISH_SET_BEAUTY_EFFECT="zc.p.0.sbe.1";var c=function(){function e(e,t){this.logger=e,this.kind="video",this._enabled=!1,this.lastRenderTime=0,this.animationFrameId=0,this.backgroundLoop=null,this.setInput(t,!0),this.fps=15,this.detector=new s.default(e),this.backgroundLoop&&clearTimeout(this.backgroundLoop),this.backgroundLoop=null,this.lastRenderTime=0,this.manager=new a.default(e)}return Object.defineProperty(e.prototype,"enabled",{get:function(){return this._enabled},set:function(e){this._enabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"output",{get:function(){return this._output},enumerable:!1,configurable:!0}),e.prototype.setBeautyEffectOptions=function(e,r){return void 0===r&&(r={}),i(this,void 0,void 0,(function(){return n(this,(function(i){switch(i.label){case 0:return e&&this.manager.setEffectConfig(r),this.enabled===e?[3,6]:(this.manager.setEnableBeauty(e),this.enabled!==e&&this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" effect enabled "+e+"; options: "+JSON.stringify(r)),this.enabled=e,e?this.input?[4,this.startEffect()]:[3,2]:[3,3]);case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return[4,this.stopEffect()];case 4:i.sent(),i.label=5;case 5:i.label=6;case 6:return[2]}}))}))},e.prototype.startEffect=function(){return i(this,void 0,void 0,(function(){var e,r,o=this;return n(this,(function(s){switch(s.label){case 0:return this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" call start effect"),this.input?this.input&&this.output&&this.input!==this.output?(this.logger.warn(t.PUBLISH_SET_BEAUTY_EFFECT+" video effect is already enabled"),[2]):[4,this.startWebGLProcessor()]:(this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" start effect failed, input track is null"),[2]);case 1:return e=s.sent(),[4,this.updateOutput(e)];case 2:return s.sent(),this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" start effect success"),this.detector.startRecordBeautyEffectOutput(this.fps).then((function(e){if(!e.result&&o.onOverload){var t=e.targetFPS,r=e.currentFPS;o.onOverload({targetFPS:t,currentFPS:r})}})),r=function(){return i(o,void 0,void 0,(function(){var e,t,i;return n(this,(function(n){switch(n.label){case 0:return this.enabled&&(this.animationFrameId=requestAnimationFrame(r)),e=Date.now(),t=1e3/this.fps,(i=this.lastRenderTime?e-this.lastRenderTime:t)>=t?(this.lastRenderTime=e-(i-t),this.videoEl&&this.videoEl.paused&&this.videoEl.play(),this.enabled&&this.videoEl?[4,this.manager.render(this.videoEl)]:[3,2]):[3,2];case 1:n.sent(),this.output&&this.output.requestFrame&&this.output.requestFrame(),this.detector.addFrame(),n.label=2;case 2:return[2]}}))}))},this.animationFrameId=requestAnimationFrame(r),document.addEventListener("visibilitychange",(function(){if(document.hidden){var e=function(){o.enabled&&o.videoEl&&o.manager.render(o.videoEl),o.output&&o.output.requestFrame&&o.output.requestFrame(),o.detector.addFrame(),o.backgroundLoop=window.setTimeout(e,Math.floor(1e3/o.fps))};e()}else o.backgroundLoop&&(clearTimeout(o.backgroundLoop),o.backgroundLoop=null)}),!1),[2]}}))}))},e.prototype.stopEffect=function(){return i(this,void 0,void 0,(function(){var e=this;return n(this,(function(r){switch(r.label){case 0:return this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" call stop effect"),this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=0),this.detector.stopRecordBeautyEffectOutput(),this.manager.release(),[4,this.updateOutput()];case 1:return r.sent(),void 0===this.removeDomTimer&&(this.removeDomTimer=window.setTimeout((function(){!1===e.enabled&&e.destroy()}),18e4)),[2]}}))}))},e.prototype.destroy=function(){this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" destroy hidden elements"),this.canvasEl&&this.canvasEl.remove(),this.videoEl&&this.videoEl.remove(),this.videoEl=this.canvasEl=void 0,this.removeDomTimer&&(clearTimeout(this.removeDomTimer),this.removeDomTimer=void 0)},e.prototype.startWebGLProcessor=function(){return i(this,void 0,void 0,(function(){var e,r,i,o,s=this;return n(this,(function(n){switch(n.label){case 0:return this.input?(this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" start webgl processor"),this.removeDomTimer&&(clearTimeout(this.removeDomTimer),this.removeDomTimer=void 0),this.canvasEl&&this.videoEl?[3,2]:(this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" create elements"),this.canvasEl&&(this.canvasEl.remove(),this.canvasEl=void 0),this.videoEl&&(this.videoEl.remove(),this.videoEl=void 0),this.canvasEl=document.createElement("canvas"),this.videoEl=document.createElement("video"),this.videoEl.setAttribute("autoplay",""),this.videoEl.setAttribute("muted",""),this.videoEl.muted=!0,this.videoEl.setAttribute("playsinline",""),this.videoEl.setAttribute("style","display:none"),this.videoEl.srcObject=new MediaStream([this.input]),e=new Promise((function(e){var t=function(){s.videoEl&&s.videoEl.removeEventListener("playing",t),e(void 0)};s.videoEl&&s.videoEl.addEventListener("playing",t)})),this.videoEl.play(),[4,e])):(this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" input track is null"),[2]);case 1:n.sent(),n.label=2;case 2:return r=this.input.getSettings(),i=r.width||this.videoEl.videoWidth,o=r.height||this.videoEl.videoHeight,r.frameRate&&(this.fps,r.frameRate),r.frameRate&&this.fps!==r.frameRate&&(this.fps=r.frameRate,this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" set target fps: "+this.fps)),this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" beauty video processor: width "+r.width+" height "+r.height),i&&o?(this.canvasEl.width=i,this.canvasEl.height=o,this.videoEl.setAttribute("width",i.toString()),this.videoEl.setAttribute("height",o.toString()),this.manager.init(i,o,this.canvasEl),[2,this.canvasEl.captureStream().getVideoTracks()[0]]):(this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" resolution of track is wrong"),[2])}}))}))},e.prototype.setInput=function(e,r){return void 0===r&&(r=!1),i(this,void 0,void 0,(function(){return n(this,(function(i){switch(i.label){case 0:return e===this.input?[3,6]:e.kind!==this.kind?(this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" kind of track is not video"),[2]):(this.output&&this.input===this.output&&this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" input track is same as effect track"),this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" change input track"),r?this.input?[4,this.removeInput()]:[3,2]:[3,5]);case 1:i.sent(),i.label=2;case 2:return this.input=e,this.enabled&&!this.videoEl?[4,this.startEffect()]:[3,4];case 3:i.sent(),i.label=4;case 4:return[3,6];case 5:this.input=e,this.videoEl&&(this.videoEl.srcObject=new MediaStream([this.input])),i.label=6;case 6:return[2]}}))}))},e.prototype.removeInput=function(){return i(this,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return this.input=void 0,[4,this.stopEffect()];case 1:return e.sent(),[2]}}))}))},e.prototype.updateOutput=function(e){return i(this,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:return this.output===e?[3,3]:(this._output=e,this.onOutputChange?[4,this.onOutputChange(this._output)]:[3,2]);case 1:t.sent(),t.label=2;case 2:t.label=3;case 3:return[2]}}))}))},e.prototype.onOutputChange=function(e){return i(this,void 0,void 0,(function(){return n(this,(function(e){return[2]}))}))},e.prototype.onOverload=function(e){},e}();t.default=c},608:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ClientUtil=void 0;var o=r(6706),s=r(3529),a=r(4395),c=function(){function e(){}return e.checkIllegalCharacters=function(e){return/^([0-9a-zA-Z#!$%&()`'+-;<=.>@^_~,\\*])+$/.test(e)&&/^[^:/]*$/g.test(e)},e.isUrl=function(e){return!!(e.startsWith("rtmp://")||e.startsWith("https://")&&e.endsWith(".flv")||e.startsWith("https://")&&e.endsWith(".m3u8"))},e.registerCallback=function(e,t,r){var i,n;t.success&&(i=t.success,r[e+"SuccessCallback"]=i),t.error&&(n=t.error,r[e+"ErrorCallback"]=n)},e.actionErrorCallback=function(e,t){return t[e+"ErrorCallback"]},e.actionSuccessCallback=function(e,t){return t[e+"SuccessCallback"]},e.logReportCallback=function(t,r,i,n){e.registerCallback(t,{success:function(t,n){for(var o=[],s=2;s<arguments.length;s++)o[s-2]=arguments[s];e.dataReportEvent(r,i,t,n,o)}},n)},e.actionLogReportCallback=function(t,r,i,n,o){e.actionSuccessCallback(t,r)&&e.actionSuccessCallback(t,r)(i,n)},e.getServerError=function(e){var t={1:"parse json error.",1001:"login is processing.",1002:"liveroom request error.",1003:"zpush connect fail.",1004:"zpush handshake fail.",1005:"zpush login fail.",1006:"user login state is wrong.",1007:"got no zpush addr",1008:"token error",1009:"dispatch error",1010:"token expired",1011:"token format error",2002:"biz channel error",1e9:"liveroom cmd error, code:",1000002001:"need relogin",1000002002:"third token auth error",1000002003:"token nonce type should be int64",1000002004:"token appid type  should be uint32",1000002005:"token timeout type should be int64",1000002006:"token user_id type should be string",1000002007:"token room_id type should be string",1000002008:"token format error",1000002009:"token privilege type should be map",1000002010:"token expire_time type should be int64",1000002011:"token user_id type should be string",1000002012:"token not exist",1000002013:"token update error",1000002014:"token not need to check"};if(0===e)return{code:0,message:""};var r={code:0,message:"liveroom cmd error"};if(r.code=e,e>1e9){var i=t[e];r.message=i?"liveroom cmd error, code: "+e+", message: "+i:t[1e9]+e}else r.message=t[e]?t[e]+" code:"+e:"unknown error code:"+e;return r},e.unregisterCallback=function(e,t){delete t[e+"SuccessCallback"],delete t[e+"ErrorCallback"]},e.decodeServerError=function(e,t){var r={code:-1,message:"server error"};return e>1e9&&(r.code=e-1e9+52e6),t&&(r.message=t),r},e.getLiveRoomError=function(e){return e>1e9?{1105:"ROOM_MAX_USER_COUNT",1012:"PUBLISHER_ERROR_REPETITIVE_PUBLISH_STREAM",2002:"TOKEN_ERROR",2003:"ROOM_ERROR_LOGIN_TIMEOUT",2010:"TOKEN_ERROR"}[e-1e9]||"":{1:"PARSE_JSON_ERROR",1001:"LOGIN_PROCESSING",1002:"LIVEROMM_REQUEST_ERROR",1003:"ZPUSH_REQUEST_FAIL",1004:"ZPUSH_REQUEST_FAIL",1005:"ZPUSH_REQUEST_FAIL",1006:"LOGIN_STATE_WRONG",1007:"ZPUSH_REQUEST_FAIL",1008:"TOKEN_ERROR",1009:"DIAPATCH_ERROR",1010:"TOKEN_EXPIRED",1011:"TOKEN_ERROR",1012:"SUBCMD_ERROR",1101:"ZEGO_AUTH_ERROR",2001:"BIZ_CHANNEL_ERROR",2002:"BIZ_CHANNEL_ERROR"}[e]||"ROOM_INNER_ERROR"},e.getKickoutError=function(e){var t={};switch(e){case 1:t.code=63000001,t.message="zpush multiple login kickout",t.name="MULTIPLE_LOGIN_KICKOUT";break;case 2:t.code=63000002,t.message="zpush manual kickout",t.name="MANUAL_KICKOUT";break;case 3:t.code=63000003,t.message="kickout reason = "+e;break;case 4:t.code=63000004,t.message="zpush multiple login kickout",t.name="MULTIPLE_LOGIN_KICKOUT";break;case 5:t.code=63000005,t.message="zpush token expired",t.name="TOKEN_EXPIRED";break;default:t.code=e,t.message="kickout reason = "+e}return t},e.dataReportEvent=function(e,t,r,i,n){switch(r){case"eventStart":e.eventStart(t,i);break;case"eventEndWithMsgInfo":e.eventEndWithMsgInfo(t,i,n[0]);break;case"addEventMsg":e.addEventMsg(t,i,n[0],n[1]);break;case"addEvent":e.addEvent(t,i);break;case"eventEnd":e.eventEnd(t,i);break;case"addMsgInfo":e.addMsgInfo(t,n[0])}},e.isKeepTryLogin=function(e){switch(e){case 1002:case 1003:return!0;default:return!1}},e.mergeStreamList=function(e,t,r,i){var n,o=[],s=[],a=[];r||(r=[]);for(var c=0;c<r.length;c++)if(r[c].anchor_id_name!=e&&r[c].user_id!=e){n=!1;for(var l=0;l<t.length;l++)if(r[c].stream_id===t[l].stream_id){r[c].extra_info!==t[l].extra_info&&a.push(r[c]),n=!0;break}n||o.push(r[c])}for(var u=0;u<t.length;u++){n=!1;for(var d=0;d<r.length;d++)if(t[u].stream_id===r[d].stream_id){n=!0;break}n||s.push(t[u])}for(t.splice(0),c=0;c<r.length;c++)t.push(r[c]);i(o,s,a)},e.checkInteger=function(e,t){return 0==t?"number"==typeof e&&e%1==0&&e>=0:"number"==typeof e&&e%1==0&&e>0},e.checkValidNumber=function(e,t,r){return t=t||1,r=r||1e4,"number"==typeof e&&e%1==0&&e>=t&&e<=r},e.uuid=function(e,t){var r,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=[];if(t=t||i.length,e)for(r=0;r<e;r++)n[r]=i[0|Math.random()*t];else{var o=void 0;for(n[8]=n[13]=n[18]=n[23]="-",n[14]="4",r=0;r<36;r++)n[r]||(o=0|16*Math.random(),n[r]=i[19==r?3&o|8:o])}return n.join("")},e.supportDetection=function(e,t,r,o){return i(this,void 0,void 0,(function(){var i,s,a,c,l,u,d,h;return n(this,(function(n){switch(n.label){case 0:return i={webRTC:!1,customCapture:!1,camera:!1,microphone:!1,videoCodec:{H264:!1,H265:!1,VP8:!1,VP9:!1},screenSharing:e,errInfo:{}},o&&"screenSharing"===o?(t({result:e,errInfo:i.errInfo}),[2]):o&&"customCapture"!==o||(((s=document.createElement("video")).captureStream||s.mozCaptureStream)&&(i.customCapture=!0),"customCapture"!==o)?(a=navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,c="https:"!==window.location.protocol&&"file:"!==window.location.protocol&&-1==window.location.hostname.indexOf("127.0.0.1")&&-1==window.location.hostname.indexOf("localhost"),o&&"camera"!==o&&"microphone"!==o?[3,9]:a?c?(i.camera=!1,console.error("webrtc requires https or localhost"),[3,9]):[3,1]:[3,9]):(t({result:i.customCapture,errInfo:i.errInfo}),[2]);case 1:if(o&&"camera"!==o)return[3,5];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,navigator.mediaDevices.getUserMedia({video:!0})];case 3:return(l=n.sent())&&(i.camera=!0)&&l.getTracks().forEach((function(e){return e.stop()})),[3,5];case 4:return u=n.sent(),i.errInfo.camera={name:u.name,message:u.message},console.error("camera devices detect error: ",u.name,u.message),[3,5];case 5:if(o&&"microphone"!==o)return[3,9];n.label=6;case 6:return n.trys.push([6,8,,9]),[4,navigator.mediaDevices.getUserMedia({audio:!0})];case 7:return(d=n.sent())&&(i.microphone=!0)&&d.getTracks().forEach((function(e){return e.stop()})),[3,9];case 8:return h=n.sent(),i.errInfo.microphone={name:h.name,message:h.message},console.error("microphone devices detect error: ",h.name,h.message),[3,9];case 9:return"camera"===o||"microphone"===o?(t({result:i[o],errInfo:i.errInfo}),[2]):(this.supportVideoCodeType((function(e,r){o||(i.videoCodec.H264=e.H264,i.videoCodec.H265=e.H265,i.videoCodec.VP8=e.VP8,i.videoCodec.VP9=e.VP9,i.webRTC=e.webRTC),r&&("string"==typeof r?i.errInfo.extendedDate=r:i.errInfo.webRTC={name:r.name,message:r.message},console.error("videoCodec detect error: "+r)),t&&t(o?{result:e[o],errInfo:i.errInfo}:i)}),r,o),[2])}}))}))},e.getDevices=function(e,t){void 0!==navigator.mediaDevices&&void 0!==navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then((function(t){for(var r=[],i=[],n=[],o=0;o<t.length;o++){var s=t[o];"audioinput"===s.kind&&r.push({deviceName:s.label,deviceID:s.deviceId}),"audiooutput"===s.kind&&i.push({deviceName:s.label,deviceID:s.deviceId}),"videoinput"===s.kind&&n.push({deviceName:s.label,deviceID:s.deviceId})}e&&e({microphones:r,speakers:i,cameras:n})})).catch((function(e){console.error("enumerate devices wrong "+e),t&&t(s.ZegoRTCLogEvent.kZegoTaskEnumDevices.error.kEnumDevicesError)})):t&&t(s.ZegoRTCLogEvent.kZegoTaskEnumDevices.error.kBrowserNotSupportError)},e.compareVersion=function(e,t){e=e.split("."),t=t.split(".");for(var r=Math.max(e.length,t.length);e.length<r;)e.push("0");for(;t.length<r;)t.push("0");for(var i=0;i<r;i++){var n=parseInt(e[i]),o=parseInt(t[i]);if(n>o)return 1;if(n<o)return-1}return 0},e.isSupportLive=function(e,t){var r=wx.getSystemInfoSync().SDKVersion,i={code:0,msg:""};this.compareVersion(r,"1.7.0")<0&&(i={code:10001,msg:"当前微信版本过低，无法使用相关组件"},e&&e(i)),wx.getSetting({success:function(t){var r=t.authSetting;r["scope.camera"]&&r["scope.record"]||(i={code:10002,msg:"需要摄像头和录音功能的授权"}),e&&e(i)},fail:function(e){console.error("get setting error",e),t&&t(e)}})},e.supportVideoCodeType=function(e,t,r){return i(this,void 0,void 0,(function(){var i,o,s,c,l,u,d,h,p,f;return n(this,(function(n){switch(n.label){case 0:return i={webRTC:!1,H264:!1,VP8:!1,VP9:!1,H265:!1},r?1!==t||"VP8"!==r&&"H264"!==r?[3,2]:[4,(f=new a.CheckModule).checkSupportByType(r)]:[3,2];case 1:return"boolean"==typeof(o=n.sent())?(i[r]=o,[2,e(i)]):(i[r]=!1,[2,e(i,o)]);case 2:if("webRTC"!==r&&1!==t)return[3,7];n.label=3;case 3:return n.trys.push([3,5,,6]),[4,(new RTCPeerConnection).createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0})];case 4:return n.sent(),i.webRTC=!0,[3,6];case 5:return s=n.sent(),e&&e(i,s),[3,6];case 6:if("webRTC"===r)return[2,e(i)];n.label=7;case 7:if(1===t){for(c="",u=[],d=0,h=l=["VP8","H264"];d<h.length;d++)p=h[d],f=new a.CheckModule,u.push(f.checkSupportByType(p));return Promise.all(u).then((function(t){t.forEach((function(e,t){"boolean"==typeof e?i[l[t]]=!0:(i[l[t]]=!1,c=e)})),c?e(i,c):e(i)})),[2]}try{(new RTCPeerConnection).createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then((function(t){if(i.webRTC=!0,t&&t.sdp){var n=t.sdp.split("\r\n");if(i.H264=n.some((function(e){return e.startsWith("a=rtpmap:")&&e.indexOf("H264/")>-1})),"H264"===r)return e(i);if(i.VP8=n.some((function(e){return e.startsWith("a=rtpmap:")&&e.indexOf("VP8/")>-1})),"VP8"===r)return e(i);i.VP9=n.some((function(e){return e.startsWith("a=rtpmap:")&&e.indexOf("VP9/")>-1})),i.H265=n.some((function(e){return e.startsWith("a=rtpmap:")&&e.indexOf("H265/")>-1})),e&&e(i)}}))}catch(t){e&&e(i,t)}return[2]}}))}))},e.getPublisherStateType=function(e){return 0==e||1==e?0==e?"PUBLISHING":"NO_PUBLISH":"PUBLISH_REQUESTING"},e.getPlayerStateType=function(e){return 0==e||1==e?0==e?"PLAYING":"NO_PLAY":"PLAY_REQUESTING"},e.getSteamUpdateType=function(e){return 0==e?"DELETE":"ADD"},e.checkScreenParams=function(t,r){if("object"==typeof t&&void 0!==t.videoQuality&&!e.checkInteger(t.videoQuality))return r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," videoQuality must be integer number"),!1;if("object"==typeof t&&void 0!==t.sourceID&&"string"!=typeof t.sourceID)return r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," sourceID must be string"),!1;if("object"==typeof t&&4===t.videoQuality){if(void 0===t.bitRate)return r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," bitrate is required when videoQuality is 4"),!1;if(!e.checkInteger(t.bitRate))return r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," bitrate must be integer number"),!1;if(t.bitRate>10240)return r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," bitrate cannot greater than 10 Mbps"),!1;if(void 0===t.frameRate)return r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," frameRate is required when videoQuality is 4"),!1;if(!e.checkInteger(t.frameRate))return r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," frameRate must be integer number"),!1;if(void 0===t.width)return r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," width is required when videoQuality is 4"),!1;if(!e.checkInteger(t.width))return r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," width must be integer number"),!1;if(void 0===t.height)return r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," height is required when videoQuality is 4"),!1;if(!e.checkInteger(t.height))return r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," height must be integer number"),!1}return!0},e.checkCameraParams=function(t,r){return t.width&&e.checkValidNumber(t.width)?t.height&&e.checkValidNumber(t.height)?t.frameRate&&e.checkValidNumber(t.frameRate)?!(!t.bitRate||!e.checkValidNumber(t.bitRate))||(r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," bitrate must be integer number"),!1):(r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," frameRate must be integer number"),!1):(r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," height must be integer number"),!1):(r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," width must be integer number"),!1)},e.isParamEmpty=function(e){return null!=e&&""!==e},e.isTypeString=function(e){return"string"==typeof e},e.isTooLong=function(e,t){return!(e.length>=t)},e.isReDispatch=function(e){var t=e.message.match(/action:(\d+)/),r=t?Number(t[1]):NaN;return[s.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kTTLOverTimeError,s.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kClientIPChangedError,s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kTTLOverTimeError,s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kClientIPChangedError].includes(e)||[6].includes(r)},e.arrAvg=function(e,t,r){return e.push(t),e.length>r&&e.shift(),e.reduce((function(e,t){return e+t}))/e.length},e.getNetQuality=function(e,t,r){return void 0!==r?.15*this.calcQualityOfJitter(r)+.85*Math.min(this.calcQualityOfRtt(e),this.calcQualityOfLostRate(t,!1)):Math.min(this.calcQualityOfRtt(e),this.calcQualityOfLostRate(t,!0))},e.calcQualityOfRtt=function(e){return e<600?97-Math.pow(.09*e,1.1):18*Math.exp(.002*(600-e))},e.calcQualityOfJitter=function(e){return e<=50?98-Math.pow(e,1.15):o.QUALITY_CONSTANT.PoorMinQuality},e.calcQualityOfLostRate=function(e,t){if(t){var r=e;return r<=55?99-Math.pow(.8*r,1.18):o.QUALITY_CONSTANT.PoorMinQuality}var i=100*e;return i<=40?96-Math.pow(i,1.22):o.QUALITY_CONSTANT.PoorMinQuality},e.quality2QualityGrade=function(e){return o.QualityGrade.Unknown,e>=o.QUALITY_CONSTANT.ExcellentMinQuality?o.QualityGrade.Excellent:e>=o.QUALITY_CONSTANT.GoodMinQuality?o.QualityGrade.Good:e>=o.QUALITY_CONSTANT.MiddleMinQuality?o.QualityGrade.Middle:e>=o.QUALITY_CONSTANT.PoorMinQuality?o.QualityGrade.Poor:o.QualityGrade.Die},e}();t.ClientUtil=c},6502:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RetryHandler=void 0;var r=function(){function e(){this.RETRY_MAX_TIME=300,this.RETRY_START_TIME_INTERVAL=4,this.RETRY_CONTINUE_COUNT=2,this.RETRY_MAX_TIME_INTERVAL=32,this.retryStartTime=0,this.retryActiveCount=1,this.isOverTime=!1}return e.prototype.init=function(e,t,r,i){this.invalid(),this.stopMaxTime(),this.isOverTime=!1,"number"==typeof e&&e<3600&&(this.RETRY_MAX_TIME=e),"number"==typeof t&&(this.RETRY_START_TIME_INTERVAL=t),"number"==typeof r&&(this.RETRY_CONTINUE_COUNT=r),"number"==typeof i&&(this.RETRY_MAX_TIME_INTERVAL=i)},e.prototype.invalid=function(){this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=null,this.retryStartTime=0,this.retryActiveCount=1},e}();t.RetryHandler=r},4767:function(e,t){"use strict";var r=this&&this.__spreadArray||function(e,t){for(var r=0,i=t.length,n=e.length;r<i;r++,n++)e[n]=t[r];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.SdpUtil=void 0;var i=function(){function e(){}return e.zegoSdp=function(e){var t=e.split("\r\n"),i=[],n=[];t.forEach((function(e){var t=e.match(/a=rtpmap:(\d+)\s+((H264\/90000)|(opus\/48000\/2))/);t&&t[1]&&t[2]&&("H264/90000"===t[2]&&i.push(t[1]),"opus/48000/2"===t[2]&&n.push(t[1]))}));var o=[];return t.map((function(e){var t=!0,s=e.match(/((a=rtcp-fb:)|(a=rtpmap:)|(a=fmtp:))(\d+)/);if(s&&s[5]&&(r(r([],i),n).some((function(e){return e==s[5]}))||(t=!1)),e.indexOf("m=video")>-1){var a=e.split(" ");e=r([a[0],a[1],a[2]],i).join(" ")}else e.indexOf("m=audio")>-1&&(a=e.split(" "),e=r([a[0],a[1],a[2]],n).join(" "));t&&o.push(e)})),o.join("\r\n")},e.getSDPByVideDecodeType=function(e,t,i){var n={str:"",arr:[],obj:{H264:[],H265:[],VP8:[],VP9:[],OTHER:[]}};if(!e.includes("m=video"))return e;var o=/m=video.+/.exec(e)[0];o=o.match(/[\s|\d]+/g)[1].replace(" ",""),n.str=o,n.arr=n.str.split(" "),n.arr.forEach((function(t){var r=new RegExp("a=rtpmap:"+t+".+").exec(e)[0];r.includes("H264")?n.obj.H264.push(t):r.includes("H265")?n.obj.H265.push(t):r.includes("VP8")?n.obj.VP8.push(t):r.includes("VP9")?n.obj.VP9.push(t):n.obj.OTHER.push(t)})),n.obj.OTHER.forEach((function(t){var r=new RegExp("a=fmtp:"+t+".+apt=(\\d+)").exec(e),i=r&&r[1];i&&(n.obj.H264.includes(i)?n.obj.H264.push(t):n.obj.H265.includes(i)?n.obj.H265.push(t):n.obj.VP8.includes(i)?n.obj.VP8.push(t):n.obj.VP9.includes(i)&&n.obj.VP9.push(t))}));var s=[];if("VP9"===t?s=r(r(r([],n.obj.H265),n.obj.H264),n.obj.VP8):"VP8"===t?s=r(r(r([],n.obj.H265),n.obj.H264),n.obj.VP9):"H264"===t?s=r(r(r([],n.obj.H265),n.obj.VP8),n.obj.VP9):"H265"===t&&(s=r(r(r([],n.obj.VP8),n.obj.H264),n.obj.VP9)),i&&"H264"==t){var a=[];n.obj.H264.forEach((function(t){var r=new RegExp("a=fmtp:"+t+".+\\s\\n","g").exec(e);(null==r?void 0:r.find((function(e){return e.includes("profile-level-id=42e01f")})))||a.push(t)})),a.length==n.obj.H264.length&&(a=[]),s=s.concat(a)}return s.forEach((function(t){var r=n.arr.indexOf(t);n.arr.splice(r,1);var i=new RegExp("a=rtpmap:"+t+".+\\s\\n","g"),o=new RegExp("a=rtcp-fb:"+t+".+\\s\\n","g"),s=new RegExp("a=fmtp:"+t+".+\\s\\n","g");e=(e=(e=e.replace(i,"")).replace(o,"")).replace(s,"")})),e=e.replace(o,n.arr.join(" "))},e}();t.SdpUtil=i},5321:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoWebRTC=void 0;var s=r(6706),a=r(608),c=r(7325),l=r(1089),u=r(3529),d=r(908),h=r(3409),p=r(7560),f=r(1547),g=o(r(5515)),m=r(3770),_=r(4865),v=r(361),E=r(5019),A=r(9595),y=r(9595),S=function(){function e(e,t,r,i){var n=this;void 0===i&&(i=0),this.mediaEleSources=[],this.logger=e,this.dataReport=t,this.ac=new("undefined"!=typeof webkitAudioContext?webkitAudioContext:AudioContext),this.checkAudioContext(),this.stateCenter=new c.StateCenter(this.logger,this.dataReport),this.stateCenter.clientType="webrtc",this.stateCenter.type=2===i?"PRIVATE":"PUBLIC",this.RTM=r,this.streamCenter=new h.ZegoStreamCenterWeb(this.logger,this.stateCenter,this.dataReport,this.RTM,this.ac,this.mediaEleSources),this.rtcModules=new d.RTCModules(this.logger,this.dataReport,this.stateCenter,this.streamCenter,this.RTM,this.ac),this.stateCenter.getSeq=s.getSeq,this.stateCenter.getReportSeq=s.getReportSeq,this.stateCenter.networkState=navigator?navigator.onLine?s.ENUM_NETWORK_STATE.online:s.ENUM_NETWORK_STATE.offline:s.ENUM_NETWORK_STATE.online,this.stateCenter.browser=g.browserDetails.browser,this.stateCenter.settingConfig=new y.ZegoSettingConfig,this.RTM.cloudSetting.setEnvVariable("sdk_version",s.PROTO_VERSION),this.RTM.cloudSetting.getSettingCache(A.RTC).then((function(e){n.logger.info(l.ZEGO_WEBRTC_ACTION.CONSTRUCTOR+" streamConfig "+JSON.stringify(e));var t=s.getReportSeq();n.dataReport.newReport(t,u.ZegoRTCLogEvent.kZegoTaskCloudSettingCache.event),n.dataReport.addMsgInfo(t,{files:[{name:A.RTC,content:null==e?void 0:e.setting,versions:null==e?void 0:e.versions}]}),n.dataReport.uploadReport(t),n.stateCenter.settingConfig.setSetting(null==e?void 0:e.setting)})).catch((function(e){n.logger.warn(l.ZEGO_WEBRTC_ACTION.CONSTRUCTOR+" streamConfig "+JSON.stringify(e))}))}return e.prototype.checkAudioContext=function(){var e=this;if(this.ac&&"suspended"===this.ac.state){var t=function(){e.ac.resume(),window.removeEventListener("click",t),window.removeEventListener("touchstart",t)};window.addEventListener("click",t),window.addEventListener("touchstart",t)}},e.prototype.mutePublishStreamVideo=function(e,t,r){return!1},e.prototype.mutePublishStreamAudio=function(e,t){return!1},e.prototype.mutePlayStreamVideo=function(e,t){return new Promise((function(e,t){console.error("should install advanced module"),e(!1)}))},e.prototype.mutePlayStreamAudio=function(e,t){return new Promise((function(e,t){console.error("should install advanced module"),e(!1)}))},e.prototype.muteMicrophone=function(e){return!1},e.prototype.isMicrophoneMuted=function(){return!this.streamCenter.isMicEnabled},e.prototype.setAudioOutput=function(e,t){return this.logger.info(l.ZEGO_WEBRTC_ACTION.SET_AUDIO_OUTPUT+" call"),"string"!=typeof t?(this.logger.error("audiooutput is not string"),!1):this.rtcModules.playModule.setStreamAudioOutput(e,t)},e.prototype.setCustomSignalUrl=function(e){if(this.logger.info(l.ZEGO_WEBRTC_ACTION.SET_CUSTOM_SIGNAL_URL+" call: "+e),e&&0!=e.length){var t=!0;e.forEach((function(e){return 0!=e.indexOf("wss://")&&(t=!1)})),t?this.stateCenter.customUrl=e:this.logger.error(l.ZEGO_WEBRTC_ACTION.SET_CUSTOM_SIGNAL_URL+" url is not correct")}else this.logger.error(l.ZEGO_WEBRTC_ACTION.SET_CUSTOM_SIGNAL_URL+" param error")},e.prototype.setGWNode=function(e){"string"==typeof e&&e.length>0&&(this.streamCenter.gwNode=e)},e.prototype.setQualityMonitorCycle=function(e){return"number"==typeof e&&e>=1e3?(this.streamCenter.setQualityMonitorCycle(e),!0):(this.logger.error("zc.sqmc.0 time must be number and bigger than 1000"),!1)},e.prototype.startPlayingStream=function(e,t,r){return this.logger.info(l.ZEGO_WEBRTC_ACTION.START_PLAYING_STREAM+" call by user"),this.rtcModules.playModule.startPlayingStream(e,t,r)},e.prototype.stopPlayingStream=function(e){this.logger.info(l.ZEGO_WEBRTC_ACTION.STOP_PLAYING_STREAM+" call by user"),this.rtcModules.playModule.stopPlayingStream(e)},e.prototype.setTurnOverTcpOnly=function(e){this.logger.info(l.ZEGO_WEBRTC_ACTION.SET_TURN_OVER_TCP_ONLY+" call "+e),"boolean"==typeof e?this.stateCenter.turnOverTcpOnly=e:this.logger.error("zc.p.stoto.0 param must be param")},e.prototype.createStream=function(e){return this.rtcModules.publishModule.createStream(e)},e.prototype.destroyStream=function(e){this.rtcModules.publishModule.destroyStream(e)},e.prototype.startPublishingStream=function(e,t,r,i){return this.logger.info(l.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" call by user"),this.rtcModules.publishModule.startPublishingStream(e,t,r,i)},e.prototype.activateSEIInsert=function(e){return console.error("should install advanced module"),!1},e.prototype.stopPublishingStream=function(e){return this.logger.info(l.ZEGO_WEBRTC_ACTION.STOP_PUBLISHING_STREAM+" call by user"),this.rtcModules.publishModule.stopPublishingStream(e)},e.prototype.setVideoConfig=function(e,t){return this.rtcModules.advancedModule?this.rtcModules.advancedModule.setVideoConfig(e,t):new Promise((function(e,t){console.error("should install advanced module"),e({errorCode:-1,extendedData:"should install advanced module"})}))},e.prototype.setAudioConfig=function(e,t){return this.rtcModules.advancedModule?this.rtcModules.advancedModule.setAudioConfig(e,t):new Promise((function(e,t){console.error("should install advanced module"),e({errorCode:-1,extendedData:"should install advanced module"})}))},e.prototype.replaceTrack=function(e,t){return this.rtcModules.advancedModule?this.rtcModules.advancedModule.replaceTrack(e,t):new Promise((function(e,t){console.error("should install advanced module"),e({errorCode:-1,extendedData:"should install advanced module"})}))},e.prototype.preloadEffect=function(e,t,r){void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.preloadEffect(e,t,r):console.error("未引入混音模块")},e.prototype.playEffect=function(e,t,r){void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.playEffect(e,t,r):console.error("未引入混音模块")},e.prototype.pauseEffect=function(e,t){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.pauseEffect(e,t):(console.error("未引入混音模块"),!1)},e.prototype.resumeEffect=function(e,t){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.resumeEffect(e,t):(console.error("未引入混音模块"),!1)},e.prototype.stopEffect=function(e,t){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.stopEffect(e,t):(console.error("未引入混音模块"),!1)},e.prototype.unloadEffect=function(e){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.unloadEffect(e):(console.error("未引入混音模块"),!1)},e.prototype.setEffectVolume=function(e,t,r){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.setEffectVolume(e,t,r):(console.error("未引入混音模块"),!1)},e.prototype.startMixingAudio=function(e,t){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.startMixingAudio(e,t):(console.error("未引入混音模块"),!1)},e.prototype.stopMixingAudio=function(e,t){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.stopMixingAudio(e,t):(console.error("未引入混音模块"),!1)},e.prototype.mixingBuffer=function(e,t,r,i){void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.mixingBuffer(e,t,r,i):console.error("未引入混音模块")},e.prototype.stopMixingBuffer=function(e,t){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.stopMixingBuffer(e,t):(console.error("未引入混音模块"),!1)},e.prototype.setMixingAudioVolume=function(e,t,r){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.setMixingAudioVolume(e,t,r):(console.error("未引入混音模块"),!1)},e.prototype.checkSystemRequirements=function(t,r){var i=this,n=navigator&&navigator.mediaDevices&&(e.screenShotReady||"getDisplayMedia"in navigator.mediaDevices);return this.logger.info(l.ZEGO_WEBRTC_ACTION.CHECK_SUPPORT+" call"+navigator.userAgent),new Promise((function(e){var o=s.getReportSeq();i.dataReport.newReport(o,u.ZegoRTCLogEvent.kZegoTaskCheckSystemRequirements.event);var c=r||"all",l=function(t){i.dataReport.addMsgInfo(o,{capability:u.ZegoRTCLogEvent.kZegoTaskCheckSystemRequirements.capability(t)}),i.dataReport.uploadReport(o);var r=i.stateCenter.checkList.indexOf(c);i.stateCenter.checkList.splice(r,1),e(t)};return["webRTC","customCapture","camera","microphone","screenSharing","H264","VP8","all"].includes(c)&&[0,1].includes(t)?i.stateCenter.checkList.includes(c)||i.stateCenter.checkList.includes("all")?l({result:!1,errInfo:{extendedDate:"The last test of the same type has not returned a result "}}):(i.stateCenter.checkList.push(c),void a.ClientUtil.supportDetection(n,l,t,r)):l({result:!1,errInfo:{extendedDate:"param error"}})}))},e.prototype.enumDevices=function(){var e=this;return this.logger.info("zc.ed.0 call"),new Promise((function(t,r){var i=s.getReportSeq();e.dataReport.newReport(i,u.ZegoRTCLogEvent.kZegoTaskEnumDevices.event),e.rtcModules.publishModule.recordDevices((function(r){var n=[];r.cameras.forEach((function(e){return n.push({device:e.deviceName,type:0})})),r.microphones.forEach((function(e){return n.push({device:e.deviceName,type:1})})),r.speakers.forEach((function(e){return n.push({device:e.deviceName,type:2})})),e.dataReport.addMsgInfo(i,{dev_list:u.ZegoRTCLogEvent.kZegoTaskEnumDevices.dev_list(n)}),e.dataReport.uploadReport(i),t(r)}),(function(t){e.dataReport.addMsgInfo(i,t),e.dataReport.uploadReport(i),r(t)}))}))},e.prototype.getAudioInfo=function(e,t,r){},e.prototype.getSoundLevel=function(e,t,r){this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.getSoundLevel(e,t,r):console.error("未引入混音模块")},e.prototype.stopSoundLevel=function(e){this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.stopSoundLevel(e):console.error("未引入混音模块")},e.handleDataAvailable=function(t){t.data&&t.data.size>0&&e.recordedBlobs.push(t.data)},e.prototype.startRecord=function(e){},e.prototype.stopRecord=function(){},e.prototype.resumeRecord=function(){},e.prototype.pauseRecord=function(){},e.prototype.saveRecord=function(e){},e.prototype.takeSnapShot=function(e,t){},e.prototype.saveSnapShot=function(e,t){},e.prototype.useVideoDevice=function(e,t){return this.rtcModules.advancedModule?this.rtcModules.advancedModule.useVideoDevice(e,t):new Promise((function(e,t){e({errorCode:-1,extendedData:"should install advanced module"})}))},e.prototype.useAudioDevice=function(e,t){return this.rtcModules.advancedModule?this.rtcModules.advancedModule.useAudioDevice(e,t):(console.error("should use advanced module first"),new Promise((function(e,t){e({errorCode:-1,extendedData:"should install advanced module"})})))},e.prototype.getElectronScreenSources=function(){return this.rtcModules.publishModule.getElectronScreenSources()},e.prototype.setSoundLevelDelegate=function(e,t){this.logger.info("zc.ssd.0 call"),"boolean"==typeof e?t&&(!this.stateCenter.checkInteger(t)||t<100||t>3e3)?this.logger.error("zc.ssd.0 soundLevel interval must be integer number which is between 100 and 3000"):this.streamCenter.setSoundLevelDelegate(e,t):this.logger.error("zc.ssd.0 param 1 must be boolean")},e.prototype.on=function(e,t){return this.rtcModules.bindListener(e,t)},e.prototype.off=function(e,t){return this.rtcModules.deleteListener(e,t)},e.prototype.getVersion=function(){return s.PROTO_VERSION},e.prototype.setStreamExtraInfo=function(e,t){return new Promise((function(e,t){console.error("should use advanced module first"),t()}))},e.prototype.addPublishCdnUrl=function(e,t){return this.logger.info("zg.cm.apu call ",e,t),this.rtcModules.advancedModule?this.rtcModules.advancedModule.publishTarget({type:"addpush",streamID:e,pushUrl:t}):new Promise((function(e,t){console.error("should install advanced module"),e({errorCode:-1,extendedData:"should install advanced module"})}))},e.prototype.removePublishCdnUrl=function(e,t){return this.logger.info("zg.cm.apu call ",e,t),this.rtcModules.advancedModule?this.rtcModules.advancedModule.publishTarget({type:"delpush",streamID:e,pushUrl:t}):new Promise((function(e,t){console.error("should install advanced module"),e({errorCode:-1,extendedData:"should install advanced module"})}))},e.prototype.startMixerTask=function(e){return new Promise((function(e,t){console.error("未引入混流模块"),t()}))},e.prototype.setMixerTaskConfig=function(e){return new Promise((function(e,t){console.error("未引入混流模块"),t()}))},e.prototype.stopMixerTask=function(e){return new Promise((function(e,t){console.error("未引入混流模块"),t()}))},e.prototype.setCaptureVolume=function(e,t){return this.rtcModules.publishModule.setCaptureVolume(e,t)},e.prototype.getRoomInfo=function(){var e=this.stateCenter.roomList[0];return null==e?void 0:e.streamHandler.getRoomInfo()},e.use=function(t){switch(t.type){case"AudioMix":t.install(d.RTCModules,f.ZegoPublish);break;case"MixStream":t.install(e,p.StreamHandler,d.RTCModules);break;case"Advance":t.install(e,d.RTCModules,p.StreamHandler,m.ZegoPreview,_.PlayModule,v.PublishModule,f.ZegoPublish,E.ZegoSignal);break;case"BeautyEffect":t.install(m.ZegoPreview);break;case"RangeAudio":case"DataChannel":t.install(e)}},e.prototype.createRangeAudioInstance=function(){throw new Error("should use range audio module")},e.prototype.createRealTimeSequentialDataManager=function(e){throw new Error("should use datachannel module")},e.prototype.destroyRealTimeSequentialDataManager=function(e){throw new Error("should use datachannel module")},e.prototype.enableDataChannel=function(e){"boolean"==typeof e&&(this.streamCenter.isDataChannelEnabled=e)},e.prototype.addTrack=function(e,t){return new Promise((function(e,t){throw new Error("use advanced module first")}))},e.prototype.removeTrack=function(e,t){return new Promise((function(e,t){throw new Error("use advanced module first")}))},e.prototype.setBeautyEffect=function(e,t,r){return this.rtcModules.advancedModule?this.rtcModules.advancedModule.setBeautyEffect(e,t,r):new Promise((function(e,t){console.error("should install advanced module"),e({errorCode:-1,extendedData:"should install advanced module"})}))},e.screenShotReady=!1,e}();t.ZegoWebRTC=S,window.addEventListener("message",(function(e){var t=e.data.type,r=e.origin;r!==window.location.origin&&console.warn("ScreenStream: you should discard foreign event from origin:",r),"SS_PING"===t&&(S.screenShotReady=!0)}))},4395:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.CheckModule=void 0;var o=r(4767),s=function(){function e(){var e=this;this.iceconnectionstatechangeTimes=0,this.isCheckAll=!1;var t=document.createElement("canvas");t.getContext("2d").fillStyle="rgba(255, 255, 255, 0)";try{this.localStream=t.captureStream()}catch(e){console.error("canvas captureStream error",e)}this.timer=setTimeout((function(){e.resolve("Detection timeout"),e.hangup()}),5e3)}return e.prototype.checkSupportByType=function(e){return i(this,void 0,void 0,(function(){var t,r,i=this;return n(this,(function(n){switch(n.label){case 0:return this.checkType=e,t={},this.localPc=new RTCPeerConnection(t),this.remotePc=new RTCPeerConnection(t),r=new Promise((function(e){return i.resolve=e})),this.localPc.addEventListener("icecandidate",(function(e){return i.onIceCandidate(i.localPc,e)})),this.remotePc.addEventListener("icecandidate",(function(e){return i.onIceCandidate(i.remotePc,e)})),this.remotePc.addEventListener("iceconnectionstatechange",(function(t){"connected"===i.remotePc.iceConnectionState&&(i.iceconnectionstatechangeResult=!0),2==++i.iceconnectionstatechangeTimes&&i.iceCandidate&&(clearTimeout(i.timer),"connected"===i.remotePc.iceConnectionState?i.resolve(!0):i.resolve("The browser does not support "+e+" format"),i.hangup())})),this.localStream.getTracks().forEach((function(e){return i.localPc.addTrack(e,i.localStream)})),[4,this.check(e)];case 1:return n.sent(),[4,r];case 2:return[2,n.sent()]}}))}))},e.prototype.check=function(e){return i(this,void 0,void 0,(function(){var t,r;return n(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.localPc.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0})];case 1:return(t=i.sent()).sdp=o.SdpUtil.getSDPByVideDecodeType(t.sdp,e),this.onCreateOfferSuccess(t),[3,3];case 2:return r=i.sent(),this.onCreateSessionDescriptionError(r),[3,3];case 3:return[2]}}))}))},e.prototype.onCreateOfferSuccess=function(e){return i(this,void 0,void 0,(function(){var t,r,i,o;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.localPc.setLocalDescription(e)];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),this.onSetSessionDescriptionError(t),[2];case 3:return n.trys.push([3,5,,6]),[4,this.remotePc.setRemoteDescription(e)];case 4:return n.sent(),[3,6];case 5:return r=n.sent(),this.onSetSessionDescriptionError(r),[2];case 6:return n.trys.push([6,9,,10]),[4,this.remotePc.createAnswer()];case 7:return i=n.sent(),[4,this.onCreateAnswerSuccess(i)];case 8:return n.sent(),[3,10];case 9:return o=n.sent(),this.onCreateSessionDescriptionError(o),[2];case 10:return[2]}}))}))},e.prototype.onCreateAnswerSuccess=function(e){return i(this,void 0,void 0,(function(){var t,r;return n(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.remotePc.setLocalDescription(e)];case 1:return i.sent(),[3,3];case 2:return t=i.sent(),this.onSetSessionDescriptionError(t),[2];case 3:return i.trys.push([3,5,,6]),[4,this.localPc.setRemoteDescription(e)];case 4:return i.sent(),[3,6];case 5:return r=i.sent(),this.onSetSessionDescriptionError(r),[2];case 6:return[2]}}))}))},e.prototype.onIceCandidate=function(e,t){return i(this,void 0,void 0,(function(){var r;return n(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.getOtherPc(e).addIceCandidate(t.candidate)];case 1:return i.sent(),[3,3];case 2:return r=i.sent(),console.error(this.checkType,this.getPcName(e)+" addIceCandidate error",r),clearTimeout(this.timer),this.hangup(),this.resolve(r),[3,3];case 3:return"remotePc"===this.getPcName(e)&&t.candidate&&(this.iceCandidate=!0),this.iceconnectionstatechangeResult&&"localPc"===this.getPcName(e)&&(clearTimeout(this.timer),this.hangup(),this.resolve(!0)),[2]}}))}))},e.prototype.getOtherPc=function(e){return e===this.localPc?this.remotePc:this.localPc},e.prototype.getPcName=function(e){return e===this.localPc?"localPc":"remotePc"},e.prototype.onCreateSessionDescriptionError=function(e){console.error("Failed to create session description: "+e.toString()),clearTimeout(this.timer),this.hangup(),this.resolve(e)},e.prototype.onSetSessionDescriptionError=function(e){console.error("Failed to set session description: "+e.toString()),clearTimeout(this.timer),this.hangup(),this.resolve(e)},e.prototype.hangup=function(){this.localPc.close(),this.remotePc.close(),this.iceconnectionstatechangeTimes=0,this.localStream.getTracks().forEach((function(e){return e.stop()}))},e}();t.CheckModule=s},8493:function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.RetryDispatchHandler=void 0;var o=r(6502),s=r(6706),a=r(1089),c=r(3529),l=r(2752),u=function(e){function t(t,r,i,n){var o=e.call(this)||this;return o.retryActiveCount=1,o.RETRY_MAX_TIME=90,o.logger=t,o.stateCenter=r,o.rtm=i,o.streamCenter=n,o}return n(t,e),t.prototype.initStream=function(e,t,r){this.streamID=e,this.playOption=t,this.isPublish=r},t.prototype.active=function(e){var t=this;if(this.logger.info(a.ZEGO_WEBRTC_ACTION.RDH_ACTIVE+" retry call "+this.streamID),this.stateCenter.networkState==s.ENUM_NETWORK_STATE.offline)return this.logger.info(a.ZEGO_WEBRTC_ACTION.RDH_ACTIVE+" network is broken, stop retry"),!1;if(this.retryTimer)return this.logger.info(a.ZEGO_WEBRTC_ACTION.RDH_ACTIVE+" has active, ignore"),!1;if(this.isOverTime)return this.logger.warn(a.ZEGO_WEBRTC_ACTION.RDH_ACTIVE+" retry over time, stop retry"),!1;if(!this.rtm.isLogin()){this.stopMaxTime(),this.invalid();var r=this.isPublish?this.streamCenter.publisherList[this.streamID]:this.streamCenter.playerList[this.streamID];r&&(r.isReDispatch=!0)}var i,n=this.retryActiveCount-1;if("PUBLIC"===this.stateCenter.type){var o=this.playOption&&2==this.playOption.resourceMode?1:0;i={stream_id:this.streamID,ptype:this.isPublish?"push":"pull",signals:this.streamCenter.getAllInUseUrl(),header_kvs:[{key:"grpc-metadata-push",value:this.playOption&&this.playOption.cdnUrl||""}],retry:n,center_ability:!0,dispatch_type:o}}else i={stream_id:this.streamID,dispatch_type:this.isPublish?1:2,stream_type:3,an_type:this.rtm.getAnType()};return this.retryTimer=setTimeout((function(){t.retryTimer&&clearTimeout(t.retryTimer),t.retryTimer=null,t.retryActiveCount++;var e=t.streamCenter.getRoomByStreamID(t.streamID),r=t.rtm.service.sendMessage("webrtc_url",i,(function(e,r){t.handleFetchWebRtcUrlRsp(e)}),(function(e,r){t.handleFetchWebRtcUrlRsp(e)}),void 0,{sessionID:null==e?void 0:e.sessionID,roomID:null==e?void 0:e.roomID,roomSessionID:null==e?void 0:e.roomSessionID});t.isPublish&&r?t.streamCenter.publisherList[t.streamID]&&(t.streamCenter.publisherList[t.streamID].seq=r):r&&t.streamCenter.playerList[t.streamID]&&(t.streamCenter.playerList[t.streamID].seq=r)}),"number"==typeof e?e:1e3*this.retryActiveInterval),this.logger.info(a.ZEGO_WEBRTC_ACTION.RDH_ACTIVE+" call success"),!0},t.prototype.startMaxTime=function(){var e=this;this.maxTimer||(this.maxTimer=setTimeout((function(){e.logger.warn(a.ZEGO_WEBRTC_ACTION.RDH_MAX_TIME+" "+e.streamID+" dispatch over max time "+e.RETRY_MAX_TIME+"s stop retry"),e.isOverTime=!0,e.invalid();var t=c.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayDispatchError;t.message=t.message+" try max limit",e.isPublish?e.streamCenter.onPublishStateUpdate(s.ENUM_PUBLISH_STATE_UPDATE.error,e.streamID,t):e.streamCenter.onPlayStateUpdate(s.ENUM_PLAY_STATE_UPDATE.error,e.streamID,t)}),1e3*this.RETRY_MAX_TIME))},t.prototype.stopMaxTime=function(){this.maxTimer&&clearTimeout(this.maxTimer),this.maxTimer=null},t.prototype.onactive=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.handleFetchWebRtcUrlRsp=function(e){if(e.code&&[l.errorCodeList.TIMEOUT.code].includes(e.code))this.active();else{if(e.code&&[l.errorCodeList.SOCKET_CLOSE.code].includes(e.code))return this.stopMaxTime(),this.invalid(),void(this.isPublish?this.streamCenter.publisherList[this.streamID].isReDispatch=!0:this.streamCenter.playerList[this.streamID].isReDispatch=!0);var t=e,r=t.body.stream_id,i=!1;if(this.isPublish&&(!this.streamCenter.publisherList[r]||t.header.seq!==this.streamCenter.publisherList[this.streamID].seq))return this.logger.warn(a.ZEGO_WEBRTC_ACTION.RDH_WEBRTC_URL_RSP+" seq is not match, ignore "+this.streamID),this.stopMaxTime(),void this.invalid();if(!(this.isPublish||this.streamCenter.playerList[this.streamID]&&t.header.seq===this.streamCenter.playerList[this.streamID].seq))return this.logger.warn(a.ZEGO_WEBRTC_ACTION.RDH_WEBRTC_URL_RSP+" seq is not match, ignore "+this.streamID),this.stopMaxTime(),void this.invalid();if("PUBLIC"===this.stateCenter.type){if(this.stateCenter.clientIP=t.body.clientip||"",0!==t.body.err_code&&2==t.body.need_action)return this.retryActiveInterval=t.body.action_delay/1e3||Math.floor(3*Math.random())+3,2==this.retryActiveCount&&((p=c.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayDispatchError).message=p.message+(t.body.err_code?" server error:"+t.body.err_code:""),"push"===t.body.ptype?this.streamCenter.onPublishStateUpdate(s.ENUM_PUBLISH_STATE_UPDATE.retry,r,p):this.streamCenter.onPlayStateUpdate(s.ENUM_PLAY_STATE_UPDATE.retry,r,p)),void this.active();if(0!==t.body.err_code&&1!==t.body.need_action&&![3102].includes(t.body.err_code))return this.retryActiveInterval=Math.floor(3*Math.random())+3,2==this.retryActiveCount&&((p=c.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayDispatchError).message=p.message+(t.body.err_code?" server error:"+t.body.err_code:""),"push"===t.body.ptype?this.streamCenter.onPublishStateUpdate(s.ENUM_PUBLISH_STATE_UPDATE.retry,r,p):this.streamCenter.onPlayStateUpdate(s.ENUM_PLAY_STATE_UPDATE.retry,r,p)),void this.active();if(this.stopMaxTime(),this.invalid(),t.body.urls&&Array.isArray(t.body.urls)&&t.body.urls.length>0?i=!0:this.logger.error(a.ZEGO_WEBRTC_ACTION.RDH_WEBRTC_URL_RSP+" signal url is empty"),"push"===t.body.ptype&&this.streamCenter.publisherList[r]){if(!i)return void this.streamCenter.onPublishStateUpdate(s.ENUM_PUBLISH_STATE_UPDATE.error,r,c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishDispatchError);var n=this.streamCenter.publisherList[r];this.stateCenter.publishStreamList[r]?(n.ttl=t.body.hosts_ttl?(new Date).getTime()+1e3*t.body.hosts_ttl:0,n.isCenterNode="boolean"==typeof t.body.is_center_node&&t.body.is_center_node,n.serverUrls=t.body.urls,this.streamCenter.startPublishingStream(r)):this.logger.error(a.ZEGO_WEBRTC_ACTION.RDH_WEBRTC_URL_RSP+" no streamid to publish")}else if("pull"==t.body.ptype&&this.streamCenter.playerList[r]){if(!i)return(p=c.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayDispatchError).message=p.message+(t.body.err_code?" server error:"+t.body.err_code:""),3102===t.body.err_code&&(p=c.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayUnsupportedResourceMode),void this.streamCenter.onPlayStateUpdate(s.ENUM_PLAY_STATE_UPDATE.error,r,p);(f=this.streamCenter.playerList[r]).ttl=t.body.hosts_ttl?(new Date).getTime()+1e3*t.body.hosts_ttl:0,f.isCenterNode="boolean"==typeof t.body.is_center_node&&t.body.is_center_node,f.serverUrls=t.body.urls,this.streamCenter.startPlayingStream(r,this.streamCenter.playSuccessCallBackList[r])}}else{this.stopMaxTime(),this.invalid();var o=[],u=t.body.stream_url_info&&t.body.stream_url_info.stream_url,d=t.body.stream_url_info&&t.body.stream_url_info.ip_infos,h=/^ws(s)?:\/\/(.*?)\//;if(t.body.stream_url_info&&u&&d?i=!0:this.logger.error(a.ZEGO_WEBRTC_ACTION.RDH_WEBRTC_URL_RSP+" signal url is empty"),d&&d.forEach((function(e){var t=e.ip_address+":"+e.port;o.push(u.replace(h.exec(u)[2],t))})),this.isPublish&&this.streamCenter.publisherList[r]){if(!i)return void this.streamCenter.onPublishStateUpdate(s.ENUM_PUBLISH_STATE_UPDATE.error,r,c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishDispatchError);n=this.streamCenter.publisherList[r],this.stateCenter.publishStreamList[r]?(n.serverUrls=o,this.streamCenter.startPublishingStream(r)):this.logger.error(a.ZEGO_WEBRTC_ACTION.RDH_WEBRTC_URL_RSP+" no streamid to publish")}else if(!this.isPublish&&this.streamCenter.playerList[r]){var p,f;if(!i)return(p=c.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayDispatchError).message=p.message+(t.body.err_code?" server error:"+t.body.err_code:""),void this.streamCenter.onPlayStateUpdate(s.ENUM_PLAY_STATE_UPDATE.error,r,p);(f=this.streamCenter.playerList[r]).serverUrls=o,this.streamCenter.startPlayingStream(r,this.streamCenter.playSuccessCallBackList[r])}}}},t}(o.RetryHandler);t.RetryDispatchHandler=u},6014:function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.RetryStreamHandler=void 0;var o=r(6706),s=r(6502),a=r(3529),c=r(1089),l=r(608),u=function(e){function t(t,r,i,n){var o=e.call(this)||this;return o.logger=t,o.stateCenter=r,o.streamCenter=i,o.isPublish=n,o.serverUrls=[],o}return n(t,e),t.prototype.initStream=function(e,t){this.streamID=e,this.serverUrls=t},t.prototype.activePublish=function(e){var t=this;if(this.logger.info("zc.tsh.a retry call "+this.streamID),this.stateCenter.networkState==o.ENUM_NETWORK_STATE.offline)return this.logger.info("zc.tsh.a network is broken, stop retry"),!1;if(this.retryTimer)return this.logger.info("zc.tsh.a has active, ignore"),!1;if(this.isOverTime)return this.logger.warn("zc.tsh.a retry over time, stop retry"),!1;if(1==this.retryActiveCount)this.retryActiveInterval=Math.floor(Math.random()*(1-this.RETRY_START_TIME_INTERVAL)+this.RETRY_START_TIME_INTERVAL);else{var r=Math.pow(2,Math.round(this.retryActiveCount/this.RETRY_CONTINUE_COUNT+1));this.retryActiveInterval=r>this.RETRY_MAX_TIME_INTERVAL?this.RETRY_MAX_TIME_INTERVAL:r}var i=this.streamCenter.publisherList[this.streamID].publisher,n=this.serverUrls,s=i.signal?i.signal.server:"";n.forEach((function(e,r){return r<=n.indexOf(s)&&t.serverUrls.push(e)})),n.splice(0,n.indexOf(s)+1);var a=this.serverUrls[this.retryActiveCount%this.serverUrls.length==0?this.serverUrls.length-1:this.retryActiveCount%this.serverUrls.length-1];return this.retryTimer=setTimeout((function(){t.logger.warn("zc.tsh.a stream "+t.streamID+" connect signal server "+a),t.retryTimer&&clearTimeout(t.retryTimer),t.retryTimer=null,t.retryActiveCount++,t.streamCenter.connectPublishServer(t.streamID,a)}),"number"==typeof e?e:1e3*this.retryActiveInterval),this.logger.info("zc.tsh.a call success"),!0},t.prototype.activePull=function(e,t){var r=this;if(this.logger.info("zc.tsh.a retry call "+this.streamID),t&&(this.playStreamSuccess=t),this.stateCenter.networkState==o.ENUM_NETWORK_STATE.offline)return this.logger.info("zc.tsh.a network is broken, stop retry"),!1;if(this.retryTimer)return this.logger.info("zc.tsh.a has active, ignore"),!1;if(this.isOverTime)return this.logger.warn("zc.tsh.a retry over time, stop retry"),!1;if(1==this.retryActiveCount)this.retryActiveInterval=Math.floor(Math.random()*(1-this.RETRY_START_TIME_INTERVAL)+this.RETRY_START_TIME_INTERVAL);else{var i=Math.pow(2,Math.round(this.retryActiveCount/this.RETRY_CONTINUE_COUNT+1));this.retryActiveInterval=i>this.RETRY_MAX_TIME_INTERVAL?this.RETRY_MAX_TIME_INTERVAL:i}var n=this.streamCenter.playerList[this.streamID].player,s=this.serverUrls,a=n.signal?n.signal.server:"";s.forEach((function(e,t){return t<=s.indexOf(a)&&r.serverUrls.push(e)})),s.splice(0,s.indexOf(a)+1);var c=this.serverUrls[this.retryActiveCount%this.serverUrls.length==0?this.serverUrls.length-1:this.retryActiveCount%this.serverUrls.length-1];return this.retryTimer=setTimeout((function(){r.logger.warn("zc.tsh.a stream "+r.streamID+" connect signal server "+c),r.retryTimer&&clearTimeout(r.retryTimer),r.retryTimer=null,r.retryActiveCount++,r.streamCenter.connectPlayServer(r.streamID,r.playStreamSuccess,c)}),"number"==typeof e?e:1e3*this.retryActiveInterval),this.logger.info("zc.tsh.a call success"),!0},t.prototype.startMaxTime=function(){var e=this;this.maxTimer||(this.maxTimer=setTimeout((function(){if(e.logger.warn(e.streamID+" over max time "+e.RETRY_MAX_TIME+"s, stop retry"),e.isOverTime=!0,e.invalid(),e.isPublish){if(!e.streamCenter.publisherList[e.streamID])return void e.logger.info("zc.tsh.smt streamID "+e.streamID+" publish no found");e.publishStateHandle(o.ENUM_PUBLISH_STATE_UPDATE.error,e.streamID,a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishRetryTimeoutError,!0)}else{if(!e.streamCenter.playerList[e.streamID])return void e.logger.info("zc.tsh.smt streamID "+e.streamID+" play no found");e.playStateHandle(o.ENUM_PLAY_STATE_UPDATE.error,e.streamID,a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayRetryTimeoutError,!0)}}),1e3*this.RETRY_MAX_TIME))},t.prototype.stopMaxTime=function(){this.maxTimer&&clearTimeout(this.maxTimer),this.maxTimer=null},t.prototype.onactive=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.retryNextSignal=function(e){if(this.stateCenter.networkState==o.ENUM_NETWORK_STATE.offline)return!0;if(this.isPublish){var t=this.streamCenter.publisherList[this.streamID];if(t.publisher.state==o.ENUM_PUBLISH_STATE.stop&&[a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSessionTimeoutError.code,a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishNegoTimeoutError.code].includes(e.code))return!0;if(t.isCenterNode&&t.publisher.signal&&t.publisher.signal.websocket&&1==t.publisher.signal.websocket.readyState)return!1;if(!t.isCenterNode&&[a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishSessionClosedError.code].includes(e.code)){var r=(i=e.message.match(/reason:(\d+)/))?i[1]:"";return!["26"].includes(r)}return!0}var i,n=this.streamCenter.playerList[this.streamID];return!(n.player.state!=o.ENUM_PLAY_STATE.stop||![a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kSessionTimeoutError.code,a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayNegoTimeoutError.code].includes(e.code))||!(n.isCenterNode&&n.player.signal&&n.player.signal.websocket&&1==n.player.signal.websocket.readyState)&&(!(!n.isCenterNode&&[a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlaySessionClosedError.code].includes(e.code))||(r=(i=e.message.match(/reason:(\d+)/))?i[1]:"",!["24","26","28"].includes(r)))},t.prototype.publishStateHandle=function(e,t,r,i){this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISH_STATE_HANDLE+" call "+t+" "+(r?r.code+"":""));var n=i||this.RETRY_MAX_TIME<3;if(!n&&r&&(l.ClientUtil.isReDispatch(r)||0==this.serverUrls.length))return this.stopMaxTime(),this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=null,void this.streamCenter.onPublishStateUpdate(e,t,r);var s=this.streamCenter.publisherList[t],u=s.publisher;if(!n&&r&&0!==r.code){!this.maxTimer&&!n&&this.startMaxTime(),this.stateCenter.publishStreamList[t].state=o.ENUM_PUBLISH_STREAM_STATE.retryPublish;var d=u.localStream,h=u.videoInfo,p=u.mediaStreamConfig,f=u.publishOption;if(0!=u.sessionId&&u.signal&&u.shouldSendCloseSession()&&(u.signal.sendCloseSession(o.getSeq(),u.sessionId,1),u.signal.removeSession(u.sessionId),u.closeSessionSignal=!0),u.resetPublish(),!n&&!this.retryNextSignal(r)){if(s.isCenterNode&&u.gwNodeTTL<(new Date).getTime()&&0!==u.gwNodeList.length)u.gwNode="",u.gwNodeList=[],u.gwNodeTTL=0;else if(s.isCenterNode){var g=u.gwNodeList.findIndex((function(e){return e==u.gwNode}));u.gwNode=u.gwNodeList[++g%u.gwNodeList.length]}return void setTimeout((function(){u.startPublish(t,d,h,p,f)}),3e3)}this.streamCenter.removeStreamFromSignal(!0,t)}if(n)return this.stopMaxTime(),this.invalid(),1===e&&u.resetPublish(),void this.streamCenter.onPublishStateUpdate(e,t,r);if(r&&0!==r.code&&this.activePublish(void 0)){var m=o.getReportSeq();this.streamCenter.dataReport.newReport(m),this.streamCenter.dataReport.addMsgInfo(m,{stream:a.ZegoRTCLogEvent.kZegoTaskRePublish.stream(this.streamID)}),this.streamCenter.dataReport.uploadReport(m,a.ZegoRTCLogEvent.kZegoTaskRePublish.event),this.streamCenter.onPublishStateUpdate(2,t,r)}this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISH_STATE_HANDLE+" end "+t)},t.prototype.playStateHandle=function(e,t,r,i){this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAY_STATE_HANDLE+" call "+t+" "+(r?r.code+"":""));var n=i||this.RETRY_MAX_TIME<3;if(!n&&r&&(l.ClientUtil.isReDispatch(r)||0==this.serverUrls.length))return this.stopMaxTime(),this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=null,void this.streamCenter.onPlayStateUpdate(e,t,r);if(r&&0!==r.code){!this.maxTimer&&!n&&this.startMaxTime();var s=this.streamCenter.playerList[t],u=s.player,d=u.playOption;if(0!=u.sessionId&&u.signal&&u.shouldSendCloseSession()&&(u.signal.sendCloseSession(o.getSeq(),u.sessionId,1),u.signal.removeSession(u.sessionId),u.closeSessionSignal=!0),u.resetPlay(),!n&&!this.retryNextSignal(r)){if(s.isCenterNode&&u.gwNodeTTL<(new Date).getTime()&&0!==u.gwNodeList.length)u.gwNode="",u.gwNodeList=[],u.gwNodeTTL=0;else if(s.isCenterNode){var h=u.gwNodeList.findIndex((function(e){return e==u.gwNode}));u.gwNode=u.gwNodeList[++h%u.gwNodeList.length]}return void setTimeout((function(){u.startPlay(t,u.getRemoteStreamSuc,d)}),3e3)}this.streamCenter.removeStreamFromSignal(!1,t)}if(n)return this.stopMaxTime(),this.invalid(),void this.streamCenter.onPlayStateUpdate(e,t,r);if(r&&0!==r.code&&this.activePull(void 0)){var p=o.getReportSeq();this.streamCenter.dataReport.newReport(p),this.streamCenter.dataReport.addMsgInfo(p,{stream:a.ZegoRTCLogEvent.kZegoTaskRePlay.stream(this.streamID)}),this.streamCenter.dataReport.uploadReport(p,a.ZegoRTCLogEvent.kZegoTaskRePlay.event),this.streamCenter.onPlayStateUpdate(2,t,r)}this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAY_STATE_HANDLE+" end "+t)},t}(s.RetryHandler);t.RetryStreamHandler=u},908:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.RTCModules=void 0;var o=r(6706),s=r(3529),a=r(608),c=r(7560),l=r(361),u=r(4865),d=r(1089),h=r(2752),p=r(9595),f=function(){function e(e,t,r,i,n,o){this.logger=e,this.dataReport=t,this.stateCenter=r,this.streamCenter=i,this.rtm=n,this.ac=o,this.mediaEleSources=[],this.publishModule=new l.PublishModule(this.logger,this.dataReport,this.stateCenter,this.streamCenter,this.rtm),this.playModule=new u.PlayModule(this.logger,this.dataReport,this.stateCenter,this.streamCenter,this.rtm),this.initAdvance(),this.initAudioMix(),this.init()}return e.prototype.init=function(){this.bindWindowListener(),this.bindRTMListener(),this.bindStreamCenterHandler()},e.prototype.initAudioMix=function(){},e.prototype.initAdvance=function(){},e.prototype.bindWindowListener=function(){var e=this,t=navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i),r=this.stateCenter.browser,i=t?"pagehide":"firefox"===r?"beforeunload":"unload";window.addEventListener(i,(function(){for(var t in window.event&&(window.event.cancelBubble=!0),e.streamCenter.publisherList)e.publishModule.stopPublishingStream(t);for(var t in e.streamCenter.playerList)e.playModule.stopPlayingStream(t)})),window.addEventListener("message",(function(t){var r=t.data,i=r.type,n=r.streamId,o=r.canRequestAudioTrack;"SS_DIALOG_SUCCESS"===i&&e.screenStreamFrom(n,o,a.ClientUtil.actionSuccessCallback("screenShare",e.stateCenter.callbackList)),"SS_DIALOG_CANCEL"===i&&a.ClientUtil.actionSuccessCallback("screenShare",e.stateCenter.callbackList)(!1,null,i)})),window.addEventListener("offline",(function(){for(var t in e.logger.info("zc.off.0 newtwork is broken"),e.stateCenter.networkState=o.ENUM_NETWORK_STATE.offline,e.streamCenter.publisherList)(r=e.streamCenter.publisherList[t].retryStreamHandler).startMaxTime(),r.invalid();for(var t in e.streamCenter.playerList){var r;(r=e.streamCenter.playerList[t].retryStreamHandler).startMaxTime(),r.invalid()}})),window.addEventListener("online",(function(t){for(var r in e.logger.info("zc.on.0 network is online"),e.stateCenter.networkState=o.ENUM_NETWORK_STATE.online,e.streamCenter.publisherList){var i=e.streamCenter.publisherList[r].publisher,n=e.streamCenter.publisherList[r].retryStreamHandler;i.state==o.ENUM_PUBLISH_STATE.stop||i.stateNego!==o.ENUM_PUBLISH_STATE_NEGO.iceConnected?!n.isOverTime&&n.publishStateHandle(o.ENUM_PUBLISH_STATE_UPDATE.error,r,s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishNetworkBrokenError):i.state==o.ENUM_PUBLISH_STATE.publishing&&n.stopMaxTime()}for(var r in e.streamCenter.playerList){var a=e.streamCenter.playerList[r].player;n=e.streamCenter.playerList[r].retryStreamHandler,a.state==o.ENUM_PLAY_STATE.stop||a.stateNego!==o.ENUM_PLAY_STATE_NEGO.iceConnected?!n.isOverTime&&n.playStateHandle(o.ENUM_PLAY_STATE_UPDATE.error,r,s.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayNetworkBrokenError):a.state==o.ENUM_PLAY_STATE.playing&&n.stopMaxTime()}})),window.addEventListener("visibilitychange",(function(t){if(Object.keys(e.streamCenter.publisherList).length>0||Object.keys(e.streamCenter.playerList).length>0){var r=o.getReportSeq();e.dataReport.newReport(r,s.ZegoRTCLogEvent.kZegoVisibilityChange.event),e.dataReport.uploadReport(r)}}))},e.prototype.bindRTMListener=function(){var e,t,r=this;this.rtm._on("_settingCanFetch",(function(e){return i(r,void 0,void 0,(function(){var e=this;return n(this,(function(t){return this.rtm.cloudSetting.fetchSetting(p.RTC).then((function(t){e.logger.info("zc.scf stream config "+JSON.stringify(t)),e.rtm._on("_cloudSettingNotify",(function(t,r){var i=o.getReportSeq();e.dataReport.newReport(i,s.ZegoRTCLogEvent.kZegoTaskCloudSettingRefresh.event);var n=e.rtm.cloudSetting.getEnvVariables();e.dataReport.addMsgInfo(i,{params:n,files:[{name:t,content:r.setting,versions:r.versions}]}),e.dataReport.uploadReport(i),p.RTC}))})),[2]}))}))})),this.rtm._on("roomLoginResponse",(function(e){r.logger.info("zc.rlr call "+JSON.stringify(e));var t=e.header.room_id;r.stateCenter.appid=r.rtm.getAppID(),r.stateCenter.idName=r.rtm.getUserID(),r.stateCenter.testEnvironment=r.rtm.isTestEnvironment(),r.stateCenter.isMultiRoom=r.rtm.getMultiRoom(),r.streamCenter.setSessionInfo(r.stateCenter.appid,r.stateCenter.idName,r.stateCenter.testEnvironment);var i=r.rtm.getToken(t),n=r.rtm.getSessionId(t),o=r.rtm.getRoomSessionID(t),s=r.stateCenter.getRoomByRoomID(t);if(!s){var a=new c.StreamHandler(r.logger,r.stateCenter,r.rtm,r.streamCenter,t);r.bindStreamHandler(a),s={roomID:t,streamHandler:a,sessionID:n,roomSessionID:o,token:i,isResetRoom:!1,streamList:[],streamInfoList:[]},r.stateCenter.roomList.push(s)}s.sessionID=n,s.roomSessionID=o,s.streamHandler.handleStreamStart(e,s),r.logger.info("zc.rlr end "+t)})),this.rtm._on("HBResponse",(function(e){var t,i=null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id,n=r.stateCenter.getRoomByRoomID(i);"PUBLIC"===r.stateCenter.type&&(null==n||n.streamHandler.patchStreamList(e))})),this.rtm._on("_roomStateUpdate",(function(e,t,i,n){if("DISCONNECTED"==t){r.logger.info("zc.rsu "+e+" disconnected "+(i?i+" ":"")+(n||""));var o=r.stateCenter.getRoomByRoomID(e);if(o){var s=r.stateCenter.roomList.findIndex((function(t){return t.roomID==e}));o.isResetRoom=!0,o.streamHandler.reset(),r.streamCenter.reset(e),r.stateCenter.roomList.splice(s,1)}}else r.logger.info("zc.rsu "+e+" state: "+t)})),this.rtm._on("_tokenRenewed",(function(e,t){r.logger.info("zc.tr roomID:"+t+" "+e);var i=r.stateCenter.getRoomByRoomID(t);i&&(i.token=e)})),this.rtm._on("_tokenExpired",(function(e){var t,i;((null===(i=null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.stop_stream)||void 0===i?void 0:i.stream_id_list)||[]).forEach((function(e){r.publishModule.stopPublishingStream(e,h.errorCodeList.TOKEN_EXPIRED)}))})),this.rtm.service.on("stream",(function(e){var t,i=(null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id)||"",n=r.stateCenter.getRoomByRoomID(i);n?n.streamHandler.handleStreamUpdateRsp(e):r.logger.error(d.ZEGO_WEBRTC_ACTION.ON_STREAM+" room no found")})),null===(e=this.rtm.service)||void 0===e||e.on("push_stream_update",(function(e){var t,i=(null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id)||"",n=r.stateCenter.getRoomByRoomID(i);n?n.streamHandler.handlePushStreamUpdateMsg(e):r.logger.error(d.ZEGO_WEBRTC_ACTION.ON_PUSH_STREAM_UPDATE+" room no found")})),null===(t=this.rtm.service)||void 0===t||t.on("zegochat_js.push_room_stream_update_req",(function(e){var t,i=(null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id)||"",n=r.stateCenter.getRoomByRoomID(i);n?n.streamHandler.handlePriPushStreamUpdateMsg(e):r.logger.error(d.ZEGO_WEBRTC_ACTION.ON_STREAM+" room no found")}))},e.prototype.bindStreamCenterHandler=function(){var e=this;this.streamCenter.onPlayStateUpdate=function(t,r,i){var n=e.stateCenter.reportSeqList.startPlay[r],o=e.streamCenter.playerList[r];if(1==t&&o&&a.ClientUtil.isReDispatch(i)){var s=o.player,c=o.retryDispatchHandler,l=o.playOption;return 0!=s.sessionId&&s.signal&&s.shouldSendCloseSession()&&(s.signal.sendCloseSession(e.stateCenter.getSeq(),s.sessionId,1),s.signal.removeSession(s.sessionId),s.closeSessionSignal=!0),s.resetPlay(),c.stopMaxTime(),c.invalid(),c.initStream(r,l,!1),void(e.rtm.isLogin()?(c.startMaxTime(),c.active(0)):e.streamCenter.playerList[r].isReDispatch=!0)}o&&o.player&&(0==t||1==t)&&n&&(e.dataReport.eventEndWithMsgInfo(n,"PlayState",{type:t}),1==t&&i&&e.dataReport.addMsgInfo(n,i),e.dataReport.uploadReport(n),delete e.stateCenter.reportSeqList.startPlay[r]),1===t&&e.streamCenter.playErrorCallBackList[r]?(e.streamCenter.playErrorCallBackList[r]({errorCode:i&&i.code,extendedData:i&&i.message}),delete e.streamCenter.playErrorCallBackList[r],e.logger.info("zc.opsu.1 stop play called by sdk"),e.playModule.stopPlayingStream(r,i)):e.stateCenter.actionListener("playerStateUpdate",{state:a.ClientUtil.getPlayerStateType(t),streamID:r,errorCode:i&&i.code,extendedData:i&&i.message})},this.streamCenter.onPublishStateUpdate=function(t,r,i){e.onPublishStateUpdateHandle(t,r,i)},this.streamCenter.onPublishQualityUpdate=function(t,r){e.stateCenter.actionListener("publishQualityUpdate",t,r)},this.streamCenter.onPlayQualityUpdate=function(t,r){e.stateCenter.actionListener("playQualityUpdate",t,r)},this.streamCenter.onRemoteCameraStatusUpdate=function(t,r,i){var n=o.getReportSeq();e.dataReport.newReport(n,s.ZegoRTCLogEvent.kZegoTaskRemoteCameraUpdate.event),e.dataReport.addMsgInfo(n,{stream:s.ZegoRTCLogEvent.kZegoTaskRemoteCameraUpdate.stream(t),status:s.ZegoRTCLogEvent.kZegoTaskRemoteCameraUpdate.status(r)}),e.dataReport.uploadReport(n),e.stateCenter.actionListener("remoteCameraStatusUpdate",t,r),e.stateCenter.actionListener("_remoteCameraStatusUpdate",t,i)},this.streamCenter.onRemoteMicStatusUpdate=function(t,r,i){var n=o.getReportSeq();e.dataReport.newReport(n,s.ZegoRTCLogEvent.kZegoTaskRemoteMicUpdate.event),e.dataReport.addMsgInfo(n,{stream:s.ZegoRTCLogEvent.kZegoTaskRemoteMicUpdate.stream(t),status:s.ZegoRTCLogEvent.kZegoTaskRemoteMicUpdate.status(r)}),e.dataReport.uploadReport(n),e.stateCenter.actionListener("remoteMicStatusUpdate",t,r),e.stateCenter.actionListener("_remoteMicStatusUpdate",t,i)},this.streamCenter.onSoundLevelUpdate=function(t){e.stateCenter.actionListener("soundLevelUpdate",t)},this.streamCenter.onMicSoundLevelUpdate=function(t){e.stateCenter.actionListener("capturedSoundLevelUpdate",t)}},e.prototype.bindStreamHandler=function(e){var t=this;e.onStreamUpdated=function(e,r,i){var n;n="PRIVATE"===t.stateCenter.type?i.map((function(e){return{streamID:e.stream_id,user:{userID:e.user_id,userName:e.user_name},extraInfo:e.extra_info,title:e.title,streamVer:e.stream_ver}})):i.map((function(e){return{streamID:e.streamID,user:e.user,extraInfo:e.extraInfo,urlsFLV:e.urlFlv,urlsRTMP:e.urlRtmp,urlsHLS:e.urlHls,urlsHttpsFLV:e.urlHttpsFlv,urlsHttpsHLS:e.urlHttpsHls}}));var c={};if(0===r){var l=i.map((function(e){return{stream_id:e.streamID,code:o.STREAM_DELETE_REASON[e.closeType]&&o.STREAM_DELETE_REASON[e.closeType].code||0,description:o.STREAM_DELETE_REASON[e.closeType]&&o.STREAM_DELETE_REASON[e.closeType].description||"unknown"}}));c.stream_delete_reason=l}var u=o.getReportSeq();if(t.dataReport.newReport(u,s.ZegoRTCLogEvent.kZegoTaskLiveRoomGetStreamUpdateInfo.event),t.dataReport.addMsgInfo(u,{stream_update_type:s.ZegoRTCLogEvent.kZegoTaskLiveRoomGetStreamUpdateInfo.stream_update_type(1===r?"added":"deleted"),update_stream:s.ZegoRTCLogEvent.kZegoTaskLiveRoomGetStreamUpdateInfo.update_stream(n)}),t.dataReport.uploadReport(u),t.stateCenter.actionListener("roomStreamUpdate",e,a.ClientUtil.getSteamUpdateType(r),n,Object.keys(c).length>0?JSON.stringify(c):""),t.stateCenter.actionListener("_streamUpdated",r,i),1===r){var d=[];n.forEach((function(e){e.extraInfo&&d.push({streamID:e.streamID,user:e.user,extraInfo:e.extraInfo})})),d.length>0&&t.stateCenter.actionListener("streamExtraInfoUpdate",e,d)}},e.onPublishStateUpdate=function(e,r,i){t.logger.info("zb.opsu ",r);var n=t.stateCenter.reportSeqList.startPublish[r],o=t.streamCenter.publisherList[r];o&&o.publisher&&(0==e||1==e)&&n&&(t.dataReport.eventEndWithMsgInfo(n,"PublishState",{type:e}),1==e&&t.dataReport.addMsgInfo(n,i),t.dataReport.uploadReport(n),delete t.stateCenter.reportSeqList.startPublish[r]),t.stateCenter.actionListener("publisherStateUpdate",{state:a.ClientUtil.getPublisherStateType(e),streamID:r,errorCode:i.code,extendedData:i.message})},e.onStreamExtraInfoUpdated=function(e,r){var i;i="PUBLIC"===t.stateCenter.type?r.map((function(e){return{streamID:e.streamID,user:e.user,extraInfo:e.extraInfo}})):r.map((function(e){return{streamID:e.stream_id,user:{userID:e.user_id,userName:e.user_name},extraInfo:e.extra_info,title:e.title,streamVer:e.stream_ver}}));var n=o.getReportSeq();t.dataReport.newReport(n,s.ZegoRTCLogEvent.kZegoTaskLiveRoomGetStreamExtraInfo.event),t.dataReport.addMsgInfo(n,{update_stream:s.ZegoRTCLogEvent.kZegoTaskLiveRoomGetStreamExtraInfo.update_stream(i)}),t.dataReport.uploadReport(n),t.stateCenter.actionListener("streamExtraInfoUpdate",e,i)}},e.prototype.screenStreamFrom=function(e,t,r){var i={};i.audio={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e}},i.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxWidth:window.screen.width,maxHeight:window.screen.height}},!t&&(i.audio=!1),navigator.mediaDevices.getUserMedia(i).then((function(e){r(!0,e)})).catch((function(e){r(!1,null,e)}))},e.prototype.onPublishStateUpdateHandle=function(e,t,r){var i=this;this.logger.info("zc.opsuh.0 call");var n=this.streamCenter.publisherList[t],s=n.room;if(s)if(0==e){if(this.stateCenter.publishStreamList[t])if([o.ENUM_PUBLISH_STREAM_STATE.tryPublish,o.ENUM_PUBLISH_STREAM_STATE.retryPublish].includes(this.stateCenter.publishStreamList[t].state)&&!s.streamList.find((function(e){return e.stream_id==t}))){var c;this.stateCenter.publishStreamList[t].state=o.ENUM_PUBLISH_STREAM_STATE.update_info,c="PUBLIC"===this.stateCenter.type?o.ENUM_STREAM_SUB_CMD.liveBegin:o.ENUM_STREAM_CMD_PRI.liveBegin,s.streamHandler.updateStreamInfo(t,c,this.stateCenter.publishStreamList[t].extra_info,(function(e){"PRIVATE"===i.stateCenter.type&&i.stateCenter.publishStreamList[t]&&i.stateCenter.publishStreamList[t].state==o.ENUM_PUBLISH_STREAM_STATE.update_info&&(i.stateCenter.publishStreamList[t].state=o.ENUM_PUBLISH_STREAM_STATE.stop,s.streamHandler.onPublishStateUpdate(1,t,e),i.publishModule.stopPublishingStream(t))}))}else this.stateCenter.publishStreamList[t].state=o.ENUM_PUBLISH_STREAM_STATE.publishing,this.WebrtcOnPublishStateUpdateHandle(e,t,r)}else{if(1==e&&n&&a.ClientUtil.isReDispatch(r)){var l=n.publisher,u=n.retryDispatchHandler,d=n.publishOption;return 0!=l.sessionId&&l.signal&&l.shouldSendCloseSession()&&(l.signal.sendCloseSession(this.stateCenter.getSeq(),l.sessionId,1),l.signal.removeSession(l.sessionId),l.closeSessionSignal=!0),l.resetPublish(),u.stopMaxTime(),u.invalid(),u.initStream(t,d,!0),void(this.rtm.isLogin()?(u.startMaxTime(),u.active(0)):this.streamCenter.publisherList[t].isReDispatch=!0)}s.streamHandler.onPublishStateUpdate(e,t,r),1==e&&(this.logger.info("zc.opsuh.0 stop publish called by sdk"),this.publishModule.stopPublishingStream(t,r))}else this.logger.error("zc.opsuh.0 room not exist")},e.prototype.WebrtcOnPublishStateUpdateHandle=function(e,t,r){if(this.stateCenter.publishStreamList[t].state==o.ENUM_PUBLISH_STREAM_STATE.publishing){var i=this.streamCenter.getRoomByStreamID(t);i&&i.streamHandler.onPublishStateUpdate(e,t,r)}},e.prototype.bindListener=function(e,t){return this.stateCenter.listenerList[e]?"function"!=typeof t?(this.logger.error("zc.o.0 listener callBack must be funciton"),!1):(-1==this.stateCenter.listenerList[e].indexOf(t)&&this.stateCenter.listenerList[e].push(t),!0):(this.logger.error("zc.o.0 event "+e+" no found"),!1)},e.prototype.deleteListener=function(e,t){if(!this.stateCenter.listenerList[e])return this.logger.error("zc.o.1 listener no found"),!1;var r=this.stateCenter.listenerList[e];return t?r.splice(r.indexOf(t),1):this.stateCenter.listenerList[e]=[],!0},e}();t.RTCModules=f},4865:function(e,t,r){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.PlayModule=void 0;var n=r(1089),o=r(6706),s=r(3529),a=r(608),c=function(){function e(e,t,r,i,n){this.logger=e,this.dataReport=t,this.stateCenter=r,this.streamCenter=i,this.rtm=n}return e.prototype.startPlayingStream=function(e,t,r){var i=this;return this.logger.info(n.ZEGO_WEBRTC_ACTION.START_PLAYING_STREAM+" call ",e),new Promise((function(n,o){return i._handlePlayStream(e,t,n,o,r)}))},e.prototype._handlePlayStream=function(e,t,r,c,l){var u=this,d=o.getReportSeq();this.stateCenter.reportSeqList.startPlay[e]=d,this.dataReport.newReport(d,s.ZegoRTCLogEvent.kZegoTaskPlayStart.event);var h,p=function(t,r){u.logger.error(n.ZEGO_WEBRTC_ACTION.START_PLAYING_STREAM+" "+(r||t.message)),u.dataReport.uploadReport(d,void 0,t,r),delete u.stateCenter.reportSeqList.startPlay[e],c&&c(i(i({},t),{errorCode:t.code,extendedData:t.message+(r?" "+r:"")}))};if(void 0===e||"string"!=typeof e||""===e)return p(s.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayParamError,"stream id type error"),!1;if(e.length>o.MAX_STREAM_ID_LENGTH)return p(s.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayStreamIDToLongError,"stream id length limit "+o.MAX_STREAM_ID_LENGTH),!1;if(!a.ClientUtil.checkIllegalCharacters(e))return p(s.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayStreamIDInvalidCharacterError),!1;if(void 0!==t&&"object"!=typeof t)return p(s.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayParamError,"playOption must be object"),!1;if(this.stateCenter.customUrl&&0!=this.stateCenter.customUrl.length)this.logger.info("zc.p.sps.1 customUrl "+JSON.stringify(this.stateCenter.customUrl)),h=this.stateCenter.customUrl;else{var f=this.stateCenter.settingConfig.getSetting("signal_nodes",!0);f&&f instanceof Array&&f.length>0&&(h=f,this.logger.info("zc.p.sps.1 setting config signal_nodes "+JSON.stringify(f)))}if(h)return this.streamCenter.setPlayStateStart(e,t,l)?(this.streamCenter.onPlayStateUpdate(o.ENUM_PLAY_STATE_UPDATE.retry,e,{code:0,message:""}),this.streamCenter.playerList[e].serverUrls=h,this.streamCenter.startPlayingStream(e,(function(e){r&&r(e)}))):(p(s.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayRepeatedPullError,"cannot start play"),!1);if(this.dataReport.addMsgInfo(d,{stream:s.ZegoRTCLogEvent.kZegoTaskPlayStart.stream(e),playOption:s.ZegoRTCLogEvent.kZegoTaskPlayStart.playOption(t)}),this.rtm.service.isDisConnect())return p(s.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayNoLoginError),!1;this.stateCenter.pullLimited||(e=NaN+e),t&&t.videoCodec&&(t.videoCodec=t.videoCodec.toUpperCase());var g=this.stateCenter.settingConfig.getSetting("resource_mode",!0);if(g&&(this.logger.info(n.ZEGO_WEBRTC_ACTION.START_PLAYING_STREAM," setting resource_mode "+g),!t&&(t={}),t.resourceMode=g),!this.streamCenter.setPlayStateStart(e,t,l))return p(s.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayRepeatedPullError,"cannot start play"),!1;this.streamCenter.onPlayStateUpdate(o.ENUM_PLAY_STATE_UPDATE.retry,e,{code:0,message:""}),this.streamCenter.playSuccessCallBackList[e]=function(e){r&&r(e)},c&&(this.streamCenter.playErrorCallBackList[e]=c);var m=this.streamCenter.playerList[e].retryDispatchHandler;return m.stopMaxTime(),m.invalid(),m.initStream(e,t,!1),m.startMaxTime(),m.active(0)},e.prototype.stopPlayingStream=function(e,t){this.logger.info(n.ZEGO_WEBRTC_ACTION.STOP_PLAYING_STREAM+" call",e);var r=o.getReportSeq();if(this.stateCenter.reportSeqList.stopPlay[e]=r,this.dataReport.newReport(r,s.ZegoRTCLogEvent.kZegoTaskPlayStop.event),this.dataReport.addMsgInfo(r,{stream:s.ZegoRTCLogEvent.kZegoTaskPlayStop.stream(e)}),"string"!=typeof e||""===e)return this.logger.error(n.ZEGO_WEBRTC_ACTION.STOP_PLAYING_STREAM+" streamid must be string and not empty"),this.dataReport.uploadReport(r,void 0,s.ZegoRTCLogEvent.kZegoTaskPlayStop.error.kParamError,"stream id type error"),void delete this.stateCenter.reportSeqList.stopPlay[e];var i=this.streamCenter.playerList[e],a=i&&i.player&&i.player.state!==o.ENUM_PLAY_STATE.stop;for(var c in this.streamCenter.stopPlayingStream(e),this.stateCenter.streamUrlMap)if(this.stateCenter.streamUrlMap[c]===e){delete this.stateCenter.streamUrlMap[c];break}this.dataReport.uploadReport(r),a&&this.streamCenter.onPlayStateUpdate(o.ENUM_PLAY_STATE_UPDATE.error,e,t||{code:0,message:""}),this.logger.debug(n.ZEGO_WEBRTC_ACTION.STOP_PLAYING_STREAM+" call success")},e.prototype.mutePlayStream=function(e,t,r){return new Promise((function(e,t){e(!1)}))},e.prototype.setStreamAudioOutput=function(e,t){return!1},e}();t.PlayModule=c},5634:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlayStreamQuality=void 0;var i=r(6706),n=r(1089),o=r(3529),s=r(608),a=function(){function e(e,t,r,n){this.player=t,this.logger=r,this.dataReport=n,this.playQualityList=[],this.maxQualityListCount=10,this.qualityTimer=null,this.lastPlayStats={audioPacketsLost:0,videoPacketsLost:0,time:0,audioTime:0,videoTime:0,audioBytesReceived:0,videoBytesReceived:0,audioPacketsReceived:0,videoPacketsReceived:0,framesDecoded:0,framesReceived:0,framesDropped:0,audioBitrate:0},this.decodeStartTime=0,this.netQuality=0,this.probeTime=0,this.probeInterval=6e4,this.probeState=i.ENUM_PROBE_STATE.probed,this.probeTimer=null,this.probeTimeoutInterval=3e4,this.qualityUpload=!1,this.qualityUploadInterval=3e4,this.qualityUploadLastTime=0,this.cumulativeQuality={},this.audioBreakThreshold=200,this.videoBreakThreshold=500,this.videoBreak={breakStartTime:void 0,cumulativeBreakDuration:0,cumulativeDecodeDuration:0,decodeStartTime:void 0,decodeEndTime:void 0,totalDuration:0,noBreakNoDecodeDuration:0,resumeRecv:!0},this.audioBreak={breakStartTime:void 0,cumulativeBreakDuration:0,cumulativeDecodeDuration:0,decodeStartTime:void 0,decodeEndTime:void 0,totalDuration:0,noBreakNoDecodeDuration:0,resumeRecv:!0},this.lastSampleTime=0,this.videoBreakReport={breakDuration:0,breakCancelDuration:0,decodeTime:0},this.audioBreakReport={breakDuration:0,breakCancelDuration:0,decodeTime:0},this.totalQuality={totalSquaredInterFrameDelay:0,totalInterFrameDelay:0,framesDecode:0,totalSamplesReceived:0,concealedSamples:0,audioBytesReceived:0},this.currentSecondQuality={totalSquaredInterFrameDelay:0,totalInterFrameDelay:0,framesDecode:0,totalSamplesReceived:0,concealedSamples:0},this.onBreakEnd=function(e,t,r,i){if(void 0===i&&(i="video"),t.breakStartTime){var n=e-t.breakStartTime;n>=r&&(t.cumulativeBreakDuration+=n),t.breakStartTime=void 0}},this.p2pNetStats={p2pLostRate:0,p2pRTT:0},this.sampleTimes=0,this.qualitySampleInterval=1e3,this.qualityTimeInterval=e}return Object.defineProperty(e.prototype,"streamId",{get:function(){return this.player.streamId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sessionId",{get:function(){return this.player.sessionId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"peerID",{get:function(){return this.player.peerID},enumerable:!1,configurable:!0}),e.prototype.getPlayStats=function(e,t){var r=this;if(null!=e){var a=this.sampleTimes%parseInt((this.qualityTimeInterval/this.qualitySampleInterval).toString())==0;this.sampleTimes,parseInt((this.qualityTimeInterval/this.qualitySampleInterval).toString()),a&&this.getP2PNetStats();for(var c,l=document.querySelectorAll("video, audio"),u=0;u<l.length;u++)l[u].srcObject===this.player.playStream&&(c=l[u]);var d={sampleTimeWindow:this.qualityTimeInterval,audioFractionLost:0,audioPacketsLost:0,audioPacketsLostRate:0,audioBitrate:0,audioLevel:0,audioSendLevel:0,audioSamplingRate:0,audioCodec:"opus",audioQuality:0,audioFPS:0,videoQuality:0,videoPacketsLost:0,videoPacketsLostRate:0,videoBitrate:0,videoFPS:0,playData:0,nackCount:0,pliCount:0,audioJitter:0,videoFractionLost:0,videoFramesDecoded:0,frameHeight:0,frameWidth:0,videoTransferFPS:0,videoFramesDropped:0,totalRoundTripTime:0,currentRoundTripTime:0,googBandwidthLimitedResolution:void 0,videoCodecName:"",audioCodecName:"",googCpuLimitedResolution:void 0,googAvailableSendBandwidth:0,audioMuteState:this.player.audioMuteState,videoMuteState:this.player.videoMuteState,muted:c?c.muted:void 0,paused:c?c.paused:void 0,volume:c?c.volume:void 0,sinkId:c?c.sinkId:void 0},h=this.lastPlayStats.time,p=0,f=0,g=0,m=0,_=0,v=0,E=0,A=null,y=null;e.forEach((function(e){["ssrc","inbound-rtp"].includes(e.type)&&("video"==e.mediaType||e.id.indexOf("VideoStream")>=0)&&(A=e),("inbound-rtp"==e.type||"ssrc"==e.type&&null!=e.bytesReceived)&&("audio"==e.mediaType||e.id.indexOf("AudioStream")>=0)&&(y=e)}));var S=function(e,t,i,o,s,a,c,l,u){if(void 0===l&&(l=c),void 0===u&&(u="video"),s>1e3&&(s=1e3),o.breakStartTime)if(i)if(0===t)e-o.breakStartTime>=22e3&&r.onBreakEnd(e,o,s,u),a.breakDuration+=1e3;else if(c>=s)if(c<500)if(c+l<1e3){var d=e-(1e3-l);r.onBreakEnd(d,o,s,u),o.breakStartTime=e-c,a.breakDuration+=l+c,a.decodeTime+=1e3-(l+c)}else r.onBreakEnd(e-1e3+l,o,s,u),o.breakStartTime=e-1e3+l,a.breakDuration+=1e3;else c>=500&&(r.onBreakEnd(e-c,o,s,u),o.breakStartTime=e-c,a.breakDuration+=1e3);else l<=s?(r.onBreakEnd(e-1e3+l,o,s,u),o.breakStartTime=void 0,a.breakDuration+=l,a.decodeTime+=1e3-l):a.breakDuration+=1e3;else{o.resumeRecv=!1;var h=e-1e3,p=h-o.breakStartTime;p<=0&&(r.logger.error(n.ZEGO_WEBRTC_ACTION.PLAYER_SET_PLAYER_QUALITY_TIMER+" breakCancelDuration less than 0.  ("+o.breakStartTime+", "+h+")"),p=0),o.breakStartTime=void 0,o.noBreakNoDecodeDuration+=p,a.breakCancelDuration+=p}else i?0===t?o.resumeRecv?(o.breakStartTime=e-1e3,a.breakDuration+=1e3):o.noBreakNoDecodeDuration+=1e3:l>s?o.resumeRecv?(o.breakStartTime=e-l,a.breakDuration+=l,a.decodeTime+=1e3-l):o.noBreakNoDecodeDuration+=1e3:a.decodeTime+=1e3:o.decodeStartTime&&(0===t?(o.resumeRecv=!1,o.noBreakNoDecodeDuration+=1e3):a.decodeTime+=1e3);i&&t&&(o.resumeRecv=!0)},C=(new Date).getTime(),T=function(e,t){return e>t?e-t:0};this.lastSampleTime||(this.lastSampleTime=C-1e3);var b=A.totalInterFrameDelay,I=A.framesDecoded,R=A.totalSquaredInterFrameDelay,w=T(I,this.totalQuality.framesDecode);this.totalQuality.framesDecode=I;var k=T(b,this.totalQuality.totalInterFrameDelay);this.totalQuality.totalInterFrameDelay=b;var O=T(R,this.totalQuality.totalSquaredInterFrameDelay);this.totalQuality.totalSquaredInterFrameDelay=R;var N=(O-Math.pow(k,2)/(w||1))/(w||1);N=N>0?N:-N;var L=parseInt((1e3/(w+1)).toString()),P=1e3*Math.sqrt(N),D=k/(w||1)*1e3||L,M=(D=parseInt((D>1e3?1e3:D).toString()))+P;M=parseInt((M>1e3?1e3:M).toString()),w>0&&0===this.player.cameraStatus&&!this.videoBreak.decodeStartTime&&(this.videoBreak.decodeStartTime=C-1e3),this.videoBreak.decodeStartTime&&S(C,w,0===this.player.cameraStatus&&this.player.playMediaStatus.video,this.videoBreak,this.videoBreakThreshold,this.videoBreakReport,D,M);var x=y.totalSamplesReceived,B=y.concealedSamples,U=y.bytesReceived,F=T(x,this.totalQuality.totalSamplesReceived);this.totalQuality.totalSamplesReceived=x;var V=T(B,this.totalQuality.concealedSamples);this.totalQuality.concealedSamples=B;var j=T(U,this.totalQuality.audioBytesReceived);this.totalQuality.audioBytesReceived=U;var G=parseInt((V/(F||1)*1e3).toString());if(j>0&&0===this.player.micStatus&&!this.audioBreak.decodeStartTime&&(this.audioBreak.decodeStartTime=C-1e3),this.audioBreak.decodeStartTime&&S(C,j,0===this.player.micStatus&&this.player.playMediaStatus.audio,this.audioBreak,this.audioBreakThreshold,this.audioBreakReport,G,G,"audio"),t&&t.result().forEach((function(e){a&&("ssrc"==e.type&&(e.names().indexOf("googBandwidthLimitedResolution")>=0&&(d.googBandwidthLimitedResolution=e.stat("googBandwidthLimitedResolution")),e.names().indexOf("codecImplementationName")>=0&&(d.codecImplementationName=e.stat("codecImplementationName")),"video"==e.stat("mediaType")&&(e.names().indexOf("googCodecName")>=0&&(d.videoCodecName=e.stat("googCodecName")),e.names().indexOf("googCurrentDelayMs")>=0&&(E=e.stat("googCurrentDelayMs"))),"audio"==e.stat("mediaType")&&(e.names().indexOf("googCodecName")>=0&&(d.audioCodecName=e.stat("googCodecName")),e.names().indexOf("googCurrentDelayMs")>=0&&(v=e.stat("googCurrentDelayMs"))),e.names().indexOf("googCpuLimitedResolution")>=0&&(d.googCpuLimitedResolution=e.stat("googCpuLimitedResolution"))),"VideoBwe"==e.type&&e.names().indexOf("googAvailableSendBandwidth")>=0&&(d.googAvailableSendBandwidth=e.stat("googAvailableSendBandwidth")))})),a){e.forEach((function(e){if(("inbound-rtp"==e.type||"ssrc"==e.type&&null!=e.bytesReceived)&&("audio"==e.mediaType||e.id.indexOf("AudioStream")>=0)){0!=h&&(d.audioBitrate=8*(e.bytesReceived-r.lastPlayStats.audioBytesReceived)/(e.timestamp-h),(n=e.packetsLost-r.lastPlayStats.audioPacketsLost)>0&&(f=n/(n+e.packetsReceived-r.lastPlayStats.audioPacketsReceived))),d.audioBitrate<0&&(d.audioBitrate=0),d.audioJitter=e.jitter,e.packetsLost>0&&(d.audioPacketsLost=e.packetsLost),d.audioFractionLost=e.fractionLost;var t=e.packetsLost-r.lastPlayStats.audioPacketsLost;d.audioFPS=(e.packetsReceived-r.lastPlayStats.audioPacketsReceived)/(e.timestamp-h)*1e3,d.audioPacketsLostRate=t>0?t/(e.packetsReceived-r.lastPlayStats.audioPacketsReceived+t):0,r.lastPlayStats.audioBytesReceived=e.bytesReceived,e.packetsLost>0&&(r.lastPlayStats.audioPacketsLost=e.packetsLost),r.lastPlayStats.audioPacketsReceived=e.packetsReceived,r.lastPlayStats.audioTime=e.timestamp,r.lastPlayStats.time=e.timestamp,r.lastPlayStats.audioBitrate=d.audioBitrate,m=e.jitter}else if(("inbound-rtp"==e.type||"ssrc"==e.type&&null!=e.bytesReceived)&&("video"==e.mediaType||e.id.indexOf("VideoStream")>=0)){var n;0!=h&&(d.videoBitrate=8*(e.bytesReceived-r.lastPlayStats.videoBytesReceived)/(e.timestamp-h),d.videoFPS=1e3*(e.framesDecoded-r.lastPlayStats.framesDecoded)/(e.timestamp-h),(n=e.packetsLost-r.lastPlayStats.videoPacketsLost)>0&&(g=n/(n+e.packetsReceived-r.lastPlayStats.videoPacketsReceived))),d.videoBitrate<0&&(d.videoBitrate=0),d.videoFPS<0&&(d.videoFPS=0),d.nackCount=e.nackCount,d.pliCount=e.pliCount,d.videoFractionLost=e.fractionLost,d.videoFramesDecoded=e.framesDecoded,e.packetsLost>0&&(d.videoPacketsLost=e.packetsLost),t=e.packetsLost-r.lastPlayStats.videoPacketsLost,d.videoPacketsLostRate=t>0?t/(e.packetsReceived-r.lastPlayStats.videoPacketsReceived+t):0,r.lastPlayStats.videoBytesReceived=e.bytesReceived,r.lastPlayStats.framesDecoded=e.framesDecoded,e.packetsLost>0&&(r.lastPlayStats.videoPacketsLost=e.packetsLost),r.lastPlayStats.videoPacketsReceived=e.packetsReceived,r.lastPlayStats.videoTime=e.timestamp,r.lastPlayStats.time=e.timestamp,_=e.jitter}else if("track"==e.type&&("video"==e.kind||e.id.indexOf("video")>=0)||e.frameWidth){if(d.frameHeight=e.frameHeight,d.frameWidth=e.frameWidth,0===h||r.lastPlayStats.frameHeight===e.frameHeight&&r.lastPlayStats.frameWidth===e.frameWidth)0===h&&(r.lastPlayStats.frameHeight=e.frameHeight,r.lastPlayStats.frameWidth=e.frameWidth);else{var s=i.getReportSeq();r.dataReport.newReport(s,o.ZegoRTCLogEvent.kZegoTaskVideoPlaySize.event),r.dataReport.addMsgInfo(s,{session_id:o.ZegoRTCLogEvent.kZegoTaskVideoPlaySize.session_id(r.sessionId),w:o.ZegoRTCLogEvent.kZegoTaskVideoPlaySize.w(e.frameWidth),h:o.ZegoRTCLogEvent.kZegoTaskVideoPlaySize.h(e.frameHeight)}),!r.player.isProbe&&r.dataReport.uploadReport(s),r.lastPlayStats.frameHeight=e.frameHeight,r.lastPlayStats.frameWidth=e.frameWidth}0!=h&&(d.videoTransferFPS=1e3*(e.framesReceived-r.lastPlayStats.framesReceived)/(e.timestamp-h),d.videoFramesDropped=e.framesDropped-r.lastPlayStats.framesDropped),d.videoTransferFPS<0&&(d.videoTransferFPS=0),d.videoFramesDropped<0&&(d.videoFramesDropped=0),r.lastPlayStats.framesReceived=e.framesReceived,r.lastPlayStats.framesDropped=e.framesDropped}else"track"==e.type&&("audio"==e.kind||e.id.indexOf("audio")>=0)?(d.audioLevel=e.audioLevel,d.audioSendLevel=e.totalAudioEnergy,d.audioSamplingRate=e.totalSamplesDuration):"candidate-pair"==e.type&&(null!=e.totalRoundTripTime&&(d.totalRoundTripTime=e.totalRoundTripTime),null!=e.currentRoundTripTime&&(d.currentRoundTripTime=e.currentRoundTripTime,p=1e3*d.currentRoundTripTime))})),this.lastPlayStats.googCurrentDelayMs=Number(v)||Number(E)||0,g=isNaN(g)||g<0?0:g,_=isNaN(_)||_<0?0:_,f=isNaN(f)||f<0?0:f,m=isNaN(m)||m<0?0:m;var H=s.ClientUtil.getNetQuality(p,g,_),Q=s.ClientUtil.getNetQuality(p,f,m);d.audioQuality=h>0?s.ClientUtil.quality2QualityGrade(H):0,d.videoQuality=h>0?s.ClientUtil.quality2QualityGrade(Q):0;var W=Math.min(H,Q);this.netQuality=W,d.peerToPeerDelay=isNaN(this.p2pNetStats.p2pRTT)?0:parseInt((this.p2pNetStats.p2pRTT/2+this.lastPlayStats.googCurrentDelayMs).toString()),d.peerToPeerPacketLostRate=100*this.p2pNetStats.p2pLostRate/256,h>0&&W<=i.QUALITY_CONSTANT.MiddleMinQuality&&C>this.probeTime+this.probeInterval&&(this.logger.info(n.ZEGO_WEBRTC_ACTION.PLAYER_SET_PLAYER_QUALITY_TIMER+" netQuality "+W+" start net probe"),this.probeState=i.ENUM_PROBE_STATE.tryProbe,this.player.streamCenter.startNetProbe(!1,this.player,this.player.gwNodeList),this.probeTime=C),this.uploadPlayQuality(d,C);var q={video:{videoBitrate:d.videoBitrate,videoFPS:d.videoFPS,videoTransferFPS:d.videoTransferFPS,videoFramesDecoded:d.videoFramesDecoded,videoFramesDropped:d.videoFramesDropped,videoPacketsLost:d.videoPacketsLost,videoPacketsLostRate:d.videoPacketsLostRate,videoQuality:d.videoQuality,frameHeight:d.frameHeight,frameWidth:d.frameWidth,muteState:d.videoMuteState},audio:{audioBitrate:d.audioBitrate,audioCodec:d.audioCodec,audioJitter:d.audioJitter,audioLevel:d.audioLevel,audioPacketsLost:d.audioPacketsLost,audioPacketsLostRate:d.audioPacketsLostRate,audioQuality:d.audioQuality,audioSamplingRate:d.audioSamplingRate,audioSendLevel:d.audioSendLevel,muteState:d.audioMuteState,audioFPS:d.audioFPS},nackCount:d.nackCount,pliCount:d.pliCount,totalRoundTripTime:d.totalRoundTripTime,playData:d.playData,currentRoundTripTime:d.currentRoundTripTime,peerToPeerDelay:d.peerToPeerDelay,peerToPeerPacketLostRate:d.peerToPeerPacketLostRate,sampleTimeWindow:d.sampleTimeWindow};void 0!==d.muted&&(q.muted=d.muted,q.paused=d.paused,q.volume=d.volume,q.sinkId=d.sinkId),void 0!==d.videoCodecName&&(q.video.googCodecName=d.videoCodecName,q.audio.googCodecName=d.audioCodecName,q.codecImplementationName=d.codecImplementationName,q.googAvailableSendBandwidth=d.googAvailableSendBandwidth),0!=h&&this.player.onPlayQualityUpdate(this.streamId,q)}}},e.prototype.uploadPlayQuality=function(e,t){var r=this;if(this.qualityUpload){var o=t;(0==this.qualityUploadLastTime||o-this.qualityUploadLastTime>=this.qualityUploadInterval)&&(e.stream_type="play",e.stream_id=this.streamId,e.timeStamp=parseInt((o/1e3).toString()),e.video_break_duration=this.videoBreakReport.breakDuration,e.video_break_cancel_duration=this.videoBreakReport.breakCancelDuration,e.video_decode_time=this.videoBreakReport.decodeTime,this.videoBreakReport.breakCancelDuration=0,this.videoBreakReport.breakDuration=0,this.videoBreakReport.decodeTime=0,e.audio_break_duration=this.audioBreakReport.breakDuration,e.audio_break_cancel_duration=this.audioBreakReport.breakCancelDuration,e.audio_decode_time=this.audioBreakReport.decodeTime,this.audioBreakReport.breakCancelDuration=0,this.audioBreakReport.breakDuration=0,this.audioBreakReport.decodeTime=0,e.real_sampling_interval=o-this.lastSampleTime,this.lastSampleTime=o,this.logger.info(n.ZEGO_WEBRTC_ACTION.PLAYER_UPLOAD_PLAYER_QUALITY+" "+this.streamId+" upload"+JSON.stringify(e)),this.player.streamCenter.updateQuality(1,e),this.player.signal.QualityReport(i.getSeq(),this.sessionId,e,(function(e,t,i){void 0!==i.report&&(r.qualityUpload=i.report,r.qualityUploadInterval=i.report_interval_ms)}),(function(e){r.logger.info(n.ZEGO_WEBRTC_ACTION.PLAYER_UPLOAD_PLAYER_QUALITY+" "+r.streamId+" upload failed "+e)})),this.qualityUploadLastTime=o)}},e.prototype.getP2PNetStats=function(){var e=this;this.player.signal.getP2PNetStats(i.getSeq(),this.sessionId,this.peerID,(function(t,r,i){var n=i.p2p_lost_rate,o=i.p2p_rtt;e.p2pNetStats.p2pLostRate=n||0,e.p2pNetStats.p2pRTT=o||0}),(function(e){}))},e.prototype.setPlayQualityTimer=function(){var e=this;null==this.qualityTimer&&(this.logger.info(n.ZEGO_WEBRTC_ACTION.PLAYER_SET_PLAYER_QUALITY_TIMER+" "+this.streamId+" startTimer"),this.clearPlayQualityTimer(),this.getP2PNetStats(),this.qualityTimer=setInterval((function(){e.sampleTimes++;var t=e.player.peerConnection;if(t){var r=[t.getStats(null)];"chrome"==e.player.stateCenter.browser&&r.push(new Promise((function(e,r){t.getStats((function(t){return e(t)}),(function(e){return r(e)}))}))),Promise.all(r).then((function(t){e.getPlayStats(t[0],t[1])})).catch((function(t){e.logger.error(n.ZEGO_WEBRTC_ACTION.PLAYER_SET_PLAYER_QUALITY_TIMER+" "+e.streamId+" getStats error "+t.toString())}))}}),1e3),this.lastPlayStats={audioPacketsLost:0,videoPacketsLost:0,time:0,audioTime:0,videoTime:0,audioBytesReceived:0,videoBytesReceived:0,videoPacketsReceived:0,audioPacketsReceived:0,framesDecoded:0,framesReceived:0,framesDropped:0,audioBitrate:0})},e.prototype.clearPlayQualityTimer=function(){if(null!=this.qualityTimer){clearInterval(this.qualityTimer),this.qualityTimer=null;var e=(new Date).getTime();this.lastSampleTime=0,this.sampleTimes=0,this.totalQuality={totalSquaredInterFrameDelay:0,totalInterFrameDelay:0,framesDecode:0,totalSamplesReceived:0,concealedSamples:0,audioBytesReceived:0};var t=function(t,r,i,n,o){if(void 0===o&&(o="video"),i=i>1e3?1e3:i,r.breakDuration=0,r.breakCancelDuration=0,r.decodeTime=0,t.decodeStartTime){var s=e,a=s-t.decodeStartTime;if(t.decodeStartTime=void 0,t.totalDuration+=a,t.breakStartTime){var c=s-t.breakStartTime;t.breakStartTime=void 0,n?c>i&&(t.cumulativeBreakDuration+=c):t.noBreakNoDecodeDuration+=c}var l=t.cumulativeBreakDuration,u=t.totalDuration-t.cumulativeBreakDuration-t.noBreakNoDecodeDuration;return t.cumulativeDecodeDuration=u,{cumulativeBreakDuration:l,cumulativeDecodeDuration:u}}return{cumulativeBreakDuration:0,cumulativeDecodeDuration:0}},r=0===this.player.cameraStatus&&this.player.playMediaStatus.video;t(this.videoBreak,this.videoBreakReport,this.videoBreakThreshold,r);var i=0===this.player.micStatus&&this.player.playMediaStatus.audio;t(this.audioBreak,this.audioBreakReport,this.audioBreakThreshold,i,"audio")}this.lastPlayStats={audioPacketsLost:0,videoPacketsLost:0,time:0,audioTime:0,videoTime:0,audioBytesReceived:0,videoBytesReceived:0,videoPacketsReceived:0,audioPacketsReceived:0,framesDecoded:0,framesDropped:0,framesReceived:0,audioBitrate:0}},e.prototype.startProbeTimeout=function(){var e=this;this.probeTimer=setTimeout((function(){e.logger.error(n.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" probe timeout"),e.player.playStateUpdateError(o.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kProbeTimeOutError)}),this.probeTimeoutInterval)},e.prototype.stopProbeTimeout=function(){this.probeTimer&&(clearTimeout(this.probeTimer),this.probeTimer=null)},e}();t.PlayStreamQuality=a},3849:function(e,t,r){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoPlayWeb=void 0;var n=r(6706),o=r(4767),s=r(608),a=r(3529),c=r(1089),l=r(5634),u=function(){function e(e,t,r,i,o,s,a){this.state=n.ENUM_PLAY_STATE.stop,this.candidateInfo=[],this.broadcasterStatus=n.ENUM_BROADCASTER_STATUS.stop,this.playQualityList=[],this.maxQualityListCount=10,this.reportSeq=NaN,this.streamReportSeq=n.getSeq(),this.videoSizeCallback=!1,this.remoteStream=null,this.playStream=null,this.playOption={},this.playMediaStatus={video:!0,audio:!0},this.closeSessionSignal=!1,this.stateNego=n.ENUM_PLAY_STATE_NEGO.stop,this.negoTimer=null,this.negoInterval=25e3,this.cameraStatus=0,this.micStatus=0,this.hasSentStreamStatus=!1,this.playEvent=!1,this.gotStreamStatus=!1,this.soundLevel=0,this.mic=null,this.script=null,this.beginTime=0,this.firstFrameTime=0,this.resourceMode=0,this.gwNode="",this.gwNodeList=[],this.gwNodeTTL=0,this.isPeer=!1,this.peerFailCount=0,this.isProbe=!1,this.peerID=0,this.isRecvClientInfo=!1,this.audioMuteState="0",this.videoMuteState="0",this.first_pkt=!0,this.next_sn=[],this.pkt_list=[],this.onDataChannelList=[],this.iceDisconnectedMaxTime=15e3,this.logger=e,this.signal=t,this.dataReport=r,this.streamCenter=o,this.ac=s,this.stateCenter=a,this.dataReport.newReport(this.streamReportSeq),this.dataReport.addMsgInfo(this.streamReportSeq,{abs_time:Date.now()}),this.qualityHandler=new l.PlayStreamQuality(i,this,this.logger,this.dataReport),this.resourceMode=this.stateCenter.settingConfig.getSetting("resource_mode")}return Object.defineProperty(e.prototype,"probeState",{get:function(){return this.qualityHandler.probeState},set:function(e){this.qualityHandler.probeState=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"netQuality",{get:function(){return this.qualityHandler.netQuality},set:function(e){this.qualityHandler.netQuality=e},enumerable:!1,configurable:!0}),e.prototype.startPlay=function(e,t,r){var i=this;if(this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" called ",e),this.playEvent=!1,this.signal&&this.signal.negoInterval&&(this.negoInterval=this.signal.negoInterval),e){this.streamId=e,this.getRemoteStreamSuc=t,this.playOption=r||{},this.playMediaStatus={video:void 0===this.playOption.video||!!this.playOption.video,audio:void 0===this.playOption.audio||!!this.playOption.audio},r&&r.videoCodec&&(this.playOption.videoCodec=r.videoCodec);var n=this.stateCenter.settingConfig.getSetting("play_video_codec",!0);n&&(this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" setting play_video_codec "+n),this.playOption.videoCodec=n),this.dataReport.addMsgInfo(this.reportSeq,{audio_activate:a.ZegoRTCLogEvent.kZegoTaskPlayStart.audio_activate(1==this.playOption.audio?1:0==this.playOption.audio?0:1),video_activate:a.ZegoRTCLogEvent.kZegoTaskPlayStart.video_activate(1==this.playOption.video?1:0==this.playOption.video?0:1)}),this.isPeer?this.createOffer():this.createSession(),this.negoTimer=setTimeout((function(){i.logger.error(c.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" waiting timeout"),i.playStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayNegoTimeoutError)}),this.negoInterval),this.isProbe&&this.qualityHandler.startProbeTimeout()}else this.logger.warn(c.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" streamId is null")},e.prototype.onCreatePlaySessionSuccess=function(e){var t=this;this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS+" "+this.streamId+" success");var r=[];if(e.turn_server){var i=e.turn_server,n=this.stateCenter.turnOverTcpOnly,o=this.stateCenter.settingConfig.getSetting("udp_or_tcp",!0);o&&(this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS+" setting udp_or_tcp "+o),n="tcp"===o),n&&(i=i.replace("udp","tcp")),this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS+" turn over tcp "+i),r.push(i)}e.stun_server&&r.push(e.stun_server);var s={iceTransportPolicy:"relay",iceServers:[{urls:r,username:e.turn_username,credential:e.turn_auth_key}]};this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS+" "+this.streamId+" username: "+e.turn_username),this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS+" "+this.streamId+" credential: "+e.turn_auth_key),this.createOffer(s),this.signal.registerPushCallback("MediaDescPush",this.sessionId,(function(e,r,i){t.onRecvMediaDesc(e,r,i)})),this.signal.registerPushCallback("CandidateInfoPush",this.sessionId,(function(e,r,i){t.onRecvCandidateInfo(e,r,i)})),this.signal.registerPushCallback("CloseSessionPush",this.sessionId,(function(e,r,i){t.onRecvCloseSession(e,r,i)})),this.signal.registerPushCallback("SessionResetPush",this.sessionId,(function(e,r,i){t.onRecvResetSession(e,r,i)})),this.signal.registerPushCallback("StreamStatusNotifyPush",this.sessionId,(function(e,r,i){t.gotStreamStatus=!0,t.streamStatus=i,t.playStream&&t.onRecvStreamStatus(i)})),this.signal.registerPushCallback("PlayEventPush",this.sessionId,(function(e,r,i){t.onRecvPlayEvent(e,r,i)})),this.signal.registerPushCallback("ClientInfoPush",this.sessionId,(function(e,r,i){t.onRecvClientInfo(e,r,i)})),this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS+" "+this.streamId+" call success")},e.prototype.createOffer=function(e){var t=this;this.peerConnection=new RTCPeerConnection(e),this.peerConnection.onicecandidate=function(e){t.onIceCandidate(e)},this.peerConnection.onsignalingstatechange=function(e){t.onConnectionStateChange(e)},this.peerConnection.oniceconnectionstatechange=function(e){t.onIceConnectionStateChange(e)},this.peerConnection.ontrack=function(e){t.onGotRemoteStream(e.streams[0])},this.streamCenter.isDataChannelEnabled&&(this.dataChannel=this.peerConnection.createDataChannel(this.streamId),this.dataChannel.binaryType="arraybuffer",this.dataChannel.onopen=function(e){t.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS+" "+t.streamId+" data channel open")},this.dataChannel.onmessage=function(e){if(t.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS+" "+t.streamId+" data channel onmessage"),e.data instanceof Blob){var r=new FileReader,i={};r.readAsArrayBuffer(e.data),r.onload=function(){i.data=r.result,t.onReceivedDataChannel(i)}}else t.onReceivedDataChannel(e)});var r={offerToReceiveAudio:1,offerToReceiveVideo:1};this.playOption&&!1===this.playOption.video&&(r.offerToReceiveVideo=0),this.playOption&&!1===this.playOption.audio&&(r.offerToReceiveAudio=0),this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS+" "+this.streamId+" createOffer: "+JSON.stringify(r)),this.dataReport.eventStart(this.reportSeq,"CreateOffer"),this.dataReport.eventStart(this.streamReportSeq,"CreateOffer"),this.peerConnection.createOffer(r).then((function(e){t.dataReport.eventEnd(t.reportSeq,"CreateOffer"),t.dataReport.eventEnd(t.streamReportSeq,"CreateOffer"),t.onCreateOfferSuccess(e)}),(function(e){t.dataReport.eventEndWithMsg(t.reportSeq,"CreateOffer",{error:e.toString()}),t.dataReport.eventEndWithMsg(t.streamReportSeq,"CreateOffer",{error:e.toString()}),t.logger.error(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS+" "+t.streamId+" create offer error "+e.toString()),t.playStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kCreateOfferError,!0)}))},e.prototype.createSession=function(e){var t=this;this.sessionSeq=n.getSeq();var r=this.streamId;1==this.streamCenter.testEnvironment&&(r="zegotest-"+this.streamCenter.appid+"-"+this.streamId);var i=this.stateCenter.settingConfig.getSetting("gw_nodes");if(i&&i instanceof Array&&i.length>0&&(this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" setting "+JSON.stringify(i)),this.gwNodeList=i,this.gwNode=this.gwNodeList[0]||this.gwNode),this.isPeer){this.dataReport.eventStart(this.reportSeq,"CreateSessionWithSdp"),this.dataReport.eventStart(this.streamReportSeq,"CreateSessionWithSdp");var o=this.stateCenter.settingConfig.getSetting("l3_play_buffer_ms");this.signal.createSessionWithSdp({seq:this.sessionSeq,type:this.isProbe?2:1,mode:0,streamId:r,strAuthParam:this.playOption&&this.playOption.streamParams||"",sdp:e.sdp,serverHost:this.gwNode,playBufLevel:2==this.resourceMode?o:void 0},(function(e,r,i){t.handleCreateSessionWithSdpResp(e,r,i)}),(function(r,i){t.dataReport.eventEndWithMsg(t.reportSeq,"CreateSession",{error:r}),t.dataReport.eventEndWithMsg(t.streamReportSeq,"CreateSession",{error:r}),!t.isProbe&&r==n.SEND_MSG_TIMEOUT&&t.peerFailCount<2?(t.peerFailCount++,t.createSession(e)):!t.isProbe&&r==n.SEND_MSG_TIMEOUT&&t.peerFailCount>=2?(t.isPeer=!1,t.streamCenter.isPeer=!1,t.createSession()):t.playStateUpdateError(r==n.SEND_MSG_TIMEOUT?a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kSessionTimeoutError:a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kSessionRequestError)}))}else this.dataReport.eventStart(this.reportSeq,"CreateSession"),this.dataReport.eventStart(this.streamReportSeq,"CreateSession"),this.signal.createSession(this.sessionSeq,1,0,r,this.playOption&&this.playOption.streamParams,this.gwNode,(function(e,r,i){t.handleCreateSessionResp(e,r,i)}),(function(e,r){t.dataReport.eventEndWithMsg(t.reportSeq,"CreateSession",{error:e}),t.dataReport.eventEndWithMsg(t.streamReportSeq,"CreateSession",{error:e}),t.playStateUpdateError(e==n.SEND_MSG_TIMEOUT?a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kSessionTimeoutError:a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kSessionRequestError)}));this.state=n.ENUM_PLAY_STATE.waitingSessionRsp,this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" "+this.streamId+" called success"),this.stateNego=n.ENUM_PLAY_STATE_NEGO.start},e.prototype.handleCreateSessionResp=function(e,t,r){var i=r.turn_server,n=i.split("?")[0]&&i.split("?")[0].slice(5),o=this.streamCenter.server.split("?"),s=o[1]&&o[1].slice(2);this.dataReport.eventEndWithMsg(this.streamReportSeq,"CreateSession",{sessionId:r.session_id,url:"webrtc://"+n+"/"+s+"/"+this.streamId}),this.dataReport.eventEndWithMsg(this.reportSeq,"CreateSession",{sessionId:r.session_id,url:"webrtc://"+n+"/"+s+"/"+this.streamId}),this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" "+this.streamId+" sessionId:"+r.session_id),this.sessionSeq==e?(this.gwNodeList=r.gw_nodes&&r.gw_nodes.length>0?r.gw_nodes:this.gwNodeList,this.gwNode=r.gw_nodes&&r.gw_nodes.length>0?this.gwNodeList[0]:this.gwNode,this.gwNodeTTL=r.gw_nodes_ttl?(new Date).getTime()+1e3*r.gw_nodes_ttl:this.gwNodeTTL,this.stateCenter.clientIP=r.clientip?r.clientip:this.stateCenter.clientIP,0!==r.result?(this.logger.error(c.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" "+this.streamId+" create error"),this.playStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kSessionRequestError)):(this.sessionId=r.session_id,this.sessionToken=r.session_token,this.dataReport.addMsgInfo(this.reportSeq,{session_id:a.ZegoRTCLogEvent.kZegoTaskPlayStart.session_id(this.sessionId)}),this.onCreatePlaySessionSuccess(r))):this.logger.error(c.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" seq is not match.")},e.prototype.handleCreateSessionWithSdpResp=function(e,t,r){var i=this;this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_HANDLE_CREATE_SESSION_WITH_SDP+" sessionId:"+t),this.sessionSeq==e?(this.gwNodeList=r.gw_nodes&&r.gw_nodes.length>0?r.gw_nodes:this.gwNodeList,this.gwNode=r.gw_nodes&&r.gw_nodes.length>0?this.gwNodeList[0]:this.gwNode,this.gwNodeTTL=r.gw_nodes_ttl?(new Date).getTime()+1e3*r.gw_nodes_ttl:this.gwNodeTTL,this.stateCenter.clientIP=r.clientip?r.clientip:this.stateCenter.clientIP,this.dataReport.eventEndWithMsg(this.streamReportSeq,"CreateSessionWithSdp",{sessionId:t}),this.dataReport.eventEndWithMsg(this.reportSeq,"CreateSessionWithSdp",{sessionId:t}),0!==r.result?(this.logger.error(c.ZEGO_WEBRTC_ACTION.PLAYER_HANDLE_CREATE_SESSION_WITH_SDP+" create session failed "+r.result),this.playStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kSessionRequestError)):(this.sessionId=t,this.sessionToken=r.session_token,this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_HANDLE_CREATE_SESSION_WITH_SDP+" create session success ",this.streamId),this.signal.registerPushCallback("CloseSessionPush",this.sessionId,(function(e,t,r){i.onRecvCloseSession(e,t,r)})),this.signal.registerPushCallback("SessionResetPush",this.sessionId,(function(e,t,r){i.onRecvResetSession(e,t,r)})),this.signal.registerPushCallback("StreamStatusNotifyPush",this.sessionId,(function(e,t,r){i.gotStreamStatus=!0,i.streamStatus=r,i.playStream&&i.onRecvStreamStatus(r)})),this.signal.registerPushCallback("PlayEventPush",this.sessionId,(function(e,t,r){i.onRecvPlayEvent(e,t,r)})),this.signal.registerPushCallback("ClientInfoPush",this.sessionId,(function(e,t,r){i.onRecvClientInfo(e,t,r)})),this.signal.registerPushCallback("NetQualityProbeRsp",this.sessionId,(function(e,t,r){i.onRecvPlayEvent(e,t,r)})),this.signal.registerPushCallback("NetQualityInfoPush",this.sessionId,(function(e,t,r){i.onRecvNetQualityInfo(e,t,r)})),this.onGetRemoteOfferSuccess(r.sdp))):this.logger.error(c.ZEGO_WEBRTC_ACTION.PLAYER_HANDLE_CREATE_SESSION_WITH_SDP+" seq is not match.")},e.prototype.onCreateOfferSuccess=function(e){var t=this;this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_OFFER_SUCCESS+" "+this.streamId+" localSdp1 "+e.sdp.substr(0,e.sdp.length/2)),this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_OFFER_SUCCESS+" "+this.streamId+" localSdp2 "+e.sdp.substr(e.sdp.length/2)),e.sdp=e.sdp.replace(/sendrecv/g,"recvonly"),e.sdp=e.sdp.replace(/useinbandfec=/,"stereo=1;useinbandfec=");var r=e.sdp.match(/m=application[\s\S]+datachannel[\s\S]+/)?e.sdp.match(/m=application[\s\S]+datachannel[\s\S]+/)[0]:null;if(r){var i=r.replace(/recvonly/,"sendrecv");e.sdp=e.sdp.replace(r,i)}var n=e.sdp.match(/m=video(.|\r|\n)*a=rtpmap(.|\r|\n)*(a=fmtp:(102).*)/);if(null!==n){var s=n[3];e.sdp=e.sdp.replace(s,s+";sps-pps-idr-in-keyframe=1")}this.playOption.videoCodec&&(e.sdp=o.SdpUtil.getSDPByVideDecodeType(e.sdp,this.playOption.videoCodec)),this.dataReport.eventStart(this.reportSeq,"SetLocalDescription"),this.dataReport.eventStart(this.streamReportSeq,"SetLocalDescription"),this.peerConnection.setLocalDescription(e).then((function(){t.dataReport.eventEnd(t.reportSeq,"SetLocalDescription"),t.dataReport.eventEnd(t.streamReportSeq,"SetLocalDescription"),t.onSetLocalDescriptionSuccess(e)}),(function(e){t.logger.error(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_OFFER_SUCCESS+" "+t.streamId+" set error "+e.toString()),t.dataReport.eventEnd(t.reportSeq,"SetLocalDescription",{error:e.toString()}),t.dataReport.eventEnd(t.streamReportSeq,"SetLocalDescription",{error:e.toString()}),t.playStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kSetLocalDescError,!0)}))},e.prototype.onSetLocalDescriptionSuccess=function(e){var t=this;if(this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+this.streamId+" success"),this.isPeer)this.createSession(e);else{var r={sdp:e.sdp};2==this.resourceMode&&(r.min_play_buf_level_ms=500),this.answerSeq=n.getSeq(),this.dataReport.eventStart(this.reportSeq,"SendMediaDesc"),this.dataReport.eventStart(this.streamReportSeq,"SendMediaDesc"),this.signal.sendMediaDesc(this.answerSeq,this.sessionId,0,r,(function(e,r,i){t.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+t.streamId+" sendMediaDesc resp"),t.answerSeq==e&&t.sessionId==r?(t.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+t.streamId+" send success stateNego:waiterAnswer"),t.stateNego=n.ENUM_PLAY_STATE_NEGO.waiterAnswer,t.dataReport.eventEnd(t.reportSeq,"SendMediaDesc"),t.dataReport.eventEnd(t.streamReportSeq,"SendMediaDesc"),t.state=n.ENUM_PLAY_STATE.waitingServerAnswer):t.logger.error(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+t.streamId+" seq or sessionId is not equal "+t.answerSeq+" "+e,0+t.sessionId+" "+r)}),(function(e,r){t.logger.error(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+t.streamId+" failed to send "+e),t.dataReport.eventEndWithMsg(t.reportSeq,"SendMediaDesc",{error:e}),t.dataReport.eventEndWithMsg(t.streamReportSeq,"SendMediaDesc",{error:e}),t.playStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kMediaDescError)})),this.state=n.ENUM_PLAY_STATE.waitingOfferRsp}},e.prototype.onRecvMediaDesc=function(e,t,r){this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" "+this.streamId+" received ",r),this.stateNego=n.ENUM_PLAY_STATE_NEGO.waitingCandidate,this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" "+this.streamId+" received stateNego:waitingCandidate"),this.state===n.ENUM_PLAY_STATE.waitingServerAnswer?(this.dataReport.addEvent(this.reportSeq,"RecvMediaDesc"),this.dataReport.addEvent(this.streamReportSeq,"RecvMediaDesc"),this.signal.sendMediaDescAck(e,this.sessionId,0),this.onGetRemoteOfferSuccess(r.sdp)):this.logger.error(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" "+this.streamId+" current state "+this.state+" not allowed")},e.prototype.onGetRemoteOfferSuccess=function(e){var t,r=this,i={type:"answer",sdp:e,toJSON:function(){}};this.dataReport.eventStart(this.reportSeq,"SetRemoteDescription"),this.dataReport.eventStart(this.streamReportSeq,"SetRemoteDescription");var o=this.stateCenter.turnOverTcpOnly,s=this.stateCenter.settingConfig.getSetting("udp_or_tcp",!0);s&&(this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" setting udp_or_tcp "+s),o="tcp"===s),o&&(null===(t=i.sdp.match(/candidate.*/g))||void 0===t||t.forEach((function(e){var t=e.replace(/udp/,"tcp");i.sdp=i.sdp.replace(e,t)}))),this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" "+this.streamId+" remoteSdp ",i.sdp),this.peerConnection.setRemoteDescription(new RTCSessionDescription(i)).then((function(){r.dataReport.eventEnd(r.reportSeq,"SetRemoteDescription"),r.dataReport.eventEnd(r.streamReportSeq,"SetRemoteDescription"),r.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" "+r.streamId+" set success")}),(function(e){r.logger.error(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" "+r.streamId+" set remote error "+e.toString()),r.dataReport.eventEndWithMsg(r.reportSeq,"SetRemoteDescription",{error:e.toString()}),r.dataReport.eventEndWithMsg(r.streamReportSeq,"SetRemoteDescription",{error:e.toString()}),r.playStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kSetRemoteDescError,!0)})),this.state=n.ENUM_PLAY_STATE.waitingServerICE,this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" "+this.streamId+" call success")},e.prototype.onRecvCandidateInfo=function(e,t,r){var i=this;if(this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_CANDIDATE_INFO+" "+this.streamId+" received "),this.state==n.ENUM_PLAY_STATE.waitingServerICE){this.dataReport.addEvent(this.reportSeq,"RecvIceCandidate"),this.dataReport.addEvent(this.streamReportSeq,"RecvIceCandidate"),this.signal.sendCandidateInfoAck(e,this.sessionId,0),this.sendCandidateInfo(this.candidateInfo),this.candidateInfo=[];for(var o=0;o<r.infos.length;o++){var s={sdpMid:r.infos[o].sdpMid,sdpMLineIndex:r.infos[o].sdpMLineIndex,candidate:r.infos[o].candidate};this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_CANDIDATE_INFO+" "+this.streamId+" candidate "+s.candidate),this.peerConnection.addIceCandidate(new RTCIceCandidate(s)).then((function(){i.logger.debug(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_CANDIDATE_INFO+" "+i.streamId+" add success")}),(function(e){i.logger.error(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_CANDIDATE_INFO+" "+i.streamId+" add error "+e.toString()),i.playStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kCandidateError,!0)}))}this.state=n.ENUM_PLAY_STATE.connecting,this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_CANDIDATE_INFO+" "+this.streamId+" call success")}else this.logger.warn(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_CANDIDATE_INFO+" "+this.streamId+" current state "+this.state+" not allowed")},e.prototype.onRecvPlayEvent=function(e,t,r){if(this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_PLAY_EVENT+" "+this.streamId+" received"),!0===this.playEvent&&0==r.event){this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_PLAY_EVENT+" "+this.streamId+" retry: "+this.streamId);var i=this.streamId,o=this.playOption;this.signal.sendCloseSession(n.getSeq(),this.sessionId,1),this.resetPlay(),this.startPlay(i,this.getRemoteStreamSuc,o)}else this.playEvent=!0},e.prototype.onRecvClientInfo=function(e,t,r){this.stateCenter.clientIP!==r.clientip&&this.logger.warn(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_CLIENT_INFO+" client ip changed "+this.stateCenter.clientIP+" "+r.clientip),this.stateCenter.clientIP=r.clientip,this.peerID=r.peer_id,this.isProbe&&this.stateNego==n.ENUM_PLAY_STATE_NEGO.iceConnected&&this.signal.sendNetProbe(n.getSeq(),this.sessionId,this.peerID,(function(){}),(function(){})),this.isRecvClientInfo=!0},e.prototype.onRecvNetQualityInfo=function(e,t,r){this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_NET_QUALITY_INFO+" call"),this.qualityHandler.stopProbeTimeout();var i=0,o=r.lossrate,a=r.rtt;this.peerID===r.peer_id&&null!=typeof o&&null!=typeof a||(this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_NET_QUALITY_INFO+" local peerID:"+this.peerID+" remote peerID:"+r.peer_id+" lossrate:"+o+" rtt:"+a),i=1),this.signal.sendNetQualityInfoPushAck(n.getSeq(),this.sessionId,this.peerID,i),0==i&&"number"==typeof o&&"number"==typeof a?this.onCalNetQualityResult(0,s.ClientUtil.getNetQuality(a,o)):this.onCalNetQualityResult(1)},e.prototype.onIceCandidate=function(e){if(this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CANDIDATE+" "+this.streamId+" called"),null!=e.candidate)if(this.logger.debug(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CANDIDATE+" "+this.streamId+" candidate "+e.candidate.candidate),this.state<n.ENUM_PLAY_STATE.connecting||this.state==n.ENUM_PLAY_STATE.stop)this.logger.debug(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CANDIDATE+" "+this.streamId+" cached"),this.candidateInfo.push({candidate:e.candidate.candidate,sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex});else{this.logger.debug(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CANDIDATE+" "+this.streamId+" send");var t={candidate:e.candidate.candidate,sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex};this.sendCandidateInfo([t])}},e.prototype.onConnectionStateChange=function(e){this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_CONNECTION_STATE_CHANGE+" "+this.streamId+" called "+e.target.signalingState)},e.prototype.onIceConnectionStateChange=function(e){var t=this;if(this.state!=n.ENUM_PLAY_STATE.stop&&null!=this.peerConnection)if(this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CONNECTION_STATE_CHANGE+" "+this.streamId+" stateChanged "+this.peerConnection.iceConnectionState),"connected"===this.peerConnection.iceConnectionState){if(this.stateNego=n.ENUM_PLAY_STATE_NEGO.iceConnected,this.isProbe&&this.isPeer&&this.isRecvClientInfo)return this.signal.sendNetProbe(n.getSeq(),this.sessionId,this.peerID,(function(){}),(function(){})),void(null!=this.negoTimer&&(clearTimeout(this.negoTimer),this.negoTimer=null));for(var r in null!=this.negoTimer&&(clearTimeout(this.negoTimer),this.negoTimer=null),null!=this.iceDisconnectedTimer&&(clearTimeout(this.iceDisconnectedTimer),this.iceDisconnectedTimer=null),this.dataReport.addEvent(this.reportSeq,"IceConnected"),this.dataReport.addEvent(this.streamReportSeq,"IceConnected"),this.state!=n.ENUM_PLAY_STATE.playing&&(this.onPlayStateUpdate(n.ENUM_PLAY_STATE_UPDATE.start,this.streamId,{code:0,message:""},!0),this.getRemoteStreamSuc&&this.getRemoteStreamSuc(this.playStream)),this.state=n.ENUM_PLAY_STATE.playing,this.dataReport.eventStart(this.reportSeq,"PlayState"),this.dataReport.eventStart(this.streamReportSeq,"PlayState"),this.streamCenter.publisherList)if(this.streamCenter.publisherList[r].publisher.state==n.ENUM_PUBLISH_STATE.publishing&&this.broadcasterStatus==n.ENUM_BROADCASTER_STATUS.stop){this.signal&&this.signal.sendBroadcasterStatus(n.getSeq(),this.sessionId,1),this.broadcasterStatus=n.ENUM_BROADCASTER_STATUS.start;break}if(!this.isProbe&&this.qualityHandler.setPlayQualityTimer(),this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CONNECTION_STATE_CHANGE+" "+this.streamId+" stateNego:iceConnected"),this.isPeer&&(this.peerFailCount=0),0==this.firstFrameTime){this.firstFrameTime=(new Date).getTime()-this.beginTime;var i=n.getReportSeq();this.dataReport.newReport(i,a.ZegoRTCLogEvent.kZegoTaskPlayDecodeFirstVideoFrame.event),this.dataReport.addMsgInfo(i,{session_id:a.ZegoRTCLogEvent.kZegoTaskPlayDecodeFirstVideoFrame.session_id(this.sessionId),fft_consumed:a.ZegoRTCLogEvent.kZegoTaskPlayDecodeFirstVideoFrame.fft_consumed(this.firstFrameTime)}),!this.isProbe&&this.dataReport.uploadReport(i)}}else"closed"===this.peerConnection.iceConnectionState?(this.dataReport.addEvent(this.reportSeq,"IceClosed"),this.stateNego=n.ENUM_PLAY_STATE_NEGO.iceClosed,this.checkPlayConnectionFailedState(this.peerConnection.iceConnectionState)):"failed"===this.peerConnection.iceConnectionState?(this.dataReport.addEvent(this.reportSeq,"IceFailed"),this.stateNego=n.ENUM_PLAY_STATE_NEGO.iceFailed,this.checkPlayConnectionFailedState(this.peerConnection.iceConnectionState)):"disconnected"===this.peerConnection.iceConnectionState&&(this.dataReport.addEvent(this.reportSeq,"IceDisconnected"),this.stateNego=n.ENUM_PLAY_STATE_NEGO.iceDisconnected,this.logger.warn(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CONNECTION_STATE_CHANGE+" ice disconnected"),this.iceDisconnectedTimer||(this.iceDisconnectedTimer=setTimeout((function(){t.checkPlayConnectionFailedState("disconnected")}),this.iceDisconnectedMaxTime)))},e.prototype.checkPlayConnectionFailedState=function(e){this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CONNECTION_STATE_CHANGE+"  state "+this.state+" connectionState "+e),this.playStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kMediaConnectionError)},e.prototype.resetPlay=function(){this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_RESET_PLAY+" "+this.streamId+" call"),this.state=n.ENUM_PLAY_STATE.stop,this.playEvent=!1,this.isRecvClientInfo=!1,null!=this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null),null!=this.negoTimer&&(clearTimeout(this.negoTimer),this.negoTimer=null),null!=this.iceDisconnectedTimer&&(clearTimeout(this.iceDisconnectedTimer),this.iceDisconnectedTimer=null),this.qualityHandler.stopProbeTimeout(),this.qualityHandler.clearPlayQualityTimer(),this.signal&&(this.signal.unregisterPushCallback("MediaDescPush",this.sessionId),this.signal.unregisterPushCallback("CandidateInfoPush",this.sessionId),this.signal.unregisterPushCallback("CloseSessionPush",this.sessionId),this.signal.unregisterPushCallback("SessionResetPush",this.sessionId),this.signal.unregisterPushCallback("PublishEventPush",this.sessionId),this.signal.unregisterPushCallback("ClientInfoPush",this.sessionId),this.signal.unregisterPushCallback("NetQualityProbeRsp",this.sessionId),this.signal.unregisterPushCallback("NetQualityInfoPush",this.sessionId)),this.sessionSeq=0,this.answerSeq=0,this.videoSizeCallback=!1,this.stopSoundLevel()},e.prototype.onRecvResetSession=function(e,t,r){if(this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_RESET_SESSION+" "+this.streamId+" received "),t==this.sessionId){this.signal.sendCloseSessionAck(e,this.sessionId,0);var i=JSON.parse(JSON.stringify(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlaySessionClosedError));this.negoTimer&&clearTimeout(this.negoTimer),this.playStateUpdateError(i)}else this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_RESET_SESSION+" "+this.streamId+" cannot find session")},e.prototype.onRecvCloseSession=function(e,t,r){this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_CLOSE_SESSION+" "+this.streamId+" "+JSON.stringify(r)),this.signal.sendCloseSessionAck(e,this.sessionId,0);var i=r.err_info?JSON.parse(r.err_info.toLowerCase()):{},n=i.action?i.action:null,o=1*r.reason,s=JSON.parse(JSON.stringify(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlaySessionClosedError));s.message+=" reason:"+o+" "+(n?" action:"+n:""),this.negoTimer&&clearTimeout(this.negoTimer);var l=![4,8,10,11,12,14,24,26,27,28].includes(o)&&![2,5,6].includes(n);this.playStateUpdateError(s,l)},e.prototype.onRecvStreamStatus=function(e){if(this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_STREAM_STATUS+" "+this.streamId+" call"),this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_STREAM_STATUS+" "+this.streamId+" status camera_status: "+e.camera_status+" mic_status: "+e.mic_status),(!this.hasSentStreamStatus||this.cameraStatus!==e.camera_status)&&this.onRemoteCameraStatusUpdate(this.streamId,this.getCameraMicStatus(e.camera_status),e.camera_status),(!this.hasSentStreamStatus||this.micStatus!==e.mic_status)&&this.onRemoteMicStatusUpdate(this.streamId,this.getCameraMicStatus(e.mic_status),e.mic_status),this.hasSentStreamStatus=!0,this.cameraStatus=e.camera_status,this.micStatus=e.mic_status,this.videoMuteState=0===e.camera_status?"0":"1",this.audioMuteState=0===e.mic_status?"0":"1","boolean"==typeof this.playOption.video)this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_STREAM_STATUS+" "+this.streamId+" has set video option, ignore stream status");else{var t=this.playStream;if(0!==e.camera_status&&20!==e.camera_status?t.getVideoTracks().forEach((function(e){e.enabled=!1,e.stop(),t.removeTrack(e)})):0===t.getVideoTracks().length&&t.addTrack(this.remoteStream.clone().getVideoTracks()[0]),"safari"===this.stateCenter.browser)for(var r=document.querySelectorAll("video, audio"),i=0;i<r.length;i++)r[i].srcObject===this.playStream&&(r[i].srcObject=this.playStream)}this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_STREAM_STATUS+" "+this.streamId+" call success")},e.prototype.onGotRemoteStream=function(e){var t=this;this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_GOT_REMOTE_STREAM+" "+this.streamId+" called "+e),e?(this.playStream?(this.playStream.getTracks().forEach((function(e){return t.playStream.removeTrack(e)})),e.clone().getTracks().forEach((function(e){return t.playStream.addTrack(e)}))):this.playStream=e.clone(),this.audioMuteState=this.playStream.getAudioTracks().length>0?"0":"1",this.videoMuteState=this.playStream.getVideoTracks().length>0?"0":"1",this.remoteStream=e,this.gotStreamStatus&&this.onRecvStreamStatus(this.streamStatus),this.dataReport.addEvent(this.reportSeq,"GetRemoteStream"),this.streamCenter.soundLevelDelegate&&!this.isProbe&&this.startSoundLevel()):this.logger.warn(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_GOT_REMOTE_STREAM+" "+this.streamId+" remote stream is empty")},e.prototype.sendCandidateInfo=function(e){var t=this;this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_SEND_CANDIDATE_INFO+" "+this.streamId+" called"),!(e=e.filter((function(e){return!(e.candidate.indexOf("tcp")>0)&&(!!e.candidate||void 0)})))||e.length<1?this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_SEND_CANDIDATE_INFO+" "+this.streamId+" cancelled"):(this.dataReport.eventStart(this.reportSeq,"SendIceCandidate"),this.dataReport.eventStart(this.streamReportSeq,"SendIceCandidate"),this.stateNego!==n.ENUM_PLAY_STATE_NEGO.iceConnected&&(this.stateNego=n.ENUM_PLAY_STATE_NEGO.sendCandidate),this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_SEND_CANDIDATE_INFO+" "+this.streamId+" stateNego:sendCandidate"),this.signal.sendCandidateInfo(n.getSeq(),this.sessionId,e,(function(e,r,i){t.logger.debug(c.ZEGO_WEBRTC_ACTION.PLAYER_SEND_CANDIDATE_INFO+" "+t.streamId+" send success"),t.dataReport.eventEnd(t.reportSeq,"SendIceCandidate"),t.dataReport.eventEnd(t.streamReportSeq,"SendIceCandidate")}),(function(e,r){t.logger.error(c.ZEGO_WEBRTC_ACTION.PLAYER_SEND_CANDIDATE_INFO+" "+t.streamId+" failed to send: "+e.toString()),t.dataReport.eventEndWithMsg(t.reportSeq,"SendIceCandidate",{error:e}),t.dataReport.eventEndWithMsg(t.streamReportSeq,"SendIceCandidate",{error:e}),t.playStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kCandidateError)})))},e.prototype.shouldSendCloseSession=function(){return this.state!=n.ENUM_PLAY_STATE_UPDATE.stop&&this.state!=n.ENUM_PLAY_STATE.waitingSessionRsp},e.prototype.playStateUpdateError=function(e,t){this.logger.error(c.ZEGO_WEBRTC_ACTION.PLAYER_STATE_ERROR+" call ",this.streamId,JSON.stringify(e)),this.isProbe?this.onCalNetQualityResult(1):this.streamId&&this.onPlayStateUpdate(n.ENUM_PLAY_STATE_UPDATE.error,this.streamId,e,t),this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_STATE_ERROR+" "+this.streamId+" ended")},e.prototype.getCameraMicStatus=function(e){return 0==e?"OPEN":"MUTE"},e.prototype.onPlayStateUpdate=function(e,t,r,i){},e.prototype.onPlayQualityUpdate=function(e,t){},e.prototype.onRemoteCameraStatusUpdate=function(e,t,r){},e.prototype.onRemoteMicStatusUpdate=function(e,t,r){},e.prototype.stopPlay=function(){var e;for(var t in this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_STOP_PLAY+" "+this.streamId+" called"),this.streamCenter.publisherList)if(this.streamCenter.publisherList[t].publisher.state==n.ENUM_PUBLISH_STATE.publishing&&this.broadcasterStatus==n.ENUM_BROADCASTER_STATUS.start){this.signal&&this.signal.sendBroadcasterStatus(n.getSeq(),this.sessionId,0),this.broadcasterStatus=n.ENUM_BROADCASTER_STATUS.stop;break}this.sessionId&&!this.closeSessionSignal&&this.signal.sendCloseSession(n.getSeq(),this.sessionId,0),this.dataReport.eventEndWithMsg(this.streamReportSeq,"PlayState",{state:this.state+""}),this.dataReport.addEvent(this.streamReportSeq,"StopPlay"),this.dataReport.addMsgExt(this.streamReportSeq,{stream:this.streamId,sessionId:this.sessionId}),this.resetPlay();var r=this.qualityHandler,o=r.videoBreak,s=r.audioBreak,a=2===this.resourceMode?"l3":"rtc",l=((e={})[a+"_a_break_time"]=s.cumulativeBreakDuration,e[a+"_a_decode_time"]=s.cumulativeDecodeDuration,e[a+"_v_break_time"]=o.cumulativeBreakDuration,e[a+"_v_decode_time"]=o.cumulativeDecodeDuration,e);this.dataReport.addMsgInfo(this.streamReportSeq,i({itemtype:"RTCPlayStream",cdn_a_break_time:0,cdn_a_decode_time:0,cdn_v_break_time:0,cdn_v_decode_time:0,l3_a_break_time:0,l3_a_decode_time:0,l3_v_break_time:0,l3_v_decode_time:0,rtc_a_break_time:0,rtc_a_decode_time:0,rtc_v_break_time:0,rtc_v_decode_time:0},l)),!this.isProbe&&this.dataReport.uploadReport(this.streamReportSeq,"RTCPlayStream")},e.prototype.onDisconnect=function(e){this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_ON_DISCONNECT+" "+this.streamId+" call"),this.dataReport.addEvent(this.reportSeq,"OnDisconnect"),this.playStateUpdateError(e||a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kWebsocketDisconnectedError,!!e)},e.prototype.startSoundLevel=function(){var e=this;if(this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_START_SOUND_LEVEL+" call streamID: "+this.streamId),!this.isProbe)if(this.remoteStream&&0!=this.remoteStream.getAudioTracks().length){this.script&&this.script.disconnect()&&(this.script=null),this.mic&&this.mic.disconnect()&&(this.mic=null);try{this.mic=this.ac.createMediaStreamSource(this.remoteStream),this.script=this.ac.createScriptProcessor(4096,1,1),this.mic.connect(this.script),this.script.connect(this.ac.destination),this.script.onaudioprocess=function(t){for(var r=t.inputBuffer.getChannelData(0),i=0,n=0;n<r.length;n++)i<r[n]&&(i=r[n]);e.soundLevel=100*i},this.ac.resume()}catch(e){this.logger.error(c.ZEGO_WEBRTC_ACTION.PLAYER_START_SOUND_LEVEL+" get sound level failed "+e)}}else this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_START_SOUND_LEVEL+" "+this.streamId+" remote stream no found")},e.prototype.stopSoundLevel=function(){this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_STOP_SOUND_LEVEL+" call streamID: "+this.streamId),this.script&&this.script.disconnect(),this.mic&&this.mic.disconnect(),this.script=null,this.mic=null},e.prototype.onCalNetQualityResult=function(e,t){},e.prototype.onReceivedDataChannel=function(e){var t,r,i=this,n=new Uint8Array(e.data,0,10),o=e.data.byteLength-10,s=new Uint8Array(e.data,10,o);if(1==n[0]){var a=n[1],c=n[2]<<8|n[3],l=n[4]<<8|n[5],u=(new Date).getTime();if(this.first_pkt&&(this.next_sn[0]=c==l?c:l,this.first_pkt=!1),this.pkt_list.push({sn:c,sn0:l,recv_ts:u,flags:a,payload_len:o,payloadArray:s}),this.pkt_list.sort(this.compareShort),c==this.next_sn[0]){var d=this.pkt_list.filter((function(e){return e.sn0==l}));if(d.sort(this.compareShort),null!=d.find((function(e){return 1&e.flags}))&&d.length==this.compareShort(c,l)+1){for(var h=0,p=new ArrayBuffer(65536),f=0;f<d.length;f++)new Uint8Array(p).set(d[f].payloadArray,h),h+=d[f].payload_len;null===(t=this.onDataChannelList)||void 0===t||t.forEach((function(e){e(p,h,i.streamId)})),this.pkt_list=[],this.first_pkt=!0}this.next_sn[0]++}else for(var g=function(){var e=m.pkt_list.filter((function(e){return e.sn0==i.pkt_list[0].sn0}));if(e.sort(m.compareShort),null!=e.find((function(e){return 1&e.flags}))&&e.length==m.compareShort(e[e.length-1].sn,e[0].sn0)+1){for(var t=0,n=new ArrayBuffer(65536),o=0;o<e.length;o++)new Uint8Array(n).set(e[o].payloadArray,t),t+=e[o].payload_len;m.next_sn[0]=e[0].sn0+e.length,null===(r=m.onDataChannelList)||void 0===r||r.forEach((function(e){e(n,t,i.streamId)})),m.pkt_list=[],m.first_pkt=!0}else if(u-e[0].ts<4e3){var s=e[0].sn0;for(o=0;o<e.length&&s==e[o].sn;o++)s++;return m.next_sn[0]=s,"break"}for(o=0;o<e.length;o++)m.pkt_list.shift()},m=this;this.pkt_list.length>0&&"break"!==g(););}},e.prototype.compareShort=function(e,t){var r=new Uint16Array(1);r[0]=e-t;var i=new Int16Array(1);return i[0]=r[0],i[0]},e}();t.ZegoPlayWeb=u},361:function(e,t,r){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.PublishModule=void 0;var n=r(1089),o=r(6706),s=r(3529),a=r(608),c=r(2752),l=r(3770),u=r(5321),d=function(){function e(e,t,r,i,n){this.logger=e,this.dataReport=t,this.stateCenter=r,this.streamCenter=i,this.rtm=n,this.recordDevices()}return e.prototype.createStream=function(e){var t=this;return this.logger.info(n.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" call"),e&&e.camera&&e.camera.audioBitRate&&(e.camera.audioBitrate=e.camera.audioBitRate),e&&e.camera&&e.camera.bitrate&&(e.camera.bitRate=e.camera.bitrate),e&&e.screen&&"object"==typeof e.screen&&e.screen.bitrate&&(e.screen.bitRate=e.screen.bitrate),e&&e.custom&&e.custom.bitrate&&(e.custom.bitRate=e.custom.bitrate),new Promise((function(r,c){var l="camera",d=o.getReportSeq();t.dataReport.newReport(d,s.ZegoRTCLogEvent.kZegoTaskCreateStream.event);var h=function(e){var i=t.streamCenter.checkPreview(e),n=e;if(i&&navigator.userAgent){var o=navigator.userAgent.toLowerCase().match(/cpu iphone os (.*?) like mac os/);o&&o[1]&&o[1].includes("15_1")&&(n=t.getStreamThroughCanvas(e),i.localStream=n)}if(0==n.getAudioTracks().length){var s=t.streamCenter.ac.createMediaStreamDestination(),a=s?s.stream:null,c=a?a.getAudioTracks()[0]:null;c&&(c.enabled=!1,n.addTrack(c),i&&(i.hasEmptyAudioTrack=!0))}t.dataReport.uploadReport(d),!t.stateCenter.deviceInfos&&t.recordDevices(),r(n),t.streamCenter.activeSoundLevel()},p=function(e,r){void 0===r&&(r=""),t.dataReport.addMsgInfo(d,{error:e.code,message:e.message+r}),t.dataReport.uploadReport(d),c({code:e.code,msg:e.message+r})};if("https:"!==window.location.protocol&&"file:"!==window.location.protocol&&-1==window.location.hostname.indexOf("127.0.0.1")&&-1==window.location.hostname.indexOf("localhost"))return t.logger.error(n.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" https or localhost required "),void p({code:s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kBrowserNotSupportError.code,message:s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kBrowserNotSupportError.message+" https or localhost required"});if(e&&e.screen){if(l="screen",!a.ClientUtil.checkScreenParams(e.screen,p))return;var f=t.stateCenter.browser,g=t.streamCenter.getScreenConstrains(e.screen);t.dataReport.addMsgInfo(d,{stream_type:s.ZegoRTCLogEvent.kZegoTaskCreateStream.stream_type("screen"),screen:s.ZegoRTCLogEvent.kZegoTaskCreateStream.screen(g)});var m=function(e){t.streamCenter.createScreenPreviewer(e,g)&&h(e),e.getVideoTracks()[0].onended=function(){var r=o.getReportSeq();t.dataReport.newReport(r),t.dataReport.uploadReport(r,s.ZegoRTCLogEvent.kZegoTaskScreenSharingEnded),e&&t.stopPreview(e),t.stateCenter.actionListener("screenSharingEnded",e)}};"firefox"==f||"object"==typeof e.screen&&"firefox"==e.screen.type?t.startScreenShotFirFox("screen",g,(function(e,t,r){e?t&&m(t):r&&p(r)})):"chrome"==f&&u.ZegoWebRTC.screenShotReady||"object"==typeof e.screen&&"shot"==e.screen.type?t.startScreenShotChrome((function(r,i,o){r?(t.logger.info(n.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" using extension"),i&&m(i)):(o&&t.logger.error(n.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" extension "+o),"SS_DIALOG_CANCEL"===o||"object"==typeof e.screen&&"shot"==e.screen.type?o&&p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenCancelError):t.startScreenSharing(g,(function(e,r,i){e?r&&m(r):(t.logger.error(n.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" "+i),i&&p(i))})))})):"Electron"==f||"object"==typeof e.screen&&"Electron"==e.screen.type?t.startScreenShotElectron(g,(function(e,t,r){e?t&&m(t):r&&p(r)})):t.startScreenSharing(g,(function(e,t,r){e?t&&m(t):r&&p(r)}))}else{if(e&&"object"==typeof e.camera&&void 0!==e.camera.videoQuality&&!a.ClientUtil.checkInteger(e.camera.videoQuality))return t.logger.error(n.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" videoQuality must be integer number"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," videoQuality must be integer number");if(e&&e.camera&&e.camera.audioBitrate){if(!a.ClientUtil.checkInteger(e.camera.audioBitrate))return t.logger.error(n.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" audioBitrate must be integer number"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," audioBitrate must be integer number");if(e.camera.audioBitrate<6)return t.logger.error(n.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" audioBitrate cannot less 6 kbps"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," audioBitrate cannot less 6 kbps");if(e.camera.audioBitrate>510)return t.logger.error(n.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" audioBitrate cannot greater than 510 kbps"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," audioBitrate cannot greater than 510 kbps");t.stateCenter.audioBitRate=1e3*e.camera.audioBitrate}if(e&&e.camera&&e.camera.bitRate){if("number"!=typeof e.camera.bitRate)return t.logger.error(n.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" bitrate must be integer number"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," bitrate must be integer number");if(e.camera.bitRate>10240)return t.logger.error(n.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" bitrate cannot greater than 10 Mbps"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," bitrate cannot greater than 10 Mbps")}if(e&&e.camera&&void 0!==e.camera.channelCount&&!a.ClientUtil.checkInteger(e.camera.channelCount))return t.logger.error(n.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" channelCount must be integer number"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," channelCount must be integer number");if(e&&e.camera&&4===e.camera.videoQuality&&!a.ClientUtil.checkCameraParams(e.camera,p))return;if(e&&e.custom&&e.custom.bitRate){if(!a.ClientUtil.checkInteger(e.custom.bitRate))return t.logger.error(n.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" bitrate must be integer number"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," bitrate must be integer number");if(e.custom.bitRate>10240)return t.logger.error(n.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" bitrate cannot greater than 10 Mbps"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," bitrate cannot greater than 10 Mbps")}if(e&&e.custom&&e.custom.audioBitrate){if(!a.ClientUtil.checkInteger(e.custom.audioBitrate))return t.logger.error("ze.cs.0 audioBitrate must be integer number"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," audioBitrate must be integer number");if(e.custom.audioBitrate<6)return t.logger.error("ze.cs.0 audioBitrate cannot less 6 kbps"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," audioBitrate cannot less 6 kbps");if(e.custom.audioBitrate>510)return t.logger.error("ze.cs.0 audioBitrate cannot greater than 510 kbps"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," audioBitrate cannot greater than 510 kbps")}if(e&&e.custom&&void 0!==e.custom.channelCount&&1!==e.custom.channelCount&&2!==e.custom.channelCount)return t.logger.error("ze.cs.0 channelCount must number 1 or 2"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," channelCount must number 1 or 2");var _={};if(e&&e.camera)l="camera",_=e.camera,t.dataReport.addMsgInfo(d,{stream_type:s.ZegoRTCLogEvent.kZegoTaskCreateStream.stream_type("camera"),camera:s.ZegoRTCLogEvent.kZegoTaskCreateStream.camera(e.camera)}),"boolean"!=typeof _.video&&(_.video=!0),"boolean"!=typeof _.audio&&(_.audio=!0);else if(e&&e.custom){l="custom",_=e.custom;var v=e.custom.source instanceof MediaStream?"MediaStream":"HTMLElement";t.dataReport.addMsgInfo(d,{stream_type:s.ZegoRTCLogEvent.kZegoTaskCreateStream.stream_type("custom"),custom:s.ZegoRTCLogEvent.kZegoTaskCreateStream.custom(i(i({},e.custom),{source:v}))})}t.startPreview(_,l,h,p)}}))},e.prototype.destroyStream=function(e){this.logger.info(n.ZEGO_WEBRTC_ACTION.DESTROY_STREAM+" call");var t=o.getReportSeq();if(this.dataReport.newReport(t),!(e instanceof MediaStream))return this.logger.error(n.ZEGO_WEBRTC_ACTION.DESTROY_STREAM+" localStream is not mediaStream or tracks is null"),this.dataReport.addMsgInfo(t,s.ZegoRTCLogEvent.kZegoTaskDestroyStream.error.kLocalStreamError),void this.dataReport.uploadReport(t,s.ZegoRTCLogEvent.kZegoTaskDestroyStream.event);e instanceof MediaStream&&0==e.getTracks().length&&this.logger.info(n.ZEGO_WEBRTC_ACTION.DESTROY_STREAM+" tracks is null"),this.stopPreview(e),this.dataReport.uploadReport(t,s.ZegoRTCLogEvent.kZegoTaskDestroyStream.event)},e.prototype.startPublishingStream=function(e,t,r,i){this.logger.info(n.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" call ",e);var c,l=!0,u="",d=o.getReportSeq();if(this.stateCenter.reportSeqList.startPublish[e]=d,this.dataReport.newReport(d,s.ZegoRTCLogEvent.kZegoTaskPublishStart.event),l&&void 0===e&&(u="stream id required",this.logger.error(n.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+u),l=!1,c=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishParamError),!l||e&&"string"==typeof e||(u="stream id type wrong",this.logger.error(n.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" "+u),l=!1,c=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishParamError),l&&e.length>o.MAX_STREAM_ID_LENGTH&&(u="stream id length limit",this.logger.error(n.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" "+u),l=!1,c=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishParamError),l&&!a.ClientUtil.checkIllegalCharacters(e)&&(u="stream ID contains illegal characters",this.logger.error(n.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" "+u),l=!1,c=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishParamError),l&&(!t||t instanceof MediaStream&&0==t.getTracks().length)&&(u="localStream wrong",this.logger.error(n.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" "+u),l=!1,c=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishParamError),l&&!this.streamCenter.checkPreview(t)&&(u="stream is not from zego",this.logger.error(n.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" "+u),l=!1,c=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishNoPreviewError),l&&void 0!==r&&"object"!=typeof r&&(l=!1,c=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishParamError,u="publishOption must be object"),l&&void 0!==r&&void 0!==r.streamParams&&"string"!=typeof r.streamParams&&(this.logger.error(n.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" publishOption streamParams must be string"),l=!1,c=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishParamError,u=" publishOption streamParams must be string"),l&&void 0!==r&&void 0!==r.extraInfo&&"string"!=typeof r.extraInfo&&(this.logger.error(n.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" publishOption extraInfo must be string"),l=!1,c=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishParamError,u=" publishOption extraInfo must be string"),l&&void 0!==r&&void 0!==r.videoCodec&&"string"!=typeof r.videoCodec&&(this.logger.error(n.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" publishOption videoCodec must be string"),l=!1,c=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishParamError,u=" publishOption videoCodec must be string"),!l||!this.stateCenter.isMultiRoom||r&&"string"==typeof r.roomID&&""!=r.roomID||(l=!1,c=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishParamError,u=" roomID is need if set multi room"),r&&r.videoCodec&&(r.videoCodec=r.videoCodec.toUpperCase()),l&&this.rtm.service.isDisConnect()&&(this.logger.error("zc.p.sps.1 not login"),l=!1,c=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishNoLoginError),!l)return this.logger.error(n.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" "+u),this.dataReport.uploadReport(d,void 0,c,u),delete this.stateCenter.reportSeqList.startPublish[e],!1;r||(r={}),this.dataReport.addMsgInfo(d,{stream:s.ZegoRTCLogEvent.kZegoTaskPublishStart.stream(e),publishOption:s.ZegoRTCLogEvent.kZegoTaskPublishStart.publishOption(r)}),r.audioBitRate=this.stateCenter.audioBitRate;var h,p=r.roomID?r.roomID:this.stateCenter.roomList[0]?this.stateCenter.roomList[0].roomID:"",f=this.stateCenter.getRoomByRoomID(p);if(!f)return this.logger.error("zc.p.sps.1 room no found"),!1;if(this.dataReport.addMsgInfo(d,{publish_room_id:p,isMulti:this.stateCenter.isMultiRoom}),this.stateCenter.customUrl&&0!=this.stateCenter.customUrl.length)this.logger.info("zc.p.sps.1 customUrl "+JSON.stringify(this.stateCenter.customUrl)),h=this.stateCenter.customUrl;else{var g=this.stateCenter.settingConfig.getSetting("signal_nodes",!0);g&&g instanceof Array&&g.length>0&&(h=g,this.logger.info("zc.p.sps.1 setting config signal_nodes "+JSON.stringify(g)))}if(h)return this.stateCenter.publishStreamList[e]={state:o.ENUM_PUBLISH_STREAM_STATE.tryPublish,extra_info:r.extraInfo?r.extraInfo:null},this.streamCenter.setPublishStateStart(f,e,t,r,i)?(f.streamHandler.onPublishStateUpdate(o.ENUM_PUBLISH_STATE_UPDATE.retry,e,{code:0,message:""}),this.streamCenter.publisherList[e].serverUrls=h,this.streamCenter.startPublishingStream(e)):(this.logger.info("zc.p.sps.1 cannot start publish"),!1);if(!this.streamCenter.setPublishStateStart(f,e,t,r,i))return this.logger.error("zc.p.sps.1 cannot start publish"),!1;this.stateCenter.publishStreamList[e]={state:o.ENUM_PUBLISH_STREAM_STATE.tryPublish,extra_info:r.extraInfo?r.extraInfo:null},this.logger.info("zc.p.sps.1 start publish"),f.streamHandler.onPublishStateUpdate(o.ENUM_PUBLISH_STATE_UPDATE.retry,e,{code:0,message:""});var m=this.streamCenter.publisherList[e].retryDispatchHandler;return m.stopMaxTime(),m.invalid(),m.initStream(e,r,!0),m.startMaxTime(),m.active(0)},e.prototype.activateSEIInsert=function(e,t,r){return void 0===r&&(r=0),!1},e.prototype.stopPublishingStream=function(e,t){this.logger.info(n.ZEGO_WEBRTC_ACTION.STOP_PUBLISHING_STREAM+" call ",e+(t?t.toString():""));var r=o.getReportSeq();if(this.stateCenter.reportSeqList.stopPublish[e]=r,this.dataReport.newReport(r,s.ZegoRTCLogEvent.kZegoTaskPublishStop.event),this.dataReport.addMsgInfo(r,{streamID:s.ZegoRTCLogEvent.kZegoTaskPublishStop.stream(e)}),"string"!=typeof e||""==e)return this.logger.error(n.ZEGO_WEBRTC_ACTION.STOP_PUBLISHING_STREAM+" streamID must be string and not empty"),this.dataReport.uploadReport(r,void 0,s.ZegoRTCLogEvent.kZegoTaskPublishStop.error.kParamError,"stream id type error"),delete this.stateCenter.reportSeqList.stopPublish[e],!1;var i=this.streamCenter.publisherList[e],a=this.streamCenter.getRoomByStreamID(e),c=i&&i.publisher&&i.publisher.state!==o.ENUM_PUBLISH_STATE.stop;if(this.streamCenter.stopPublishingStream(e),this.stateCenter.publishStreamList[e]){if(this.stateCenter.publishStreamList[e].state>=o.ENUM_PUBLISH_STREAM_STATE.update_info&&a){var l;if(!t||1102018!==t.code)l="PUBLIC"===this.stateCenter.type?o.ENUM_STREAM_SUB_CMD.liveEnd:o.ENUM_STREAM_CMD_PRI.liveEnd,a.streamHandler.updateStreamInfo(e,l);for(var u=0;u<a.streamList.length;u++)if(a.streamList[u].stream_id==e){a.streamList.splice(u--,1);break}}delete this.stateCenter.publishStreamList[e]}return this.dataReport.uploadReport(r),a&&c&&a.streamHandler.onPublishStateUpdate(o.ENUM_PUBLISH_STATE_UPDATE.error,e,t||{code:0,message:""}),!0},e.prototype.setCaptureVolume=function(e,t){var r=this;return new Promise((function(i){var o;r.logger.info(n.ZEGO_WEBRTC_ACTION.PUBLISH_SET_CAPTURE_VOLUME+" call");var a=function(e){r.logger.error(n.ZEGO_WEBRTC_ACTION.PUBLISH_SET_CAPTURE_VOLUME+" "+e),i({errorCode:s.ZegoRTCLogEvent.kZegoSetCaptureVolume.error.kParamError.code,extendedData:JSON.stringify({fail_reason:s.ZegoRTCLogEvent.kZegoSetCaptureVolume.error.kParamError.message+" "+e})})},c=r.streamCenter.ac,l=r.streamCenter.checkPreview(e);if(e instanceof MediaStream&&l)if(0!=e.getAudioTracks().length)if("number"!=typeof t||t<0||t>100)a(" volume must be number between 0 to 100");else{if(l.gainNode)l.gainNode.gain.value=t/100;else{var u=c.createMediaStreamSource(e),d=c.createGain(),h=c.createMediaStreamDestination();u.connect(d),d.connect(h);var p=h.stream.getAudioTracks()[0];for(var f in r.streamCenter.publisherList){var g=r.streamCenter.publisherList[f];if(g.localStream==e){var m=null===(o=g.publisher.peerConnection)||void 0===o?void 0:o.getSenders().find((function(e){return e.track&&"audio"===e.track.kind}));m&&(m.replaceTrack(p),g.localStream.removeTrack(g.publisher.localStream.getAudioTracks()[0]),g.localStream.addTrack(p));break}}e.removeTrack(e.getAudioTracks()[0]),e.addTrack(p),l.gainNode=d,l.gainNode.gain.value=t/100}c.resume(),i({errorCode:0,extendedData:""}),r.logger.info(n.ZEGO_WEBRTC_ACTION.PUBLISH_SET_CAPTURE_VOLUME+" call success")}else a(" stream audioTrack no found");else a(" stream must be created by zego")}))},e.prototype.getElectronScreenSources=function(){var e=this;return new Promise((function(t,r){var i=window.require("electron");i||(e.logger.error("zc.gess.0 Electron is not exist"),r({message:"Electron is not exist"})),i.desktopCapturer.getSources({types:["window","screen"]}).then((function(e){var r=e.map((function(e){return{id:e.id,name:e.name,thumbnail:e.thumbnail}}));t(r)})).catch((function(t){e.logger.error("zc.gess.0 "+t),r(t)}))}))},e.prototype.startScreenShotChrome=function(e){if(u.ZegoWebRTC.screenShotReady)window.postMessage({type:"SS_UI_REQUEST",text:"start"},"*"),a.ClientUtil.registerCallback("screenShare",{success:e},this.stateCenter.callbackList);else{var t='zc.b.ss Please install the extension:1. Go to chrome://extensions  2. Check: "Enable Developer mode   3. Click: "Load the unpacked extension... 4. Choose "extension" folder from the repository 5. Reload this page';this.logger.error(t),e(!1,null,{code:s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.code,message:s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.message+" "+t})}},e.prototype.startScreenSharing=function(e,t){var r=this;"getDisplayMedia"in navigator.mediaDevices?navigator.mediaDevices.getDisplayMedia({audio:e.audio,video:{frameRate:e.frameRate,width:e.width,height:e.height}}).then((function(e){t(!0,e)})).catch((function(e){r.logger.error("zc.b.sss "+e),e.message&&"permission denied"==e.message.toLowerCase()?t(!1,null,s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenCancelError):t(!1,null,{code:s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.code,message:s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.message+" "+e})})):(this.logger.error("zc.b.sss brower does not support getDisplayMedia"),t(!1,null,s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kBrowserNotSupportError))},e.prototype.startScreenShotFirFox=function(e,t,r){var i=this,n={video:{frameRate:t.frameRate,bitRate:t.bitRate,width:t.width,height:t.height,mediaSource:e},audio:t.audio};navigator.mediaDevices.getUserMedia(n).then((function(e){r(!0,e)})).catch((function(e){i.logger.error("ze.ssf.1 "+e),r(!1,null,{code:s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.code,message:s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.message+" "+e})}))},e.prototype.startScreenShotElectron=function(e,t){var r=this;if(!window.require("electron"))return this.logger.error("ze.sse.1 Electron is not exist"),void t(!1,null,{code:s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.code,message:s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.message+" Electron is not exist"});var i={video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e.sourceID,maxWidth:window.screen.width,maxHeight:window.screen.height}},audio:!1};navigator.mediaDevices.getUserMedia(i).then((function(e){t(!0,e)})).catch((function(e){r.logger.error("ze.sse.1 "+e),t(!1,null,{code:s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.code,message:s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.message+" "+e})}))},e.prototype.startPreview=function(e,t,r,i){var n=this,o=null;return o=new l.ZegoPreview(this.logger,this.streamCenter.ac,this.stateCenter,this.streamCenter,t),this.streamCenter.previewStreamList.push(o),o.startPreview(e,(function(i){n.streamCenter.soundLevelDelegate&&(null==o||o.startSoundLevel()),"camera"===t&&(null==o?void 0:o.micTrack)&&(o.micTrack.enabled=n.streamCenter.isMicEnabled),(null==e?void 0:e.videoOptimizationMode)&&n.streamCenter.setVideoTrackContentHint(i,null==e?void 0:e.videoOptimizationMode),n.logger.debug("zsc.sp.0 call success"),!n.stateCenter.deviceInfos&&n.recordDevices(),r&&r(i)}),(function(e){n.streamCenter.previewStreamList=n.streamCenter.previewStreamList.filter((function(e){return e!==o})),i&&i(e)})),!0},e.prototype.stopPreview=function(e){if(!e)return this.logger.warn("zsc.sp.0 localStream null"),!1;for(var t in this.streamCenter.publisherList)this.streamCenter.publisherList[t].localStream===e&&(this.streamCenter.publisherList[t].localStream=null);var r=this.streamCenter.checkPreview(e);return r?(r.previewSuc&&(r.stopPreview(),this.streamCenter.removePreview(r)),!0):(this.logger.warn("zsc.sp.0 no preview"),!1)},e.prototype.recordDevices=function(e,t){var r,i=this;this.logger.info("zsc.rd.0 call"),a.ClientUtil.getDevices((function(t){i.stateCenter.deviceInfos={microphones:t.microphones,speakers:t.speakers,cameras:t.cameras},e&&e(t)}),(function(e){i.logger.warn("zsc.rd.0 getDevices err:",e),t&&t(e)})),void 0!==(null===(r=navigator.mediaDevices)||void 0===r?void 0:r.ondevicechange)&&(navigator.mediaDevices.ondevicechange=null,navigator.mediaDevices.ondevicechange=function(e){i.logger.info("zsc.rd.0 devicechange"),i.stateCenter.deviceChangeTimer&&(clearTimeout(i.stateCenter.deviceChangeTimer),i.stateCenter.deviceChangeTimer=null),i.stateCenter.deviceChangeTimer=setTimeout((function(){a.ClientUtil.getDevices((function(e){for(var t=[],r=function(r){var n=i.stateCenter.deviceInfos.cameras[r];e.cameras.find((function(e){return e.deviceID===n.deviceID}))||t.push(n)},n=0;n<i.stateCenter.deviceInfos.cameras.length;n++)r(n);i.stateCenter.deviceStateOut=!1;var a=!1;t.length>0&&(a=!0),t.forEach((function(e){for(var t in i.streamCenter.publisherList){var r=i.streamCenter.publisherList[t],n=r.publisher;r.localStream&&r.cameraLabel===e.deviceName&&(a=!1,n.sendStreamStatus(-6,n.mic_status),i.stateCenter.actionListener("_deviceError",c.errorCodeList.DEVICE_ERROR_TYPE_UNPLUGGED.code,e.deviceName,"camera"),i.stateCenter.actionListener("deviceError",c.errorCodeList.DEVICE_ERROR_TYPE_UNPLUGGED.code,e.deviceName)),r.localStream&&0===r.localStream.getAudioTracks().length&&(a=!1)}var l=o.getReportSeq();i.dataReport.newReport(l,s.ZegoRTCLogEvent.kZegoTaskDeviceInterrupt.event),i.dataReport.addMsgInfo(l,{interrupt:0}),i.dataReport.uploadReport(l),i.stateCenter.actionListener("videoDeviceStateChanged","DELETE",e)})),a&&(i.stateCenter.deviceStateOut=!0),i.stateCenter.deviceInfos.microphones.filter((function(t){return!e.microphones.find((function(e){return e.deviceID===t.deviceID}))})).forEach((function(e){for(var t in i.streamCenter.publisherList){var r=i.streamCenter.publisherList[t],n=r.publisher;r.localStream&&(r.microLabel===e.deviceName||r.microLabel.includes(e.deviceName))&&(n.sendStreamStatus(n.camera_status,-6),i.stateCenter.actionListener("_deviceError",c.errorCodeList.DEVICE_ERROR_TYPE_UNPLUGGED.code,i.streamCenter.publisherList[t].microLabel,"micro"),i.stateCenter.actionListener("deviceError",c.errorCodeList.DEVICE_ERROR_TYPE_UNPLUGGED.code,i.streamCenter.publisherList[t].microLabel))}var a=o.getReportSeq();i.dataReport.newReport(a,s.ZegoRTCLogEvent.kZegoTaskDeviceInterrupt.event),i.dataReport.addMsgInfo(a,{interrupt:0}),i.dataReport.uploadReport(a),i.stateCenter.actionListener("audioDeviceStateChanged","DELETE","Input",e)}));var l=i.stateCenter.deviceInfos.speakers.filter((function(t){return!e.speakers.find((function(e){return e.deviceID===t.deviceID}))})),u=e.cameras.filter((function(e){return!i.stateCenter.deviceInfos.cameras.find((function(t){return t.deviceID===e.deviceID}))})),d=e.microphones.filter((function(e){return!i.stateCenter.deviceInfos.microphones.find((function(t){return t.deviceID===e.deviceID}))})),h=e.speakers.filter((function(e){return!i.stateCenter.deviceInfos.speakers.find((function(t){return t.deviceID===e.deviceID}))}));l.forEach((function(e){var t=o.getReportSeq();i.dataReport.newReport(t,s.ZegoRTCLogEvent.kZegoTaskAudioOutputChanged.event),i.dataReport.addMsgInfo(t,{reason:s.ZegoRTCLogEvent.kZegoTaskAudioOutputChanged.reason("delete"),device:s.ZegoRTCLogEvent.kZegoTaskAudioOutputChanged.device(e)}),i.dataReport.uploadReport(t),i.stateCenter.actionListener("audioDeviceStateChanged","DELETE","Output",e)})),u.forEach((function(e){var t=o.getReportSeq();i.dataReport.newReport(t,s.ZegoRTCLogEvent.kZegoTaskDeviceInterrupt.event),i.dataReport.addMsgInfo(t,{interrupt:1}),i.dataReport.uploadReport(t),i.stateCenter.actionListener("videoDeviceStateChanged","ADD",e)})),d.forEach((function(e){var t=o.getReportSeq();i.dataReport.newReport(t,s.ZegoRTCLogEvent.kZegoTaskDeviceInterrupt.event),i.dataReport.addMsgInfo(t,{interrupt:1}),i.dataReport.uploadReport(t),i.stateCenter.actionListener("audioDeviceStateChanged","ADD","Input",e)})),h.forEach((function(e){var t=o.getReportSeq();i.dataReport.newReport(t,s.ZegoRTCLogEvent.kZegoTaskAudioOutputChanged.event),i.dataReport.addMsgInfo(t,{reason:s.ZegoRTCLogEvent.kZegoTaskAudioOutputChanged.reason("add"),device:s.ZegoRTCLogEvent.kZegoTaskAudioOutputChanged.device(e)}),i.dataReport.uploadReport(t),i.stateCenter.actionListener("audioDeviceStateChanged","ADD","Output",e)})),i.stateCenter.deviceInfos={microphones:e.microphones,speakers:e.speakers,cameras:e.cameras}}),(function(e){i.logger.warn("zsc.rd.0 getDevices err:",e)}))}),500)})},e.prototype.getStreamThroughCanvas=function(e){if(0==e.getVideoTracks().length)return e;var t=document.createElement("video"),r=document.createElement("canvas"),i=r.getContext("2d");t.setAttribute("style","display:none"),r.setAttribute("style","display:none"),t.setAttribute("muted",""),t.muted=!0,t.setAttribute("autoplay",""),t.autoplay=!0,t.setAttribute("playsinline",""),document.body.append(t),document.body.append(r),t.srcObject=e;var n=function(){null==i||i.drawImage(t,0,0,r.width,r.height),window.requestAnimationFrame(n),t.srcObject=e};t.oncanplay=function(){r.width=t.videoWidth,r.height=t.videoHeight,t.play(),n()};var o=r.captureStream(15),s=o.getVideoTracks()[0],a=s.stop;if(s.stop=function(){a.call(s),n(),t.remove(),r.width=0,r.remove()},e instanceof MediaStream&&e.getAudioTracks().length){var c=e.getAudioTracks()[0];o.addTrack(c)}return o},e}();t.PublishModule=d},3770:function(e,t,r){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},n=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoPreview=void 0;var s=r(6706),a=r(3529),c=r(1089),l=function(){function e(e,t,r,i,n){var o=this;this.logger=e,this.ac=t,this.stateCenter=r,this.streamCenter=i,this.previewType=n,this.localStream=null,this.videoInfo={},this.previewSuc=!1,this.soundLevel=0,this.hasEmptyAudioTrack=!1,this.script=null,this.mic=null,this._audioTrack=null,this._videoTrack=null,this.originVideoTrack=null,this.activateSEIConfig=null,this.isAudioEnabled=!0,this.gainNode=null,this.cameraMaxResolution={},this.enableMicrophoneOnly=function(e,t){var r;if(!o.localStream)return o.logger.error("zp.em.2 no localStream"),!1;var i=null===(r=t.checkPublish(o.localStream))||void 0===r?void 0:r.publisher;if(i){var n=i.camera_status,s=o.isAudioEnabled&&e?0:20;i.camera_status===n&&i.mic_status===s||i.sendStreamStatus(n,s)}return o.micTrack?(o.micTrack.enabled=o.isAudioEnabled&&e,o.logger.debug("zp.emo.2 call success"),!0):(o.logger.info("zp.emo.2 no micTrack"),!0)}}return Object.defineProperty(e.prototype,"audioTrack",{get:function(){var e;return this._audioTrack||(null===(e=this.localStream)||void 0===e?void 0:e.getAudioTracks()[0])||null},set:function(e){this._audioTrack=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"videoTrack",{get:function(){var e;return this._videoTrack||(null===(e=this.localStream)||void 0===e?void 0:e.getVideoTracks()[0])||null},set:function(e){this._videoTrack=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"micTrack",{get:function(){return"camera"===this.previewType&&this.audioTrack||null},enumerable:!1,configurable:!0}),e.prototype.getMediaStreamConstraints=function(e,t){var r={audio:null,video:null};if(r.audio=!0,r.video={width:640,height:480,frameRate:15,bitRate:this.stateCenter.settingConfig.getSetting("camera_video_bitrate")},e.audio?void 0===e.audioInput&&void 0===e.ANS&&void 0===e.AGC&&void 0===e.AEC&&void 0===e.channelCount?(r.audio={},r.audio.noiseSuppression=this.stateCenter.settingConfig.getSetting("ANS"),r.audio.autoGainControl=this.stateCenter.settingConfig.getSetting("AGC"),r.audio.echoCancellation=this.stateCenter.settingConfig.getSetting("AEC"),r.audio.channelCount=1):(r.audio={},void 0!==e.audioInput&&null!==e.audioInput&&(r.audio.deviceId={exact:e.audioInput}),void 0!==e.ANS&&(r.audio.noiseSuppression=e.ANS),void 0!==e.AGC&&(r.audio.autoGainControl=e.AGC),void 0!==e.AEC&&(r.audio.echoCancellation=e.AEC),void 0!==e.channelCount&&(r.audio.channelCount=e.channelCount)):!1===e.audio&&(r.audio=!1),e.video){var i=640,n=480,o=15,a=this.stateCenter.settingConfig.getSetting("camera_video_bitrate");if(1===e.videoQuality?(i=s.ENUM_RESOLUTION_TYPE.LOW.width,n=s.ENUM_RESOLUTION_TYPE.LOW.height,o=s.ENUM_RESOLUTION_TYPE.LOW.frameRate,a=s.ENUM_RESOLUTION_TYPE.LOW.bitRate):2===e.videoQuality?(i=s.ENUM_RESOLUTION_TYPE.MEDIUM.width,n=s.ENUM_RESOLUTION_TYPE.MEDIUM.height,o=s.ENUM_RESOLUTION_TYPE.MEDIUM.frameRate,a=s.ENUM_RESOLUTION_TYPE.MEDIUM.bitRate):3===e.videoQuality?(i=s.ENUM_RESOLUTION_TYPE.HIGH.width,n=s.ENUM_RESOLUTION_TYPE.HIGH.height,o=s.ENUM_RESOLUTION_TYPE.HIGH.frameRate,a=s.ENUM_RESOLUTION_TYPE.HIGH.bitRate):4===e.videoQuality?(i=e.width,n=e.height,o=e.frameRate,a=e.bitRate||this.stateCenter.settingConfig.getSetting("camera_video_bitrate")):this.logger.info("zp.gmsc.2 use default"),t&&(e.width&&(i=e.width),e.height&&(n=e.height),e.frameRate&&(o=e.frameRate),e.bitRate&&(a=e.bitRate)),!1===e.horizontal){var c=n;n=i,i=c}!0===e.isSwitch&&(c=n,n=i,i=c),r.video={width:i,height:n,frameRate:o,bitRate:a},null!=e.facingMode?r.video.facingMode=e.facingMode:null!=e.videoInput&&null!=e.videoInput&&""!=e.videoInput&&(r.video.deviceId={exact:e.videoInput}),this.logger.info("zp.gmsc.2 width: "+i+" height: "+n+" rate: "+o)}else!1===e.video&&(e.audioBitrate&&(r.video={}),r.video=!1);return r},e.prototype.startPreview=function(e,t,r){return n(this,void 0,void 0,(function(){var n,s,c,l,u,d,h,p=this;return o(this,(function(o){return this.logger.debug("zp.sv.2 called"),this.mediaStreamConfig=e,void 0===navigator.mediaDevices||null==navigator.mediaDevices.getUserMedia?(r&&r(a.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kBrowserNotSupportError),[2]):e.source instanceof MediaStream?(n=e.source.getVideoTracks(),s=n.length>0?n[0].getSettings():{width:0,height:0,frameRate:0},this.logger.debug("zp.sv.2 use external media stream"),this.previewSuc=!0,this.localStream=e.source,this.initMediaTrack(e.source),this.videoInfo={width:s.width,height:s.height,frameRate:s.frameRate,bitRate:e.bitRate||this.stateCenter.settingConfig.getSetting("custom_video_bitrate"),startBitrate:e.startBitrate||this.stateCenter.settingConfig.getSetting("bitrate_mode"),channelCount:e.channelCount||(this.audioTrack&&this.audioTrack.getSettings?this.audioTrack.getSettings().channelCount:1),audioBitrate:1e3*e.audioBitrate||48e3},t&&t(this.localStream),[2]):e.source instanceof HTMLMediaElement?((c=this.captureStream(e.source,e))?(this.videoInfo.bitRate=e.bitRate||this.stateCenter.settingConfig.getSetting("custom_video_bitrate"),this.previewSuc=!0,this.initMediaTrack(c),t&&t(c)):r&&r(a.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kBrowserNotSupportError),[2]):((l=this.getMediaStreamConstraints(e)).audio&&(u=this.stateCenter.settingConfig.getSetting("AEC",!0),d=this.stateCenter.settingConfig.getSetting("AGC",!0),h=this.stateCenter.settingConfig.getSetting("ANS",!0),"boolean"==typeof u&&(this.logger.info("zp.sv.2 setting AEC "+u),l.audio.echoCancellation=u),"boolean"==typeof d&&(this.logger.info("zp.sv.2 setting AGC "+d),l.audio.autoGainControl=d),"boolean"==typeof h&&(this.logger.info("zp.sv.2 setting ANS "+h),l.audio.noiseSuppression=h)),this.videoInfo=i({},l.video),this.videoInfo?(this.videoInfo.audioBitrate=1e3*e.audioBitrate||48e3,this.videoInfo.startBitrate=e.startBitrate||this.stateCenter.settingConfig.getSetting("bitrate_mode")):e.audioBitrate&&(this.videoInfo={audioBitrate:1e3*e.audioBitrate||48e3}),this.mediaStreamConfig.video=!!l.video,this.mediaStreamConfig.audio=!!l.audio,this.logger.info("zp.sv.2 ",JSON.stringify(l)),e.unlimitedCaptureResolution&&l.video.width&&(l.video.width={ideal:4096},l.video.height={ideal:2160},this.logger.info("zp.sv.2 ","capture max resolution of camera")),navigator.mediaDevices.getUserMedia(l).then((function(r){p.logger.info("zp.sv.2 success"),p.localStream=r,p.previewSuc=!0,p.initMediaTrack(r),p.videoInfo&&(p.videoInfo.channelCount=e.channelCount||(p.audioTrack&&p.audioTrack.getSettings?p.audioTrack.getSettings().channelCount:1)),t&&t(r)}),(function(e){if(p.logger.info("zp.sv.2 failed ",e.name," ",e.message),r){var t=a.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kGetUserMediaError;t.message=t.message+" "+e.name+" "+e.message,"NotAllowedError"===e.name||"SecurityError"===e.name?(t=i({},a.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kDeviceNoAllowedError)).message=e.name+": "+t.message:"NotReadableError"===e.name?(t=i({},a.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kDeviceNoReadableError)).message=e.name+": "+t.message:"OverconstrainedError"===e.name&&((t=i({},a.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kDeviceOverConstrainedError)).message=e.name+": "+t.message+(e.constraint?". such as "+e.constraint:"")),r(t)}})),[2])}))}))},e.prototype.captureStream=function(e,t){if(!e)return this.logger.info("zp.cs.2 no local video"),null;var r;if(e.captureStream)r=e.captureStream(),this.logger.debug("zp.cs.2 captureStream");else{if(!e.mozCaptureStream)return this.logger.info("zp.cs.2 don't support"),null;r=e.mozCaptureStream(),this.logger.debug("zp.cs.2 mozCaptureStream")}return 0==r.getTracks().length?(this.logger.error("zp.cs.2 external capture tracks no found"),null):(this.localStream=r,this.videoInfo={width:e.videoWidth,height:e.videoHeight,frameRate:0,bitRate:t.bitRate||this.stateCenter.settingConfig.getSetting("custom_video_bitrate"),channelCount:t.channelCount||(this.audioTrack&&this.audioTrack.getSettings?this.audioTrack.getSettings().channelCount:1),audioBitrate:1e3*t.audioBitrate||48e3,startBitrate:t.startBitrate||this.stateCenter.settingConfig.getSetting("bitrate_mode")},this.logger.debug("zp.cs.2 called success"),this.localStream)},e.prototype.stopPreview=function(){var e,t,r;this.logger.info("zp.sv.2.1 called"),this.localStream&&(this.videoEffect&&(this.videoEffect.setBeautyEffectOptions(!1),this.videoEffect.destroy()),null===(e=this.originVideoTrack)||void 0===e||e.stop(),null===(t=this.videoTrack)||void 0===t||t.stop(),null===(r=this.audioTrack)||void 0===r||r.stop(),this.localStream.getTracks().reverse().forEach((function(e){return e.stop()})),this.localStream=null,this.videoInfo={})},e.prototype.enableMicrophone=function(e,t){return!1},e.prototype.enableCamera=function(e,t,r){return!1},e.prototype.startSoundLevel=function(){var e=this;if(this.localStream&&0!=this.localStream.getAudioTracks().length){this.script&&this.script.disconnect()&&(this.script=null),this.mic&&this.mic.disconnect()&&(this.mic=null);try{this.mic=this.ac.createMediaStreamSource(this.localStream),this.script=this.ac.createScriptProcessor(4096,1,1),this.mic.connect(this.script),this.script.connect(this.ac.destination),this.script.onaudioprocess=function(t){for(var r=t.inputBuffer.getChannelData(0),i=0,n=0;n<r.length;n++)i<r[n]&&(i=r[n]);e.soundLevel=100*i},this.ac.resume()}catch(e){this.logger.error(c.ZEGO_WEBRTC_ACTION.PUBLISHER_START_SOUND_LEVEL+" get sound level failed "+e)}}},e.prototype.stopSoundLevel=function(){this.soundLevel=0,this.script&&this.script.disconnect(),this.mic&&this.mic.disconnect(),this.script=null,this.mic=null},e.prototype.restartSoundLevel=function(){this.streamCenter.soundLevelDelegate?(this.stopSoundLevel(),this.startSoundLevel()):this.stopSoundLevel()},e.prototype.setBeautyEffect=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(e){return[2]}))}))},e.prototype.replacePreviewTrack=function(e,t){void 0===t&&(t=!1)},e.prototype.initMediaTrack=function(e){e.getVideoTracks().length>0&&(this.videoTrack=e.getVideoTracks()[0],this.originVideoTrack=this.videoTrack),e.getAudioTracks().length>0&&(this.audioTrack=e.getAudioTracks()[0])},e}();t.ZegoPreview=l},1547:function(e,t,r){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoPublish=void 0;var n=r(6706),o=r(4767),s=r(608),a=r(3529),c=r(1089),l=function(){function e(e,t,r,i,o,s,a,c,l){this.state=n.ENUM_PUBLISH_STATE.stop,this.sessionId=0,this.sessionToken="",this.candidateInfo=[],this.qualityTimer=null,this.publishQualityList=[],this.maxQualityListCount=10,this.lastPublishStats={},this.reportSeq=NaN,this.streamReportSeq=n.getSeq(),this.qualityUpload=!1,this.qualityUploadInterval=3e4,this.qualityUploadLastTime=0,this.qualitySeq=0,this.videoInfo={width:0,height:0,frameRate:0,bitRate:0,channelCount:1,audioBitrate:48e3},this.mediaStreamConfig=null,this.offerSeq=0,this.audioMixList=[],this.arrayBufferMap={},this.effectList=[],this.peerConnection=null,this.qualityCount=0,this.closeSessionSignal=!1,this.channelCount=1,this.localSdpOrder=[],this.remoteSdpOrder=[],this.videoCodec="H264",this.stateNego=n.ENUM_PUBLISH_STATE_NEGO.stop,this.negoInterval=25e3,this.publishEvent=!1,this.cameraState="on",this.microState="on",this.gwNode="",this.gwNodeList=[],this.gwNodeTTL=0,this.needIncMax=!1,this.probeCount=0,this.gotMax=!1,this.initFitCnt=0,this.targetRate=0,this.totalBitrateArray=[],this.totalTargetRateArray=[],this.totalRetransRateArray=[],this.isPeer=!1,this.peerFailCount=0,this.peerID=0,this.netQuality=0,this.probeTime=0,this.probeInterval=6e4,this.probeState=n.ENUM_PROBE_STATE.probed,this.iceDisconnectedMaxTime=15e3,this.isUpdateSDP=!1,this.toBeReplacedTracks={},this.send_seq=0,this.dataChannelState=0,this.first_pkt=!0,this.next_sn=[],this.pkt_list=[],this.camera_status=2,this.mic_status=2,this.streamId=e,this.logger=t,this.dataReport=r,this.qualityTimeInterval=i,this.ac=s,this.mediaEleSources=a,this.streamCenter=o,this.stateCenter=c,this.dataReport.newReport(this.streamReportSeq),this.videoCodec=this.stateCenter.settingConfig.getSetting("publish_video_codec")}return Object.defineProperty(e.prototype,"previewer",{get:function(){return this.streamCenter.checkPreview(this.localStream)},enumerable:!1,configurable:!0}),e.prototype.publishStateUpdateError=function(e,t){this.logger.error(c.ZEGO_WEBRTC_ACTION.PUBLISHER_STATE_ERROR+"  call ",this.streamId,JSON.stringify(e)),this.streamId&&this.onPublishStateUpdate(n.ENUM_PUBLISH_STATE_UPDATE.error,this.streamId,e,t),this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_STATE_ERROR+"  ended")},e.prototype.resetPublish=function(){this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_RESET_PUBLISH+"   "+this.streamId+" call"),this.state=n.ENUM_PUBLISH_STATE.stop,this.publishEvent=!1,null==this.peerConnection&&null==this.peerConnection||(this.peerConnection.close(),this.peerConnection=null),null!=this.negoTimer&&(clearTimeout(this.negoTimer),this.negoTimer=null),null!=this.iceDisconnectedTimer&&(clearTimeout(this.iceDisconnectedTimer),this.iceDisconnectedTimer=null),this.clearPublishQualityTimer(),this.signal&&(this.signal.unregisterPushCallback("CandidateInfoPush",this.sessionId),this.signal.unregisterPushCallback("MediaDescPush",this.sessionId),this.signal.unregisterPushCallback("CloseSessionPush",this.sessionId),this.signal.unregisterPushCallback("SessionResetPush",this.sessionId),this.signal.unregisterPushCallback("PublishEventPush",this.sessionId),this.signal.unregisterPushCallback("ClientInfoPush",this.sessionId)),this.sessionSeq=0,this.offerSeq=0,this.candidateInfo=[],this.publishQualityList=[],this.qualityUploadLastTime=0,this.resetEncBitrate(),this.isUpdateSDP=!1},e.prototype.clearPublishQualityTimer=function(){null!=this.qualityTimer&&(clearInterval(this.qualityTimer),this.qualityTimer=null),this.lastPublishStats={},this.qualityCount=0},e.prototype.shouldSendCloseSession=function(){return this.state!=n.ENUM_PUBLISH_STATE.stop&&this.state!=n.ENUM_PUBLISH_STATE.waitingSessionRsp},e.prototype.startPublish=function(e,t,r,i,n){var o,s=this;if(this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+e+" called"),this.signal&&this.signal.negoInterval&&(this.negoInterval=this.signal.negoInterval),e){var l;this.localStream=t,this.mediaStreamConfig=i,this.channelCount=i.channelCount,this.publishOption=n||{},navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&i&&(i.externalCapture||i.externalMediaStream)&&(this.localStream.onaddtrack=function(){var e,t,r,i;s.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+s.streamId+" Track added");var n=[];(null===(e=s.previewer)||void 0===e?void 0:e.videoTrack)&&n.push(null===(t=s.previewer)||void 0===t?void 0:t.videoTrack);var o=s.localStream.getAudioTracks();if(n.length>1)null==(a=null===(r=s.peerConnection)||void 0===r?void 0:r.getSenders().find((function(e){var t;return(null===(t=e.track)||void 0===t?void 0:t.kind)===n[1].kind})))||a.replaceTrack(n[1]),s.localStream.removeTrack(n[0]);else if(o.length>1){var a;null==(a=null===(i=s.peerConnection)||void 0===i?void 0:i.getSenders().find((function(e){var t;return(null===(t=e.track)||void 0===t?void 0:t.kind)===o[1].kind})))||a.replaceTrack(o[1]),s.localStream.removeTrack(o[0])}}),r&&(this.videoInfo=r),n&&n.videoCodec&&(this.videoCodec=n.videoCodec);var u=null===(o=this.previewer)||void 0===o?void 0:o.previewType;switch(u){case"camera":l=this.stateCenter.settingConfig.getSetting("camera_video_bitrate",!0);break;case"screen":l=this.stateCenter.settingConfig.getSetting("screen_video_bitrate",!0);break;case"custom":l=this.stateCenter.settingConfig.getSetting("custom_video_bitrate",!0)}l&&(this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" setting "+u+" "+l),this.videoInfo.bitRate=l);var d=this.stateCenter.settingConfig.getSetting("bitrate_mode",!0);d&&(this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" setting bitrate_mode "+d),this.videoInfo.startBitrate=d);var h=this.stateCenter.settingConfig.getSetting("publish_video_codec",!0);h&&(this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" setting publish_video_codec "+h),this.videoCodec=h),this.dataReport.addMsgInfo(this.reportSeq,{video_en_codec_id:a.ZegoRTCLogEvent.kZegoTaskPublishStart.video_en_codec_id("VP8"==this.videoCodec?2:0),audio_c_channel_count:a.ZegoRTCLogEvent.kZegoTaskPublishStart.audio_c_channel_count(2==this.channelCount?2:1),audio_en_bps:a.ZegoRTCLogEvent.kZegoTaskPublishStart.audio_en_bps(this.videoInfo.audioBitrate),aec_level:a.ZegoRTCLogEvent.kZegoTaskPublishStart.aec_level(1==i.AEC?2:0==i.AEC?0:2),ans_level:a.ZegoRTCLogEvent.kZegoTaskPublishStart.ans_level(1==i.ANS?2:0==i.ANS?0:2),agc:a.ZegoRTCLogEvent.kZegoTaskPublishStart.agc(1==i.AGC?2:0==i.AGC?0:2),traffic_control_min_video_bitrate:a.ZegoRTCLogEvent.kZegoTaskPublishStart.traffic_control_min_video_bitrate(this.videoInfo.bitRate)}),this.isPeer?this.createOffer():this.createSession(),this.negoTimer=setTimeout((function(){s.logger.error(c.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" waiting timeout"),s.publishStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishNegoTimeoutError)}),this.negoInterval)}else this.logger.error(c.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+e+" streamId is null")},e.prototype.activateSEIInsert=function(e,t){return new Promise((function(e,t){e(!1)}))},e.prototype.createSession=function(e){var t=this;this.sessionSeq=n.getSeq();var r=this.streamId;1==this.streamCenter.testEnvironment&&(r="zegotest-"+this.streamCenter.appid+"-"+this.streamId);var i=this.stateCenter.settingConfig.getSetting("gw_nodes");i&&i instanceof Array&&i.length>0&&(this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" setting "+JSON.stringify(i)),this.gwNodeList=i,this.gwNode=this.gwNodeList[0]||this.gwNode),this.isPeer?(this.dataReport.eventStart(this.reportSeq,"CreateSessionWithSdp"),this.dataReport.eventStart(this.streamReportSeq,"CreateSessionWithSdp"),this.signal.createSessionWithSdp({seq:this.sessionSeq,type:0,mode:0,streamId:r,videoInfo:this.videoInfo,strAuthParam:this.publishOption&&this.publishOption.streamParams||"",sdp:e.sdp,serverHost:this.gwNode},(function(e,r,i){t.handleCreateSessionWithSdpResp(e,r,i)}),(function(r,i){t.dataReport.eventEndWithMsg(t.reportSeq,"CreateSession",{error:r}),t.dataReport.eventEndWithMsg(t.streamReportSeq,"CreateSession",{error:r}),r==n.SEND_MSG_TIMEOUT&&t.peerFailCount<2?(t.peerFailCount++,t.createSession(e)):r==n.SEND_MSG_TIMEOUT&&t.peerFailCount>=2?(t.isPeer=!1,t.streamCenter.isPeer=!1,t.createSession()):t.publishStateUpdateError(r==n.SEND_MSG_TIMEOUT?a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSessionTimeoutError:a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSessionRequestError)}))):(this.dataReport.eventStart(this.reportSeq,"CreateSession"),this.dataReport.eventStart(this.streamReportSeq,"CreateSession"),this.signal.createSession(this.sessionSeq,0,0,r,this.publishOption&&this.publishOption.streamParams,this.gwNode,(function(e,r,i){t.handleCreateSessionResp(e,r,i)}),(function(e,r){t.reportSeq,t.dataReport.eventEndWithMsg(t.reportSeq,"CreateSession",{error:e}),t.dataReport.eventEndWithMsg(t.streamReportSeq,"CreateSession",{error:e}),t.publishStateUpdateError(e==n.SEND_MSG_TIMEOUT?a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSessionTimeoutError:a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSessionRequestError)}))),this.state=n.ENUM_PUBLISH_STATE.waitingSessionRsp,this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+this.streamId+" called success"),this.stateNego=n.ENUM_PUBLISH_STATE_NEGO.start},e.prototype.handleCreateSessionResp=function(e,t,r){var i=r.turn_server,n=i.split("?")[0]&&i.split("?")[0].slice(5),o=this.streamCenter.server.split("?"),s=o[1]&&o[1].slice(2);this.dataReport.eventEndWithMsg(this.streamReportSeq,"CreateSession",{sessionId:r.session_id,url:"webrtc://"+n+"/"+s+"/"+this.streamId}),this.dataReport.eventEndWithMsg(this.reportSeq,"CreateSession",{sessionId:r.session_id,url:"webrtc://"+n+"/"+s+"/"+this.streamId}),this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+this.streamId+" sessionId:"+r.session_id),this.sessionSeq==e?(this.gwNodeList=r.gw_nodes&&r.gw_nodes.length>0?r.gw_nodes:this.gwNodeList,this.gwNode=r.gw_nodes&&r.gw_nodes.length>0?this.gwNodeList[0]:this.gwNode,this.gwNodeTTL=r.gw_nodes_ttl?(new Date).getTime()+1e3*r.gw_nodes_ttl:this.gwNodeTTL,this.stateCenter.clientIP=r.clientip?r.clientip:this.stateCenter.clientIP,0!==r.result?(this.logger.error(c.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+this.streamId+" create session failed "+r.result),this.publishStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSessionRequestError)):(this.sessionId=r.session_id,this.sessionToken=r.session_token,this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+this.streamId+" create session success "+this.sessionId),this.dataReport.addMsgInfo(this.reportSeq,{session_id:a.ZegoRTCLogEvent.kZegoTaskPublishStart.session_id(this.sessionId)}),this.onCreatePublishSessionSuccess(r))):this.logger.error(c.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+this.streamId+" seq is not match.")},e.prototype.handleCreateSessionWithSdpResp=function(e,t,r){var i=this;this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" sessionId:"+t),this.sessionSeq==e?(this.gwNodeList=r.gw_nodes&&r.gw_nodes.length>0?r.gw_nodes:this.gwNodeList,this.gwNode=r.gw_nodes&&r.gw_nodes.length>0?this.gwNodeList[0]:this.gwNode,this.gwNodeTTL=r.gw_nodes_ttl?(new Date).getTime()+1e3*r.gw_nodes_ttl:this.gwNodeTTL,this.stateCenter.clientIP=r.clientip?r.clientip:this.stateCenter.clientIP,this.dataReport.eventEndWithMsg(this.streamReportSeq,"CreateSessionWithSdp",{sessionId:t}),this.dataReport.eventEndWithMsg(this.reportSeq,"CreateSessionWithSdp",{sessionId:t}),0!==r.result?(this.logger.error(c.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" create session failed "+r.result),this.publishStateUpdateError({code:a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSessionRequestError.code,message:a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSessionRequestError.message+" result:"+r.result})):(this.sessionId=t,this.sessionToken=r.session_token,this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" get remote session success "+this.streamId),this.signal.registerPushCallback("CloseSessionPush",this.sessionId,(function(e,t,r){i.onRecvCloseSession(e,t,r)})),this.signal.registerPushCallback("SessionResetPush",this.sessionId,(function(e,t,r){i.onRecvResetSession(e,t,r)})),this.signal.registerPushCallback("PublishEventPush",this.sessionId,(function(e,t,r){i.onRecvPublishEvent(e,t,r)})),this.signal.registerPushCallback("ClientInfoPush",this.sessionId,(function(e,t,r){i.onRecvClientInfo(e,t,r)})),this.signal.registerPushCallback("MediaDescUpdatePush",this.sessionId,(function(e,t,r){i.onRecvUpdateMediaDescription(e,t,r)})),this.onGetRemoteOfferSuccess(r.sdp))):this.logger.error(c.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" seq is not match.")},e.prototype.onCreatePublishSessionSuccess=function(e){var t=this;this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS+" "+this.streamId+" called");var r=[];if(e.turn_server){var i=e.turn_server,n=this.stateCenter.turnOverTcpOnly,o=this.stateCenter.settingConfig.getSetting("udp_or_tcp",!0);o&&(this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS+" setting udp_or_tcp "+o),n="tcp"===o),n&&(i=i.replace("udp","tcp")),this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS+" over tcp "+i),r.push(i)}e.stun_server&&r.push(e.stun_server);var s={iceTransportPolicy:"relay",iceServers:[{urls:r,username:e.turn_username,credential:e.turn_auth_key}]};this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS+" "+this.streamId+" username: "+e.turn_username),this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS+" "+this.streamId+" credential: "+e.turn_auth_key),this.createOffer(s),this.signal.registerPushCallback("CandidateInfoPush",this.sessionId,(function(e,r,i){t.onRecvCandidateInfo(e,r,i)})),this.signal.registerPushCallback("CloseSessionPush",this.sessionId,(function(e,r,i){t.onRecvCloseSession(e,r,i)})),this.signal.registerPushCallback("MediaDescPush",this.sessionId,(function(e,r,i){t.onRecvMediaDescription(e,r,i)})),this.signal.registerPushCallback("SessionResetPush",this.sessionId,(function(e,r,i){t.onRecvResetSession(e,r,i)})),this.signal.registerPushCallback("PublishEventPush",this.sessionId,(function(e,r,i){t.onRecvPublishEvent(e,r,i)})),this.signal.registerPushCallback("ClientInfoPush",this.sessionId,(function(e,r,i){t.onRecvClientInfo(e,r,i)})),this.signal.registerPushCallback("MediaDescUpdatePush",this.sessionId,(function(e,r,i){t.onRecvUpdateMediaDescription(e,r,i)})),this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS+" "+this.streamId+" call success")},e.prototype.createOffer=function(e){var t,r,i=this;this.peerConnection=new RTCPeerConnection(e),this.peerConnection.onicecandidate=function(e){i.onIceCandidate(e)},this.peerConnection.onsignalingstatechange=function(e){i.onConnectionStateChange(e)},this.peerConnection.oniceconnectionstatechange=function(e){i.onIceConnectionStateChange(e)},this.streamCenter.isDataChannelEnabled&&(this.dataChannel=this.peerConnection.createDataChannel(this.streamId),this.dataChannel.binaryType="arraybuffer",this.dataChannel.onopen=function(e){i.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS+" "+i.streamId+" data channel open"),i.dataChannelState=1},this.dataChannel.onclose=function(e){i.logger.error(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS+" "+i.streamId+" data channel close ")});var n=[],o=[];this.localStream&&(this.localStream.getTracks().forEach((function(e){var t;null===(t=i.peerConnection)||void 0===t||t.addTrack(e,i.localStream)})),(null===(t=this.previewer)||void 0===t?void 0:t.videoTrack)&&(n=[null===(r=this.previewer)||void 0===r?void 0:r.videoTrack]),o=this.localStream.getAudioTracks(),n.length>0&&this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS+" "+this.streamId+" video device: "+n[0].label),o.length>0&&this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS+" "+this.streamId+" audio device: "+o[0].label));var s={offerToReceiveAudio:o.length>0?1:0,offerToReceiveVideo:n.length>0?1:0};this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS+" "+this.streamId+" createOffer: "+JSON.stringify(s)),this.dataReport.eventStart(this.reportSeq,"CreateOffer"),this.dataReport.eventStart(this.streamReportSeq,"CreateOffer"),this.peerConnection.createOffer(s).then((function(e){i.dataReport.eventEnd(i.reportSeq,"CreateOffer"),i.dataReport.eventEnd(i.streamReportSeq,"CreateOffer"),i.onCreateOfferSuccess(e)}),(function(e){i.dataReport.eventEndWithMsg(i.reportSeq,"CreateOffer",{error:e.toString()}),i.dataReport.eventEndWithMsg(i.streamReportSeq,"CreateOffer",{error:e.toString()}),i.logger.error(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS+" "+i.streamId+" create offer error "+e.toString()),i.publishStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kCreateOfferError,!0)}))},e.prototype.onCreateOfferSuccess=function(e,t,r,i){var n,s=this;t&&(this.isUpdateSDP=!0,i&&(this.updateSDPCallBack=i)),this.videoInfo.bitRate>0&&(e.sdp=this.updateBandwidthRestriction(e.sdp,this.videoInfo.bitRate)),e.sdp=e.sdp.replace(/sendrecv/g,"sendonly");var l=e.sdp.match(/m=application[\s\S]+datachannel[\s\S]+/)?e.sdp.match(/m=application[\s\S]+datachannel[\s\S]+/)[0]:null;if(l){var u=l.replace(/sendonly/,"sendrecv");e.sdp=e.sdp.replace(l,u)}e.sdp=e.sdp.replace(/useinbandfec=\d+/,(this.videoInfo.audioBitrate?"maxaveragebitrate="+this.videoInfo.audioBitrate:"")+(2===this.videoInfo.channelCount?";stereo=1":"")),this.localSdpOrder=e.sdp.match(/m=(.\w*)\s/g)||[],this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_OFFER_SUCCESS+" "+this.streamId+" local sdp revert "+this.localSdpOrder.join("")),e.sdp=o.SdpUtil.getSDPByVideDecodeType(e.sdp,this.videoCodec,!0),this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_OFFER_SUCCESS+" "+this.streamId+" localSdp1 "+e.sdp.substr(0,e.sdp.length/2)),this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_OFFER_SUCCESS+" "+this.streamId+" localSdp2 "+e.sdp.substr(e.sdp.length/2)),this.dataReport.eventStart(this.reportSeq,"SetLocalDescription"),this.dataReport.eventStart(this.streamReportSeq,"SetLocalDescription"),null===(n=this.peerConnection)||void 0===n||n.setLocalDescription(e).then((function(){s.dataReport.eventEnd(s.reportSeq,"SetLocalDescription"),s.dataReport.eventEnd(s.streamReportSeq,"SetLocalDescription"),s.onSetLocalDescriptionSuccess(e,r)}),(function(e){s.dataReport.eventEndWithMsg(s.reportSeq,"SetLocalDescription",{error:e.toString()}),s.dataReport.eventEndWithMsg(s.streamReportSeq,"SetLocalDescription",{error:e.toString()}),s.logger.error(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_OFFER_SUCCESS+" "+s.streamId+" error "+e.toString()),s.publishStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSetLocalDescError,!0)}))},e.prototype.updateBandwidthRestriction=function(e,t){var r="AS";return"firefox"===this.stateCenter.browser&&(t=1e3*(t>>>0),r="TIAS"),-1===e.indexOf("b="+r+":")?e.replace(/(m=video.*\r\nc=IN.*\r\n)/g,"$1b="+r+":"+t+"\r\n"):(e=e.replace(new RegExp("b="+r+":.*\r\n","g"),"b="+r+":"+t+"\r\n")).replace("b="+r+":"+t+"\r\n","")},e.prototype.onSetLocalDescriptionSuccess=function(e,t){var r=this;this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+this.streamId+" success"),!this.isUpdateSDP&&(this.state=n.ENUM_PUBLISH_STATE.waitingOfferRsp),t&&(this.videoInfo=i(i({},this.videoInfo),t));var o={sdp:e.sdp,width:this.videoInfo.width,height:this.videoInfo.height,frameRate:this.videoInfo.frameRate,video_min_kpbs:this.videoInfo.bitRate,video_max_kpbs:this.videoInfo.bitRate,audio_kpbs:48,keyframe_intv:2};if(this.offerSeq=n.getSeq(),this.isUpdateSDP){this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+this.streamId+" update sdp");var s=i(i({},o),{seq:this.sessionSeq,peerID:this.peerID,type:0});return this.dataReport.eventStart(this.reportSeq,"SendMediaDescUpdate"),this.dataReport.eventStart(this.streamReportSeq,"SendMediaDescUpdate"),void this.signal.sendMediaDescUpdateReq(this.offerSeq,this.sessionId,s,(function(e,t,r){}),(function(e,t){r.dataReport.eventEndWithMsg(r.reportSeq,"SendMediaDescUpdate",{error:e}),r.dataReport.eventEndWithMsg(r.streamReportSeq,"SendMediaDescUpdate",{error:e}),r.updateSDPCallBack&&r.updateSDPCallBack(-1),r.publishStateUpdateError(e==n.SEND_MSG_TIMEOUT?a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kUpdateMediaDescriptionTimeOut:a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kUpdateMediaDescriptionError)}))}this.isPeer?this.createSession(e):(this.dataReport.eventStart(this.reportSeq,"SendMediaDesc"),this.dataReport.eventStart(this.streamReportSeq,"SendMediaDesc"),this.signal.sendMediaDesc(this.offerSeq,this.sessionId,0,o,(function(e,t,i){r.offerSeq==e&&r.sessionId==t?(r.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+r.streamId+" send success"),r.dataReport.eventEndWithMsg(r.reportSeq,"SendMediaDesc",{mediaDescription:{width:o.width,height:o.height,frameRate:o.frameRate,video_min_kpbs:o.video_min_kpbs,video_max_kpbs:o.video_max_kpbs,audio_kpbs:o.audio_kpbs,keyframe_intv:o.keyframe_intv}}),r.dataReport.eventEndWithMsg(r.streamReportSeq,"SendMediaDesc",{mediaDescription:{width:o.width,height:o.height,frameRate:o.frameRate,video_min_kpbs:o.video_min_kpbs,video_max_kpbs:o.video_max_kpbs,audio_kpbs:o.audio_kpbs,keyframe_intv:o.keyframe_intv}}),r.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+r.streamId+" send success stateNego:waiterAnswer"),r.stateNego=n.ENUM_PUBLISH_STATE_NEGO.waiterAnswer,r.state=n.ENUM_PUBLISH_STATE.waitingServerAnswer):r.logger.error(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+r.streamId+" seq or sessionId is not equal")}),(function(e,t){r.dataReport.eventEndWithMsg(r.reportSeq,"SendMediaDesc",{error:e}),r.dataReport.eventEndWithMsg(r.streamReportSeq,"SendMediaDesc",{error:e}),r.publishStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kMediaDescError)})),this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+this.streamId+" call success"))},e.prototype.onRecvUpdateMediaDescription=function(e,t,r){this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_UPDATE_MEDIA_DESC+" "+this.streamId+" received"),this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_UPDATE_MEDIA_DESC+" "+this.streamId+" received stateNego:waitingCandidate"),this.dataReport.addEvent(this.reportSeq,"RecvUpdateMediaDesc"),this.dataReport.addEvent(this.streamReportSeq,"RecvUpdateMediaDesc"),this.signal.sendUpdateMediaDescAck(e,this.sessionId,0,this.peerID),1==r.type?this.onGetRemoteOfferSuccess(r.sdp):this.publishStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kMediaDescError)},e.prototype.onRecvMediaDescription=function(e,t,r){this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_MEDIA_DESC+" "+this.streamId+" received"),this.state==n.ENUM_PUBLISH_STATE.waitingServerAnswer?(this.stateNego=n.ENUM_PUBLISH_STATE_NEGO.waitingCandidate,this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_MEDIA_DESC+" "+this.streamId+" received stateNego:waitingCandidate"),this.dataReport.addEvent(this.reportSeq,"RecvMediaDesc"),this.dataReport.addEvent(this.streamReportSeq,"RecvMediaDesc"),this.signal.sendMediaDescAck(e,this.sessionId,0),1==r.type?this.onGetRemoteOfferSuccess(r.sdp):this.publishStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kMediaDescError)):this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_MEDIA_DESC+" "+this.streamId+" current state "+this.state+" not allowed")},e.prototype.onGetRemoteOfferSuccess=function(e){var t,r,i,o,s,l,u=this;this.videoInfo.audioBitrate&&48e3!==this.videoInfo.audioBitrate&&(e=e.replace(/maxaveragebitrate=(\d+)/,"maxaveragebitrate="+this.videoInfo.audioBitrate)),this.remoteSdpOrder=e.match(/m=(.\w*)\s/g)||[],this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_GET_REMOTE_DESCRIPTION+" "+this.streamId+NaN+this.remoteSdpOrder.join(""));var d=this.stateCenter.turnOverTcpOnly,h=this.stateCenter.settingConfig.getSetting("udp_or_tcp",!0);if(h&&(this.logger.info("zp.oro.0 setting udp_or_tcp "+h),d="tcp"===h),d&&(null===(t=e.match(/candidate.*/g))||void 0===t||t.forEach((function(t){var r=t.replace(/udp/,"tcp");e=e.replace(t,r)}))),this.logger.info("zp.oro.0 "+this.streamId+" sdp revert "+this.localSdpOrder.join("")+" "+this.remoteSdpOrder.join("")),this.localSdpOrder.join()!==this.remoteSdpOrder.join()&&this.localSdpOrder.length==this.remoteSdpOrder.length){var p=new RegExp("[\\s\\S]*"+this.remoteSdpOrder[0]).exec(e)[0].replace(this.remoteSdpOrder[0],""),f=[],g="";this.localSdpOrder.forEach((function(t){var r=u.remoteSdpOrder.findIndex((function(e){return e==t})),i=new RegExp(t+"[\\s\\S]*"+(u.remoteSdpOrder[r+1]||"")).exec(e)[0].replace(u.remoteSdpOrder[r+1],""),n=/a=mid:(\w)/.exec(i)[1];f.push(n),g+=i||""})),e=p.replace(/a=group:BUNDLE.*/,"a=group:BUNDLE "+f.join(" "))+g,this.localSdpOrder=[],this.remoteSdpOrder=[]}var m=e.match(/m=video(.|\r|\n)*a=rtpmap(.|\r|\n)*(a=fmtp:(\d+).*)/);if("chrome"==this.stateCenter.browser){var _=0;if(this.videoInfo.bitRate&&"target"===this.videoInfo.startBitrate&&(_=this.videoInfo.bitRate),null!==m&&_){var v=m[3];e=-1!==v.indexOf("apt=")?e.replace(v,"a=fmtp:96 x-google-start-bitrate="+_+"\n"+v):e.replace(v,v+";x-google-start-bitrate="+_)}}if(this.videoInfo.bitRate>0){var E=/b=AS.*(\r\n|\n)/.test(e);e=E?e.replace(/AS:(\d+)/,"AS:"+this.videoInfo.bitRate):e.replace(/m=video.*(\r\n|\n)c=.*(\r\n|\n)/,"$&b=AS:"+this.videoInfo.bitRate+"\n");var A=null===(r=this.peerConnection)||void 0===r?void 0:r.getSenders().find((function(e){return e.track&&"video"===e.track.kind}));if(A&&A.getParameters&&A.setParameters){var y=A.getParameters();y.encodings&&0!=y.encodings.length||(y.encodings=[{}]),y.encodings[0].maxBitrate=1e3*this.videoInfo.bitRate;var S=this.lastPublishStats.frameWidth,C=(null===(o=null===(i=this.previewer)||void 0===i?void 0:i.cameraMaxResolution)||void 0===o?void 0:o.maxWidth)||0,T=null===(s=this.previewer)||void 0===s?void 0:s.videoInfo.width,b=S?Math.min(C,S):C;if(C&&T){var I=Math.max(b/T,1);y.encodings[0].scaleResolutionDownBy=I}A.setParameters(y)}}this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_GET_REMOTE_DESCRIPTION+" "+this.streamId+" remoteSdp:",e);var R={type:"answer",sdp:e,toJSON:function(){}};this.dataReport.eventStart(this.reportSeq,"SetRemoteDescription"),this.dataReport.eventStart(this.streamReportSeq,"SetRemoteDescription"),null===(l=this.peerConnection)||void 0===l||l.setRemoteDescription(new RTCSessionDescription(R)).then((function(){u.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_GET_REMOTE_DESCRIPTION+" "+u.streamId+" set success"),u.dataReport.eventEnd(u.reportSeq,"SetRemoteDescription"),u.dataReport.eventEnd(u.streamReportSeq,"SetRemoteDescription"),u.stateNego==n.ENUM_PUBLISH_STATE_NEGO.iceConnected&&u.updateSDPCallBack&&(u.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_GET_REMOTE_DESCRIPTION+" "+u.streamId+" update sdp success"),u.updateSDPCallBack(0),u.updateSDPCallBack=void 0,u.isUpdateSDP=!1)}),(function(e){u.logger.error(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_GET_REMOTE_DESCRIPTION+" "+u.streamId+" failed: "+e.toString()),u.dataReport.eventEndWithMsg(u.reportSeq,"SetRemoteDescription",{error:e.toString()}),u.dataReport.eventEndWithMsg(u.streamReportSeq,"SetRemoteDescription",{error:e.toString()}),u.publishStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSetRemoteDescError,!0)})),this.state=n.ENUM_PUBLISH_STATE.waitingServerICE,this.logger.debug(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_GET_REMOTE_DESCRIPTION+" "+this.streamId+" call success")},e.prototype.onIceConnectionStateChange=function(e){var t=this;this.state!=n.ENUM_PUBLISH_STATE.stop&&null!=this.peerConnection&&(this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE+" "+this.streamId+" stateChanged "+this.peerConnection.iceConnectionState),"connected"===this.peerConnection.iceConnectionState?(this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE+" "+this.streamId+" connected state "+this.state),this.dataReport.eventEnd(this.reportSeq,"IceConnected"),this.dataReport.eventEnd(this.streamReportSeq,"IceConnected"),this.stateNego=n.ENUM_PUBLISH_STATE_NEGO.iceConnected,this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE+" "+this.streamId+" stateNego:iceConnected"),this.negoTimer&&(clearTimeout(this.negoTimer),this.negoTimer=null),null!=this.iceDisconnectedTimer&&(clearTimeout(this.iceDisconnectedTimer),this.iceDisconnectedTimer=null),this.publishEvent?this.publishSuccess():(this.firstGetStatsTimer&&clearTimeout(this.firstGetStatsTimer),this.firstGetStatsTimer=null,this.firstGetStatsTimer=setTimeout((function(){var e;t.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE+" get first stats state "+t.state),t.state!==n.ENUM_PUBLISH_STATE.publishing&&(null===(e=t.peerConnection)||void 0===e||e.getStats().then((function(e){t.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE+" get first stats suc"),e.size>0&&t.publishSuccess()})))}),1e3))):"closed"===this.peerConnection.iceConnectionState?(this.dataReport.addEvent(this.reportSeq,"IceClosed"),this.stateNego=n.ENUM_PUBLISH_STATE_NEGO.iceClosed,this.checkPublishConnectionFailedState(this.peerConnection.iceConnectionState)):"failed"===this.peerConnection.iceConnectionState?(this.dataReport.addEvent(this.reportSeq,"IceFailed"),this.stateNego=n.ENUM_PUBLISH_STATE_NEGO.iceFailed,this.checkPublishConnectionFailedState(this.peerConnection.iceConnectionState)):"disconnected"===this.peerConnection.iceConnectionState&&(this.dataReport.addEvent(this.reportSeq,"IceDisconnected"),this.logger.warn(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE+" ice disconnected "),this.stateNego=n.ENUM_PUBLISH_STATE_NEGO.iceDisconnected,this.iceDisconnectedTimer||(this.iceDisconnectedTimer=setTimeout((function(){t.checkPublishConnectionFailedState("disconnected")}),this.iceDisconnectedMaxTime))))},e.prototype.onIceCandidate=function(e){if(this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CANDIDATE+" "+this.streamId+" candidate"+e.candidate),e.candidate)if(this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CANDIDATE+" "+this.streamId+" candidate"+e.candidate.candidate),this.state<n.ENUM_PUBLISH_STATE.connecting||this.state==n.ENUM_PUBLISH_STATE.stop)this.candidateInfo.push({candidate:e.candidate.candidate,sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex});else{var t={candidate:e.candidate.candidate,sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex};this.sendCandidateInfo([t])}},e.prototype.sendCandidateInfo=function(e){var t=this;this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_CANDIDATE_INFO+" "+this.streamId+" called"),!(e=e.filter((function(e){return e.candidate.indexOf("relay")>0})))||e.length<1?this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_CANDIDATE_INFO+" "+this.streamId+" cancelled"):(this.dataReport.eventStart(this.reportSeq,"SendIceCandidate"),this.dataReport.eventStart(this.streamReportSeq,"SendIceCandidate"),this.stateNego!==n.ENUM_PUBLISH_STATE_NEGO.iceConnected&&(this.stateNego=n.ENUM_PUBLISH_STATE_NEGO.sendCandidate),this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_CANDIDATE_INFO+" "+this.streamId+" stateNego:sendCandidate"),this.signal.sendCandidateInfo(n.getSeq(),this.sessionId,e,(function(e,r,i){t.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_CANDIDATE_INFO+" "+t.streamId+" send success"),t.dataReport.eventEnd(t.reportSeq,"SendIceCandidate"),t.dataReport.eventEnd(t.streamReportSeq,"SendIceCandidate")}),(function(e,r){t.logger.error(c.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_CANDIDATE_INFO+" "+t.streamId+" failed to send: "+e.toString()),t.dataReport.eventEndWithMsg(t.reportSeq,"SendIceCandidate",{error:e}),t.dataReport.eventEndWithMsg(t.streamReportSeq,"SendIceCandidate",{error:e}),t.publishStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kCandidateError)})))},e.prototype.onConnectionStateChange=function(e){this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CONNECTION_STATE_CHANGE+" "+this.streamId+" called "+e.target.signalingState)},e.prototype.onRecvCandidateInfo=function(e,t,r){var i,o=this;if(this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_CANDIDATE_INFO+" "+this.streamId+" received "+JSON.stringify(r.infos)),this.state==n.ENUM_PUBLISH_STATE.waitingServerICE){this.dataReport.addEvent(this.reportSeq,"RecvIceCandidate"),this.dataReport.addEvent(this.streamReportSeq,"RecvIceCandidate"),this.signal.sendCandidateInfoAck(e,this.sessionId,0),this.sendCandidateInfo(this.candidateInfo),this.candidateInfo=[];for(var s=0;s<r.infos.length;s++){var l={sdpMid:r.infos[s].sdpMid,sdpMLineIndex:r.infos[s].sdpMLineIndex,candidate:r.infos[s].candidate};this.logger.debug(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_CANDIDATE_INFO+""+this.streamId+" candidate "+l.candidate),null===(i=this.peerConnection)||void 0===i||i.addIceCandidate(new RTCIceCandidate(l)).then((function(){o.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_CANDIDATE_INFO+" "+o.streamId+" add success")}),(function(e){o.logger.error(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_CANDIDATE_INFO+" "+o.streamId+" add error "+e.toString()),o.publishStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kCandidateError,!0)}))}this.state=n.ENUM_PUBLISH_STATE.connecting,this.dataReport.eventStart(this.reportSeq,"IceConnected"),this.dataReport.eventStart(this.streamReportSeq,"IceConnected")}else this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_CANDIDATE_INFO+" "+this.streamId+" current state "+this.state+" not allowed")},e.prototype.onRecvCloseSession=function(e,t,r){this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_CLOSE_SESSION+""+this.streamId+" "+JSON.stringify(r)),this.dataReport.addEvent(this.reportSeq,"RecvCloseSession"),this.signal.sendCloseSessionAck(e,this.sessionId,0);var i=r.err_info?JSON.parse(r.err_info.toLowerCase()):{},n=i.action?i.action:null,o=1*r.reason,s=JSON.parse(JSON.stringify(a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishSessionClosedError));s.message+=" reason:"+o+" "+(n?" action:"+n:""),1011===i.err&&(s=a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kMediaServerForbidError),1014===i.err&&(s=a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishTokenExpiredError),this.negoTimer&&clearTimeout(this.negoTimer);var l=![4,8,10,11,12,14,26,27].includes(o)&&![2,5,6].includes(n);this.publishStateUpdateError(s,l)},e.prototype.onRecvResetSession=function(e,t,r){if(this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_RESET_SESSION+" "+this.streamId+" received "),t==this.sessionId){this.signal.sendCloseSessionAck(e,this.sessionId,0);var i=a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishSessionClosedError;this.negoTimer&&clearTimeout(this.negoTimer),this.publishStateUpdateError(i)}else this.logger.error(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_RESET_SESSION+" "+this.streamId+" cannot find session")},e.prototype.onRecvPublishEvent=function(e,t,r){this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_PUBLISH_EVENT+" "+this.streamId+" received"),this.publishEvent=!0,this.firstGetStatsTimer&&(clearTimeout(this.firstGetStatsTimer),this.firstGetStatsTimer=null),this.stateNego===n.ENUM_PUBLISH_STATE_NEGO.iceConnected&&0==r.event&&this.publishSuccess()},e.prototype.onRecvClientInfo=function(e,t,r){this.stateCenter.clientIP!==r.clientip&&this.logger.warn(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_CLIENT_INFO+" client ip changed "+this.stateCenter.clientIP+" "+r.clientip),this.stateCenter.clientIP=r.clientip,this.peerID=r.peer_id;var i=this.previewer;if(i&&null!==i.activateSEIConfig){var n=null==i?void 0:i.activateSEIConfig,o=n.action,s=n.infoType;this.activateSEIInsert(o,s)}},e.prototype.checkPublishConnectionFailedState=function(e){this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE+" streamID "+this.streamId," state "+this.state+" connectionState "+e),this.publishStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kMediaConnectionError)},e.prototype.setPublishQualityTimer=function(){var e=this;null==this.qualityTimer&&(this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_SET_PLAYER_QUALITY_TIMER+" "+this.streamId+" called"),this.clearPublishQualityTimer(),this.qualityTimer=setInterval((function(){e.peerConnectionGetStats()}),this.qualityTimeInterval),this.lastPublishStats={audioPacketsLost:0,videoPacketsLost:0,videoPacketsSent:0,audioPacketsSent:0,audioRetransmittedPacketsSent:0,videoTime:(new Date).getTime(),audioTime:(new Date).getTime(),time:0,audioBytesSent:0,videoBytesSent:0,framesEncoded:0,framesSent:0,videoRetransmittedPacketsSent:0},this.qualitySeq=n.getSeq(),this.qualityCount=0)},e.prototype.peerConnectionGetStats=function(e){var t=this;if(this.peerConnection){var r=[this.peerConnection.getStats(null)];"chrome"==this.stateCenter.browser&&r.push(new Promise((function(e,r){var i;null===(i=t.peerConnection)||void 0===i||i.getStats((function(t){return e(t)}),(function(e){return r(e)}))}))),Promise.all(r).then((function(r){var i=t.getPublishStats(r[0],r[1]);e&&e(i,r[0],r[1])})).catch((function(e){t.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_SET_PLAYER_QUALITY_TIMER+" "+t.streamId+" getStats error "+e.toString())}))}},e.prototype.getPublishStats=function(e,t){var r,i=this;if(e){for(var o,l=document.querySelectorAll("video, audio"),u=0;u<l.length;u++)l[u].srcObject===this.localStream&&(o=l[u]);var d=this.streamCenter.checkPreview(this.localStream),h={audioCodec:"opus",audioTargetBitrate:this.videoInfo.audioBitrate/1e3||0,audioBitrate:0,videoTargetBitrate:this.videoInfo.bitRate||0,videoTargetFPS:this.videoInfo.frameRate||0,videoBitrate:0,audioFPS:0,audioLevel:0,audioInputLevel:0,audioPacketsLost:0,audioPacketsLostRate:0,sendLevel:0,samplingRate:0,videoFPS:0,nackCount:0,pliCount:0,audioQuality:0,videoQuality:0,frameHeight:0,frameWidth:0,videoTransferFPS:0,videoPacketsLost:0,videoPacketsLostRate:0,totalRoundTripTime:0,currentRoundTripTime:0,googBandwidthLimitedResolution:void 0,videoCodecName:"",audioCodecName:"",googCpuLimitedResolution:void 0,googAvailableSendBandwidth:0,googActualEncBitrate:0,googTargetEncBitrate:0,googFrameWidthInput:0,googFrameHeightInput:0,googFrameRateInput:0,codecImplementationName:"",videoMuteState:(null===(r=null==d?void 0:d.videoTrack)||void 0===r?void 0:r.enabled)?"0":"1",audioMuteState:this.localStream.getAudioTracks().length>0&&this.localStream.getAudioTracks()[0].enabled?"0":"1",muted:o?o.muted:void 0,paused:o?o.paused:void 0,volume:o?o.volume:void 0,sinkId:o?o.sinkId:void 0},p=this.lastPublishStats.time,f=0,g=0,m=0,_=0,v=0,E=0;e.forEach((function(e){if(("outbound-rtp"==e.type||"ssrc"==e.type&&null!=e.bytesSent)&&"audio"==e.mediaType)0!=p&&(h.audioBitrate=8*(e.bytesSent-i.lastPublishStats.audioBytesSent)/(e.timestamp-p),h.audioFPS=(e.packetsSent-(e.retransmittedPacketsSent-i.lastPublishStats.audioRetransmittedPacketsSent)-i.lastPublishStats.audioPacketsSent)/(e.timestamp-p)*1e3,m=(e.retransmittedPacketsSent-i.lastPublishStats.audioRetransmittedPacketsSent)/(e.packetsSent-i.lastPublishStats.audioPacketsSent)),h.audioBitrate<0&&(h.audioBitrate=0),i.lastPublishStats.audioBytesSent=e.bytesSent,i.lastPublishStats.time=e.timestamp,i.lastPublishStats.audioPacketsSentTimeStamp=e.packetsSent-i.lastPublishStats.audioPacketsSent,i.lastPublishStats.audioPacketsSent=e.packetsSent,i.lastPublishStats.audioRetransmittedPacketsSent=e.retransmittedPacketsSent;else if(("outbound-rtp"==e.type||"ssrc"==e.type&&null!=e.bytesSent)&&"video"==e.mediaType)0!=p&&(h.videoBitrate=8*(e.bytesSent-i.lastPublishStats.videoBytesSent)/(e.timestamp-p),h.videoFPS=1e3*(e.framesEncoded-i.lastPublishStats.framesEncoded)/(e.timestamp-p),_=(e.retransmittedPacketsSent-i.lastPublishStats.videoRetransmittedPacketsSent)/(e.packetsSent-i.lastPublishStats.videoPacketsSent)),h.videoBitrate<0&&(h.videoBitrate=0),h.videoFPS<0&&(h.videoFPS=0),h.nackCount=e.nackCount,h.pliCount=e.pliCount,i.lastPublishStats.videoBytesSent=e.bytesSent,i.lastPublishStats.framesEncoded=e.framesEncoded,i.lastPublishStats.time=e.timestamp,i.lastPublishStats.videoPacketsSentTimeStamp=e.packetsSent-i.lastPublishStats.videoPacketsSent,i.lastPublishStats.videoPacketsSent=e.packetsSent,i.lastPublishStats.videoRetransmittedPacketsSent=e.retransmittedPacketsSent;else if("remote-inbound-rtp"==e.type&&"video"==e.kind){e.packetsLost>0&&(h.videoPacketsLost=e.packetsLost);var t=e.packetsLost-i.lastPublishStats.videoPacketsLost;h.videoPacketsLostRate=t>0?t/i.lastPublishStats.videoPacketsSentTimeStamp:0,e.packetsLost>0&&(i.lastPublishStats.videoPacketsLost=e.packetsLost),i.lastPublishStats.videoTime=e.timestamp,g=1e3*e.roundTripTime,E=e.jitter}else if("remote-inbound-rtp"==e.type&&"audio"==e.kind){e.packetsLost>0&&(h.audioPacketsLost=e.packetsLost);var r=e.packetsLost-i.lastPublishStats.audioPacketsLost;h.audioPacketsLostRate=r>0?r/i.lastPublishStats.audioPacketsSentTimeStamp:0,e.packetsLost>0&&(i.lastPublishStats.audioPacketsLost=e.packetsLost),i.lastPublishStats.audioTime=e.timestamp,f=1e3*e.roundTripTime,v=e.jitter}else if("media-source"==e.type&&("audio"==e.kind||e.id.toLowerCase().indexOf("audio")>=0))h.audioLevel=e.audioLevel,h.sendLevel=e.totalAudioEnergy,h.audioInputLevel=32767*e.totalAudioEnergy,h.samplingRate=e.totalSamplesDuration;else if("track"==e.type&&("video"==e.kind||e.id.indexOf("video")>=0||e.frameWidth)){if(h.frameHeight=e.frameHeight,h.frameWidth=e.frameWidth,0===p||i.lastPublishStats.frameHeight===e.frameHeight&&i.lastPublishStats.frameWidth===e.frameWidth)0===p&&(i.lastPublishStats.frameHeight=e.frameHeight,i.lastPublishStats.frameWidth=e.frameWidth);else{var o=n.getReportSeq();i.dataReport.newReport(o,a.ZegoRTCLogEvent.kZegoTaskVideoCaptureSize.event),i.dataReport.addMsgInfo(o,{session_id:a.ZegoRTCLogEvent.kZegoTaskVideoCaptureSize.session_id(i.sessionId),w:a.ZegoRTCLogEvent.kZegoTaskVideoCaptureSize.w(e.frameWidth),h:a.ZegoRTCLogEvent.kZegoTaskVideoCaptureSize.h(e.frameHeight)}),i.dataReport.uploadReport(o),i.lastPublishStats.frameHeight=e.frameHeight,i.lastPublishStats.frameWidth=e.frameWidth}0!=p&&(h.videoTransferFPS=1e3*(e.framesSent-i.lastPublishStats.framesSent)/(e.timestamp-p)),h.videoTransferFPS<0&&(h.videoTransferFPS=0),i.lastPublishStats.framesSent=e.framesSent}else"candidate-pair"==e.type&&(null!=e.totalRoundTripTime&&(h.totalRoundTripTime=e.totalRoundTripTime),null!=e.currentRoundTripTime&&(h.currentRoundTripTime=e.currentRoundTripTime))})),t&&t.result().forEach((function(e){"ssrc"==e.type&&e.names().indexOf("googBandwidthLimitedResolution")>=0&&(h.googBandwidthLimitedResolution=e.stat("googBandwidthLimitedResolution")),"ssrc"==e.type&&"video"==e.stat("mediaType")&&e.names().indexOf("googCodecName")>=0&&(h.videoCodecName=e.stat("googCodecName")),"ssrc"==e.type&&"audio"==e.stat("mediaType")&&e.names().indexOf("googCodecName")>=0&&(h.audioCodecName=e.stat("googCodecName")),"ssrc"==e.type&&e.names().indexOf("googCpuLimitedResolution")>=0&&(h.googCpuLimitedResolution=e.stat("googCpuLimitedResolution")),"ssrc"==e.type&&e.names().indexOf("googFrameWidthInput")>=0&&(h.googFrameWidthInput=e.stat("googFrameWidthInput")),"ssrc"==e.type&&e.names().indexOf("googFrameHeightInput")>=0&&(h.googFrameHeightInput=e.stat("googFrameHeightInput")),"ssrc"==e.type&&e.names().indexOf("googFrameRateInput")>=0&&(h.googFrameRateInput=e.stat("googFrameRateInput")),"ssrc"==e.type&&e.names().indexOf("codecImplementationName")>=0&&(h.codecImplementationName=e.stat("codecImplementationName")),"VideoBwe"==e.type&&e.names().indexOf("googAvailableSendBandwidth")>=0&&(h.googAvailableSendBandwidth=e.stat("googAvailableSendBandwidth")),"VideoBwe"==e.type&&e.names().indexOf("googActualEncBitrate")>=0&&(h.googActualEncBitrate=e.stat("googActualEncBitrate")),"VideoBwe"==e.type&&e.names().indexOf("googTargetEncBitrate")>=0&&(h.googTargetEncBitrate=e.stat("googTargetEncBitrate")),"VideoBwe"==e.type&&e.names().indexOf("googRetransmitBitrate")>=0&&(h.googRetransmitBitrate=e.stat("googRetransmitBitrate"))})),"chrome"===this.stateCenter.browser&&this.handleEncBitrate(Number.parseInt(h.googTargetEncBitrate),Number.parseInt(h.googActualEncBitrate),Number.parseInt(h.googRetransmitBitrate)),g=isNaN(g)||g<0?0:g,_=isNaN(_)||_<0?0:_,E=isNaN(E)||E<0?0:E,f=isNaN(f)||f<0?0:f,m=isNaN(m)||m<0?0:m,v=isNaN(v)||v<0?0:v;var A=s.ClientUtil.getNetQuality(g,_,E),y=s.ClientUtil.getNetQuality(f,m,v);h.videoQuality=p>0?s.ClientUtil.quality2QualityGrade(A):0,h.audioQuality=p>0?s.ClientUtil.quality2QualityGrade(y):0;var S=Math.min(A,y);this.netQuality=S,p>0&&S<=n.QUALITY_CONSTANT.MiddleMinQuality&&(new Date).getTime()>this.probeTime+this.probeInterval&&(this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAYER_SET_PLAYER_QUALITY_TIMER+" netQuality "+S+" start net probe"),this.probeState=n.ENUM_PROBE_STATE.tryProbe,this.streamCenter.startNetProbe(!0,this,this.gwNodeList),this.probeTime=(new Date).getTime());var C={video:{videoBitrate:h.videoBitrate,videoFPS:h.videoFPS,videoTransferFPS:h.videoTransferFPS,frameHeight:h.frameHeight,frameWidth:h.frameWidth,muteState:h.videoMuteState,videoQuality:h.videoQuality,videoPacketsLost:h.videoPacketsLost,videoPacketsLostRate:h.videoPacketsLostRate},audio:{audioBitrate:h.audioBitrate,audioCodec:h.audioCodec,muteState:h.audioMuteState,audioQuality:h.audioQuality,audioPacketsLost:h.audioPacketsLost,audioPacketsLostRate:h.audioPacketsLostRate,audioFPS:h.audioFPS},nackCount:h.nackCount,pliCount:h.pliCount,totalRoundTripTime:h.totalRoundTripTime,currentRoundTripTime:h.currentRoundTripTime};return void 0!==h.videoPacketsLost&&(C.video.videoPacketsLost=h.videoPacketsLost,C.video.videoPacketsLostRate=h.videoPacketsLostRate,C.audio.audioPacketsLost=h.audioPacketsLost,C.audio.audioPacketsLostRate=h.audioPacketsLostRate),void 0!==h.muted&&(C.muted=h.muted,C.paused=h.paused,C.volume=h.volume,C.sinkId=h.sinkId),void 0!==h.googBandwidthLimitedResolution&&(C.googBandwidthLimitedResolution=h.googBandwidthLimitedResolution,C.video.googCodecName=h.videoCodecName,C.audio.googCodecName=h.audioCodecName,C.googCpuLimitedResolution=h.googCpuLimitedResolution,C.googFrameWidthInput=h.googFrameWidthInput,C.googFrameHeightInput=h.googFrameHeightInput,C.googFrameRateInput=h.googFrameRateInput,C.codecImplementationName=h.codecImplementationName,C.googAvailableSendBandwidth=h.googAvailableSendBandwidth,C.googActualEncBitrate=h.googActualEncBitrate,C.googTargetEncBitrate=h.googTargetEncBitrate),0!==p&&(this.uploadPublishQuality(h),this.onPublishQualityUpdate(this.streamId,C,e,t)),C}},e.prototype.uploadPublishQuality=function(e){var t=this;if(this.qualityUpload){var r=(new Date).getTime();(0==this.qualityUploadLastTime||r-this.qualityUploadLastTime>=this.qualityUploadInterval)&&(e.stream_type="publish",e.stream_id=this.streamId,e.timeStamp=parseInt(Math.round(r/1e3).toString()),this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_UPLOAD_PUBLISH_QUALITY+" "+this.streamId+" upload"+JSON.stringify(e)),this.streamCenter.updateQuality(0,e),this.signal.QualityReport(n.getSeq(),this.sessionId,e,(function(e,r,i){void 0!==i.report&&(t.qualityUpload=i.report,t.qualityUploadInterval=i.report_interval_ms)}),(function(e,r){t.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_UPLOAD_PUBLISH_QUALITY+" "+t.streamId+" upload failed "+e)})),this.qualityUploadLastTime=r)}},e.prototype.stopPublish=function(){if(this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_STOP_PUBLISH+"  .1 "+this.streamId+" called"),Object.keys(this.streamCenter.publisherList).length=1)for(var e in this.streamCenter.playerList){var t=this.streamCenter.playerList[e].player;t.state==n.ENUM_PLAY_STATE.playing&&t.broadcasterStatus==n.ENUM_BROADCASTER_STATUS.start&&(this.signal&&this.signal.sendBroadcasterStatus(n.getSeq(),t.sessionId,0),t.broadcasterStatus=n.ENUM_BROADCASTER_STATUS.stop)}this.stopMixingAudio(),this.stopMixingBuffer(),this.stopEffect(),this.sessionId&&!this.closeSessionSignal&&this.signal.sendCloseSession(n.getSeq(),this.sessionId,0),this.dataReport.eventEndWithMsg(this.streamReportSeq,"PublishState",{state:this.state+""}),this.dataReport.addEvent(this.streamReportSeq,"StopPublish"),this.dataReport.addMsgExt(this.streamReportSeq,{stream:this.streamId,sessionId:this.sessionId}),this.dataReport.addMsgInfo(this.streamReportSeq,{itemtype:"RTCPublishStream"}),this.dataReport.uploadReport(this.streamReportSeq,"RTCPublishStream"),this.resetPublish()},e.prototype.onPublishStateUpdate=function(e,t,r,i){},e.prototype.onPublishQualityUpdate=function(e,t,r,i){},e.prototype.onDisconnect=function(e){this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_DISCONNECT+" "+this.streamId+" call"),this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_DISCONNECT+" "+this.streamId+" websocket disconnect"),this.dataReport.addEvent(this.reportSeq,"OnDisconnect"),this.publishStateUpdateError(e||a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kWebsocketDisconnectedError,!!e)},e.prototype.playEffect=function(e,t,r,i){},e.prototype.pauseEffect=function(e){},e.prototype.resumeEffect=function(e){},e.prototype.stopEffect=function(e){},e.prototype.setEffectVolume=function(e,t){},e.prototype.startMixingAudio=function(e){},e.prototype.stopMixingAudio=function(e){},e.prototype.mixingBuffer=function(e,t,r){},e.prototype.stopMixingBuffer=function(e){},e.prototype.setMixingAudioVolume=function(e,t){},e.prototype.publishSuccess=function(){var e;if(this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_PUBLISH_SUCCESS+" call"),this.isUpdateSDP&&this.updateSDPCallBack)return this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_PUBLISH_SUCCESS+" "+this.streamId+" update sdp success"),this.updateSDPCallBack(0),this.updateSDPCallBack=void 0,void(this.isUpdateSDP=!1);for(var t in this.state!=n.ENUM_PUBLISH_STATE.publishing&&this.onPublishStateUpdate(n.ENUM_PUBLISH_STATE_UPDATE.start,this.streamId,{code:0,message:""},!0),this.isPeer&&(this.peerFailCount=0),this.state=n.ENUM_PUBLISH_STATE.publishing,this.dataReport.eventStart(this.reportSeq,"PublishState"),this.dataReport.eventStart(this.streamReportSeq,"PublishState"),this.streamCenter.playerList){var r=this.streamCenter.playerList[t].player;r.state==n.ENUM_PLAY_STATE.playing&&r.broadcasterStatus==n.ENUM_BROADCASTER_STATUS.stop&&(this.signal&&this.signal.sendBroadcasterStatus(n.getSeq(),r.sessionId,1),r.broadcasterStatus=n.ENUM_BROADCASTER_STATUS.start)}this.setPublishQualityTimer();var i=2,o=2,s=null===(e=this.previewer)||void 0===e?void 0:e.videoTrack,a=0!==this.localStream.getAudioTracks().length&&this.localStream.getAudioTracks()[0];s&&!0===s.enabled&&(i=0),a&&!0===a.enabled&&(o=0),this.sendStreamStatus(i,o),this.streamCenter.soundLevelDelegate&&this.previewer&&this.previewer.startSoundLevel(),this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_PUBLISH_SUCCESS+" call success")},e.prototype.startSoundLevel=function(){var e;if(this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_START_SOUND_LEVEL+" call streamID: "+this.streamId),this.localStream&&0!=this.localStream.getAudioTracks().length)try{null===(e=this.previewer)||void 0===e||e.startSoundLevel()}catch(e){this.logger.error(c.ZEGO_WEBRTC_ACTION.PUBLISHER_START_SOUND_LEVEL+" "+this.streamId+" get sound level failed "+e)}else this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_START_SOUND_LEVEL+" "+this.streamId+" local stream no found")},e.prototype.stopSoundLevel=function(){var e;this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISHER_STOP_SOUND_LEVEL+" call streamID: "+this.streamId),null===(e=this.previewer)||void 0===e||e.stopSoundLevel()},e.prototype.rebackMic=function(){var e,t=this;if(this.peerConnection&&this.micTrack instanceof MediaStreamTrack&&0==this.audioMixList.length&&0==Object.keys(this.arrayBufferMap).length&&0==this.effectList.length){var r=null===(e=this.peerConnection)||void 0===e?void 0:e.getSenders().find((function(e){var r,i;return(null===(r=e.track)||void 0===r?void 0:r.kind)===(null===(i=t.micTrack)||void 0===i?void 0:i.kind)}));r&&(r.replaceTrack(this.micTrack),this.localStream.removeTrack(this.localStream.getAudioTracks()[0]),this.localStream.addTrack(this.micTrack))}},e.prototype.handleEncBitrate=function(e,t,r){var i,n=this,o=1e3*this.videoInfo.bitRate,a=0;if(t>0){this.needIncMax||this.gotMax||(this.probeCount++,t>=.75*e?(this.probeCount>=10&&this.initFitCnt>=.6*this.probeCount&&(this.gotMax=!0,this.targetRate=o),this.initFitCnt++):this.probeCount>=10&&this.initFitCnt/this.probeCount<.3&&(this.needIncMax=!0));var l=s.ClientUtil.arrAvg(this.totalBitrateArray,t,10);if(this.needIncMax)if(l>=1.05*o){if(this.targetRate>o){var u=void 0;l>e?(u=l-e,this.targetRate-=u):(u=l-o,this.targetRate-=u),this.targetRate=Math.max(this.targetRate,o),this.targetRate=Math.min(this.targetRate,2*o),a=this.targetRate}}else l<.8*o&&(0===this.targetRate&&(this.targetRate=e),this.targetRate>=o?this.targetRate=this.targetRate+.08*o:this.targetRate=1.05*this.targetRate,this.targetRate=Math.min(this.targetRate,2*o),a=this.targetRate)}if(r>0&&r<o){var d=s.ClientUtil.arrAvg(this.totalRetransRateArray,r,5);this.needIncMax?d+t>1.05*o&&(u=d+t-o,this.targetRate-=u,this.targetRate=Math.max(this.targetRate,o-d),a=this.targetRate):a=this.targetRate-d}else this.targetRate<o&&(this.targetRate=o,a=this.targetRate);if(a>0){a=s.ClientUtil.arrAvg(this.totalTargetRateArray,a,5);var h=null===(i=this.peerConnection)||void 0===i?void 0:i.getSenders().find((function(e){return e.track&&"video"===e.track.kind}));if(!h)return;var p=h.getParameters();p.encodings||(p.encodings=[{}]),p.encodings[0].maxBitrate=a,h.setParameters(p).catch((function(e){n.logger.error(c.ZEGO_WEBRTC_ACTION.PUBLISHER_HANDLE_ENC_BITRATE+" "+e)}))}},e.prototype.resetEncBitrate=function(){this.needIncMax=!1,this.probeCount=0,this.gotMax=!1,this.initFitCnt=0,this.targetRate=0,this.totalBitrateArray=[],this.totalTargetRateArray=[],this.totalRetransRateArray=[]},e.prototype.replacePublishedTrack=function(e,t){return void 0===t&&(t=!1),{errorCode:-1,extendedData:"should install advanced module first"}},e.prototype.sendStreamStatus=function(e,t,r){var i=this;void 0===r&&(r=0),this.camera_status=e,this.mic_status=t,r++,this.signal.sendStreamStatus(n.getSeq(),this.sessionId,e,t,this.streamId,(function(){i.camera_status===e&&i.mic_status===t&&r<=1&&i.sendStreamStatus(e,t,r)}))},e}();t.ZegoPublish=l},5019:function(e,t,r){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoSignal=void 0;var n=r(6706),o=r(1089),s=r(2752),a=function(){function e(e,t){this.sendDataMap={},this.sendDataList=new n.LinkedList,this.sendDataCheckOnceCount=100,this.signalSeq=0,this.pushCallback={},this.sessionInfos={},this.tryHeartbeatCount=0,this.heartbeatInterval=1e4,this.sendDataTimeout=5e3,this.sendDataDropTimeout=1e4,this.sendDataCheckTimer=null,this.sendDataCheckInterval=2e3,this.checkMessageList=["ActivateVideoPlayStreamReq","ActivateAudioPlayStreamReq","CreateSessionReq","CreateSessionWithSdpReq","ActivateSEIInsertReq","StreamStatusNotify","MediaDescUpdateReq"],this.tryConnectCount=1,this.tryConnectTimer=null,this.tryConnectInterval=3e3,this.state=n.ENUM_CONNECT_STATE.disconnect,this.tokenType=0,this.browser=this.getBrowserAndVersion(),this.platform=navigator.platform,this.negoInterval=25e3,this.negoTryCount=1,this.negoTryMaxCount=2,this.logger=e,this.stateCenter=t,this.stateCenter.streamConnectTime&&(this.tryConnectInterval=this.stateCenter.streamConnectTime)}return e.prototype.getBrowserAndVersion=function(){var e,t=navigator.userAgent,r=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*([\d\.]+)/i)||[];return/trident/i.test(r[1])?{name:"IE",version:(e=/\brv[ :]+([\d\.]+)/g.exec(t)||[])[1]||""}:"Chrome"===r[1]&&null!=(e=t.match(/\bOPR|Edge\/([\d\.]+)/))?{name:"Opera",version:e[1]}:(r=r[2]?[r[1],r[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/([\d+\.]+)/i))&&r.splice(1,1,e[1]),{name:r[0],version:r[1]})},e.prototype.setSessionInfo=function(e,t){this.logger.debug(o.ZEGO_WEBRTC_ACTION.SIGNAL_SET_SESSION_INFO+" call"),this.appid=e+"",this.userid=t},e.prototype.onDisconnect=function(e,t){},e.prototype.onUpdateHeartBeatInterval=function(e){},e.prototype.resetConnectTimer=function(){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_RESET_CONNECT_TIMER+" call"),clearTimeout(this.tryConnectTimer),this.tryConnectTimer=null,this.tryConnectCount=0},e.prototype.bindWebSocketHandle=function(){var e=this;this.tryHeartbeatCount=0,this.tryConnectInterval=this.stateCenter.streamConnectTime?this.stateCenter.streamConnectTime:3e3,this.websocket.onmessage=function(t){var r=JSON.parse(t.data);e.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_BIND_WEBSOCKET_HANDLE+" signmsg= ",r.header.cmd),e.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_BIND_WEBSOCKET_HANDLE+" signmsg= "+JSON.stringify(r)),r.header.appid==e.appid&&r.header.user_id===e.userid?e.handleServerPush(r):e.logger.warn(o.ZEGO_WEBRTC_ACTION.SIGNAL_BIND_WEBSOCKET_HANDLE+" check header failed")},this.websocket.onclose=function(t){e.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_BIND_WEBSOCKET_HANDLE+" close msg = "+JSON.stringify(t.code?t.code:t)),e.state!=n.ENUM_CONNECT_STATE.disconnect&&(e.resetConnectTimer(),e.startConnectTimer((function(t){1008===t&&e.disconnectCallback(s.errorCodeList.TOKEN_EXPIRED)})),e.resetCheckMessage())},this.websocket.onerror=function(t){e.logger.error(o.ZEGO_WEBRTC_ACTION.SIGNAL_BIND_WEBSOCKET_HANDLE+" msg = "+JSON.stringify(t))}},e.prototype.resetCheckMessage=function(){this.logger.debug(o.ZEGO_WEBRTC_ACTION.SIGNAL_RESET_CHECK_MESSAGE+" call"),clearTimeout(this.sendDataCheckTimer),this.sendDataCheckTimer=null;for(var e=this.sendDataList.getFirst();null!=e;)this.sendDataList.remove(e),e._data.error&&e._data.error(n.SEND_MSG_RESET,e._data.seq),e=this.sendDataList.getFirst();this.sendDataMap={}},e.prototype.handleServerPush=function(e){switch(e.header.cmd){case"LoginRsp":this.handleRespondData("LoginReq",e);break;case"CreateSessionRsp":this.handleRespondData("CreateSessionReq",e),0===e.body.result&&this.addSession(e.header.session_id,e.body.session_token);break;case"CreateSessionWithSdpRsp":this.handleRespondData("CreateSessionWithSdpReq",e),0===e.body.result&&this.addSession(e.header.session_id,e.body.session_token);break;case"MediaDescRsp":this.handleRespondData("MediaDescReq",e);break;case"CandidateInfoRsp":this.handleRespondData("CandidateInfoReq",e);break;case"CloseSessionRsp":this.handleRespondData("CloseSessionReq",e),this.removeSession(e.header.session_id);break;case"ClientHBRsp":this.handleRespondData("ClientHBReq",e);break;case"MediaDescPush":case"CandidateInfoPush":this.handlePushData(e);break;case"CloseSessionPush":this.handlePushData(e),this.removeSession(e.header.session_id);break;case"QualityReportRsp":this.handleRespondData("QualityReportReq",e);break;case"SessionResetPush":this.handlePushResetSessionData(e);break;case"StreamStatusNotifyPush":case"PublishEventPush":case"PlayEventPush":case"ClientInfoPush":this.handlePushData(e);break;case"ActivateVideoPlayStreamRsp":this.handleRespondData("ActivateVideoPlayStreamReq",e);break;case"ActivateAudioPlayStreamRsp":this.handleRespondData("ActivateAudioPlayStreamReq",e);break;case"NetQualityProbeRsp":this.handleRespondData("NetQualityProbeReq",e);break;case"NetQualityInfoPush":this.handlePushData(e);break;case"ActivateSEIInsertRsp":this.handleRespondData("ActivateSEIInsertReq",e);break;case"StreamStatusNotifyAck":this.handleRespondData("StreamStatusNotify",e);break;case"Peer2PeerNetStatsGetRsp":this.handleRespondData("Peer2PeerNetStatsGetReq",e);break;case"MediaDescUpdateRsp":this.handleRespondData("MediaDescUpdateReq",e);case"MediaDescUpdatePush":this.handlePushData(e)}},e.prototype.disconnectCallback=function(e){this.connectCallback&&(this.connectCallback(-1,this.server,void 0),this.connectCallback=null);var t=this.server;this.disconnectServer(),this.onDisconnect(t,e)},e.prototype.updateToken=function(){var e=this;this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_UPDATE_TOKEN+" call");var t={token:this.token,tokenType:this.tokenType,roomid:this.roomID,anchorname:this.stateCenter.anchor_info.anchor_id,sdkversion:n.PROTO_VERSION,osinfo:navigator.appVersion};if(0!=Object.keys(this.sessionInfos).length){var r=[];for(var i in this.sessionInfos){var s=parseInt(i);r.push({session_id:s,session_token:this.sessionInfos[s].token})}t.sessions=r}this.sendMessageWithCallback("LoginReq",this.stateCenter.getSeq(),0,t,(function(t,r,i){if(0==i.result){e.token=i.token,e.tokenType=i.tokenType;var n={report:i.report,report_interval:i.report_interval_ms};i.negoInterval&&(e.negoInterval=i.negoInterval),i.negoTryCount&&(e.negoTryCount=i.negoTryCount),i.negoTryMaxCount&&(e.negoTryMaxCount=i.negoTryMaxCount),null!=e.connectCallback&&(e.connectCallback(0,e.server,n),e.connectCallback=null),e.checkMessageTimeout()}else{var o={error:i.strError};null!=e.connectCallback&&(e.connectCallback(i.result,e.server,o),e.connectCallback=null)}}),(function(){null!=e.connectCallback&&(e.connectCallback(-1,e.server,void 0),e.connectCallback=null)}))},e.prototype.sendMessageWithCallback=function(e,t,r,i,s,a){if(this.logger.debug(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MESSAGE_WITH_CALLBACK+" call "+e),!this.websocket||1!==this.websocket.readyState)return this.logger.error(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MESSAGE_WITH_CALLBACK+" connect not establish"),void(a&&a(n.SEND_MSG_TIMEOUT,t));var c={header:this.getHeader(e,t,r),body:i};null==s&&(s=null),null==a&&(a=null);var l={seq:t,deleted:!1,cmd:e,time:(new Date).getTime(),success:s,error:a},u=this.sendDataList.push(l);this.sendDataMap[l.seq]=u;var d=JSON.stringify(c);this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MESSAGE_WITH_CALLBACK+" "+d),this.websocket.send(d),this.logger.debug(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MESSAGE_WITH_CALLBACK+" success")},e.prototype.getHeader=function(e,t,r){return this.globalHeader={version:"1.0.1",cmd:e,appid:this.appid+"",seq:t,user_id:this.userid,session_id:r},this.globalHeader},e.prototype.connectServer=function(e,t,r,i){var s=this;if(this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" "+r),this.roomID=e,this.token=t,this.server=r,this.state=n.ENUM_CONNECT_STATE.connecting,this.connectCallback=i,this.websocket&&1===this.websocket.readyState)this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" websocket is connected"),this.resetConnectTimer(),this.state=n.ENUM_CONNECT_STATE.connected;else{this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" need new websocket");try{this.websocket&&(this.logger.warn(o.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" close error websocket"),this.websocket.onclose=null,this.websocket.onerror=null,this.websocket.close(),this.websocket=null),this.websocket=new WebSocket(this.server),this.websocket.onopen=function(){s.resetConnectTimer(),s.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" websocket open call"),s.bindWebSocketHandle(),s.updateToken(),s.state=n.ENUM_CONNECT_STATE.connected},this.websocket.onclose=function(e){s.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" websocket close call  "+JSON.stringify(e))},this.websocket.onerror=function(e){s.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" websocket onerror call  "+JSON.stringify(e))}}catch(e){this.logger.error(o.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" websocket error "+e)}}this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" "+this.tryConnectInterval),this.tryConnectTimer=setTimeout((function(){s.startConnectTimer(i)}),this.tryConnectInterval)},e.prototype.startConnectTimer=function(e){if(this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_START_CONNECT_TIMER+" call"),this.tryConnectCount>=n.MAX_TRY_CONNECT_COUNT)return this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_START_CONNECT_TIMER+" beyond "+this.server+"max limit"),void this.disconnectCallback();this.websocket&&1===this.websocket.readyState?(this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_START_CONNECT_TIMER+" websocket is connected"),this.resetConnectTimer()):(this.tryConnectCount+=1,this.connectServer(this.roomID,this.token,this.server,e))},e.prototype.disconnectServer=function(){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_DISCONNECT_SERVER+" call"),this.connectCallback=null,this.resetCheckMessage(),this.resetConnectTimer(),this.websocket&&(this.websocket.onclose=null,this.websocket.onerror=null,this.websocket.close(),this.websocket=null),this.token="",this.sessionInfos={},this.tokenType=0,this.tryHeartbeatCount=0,this.tryConnectCount=0,this.state=n.ENUM_CONNECT_STATE.disconnect},e.prototype.isServerConnected=function(){return!(!this.websocket||1!==this.websocket.readyState)},e.prototype.createSession=function(e,t,r,i,s,a,c,l){void 0===s&&(s=""),void 0===a&&(a=""),this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CREATE_SESSION+" call: "+i);var u="";n.PROTO_VERSION.split(".").forEach((function(e,t){return 1==e.length&&1==t?u+="0"+e:u+=e}));var d={type:t,stream_id:i,platform:this.platform,browser:this.browser.name,version:this.browser.version,app_id:this.appid,negotiate_mode:r,strAuthParam:s,sdk_version:1*u,turn_server_host:"string"==typeof a?a:""};this.sendMessageWithCallback("CreateSessionReq",e,0,d,c,l)},e.prototype.createSessionWithSdp=function(e,t,r){var i=e.seq,s=e.type,a=e.streamId,c=e.strAuthParam,l=e.sdp,u=e.serverHost,d=e.playBufLevel;this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CREATE_SESSION+" call: "+a);var h="";n.PROTO_VERSION.split(".").forEach((function(e,t){return 1==e.length&&1==t?h+="0"+e:h+=e}));var p={type:s,app_id:this.appid,stream_id:a,sdp:l,user_id:this.userid,platform:this.platform,browser:this.browser.name,sdk_vers:parseInt(h),clientIp:"",media_server_host:"string"==typeof u?u:"",strAuthParam:c};d&&(p.min_play_buf_level_ms=d),this.sendMessageWithCallback("CreateSessionWithSdpReq",i,0,p,t,r)},e.prototype.sendMediaDescUpdateReq=function(e,t,r,i,n){var o={peer_id:r.peerID,type:r.type,sdp:r.sdp,width:r.width,height:r.height,framerate:r.frameRate,video_min_kpbs:r.video_min_kpbs,video_max_kpbs:r.video_max_kpbs,audio_kpbs:r.audio_kpbs,keyframe_intv:r.keyframe_intv};this.sendMessageWithCallback("MediaDescUpdateReq",e,t,o,i,n)},e.prototype.removeSession=function(e){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_REMOVE_SESSION+" call"+e),this.sessionInfos[e]&&delete this.sessionInfos[e]},e.prototype.sendCloseSession=function(e,t,r,i,n){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_REMOVE_SESSION+" call: "+t);var s={reason:r};this.removeSession(t),this.sendMessageWithCallback("CloseSessionReq",e,t,s,i,n)},e.prototype.sendMessage=function(e,t,r,i){if(this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MESSAGE+" call "+e),this.websocket&&1===this.websocket.readyState){var n={header:this.getHeader(e,t,r),body:i},s=JSON.stringify(n);this.websocket.send(s),this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MESSAGE+" success")}else this.logger.error(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MESSAGE+" connect not establish")},e.prototype.handleRespondData=function(e,t){this.logger.debug(o.ZEGO_WEBRTC_ACTION.SIGNAL_HANDLE_RESPOND_DATA+" call");var r=this.sendDataMap[t.header.seq];if(null!=r){var i=r._data;i.cmd!==e?this.logger.error(o.ZEGO_WEBRTC_ACTION.SIGNAL_HANDLE_RESPOND_DATA+" command is not match"):i.success&&i.success(t.header.seq,t.header.session_id,t.body),delete this.sendDataMap[t.header.seq],this.sendDataList.remove(r)}else{if("CloseSessionRsp"==t.header.cmd)return;this.logger.error(o.ZEGO_WEBRTC_ACTION.SIGNAL_HANDLE_RESPOND_DATA+" cannot find data "+e)}},e.prototype.addSession=function(e,t){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_ADD_SESSION+" call"+e),this.sessionInfos[e]={token:t}},e.prototype.handlePushData=function(e){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_HANDLE_PUSH_DATA+" call "+e.header.cmd+" session "+e.header.session_id);var t=this.pushCallback[e.header.cmd+e.header.session_id];t?t.callback&&t.callback(e.header.seq,e.header.session_id,e.body):this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_HANDLE_PUSH_DATA+" no callbackData "+e.header.cmd+" session: "+e.header.session_id)},e.prototype.handlePushResetSessionData=function(e){this.logger.debug(o.ZEGO_WEBRTC_ACTION.SIGNAL_HANDLE_PUSH_RESET_SESSION_DATA+" call ");var t=[];if(0==e.body.cResetType)t=Object.keys(this.sessionInfos);else if(1==e.body.cResetType)for(var r=0;r<e.body.session_ids.length;r++)t.push(e.body.session_ids[r]);if(this.sendResetSessionAck(e.header.seq,0,0),0!=t.length)for(var i=0;i<t.length;i++){var n=this.pushCallback[e.header.cmd+t[i]];null==n?this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_HANDLE_PUSH_RESET_SESSION_DATA+" no callbackData "+t[i]):n.callback&&n.callback(e.header.seq,t[i],e.body)}else this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_HANDLE_PUSH_RESET_SESSION_DATA+" no session to callback")},e.prototype.sendMediaDesc=function(e,t,r,i,n,s){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MEDIA_DESC+" call: "+t);var a={type:r,sdp:i.sdp};null!=i.width&&(a.width=i.width),null!=i.height&&(a.height=i.height),null!=i.frameRate&&(a.framerate=i.frameRate),null!=i.video_min_kpbs&&(a.video_min_kpbs=i.video_min_kpbs),null!=i.video_max_kpbs&&(a.video_max_kpbs=i.video_max_kpbs),null!=i.audio_kpbs&&(a.audio_kpbs=i.audio_kpbs),null!=i.keyframe_intv&&(a.keyframe_intv=i.keyframe_intv),null!=i.min_play_buf_level_ms&&(a.min_play_buf_level_ms=i.min_play_buf_level_ms),this.sendMessageWithCallback("MediaDescReq",e,t,a,n,s)},e.prototype.sendCandidateInfo=function(e,t,r,i,n){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_CANDIDATE_INFO+" call: "+t);for(var s=[],a=0;a<r.length;a++){var c={candidate:r[a].candidate,sdpMid:r[a].sdpMid,sdpMLineIndex:r[a].sdpMLineIndex};s.push(c)}var l={infos:s};this.sendMessageWithCallback("CandidateInfoReq",e,t,l,i,n)},e.prototype.sendMediaDescAck=function(e,t,r){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MEDIA_DESC_ACK+" call: "+t);var i={result:r};this.sendMessage("MediaDescAck",e,t,i)},e.prototype.sendUpdateMediaDescAck=function(e,t,r,i){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MEDIA_DESC_ACK+" call: "+t);var n={peer_id:i,result:r};this.sendMessage("MediaDescUpdateAck",e,t,n)},e.prototype.sendCandidateInfoAck=function(e,t,r){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_CANDIDATE_INFO_ACK+" call: "+t);var i={result:r};this.sendMessage("CandidateInfoAck",e,t,i)},e.prototype.sendCloseSessionAck=function(e,t,r){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_CLOSE_SESSION_ACK+" call: "+t);var i={result:r};this.sendMessage("CloseSessionAck",e,t,i)},e.prototype.sendResetSessionAck=function(e,t,r){this.logger.debug(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_RESET_SESSION_ACK+" call: "+t);var i={result:r};this.sendMessage("SessionResetAck",e,t,i)},e.prototype.registerPushCallback=function(e,t,r){r&&"function"==typeof r&&(this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_REGISTER_PUSH_CALLBACK+" set callback "+t),this.pushCallback[e+t]={callback:r})},e.prototype.unregisterPushCallback=function(e,t){delete this.pushCallback[e+t]},e.prototype.checkMessageTimeout=function(){for(var e=this,t=this.sendDataList.getFirst(),r=(new Date).getTime(),i=0,s=0,a=0;null!=t&&!(t._data.time+this.sendDataTimeout>r);)if(delete this.sendDataMap[t._data.seq],this.sendDataList.remove(t),++s,-1!=this.checkMessageList.indexOf(t._data.cmd)){if(null==t._data.error||this.sendDataDropTimeout>0&&t._data.time+this.sendDataDropTimeout<r?++a:(this.logger.warn(o.ZEGO_WEBRTC_ACTION.SIGNAL_CHECK_MESSAGE_TIMEOUT+" error cmd = "+t._data.cmd),t._data.error&&t._data.error(n.SEND_MSG_TIMEOUT,t._data.seq)),++i>=this.sendDataCheckOnceCount)break;t=this.sendDataList.getFirst()}else t=this.sendDataList.getFirst();this.sendDataCheckTimer=setTimeout((function(){e.checkMessageTimeout()}),this.sendDataCheckInterval),0==s&&0==a||this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CHECK_MESSAGE_TIMEOUT+" call success, state: timeout="+s+" drop="+a)},e.prototype.sendHeartbeat=function(){var e=this;if(this.logger.debug(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_HEARTBEAT+"call tryHeartbeatCount:"+this.tryHeartbeatCount),0!=Object.keys(this.sessionInfos).length)if(this.state===n.ENUM_CONNECT_STATE.connected){if(++this.tryHeartbeatCount>n.MAX_TRY_HEARTBEAT_COUNT)return this.logger.error(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_HEARTBEAT+" heartbeat try limit"),void this.disconnectCallback();var t=[];for(var r in this.sessionInfos)t.push(parseInt(r));var i={session_ids:t};this.sendMessageWithCallback("ClientHBReq",this.stateCenter.getSeq(),0,i,(function(t,r,i){e.heartbeatInterval!=i.hb_interval&&(e.heartbeatInterval=i.hb_interval,e.onUpdateHeartBeatInterval(i.hb_interval)),e.tryHeartbeatCount=0}),(function(e,t){}))}else this.logger.warn(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_HEARTBEAT+" state error");else this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_HEARTBEAT+" no need to heartbeat")},e.prototype.QualityReport=function(e,t,r,n,s){this.logger.debug(o.ZEGO_WEBRTC_ACTION.SIGNAL_QUALITY_REPORT+" call");var a={streams:[i(i({},r),{aid:t})]};this.sendMessageWithCallback("QualityReportReq",e,t,a,n,s)},e.prototype.sendStreamStatus=function(e,t,r,i,s,a){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_STREAM_STATUS+" call "+t);var c={mic_status:i,camera_status:r};this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_STREAM_STATUS+" stream "+(s||"")+" status "+JSON.stringify(c)),this.sendMessageWithCallback("StreamStatusNotify",e,t,c,(function(){}),(function(e){e===n.SEND_MSG_TIMEOUT&&a&&a()}))},e.prototype.ActivatePlayVideoStream=function(e,t,r,i,n){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_ACTIVE_PLAY_VIDEO_STREAM+" call");var s={active:r?0:1,layer:0};this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_ACTIVE_PLAY_VIDEO_STREAM+" activate video "+JSON.stringify(s)),this.sendMessageWithCallback("ActivateVideoPlayStreamReq",e,t,s,i,n)},e.prototype.ActivatePlayAudioStream=function(e,t,r,i,n){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_ACTIVE_PLAY_AUDIO_STREAM+" call");var s={active:r?0:1,layer:0};this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_ACTIVE_PLAY_AUDIO_STREAM+" activate audio "+JSON.stringify(s)),this.sendMessageWithCallback("ActivateAudioPlayStreamReq",e,t,s,i,n)},e.prototype.sendBroadcasterStatus=function(e,t,r){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_BROADCAST_STATUS+" call "+t);var i={status:r};this.sendMessage("BroadcasterStatusNotify",e,t,i)},e.prototype.sendNetProbe=function(e,t,r,i,n){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_NET_PROBE+" call "+t);var s={peer_id:r,action:1};this.sendMessageWithCallback("NetQualityProbeReq",e,t,s,i,n)},e.prototype.sendNetQualityInfoPushAck=function(e,t,r,i){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_NET_PROBE+" call "+t);var n={peer_id:r,result:i};this.sendMessage("NetQualityInfoAck",e,t,n)},e.prototype.activateSEIInsert=function(e,t,r,i,n,o,s){},e.prototype.getP2PNetStats=function(e,t,r,i,n){var o={peer_id:r};this.sendMessageWithCallback("Peer2PeerNetStatsGetReq",e,t,o,i,n)},e}();t.ZegoSignal=a},3409:function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoStreamCenterWeb=void 0;var s=r(6706),a=r(3770),c=r(1547),l=r(5740),u=r(6706),d=r(5019),h=r(3849),p=r(6014),f=r(8493),g=r(2752),m=r(3529),_=r(2990),v=function(e){function t(t,r,i,n,o,s){var a=e.call(this)||this;return a.logger=t,a.stateCenter=r,a.dataReport=i,a.rtm=n,a.ac=o,a.mediaEleSources=s,a.testEnvironment=!1,a.heartbeatTimer=null,a.heartbeatInterval=1e4,a.qualityTimerInterval=3e3,a.previewStreamList=[],a.signalList={},a.chargeInfos={itemtype:"ChargeInfos",timestamp_begin:0,timestamp_end:0,timestamp_diff_flag:0,timestamp_diff:0,infos:[]},a.chargeInfosTimer=null,a.chargeInfosInterval=6e4,a.chargeInfoSeq=0,a.soundLevelDelegate=!1,a.soundLevelInterval=1e3,a.isPeer=!0,a.probeList={},a.isMicEnabled=!0,a.isDataChannelEnabled=!1,a.publishQualityInfos=[],a.playQualityInfos=[],a.qualityUploadTimestamp=0,a.qualityHeadTimestamp=0,a.gwNode="",a.playerList={},a.publisherList={},a.playSuccessCallBackList={},a.playErrorCallBackList={},a.tryCountConnectInterval=3e3,a.checkMessageTimeout=function(){for(var e in a.signalList)a.signalList[e].signal&&a.signalList[e].signal.checkMessageTimeout()},a.getAllInUseUrl=function(){var e=[];for(var t in a.signalList)e.push(t);return e},a.onDisconnectHandle=function(e,t){if(a.logger.info("zsc.od.0 call"),a.signalList[e]){for(var r=a.signalList[e],i=0;i<r.publishConnectedList.length;i++){var n=a.publisherList[r.publishConnectedList[i]];n&&n.publisher&&n.publisher.onDisconnect(t)}for(i=0;i<r.playConnectedList.length;i++){var o=a.playerList[r.playConnectedList[i]];o&&o.player&&o.player.onDisconnect(t)}delete a.signalList[e],a.stopSignalHeartbeat(),a.stopChargeInfosUpload(),a.stopSoundLevel()}},"PRIVATE"==a.stateCenter.type&&(a.isPeer=!1),a}return n(t,e),Object.defineProperty(t.prototype,"cameraPreviewStream",{get:function(){return this.previewStreamList.find((function(e){return"camera"===e.previewType}))},enumerable:!1,configurable:!0}),t.prototype.onSignalDisconnected=function(e){},t.prototype.setQualityMonitorCycle=function(e){var t=this;return this.logger.debug("zsc.qmc.0 timeInterval "+e),0==Object.keys(this.publisherList).length?this.qualityTimerInterval=e:Object.keys(this.publisherList).forEach((function(r){t.publisherList[r].publisher.qualityTimeInterval=e,t.publisherList[r].publisher.setPublishQualityTimer()})),!0},t.prototype.setSessionInfo=function(e,t,r){this.logger.debug("zsc.ssi.0 called"),this.appid=e,this.userid=t,this.testEnvironment=r},t.prototype.onPlayStateUpdate=function(e,t,r){},t.prototype.onPlayQualityUpdate=function(e,t){},t.prototype.onPublishStateUpdate=function(e,t,r){},t.prototype.onPublishQualityUpdate=function(e,t){},t.prototype.onUpdateHeartBeatIntervalHandle=function(e){e!=this.heartbeatInterval&&(this.logger.debug("zsc.uhb.0 update "+e),this.heartbeatTimer&&(clearTimeout(this.heartbeatTimer),this.heartbeatTimer=null),this.heartbeatInterval=e,this.startSignalHeartbeat())},t.prototype.setPublishStateStart=function(e,t,r,i,n){var o,a,l=this;if(this.logger.info("zsc.pss.0 call "+t),this.stateCenter.networkState==s.ENUM_NETWORK_STATE.offline)return this.logger.error("zsc.pss.0 network offline"),!1;var d=this.publisherList[t],h=this.stateCenter.reportSeqList.startPublish[t];if(this.dataReport.eventStart(h,"setPublishState"),d)return this.logger.error("zsc.pss.0 publisher already exist"),this.dataReport.eventEndWithMsgInfo(h,"setPublishState",{message:"publisher already exist"}),this.dataReport.uploadReport(h,void 0,m.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kIsPublishing),delete this.stateCenter.reportSeqList.startPublish[t],!1;var g=new c.ZegoPublish(t,this.logger,this.dataReport,this.qualityTimerInterval,this,this.ac,this.mediaEleSources,this.stateCenter,r);g.state=u.ENUM_PUBLISH_STATE.start,g.isPeer=this.isPeer,g.reportSeq=this.stateCenter.reportSeqList.startPublish[t];var _=g.previewer,v=null===(o=null==_?void 0:_.videoTrack)||void 0===o?void 0:o.label,E=r.getAudioTracks()[0]&&r.getAudioTracks()[0].label,A=null===(a=null==_?void 0:_.videoTrack)||void 0===a?void 0:a.getSettings().deviceId,y=r.getAudioTracks()[0]&&r.getAudioTracks()[0].getSettings().deviceId,S=new p.RetryStreamHandler(this.logger,this.stateCenter,this,!0);return this.publisherList[t]={seq:0,room:e,localStream:r,publisher:g,serverUrls:[],ttl:0,isCenterNode:!0,streamID:t,publishOption:i,cameraLabel:v||"",microLabel:E||"",cameraDeviceId:A||"",microDeviceId:y||"",deviceStateCount:0,retryStreamHandler:S,retryDispatchHandler:new f.RetryDispatchHandler(this.logger,this.stateCenter,this.rtm,this),isDataChannel:n},g.onPublishStateUpdate=function(e,r,i,n){var o=l.publisherList[r];o?S.publishStateHandle(e,o.streamID,i,n):l.logger.error("zsc.psuh.0 cannot find publish "+t)},g.onPublishQualityUpdate=function(e,r){var i=l.publisherList[e];i?(l.stateCenter.deviceStateOut&&0===r.audio.audioBitrate?(i.deviceStateCount++,i.deviceStateCount>=2&&(i.deviceStateCount=0,l.stateCenter.deviceStateOut=!1,l.logger.warn("zsc.pss.0 publish audio error by device"))):i.deviceStateCount=0,l.onPublishQualityUpdate(i.streamID,r)):l.logger.error("zsc.psuh.0 cannot find publish "+t)},this.dataReport.eventStart(g.reportSeq,"GetSignalUrl"),this.dataReport.eventStart(g.streamReportSeq,"GetSignalUrl"),!0},t.prototype.startPublishingStream=function(e){this.logger.info("zsc.sps.0 call");var t=this.publisherList[e];if(!t)return this.logger.error("zsc.sps.0 publisher don't exist"),!1;var r=t.publisher;if(this.dataReport.eventEndWithMsg(r.reportSeq,"GetSignalUrl",{urls:t.serverUrls,is_center:t.isCenterNode}),this.dataReport.eventEndWithMsg(r.streamReportSeq,"GetSignalUrl",{urls:t.serverUrls,is_center:t.isCenterNode}),!t.serverUrls||0===t.serverUrls.length)return t.retryStreamHandler.publishStateHandle(u.ENUM_PUBLISH_STATE_UPDATE.error,e,g.errorCodeList.DISPATCH_ERROR),this.logger.info("zsc.sps.0 server don't have signal url"),!1;var i=t.serverUrls.indexOf(this.server);-1!==i&&(t.serverUrls.splice(i,1),t.serverUrls.unshift(this.server));var n=t.retryStreamHandler;return n.invalid(),n.init(this.stateCenter.streamRetryTime),n.initStream(e,t.serverUrls),n.activePublish(0)},t.prototype.updateWaitingList=function(e,t,r,i,n){t?e.publishWaitingList.push({streamID:r,success:i,error:n}):e.playWaitingList.push({streamID:r,success:i,error:n})},t.prototype.publishStream=function(e){var t=this.publisherList[e].publisher;if(t){var r=null,i=null,n=this.publisherList[e].publishOption,o=this.checkPreview(this.publisherList[e].localStream);if(o){r=o.localStream,i=o.videoInfo;var s=this.stateCenter.reportSeqList.startPublish[e];this.dataReport.addMsgInfo(s,{cap_w:m.ZegoRTCLogEvent.kZegoTaskPublishStart.cap_w(o.videoInfo.width),cap_h:m.ZegoRTCLogEvent.kZegoTaskPublishStart.cap_h(o.videoInfo.height),w:m.ZegoRTCLogEvent.kZegoTaskPublishStart.w(o.videoInfo.width),h:m.ZegoRTCLogEvent.kZegoTaskPublishStart.h(o.videoInfo.height),video_en_fps:m.ZegoRTCLogEvent.kZegoTaskPublishStart.video_en_fps(o.videoInfo.frameRate),video_en_bps:m.ZegoRTCLogEvent.kZegoTaskPublishStart.video_en_bps(o.videoInfo.bitRate)}),r?(this.logger.info("zsc.ps.0 call success"),t.gwNodeTTL<(new Date).getTime()&&!this.gwNode?(t.gwNode="",t.gwNodeList=[],t.gwNodeTTL=0):this.gwNode&&(t.gwNode=this.gwNode),t.startPublish(e,r,i,o.mediaStreamConfig,n)):this.logger.error("zsc.ps.0 no localStream found")}else this.logger.error("zsc.ps.0 no preview found")}else this.logger.info("zsc.ps.0 publisher don't exist")},t.prototype.connectPublishServer=function(e,t){var r=this,i=this.publisherList[e];return i?(this.dataReport.eventStart(i.publisher.reportSeq,"ConnectServer"),this.dataReport.eventStart(i.publisher.streamReportSeq,"ConnectServer"),this.connectWithReuseSignalServer(e,!0,t,(function(e,t,i){var n=r.publisherList[e];if(n){var o=n.publisher;if(o){r.dataReport.eventEndWithMsg(o.reportSeq,"ConnectServer",{result:0,server:i}),r.dataReport.eventEndWithMsg(o.streamReportSeq,"ConnectServer",{result:0,server:i});var s=t.tokenInfo;r.logger.info("zsc.cps.0 update token success"),s&&s.report&&(o.qualityUpload=s.report,o.qualityUploadInterval=s.report_interval),o.signal=t.signal,r.server=i,r.publishStream(e),r.getTokenSuccess()}else r.logger.info("zsc.cps.1 check publisher don't exist")}else r.logger.info("zsc.cps.0 after connect publisher don't exist")}),(function(e,t){r.logger.error("zsc.cps.0 "+e+" connect fail "+t);var i=r.publisherList[e];if(i){var n=i.publisher;if(n){r.dataReport.eventEndWithMsg(n.reportSeq,"ConnectServer",{result:t}),r.dataReport.uploadReport(n.reportSeq),delete r.stateCenter.reportSeqList.startPublish[e];var s=o({},g.errorCodeList.CONNECT_FAILED);s.message=s.message+" "+t,1008===t&&(s=g.errorCodeList.TOKEN_EXPIRED),i.retryStreamHandler.publishStateHandle(u.ENUM_PUBLISH_STATE_UPDATE.error,e,s,1008==t)}else r.logger.info("zsc.cps.1 check publisher don't exist")}else r.logger.info("zsc.cps.0 after connect publisher don't exist")})),!0):(this.logger.error("zsc.cps.0 publisher don't exist"),!1)},t.prototype.getTokenSuccess=function(){this.logger.debug("zsc.gts.0 call")},t.prototype.stopPublishingStream=function(e){var t=this.publisherList[e];if(t){var r=t.retryStreamHandler;for(var i in r&&(r.stopMaxTime(),r.invalid()),this.signalList)this.signalList[i].publishWaitingList=this.signalList[i].publishWaitingList.filter((function(t){return t.streamID!==e}));delete this.publisherList[e],t.publisher&&(t.publisher.stopPublish(),delete t.publisher),this.removeStreamFromSignal(!0,e),this.stopSignalHeartbeat(),this.stopChargeInfosUpload(),this.stopSoundLevel(),this.logger.debug("zsc.sps.0.1 call success")}else this.logger.warn("zsc.sps.0.1 publisher don't exist")},t.prototype.connectWithReuseSignalServer=function(e,t,r,i,n){var o=this;this.logger.info("zsc.crss.0 begin "+r);var s=null;if(this.signalList[r])(s=this.signalList[r]).state==u.ENUM_SIGNAL_STATE.connected?(this.logger.info("zsc.crss.0 already connected "+r+" streamId: "+e),t?s.publishConnectedList.push(e):s.playConnectedList.push(e),i(e,s,r)):s.state==u.ENUM_SIGNAL_STATE.connecting&&(this.logger.info("zsc.crss.0 signal is connecting "+r+" streamId: "+e),this.updateWaitingList(s,t,e,i,n));else{this.logger.info("zsc.crss.0 new signal "+r+" streamId: "+e);var a=new d.ZegoSignal(this.logger,this.stateCenter);a.setSessionInfo(this.appid,this.userid),a.onUpdateHeartBeatInterval=this.onUpdateHeartBeatIntervalHandle.bind(this),a.onDisconnect=this.onDisconnectHandle;var c=this.publisherList[e]?this.publisherList[e]:this.playerList[e]?this.playerList[e]:null,l=null==c?void 0:c.retryStreamHandler;if(this.stateCenter.streamConnectTime)a.tryConnectInterval=this.stateCenter.streamConnectTime;else if(l&&l.retryActiveCount){var h=l.retryActiveCount*(l.retryActiveCount-1)/2+2;h=h>u.MAX_RETRY_CONNECT_INTERVAL?u.MAX_RETRY_CONNECT_INTERVAL:h,a.tryConnectInterval=1e3*h}this.signalList[r]={signal:a,state:u.ENUM_SIGNAL_STATE.connecting,publishWaitingList:[],playWaitingList:[],publishConnectedList:[],playConnectedList:[],tokenInfo:null},this.updateWaitingList(this.signalList[r],t,e,i,n);var p=null==c?void 0:c.room.token,f=null==c?void 0:c.room.roomID;this.logger.info("zsc.crss.0 "+p),a.connectServer(f||this.stateCenter.roomList[0].roomID,p||this.stateCenter.roomList[0].token,r,(function(e,t,i){s=o.signalList[r];var n,a,c=0;if(0!=e){for(o.logger.info("zsc.crss.0 connect failed "+t),c=0;c<s.publishWaitingList.length;c++)(n=s.publishWaitingList[c]).error&&n.error(n.streamID,e);for(c=0;c<s.playWaitingList.length;c++)(a=s.playWaitingList[c]).error&&a.error(a.streamID,e);delete o.signalList[r]}else{for(o.logger.debug("zsc.crss.0 connected success "+t),s.state=u.ENUM_SIGNAL_STATE.connected,s.tokenInfo=i,c=0;c<s.publishWaitingList.length;c++)(n=s.publishWaitingList[c]).success&&n.success(n.streamID,s,t),s.publishConnectedList.push(n.streamID);for(c=0;c<s.playWaitingList.length;c++)(a=s.playWaitingList[c]).success&&a.success(a.streamID,s,t),s.playConnectedList.push(a.streamID);s.publishWaitingList=[],s.playWaitingList=[],null==o.heartbeatTimer&&o.startSignalHeartbeat(),null==o.chargeInfosTimer&&o.startChargeInfosUpload(),o.activeSoundLevel()}}))}},t.prototype.setPlayStateStart=function(e,t,r){var i=this;if(this.logger.info("zsc.pss.1 call "+e),this.stateCenter.networkState==s.ENUM_NETWORK_STATE.offline)return this.logger.error("zsc.pss.1 network offline"),!1;var n=this.playerList[e],o=this.stateCenter.reportSeqList.startPlay[e];if(this.dataReport.eventStart(o,"setPlayState"),n)return this.logger.error("zsc.pss.1 player already exist"),this.dataReport.eventEndWithMsgInfo(o,"setPlayState",{message:"player already exist"}),this.dataReport.uploadReport(o,void 0,m.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kIsPlaying),delete this.stateCenter.reportSeqList.startPlay[e],!1;var a=this.getPlayRoom(e)||this.stateCenter.roomList[0];if(!a)return this.logger.error("zsc.pss.1 not login room"),this.dataReport.eventEndWithMsgInfo(o,"setPlayState",{message:"not login room"}),this.dataReport.uploadReport(o,void 0,m.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayNoLoginError),!1;var c=new h.ZegoPlayWeb(this.logger,null,this.dataReport,this.qualityTimerInterval,this,this.ac,this.stateCenter);t&&[0,2,3].includes(t.resourceMode)&&(c.resourceMode=t.resourceMode),this.dataReport.addMsgInfo(o,{resourceMode:c.resourceMode,play_room_id:a.roomID,isMulti:this.stateCenter.isMultiRoom}),c.state=u.ENUM_PLAY_STATE.start,c.isPeer=this.isPeer,c.reportSeq=this.stateCenter.reportSeqList.startPlay[e],c.beginTime=(new Date).getTime();var l=new p.RetryStreamHandler(this.logger,this.stateCenter,this,!1);return this.playerList[e]={seq:0,room:a,player:c,signal:null,serverUrls:[],ttl:0,isCenterNode:!0,streamID:e,playOption:t,retryStreamHandler:l,retryDispatchHandler:new f.RetryDispatchHandler(this.logger,this.stateCenter,this.rtm,this),isDataChannel:r},c.onPlayStateUpdate=function(e,t,r,n){var o=i.playerList[t];o?l.playStateHandle(e,o.streamID,r,n):i.logger.error("zsc.pss.1 cannot find play "+t)},c.onPlayQualityUpdate=function(e,t){var r=i.playerList[e];r?i.onPlayQualityUpdate(r.streamID,t):i.logger.error("zsc.pss.1 cannot find play "+e)},c.onRemoteCameraStatusUpdate=function(e,t,r){var n=i.playerList[e];n?i.onRemoteCameraStatusUpdate(n.streamID,t,r):i.logger.error("zsc.pss.1 cannot find play "+e)},c.onRemoteMicStatusUpdate=function(e,t,r){var n=i.playerList[e];n?i.onRemoteMicStatusUpdate(n.streamID,t,r):i.logger.error("zsc.pss.1 cannot find play "+e)},this.dataReport.eventStart(c.reportSeq,"GetSignalUrl"),this.dataReport.eventStart(c.streamReportSeq,"GetSignalUrl"),!0},t.prototype.onRemoteMicStatusUpdate=function(e,t,r){},t.prototype.onRemoteCameraStatusUpdate=function(e,t,r){},t.prototype.startPlayingStream=function(e,t){this.logger.info("zsc.sps.1 start play called");var r=this.playerList[e];if(!r)return this.logger.error("zsc.sps.1 player don't exist"),!1;var i=r.player;if(this.dataReport.eventEndWithMsg(i.reportSeq,"GetSignalUrl",{urls:r.serverUrls}),this.dataReport.eventEndWithMsg(i.streamReportSeq,"GetSignalUrl",{urls:r.serverUrls}),0==r.serverUrls.length)return r.retryStreamHandler.playStateHandle(u.ENUM_PLAY_STATE_UPDATE.error,e,g.errorCodeList.DISPATCH_ERROR),this.logger.info("zsc.sps.1 server don't have signal url"),!1;var n=r.serverUrls.indexOf(this.server);-1!==n&&(r.serverUrls.splice(n,1),r.serverUrls.unshift(this.server));var o=r.retryStreamHandler;return o.invalid(),o.init(this.stateCenter.streamRetryTime),o.initStream(e,r.serverUrls),o.activePull(0,t)},t.prototype.connectPlayServer=function(e,t,r){var i=this,n=this.playerList[e];return n?(this.dataReport.eventStart(n.player.reportSeq,"ConnectServer"),this.dataReport.eventStart(n.player.streamReportSeq,"ConnectServer"),this.connectWithReuseSignalServer(e,!1,r,(function(e,r,n){var o=i.playerList[e];if(o){var s=o.player;if(s){i.dataReport.eventEndWithMsg(s.reportSeq,"ConnectServer",{result:0,server:n}),i.dataReport.eventEndWithMsg(s.streamReportSeq,"ConnectServer",{result:0,server:n});var a=r.tokenInfo;i.logger.info("zsc.cps.1 update token success"),a&&a.report&&(s.qualityHandler.qualityUpload=a.report,s.qualityHandler.qualityUploadInterval=a.report_interval),s.signal=r.signal,i.server=n,i.playStream(e,t),i.getTokenSuccess()}else i.logger.error("zsc.cps.1 checkplayer don't exist")}else i.logger.error("zsc.cps.1 after connect player don't exist")}),(function(t,r){var n=i.playerList[t];if(n){i.dataReport.eventEndWithMsg(n.player.reportSeq,"ConnectServer",{result:r}),!n.player.isProbe&&i.dataReport.uploadReport(n.player.reportSeq),delete i.stateCenter.reportSeqList.startPlay[e];var s=o({},g.errorCodeList.CONNECT_FAILED);s.message=s.message+" "+r,1008===r&&(s=g.errorCodeList.TOKEN_EXPIRED),n.retryStreamHandler.playStateHandle(u.ENUM_PLAY_STATE_UPDATE.error,t,s,1008==r)}else i.logger.error("zsc.cps.1 after connect player don't exist")})),!0):(this.logger.error("zsc.cps.1 player don't exist"),!1)},t.prototype.playStream=function(e,t){var r=this.playerList[e].player;r?(this.logger.info("zsc.ps.1 call success"),r.gwNodeTTL<(new Date).getTime()&&!this.gwNode?(r.gwNode="",r.gwNodeList=[],r.gwNodeTTL=0):this.gwNode&&(r.gwNode=this.gwNode),r.startPlay(e,t,this.playerList[e].playOption)):this.logger.warn("zsc.ps.1 player don't exist")},t.prototype.stopSignalHeartbeat=function(){this.logger.debug("zsc.ssh.1 call");var e=0;for(var t in this.signalList)e+=1;this.heartbeatTimer&&0==e&&(this.logger.info("zsc.ssh.1 stop"),clearTimeout(this.heartbeatTimer),this.heartbeatTimer=null)},t.prototype.removeStreamFromSignal=function(e,t){var r=[];for(var i in this.signalList){var n=this.signalList[i];if(e){for(var o=0;o<n.publishConnectedList.length;o++)if(n.publishConnectedList[o]===t){this.logger.debug("zsc.rsfs.0 found from publish"),n.publishConnectedList.splice(o,1);break}for(o=0;o<n.publishWaitingList.length;o++)if(n.publishWaitingList[o].streamID===t){this.logger.debug("zsc.rsfs.0 found from publish"),n.publishWaitingList.splice(o,1);break}}else{for(var s=0;s<n.playConnectedList.length;s++)if(n.playConnectedList[s]===t){this.logger.debug("zsc.rsfs.0 found from play"),n.playConnectedList.splice(s,1);break}for(s=0;s<n.playWaitingList.length;s++)if(n.playWaitingList[s].streamID===t){this.logger.debug("zsc.rsfs.0 found from play"),n.playWaitingList.splice(s,1);break}}0==n.publishConnectedList.length&&0==n.playConnectedList.length&&0==n.publishWaitingList.length&&0==n.playWaitingList.length&&(n.signal.disconnectServer(),r.push(i))}for(var a=0;a<r.length;a++)delete this.signalList[r[a]],this.server==r[a]&&(this.server="")},t.prototype.stopPlayingStream=function(e){var t=this.playerList[e];if(t){var r=t.retryStreamHandler;for(var i in r&&(r.stopMaxTime(),r.invalid()),this.signalList)this.signalList[i].playWaitingList=this.signalList[i].playWaitingList.filter((function(t){return t.streamID!==e}));delete this.playerList[e],t.player&&(t.player.stopPlay(),delete t.player),this.removeStreamFromSignal(!1,e),this.stopSignalHeartbeat(),this.stopChargeInfosUpload(),this.stopSoundLevel(),delete this.playSuccessCallBackList[e],delete this.playErrorCallBackList[e],this.logger.debug("zsc.sps.1.1 call success")}else this.logger.info("zsc.sps.1.1 player don't exist")},t.prototype.reset=function(e){for(var t in this.publisherList)(this.publisherList[t].room.roomID==e||!e)&&this.stopPublishingStream(t);var r=function(t){var r=i.playerList[t].room;if(r.roomID!=e||!r.streamList.find((function(e){return e.stream_id==t}))&&1!=i.stateCenter.roomList.length){if(r.roomID==e&&i.stateCenter.roomList.length>1){var n=i.stateCenter.roomList.find((function(t){return t.roomID!==e}));n?i.playerList[t].room=n:i.stopPlayingStream(t)}}else i.stopPlayingStream(t)},i=this;for(var n in this.playerList)r(n);0==Object.keys(this.publisherList).length&&0==Object.keys(this.playerList).length&&(this.probeList={}),this.publishQualityInfos=[],this.playQualityInfos=[],this.qualityHeadTimestamp=0,this.qualityUploadTimestamp=0,this.qualityWebsocket&&(this.qualityWebsocket.close(),this.qualityWebsocket=void 0)},t.prototype.startSignalHeartbeat=function(){var e=this;this.logger.debug("zsc.ssh.0 call"),this.heartbeatTimer&&(clearTimeout(this.heartbeatTimer),this.heartbeatTimer=null),this.heartbeatTimer=setTimeout((function(){e.checkSignalHeartbeat()}),this.heartbeatInterval)},t.prototype.startChargeInfosUpload=function(){var e=this;this.logger.debug("zsc.sciu.0 call"),this.chargeInfosTimer&&(clearTimeout(this.chargeInfosTimer),this.chargeInfosTimer=null),this.chargeInfosTimer=setTimeout((function(){e.checkChargeInfos()}),this.chargeInfosInterval)},t.prototype.checkChargeInfos=function(){this.logger.debug("zsc.cci.0 call");var e={is_publishing:0,play_max_audio_bitrate:0,play_stream_resolution_infos:[]};for(var t in this.chargeInfos.timestamp_begin=(new Date).getTime(),this.publisherList){this.publisherList[t].publisher.state===u.ENUM_PUBLISH_STATE.publishing&&(e.is_publishing=1);break}e.play_max_audio_bitrate=0;var r=function(t){var r=i.playerList[t].player.playStream,n=r&&0!==r.getVideoTracks().length?r.getVideoTracks()[0].getSettings():void 0,o={video_width:n&&n.width?n.width:0,video_height:n&&n.height?n.height:0,count:1};if(!e.play_stream_resolution_infos.find((function(e){return e.video_width==o.video_width&&e.video_height==o.video_height&&(e.count++,!0)}))&&e.play_stream_resolution_infos.push(o),0==o.video_width&&0==o.video_height){var s=1e3*i.playerList[t].player.qualityHandler.lastPlayStats.audioBitrate;s>e.play_max_audio_bitrate&&(e.play_max_audio_bitrate=s)}},i=this;for(var n in this.playerList)r(n);0!==this.chargeInfos.timestamp_end?(this.chargeInfos.timestamp_diff=this.chargeInfos.timestamp_begin-this.chargeInfos.timestamp_end,this.chargeInfos.timestamp_diff_flag=1):(this.chargeInfos.timestamp_diff=0,this.chargeInfos.timestamp_diff_flag=0),this.chargeInfos.timestamp_end=(new Date).getTime(),this.chargeInfos.infos=[e],0!==e.play_stream_resolution_infos.length&&this.logger.report(this.chargeInfos),this.chargeInfosTimer&&this.startChargeInfosUpload()},t.prototype.checkSignalHeartbeat=function(){for(var e in this.logger.debug("zsc.csh.0 call"),this.signalList)this.signalList[e].signal&&this.signalList[e].signal.sendHeartbeat();this.heartbeatTimer&&this.startSignalHeartbeat()},t.prototype.stopChargeInfosUpload=function(){this.logger.debug("zsc.sciu.0 call");var e=0;for(var t in this.signalList)e+=1;this.chargeInfosTimer&&0==e&&(this.logger.info("zsc.sciu.0 stop"),clearTimeout(this.chargeInfosTimer),this.chargeInfosTimer=null)},t.prototype.getPublisher=function(e){var t=null;return this.publisherList[e]&&this.publisherList[e].publisher&&(t=this.publisherList[e].publisher),t},t.prototype.checkPreview=function(e){for(var t=0;t<this.previewStreamList.length;t++)if(this.previewStreamList[t].localStream===e)return this.previewStreamList[t];return null},t.prototype.checkPublish=function(e){for(var t in this.publisherList)if(this.publisherList[t].localStream==e)return this.publisherList[t];return null},t.prototype.removePreview=function(e){for(var t=0;t<this.previewStreamList.length;t++)if(this.previewStreamList[t]===e){this.previewStreamList.splice(t,1);break}},t.prototype.onPlayerStreamUrlUpdate=function(e,t,r){},t.prototype.getScreenConstrains=function(e){var t={};if("boolean"==typeof e&&e)t={audio:!1,frameRate:u.ENUM_SCREEM_RESOLUTION_TYPE.MEDIUM.frameRate,bitRate:this.stateCenter.settingConfig.getSetting("screen_video_bitrate")||u.ENUM_SCREEM_RESOLUTION_TYPE.MEDIUM.bitRate};else if("object"==typeof e){switch(e.videoQuality){case 1:t={frameRate:u.ENUM_SCREEM_RESOLUTION_TYPE.LOW.frameRate,bitRate:u.ENUM_SCREEM_RESOLUTION_TYPE.LOW.bitRate};break;case 3:t={frameRate:u.ENUM_SCREEM_RESOLUTION_TYPE.HIGH.frameRate,bitRate:u.ENUM_SCREEM_RESOLUTION_TYPE.HIGH.bitRate};break;case 4:t={frameRate:e.frameRate,bitRate:e.bitRate,width:e.width,height:e.height};break;case 2:t={frameRate:u.ENUM_SCREEM_RESOLUTION_TYPE.MEDIUM.frameRate,bitRate:u.ENUM_SCREEM_RESOLUTION_TYPE.MEDIUM.bitRate};break;default:t={frameRate:u.ENUM_SCREEM_RESOLUTION_TYPE.MEDIUM.frameRate,bitRate:this.stateCenter.settingConfig.getSetting("screen_video_bitrate")||u.ENUM_SCREEM_RESOLUTION_TYPE.MEDIUM.bitRate}}t.audio="boolean"==typeof e.audio&&e.audio,t=o(o({},e),t)}return t},t.prototype.createScreenPreviewer=function(e,t){var r=new a.ZegoPreview(this.logger,this.ac,this.stateCenter,this,"screen"),i=e.getVideoTracks()[0].getSettings();return this.previewStreamList.push(r),r.mediaStreamConfig=t,e.getAudioTracks().length>0&&(r.audioTrack=e.getAudioTracks()[0]),r.localStream=e,r.videoInfo={width:i.width,height:i.height,frameRate:i.frameRate||15,bitRate:(null==t?void 0:t.bitRate)||1e3,startBitrate:(null==t?void 0:t.startBitrate)||this.stateCenter.settingConfig.getSetting("bitrate_mode")},r.previewSuc=!0,r.previewType="screen",(null==t?void 0:t.videoOptimizationMode)&&this.setVideoTrackContentHint(e,null==t?void 0:t.videoOptimizationMode),r},t.prototype.setSoundLevelDelegate=function(e,t){for(var r in this.logger.info("zsc.ssd.0 call"),t&&(this.soundLevelInterval=t),this.soundLevelDelegate=e,this.previewStreamList){var i=this.previewStreamList[r];e?i.startSoundLevel():i.stopSoundLevel()}for(var r in this.playerList){var n=this.playerList[r].player;e?n.startSoundLevel():n.stopSoundLevel()}e?(this.logger.info("zsc.ssd.0 start getting sound"),this.activeSoundLevel()):(this.logger.info("zsc.ssd.0 stop getting sound"),this.soundLevelTimer&&clearTimeout(this.soundLevelTimer),this.soundLevelTimer=null,this.soundLevelInterval=1e3)},Object.defineProperty(t.prototype,"hasRemoteStream",{get:function(){return Object.keys(this.signalList).length>0},enumerable:!1,configurable:!0}),t.prototype.activeSoundLevel=function(){!this.soundLevelTimer&&this.soundLevelDelegate&&this.startSoundLevel()},t.prototype.startSoundLevel=function(){var e=this;this.soundLevelTimer&&(clearTimeout(this.soundLevelTimer),this.soundLevelTimer=null),this.soundLevelDelegate&&(this.hasRemoteStream&&this.checkSoundLevel(),this.checkMicSoundLevel(),this.soundLevelTimer=setTimeout((function(){e.startSoundLevel()}),this.soundLevelInterval))},t.prototype.checkSoundLevel=function(){this.logger.debug("zsc.csl.0 call");var e=[];for(var t in this.publisherList){var r=0,i=this.publisherList[t].publisher,n=i.previewer;n&&(r=n.soundLevel),e.push({streamID:this.getBackStreamId(i.streamId),soundLevel:r,type:"push"})}for(var t in this.playerList){var o=this.playerList[t].player;o.streamId&&!o.isProbe&&e.push({streamID:this.getBackStreamId(o.streamId),soundLevel:o.soundLevel,type:"pull"})}this.soundLevelDelegate&&e.length>0&&this.onSoundLevelUpdate(e)},t.prototype.checkMicSoundLevel=function(){if(this.cameraPreviewStream&&this.soundLevelDelegate){var e=this.cameraPreviewStream.soundLevel;this.onMicSoundLevelUpdate(e)}},t.prototype.getBackStreamId=function(e){return this.testEnvironment&&e?e.replace("zegotest-"+this.appid+"-",""):e},t.prototype.onSoundLevelUpdate=function(e){},t.prototype.onMicSoundLevelUpdate=function(e){},t.prototype.stopSoundLevel=function(){var e=this.previewStreamList.length;this.soundLevelTimer&&!this.hasRemoteStream&&0===e&&(this.logger.info("zsc.ssl.0 stop"),clearTimeout(this.soundLevelTimer),this.soundLevelTimer=null)},t.prototype.startNetProbe=function(e,t,r){var i=this,n=s.getReportSeq();if(this.dataReport.newReport(n,m.ZegoRTCLogEvent.kZegoNetProbe.event),this.isPeer){var o=!0;0==r.length&&(o=!1,r=e?this.publisherList[t.streamId].serverUrls:this.playerList[t.streamId].serverUrls),r.forEach((function(r){if(!(i.probeList[r]&&i.probeList[r].timeStamp+9e5<(new Date).getTime()||t.probeState==u.ENUM_PROBE_STATE.probed)){var n="zegoprobe-"+(new Date).getTime();i.setPlayStateStart(n);var s=i.playerList[n]?i.playerList[n].player:null;s&&(s.isProbe=!0,o?(s.gwNode=r,s.signal=t.signal,s.startPlay(n,(function(){}))):i.connectPlayServer(n,(function(){}),r),s.onCalNetQualityResult=function(o,a){i.logger.info("zc.ocnqr.0 "+s.gwNode+" "+o+" "+a),i.probeList[r]={result:o,netQuality:a,timeStamp:(new Date).getTime()},t.gwNode==r||t.signal.server==r?t.netQuality=a:i.handleCalNetQualityResult(e,o,a,t,r),i.stopPlayingStream(n)})}})),this.dataReport.addMsgInfo(n,{netQuality:t.netQuality,nodeList:r}),this.dataReport.uploadReport(n)}else this.dataReport.uploadReport(n,void 0,{code:-1,message:"not support peer"})},t.prototype.handleCalNetQualityResult=function(e,t,r,i,n){if(this.logger.info("zc.hcqr.0 "+i.netQuality+" probe "+r+" "+n),0===t){var o=s.getReportSeq();this.dataReport.newReport(o,m.ZegoRTCLogEvent.kZegoNetProbeResult.event);var a=!1;if(r>Math.max(75,i.netQuality+20)&&i.probeState==u.ENUM_PROBE_STATE.tryProbe)if(a=!0,e){var c=i,l=c.streamId,d=c.localStream,h=c.videoInfo,p=c.mediaStreamConfig,f=c.publishOption;0!=c.sessionId&&c.signal&&c.shouldSendCloseSession()&&(c.signal.sendCloseSession(this.stateCenter.getSeq(),c.sessionId,1),c.signal.removeSession(c.sessionId),c.closeSessionSignal=!0),c.resetPublish(),this.publisherList[l].isCenterNode?(c.gwNode=n,c.startPublish(l,d,h,p,f)):this.connectPublishServer(l,n)}else{var g=i,_=(l=g.streamId,g.getRemoteStreamSuc),v=g.playOption;0!=g.sessionId&&g.signal&&g.shouldSendCloseSession()&&(g.signal.sendCloseSession(this.stateCenter.getSeq(),g.sessionId,1),g.signal.removeSession(g.sessionId),g.closeSessionSignal=!0),g.resetPlay(),this.playerList[l].isCenterNode?(g.gwNode=n,g.startPlay(l,_,v)):this.connectPlayServer(l,_,n)}else a=!1,this.logger.warn("zc.hcqr.0 "+i.netQuality+" probe "+r+" "+n);this.dataReport.addMsgInfo(o,{isSwitch:a,isPublish:e,streamID:i.streamId,result:t,node:n,netQuality:i.netQuality,probeNetQuality:r}),this.dataReport.uploadReport(o),i.probeState=u.ENUM_PROBE_STATE.probed}},t.prototype.getRoomByStreamID=function(e){return this.publisherList[e]?this.publisherList[e].room:this.playerList[e]?this.playerList[e].room:void 0},t.prototype.setVideoTrackContentHint=function(e,t){if("string"==typeof t){var r=t.toLowerCase();if(["default","motion","detail","text"].includes(r)){var i=e.getVideoTracks()[0];i?"contentHint"in i?(this.logger.info("zc.svtch "+r),i.contentHint="default"==r?"":r):this.logger.warn("zc.svtch mediaStreamTrack contentHint attribute not supported"):this.logger.warn("zc.svtch video track no found")}else this.logger.warn("zc.svtch videoOptimizationMode wrong")}else this.logger.warn("zc.svtch videoOptimizationMode type wrong")},t.prototype.getPlayRoom=function(e){return this.stateCenter.roomList.find((function(t){return!!t.streamList.find((function(t){return t.stream_id==e}))}))},t.prototype.getQualityHead=function(e,t){var r=new Uint8Array(12);r[0]=0,r[1]=12,r[2]=e.length>>8,r[3]=e.length-(r[2]<<8),r[4]=t.length>>24,r[5]=t.length-(r[4]<<24)>>16,r[6]=t.length-(r[4]<<24)-(r[5]<<16)>>8,r[7]=t.length-(r[4]<<24)-(r[5]<<16)-(r[6]<<8);var i=Math.ceil((new Date).getTime()/1e3);return r[8]=i>>24,r[9]=i-(r[8]<<24)>>16,r[10]=i-(r[8]<<24)-(r[9]<<16)>>8,r[11]=i-(r[8]<<24)-(r[9]<<16)-(r[10]<<8),r},t.prototype.streamQualityUpload=function(){var e=this;if(Object.keys(this.publisherList).length>0||Object.keys(this.playerList).length>0){var t={version:0,timestamp:(new Date).getTime(),event:0,app_id:this.stateCenter.appid,user_id:this.stateCenter.idName,biz_type:1},r={publish_quality_infos:this.publishQualityInfos,play_quality_infos:this.playQualityInfos},i=_.logreport.SpeedLogHead.create(t),n=_.logreport.QualityEvent.create(r),o=_.logreport.SpeedLogHead.encode(i).finish(),s=_.logreport.QualityEvent.encode(n).finish(),a=this.getQualityHead(o,s),c=new Uint8Array(12+o.length+s.length);c.set(a),c.set(o,12),c.set(s,12+o.length);var l=this.logger.url.split("/")[2];if(!l)return;if(this.qualityWebsocket&&2!=this.qualityWebsocket.readyState&&3!=this.qualityWebsocket.readyState)1==this.qualityWebsocket.readyState&&this.qualityWebsocket.send(c);else{var u=this.stateCenter.appid,d=this.stateCenter.idName,h=this.stateCenter.roomList[0].token;this.qualityWebsocket=new WebSocket("wss://"+l+"/ws/report/stream?appid="+u+"&product=rtc&token="+encodeURIComponent(h)+"&id_name="+d),this.qualityWebsocket.onopen=function(){var t;null===(t=e.qualityWebsocket)||void 0===t||t.send(c)}}}},t.prototype.updateQuality=function(e,t){var r=this,i=(new Date).getTime();0!==this.qualityUploadTimestamp&&i-this.qualityUploadTimestamp>6e4||this.publishQualityInfos.join("").length+this.playQualityInfos.join().length>8e3?(this.publishQualityInfos.forEach((function(e){return e.timestamp_offset_end=Math.round(i/1e3)-r.qualityHeadTimestamp})),this.playQualityInfos.forEach((function(e){return e.timestamp_offset_end=Math.round(i/1e3)-r.qualityHeadTimestamp})),this.streamQualityUpload(),this.publishQualityInfos=[],this.playQualityInfos=[],this.qualityHeadTimestamp=Math.round((new Date).getTime()/1e3),this.qualityUploadTimestamp=i):0==this.qualityHeadTimestamp&&(this.qualityHeadTimestamp=Math.round((new Date).getTime()/1e3),this.qualityUploadTimestamp=i),0==e?this.handlePublishQualityData(t):this.handlePlayQualityData(t)},t.prototype.handlePublishQualityData=function(e){var t=this.publishQualityInfos.find((function(t){return t.stream_id==e.stream_id&&t.video_width==e.frameWidth&&t.video_height==e.frameHeight}));if(!t){var r=this.getRoomByStreamID(e.stream_id);t={timestamp_offset_begin:Math.abs(Number(e.timeStamp-this.qualityHeadTimestamp)),timestamp_offset_end:0,stream_id:e.stream_id,session_id:r?Number(r.sessionID):0,video_width:e.frameWidth,video_height:e.frameHeight,infos:[],room_id:r?r.roomID:"",evnvironment:1,room_session_id:r?Number(r.roomSessionID):0},this.publishQualityInfos.push(t)}t.infos.push({audio_bitrate:Math.round(e.audioBitrate)||0,video_bitrate:Math.round(e.videoBitrate)||0,video_capture_fps:Math.round(10*e.videoFPS)||0,video_network_fps:Math.round(10*e.videoTransferFPS)||0,uplink_plr:e.audioPacketsLostRate,rtt:Math.round(e.currentRoundTripTime),audio_network_fps:Math.round(10*e.audioFPS),captured_sound_level:Math.round(e.audioLevel),sample_time_window:Math.round(e.timeStamp/10)})},t.prototype.handlePlayQualityData=function(e){var t=this.playQualityInfos.find((function(t){return t.stream_id==e.stream_id&&t.video_width==e.frameWidth&&t.video_height==e.frameHeight}));if(!t){var r=this.getRoomByStreamID(e.stream_id);t={timestamp_offset_begin:Math.abs(Number(e.timeStamp-this.qualityHeadTimestamp)),timestamp_offset_end:0,stream_id:e.stream_id,session_id:r?Number(r.sessionID):0,video_width:e.frameWidth,video_height:e.frameHeight,infos:[],room_id:r?r.roomID:"",room_session_id:r?Number(r.roomSessionID):0},this.playQualityInfos.push(t)}t.infos.push({audio_bitrate:Math.round(e.audioBitrate)||0,video_bitrate:Math.round(e.videoBitrate)||0,video_network_fps:Math.round(10*e.videoFPS)||0,downlink_plr:Math.round(e.audioPacketsLostRate)||0,audio_network_fps:Math.round(10*e.audioFPS)||0,audio_break_duration:Math.round(e.audio_break_duration/10),video_break_duration:Math.round(e.video_break_duration/10),rtt:e.currentRoundTripTime,rendered_sound_level:Math.round(e.audioLevel),audio_break_cancel_duration:Math.round(e.audio_break_cancel_duration/10),video_break_cancel_duration:Math.round(e.video_break_cancel_duration/10),audio_decode_time:Math.round(e.audio_decode_time/10),video_decode_time:Math.round(e.video_decode_time/10),real_sampling_interval:Math.round(e.real_sampling_interval/10),video_frames_decoded:Math.round(e.videoFramesDecoded)||0,video_frames_dropped:Math.round(e.videoFramesDropped)||0,sample_time_window:Math.round(e.timeStamp/10)})},t}(l.ZegoStreamCenter);t.ZegoStreamCenterWeb=v},2990:function(e,t,r){"use strict";var i,n=r(2100),o=n.Reader,s=n.Writer,a=n.util,c=n.roots.default||(n.roots.default={});c.logreport=((i={}).SpeedLogHead=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t,r;return e.prototype.version=0,e.prototype.signature=a.newBuffer([]),e.prototype.timestamp=0,e.prototype.event=0,e.prototype.app_id=0,e.prototype.user_id="",e.prototype.biz_type=0,e.prototype.device_id="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(8).uint32(e.version),null!=e.signature&&Object.hasOwnProperty.call(e,"signature")&&t.uint32(18).bytes(e.signature),null!=e.timestamp&&Object.hasOwnProperty.call(e,"timestamp")&&t.uint32(24).uint32(e.timestamp),null!=e.event&&Object.hasOwnProperty.call(e,"event")&&t.uint32(32).uint32(e.event),null!=e.app_id&&Object.hasOwnProperty.call(e,"app_id")&&t.uint32(40).uint32(e.app_id),null!=e.user_id&&Object.hasOwnProperty.call(e,"user_id")&&t.uint32(50).string(e.user_id),null!=e.biz_type&&Object.hasOwnProperty.call(e,"biz_type")&&t.uint32(56).uint32(e.biz_type),null!=e.device_id&&Object.hasOwnProperty.call(e,"device_id")&&t.uint32(66).string(e.device_id),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new c.logreport.SpeedLogHead;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.version=e.uint32();break;case 2:i.signature=e.bytes();break;case 3:i.timestamp=e.uint32();break;case 4:i.event=e.uint32();break;case 5:i.app_id=e.uint32();break;case 6:i.user_id=e.string();break;case 7:i.biz_type=e.uint32();break;case 8:i.device_id=e.string();break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.version&&e.hasOwnProperty("version")&&!a.isInteger(e.version)?"version: integer expected":null!=e.signature&&e.hasOwnProperty("signature")&&!(e.signature&&"number"==typeof e.signature.length||a.isString(e.signature))?"signature: buffer expected":null!=e.timestamp&&e.hasOwnProperty("timestamp")&&!a.isInteger(e.timestamp)?"timestamp: integer expected":null!=e.event&&e.hasOwnProperty("event")&&!a.isInteger(e.event)?"event: integer expected":null!=e.app_id&&e.hasOwnProperty("app_id")&&!a.isInteger(e.app_id)?"app_id: integer expected":null!=e.user_id&&e.hasOwnProperty("user_id")&&!a.isString(e.user_id)?"user_id: string expected":null!=e.biz_type&&e.hasOwnProperty("biz_type")&&!a.isInteger(e.biz_type)?"biz_type: integer expected":null!=e.device_id&&e.hasOwnProperty("device_id")&&!a.isString(e.device_id)?"device_id: string expected":null},e.fromObject=function(e){if(e instanceof c.logreport.SpeedLogHead)return e;var t=new c.logreport.SpeedLogHead;return null!=e.version&&(t.version=e.version>>>0),null!=e.signature&&("string"==typeof e.signature?a.base64.decode(e.signature,t.signature=a.newBuffer(a.base64.length(e.signature)),0):e.signature.length&&(t.signature=e.signature)),null!=e.timestamp&&(t.timestamp=e.timestamp>>>0),null!=e.event&&(t.event=e.event>>>0),null!=e.app_id&&(t.app_id=e.app_id>>>0),null!=e.user_id&&(t.user_id=String(e.user_id)),null!=e.biz_type&&(t.biz_type=e.biz_type>>>0),null!=e.device_id&&(t.device_id=String(e.device_id)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.version=0,t.bytes===String?r.signature="":(r.signature=[],t.bytes!==Array&&(r.signature=a.newBuffer(r.signature))),r.timestamp=0,r.event=0,r.app_id=0,r.user_id="",r.biz_type=0,r.device_id=""),null!=e.version&&e.hasOwnProperty("version")&&(r.version=e.version),null!=e.signature&&e.hasOwnProperty("signature")&&(r.signature=t.bytes===String?a.base64.encode(e.signature,0,e.signature.length):t.bytes===Array?Array.prototype.slice.call(e.signature):e.signature),null!=e.timestamp&&e.hasOwnProperty("timestamp")&&(r.timestamp=e.timestamp),null!=e.event&&e.hasOwnProperty("event")&&(r.event=e.event),null!=e.app_id&&e.hasOwnProperty("app_id")&&(r.app_id=e.app_id),null!=e.user_id&&e.hasOwnProperty("user_id")&&(r.user_id=e.user_id),null!=e.biz_type&&e.hasOwnProperty("biz_type")&&(r.biz_type=e.biz_type),null!=e.device_id&&e.hasOwnProperty("device_id")&&(r.device_id=e.device_id),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.ProtoVersion=(t={},(r=Object.create(t))[t[0]="PROTO_VERSION"]=0,r[t[1]="PROTO_VERSION1"]=1,r[t[2]="PROTO_VERSION2"]=2,r[t[3]="PROTO_VERSION3"]=3,r[t[4]="PROTO_VERSION4"]=4,r[t[5]="PROTO_VERSION5"]=5,r[t[6]="PROTO_VERSION6"]=6,r),e.Event=function(){var e={},t=Object.create(e);return t[e[0]="QUALITY_EVENT"]=0,t[e[100]="NO_BILLING_EVENT"]=100,t[e[300]="DETECT_QUALITY_EVENT"]=300,t}(),e.BizType=function(){var e={},t=Object.create(e);return t[e[0]="UNKNOWN"]=0,t[e[1]="LIVE"]=1,t[e[2]="RTV"]=2,t}(),e}(),i.SpeedLogRsp=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.code=0,e.prototype.message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(8).uint32(e.code),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new c.logreport.SpeedLogRsp;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.code=e.uint32();break;case 2:i.message=e.string();break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.code&&e.hasOwnProperty("code")&&!a.isInteger(e.code)?"code: integer expected":null!=e.message&&e.hasOwnProperty("message")&&!a.isString(e.message)?"message: string expected":null},e.fromObject=function(e){if(e instanceof c.logreport.SpeedLogRsp)return e;var t=new c.logreport.SpeedLogRsp;return null!=e.code&&(t.code=e.code>>>0),null!=e.message&&(t.message=String(e.message)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.code=0,r.message=""),null!=e.code&&e.hasOwnProperty("code")&&(r.code=e.code),null!=e.message&&e.hasOwnProperty("message")&&(r.message=e.message),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),i.QualityEvent=function(){function e(e){if(this.publish_quality_infos=[],this.play_quality_infos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t,r;return e.prototype.hardware_infos=null,e.prototype.publish_quality_infos=a.emptyArray,e.prototype.play_quality_infos=a.emptyArray,e.prototype.network_type=0,e.prototype.charge_infos=null,e.prototype.client_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.hardware_infos&&Object.hasOwnProperty.call(e,"hardware_infos")&&c.logreport.HardwareInfos.encode(e.hardware_infos,t.uint32(10).fork()).ldelim(),null!=e.publish_quality_infos&&e.publish_quality_infos.length)for(var r=0;r<e.publish_quality_infos.length;++r)c.logreport.PublishQualityInfos.encode(e.publish_quality_infos[r],t.uint32(18).fork()).ldelim();if(null!=e.play_quality_infos&&e.play_quality_infos.length)for(r=0;r<e.play_quality_infos.length;++r)c.logreport.PlayQualityInfos.encode(e.play_quality_infos[r],t.uint32(26).fork()).ldelim();return null!=e.network_type&&Object.hasOwnProperty.call(e,"network_type")&&t.uint32(32).uint32(e.network_type),null!=e.charge_infos&&Object.hasOwnProperty.call(e,"charge_infos")&&c.logreport.ChargeInfos.encode(e.charge_infos,t.uint32(42).fork()).ldelim(),null!=e.client_type&&Object.hasOwnProperty.call(e,"client_type")&&t.uint32(800).uint32(e.client_type),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new c.logreport.QualityEvent;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.hardware_infos=c.logreport.HardwareInfos.decode(e,e.uint32());break;case 2:i.publish_quality_infos&&i.publish_quality_infos.length||(i.publish_quality_infos=[]),i.publish_quality_infos.push(c.logreport.PublishQualityInfos.decode(e,e.uint32()));break;case 3:i.play_quality_infos&&i.play_quality_infos.length||(i.play_quality_infos=[]),i.play_quality_infos.push(c.logreport.PlayQualityInfos.decode(e,e.uint32()));break;case 4:i.network_type=e.uint32();break;case 5:i.charge_infos=c.logreport.ChargeInfos.decode(e,e.uint32());break;case 100:i.client_type=e.uint32();break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.hardware_infos&&e.hasOwnProperty("hardware_infos")&&(r=c.logreport.HardwareInfos.verify(e.hardware_infos)))return"hardware_infos."+r;if(null!=e.publish_quality_infos&&e.hasOwnProperty("publish_quality_infos")){if(!Array.isArray(e.publish_quality_infos))return"publish_quality_infos: array expected";for(var t=0;t<e.publish_quality_infos.length;++t)if(r=c.logreport.PublishQualityInfos.verify(e.publish_quality_infos[t]))return"publish_quality_infos."+r}if(null!=e.play_quality_infos&&e.hasOwnProperty("play_quality_infos")){if(!Array.isArray(e.play_quality_infos))return"play_quality_infos: array expected";for(t=0;t<e.play_quality_infos.length;++t){var r;if(r=c.logreport.PlayQualityInfos.verify(e.play_quality_infos[t]))return"play_quality_infos."+r}}return null!=e.network_type&&e.hasOwnProperty("network_type")&&!a.isInteger(e.network_type)?"network_type: integer expected":null!=e.charge_infos&&e.hasOwnProperty("charge_infos")&&(r=c.logreport.ChargeInfos.verify(e.charge_infos))?"charge_infos."+r:null!=e.client_type&&e.hasOwnProperty("client_type")&&!a.isInteger(e.client_type)?"client_type: integer expected":null},e.fromObject=function(e){if(e instanceof c.logreport.QualityEvent)return e;var t=new c.logreport.QualityEvent;if(null!=e.hardware_infos){if("object"!=typeof e.hardware_infos)throw TypeError(".logreport.QualityEvent.hardware_infos: object expected");t.hardware_infos=c.logreport.HardwareInfos.fromObject(e.hardware_infos)}if(e.publish_quality_infos){if(!Array.isArray(e.publish_quality_infos))throw TypeError(".logreport.QualityEvent.publish_quality_infos: array expected");t.publish_quality_infos=[];for(var r=0;r<e.publish_quality_infos.length;++r){if("object"!=typeof e.publish_quality_infos[r])throw TypeError(".logreport.QualityEvent.publish_quality_infos: object expected");t.publish_quality_infos[r]=c.logreport.PublishQualityInfos.fromObject(e.publish_quality_infos[r])}}if(e.play_quality_infos){if(!Array.isArray(e.play_quality_infos))throw TypeError(".logreport.QualityEvent.play_quality_infos: array expected");for(t.play_quality_infos=[],r=0;r<e.play_quality_infos.length;++r){if("object"!=typeof e.play_quality_infos[r])throw TypeError(".logreport.QualityEvent.play_quality_infos: object expected");t.play_quality_infos[r]=c.logreport.PlayQualityInfos.fromObject(e.play_quality_infos[r])}}if(null!=e.network_type&&(t.network_type=e.network_type>>>0),null!=e.charge_infos){if("object"!=typeof e.charge_infos)throw TypeError(".logreport.QualityEvent.charge_infos: object expected");t.charge_infos=c.logreport.ChargeInfos.fromObject(e.charge_infos)}return null!=e.client_type&&(t.client_type=e.client_type>>>0),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.publish_quality_infos=[],r.play_quality_infos=[]),t.defaults&&(r.hardware_infos=null,r.network_type=0,r.charge_infos=null,r.client_type=0),null!=e.hardware_infos&&e.hasOwnProperty("hardware_infos")&&(r.hardware_infos=c.logreport.HardwareInfos.toObject(e.hardware_infos,t)),e.publish_quality_infos&&e.publish_quality_infos.length){r.publish_quality_infos=[];for(var i=0;i<e.publish_quality_infos.length;++i)r.publish_quality_infos[i]=c.logreport.PublishQualityInfos.toObject(e.publish_quality_infos[i],t)}if(e.play_quality_infos&&e.play_quality_infos.length)for(r.play_quality_infos=[],i=0;i<e.play_quality_infos.length;++i)r.play_quality_infos[i]=c.logreport.PlayQualityInfos.toObject(e.play_quality_infos[i],t);return null!=e.network_type&&e.hasOwnProperty("network_type")&&(r.network_type=e.network_type),null!=e.charge_infos&&e.hasOwnProperty("charge_infos")&&(r.charge_infos=c.logreport.ChargeInfos.toObject(e.charge_infos,t)),null!=e.client_type&&e.hasOwnProperty("client_type")&&(r.client_type=e.client_type),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.ResourceType=(t={},(r=Object.create(t))[t[0]="UNKNOWN"]=0,r[t[1]="CDN"]=1,r[t[2]="RTC"]=2,r[t[3]="L3"]=3,r),e}(),i.HardwareInfos=function(){function e(e){if(this.infos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timestamp_offset_begin=0,e.prototype.timestamp_offset_end=0,e.prototype.infos=a.emptyArray,e.prototype.sys_mem_total=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.timestamp_offset_begin&&Object.hasOwnProperty.call(e,"timestamp_offset_begin")&&t.uint32(8).uint32(e.timestamp_offset_begin),null!=e.timestamp_offset_end&&Object.hasOwnProperty.call(e,"timestamp_offset_end")&&t.uint32(16).uint32(e.timestamp_offset_end),null!=e.infos&&e.infos.length)for(var r=0;r<e.infos.length;++r)c.logreport.HardwareInfo.encode(e.infos[r],t.uint32(26).fork()).ldelim();return null!=e.sys_mem_total&&Object.hasOwnProperty.call(e,"sys_mem_total")&&t.uint32(32).uint32(e.sys_mem_total),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new c.logreport.HardwareInfos;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timestamp_offset_begin=e.uint32();break;case 2:i.timestamp_offset_end=e.uint32();break;case 3:i.infos&&i.infos.length||(i.infos=[]),i.infos.push(c.logreport.HardwareInfo.decode(e,e.uint32()));break;case 4:i.sys_mem_total=e.uint32();break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.timestamp_offset_begin&&e.hasOwnProperty("timestamp_offset_begin")&&!a.isInteger(e.timestamp_offset_begin))return"timestamp_offset_begin: integer expected";if(null!=e.timestamp_offset_end&&e.hasOwnProperty("timestamp_offset_end")&&!a.isInteger(e.timestamp_offset_end))return"timestamp_offset_end: integer expected";if(null!=e.infos&&e.hasOwnProperty("infos")){if(!Array.isArray(e.infos))return"infos: array expected";for(var t=0;t<e.infos.length;++t){var r=c.logreport.HardwareInfo.verify(e.infos[t]);if(r)return"infos."+r}}return null!=e.sys_mem_total&&e.hasOwnProperty("sys_mem_total")&&!a.isInteger(e.sys_mem_total)?"sys_mem_total: integer expected":null},e.fromObject=function(e){if(e instanceof c.logreport.HardwareInfos)return e;var t=new c.logreport.HardwareInfos;if(null!=e.timestamp_offset_begin&&(t.timestamp_offset_begin=e.timestamp_offset_begin>>>0),null!=e.timestamp_offset_end&&(t.timestamp_offset_end=e.timestamp_offset_end>>>0),e.infos){if(!Array.isArray(e.infos))throw TypeError(".logreport.HardwareInfos.infos: array expected");t.infos=[];for(var r=0;r<e.infos.length;++r){if("object"!=typeof e.infos[r])throw TypeError(".logreport.HardwareInfos.infos: object expected");t.infos[r]=c.logreport.HardwareInfo.fromObject(e.infos[r])}}return null!=e.sys_mem_total&&(t.sys_mem_total=e.sys_mem_total>>>0),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.infos=[]),t.defaults&&(r.timestamp_offset_begin=0,r.timestamp_offset_end=0,r.sys_mem_total=0),null!=e.timestamp_offset_begin&&e.hasOwnProperty("timestamp_offset_begin")&&(r.timestamp_offset_begin=e.timestamp_offset_begin),null!=e.timestamp_offset_end&&e.hasOwnProperty("timestamp_offset_end")&&(r.timestamp_offset_end=e.timestamp_offset_end),e.infos&&e.infos.length){r.infos=[];for(var i=0;i<e.infos.length;++i)r.infos[i]=c.logreport.HardwareInfo.toObject(e.infos[i],t)}return null!=e.sys_mem_total&&e.hasOwnProperty("sys_mem_total")&&(r.sys_mem_total=e.sys_mem_total),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),i.PublishQualityInfos=function(){function e(e){if(this.infos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timestamp_offset_begin=0,e.prototype.timestamp_offset_end=0,e.prototype.stream_id="",e.prototype.session_id=0,e.prototype.video_width=0,e.prototype.video_height=0,e.prototype.ipv4=0,e.prototype.ipv6="",e.prototype.resource_type=0,e.prototype.infos=a.emptyArray,e.prototype.room_id="",e.prototype.evnvironment=0,e.prototype.ap="",e.prototype.session="",e.prototype.room_session_id=a.Long?a.Long.fromBits(0,0,!0):0,e.prototype.protocol_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.timestamp_offset_begin&&Object.hasOwnProperty.call(e,"timestamp_offset_begin")&&t.uint32(8).uint32(e.timestamp_offset_begin),null!=e.timestamp_offset_end&&Object.hasOwnProperty.call(e,"timestamp_offset_end")&&t.uint32(16).uint32(e.timestamp_offset_end),null!=e.stream_id&&Object.hasOwnProperty.call(e,"stream_id")&&t.uint32(26).string(e.stream_id),null!=e.session_id&&Object.hasOwnProperty.call(e,"session_id")&&t.uint32(32).uint32(e.session_id),null!=e.video_width&&Object.hasOwnProperty.call(e,"video_width")&&t.uint32(40).uint32(e.video_width),null!=e.video_height&&Object.hasOwnProperty.call(e,"video_height")&&t.uint32(48).uint32(e.video_height),null!=e.ipv4&&Object.hasOwnProperty.call(e,"ipv4")&&t.uint32(56).uint32(e.ipv4),null!=e.ipv6&&Object.hasOwnProperty.call(e,"ipv6")&&t.uint32(66).string(e.ipv6),null!=e.resource_type&&Object.hasOwnProperty.call(e,"resource_type")&&t.uint32(72).uint32(e.resource_type),null!=e.infos&&e.infos.length)for(var r=0;r<e.infos.length;++r)c.logreport.PublishQualityInfo.encode(e.infos[r],t.uint32(82).fork()).ldelim();return null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(90).string(e.room_id),null!=e.evnvironment&&Object.hasOwnProperty.call(e,"evnvironment")&&t.uint32(104).uint32(e.evnvironment),null!=e.ap&&Object.hasOwnProperty.call(e,"ap")&&t.uint32(114).string(e.ap),null!=e.session&&Object.hasOwnProperty.call(e,"session")&&t.uint32(122).string(e.session),null!=e.room_session_id&&Object.hasOwnProperty.call(e,"room_session_id")&&t.uint32(128).uint64(e.room_session_id),null!=e.protocol_type&&Object.hasOwnProperty.call(e,"protocol_type")&&t.uint32(136).uint32(e.protocol_type),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new c.logreport.PublishQualityInfos;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timestamp_offset_begin=e.uint32();break;case 2:i.timestamp_offset_end=e.uint32();break;case 3:i.stream_id=e.string();break;case 4:i.session_id=e.uint32();break;case 5:i.video_width=e.uint32();break;case 6:i.video_height=e.uint32();break;case 7:i.ipv4=e.uint32();break;case 8:i.ipv6=e.string();break;case 9:i.resource_type=e.uint32();break;case 10:i.infos&&i.infos.length||(i.infos=[]),i.infos.push(c.logreport.PublishQualityInfo.decode(e,e.uint32()));break;case 11:i.room_id=e.string();break;case 13:i.evnvironment=e.uint32();break;case 14:i.ap=e.string();break;case 15:i.session=e.string();break;case 16:i.room_session_id=e.uint64();break;case 17:i.protocol_type=e.uint32();break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.timestamp_offset_begin&&e.hasOwnProperty("timestamp_offset_begin")&&!a.isInteger(e.timestamp_offset_begin))return"timestamp_offset_begin: integer expected";if(null!=e.timestamp_offset_end&&e.hasOwnProperty("timestamp_offset_end")&&!a.isInteger(e.timestamp_offset_end))return"timestamp_offset_end: integer expected";if(null!=e.stream_id&&e.hasOwnProperty("stream_id")&&!a.isString(e.stream_id))return"stream_id: string expected";if(null!=e.session_id&&e.hasOwnProperty("session_id")&&!a.isInteger(e.session_id))return"session_id: integer expected";if(null!=e.video_width&&e.hasOwnProperty("video_width")&&!a.isInteger(e.video_width))return"video_width: integer expected";if(null!=e.video_height&&e.hasOwnProperty("video_height")&&!a.isInteger(e.video_height))return"video_height: integer expected";if(null!=e.ipv4&&e.hasOwnProperty("ipv4")&&!a.isInteger(e.ipv4))return"ipv4: integer expected";if(null!=e.ipv6&&e.hasOwnProperty("ipv6")&&!a.isString(e.ipv6))return"ipv6: string expected";if(null!=e.resource_type&&e.hasOwnProperty("resource_type")&&!a.isInteger(e.resource_type))return"resource_type: integer expected";if(null!=e.infos&&e.hasOwnProperty("infos")){if(!Array.isArray(e.infos))return"infos: array expected";for(var t=0;t<e.infos.length;++t){var r=c.logreport.PublishQualityInfo.verify(e.infos[t]);if(r)return"infos."+r}}return null!=e.room_id&&e.hasOwnProperty("room_id")&&!a.isString(e.room_id)?"room_id: string expected":null!=e.evnvironment&&e.hasOwnProperty("evnvironment")&&!a.isInteger(e.evnvironment)?"evnvironment: integer expected":null!=e.ap&&e.hasOwnProperty("ap")&&!a.isString(e.ap)?"ap: string expected":null!=e.session&&e.hasOwnProperty("session")&&!a.isString(e.session)?"session: string expected":null!=e.room_session_id&&e.hasOwnProperty("room_session_id")&&!(a.isInteger(e.room_session_id)||e.room_session_id&&a.isInteger(e.room_session_id.low)&&a.isInteger(e.room_session_id.high))?"room_session_id: integer|Long expected":null!=e.protocol_type&&e.hasOwnProperty("protocol_type")&&!a.isInteger(e.protocol_type)?"protocol_type: integer expected":null},e.fromObject=function(e){if(e instanceof c.logreport.PublishQualityInfos)return e;var t=new c.logreport.PublishQualityInfos;if(null!=e.timestamp_offset_begin&&(t.timestamp_offset_begin=e.timestamp_offset_begin>>>0),null!=e.timestamp_offset_end&&(t.timestamp_offset_end=e.timestamp_offset_end>>>0),null!=e.stream_id&&(t.stream_id=String(e.stream_id)),null!=e.session_id&&(t.session_id=e.session_id>>>0),null!=e.video_width&&(t.video_width=e.video_width>>>0),null!=e.video_height&&(t.video_height=e.video_height>>>0),null!=e.ipv4&&(t.ipv4=e.ipv4>>>0),null!=e.ipv6&&(t.ipv6=String(e.ipv6)),null!=e.resource_type&&(t.resource_type=e.resource_type>>>0),e.infos){if(!Array.isArray(e.infos))throw TypeError(".logreport.PublishQualityInfos.infos: array expected");t.infos=[];for(var r=0;r<e.infos.length;++r){if("object"!=typeof e.infos[r])throw TypeError(".logreport.PublishQualityInfos.infos: object expected");t.infos[r]=c.logreport.PublishQualityInfo.fromObject(e.infos[r])}}return null!=e.room_id&&(t.room_id=String(e.room_id)),null!=e.evnvironment&&(t.evnvironment=e.evnvironment>>>0),null!=e.ap&&(t.ap=String(e.ap)),null!=e.session&&(t.session=String(e.session)),null!=e.room_session_id&&(a.Long?(t.room_session_id=a.Long.fromValue(e.room_session_id)).unsigned=!0:"string"==typeof e.room_session_id?t.room_session_id=parseInt(e.room_session_id,10):"number"==typeof e.room_session_id?t.room_session_id=e.room_session_id:"object"==typeof e.room_session_id&&(t.room_session_id=new a.LongBits(e.room_session_id.low>>>0,e.room_session_id.high>>>0).toNumber(!0))),null!=e.protocol_type&&(t.protocol_type=e.protocol_type>>>0),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.infos=[]),t.defaults){if(r.timestamp_offset_begin=0,r.timestamp_offset_end=0,r.stream_id="",r.session_id=0,r.video_width=0,r.video_height=0,r.ipv4=0,r.ipv6="",r.resource_type=0,r.room_id="",r.evnvironment=0,r.ap="",r.session="",a.Long){var i=new a.Long(0,0,!0);r.room_session_id=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.room_session_id=t.longs===String?"0":0;r.protocol_type=0}if(null!=e.timestamp_offset_begin&&e.hasOwnProperty("timestamp_offset_begin")&&(r.timestamp_offset_begin=e.timestamp_offset_begin),null!=e.timestamp_offset_end&&e.hasOwnProperty("timestamp_offset_end")&&(r.timestamp_offset_end=e.timestamp_offset_end),null!=e.stream_id&&e.hasOwnProperty("stream_id")&&(r.stream_id=e.stream_id),null!=e.session_id&&e.hasOwnProperty("session_id")&&(r.session_id=e.session_id),null!=e.video_width&&e.hasOwnProperty("video_width")&&(r.video_width=e.video_width),null!=e.video_height&&e.hasOwnProperty("video_height")&&(r.video_height=e.video_height),null!=e.ipv4&&e.hasOwnProperty("ipv4")&&(r.ipv4=e.ipv4),null!=e.ipv6&&e.hasOwnProperty("ipv6")&&(r.ipv6=e.ipv6),null!=e.resource_type&&e.hasOwnProperty("resource_type")&&(r.resource_type=e.resource_type),e.infos&&e.infos.length){r.infos=[];for(var n=0;n<e.infos.length;++n)r.infos[n]=c.logreport.PublishQualityInfo.toObject(e.infos[n],t)}return null!=e.room_id&&e.hasOwnProperty("room_id")&&(r.room_id=e.room_id),null!=e.evnvironment&&e.hasOwnProperty("evnvironment")&&(r.evnvironment=e.evnvironment),null!=e.ap&&e.hasOwnProperty("ap")&&(r.ap=e.ap),null!=e.session&&e.hasOwnProperty("session")&&(r.session=e.session),null!=e.room_session_id&&e.hasOwnProperty("room_session_id")&&("number"==typeof e.room_session_id?r.room_session_id=t.longs===String?String(e.room_session_id):e.room_session_id:r.room_session_id=t.longs===String?a.Long.prototype.toString.call(e.room_session_id):t.longs===Number?new a.LongBits(e.room_session_id.low>>>0,e.room_session_id.high>>>0).toNumber(!0):e.room_session_id),null!=e.protocol_type&&e.hasOwnProperty("protocol_type")&&(r.protocol_type=e.protocol_type),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),i.PlayQualityInfos=function(){function e(e){if(this.infos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timestamp_offset_begin=0,e.prototype.timestamp_offset_end=0,e.prototype.stream_id="",e.prototype.session_id=0,e.prototype.video_width=0,e.prototype.video_height=0,e.prototype.ipv4=0,e.prototype.ipv6="",e.prototype.resource_type=0,e.prototype.infos=a.emptyArray,e.prototype.room_id="",e.prototype.session="",e.prototype.room_session_id=a.Long?a.Long.fromBits(0,0,!0):0,e.prototype.protocol_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.timestamp_offset_begin&&Object.hasOwnProperty.call(e,"timestamp_offset_begin")&&t.uint32(8).uint32(e.timestamp_offset_begin),null!=e.timestamp_offset_end&&Object.hasOwnProperty.call(e,"timestamp_offset_end")&&t.uint32(16).uint32(e.timestamp_offset_end),null!=e.stream_id&&Object.hasOwnProperty.call(e,"stream_id")&&t.uint32(26).string(e.stream_id),null!=e.session_id&&Object.hasOwnProperty.call(e,"session_id")&&t.uint32(32).uint32(e.session_id),null!=e.video_width&&Object.hasOwnProperty.call(e,"video_width")&&t.uint32(40).uint32(e.video_width),null!=e.video_height&&Object.hasOwnProperty.call(e,"video_height")&&t.uint32(48).uint32(e.video_height),null!=e.ipv4&&Object.hasOwnProperty.call(e,"ipv4")&&t.uint32(56).uint32(e.ipv4),null!=e.ipv6&&Object.hasOwnProperty.call(e,"ipv6")&&t.uint32(66).string(e.ipv6),null!=e.resource_type&&Object.hasOwnProperty.call(e,"resource_type")&&t.uint32(72).uint32(e.resource_type),null!=e.infos&&e.infos.length)for(var r=0;r<e.infos.length;++r)c.logreport.PlayQualityInfo.encode(e.infos[r],t.uint32(82).fork()).ldelim();return null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(90).string(e.room_id),null!=e.session&&Object.hasOwnProperty.call(e,"session")&&t.uint32(106).string(e.session),null!=e.room_session_id&&Object.hasOwnProperty.call(e,"room_session_id")&&t.uint32(112).uint64(e.room_session_id),null!=e.protocol_type&&Object.hasOwnProperty.call(e,"protocol_type")&&t.uint32(120).uint32(e.protocol_type),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new c.logreport.PlayQualityInfos;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timestamp_offset_begin=e.uint32();break;case 2:i.timestamp_offset_end=e.uint32();break;case 3:i.stream_id=e.string();break;case 4:i.session_id=e.uint32();break;case 5:i.video_width=e.uint32();break;case 6:i.video_height=e.uint32();break;case 7:i.ipv4=e.uint32();break;case 8:i.ipv6=e.string();break;case 9:i.resource_type=e.uint32();break;case 10:i.infos&&i.infos.length||(i.infos=[]),i.infos.push(c.logreport.PlayQualityInfo.decode(e,e.uint32()));break;case 11:i.room_id=e.string();break;case 13:i.session=e.string();break;case 14:i.room_session_id=e.uint64();break;case 15:i.protocol_type=e.uint32();break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.timestamp_offset_begin&&e.hasOwnProperty("timestamp_offset_begin")&&!a.isInteger(e.timestamp_offset_begin))return"timestamp_offset_begin: integer expected";if(null!=e.timestamp_offset_end&&e.hasOwnProperty("timestamp_offset_end")&&!a.isInteger(e.timestamp_offset_end))return"timestamp_offset_end: integer expected";if(null!=e.stream_id&&e.hasOwnProperty("stream_id")&&!a.isString(e.stream_id))return"stream_id: string expected";if(null!=e.session_id&&e.hasOwnProperty("session_id")&&!a.isInteger(e.session_id))return"session_id: integer expected";if(null!=e.video_width&&e.hasOwnProperty("video_width")&&!a.isInteger(e.video_width))return"video_width: integer expected";if(null!=e.video_height&&e.hasOwnProperty("video_height")&&!a.isInteger(e.video_height))return"video_height: integer expected";if(null!=e.ipv4&&e.hasOwnProperty("ipv4")&&!a.isInteger(e.ipv4))return"ipv4: integer expected";if(null!=e.ipv6&&e.hasOwnProperty("ipv6")&&!a.isString(e.ipv6))return"ipv6: string expected";if(null!=e.resource_type&&e.hasOwnProperty("resource_type")&&!a.isInteger(e.resource_type))return"resource_type: integer expected";if(null!=e.infos&&e.hasOwnProperty("infos")){if(!Array.isArray(e.infos))return"infos: array expected";for(var t=0;t<e.infos.length;++t){var r=c.logreport.PlayQualityInfo.verify(e.infos[t]);if(r)return"infos."+r}}return null!=e.room_id&&e.hasOwnProperty("room_id")&&!a.isString(e.room_id)?"room_id: string expected":null!=e.session&&e.hasOwnProperty("session")&&!a.isString(e.session)?"session: string expected":null!=e.room_session_id&&e.hasOwnProperty("room_session_id")&&!(a.isInteger(e.room_session_id)||e.room_session_id&&a.isInteger(e.room_session_id.low)&&a.isInteger(e.room_session_id.high))?"room_session_id: integer|Long expected":null!=e.protocol_type&&e.hasOwnProperty("protocol_type")&&!a.isInteger(e.protocol_type)?"protocol_type: integer expected":null},e.fromObject=function(e){if(e instanceof c.logreport.PlayQualityInfos)return e;var t=new c.logreport.PlayQualityInfos;if(null!=e.timestamp_offset_begin&&(t.timestamp_offset_begin=e.timestamp_offset_begin>>>0),null!=e.timestamp_offset_end&&(t.timestamp_offset_end=e.timestamp_offset_end>>>0),null!=e.stream_id&&(t.stream_id=String(e.stream_id)),null!=e.session_id&&(t.session_id=e.session_id>>>0),null!=e.video_width&&(t.video_width=e.video_width>>>0),null!=e.video_height&&(t.video_height=e.video_height>>>0),null!=e.ipv4&&(t.ipv4=e.ipv4>>>0),null!=e.ipv6&&(t.ipv6=String(e.ipv6)),null!=e.resource_type&&(t.resource_type=e.resource_type>>>0),e.infos){if(!Array.isArray(e.infos))throw TypeError(".logreport.PlayQualityInfos.infos: array expected");t.infos=[];for(var r=0;r<e.infos.length;++r){if("object"!=typeof e.infos[r])throw TypeError(".logreport.PlayQualityInfos.infos: object expected");t.infos[r]=c.logreport.PlayQualityInfo.fromObject(e.infos[r])}}return null!=e.room_id&&(t.room_id=String(e.room_id)),null!=e.session&&(t.session=String(e.session)),null!=e.room_session_id&&(a.Long?(t.room_session_id=a.Long.fromValue(e.room_session_id)).unsigned=!0:"string"==typeof e.room_session_id?t.room_session_id=parseInt(e.room_session_id,10):"number"==typeof e.room_session_id?t.room_session_id=e.room_session_id:"object"==typeof e.room_session_id&&(t.room_session_id=new a.LongBits(e.room_session_id.low>>>0,e.room_session_id.high>>>0).toNumber(!0))),null!=e.protocol_type&&(t.protocol_type=e.protocol_type>>>0),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.infos=[]),t.defaults){if(r.timestamp_offset_begin=0,r.timestamp_offset_end=0,r.stream_id="",r.session_id=0,r.video_width=0,r.video_height=0,r.ipv4=0,r.ipv6="",r.resource_type=0,r.room_id="",r.session="",a.Long){var i=new a.Long(0,0,!0);r.room_session_id=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.room_session_id=t.longs===String?"0":0;r.protocol_type=0}if(null!=e.timestamp_offset_begin&&e.hasOwnProperty("timestamp_offset_begin")&&(r.timestamp_offset_begin=e.timestamp_offset_begin),null!=e.timestamp_offset_end&&e.hasOwnProperty("timestamp_offset_end")&&(r.timestamp_offset_end=e.timestamp_offset_end),null!=e.stream_id&&e.hasOwnProperty("stream_id")&&(r.stream_id=e.stream_id),null!=e.session_id&&e.hasOwnProperty("session_id")&&(r.session_id=e.session_id),null!=e.video_width&&e.hasOwnProperty("video_width")&&(r.video_width=e.video_width),null!=e.video_height&&e.hasOwnProperty("video_height")&&(r.video_height=e.video_height),null!=e.ipv4&&e.hasOwnProperty("ipv4")&&(r.ipv4=e.ipv4),null!=e.ipv6&&e.hasOwnProperty("ipv6")&&(r.ipv6=e.ipv6),null!=e.resource_type&&e.hasOwnProperty("resource_type")&&(r.resource_type=e.resource_type),e.infos&&e.infos.length){r.infos=[];for(var n=0;n<e.infos.length;++n)r.infos[n]=c.logreport.PlayQualityInfo.toObject(e.infos[n],t)}return null!=e.room_id&&e.hasOwnProperty("room_id")&&(r.room_id=e.room_id),null!=e.session&&e.hasOwnProperty("session")&&(r.session=e.session),null!=e.room_session_id&&e.hasOwnProperty("room_session_id")&&("number"==typeof e.room_session_id?r.room_session_id=t.longs===String?String(e.room_session_id):e.room_session_id:r.room_session_id=t.longs===String?a.Long.prototype.toString.call(e.room_session_id):t.longs===Number?new a.LongBits(e.room_session_id.low>>>0,e.room_session_id.high>>>0).toNumber(!0):e.room_session_id),null!=e.protocol_type&&e.hasOwnProperty("protocol_type")&&(r.protocol_type=e.protocol_type),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),i.ChargeInfos=function(){function e(e){if(this.infos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timestamp_offset_begin=0,e.prototype.timestamp_offset_end=0,e.prototype.timestamp_diff_flag=0,e.prototype.timestamp_diff=0,e.prototype.room_id="",e.prototype.infos=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.timestamp_offset_begin&&Object.hasOwnProperty.call(e,"timestamp_offset_begin")&&t.uint32(8).uint32(e.timestamp_offset_begin),null!=e.timestamp_offset_end&&Object.hasOwnProperty.call(e,"timestamp_offset_end")&&t.uint32(16).uint32(e.timestamp_offset_end),null!=e.timestamp_diff_flag&&Object.hasOwnProperty.call(e,"timestamp_diff_flag")&&t.uint32(24).uint32(e.timestamp_diff_flag),null!=e.timestamp_diff&&Object.hasOwnProperty.call(e,"timestamp_diff")&&t.uint32(32).uint32(e.timestamp_diff),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(42).string(e.room_id),null!=e.infos&&e.infos.length)for(var r=0;r<e.infos.length;++r)c.logreport.ChargeInfo.encode(e.infos[r],t.uint32(802).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new c.logreport.ChargeInfos;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timestamp_offset_begin=e.uint32();break;case 2:i.timestamp_offset_end=e.uint32();break;case 3:i.timestamp_diff_flag=e.uint32();break;case 4:i.timestamp_diff=e.uint32();break;case 5:i.room_id=e.string();break;case 100:i.infos&&i.infos.length||(i.infos=[]),i.infos.push(c.logreport.ChargeInfo.decode(e,e.uint32()));break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.timestamp_offset_begin&&e.hasOwnProperty("timestamp_offset_begin")&&!a.isInteger(e.timestamp_offset_begin))return"timestamp_offset_begin: integer expected";if(null!=e.timestamp_offset_end&&e.hasOwnProperty("timestamp_offset_end")&&!a.isInteger(e.timestamp_offset_end))return"timestamp_offset_end: integer expected";if(null!=e.timestamp_diff_flag&&e.hasOwnProperty("timestamp_diff_flag")&&!a.isInteger(e.timestamp_diff_flag))return"timestamp_diff_flag: integer expected";if(null!=e.timestamp_diff&&e.hasOwnProperty("timestamp_diff")&&!a.isInteger(e.timestamp_diff))return"timestamp_diff: integer expected";if(null!=e.room_id&&e.hasOwnProperty("room_id")&&!a.isString(e.room_id))return"room_id: string expected";if(null!=e.infos&&e.hasOwnProperty("infos")){if(!Array.isArray(e.infos))return"infos: array expected";for(var t=0;t<e.infos.length;++t){var r=c.logreport.ChargeInfo.verify(e.infos[t]);if(r)return"infos."+r}}return null},e.fromObject=function(e){if(e instanceof c.logreport.ChargeInfos)return e;var t=new c.logreport.ChargeInfos;if(null!=e.timestamp_offset_begin&&(t.timestamp_offset_begin=e.timestamp_offset_begin>>>0),null!=e.timestamp_offset_end&&(t.timestamp_offset_end=e.timestamp_offset_end>>>0),null!=e.timestamp_diff_flag&&(t.timestamp_diff_flag=e.timestamp_diff_flag>>>0),null!=e.timestamp_diff&&(t.timestamp_diff=e.timestamp_diff>>>0),null!=e.room_id&&(t.room_id=String(e.room_id)),e.infos){if(!Array.isArray(e.infos))throw TypeError(".logreport.ChargeInfos.infos: array expected");t.infos=[];for(var r=0;r<e.infos.length;++r){if("object"!=typeof e.infos[r])throw TypeError(".logreport.ChargeInfos.infos: object expected");t.infos[r]=c.logreport.ChargeInfo.fromObject(e.infos[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.infos=[]),t.defaults&&(r.timestamp_offset_begin=0,r.timestamp_offset_end=0,r.timestamp_diff_flag=0,r.timestamp_diff=0,r.room_id=""),null!=e.timestamp_offset_begin&&e.hasOwnProperty("timestamp_offset_begin")&&(r.timestamp_offset_begin=e.timestamp_offset_begin),null!=e.timestamp_offset_end&&e.hasOwnProperty("timestamp_offset_end")&&(r.timestamp_offset_end=e.timestamp_offset_end),null!=e.timestamp_diff_flag&&e.hasOwnProperty("timestamp_diff_flag")&&(r.timestamp_diff_flag=e.timestamp_diff_flag),null!=e.timestamp_diff&&e.hasOwnProperty("timestamp_diff")&&(r.timestamp_diff=e.timestamp_diff),null!=e.room_id&&e.hasOwnProperty("room_id")&&(r.room_id=e.room_id),e.infos&&e.infos.length){r.infos=[];for(var i=0;i<e.infos.length;++i)r.infos[i]=c.logreport.ChargeInfo.toObject(e.infos[i],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),i.HardwareInfo=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.sys_cpu_used=0,e.prototype.app_cpu_used=0,e.prototype.sys_mem_used=0,e.prototype.app_mem_used=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.sys_cpu_used&&Object.hasOwnProperty.call(e,"sys_cpu_used")&&t.uint32(8).uint32(e.sys_cpu_used),null!=e.app_cpu_used&&Object.hasOwnProperty.call(e,"app_cpu_used")&&t.uint32(16).uint32(e.app_cpu_used),null!=e.sys_mem_used&&Object.hasOwnProperty.call(e,"sys_mem_used")&&t.uint32(24).uint32(e.sys_mem_used),null!=e.app_mem_used&&Object.hasOwnProperty.call(e,"app_mem_used")&&t.uint32(32).uint32(e.app_mem_used),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new c.logreport.HardwareInfo;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.sys_cpu_used=e.uint32();break;case 2:i.app_cpu_used=e.uint32();break;case 3:i.sys_mem_used=e.uint32();break;case 4:i.app_mem_used=e.uint32();break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.sys_cpu_used&&e.hasOwnProperty("sys_cpu_used")&&!a.isInteger(e.sys_cpu_used)?"sys_cpu_used: integer expected":null!=e.app_cpu_used&&e.hasOwnProperty("app_cpu_used")&&!a.isInteger(e.app_cpu_used)?"app_cpu_used: integer expected":null!=e.sys_mem_used&&e.hasOwnProperty("sys_mem_used")&&!a.isInteger(e.sys_mem_used)?"sys_mem_used: integer expected":null!=e.app_mem_used&&e.hasOwnProperty("app_mem_used")&&!a.isInteger(e.app_mem_used)?"app_mem_used: integer expected":null},e.fromObject=function(e){if(e instanceof c.logreport.HardwareInfo)return e;var t=new c.logreport.HardwareInfo;return null!=e.sys_cpu_used&&(t.sys_cpu_used=e.sys_cpu_used>>>0),null!=e.app_cpu_used&&(t.app_cpu_used=e.app_cpu_used>>>0),null!=e.sys_mem_used&&(t.sys_mem_used=e.sys_mem_used>>>0),null!=e.app_mem_used&&(t.app_mem_used=e.app_mem_used>>>0),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.sys_cpu_used=0,r.app_cpu_used=0,r.sys_mem_used=0,r.app_mem_used=0),null!=e.sys_cpu_used&&e.hasOwnProperty("sys_cpu_used")&&(r.sys_cpu_used=e.sys_cpu_used),null!=e.app_cpu_used&&e.hasOwnProperty("app_cpu_used")&&(r.app_cpu_used=e.app_cpu_used),null!=e.sys_mem_used&&e.hasOwnProperty("sys_mem_used")&&(r.sys_mem_used=e.sys_mem_used),null!=e.app_mem_used&&e.hasOwnProperty("app_mem_used")&&(r.app_mem_used=e.app_mem_used),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),i.PublishQualityInfo=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.audio_bitrate=0,e.prototype.video_bitrate=0,e.prototype.video_capture_fps=0,e.prototype.video_network_fps=0,e.prototype.uplink_plr=0,e.prototype.rtt=0,e.prototype.audio_network_fps=0,e.prototype.captured_sound_level=0,e.prototype.sample_time_window=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.audio_bitrate&&Object.hasOwnProperty.call(e,"audio_bitrate")&&t.uint32(8).uint32(e.audio_bitrate),null!=e.video_bitrate&&Object.hasOwnProperty.call(e,"video_bitrate")&&t.uint32(16).uint32(e.video_bitrate),null!=e.video_capture_fps&&Object.hasOwnProperty.call(e,"video_capture_fps")&&t.uint32(24).uint32(e.video_capture_fps),null!=e.video_network_fps&&Object.hasOwnProperty.call(e,"video_network_fps")&&t.uint32(32).uint32(e.video_network_fps),null!=e.uplink_plr&&Object.hasOwnProperty.call(e,"uplink_plr")&&t.uint32(40).uint32(e.uplink_plr),null!=e.rtt&&Object.hasOwnProperty.call(e,"rtt")&&t.uint32(48).uint32(e.rtt),null!=e.audio_network_fps&&Object.hasOwnProperty.call(e,"audio_network_fps")&&t.uint32(56).uint32(e.audio_network_fps),null!=e.captured_sound_level&&Object.hasOwnProperty.call(e,"captured_sound_level")&&t.uint32(64).uint32(e.captured_sound_level),null!=e.sample_time_window&&Object.hasOwnProperty.call(e,"sample_time_window")&&t.uint32(800).uint32(e.sample_time_window),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new c.logreport.PublishQualityInfo;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.audio_bitrate=e.uint32();break;case 2:i.video_bitrate=e.uint32();break;case 3:i.video_capture_fps=e.uint32();break;case 4:i.video_network_fps=e.uint32();break;case 5:i.uplink_plr=e.uint32();break;case 6:i.rtt=e.uint32();break;case 7:i.audio_network_fps=e.uint32();break;case 8:i.captured_sound_level=e.uint32();break;case 100:i.sample_time_window=e.uint32();break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.audio_bitrate&&e.hasOwnProperty("audio_bitrate")&&!a.isInteger(e.audio_bitrate)?"audio_bitrate: integer expected":null!=e.video_bitrate&&e.hasOwnProperty("video_bitrate")&&!a.isInteger(e.video_bitrate)?"video_bitrate: integer expected":null!=e.video_capture_fps&&e.hasOwnProperty("video_capture_fps")&&!a.isInteger(e.video_capture_fps)?"video_capture_fps: integer expected":null!=e.video_network_fps&&e.hasOwnProperty("video_network_fps")&&!a.isInteger(e.video_network_fps)?"video_network_fps: integer expected":null!=e.uplink_plr&&e.hasOwnProperty("uplink_plr")&&!a.isInteger(e.uplink_plr)?"uplink_plr: integer expected":null!=e.rtt&&e.hasOwnProperty("rtt")&&!a.isInteger(e.rtt)?"rtt: integer expected":null!=e.audio_network_fps&&e.hasOwnProperty("audio_network_fps")&&!a.isInteger(e.audio_network_fps)?"audio_network_fps: integer expected":null!=e.captured_sound_level&&e.hasOwnProperty("captured_sound_level")&&!a.isInteger(e.captured_sound_level)?"captured_sound_level: integer expected":null!=e.sample_time_window&&e.hasOwnProperty("sample_time_window")&&!a.isInteger(e.sample_time_window)?"sample_time_window: integer expected":null},e.fromObject=function(e){if(e instanceof c.logreport.PublishQualityInfo)return e;var t=new c.logreport.PublishQualityInfo;return null!=e.audio_bitrate&&(t.audio_bitrate=e.audio_bitrate>>>0),null!=e.video_bitrate&&(t.video_bitrate=e.video_bitrate>>>0),null!=e.video_capture_fps&&(t.video_capture_fps=e.video_capture_fps>>>0),null!=e.video_network_fps&&(t.video_network_fps=e.video_network_fps>>>0),null!=e.uplink_plr&&(t.uplink_plr=e.uplink_plr>>>0),null!=e.rtt&&(t.rtt=e.rtt>>>0),null!=e.audio_network_fps&&(t.audio_network_fps=e.audio_network_fps>>>0),null!=e.captured_sound_level&&(t.captured_sound_level=e.captured_sound_level>>>0),null!=e.sample_time_window&&(t.sample_time_window=e.sample_time_window>>>0),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.audio_bitrate=0,r.video_bitrate=0,r.video_capture_fps=0,r.video_network_fps=0,r.uplink_plr=0,r.rtt=0,r.audio_network_fps=0,r.captured_sound_level=0,r.sample_time_window=0),null!=e.audio_bitrate&&e.hasOwnProperty("audio_bitrate")&&(r.audio_bitrate=e.audio_bitrate),null!=e.video_bitrate&&e.hasOwnProperty("video_bitrate")&&(r.video_bitrate=e.video_bitrate),null!=e.video_capture_fps&&e.hasOwnProperty("video_capture_fps")&&(r.video_capture_fps=e.video_capture_fps),null!=e.video_network_fps&&e.hasOwnProperty("video_network_fps")&&(r.video_network_fps=e.video_network_fps),null!=e.uplink_plr&&e.hasOwnProperty("uplink_plr")&&(r.uplink_plr=e.uplink_plr),null!=e.rtt&&e.hasOwnProperty("rtt")&&(r.rtt=e.rtt),null!=e.audio_network_fps&&e.hasOwnProperty("audio_network_fps")&&(r.audio_network_fps=e.audio_network_fps),null!=e.captured_sound_level&&e.hasOwnProperty("captured_sound_level")&&(r.captured_sound_level=e.captured_sound_level),null!=e.sample_time_window&&e.hasOwnProperty("sample_time_window")&&(r.sample_time_window=e.sample_time_window),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),i.PlayQualityInfo=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.audio_bitrate=0,e.prototype.video_bitrate=0,e.prototype.video_network_fps=0,e.prototype.audio_break_count=0,e.prototype.video_break_count=0,e.prototype.downlink_plr=0,e.prototype.peer_to_peer_plr=0,e.prototype.peer_to_peer_delay=0,e.prototype.audio_network_fps=0,e.prototype.audio_break_duration=0,e.prototype.video_break_duration=0,e.prototype.audio_break_rate=0,e.prototype.video_break_rate=0,e.prototype.audio_break_cancel=0,e.prototype.video_break_cancel=0,e.prototype.rtt=0,e.prototype.rendered_sound_level=0,e.prototype.audio_break_cancel_duration=0,e.prototype.video_break_cancel_duration=0,e.prototype.audio_decode_time=0,e.prototype.video_decode_time=0,e.prototype.real_sampling_interval=0,e.prototype.mos=0,e.prototype.audio_decode_fps=0,e.prototype.video_decode_fps=0,e.prototype.video_frames_decoded=0,e.prototype.video_frames_dropped=0,e.prototype.sample_time_window=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.audio_bitrate&&Object.hasOwnProperty.call(e,"audio_bitrate")&&t.uint32(8).uint32(e.audio_bitrate),null!=e.video_bitrate&&Object.hasOwnProperty.call(e,"video_bitrate")&&t.uint32(16).uint32(e.video_bitrate),null!=e.video_network_fps&&Object.hasOwnProperty.call(e,"video_network_fps")&&t.uint32(24).uint32(e.video_network_fps),null!=e.audio_break_count&&Object.hasOwnProperty.call(e,"audio_break_count")&&t.uint32(32).uint32(e.audio_break_count),null!=e.video_break_count&&Object.hasOwnProperty.call(e,"video_break_count")&&t.uint32(40).uint32(e.video_break_count),null!=e.downlink_plr&&Object.hasOwnProperty.call(e,"downlink_plr")&&t.uint32(48).uint32(e.downlink_plr),null!=e.peer_to_peer_plr&&Object.hasOwnProperty.call(e,"peer_to_peer_plr")&&t.uint32(56).uint32(e.peer_to_peer_plr),null!=e.peer_to_peer_delay&&Object.hasOwnProperty.call(e,"peer_to_peer_delay")&&t.uint32(64).uint32(e.peer_to_peer_delay),null!=e.audio_network_fps&&Object.hasOwnProperty.call(e,"audio_network_fps")&&t.uint32(72).uint32(e.audio_network_fps),null!=e.audio_break_duration&&Object.hasOwnProperty.call(e,"audio_break_duration")&&t.uint32(80).uint32(e.audio_break_duration),null!=e.video_break_duration&&Object.hasOwnProperty.call(e,"video_break_duration")&&t.uint32(88).uint32(e.video_break_duration),null!=e.audio_break_rate&&Object.hasOwnProperty.call(e,"audio_break_rate")&&t.uint32(96).uint32(e.audio_break_rate),null!=e.video_break_rate&&Object.hasOwnProperty.call(e,"video_break_rate")&&t.uint32(104).uint32(e.video_break_rate),null!=e.audio_break_cancel&&Object.hasOwnProperty.call(e,"audio_break_cancel")&&t.uint32(112).uint32(e.audio_break_cancel),null!=e.video_break_cancel&&Object.hasOwnProperty.call(e,"video_break_cancel")&&t.uint32(120).uint32(e.video_break_cancel),null!=e.rtt&&Object.hasOwnProperty.call(e,"rtt")&&t.uint32(128).uint32(e.rtt),null!=e.rendered_sound_level&&Object.hasOwnProperty.call(e,"rendered_sound_level")&&t.uint32(136).uint32(e.rendered_sound_level),null!=e.audio_break_cancel_duration&&Object.hasOwnProperty.call(e,"audio_break_cancel_duration")&&t.uint32(144).uint32(e.audio_break_cancel_duration),null!=e.video_break_cancel_duration&&Object.hasOwnProperty.call(e,"video_break_cancel_duration")&&t.uint32(152).uint32(e.video_break_cancel_duration),null!=e.audio_decode_time&&Object.hasOwnProperty.call(e,"audio_decode_time")&&t.uint32(160).uint32(e.audio_decode_time),null!=e.video_decode_time&&Object.hasOwnProperty.call(e,"video_decode_time")&&t.uint32(168).uint32(e.video_decode_time),null!=e.real_sampling_interval&&Object.hasOwnProperty.call(e,"real_sampling_interval")&&t.uint32(176).uint32(e.real_sampling_interval),null!=e.mos&&Object.hasOwnProperty.call(e,"mos")&&t.uint32(184).int32(e.mos),null!=e.audio_decode_fps&&Object.hasOwnProperty.call(e,"audio_decode_fps")&&t.uint32(192).uint32(e.audio_decode_fps),null!=e.video_decode_fps&&Object.hasOwnProperty.call(e,"video_decode_fps")&&t.uint32(200).uint32(e.video_decode_fps),null!=e.video_frames_decoded&&Object.hasOwnProperty.call(e,"video_frames_decoded")&&t.uint32(208).uint32(e.video_frames_decoded),null!=e.video_frames_dropped&&Object.hasOwnProperty.call(e,"video_frames_dropped")&&t.uint32(216).uint32(e.video_frames_dropped),null!=e.sample_time_window&&Object.hasOwnProperty.call(e,"sample_time_window")&&t.uint32(800).uint32(e.sample_time_window),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new c.logreport.PlayQualityInfo;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.audio_bitrate=e.uint32();break;case 2:i.video_bitrate=e.uint32();break;case 3:i.video_network_fps=e.uint32();break;case 4:i.audio_break_count=e.uint32();break;case 5:i.video_break_count=e.uint32();break;case 6:i.downlink_plr=e.uint32();break;case 7:i.peer_to_peer_plr=e.uint32();break;case 8:i.peer_to_peer_delay=e.uint32();break;case 9:i.audio_network_fps=e.uint32();break;case 10:i.audio_break_duration=e.uint32();break;case 11:i.video_break_duration=e.uint32();break;case 12:i.audio_break_rate=e.uint32();break;case 13:i.video_break_rate=e.uint32();break;case 14:i.audio_break_cancel=e.uint32();break;case 15:i.video_break_cancel=e.uint32();break;case 16:i.rtt=e.uint32();break;case 17:i.rendered_sound_level=e.uint32();break;case 18:i.audio_break_cancel_duration=e.uint32();break;case 19:i.video_break_cancel_duration=e.uint32();break;case 20:i.audio_decode_time=e.uint32();break;case 21:i.video_decode_time=e.uint32();break;case 22:i.real_sampling_interval=e.uint32();break;case 23:i.mos=e.int32();break;case 24:i.audio_decode_fps=e.uint32();break;case 25:i.video_decode_fps=e.uint32();break;case 26:i.video_frames_decoded=e.uint32();break;case 27:i.video_frames_dropped=e.uint32();break;case 100:i.sample_time_window=e.uint32();break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.audio_bitrate&&e.hasOwnProperty("audio_bitrate")&&!a.isInteger(e.audio_bitrate)?"audio_bitrate: integer expected":null!=e.video_bitrate&&e.hasOwnProperty("video_bitrate")&&!a.isInteger(e.video_bitrate)?"video_bitrate: integer expected":null!=e.video_network_fps&&e.hasOwnProperty("video_network_fps")&&!a.isInteger(e.video_network_fps)?"video_network_fps: integer expected":null!=e.audio_break_count&&e.hasOwnProperty("audio_break_count")&&!a.isInteger(e.audio_break_count)?"audio_break_count: integer expected":null!=e.video_break_count&&e.hasOwnProperty("video_break_count")&&!a.isInteger(e.video_break_count)?"video_break_count: integer expected":null!=e.downlink_plr&&e.hasOwnProperty("downlink_plr")&&!a.isInteger(e.downlink_plr)?"downlink_plr: integer expected":null!=e.peer_to_peer_plr&&e.hasOwnProperty("peer_to_peer_plr")&&!a.isInteger(e.peer_to_peer_plr)?"peer_to_peer_plr: integer expected":null!=e.peer_to_peer_delay&&e.hasOwnProperty("peer_to_peer_delay")&&!a.isInteger(e.peer_to_peer_delay)?"peer_to_peer_delay: integer expected":null!=e.audio_network_fps&&e.hasOwnProperty("audio_network_fps")&&!a.isInteger(e.audio_network_fps)?"audio_network_fps: integer expected":null!=e.audio_break_duration&&e.hasOwnProperty("audio_break_duration")&&!a.isInteger(e.audio_break_duration)?"audio_break_duration: integer expected":null!=e.video_break_duration&&e.hasOwnProperty("video_break_duration")&&!a.isInteger(e.video_break_duration)?"video_break_duration: integer expected":null!=e.audio_break_rate&&e.hasOwnProperty("audio_break_rate")&&!a.isInteger(e.audio_break_rate)?"audio_break_rate: integer expected":null!=e.video_break_rate&&e.hasOwnProperty("video_break_rate")&&!a.isInteger(e.video_break_rate)?"video_break_rate: integer expected":null!=e.audio_break_cancel&&e.hasOwnProperty("audio_break_cancel")&&!a.isInteger(e.audio_break_cancel)?"audio_break_cancel: integer expected":null!=e.video_break_cancel&&e.hasOwnProperty("video_break_cancel")&&!a.isInteger(e.video_break_cancel)?"video_break_cancel: integer expected":null!=e.rtt&&e.hasOwnProperty("rtt")&&!a.isInteger(e.rtt)?"rtt: integer expected":null!=e.rendered_sound_level&&e.hasOwnProperty("rendered_sound_level")&&!a.isInteger(e.rendered_sound_level)?"rendered_sound_level: integer expected":null!=e.audio_break_cancel_duration&&e.hasOwnProperty("audio_break_cancel_duration")&&!a.isInteger(e.audio_break_cancel_duration)?"audio_break_cancel_duration: integer expected":null!=e.video_break_cancel_duration&&e.hasOwnProperty("video_break_cancel_duration")&&!a.isInteger(e.video_break_cancel_duration)?"video_break_cancel_duration: integer expected":null!=e.audio_decode_time&&e.hasOwnProperty("audio_decode_time")&&!a.isInteger(e.audio_decode_time)?"audio_decode_time: integer expected":null!=e.video_decode_time&&e.hasOwnProperty("video_decode_time")&&!a.isInteger(e.video_decode_time)?"video_decode_time: integer expected":null!=e.real_sampling_interval&&e.hasOwnProperty("real_sampling_interval")&&!a.isInteger(e.real_sampling_interval)?"real_sampling_interval: integer expected":null!=e.mos&&e.hasOwnProperty("mos")&&!a.isInteger(e.mos)?"mos: integer expected":null!=e.audio_decode_fps&&e.hasOwnProperty("audio_decode_fps")&&!a.isInteger(e.audio_decode_fps)?"audio_decode_fps: integer expected":null!=e.video_decode_fps&&e.hasOwnProperty("video_decode_fps")&&!a.isInteger(e.video_decode_fps)?"video_decode_fps: integer expected":null!=e.video_frames_decoded&&e.hasOwnProperty("video_frames_decoded")&&!a.isInteger(e.video_frames_decoded)?"video_frames_decoded: integer expected":null!=e.video_frames_dropped&&e.hasOwnProperty("video_frames_dropped")&&!a.isInteger(e.video_frames_dropped)?"video_frames_dropped: integer expected":null!=e.sample_time_window&&e.hasOwnProperty("sample_time_window")&&!a.isInteger(e.sample_time_window)?"sample_time_window: integer expected":null},e.fromObject=function(e){if(e instanceof c.logreport.PlayQualityInfo)return e;var t=new c.logreport.PlayQualityInfo;return null!=e.audio_bitrate&&(t.audio_bitrate=e.audio_bitrate>>>0),null!=e.video_bitrate&&(t.video_bitrate=e.video_bitrate>>>0),null!=e.video_network_fps&&(t.video_network_fps=e.video_network_fps>>>0),null!=e.audio_break_count&&(t.audio_break_count=e.audio_break_count>>>0),null!=e.video_break_count&&(t.video_break_count=e.video_break_count>>>0),null!=e.downlink_plr&&(t.downlink_plr=e.downlink_plr>>>0),null!=e.peer_to_peer_plr&&(t.peer_to_peer_plr=e.peer_to_peer_plr>>>0),null!=e.peer_to_peer_delay&&(t.peer_to_peer_delay=e.peer_to_peer_delay>>>0),null!=e.audio_network_fps&&(t.audio_network_fps=e.audio_network_fps>>>0),null!=e.audio_break_duration&&(t.audio_break_duration=e.audio_break_duration>>>0),null!=e.video_break_duration&&(t.video_break_duration=e.video_break_duration>>>0),null!=e.audio_break_rate&&(t.audio_break_rate=e.audio_break_rate>>>0),null!=e.video_break_rate&&(t.video_break_rate=e.video_break_rate>>>0),null!=e.audio_break_cancel&&(t.audio_break_cancel=e.audio_break_cancel>>>0),null!=e.video_break_cancel&&(t.video_break_cancel=e.video_break_cancel>>>0),null!=e.rtt&&(t.rtt=e.rtt>>>0),null!=e.rendered_sound_level&&(t.rendered_sound_level=e.rendered_sound_level>>>0),null!=e.audio_break_cancel_duration&&(t.audio_break_cancel_duration=e.audio_break_cancel_duration>>>0),null!=e.video_break_cancel_duration&&(t.video_break_cancel_duration=e.video_break_cancel_duration>>>0),null!=e.audio_decode_time&&(t.audio_decode_time=e.audio_decode_time>>>0),null!=e.video_decode_time&&(t.video_decode_time=e.video_decode_time>>>0),null!=e.real_sampling_interval&&(t.real_sampling_interval=e.real_sampling_interval>>>0),null!=e.mos&&(t.mos=0|e.mos),null!=e.audio_decode_fps&&(t.audio_decode_fps=e.audio_decode_fps>>>0),null!=e.video_decode_fps&&(t.video_decode_fps=e.video_decode_fps>>>0),null!=e.video_frames_decoded&&(t.video_frames_decoded=e.video_frames_decoded>>>0),null!=e.video_frames_dropped&&(t.video_frames_dropped=e.video_frames_dropped>>>0),null!=e.sample_time_window&&(t.sample_time_window=e.sample_time_window>>>0),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.audio_bitrate=0,r.video_bitrate=0,r.video_network_fps=0,r.audio_break_count=0,r.video_break_count=0,r.downlink_plr=0,r.peer_to_peer_plr=0,r.peer_to_peer_delay=0,r.audio_network_fps=0,r.audio_break_duration=0,r.video_break_duration=0,r.audio_break_rate=0,r.video_break_rate=0,r.audio_break_cancel=0,r.video_break_cancel=0,r.rtt=0,r.rendered_sound_level=0,r.audio_break_cancel_duration=0,r.video_break_cancel_duration=0,r.audio_decode_time=0,r.video_decode_time=0,r.real_sampling_interval=0,r.mos=0,r.audio_decode_fps=0,r.video_decode_fps=0,r.video_frames_decoded=0,r.video_frames_dropped=0,r.sample_time_window=0),null!=e.audio_bitrate&&e.hasOwnProperty("audio_bitrate")&&(r.audio_bitrate=e.audio_bitrate),null!=e.video_bitrate&&e.hasOwnProperty("video_bitrate")&&(r.video_bitrate=e.video_bitrate),null!=e.video_network_fps&&e.hasOwnProperty("video_network_fps")&&(r.video_network_fps=e.video_network_fps),null!=e.audio_break_count&&e.hasOwnProperty("audio_break_count")&&(r.audio_break_count=e.audio_break_count),null!=e.video_break_count&&e.hasOwnProperty("video_break_count")&&(r.video_break_count=e.video_break_count),null!=e.downlink_plr&&e.hasOwnProperty("downlink_plr")&&(r.downlink_plr=e.downlink_plr),null!=e.peer_to_peer_plr&&e.hasOwnProperty("peer_to_peer_plr")&&(r.peer_to_peer_plr=e.peer_to_peer_plr),null!=e.peer_to_peer_delay&&e.hasOwnProperty("peer_to_peer_delay")&&(r.peer_to_peer_delay=e.peer_to_peer_delay),null!=e.audio_network_fps&&e.hasOwnProperty("audio_network_fps")&&(r.audio_network_fps=e.audio_network_fps),null!=e.audio_break_duration&&e.hasOwnProperty("audio_break_duration")&&(r.audio_break_duration=e.audio_break_duration),null!=e.video_break_duration&&e.hasOwnProperty("video_break_duration")&&(r.video_break_duration=e.video_break_duration),null!=e.audio_break_rate&&e.hasOwnProperty("audio_break_rate")&&(r.audio_break_rate=e.audio_break_rate),null!=e.video_break_rate&&e.hasOwnProperty("video_break_rate")&&(r.video_break_rate=e.video_break_rate),null!=e.audio_break_cancel&&e.hasOwnProperty("audio_break_cancel")&&(r.audio_break_cancel=e.audio_break_cancel),null!=e.video_break_cancel&&e.hasOwnProperty("video_break_cancel")&&(r.video_break_cancel=e.video_break_cancel),null!=e.rtt&&e.hasOwnProperty("rtt")&&(r.rtt=e.rtt),null!=e.rendered_sound_level&&e.hasOwnProperty("rendered_sound_level")&&(r.rendered_sound_level=e.rendered_sound_level),null!=e.audio_break_cancel_duration&&e.hasOwnProperty("audio_break_cancel_duration")&&(r.audio_break_cancel_duration=e.audio_break_cancel_duration),null!=e.video_break_cancel_duration&&e.hasOwnProperty("video_break_cancel_duration")&&(r.video_break_cancel_duration=e.video_break_cancel_duration),null!=e.audio_decode_time&&e.hasOwnProperty("audio_decode_time")&&(r.audio_decode_time=e.audio_decode_time),null!=e.video_decode_time&&e.hasOwnProperty("video_decode_time")&&(r.video_decode_time=e.video_decode_time),null!=e.real_sampling_interval&&e.hasOwnProperty("real_sampling_interval")&&(r.real_sampling_interval=e.real_sampling_interval),null!=e.mos&&e.hasOwnProperty("mos")&&(r.mos=e.mos),null!=e.audio_decode_fps&&e.hasOwnProperty("audio_decode_fps")&&(r.audio_decode_fps=e.audio_decode_fps),null!=e.video_decode_fps&&e.hasOwnProperty("video_decode_fps")&&(r.video_decode_fps=e.video_decode_fps),null!=e.video_frames_decoded&&e.hasOwnProperty("video_frames_decoded")&&(r.video_frames_decoded=e.video_frames_decoded),null!=e.video_frames_dropped&&e.hasOwnProperty("video_frames_dropped")&&(r.video_frames_dropped=e.video_frames_dropped),null!=e.sample_time_window&&e.hasOwnProperty("sample_time_window")&&(r.sample_time_window=e.sample_time_window),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),i.ChargeInfo=function(){function e(e){if(this.play_stream_resolution_infos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.is_publishing=0,e.prototype.play_stream_resolution_infos=a.emptyArray,e.prototype.play_max_audio_bitrate=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.is_publishing&&Object.hasOwnProperty.call(e,"is_publishing")&&t.uint32(8).uint32(e.is_publishing),null!=e.play_stream_resolution_infos&&e.play_stream_resolution_infos.length)for(var r=0;r<e.play_stream_resolution_infos.length;++r)c.logreport.ResolutionInfo.encode(e.play_stream_resolution_infos[r],t.uint32(18).fork()).ldelim();return null!=e.play_max_audio_bitrate&&Object.hasOwnProperty.call(e,"play_max_audio_bitrate")&&t.uint32(24).uint32(e.play_max_audio_bitrate),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new c.logreport.ChargeInfo;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.is_publishing=e.uint32();break;case 2:i.play_stream_resolution_infos&&i.play_stream_resolution_infos.length||(i.play_stream_resolution_infos=[]),i.play_stream_resolution_infos.push(c.logreport.ResolutionInfo.decode(e,e.uint32()));break;case 3:i.play_max_audio_bitrate=e.uint32();break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.is_publishing&&e.hasOwnProperty("is_publishing")&&!a.isInteger(e.is_publishing))return"is_publishing: integer expected";if(null!=e.play_stream_resolution_infos&&e.hasOwnProperty("play_stream_resolution_infos")){if(!Array.isArray(e.play_stream_resolution_infos))return"play_stream_resolution_infos: array expected";for(var t=0;t<e.play_stream_resolution_infos.length;++t){var r=c.logreport.ResolutionInfo.verify(e.play_stream_resolution_infos[t]);if(r)return"play_stream_resolution_infos."+r}}return null!=e.play_max_audio_bitrate&&e.hasOwnProperty("play_max_audio_bitrate")&&!a.isInteger(e.play_max_audio_bitrate)?"play_max_audio_bitrate: integer expected":null},e.fromObject=function(e){if(e instanceof c.logreport.ChargeInfo)return e;var t=new c.logreport.ChargeInfo;if(null!=e.is_publishing&&(t.is_publishing=e.is_publishing>>>0),e.play_stream_resolution_infos){if(!Array.isArray(e.play_stream_resolution_infos))throw TypeError(".logreport.ChargeInfo.play_stream_resolution_infos: array expected");t.play_stream_resolution_infos=[];for(var r=0;r<e.play_stream_resolution_infos.length;++r){if("object"!=typeof e.play_stream_resolution_infos[r])throw TypeError(".logreport.ChargeInfo.play_stream_resolution_infos: object expected");t.play_stream_resolution_infos[r]=c.logreport.ResolutionInfo.fromObject(e.play_stream_resolution_infos[r])}}return null!=e.play_max_audio_bitrate&&(t.play_max_audio_bitrate=e.play_max_audio_bitrate>>>0),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.play_stream_resolution_infos=[]),t.defaults&&(r.is_publishing=0,r.play_max_audio_bitrate=0),null!=e.is_publishing&&e.hasOwnProperty("is_publishing")&&(r.is_publishing=e.is_publishing),e.play_stream_resolution_infos&&e.play_stream_resolution_infos.length){r.play_stream_resolution_infos=[];for(var i=0;i<e.play_stream_resolution_infos.length;++i)r.play_stream_resolution_infos[i]=c.logreport.ResolutionInfo.toObject(e.play_stream_resolution_infos[i],t)}return null!=e.play_max_audio_bitrate&&e.hasOwnProperty("play_max_audio_bitrate")&&(r.play_max_audio_bitrate=e.play_max_audio_bitrate),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),i.ResolutionInfo=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.video_width=0,e.prototype.video_height=0,e.prototype.count=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.video_width&&Object.hasOwnProperty.call(e,"video_width")&&t.uint32(8).uint32(e.video_width),null!=e.video_height&&Object.hasOwnProperty.call(e,"video_height")&&t.uint32(16).uint32(e.video_height),null!=e.count&&Object.hasOwnProperty.call(e,"count")&&t.uint32(24).uint32(e.count),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new c.logreport.ResolutionInfo;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.video_width=e.uint32();break;case 2:i.video_height=e.uint32();break;case 3:i.count=e.uint32();break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.video_width&&e.hasOwnProperty("video_width")&&!a.isInteger(e.video_width)?"video_width: integer expected":null!=e.video_height&&e.hasOwnProperty("video_height")&&!a.isInteger(e.video_height)?"video_height: integer expected":null!=e.count&&e.hasOwnProperty("count")&&!a.isInteger(e.count)?"count: integer expected":null},e.fromObject=function(e){if(e instanceof c.logreport.ResolutionInfo)return e;var t=new c.logreport.ResolutionInfo;return null!=e.video_width&&(t.video_width=e.video_width>>>0),null!=e.video_height&&(t.video_height=e.video_height>>>0),null!=e.count&&(t.count=e.count>>>0),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.video_width=0,r.video_height=0,r.count=0),null!=e.video_width&&e.hasOwnProperty("video_width")&&(r.video_width=e.video_width),null!=e.video_height&&e.hasOwnProperty("video_height")&&(r.video_height=e.video_height),null!=e.count&&e.hasOwnProperty("count")&&(r.count=e.count),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),i.NoBillingEvent=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.platform_info="",e.prototype.room_id="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.platform_info&&Object.hasOwnProperty.call(e,"platform_info")&&t.uint32(10).string(e.platform_info),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(18).string(e.room_id),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new c.logreport.NoBillingEvent;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.platform_info=e.string();break;case 2:i.room_id=e.string();break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.platform_info&&e.hasOwnProperty("platform_info")&&!a.isString(e.platform_info)?"platform_info: string expected":null!=e.room_id&&e.hasOwnProperty("room_id")&&!a.isString(e.room_id)?"room_id: string expected":null},e.fromObject=function(e){if(e instanceof c.logreport.NoBillingEvent)return e;var t=new c.logreport.NoBillingEvent;return null!=e.platform_info&&(t.platform_info=String(e.platform_info)),null!=e.room_id&&(t.room_id=String(e.room_id)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.platform_info="",r.room_id=""),null!=e.platform_info&&e.hasOwnProperty("platform_info")&&(r.platform_info=e.platform_info),null!=e.room_id&&e.hasOwnProperty("room_id")&&(r.room_id=e.room_id),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),i.DynQualityEvent=function(){function e(e){if(this.dyn_quality_infos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.seq_no="",e.prototype.num=0,e.prototype.dyn_quality_infos=a.emptyArray,e.prototype.device_id="",e.prototype.latitude=0,e.prototype.longitude=0,e.prototype.country="",e.prototype.region="",e.prototype.city="",e.prototype.isp="",e.prototype.ve_mode=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.seq_no&&Object.hasOwnProperty.call(e,"seq_no")&&t.uint32(10).string(e.seq_no),null!=e.num&&Object.hasOwnProperty.call(e,"num")&&t.uint32(16).uint32(e.num),null!=e.dyn_quality_infos&&e.dyn_quality_infos.length)for(var r=0;r<e.dyn_quality_infos.length;++r)c.logreport.DynQualityInfos.encode(e.dyn_quality_infos[r],t.uint32(26).fork()).ldelim();return null!=e.device_id&&Object.hasOwnProperty.call(e,"device_id")&&t.uint32(34).string(e.device_id),null!=e.latitude&&Object.hasOwnProperty.call(e,"latitude")&&t.uint32(40).uint32(e.latitude),null!=e.longitude&&Object.hasOwnProperty.call(e,"longitude")&&t.uint32(48).uint32(e.longitude),null!=e.country&&Object.hasOwnProperty.call(e,"country")&&t.uint32(58).string(e.country),null!=e.region&&Object.hasOwnProperty.call(e,"region")&&t.uint32(66).string(e.region),null!=e.city&&Object.hasOwnProperty.call(e,"city")&&t.uint32(74).string(e.city),null!=e.isp&&Object.hasOwnProperty.call(e,"isp")&&t.uint32(82).string(e.isp),null!=e.ve_mode&&Object.hasOwnProperty.call(e,"ve_mode")&&t.uint32(88).uint32(e.ve_mode),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new c.logreport.DynQualityEvent;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.seq_no=e.string();break;case 2:i.num=e.uint32();break;case 3:i.dyn_quality_infos&&i.dyn_quality_infos.length||(i.dyn_quality_infos=[]),i.dyn_quality_infos.push(c.logreport.DynQualityInfos.decode(e,e.uint32()));break;case 4:i.device_id=e.string();break;case 5:i.latitude=e.uint32();break;case 6:i.longitude=e.uint32();break;case 7:i.country=e.string();break;case 8:i.region=e.string();break;case 9:i.city=e.string();break;case 10:i.isp=e.string();break;case 11:i.ve_mode=e.uint32();break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.seq_no&&e.hasOwnProperty("seq_no")&&!a.isString(e.seq_no))return"seq_no: string expected";if(null!=e.num&&e.hasOwnProperty("num")&&!a.isInteger(e.num))return"num: integer expected";if(null!=e.dyn_quality_infos&&e.hasOwnProperty("dyn_quality_infos")){if(!Array.isArray(e.dyn_quality_infos))return"dyn_quality_infos: array expected";for(var t=0;t<e.dyn_quality_infos.length;++t){var r=c.logreport.DynQualityInfos.verify(e.dyn_quality_infos[t]);if(r)return"dyn_quality_infos."+r}}return null!=e.device_id&&e.hasOwnProperty("device_id")&&!a.isString(e.device_id)?"device_id: string expected":null!=e.latitude&&e.hasOwnProperty("latitude")&&!a.isInteger(e.latitude)?"latitude: integer expected":null!=e.longitude&&e.hasOwnProperty("longitude")&&!a.isInteger(e.longitude)?"longitude: integer expected":null!=e.country&&e.hasOwnProperty("country")&&!a.isString(e.country)?"country: string expected":null!=e.region&&e.hasOwnProperty("region")&&!a.isString(e.region)?"region: string expected":null!=e.city&&e.hasOwnProperty("city")&&!a.isString(e.city)?"city: string expected":null!=e.isp&&e.hasOwnProperty("isp")&&!a.isString(e.isp)?"isp: string expected":null!=e.ve_mode&&e.hasOwnProperty("ve_mode")&&!a.isInteger(e.ve_mode)?"ve_mode: integer expected":null},e.fromObject=function(e){if(e instanceof c.logreport.DynQualityEvent)return e;var t=new c.logreport.DynQualityEvent;if(null!=e.seq_no&&(t.seq_no=String(e.seq_no)),null!=e.num&&(t.num=e.num>>>0),e.dyn_quality_infos){if(!Array.isArray(e.dyn_quality_infos))throw TypeError(".logreport.DynQualityEvent.dyn_quality_infos: array expected");t.dyn_quality_infos=[];for(var r=0;r<e.dyn_quality_infos.length;++r){if("object"!=typeof e.dyn_quality_infos[r])throw TypeError(".logreport.DynQualityEvent.dyn_quality_infos: object expected");t.dyn_quality_infos[r]=c.logreport.DynQualityInfos.fromObject(e.dyn_quality_infos[r])}}return null!=e.device_id&&(t.device_id=String(e.device_id)),null!=e.latitude&&(t.latitude=e.latitude>>>0),null!=e.longitude&&(t.longitude=e.longitude>>>0),null!=e.country&&(t.country=String(e.country)),null!=e.region&&(t.region=String(e.region)),null!=e.city&&(t.city=String(e.city)),null!=e.isp&&(t.isp=String(e.isp)),null!=e.ve_mode&&(t.ve_mode=e.ve_mode>>>0),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.dyn_quality_infos=[]),t.defaults&&(r.seq_no="",r.num=0,r.device_id="",r.latitude=0,r.longitude=0,r.country="",r.region="",r.city="",r.isp="",r.ve_mode=0),null!=e.seq_no&&e.hasOwnProperty("seq_no")&&(r.seq_no=e.seq_no),null!=e.num&&e.hasOwnProperty("num")&&(r.num=e.num),e.dyn_quality_infos&&e.dyn_quality_infos.length){r.dyn_quality_infos=[];for(var i=0;i<e.dyn_quality_infos.length;++i)r.dyn_quality_infos[i]=c.logreport.DynQualityInfos.toObject(e.dyn_quality_infos[i],t)}return null!=e.device_id&&e.hasOwnProperty("device_id")&&(r.device_id=e.device_id),null!=e.latitude&&e.hasOwnProperty("latitude")&&(r.latitude=e.latitude),null!=e.longitude&&e.hasOwnProperty("longitude")&&(r.longitude=e.longitude),null!=e.country&&e.hasOwnProperty("country")&&(r.country=e.country),null!=e.region&&e.hasOwnProperty("region")&&(r.region=e.region),null!=e.city&&e.hasOwnProperty("city")&&(r.city=e.city),null!=e.isp&&e.hasOwnProperty("isp")&&(r.isp=e.isp),null!=e.ve_mode&&e.hasOwnProperty("ve_mode")&&(r.ve_mode=e.ve_mode),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),i.DynQualityInfos=function(){function e(e){if(this.infos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timestamp_offset_begin=a.Long?a.Long.fromBits(0,0,!0):0,e.prototype.timestamp_offset_end=a.Long?a.Long.fromBits(0,0,!0):0,e.prototype.server_ip="",e.prototype.infos=a.emptyArray,e.prototype.network_type=0,e.prototype.stream_id="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.timestamp_offset_begin&&Object.hasOwnProperty.call(e,"timestamp_offset_begin")&&t.uint32(8).uint64(e.timestamp_offset_begin),null!=e.timestamp_offset_end&&Object.hasOwnProperty.call(e,"timestamp_offset_end")&&t.uint32(16).uint64(e.timestamp_offset_end),null!=e.server_ip&&Object.hasOwnProperty.call(e,"server_ip")&&t.uint32(26).string(e.server_ip),null!=e.infos&&e.infos.length)for(var r=0;r<e.infos.length;++r)c.logreport.DynQualityInfo.encode(e.infos[r],t.uint32(34).fork()).ldelim();return null!=e.network_type&&Object.hasOwnProperty.call(e,"network_type")&&t.uint32(40).uint32(e.network_type),null!=e.stream_id&&Object.hasOwnProperty.call(e,"stream_id")&&t.uint32(50).string(e.stream_id),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new c.logreport.DynQualityInfos;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timestamp_offset_begin=e.uint64();break;case 2:i.timestamp_offset_end=e.uint64();break;case 3:i.server_ip=e.string();break;case 4:i.infos&&i.infos.length||(i.infos=[]),i.infos.push(c.logreport.DynQualityInfo.decode(e,e.uint32()));break;case 5:i.network_type=e.uint32();break;case 6:i.stream_id=e.string();break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.timestamp_offset_begin&&e.hasOwnProperty("timestamp_offset_begin")&&!(a.isInteger(e.timestamp_offset_begin)||e.timestamp_offset_begin&&a.isInteger(e.timestamp_offset_begin.low)&&a.isInteger(e.timestamp_offset_begin.high)))return"timestamp_offset_begin: integer|Long expected";if(null!=e.timestamp_offset_end&&e.hasOwnProperty("timestamp_offset_end")&&!(a.isInteger(e.timestamp_offset_end)||e.timestamp_offset_end&&a.isInteger(e.timestamp_offset_end.low)&&a.isInteger(e.timestamp_offset_end.high)))return"timestamp_offset_end: integer|Long expected";if(null!=e.server_ip&&e.hasOwnProperty("server_ip")&&!a.isString(e.server_ip))return"server_ip: string expected";if(null!=e.infos&&e.hasOwnProperty("infos")){if(!Array.isArray(e.infos))return"infos: array expected";for(var t=0;t<e.infos.length;++t){var r=c.logreport.DynQualityInfo.verify(e.infos[t]);if(r)return"infos."+r}}return null!=e.network_type&&e.hasOwnProperty("network_type")&&!a.isInteger(e.network_type)?"network_type: integer expected":null!=e.stream_id&&e.hasOwnProperty("stream_id")&&!a.isString(e.stream_id)?"stream_id: string expected":null},e.fromObject=function(e){if(e instanceof c.logreport.DynQualityInfos)return e;var t=new c.logreport.DynQualityInfos;if(null!=e.timestamp_offset_begin&&(a.Long?(t.timestamp_offset_begin=a.Long.fromValue(e.timestamp_offset_begin)).unsigned=!0:"string"==typeof e.timestamp_offset_begin?t.timestamp_offset_begin=parseInt(e.timestamp_offset_begin,10):"number"==typeof e.timestamp_offset_begin?t.timestamp_offset_begin=e.timestamp_offset_begin:"object"==typeof e.timestamp_offset_begin&&(t.timestamp_offset_begin=new a.LongBits(e.timestamp_offset_begin.low>>>0,e.timestamp_offset_begin.high>>>0).toNumber(!0))),null!=e.timestamp_offset_end&&(a.Long?(t.timestamp_offset_end=a.Long.fromValue(e.timestamp_offset_end)).unsigned=!0:"string"==typeof e.timestamp_offset_end?t.timestamp_offset_end=parseInt(e.timestamp_offset_end,10):"number"==typeof e.timestamp_offset_end?t.timestamp_offset_end=e.timestamp_offset_end:"object"==typeof e.timestamp_offset_end&&(t.timestamp_offset_end=new a.LongBits(e.timestamp_offset_end.low>>>0,e.timestamp_offset_end.high>>>0).toNumber(!0))),null!=e.server_ip&&(t.server_ip=String(e.server_ip)),e.infos){if(!Array.isArray(e.infos))throw TypeError(".logreport.DynQualityInfos.infos: array expected");t.infos=[];for(var r=0;r<e.infos.length;++r){if("object"!=typeof e.infos[r])throw TypeError(".logreport.DynQualityInfos.infos: object expected");t.infos[r]=c.logreport.DynQualityInfo.fromObject(e.infos[r])}}return null!=e.network_type&&(t.network_type=e.network_type>>>0),null!=e.stream_id&&(t.stream_id=String(e.stream_id)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.infos=[]),t.defaults){if(a.Long){var i=new a.Long(0,0,!0);r.timestamp_offset_begin=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.timestamp_offset_begin=t.longs===String?"0":0;a.Long?(i=new a.Long(0,0,!0),r.timestamp_offset_end=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.timestamp_offset_end=t.longs===String?"0":0,r.server_ip="",r.network_type=0,r.stream_id=""}if(null!=e.timestamp_offset_begin&&e.hasOwnProperty("timestamp_offset_begin")&&("number"==typeof e.timestamp_offset_begin?r.timestamp_offset_begin=t.longs===String?String(e.timestamp_offset_begin):e.timestamp_offset_begin:r.timestamp_offset_begin=t.longs===String?a.Long.prototype.toString.call(e.timestamp_offset_begin):t.longs===Number?new a.LongBits(e.timestamp_offset_begin.low>>>0,e.timestamp_offset_begin.high>>>0).toNumber(!0):e.timestamp_offset_begin),null!=e.timestamp_offset_end&&e.hasOwnProperty("timestamp_offset_end")&&("number"==typeof e.timestamp_offset_end?r.timestamp_offset_end=t.longs===String?String(e.timestamp_offset_end):e.timestamp_offset_end:r.timestamp_offset_end=t.longs===String?a.Long.prototype.toString.call(e.timestamp_offset_end):t.longs===Number?new a.LongBits(e.timestamp_offset_end.low>>>0,e.timestamp_offset_end.high>>>0).toNumber(!0):e.timestamp_offset_end),null!=e.server_ip&&e.hasOwnProperty("server_ip")&&(r.server_ip=e.server_ip),e.infos&&e.infos.length){r.infos=[];for(var n=0;n<e.infos.length;++n)r.infos[n]=c.logreport.DynQualityInfo.toObject(e.infos[n],t)}return null!=e.network_type&&e.hasOwnProperty("network_type")&&(r.network_type=e.network_type),null!=e.stream_id&&e.hasOwnProperty("stream_id")&&(r.stream_id=e.stream_id),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),i.DynQualityInfo=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.time=a.Long?a.Long.fromBits(0,0,!0):0,e.prototype.plr=0,e.prototype.rtt=0,e.prototype.score=0,e.prototype.sample_time=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.time&&Object.hasOwnProperty.call(e,"time")&&t.uint32(8).uint64(e.time),null!=e.plr&&Object.hasOwnProperty.call(e,"plr")&&t.uint32(16).uint32(e.plr),null!=e.rtt&&Object.hasOwnProperty.call(e,"rtt")&&t.uint32(24).uint32(e.rtt),null!=e.score&&Object.hasOwnProperty.call(e,"score")&&t.uint32(32).uint32(e.score),null!=e.sample_time&&Object.hasOwnProperty.call(e,"sample_time")&&t.uint32(40).uint32(e.sample_time),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new c.logreport.DynQualityInfo;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.time=e.uint64();break;case 2:i.plr=e.uint32();break;case 3:i.rtt=e.uint32();break;case 4:i.score=e.uint32();break;case 5:i.sample_time=e.uint32();break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.time&&e.hasOwnProperty("time")&&!(a.isInteger(e.time)||e.time&&a.isInteger(e.time.low)&&a.isInteger(e.time.high))?"time: integer|Long expected":null!=e.plr&&e.hasOwnProperty("plr")&&!a.isInteger(e.plr)?"plr: integer expected":null!=e.rtt&&e.hasOwnProperty("rtt")&&!a.isInteger(e.rtt)?"rtt: integer expected":null!=e.score&&e.hasOwnProperty("score")&&!a.isInteger(e.score)?"score: integer expected":null!=e.sample_time&&e.hasOwnProperty("sample_time")&&!a.isInteger(e.sample_time)?"sample_time: integer expected":null},e.fromObject=function(e){if(e instanceof c.logreport.DynQualityInfo)return e;var t=new c.logreport.DynQualityInfo;return null!=e.time&&(a.Long?(t.time=a.Long.fromValue(e.time)).unsigned=!0:"string"==typeof e.time?t.time=parseInt(e.time,10):"number"==typeof e.time?t.time=e.time:"object"==typeof e.time&&(t.time=new a.LongBits(e.time.low>>>0,e.time.high>>>0).toNumber(!0))),null!=e.plr&&(t.plr=e.plr>>>0),null!=e.rtt&&(t.rtt=e.rtt>>>0),null!=e.score&&(t.score=e.score>>>0),null!=e.sample_time&&(t.sample_time=e.sample_time>>>0),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if(a.Long){var i=new a.Long(0,0,!0);r.time=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.time=t.longs===String?"0":0;r.plr=0,r.rtt=0,r.score=0,r.sample_time=0}return null!=e.time&&e.hasOwnProperty("time")&&("number"==typeof e.time?r.time=t.longs===String?String(e.time):e.time:r.time=t.longs===String?a.Long.prototype.toString.call(e.time):t.longs===Number?new a.LongBits(e.time.low>>>0,e.time.high>>>0).toNumber(!0):e.time),null!=e.plr&&e.hasOwnProperty("plr")&&(r.plr=e.plr),null!=e.rtt&&e.hasOwnProperty("rtt")&&(r.rtt=e.rtt),null!=e.score&&e.hasOwnProperty("score")&&(r.score=e.score),null!=e.sample_time&&e.hasOwnProperty("sample_time")&&(r.sample_time=e.sample_time),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),i),e.exports=c},5515:function(e){e.exports=function e(t,r,i){function n(s,a){if(!r[s]){if(!t[s]){if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[s]={exports:{}};t[s][0].call(l.exports,(function(e){return n(t[s][1][e]||e)}),l,l.exports,e,t,r,i)}return r[s].exports}for(var o=void 0,s=0;s<i.length;s++)n(i[s]);return n}({1:[function(e,t,r){"use strict";var i=(0,e("./adapter_factory.js").adapterFactory)({window:window});t.exports=i},{"./adapter_factory.js":2}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.adapterFactory=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).window,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},r=i.log,l=i.detectBrowser(e),u={browserDetails:l,commonShim:c,extractVersion:i.extractVersion,disableLog:i.disableLog,disableWarnings:i.disableWarnings};switch(l.browser){case"chrome":if(!n||!n.shimPeerConnection||!t.shimChrome)return r("Chrome shim is not included in this adapter release."),u;r("adapter.js shimming chrome."),u.browserShim=n,n.shimGetUserMedia(e),n.shimMediaStream(e),n.shimPeerConnection(e),n.shimOnTrack(e),n.shimAddTrackRemoveTrack(e),n.shimGetSendersWithDtmf(e),n.shimGetStats(e),n.shimSenderReceiverGetStats(e),n.fixNegotiationNeeded(e),c.shimRTCIceCandidate(e),c.shimConnectionState(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e),c.removeAllowExtmapMixed(e);break;case"firefox":if(!s||!s.shimPeerConnection||!t.shimFirefox)return r("Firefox shim is not included in this adapter release."),u;r("adapter.js shimming firefox."),u.browserShim=s,s.shimGetUserMedia(e),s.shimPeerConnection(e),s.shimOnTrack(e),s.shimRemoveStream(e),s.shimSenderGetStats(e),s.shimReceiverGetStats(e),s.shimRTCDataChannel(e),c.shimRTCIceCandidate(e),c.shimConnectionState(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e);break;case"edge":if(!o||!o.shimPeerConnection||!t.shimEdge)return r("MS edge shim is not included in this adapter release."),u;r("adapter.js shimming edge."),u.browserShim=o,o.shimGetUserMedia(e),o.shimGetDisplayMedia(e),o.shimPeerConnection(e),o.shimReplaceTrack(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e);break;case"safari":if(!a||!t.shimSafari)return r("Safari shim is not included in this adapter release."),u;r("adapter.js shimming safari."),u.browserShim=a,a.shimRTCIceServerUrls(e),a.shimCreateOfferLegacy(e),a.shimCallbacksAPI(e),a.shimLocalStreamsAPI(e),a.shimRemoteStreamsAPI(e),a.shimTrackEventTransceiver(e),a.shimGetUserMedia(e),c.shimRTCIceCandidate(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e),c.removeAllowExtmapMixed(e);break;default:r("Unsupported browser!")}return u};var i=l(e("./utils")),n=l(e("./chrome/chrome_shim")),o=l(e("./edge/edge_shim")),s=l(e("./firefox/firefox_shim")),a=l(e("./safari/safari_shim")),c=l(e("./common_shim"));function l(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}});var o=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}}),r.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},r.shimOnTrack=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var r=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(i){var n;n=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find((function(e){return e.track&&e.track.id===i.track.id})):{track:i.track};var o=new Event("track");o.track=i.track,o.receiver=n,o.transceiver={receiver:n},o.streams=[t.stream],r.dispatchEvent(o)})),t.stream.getTracks().forEach((function(i){var n;n=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find((function(e){return e.track&&e.track.id===i.id})):{track:i};var o=new Event("track");o.track=i,o.receiver=n,o.transceiver={receiver:n},o.streams=[t.stream],r.dispatchEvent(o)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else s.wrapPeerConnectionEvent(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}))},r.shimGetSendersWithDtmf=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){var n=r.apply(this,arguments);return n||(n=t(this,e),this._senders.push(n)),n};var n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){n.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var o=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach((function(e){r._senders.push(t(r,e))}))};var s=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],s.apply(this,[e]),e.getTracks().forEach((function(e){var r=t._senders.find((function(t){return t.track===e}));r&&t._senders.splice(t._senders.indexOf(r),1)}))}}else if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},r.shimGetStats=function(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,r,i){var n=this,o=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof arguments[0]))return t.apply(this,[]);var s=function(e){var t={};return e.result().forEach((function(e){var r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){r[t]=e.stat(t)})),t[r.id]=r})),t},a=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};if(arguments.length>=2){var c=function(e){o[1](a(s(e)))};return t.apply(this,[c,arguments[0]])}return new Promise((function(e,r){t.apply(n,[function(t){e(a(s(t)))},r])})).then(r,i)}}},r.shimSenderReceiverGetStats=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return s.filterStats(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var n=e.RTCPeerConnection.prototype.getReceivers;n&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=n.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),s.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return s.filterStats(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t=arguments[0],r=void 0,i=void 0,n=void 0;return this.getSenders().forEach((function(e){e.track===t&&(r?n=!0:r=e)})),this.getReceivers().forEach((function(e){return e.track===t&&(i?n=!0:i=e),e.track===t})),n||r&&i?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():i?i.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return o.apply(this,arguments)}}}},r.shimAddTrackRemoveTrackWithNative=a,r.shimAddTrackRemoveTrack=function(e){if(e.RTCPeerConnection){var t=s.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return a(e);var r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=r.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var r=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(r.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}i.apply(this,[t])};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},n.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,r){var i=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var n=[].slice.call(arguments,1);if(1!==n.length||!n[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((function(e){return e.track===t})))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var o=this._streams[r.id];if(o)o.addTrack(t),Promise.resolve().then((function(){i.dispatchEvent(new Event("negotiationneeded"))}));else{var s=new e.MediaStream([t]);this._streams[r.id]=s,this._reverseStreams[s.id]=r,this.addStream(s)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?r.apply(this,[function(r){var i=l(e,r);t[0].apply(null,[i])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):r.apply(this,arguments).then((function(t){return l(e,t)}))}}));var o=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=u(this,arguments[0]),o.apply(this,arguments)):o.apply(this,arguments)};var c=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=c.get.apply(this);return""===e.type?e:l(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var r=void 0;Object.keys(this._streams).forEach((function(i){t._streams[i].getTracks().find((function(t){return e.track===t}))&&(r=t._streams[i])})),r&&(1===r.getTracks().length?this.removeStream(this._reverseStreams[r.id]):r.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function l(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var i=e._reverseStreams[t],n=e._streams[i.id];r=r.replace(new RegExp(n.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:r})}function u(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var i=e._reverseStreams[t],n=e._streams[i.id];r=r.replace(new RegExp(i.id,"g"),n.id)})),new RTCSessionDescription({type:t.type,sdp:r})}},r.shimPeerConnection=function(e){if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection){["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}}));var t=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},r.fixNegotiationNeeded=function(e){s.wrapPeerConnectionEvent(e,"negotiationneeded",(function(e){if("stable"===e.target.signalingState)return e}))};var s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils.js"));function a(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var i=t.apply(this,arguments);return this._shimmedLocalStreams[r.id]?-1===this._shimmedLocalStreams[r.id].indexOf(i)&&this._shimmedLocalStreams[r.id].push(i):this._shimmedLocalStreams[r.id]=[r,i],i};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var i=this.getSenders();r.apply(this,arguments);var n=this.getSenders().filter((function(e){return-1===i.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(n)};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],i.apply(this,arguments)};var n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(r){var i=t._shimmedLocalStreams[r].indexOf(e);-1!==i&&t._shimmedLocalStreams[r].splice(i,1),1===t._shimmedLocalStreams[r].length&&delete t._shimmedLocalStreams[r]})),n.apply(this,arguments)}}},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then((function(t){var i=r.video&&r.video.width,n=r.video&&r.video.height,o=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},i&&(r.video.mandatory.maxWidth=i),n&&(r.video.mandatory.maxHeight=n),e.navigator.mediaDevices.getUserMedia(r)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},{}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices){var r=n.detectBrowser(e),s=function(e){if("object"!==(void 0===e?"undefined":i(e))||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(r){if("require"!==r&&"advanced"!==r&&"mediaSource"!==r){var n="object"===i(e[r])?e[r]:{ideal:e[r]};void 0!==n.exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact);var o=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==n.ideal){t.optional=t.optional||[];var s={};"number"==typeof n.ideal?(s[o("min",r)]=n.ideal,t.optional.push(s),(s={})[o("max",r)]=n.ideal,t.optional.push(s)):(s[o("",r)]=n.ideal,t.optional.push(s))}void 0!==n.exact&&"number"!=typeof n.exact?(t.mandatory=t.mandatory||{},t.mandatory[o("",r)]=n.exact):["min","max"].forEach((function(e){void 0!==n[e]&&(t.mandatory=t.mandatory||{},t.mandatory[o(e,r)]=n[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},a=function(e,n){if(r.version>=61)return n(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===i(e.audio)){var a=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};a((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),a(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=s(e.audio)}if(e&&"object"===i(e.video)){var c=e.video.facingMode;c=c&&("object"===(void 0===c?"undefined":i(c))?c:{ideal:c});var l=r.version<66;if(c&&("user"===c.exact||"environment"===c.exact||"user"===c.ideal||"environment"===c.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||l)){delete e.video.facingMode;var u=void 0;if("environment"===c.exact||"environment"===c.ideal?u=["back","rear"]:"user"!==c.exact&&"user"!==c.ideal||(u=["front"]),u)return t.mediaDevices.enumerateDevices().then((function(t){var r=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return u.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!r&&t.length&&u.includes("back")&&(r=t[t.length-1]),r&&(e.video.deviceId=c.exact?{exact:r.deviceId}:{ideal:r.deviceId}),e.video=s(e.video),o("chrome: "+JSON.stringify(e)),n(e)}))}e.video=s(e.video)}return o("chrome: "+JSON.stringify(e)),n(e)},c=function(e){return r.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(t.getUserMedia=function(e,r,i){a(e,(function(e){t.webkitGetUserMedia(e,r,(function(e){i&&i(c(e))}))}))}.bind(t),t.mediaDevices.getUserMedia){var l=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return a(e,(function(e){return l(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(c(e))}))}))}}}};var n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils.js")),o=n.log},{"../utils.js":15}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimRTCIceCandidate=function(e){if(!(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var r=new t(e),n=o.default.parseCandidate(e.candidate),s=Object.assign(r,n);return s.toJSON=function(){return{candidate:s.candidate,sdpMid:s.sdpMid,sdpMLineIndex:s.sdpMLineIndex,usernameFragment:s.usernameFragment}},s}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,s.wrapPeerConnectionEvent(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}},r.shimMaxMessageSize=function(e){if(!e.RTCSctpTransport&&e.RTCPeerConnection){var t=s.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var r=function(e){if(!e||!e.sdp)return!1;var t=o.default.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=o.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))},i=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var r=parseInt(t[1],10);return r!=r?-1:r},n=function(e){var r=65536;return"firefox"===t.browser&&(r=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),r},a=function(e,r){var i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);var n=o.default.matchPrefix(e.sdp,"a=max-message-size:");return n.length>0?i=parseInt(n[0].substr(19),10):"firefox"===t.browser&&-1!==r&&(i=2147483637),i},c=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,r(arguments[0])){var e=i(arguments[0]),t=n(e),o=a(arguments[0],e),s=void 0;s=0===t&&0===o?Number.POSITIVE_INFINITY:0===t||0===o?Math.max(t,o):Math.min(t,o);var l={};Object.defineProperty(l,"maxMessageSize",{get:function(){return s}}),this._sctp=l}return c.apply(this,arguments)}}},r.shimSendThrowTypeError=function(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return r(e,this),e},s.wrapPeerConnectionEvent(e,"datachannel",(function(e){return r(e.channel,e.target),e}))}function r(e,t){var r=e.send;e.send=function(){var i=arguments[0],n=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&n>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return r.apply(e,arguments)}}},r.shimConnectionState=function(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var r=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var r=new Event("connectionstatechange",e);t.dispatchEvent(r)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}}))}},r.removeAllowExtmapMixed=function(e){if(e.RTCPeerConnection){var t=s.detectBrowser(e);if(!("chrome"===t.browser&&t.version>=71)){var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n")),r.apply(this,arguments)}}}};var n,o=(n=e("sdp"))&&n.__esModule?n:{default:n},s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("./utils"))},{"./utils":15,sdp:17}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var i=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}});var n=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return n.shimGetDisplayMedia}}),r.shimPeerConnection=function(e){var t=s.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var r=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){r.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var i=(0,c.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,a.filterIceServers)(e.iceServers,t.version),s.log("ICE servers after filtering:",e.iceServers)),new i(e)},e.RTCPeerConnection.prototype=i.prototype},r.shimReplaceTrack=function(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)};var o,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils")),a=e("./filtericeservers"),c=(o=e("rtcpeerconnection-shim"))&&o.__esModule?o:{default:o}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.filterIceServers=function(e,t){var r=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&i.deprecated("RTCIceServer.url","RTCIceServer.urls");var n="string"==typeof t;return n&&(t=[t]),t=t.filter((function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!r?(r=!0,!0):t&&!r})),delete e.url,e.urls=n?t[0]:t,!!t.length}}))};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils"))},{"../utils":15}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}},{}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetUserMedia=function(e){var t=e&&e.navigator,r=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return r(e).catch((function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))}))}}},{}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}});var o=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}}),r.shimOnTrack=function(e){"object"===(void 0===e?"undefined":i(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},r.shimPeerConnection=function(e){var t=s.detectBrowser(e);if("object"===(void 0===e?"undefined":i(e))&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}}));var r=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,r,i){return o.apply(this,[e||null]).then((function(e){if(t.version<53&&!r)try{e.forEach((function(e){e.type=n[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,r){e.set(r,Object.assign({},t,{type:n[t.type]||t.type}))}))}return e})).then(r,i)}}},r.shimSenderGetStats=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},r.shimReceiverGetStats=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r}),s.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},r.shimRemoveStream=function(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;s.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(r){r.track&&e.getTracks().includes(r.track)&&t.removeTrack(r)}))})},r.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)};var s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){var i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return!0===r.video?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)})}},{}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimGetUserMedia=function(e){var t=n.detectBrowser(e),r=e&&e.navigator,o=e&&e.MediaStreamTrack;if(r.getUserMedia=function(e,t,i){n.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){var s=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},a=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(e){return"object"===(void 0===e?"undefined":i(e))&&"object"===i(e.audio)&&(e=JSON.parse(JSON.stringify(e)),s(e.audio,"autoGainControl","mozAutoGainControl"),s(e.audio,"noiseSuppression","mozNoiseSuppression")),a(e)},o&&o.prototype.getSettings){var c=o.prototype.getSettings;o.prototype.getSettings=function(){var e=c.apply(this,arguments);return s(e,"mozAutoGainControl","autoGainControl"),s(e,"mozNoiseSuppression","noiseSuppression"),e}}if(o&&o.prototype.applyConstraints){var l=o.prototype.applyConstraints;o.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===(void 0===e?"undefined":i(e))&&(e=JSON.parse(JSON.stringify(e)),s(e,"autoGainControl","mozAutoGainControl"),s(e,"noiseSuppression","mozNoiseSuppression")),l.apply(this,[e])}}}};var n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils"))},{"../utils":15}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimLocalStreamsAPI=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getTracks().forEach((function(i){return t.call(r,i,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e,r){return r&&(this._localStreams?this._localStreams.includes(r)||this._localStreams.push(r):this._localStreams=[r]),t.call(this,e,r)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var r=this._localStreams.indexOf(e);if(-1!==r){this._localStreams.splice(r,1);var i=e.getTracks();this.getSenders().forEach((function(e){i.includes(e.track)&&t.removeTrack(e)}))}})}},r.shimRemoteStreamsAPI=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var r=new Event("addstream");r.stream=e,t.dispatchEvent(r)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var r=new Event("addstream");r.stream=t,e.dispatchEvent(r)}}))}),t.apply(e,arguments)}}},r.shimCallbacksAPI=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,r=t.createOffer,n=t.createAnswer,o=t.setLocalDescription,s=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){var i=arguments.length>=2?arguments[2]:arguments[0],n=r.apply(this,[i]);return t?(n.then(e,t),Promise.resolve()):n},t.createAnswer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i};var c=function(e,t,r){var i=o.apply(this,[e]);return r?(i.then(t,r),Promise.resolve()):i};t.setLocalDescription=c,c=function(e,t,r){var i=s.apply(this,[e]);return r?(i.then(t,r),Promise.resolve()):i},t.setRemoteDescription=c,c=function(e,t,r){var i=a.apply(this,[e]);return r?(i.then(t,r),Promise.resolve()):i},t.addIceCandidate=c}},r.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var r=t.mediaDevices,i=r.getUserMedia.bind(r);t.mediaDevices.getUserMedia=function(e){return i(o(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,r,i){t.mediaDevices.getUserMedia(e).then(r,i)}.bind(t))},r.shimConstraints=o,r.shimRTCIceServerUrls=function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,r){if(e&&e.iceServers){for(var i=[],o=0;o<e.iceServers.length;o++){var s=e.iceServers[o];!s.hasOwnProperty("urls")&&s.hasOwnProperty("url")?(n.deprecated("RTCIceServer.url","RTCIceServer.urls"),(s=JSON.parse(JSON.stringify(s))).urls=s.url,delete s.url,i.push(s)):i.push(e.iceServers[o])}e.iceServers=i}return new t(e,r)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},r.shimTrackEventTransceiver=function(e){"object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&"receiver"in e.RTCTrackEvent.prototype&&!e.RTCTransceiver&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},r.shimCreateOfferLegacy=function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var r=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveAudio||r||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var i=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&i?"sendrecv"===i.direction?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":"recvonly"===i.direction&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):!0!==e.offerToReceiveVideo||i||this.addTransceiver("video")}return t.apply(this,arguments)}};var n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils"));function o(e){return e&&void 0!==e.video?Object.assign({},e,{video:n.compactObject(e.video)}):e}},{"../utils":15}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.extractVersion=s,r.wrapPeerConnectionEvent=function(e,t,r){if(e.RTCPeerConnection){var i=e.RTCPeerConnection.prototype,n=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return n.apply(this,arguments);var o=function(e){var t=r(e);t&&i(t)};return this._eventMap=this._eventMap||{},this._eventMap[i]=o,n.apply(this,[e,o])};var o=i.removeEventListener;i.removeEventListener=function(e,r){if(e!==t||!this._eventMap||!this._eventMap[r])return o.apply(this,arguments);var i=this._eventMap[r];return delete this._eventMap[r],o.apply(this,[e,i])},Object.defineProperty(i,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}},r.disableLog=function(e){return"boolean"!=typeof e?new Error("Argument type: "+(void 0===e?"undefined":i(e))+". Please use a boolean."):(n=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},r.disableWarnings=function(e){return"boolean"!=typeof e?new Error("Argument type: "+(void 0===e?"undefined":i(e))+". Please use a boolean."):(o=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},r.log=function(){if("object"===("undefined"==typeof window?"undefined":i(window))){if(n)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},r.deprecated=function(e,t){o&&console.warn(e+" is deprecated, please use "+t+" instead.")},r.detectBrowser=function(e){var t=e.navigator,r={browser:null,version:null};if(void 0===e||!e.navigator)return r.browser="Not a browser.",r;if(t.mozGetUserMedia)r.browser="firefox",r.version=s(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)r.browser="chrome",r.version=s(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))r.browser="edge",r.version=s(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return r.browser="Not a supported browser.",r;r.browser="safari",r.version=s(t.userAgent,/AppleWebKit\/(\d+)\./,1)}return r},r.compactObject=function e(t){return"object"!==(void 0===t?"undefined":i(t))?t:Object.keys(t).reduce((function(r,n){var o="object"===i(t[n]),s=o?e(t[n]):t[n],a=o&&!Object.keys(s).length;return void 0===s||a?r:Object.assign(r,function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},n,s))}),{})},r.walkStats=a,r.filterStats=function(e,t,r){var i=r?"outbound-rtp":"inbound-rtp",n=new Map;if(null===t)return n;var o=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((function(t){e.forEach((function(r){r.type===i&&r.trackId===t.id&&a(e,r,n)}))})),n};var n=!0,o=!0;function s(e,t,r){var i=e.match(t);return i&&i.length>=r&&parseInt(i[r],10)}function a(e,t,r){t&&!r.has(t.id)&&(r.set(t.id,t),Object.keys(t).forEach((function(i){i.endsWith("Id")?a(e,e.get(t[i]),r):i.endsWith("Ids")&&t[i].forEach((function(t){a(e,e.get(t),r)}))})))}},{}],16:[function(e,t,r){"use strict";var i=e("sdp");function n(e,t,r,n,o){var s=i.writeRtpDescription(e.kind,t);if(s+=i.writeIceParameters(e.iceGatherer.getLocalParameters()),s+=i.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":o||"active"),s+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?s+="a=sendrecv\r\n":e.rtpSender?s+="a=sendonly\r\n":e.rtpReceiver?s+="a=recvonly\r\n":s+="a=inactive\r\n",e.rtpSender){var a=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=a;var c="msid:"+(n?n.id:"-")+" "+a+"\r\n";s+="a="+c,s+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,s+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return s+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+i.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+i.localCName+"\r\n"),s}function o(e,t){var r={codecs:[],headerExtensions:[],fecMechanisms:[]},i=function(e,t){e=parseInt(e,10);for(var r=0;r<t.length;r++)if(t[r].payloadType===e||t[r].preferredPayloadType===e)return t[r]},n=function(e,t,r,n){var o=i(e.parameters.apt,r),s=i(t.parameters.apt,n);return o&&s&&o.name.toLowerCase()===s.name.toLowerCase()};return e.codecs.forEach((function(i){for(var o=0;o<t.codecs.length;o++){var s=t.codecs[o];if(i.name.toLowerCase()===s.name.toLowerCase()&&i.clockRate===s.clockRate){if("rtx"===i.name.toLowerCase()&&i.parameters&&s.parameters.apt&&!n(i,s,e.codecs,t.codecs))continue;(s=JSON.parse(JSON.stringify(s))).numChannels=Math.min(i.numChannels,s.numChannels),r.codecs.push(s),s.rtcpFeedback=s.rtcpFeedback.filter((function(e){for(var t=0;t<i.rtcpFeedback.length;t++)if(i.rtcpFeedback[t].type===e.type&&i.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var i=0;i<t.headerExtensions.length;i++){var n=t.headerExtensions[i];if(e.uri===n.uri){r.headerExtensions.push(n);break}}})),r}function s(e,t,r){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)}function a(e,t){var r=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return r||e.addRemoteCandidate(t),!r}function c(e,t){var r=new Error(t);return r.name=e,r.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],r}t.exports=function(e,t){function r(t,r){r.addTrack(t),r.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function l(t,r,i,n){var o=new Event("track");o.track=r,o.receiver=i,o.transceiver={receiver:i},o.streams=n,e.setTimeout((function(){t._dispatchEvent("track",o)}))}var u=function(r){var n=this,o=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){n[e]=o[e].bind(o)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",r=JSON.parse(JSON.stringify(r||{})),this.usingBundle="max-bundle"===r.bundlePolicy,"negotiate"===r.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(r.rtcpMuxPolicy||(r.rtcpMuxPolicy="require"),r.iceTransportPolicy){case"all":case"relay":break;default:r.iceTransportPolicy="all"}switch(r.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:r.bundlePolicy="balanced"}if(r.iceServers=function(e,t){var r=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var i=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var n="string"==typeof i;return n&&(i=[i]),i=i.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||r?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(r=!0,!0)})),delete e.url,e.urls=n?i[0]:i,!!i.length}}))}(r.iceServers||[],t),this._iceGatherers=[],r.iceCandidatePoolSize)for(var s=r.iceCandidatePoolSize;s>0;s--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:r.iceServers,gatherPolicy:r.iceTransportPolicy}));else r.iceCandidatePoolSize=0;this._config=r,this.transceivers=[],this._sdpSessionId=i.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(u.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(u.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),u.prototype.onicecandidate=null,u.prototype.onaddstream=null,u.prototype.ontrack=null,u.prototype.onremovestream=null,u.prototype.onsignalingstatechange=null,u.prototype.oniceconnectionstatechange=null,u.prototype.onconnectionstatechange=null,u.prototype.onicegatheringstatechange=null,u.prototype.onnegotiationneeded=null,u.prototype.ondatachannel=null,u.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},u.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},u.prototype.getConfiguration=function(){return this._config},u.prototype.getLocalStreams=function(){return this.localStreams},u.prototype.getRemoteStreams=function(){return this.remoteStreams},u.prototype._createTransceiver=function(e,t){var r=this.transceivers.length>0,i={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&r)i.iceTransport=this.transceivers[0].iceTransport,i.dtlsTransport=this.transceivers[0].dtlsTransport;else{var n=this._createIceAndDtlsTransports();i.iceTransport=n.iceTransport,i.dtlsTransport=n.dtlsTransport}return t||this.transceivers.push(i),i},u.prototype.addTrack=function(t,r){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var i;if(this.transceivers.find((function(e){return e.track===t})))throw c("InvalidAccessError","Track already exists.");for(var n=0;n<this.transceivers.length;n++)this.transceivers[n].track||this.transceivers[n].kind!==t.kind||(i=this.transceivers[n]);return i||(i=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(r)&&this.localStreams.push(r),i.track=t,i.stream=r,i.rtpSender=new e.RTCRtpSender(t,i.dtlsTransport),i.rtpSender},u.prototype.addStream=function(e){var r=this;if(t>=15025)e.getTracks().forEach((function(t){r.addTrack(t,e)}));else{var i=e.clone();e.getTracks().forEach((function(e,t){var r=i.getTracks()[t];e.addEventListener("enabled",(function(e){r.enabled=e.enabled}))})),i.getTracks().forEach((function(e){r.addTrack(e,i)}))}},u.prototype.removeTrack=function(t){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var r=this.transceivers.find((function(e){return e.rtpSender===t}));if(!r)throw c("InvalidAccessError","Sender was not created by this connection.");var i=r.stream;r.rtpSender.stop(),r.rtpSender=null,r.track=null,r.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(i)&&this.localStreams.indexOf(i)>-1&&this.localStreams.splice(this.localStreams.indexOf(i),1),this._maybeFireNegotiationNeeded()},u.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var r=t.getSenders().find((function(t){return t.track===e}));r&&t.removeTrack(r)}))},u.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},u.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},u.prototype._createIceGatherer=function(t,r){var i=this;if(r&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var n=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(n,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var r=!e.candidate||0===Object.keys(e.candidate).length;n.state=r?"completed":"gathering",null!==i.transceivers[t].bufferedCandidateEvents&&i.transceivers[t].bufferedCandidateEvents.push(e)},n.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),n},u.prototype._gather=function(t,r){var n=this,o=this.transceivers[r].iceGatherer;if(!o.onlocalcandidate){var s=this.transceivers[r].bufferedCandidateEvents;this.transceivers[r].bufferedCandidateEvents=null,o.removeEventListener("localcandidate",this.transceivers[r].bufferCandidates),o.onlocalcandidate=function(e){if(!(n.usingBundle&&r>0)){var s=new Event("icecandidate");s.candidate={sdpMid:t,sdpMLineIndex:r};var a=e.candidate,c=!a||0===Object.keys(a).length;if(c)"new"!==o.state&&"gathering"!==o.state||(o.state="completed");else{"new"===o.state&&(o.state="gathering"),a.component=1,a.ufrag=o.getLocalParameters().usernameFragment;var l=i.writeCandidate(a);s.candidate=Object.assign(s.candidate,i.parseCandidate(l)),s.candidate.candidate=l,s.candidate.toJSON=function(){return{candidate:s.candidate.candidate,sdpMid:s.candidate.sdpMid,sdpMLineIndex:s.candidate.sdpMLineIndex,usernameFragment:s.candidate.usernameFragment}}}var u=i.getMediaSections(n._localDescription.sdp);u[s.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+s.candidate.candidate+"\r\n",n._localDescription.sdp=i.getDescription(n._localDescription.sdp)+u.join("");var d=n.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==n.iceGatheringState&&(n.iceGatheringState="gathering",n._emitGatheringStateChange()),c||n._dispatchEvent("icecandidate",s),d&&(n._dispatchEvent("icecandidate",new Event("icecandidate")),n.iceGatheringState="complete",n._emitGatheringStateChange())}},e.setTimeout((function(){s.forEach((function(e){o.onlocalcandidate(e)}))}),0)}},u.prototype._createIceAndDtlsTransports=function(){var t=this,r=new e.RTCIceTransport(null);r.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var i=new e.RTCDtlsTransport(r);return i.ondtlsstatechange=function(){t._updateConnectionState()},i.onerror=function(){Object.defineProperty(i,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:r,dtlsTransport:i}},u.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var r=this.transceivers[e].iceTransport;r&&(delete r.onicestatechange,delete this.transceivers[e].iceTransport);var i=this.transceivers[e].dtlsTransport;i&&(delete i.ondtlsstatechange,delete i.onerror,delete this.transceivers[e].dtlsTransport)},u.prototype._transceive=function(e,r,n){var s=o(e.localCapabilities,e.remoteCapabilities);r&&e.rtpSender&&(s.encodings=e.sendEncodingParameters,s.rtcp={cname:i.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(s.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(s)),n&&e.rtpReceiver&&s.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?s.encodings=e.recvEncodingParameters:s.encodings=[{}],s.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(s.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(s.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(s))},u.prototype.setLocalDescription=function(e){var t,r,n=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(c("TypeError",'Unsupported type "'+e.type+'"'));if(!s("setLocalDescription",e.type,n.signalingState)||n._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+e.type+" in state "+n.signalingState));if("offer"===e.type)t=i.splitSections(e.sdp),r=t.shift(),t.forEach((function(e,t){var r=i.parseRtpParameters(e);n.transceivers[t].localCapabilities=r})),n.transceivers.forEach((function(e,t){n._gather(e.mid,t)}));else if("answer"===e.type){t=i.splitSections(n._remoteDescription.sdp),r=t.shift();var a=i.matchPrefix(r,"a=ice-lite").length>0;t.forEach((function(e,t){var s=n.transceivers[t],c=s.iceGatherer,l=s.iceTransport,u=s.dtlsTransport,d=s.localCapabilities,h=s.remoteCapabilities;if(!(i.isRejected(e)&&0===i.matchPrefix(e,"a=bundle-only").length||s.rejected)){var p=i.getIceParameters(e,r),f=i.getDtlsParameters(e,r);a&&(f.role="server"),n.usingBundle&&0!==t||(n._gather(s.mid,t),"new"===l.state&&l.start(c,p,a?"controlling":"controlled"),"new"===u.state&&u.start(f));var g=o(d,h);n._transceive(s,g.codecs.length>0,!1)}}))}return n._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?n._updateSignalingState("have-local-offer"):n._updateSignalingState("stable"),Promise.resolve()},u.prototype.setRemoteDescription=function(n){var u=this;if(-1===["offer","answer"].indexOf(n.type))return Promise.reject(c("TypeError",'Unsupported type "'+n.type+'"'));if(!s("setRemoteDescription",n.type,u.signalingState)||u._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+n.type+" in state "+u.signalingState));var d={};u.remoteStreams.forEach((function(e){d[e.id]=e}));var h=[],p=i.splitSections(n.sdp),f=p.shift(),g=i.matchPrefix(f,"a=ice-lite").length>0,m=i.matchPrefix(f,"a=group:BUNDLE ").length>0;u.usingBundle=m;var _=i.matchPrefix(f,"a=ice-options:")[0];return u.canTrickleIceCandidates=!!_&&_.substr(14).split(" ").indexOf("trickle")>=0,p.forEach((function(s,c){var l=i.splitLines(s),p=i.getKind(s),_=i.isRejected(s)&&0===i.matchPrefix(s,"a=bundle-only").length,v=l[0].substr(2).split(" ")[2],E=i.getDirection(s,f),A=i.parseMsid(s),y=i.getMid(s)||i.generateIdentifier();if(_||"application"===p&&("DTLS/SCTP"===v||"UDP/DTLS/SCTP"===v))u.transceivers[c]={mid:y,kind:p,protocol:v,rejected:!0};else{var S,C,T,b,I,R,w,k,O;!_&&u.transceivers[c]&&u.transceivers[c].rejected&&(u.transceivers[c]=u._createTransceiver(p,!0));var N,L,P=i.parseRtpParameters(s);_||(N=i.getIceParameters(s,f),(L=i.getDtlsParameters(s,f)).role="client"),w=i.parseRtpEncodingParameters(s);var D=i.parseRtcpParameters(s),M=i.matchPrefix(s,"a=end-of-candidates",f).length>0,x=i.matchPrefix(s,"a=candidate:").map((function(e){return i.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===n.type||"answer"===n.type)&&!_&&m&&c>0&&u.transceivers[c]&&(u._disposeIceAndDtlsTransports(c),u.transceivers[c].iceGatherer=u.transceivers[0].iceGatherer,u.transceivers[c].iceTransport=u.transceivers[0].iceTransport,u.transceivers[c].dtlsTransport=u.transceivers[0].dtlsTransport,u.transceivers[c].rtpSender&&u.transceivers[c].rtpSender.setTransport(u.transceivers[0].dtlsTransport),u.transceivers[c].rtpReceiver&&u.transceivers[c].rtpReceiver.setTransport(u.transceivers[0].dtlsTransport)),"offer"!==n.type||_)"answer"!==n.type||_||(C=(S=u.transceivers[c]).iceGatherer,T=S.iceTransport,b=S.dtlsTransport,I=S.rtpReceiver,R=S.sendEncodingParameters,k=S.localCapabilities,u.transceivers[c].recvEncodingParameters=w,u.transceivers[c].remoteCapabilities=P,u.transceivers[c].rtcpParameters=D,x.length&&"new"===T.state&&(!g&&!M||m&&0!==c?x.forEach((function(e){a(S.iceTransport,e)})):T.setRemoteCandidates(x)),m&&0!==c||("new"===T.state&&T.start(C,N,"controlling"),"new"===b.state&&b.start(L)),!o(S.localCapabilities,S.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&S.sendEncodingParameters[0].rtx&&delete S.sendEncodingParameters[0].rtx,u._transceive(S,"sendrecv"===E||"recvonly"===E,"sendrecv"===E||"sendonly"===E),!I||"sendrecv"!==E&&"sendonly"!==E?delete S.rtpReceiver:(O=I.track,A?(d[A.stream]||(d[A.stream]=new e.MediaStream),r(O,d[A.stream]),h.push([O,I,d[A.stream]])):(d.default||(d.default=new e.MediaStream),r(O,d.default),h.push([O,I,d.default]))));else{(S=u.transceivers[c]||u._createTransceiver(p)).mid=y,S.iceGatherer||(S.iceGatherer=u._createIceGatherer(c,m)),x.length&&"new"===S.iceTransport.state&&(!M||m&&0!==c?x.forEach((function(e){a(S.iceTransport,e)})):S.iceTransport.setRemoteCandidates(x)),k=e.RTCRtpReceiver.getCapabilities(p),t<15019&&(k.codecs=k.codecs.filter((function(e){return"rtx"!==e.name}))),R=S.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var B,U=!1;"sendrecv"===E||"sendonly"===E?(U=!S.rtpReceiver,I=S.rtpReceiver||new e.RTCRtpReceiver(S.dtlsTransport,p),U&&(O=I.track,A&&"-"===A.stream||(A?(d[A.stream]||(d[A.stream]=new e.MediaStream,Object.defineProperty(d[A.stream],"id",{get:function(){return A.stream}})),Object.defineProperty(O,"id",{get:function(){return A.track}}),B=d[A.stream]):(d.default||(d.default=new e.MediaStream),B=d.default)),B&&(r(O,B),S.associatedRemoteMediaStreams.push(B)),h.push([O,I,B]))):S.rtpReceiver&&S.rtpReceiver.track&&(S.associatedRemoteMediaStreams.forEach((function(t){var r=t.getTracks().find((function(e){return e.id===S.rtpReceiver.track.id}));r&&function(t,r){r.removeTrack(t),r.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(r,t)})),S.associatedRemoteMediaStreams=[]),S.localCapabilities=k,S.remoteCapabilities=P,S.rtpReceiver=I,S.rtcpParameters=D,S.sendEncodingParameters=R,S.recvEncodingParameters=w,u._transceive(u.transceivers[c],!1,U)}}})),void 0===u._dtlsRole&&(u._dtlsRole="offer"===n.type?"active":"passive"),u._remoteDescription={type:n.type,sdp:n.sdp},"offer"===n.type?u._updateSignalingState("have-remote-offer"):u._updateSignalingState("stable"),Object.keys(d).forEach((function(t){var r=d[t];if(r.getTracks().length){if(-1===u.remoteStreams.indexOf(r)){u.remoteStreams.push(r);var i=new Event("addstream");i.stream=r,e.setTimeout((function(){u._dispatchEvent("addstream",i)}))}h.forEach((function(e){var t=e[0],i=e[1];r.id===e[2].id&&l(u,t,i,[r])}))}})),h.forEach((function(e){e[2]||l(u,e[0],e[1],[])})),e.setTimeout((function(){u&&u.transceivers&&u.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},u.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},u.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},u.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},u.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",r)}},u.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var r=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",r)}},u.prototype.createOffer=function(){var r=this;if(r._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var o=r.transceivers.filter((function(e){return"audio"===e.kind})).length,s=r.transceivers.filter((function(e){return"video"===e.kind})).length,a=arguments[0];if(a){if(a.mandatory||a.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==a.offerToReceiveAudio&&(o=!0===a.offerToReceiveAudio?1:!1===a.offerToReceiveAudio?0:a.offerToReceiveAudio),void 0!==a.offerToReceiveVideo&&(s=!0===a.offerToReceiveVideo?1:!1===a.offerToReceiveVideo?0:a.offerToReceiveVideo)}for(r.transceivers.forEach((function(e){"audio"===e.kind?--o<0&&(e.wantReceive=!1):"video"===e.kind&&--s<0&&(e.wantReceive=!1)}));o>0||s>0;)o>0&&(r._createTransceiver("audio"),o--),s>0&&(r._createTransceiver("video"),s--);var l=i.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.transceivers.forEach((function(n,o){var s=n.track,a=n.kind,c=n.mid||i.generateIdentifier();n.mid=c,n.iceGatherer||(n.iceGatherer=r._createIceGatherer(o,r.usingBundle));var l=e.RTCRtpSender.getCapabilities(a);t<15019&&(l.codecs=l.codecs.filter((function(e){return"rtx"!==e.name}))),l.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),n.remoteCapabilities&&n.remoteCapabilities.codecs&&n.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),l.headerExtensions.forEach((function(e){(n.remoteCapabilities&&n.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var u=n.sendEncodingParameters||[{ssrc:1001*(2*o+1)}];s&&t>=15019&&"video"===a&&!u[0].rtx&&(u[0].rtx={ssrc:u[0].ssrc+1}),n.wantReceive&&(n.rtpReceiver=new e.RTCRtpReceiver(n.dtlsTransport,a)),n.localCapabilities=l,n.sendEncodingParameters=u})),"max-compat"!==r._config.bundlePolicy&&(l+="a=group:BUNDLE "+r.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),l+="a=ice-options:trickle\r\n",r.transceivers.forEach((function(e,t){l+=n(e,e.localCapabilities,"offer",e.stream,r._dtlsRole),l+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===r.iceGatheringState||0!==t&&r.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,l+="a="+i.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(l+="a=end-of-candidates\r\n"))}));var u=new e.RTCSessionDescription({type:"offer",sdp:l});return Promise.resolve(u)},u.prototype.createAnswer=function(){var r=this;if(r._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==r.signalingState&&"have-local-pranswer"!==r.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+r.signalingState));var s=i.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.usingBundle&&(s+="a=group:BUNDLE "+r.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),s+="a=ice-options:trickle\r\n";var a=i.getMediaSections(r._remoteDescription.sdp).length;r.transceivers.forEach((function(e,i){if(!(i+1>a)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?s+="m=application 0 DTLS/SCTP 5000\r\n":s+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?s+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(s+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(s+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var c;e.stream&&("audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var l=o(e.localCapabilities,e.remoteCapabilities);!l.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,s+=n(e,l,"answer",e.stream,r._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(s+="a=rtcp-rsize\r\n")}}));var l=new e.RTCSessionDescription({type:"answer",sdp:s});return Promise.resolve(l)},u.prototype.addIceCandidate=function(e){var t,r=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(n,o){if(!r._remoteDescription)return o(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var s=e.sdpMLineIndex;if(e.sdpMid)for(var l=0;l<r.transceivers.length;l++)if(r.transceivers[l].mid===e.sdpMid){s=l;break}var u=r.transceivers[s];if(!u)return o(c("OperationError","Can not add ICE candidate"));if(u.rejected)return n();var d=Object.keys(e.candidate).length>0?i.parseCandidate(e.candidate):{};if("tcp"===d.protocol&&(0===d.port||9===d.port))return n();if(d.component&&1!==d.component)return n();if((0===s||s>0&&u.iceTransport!==r.transceivers[0].iceTransport)&&!a(u.iceTransport,d))return o(c("OperationError","Can not add ICE candidate"));var h=e.candidate.trim();0===h.indexOf("a=")&&(h=h.substr(2)),(t=i.getMediaSections(r._remoteDescription.sdp))[s]+="a="+(d.type?h:"end-of-candidates")+"\r\n",r._remoteDescription.sdp=i.getDescription(r._remoteDescription.sdp)+t.join("")}else for(var p=0;p<r.transceivers.length&&(r.transceivers[p].rejected||(r.transceivers[p].iceTransport.addRemoteCandidate({}),(t=i.getMediaSections(r._remoteDescription.sdp))[p]+="a=end-of-candidates\r\n",r._remoteDescription.sdp=i.getDescription(r._remoteDescription.sdp)+t.join(""),!r.usingBundle));p++);n()}))},u.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var r=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?r=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(r=e.rtpReceiver)})),!r)throw c("InvalidAccessError","Invalid selector.");return r.getStats()}var i=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&i.push(e[t].getStats())}))})),Promise.all(i).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var r=e[t];if(r&&r.prototype&&r.prototype.getStats){var i=r.prototype.getStats;r.prototype.getStats=function(){return i.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(r){var i;e[r].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(i=e[r]).type]||i.type,t.set(r,e[r])})),t}))}}}));var d=["createOffer","createAnswer"];return d.forEach((function(e){var t=u.prototype[e];u.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(d=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=u.prototype[e];u.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=u.prototype[e];u.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),u}},{sdp:17}],17:[function(e,t,r){"use strict";var i={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};i.localCName=i.generateIdentifier(),i.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},i.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},i.getDescription=function(e){var t=i.splitSections(e);return t&&t[0]},i.getMediaSections=function(e){var t=i.splitSections(e);return t.shift(),t},i.matchPrefix=function(e,t){return i.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},i.parseCandidate=function(e){for(var t,r={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},i=8;i<t.length;i+=2)switch(t[i]){case"raddr":r.relatedAddress=t[i+1];break;case"rport":r.relatedPort=parseInt(t[i+1],10);break;case"tcptype":r.tcpType=t[i+1];break;case"ufrag":r.ufrag=t[i+1],r.usernameFragment=t[i+1];break;default:r[t[i]]=t[i+1]}return r},i.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},i.parseIceOptions=function(e){return e.substr(14).split(" ")},i.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=3===t.length?parseInt(t[2],10):1,r.numChannels=r.channels,r},i.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},i.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},i.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},i.parseFmtp=function(e){for(var t,r={},i=e.substr(e.indexOf(" ")+1).split(";"),n=0;n<i.length;n++)r[(t=i[n].trim().split("="))[0].trim()]=t[1];return r},i.writeFmtp=function(e){var t="",r=e.payloadType;if(void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var i=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?i.push(t+"="+e.parameters[t]):i.push(t)})),t+="a=fmtp:"+r+" "+i.join(";")+"\r\n"}return t},i.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},i.writeRtcpFb=function(e){var t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},i.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},i=e.indexOf(":",t);return i>-1?(r.attribute=e.substr(t+1,i-t-1),r.value=e.substr(i+1)):r.attribute=e.substr(t+1),r},i.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},i.getMid=function(e){var t=i.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},i.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},i.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:i.matchPrefix(e+t,"a=fingerprint:").map(i.parseFingerprint)}},i.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),r},i.getIceParameters=function(e,t){var r=i.splitLines(e);return{usernameFragment:(r=r.concat(i.splitLines(t))).filter((function(e){return 0===e.indexOf("a=ice-ufrag:")}))[0].substr(12),password:r.filter((function(e){return 0===e.indexOf("a=ice-pwd:")}))[0].substr(10)}},i.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},i.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=i.splitLines(e)[0].split(" "),n=3;n<r.length;n++){var o=r[n],s=i.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(s){var a=i.parseRtpMap(s),c=i.matchPrefix(e,"a=fmtp:"+o+" ");switch(a.parameters=c.length?i.parseFmtp(c[0]):{},a.rtcpFeedback=i.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(i.parseRtcpFb),t.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(a.name.toUpperCase())}}}return i.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(i.parseExtmap(e))})),t},i.writeRtpDescription=function(e,t){var r="";r+="m="+e+" ",r+=t.codecs.length>0?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){r+=i.writeRtpMap(e),r+=i.writeFmtp(e),r+=i.writeRtcpFb(e)}));var n=0;return t.codecs.forEach((function(e){e.maxptime>n&&(n=e.maxptime)})),n>0&&(r+="a=maxptime:"+n+"\r\n"),r+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach((function(e){r+=i.writeExtmap(e)})),r},i.parseRtpEncodingParameters=function(e){var t,r=[],n=i.parseRtpParameters(e),o=-1!==n.fecMechanisms.indexOf("RED"),s=-1!==n.fecMechanisms.indexOf("ULPFEC"),a=i.matchPrefix(e,"a=ssrc:").map((function(e){return i.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=a.length>0&&a[0].ssrc,l=i.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));l.length>0&&l[0].length>1&&l[0][0]===c&&(t=l[0][1]),n.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var i={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(i.rtx={ssrc:t}),r.push(i),o&&((i=JSON.parse(JSON.stringify(i))).fec={ssrc:c,mechanism:s?"red+ulpfec":"red"},r.push(i))}})),0===r.length&&c&&r.push({ssrc:c});var u=i.matchPrefix(e,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substr(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substr(5),10)*.95-16e3:void 0,r.forEach((function(e){e.maxBitrate=u}))),r},i.parseRtcpParameters=function(e){var t={},r=i.matchPrefix(e,"a=ssrc:").map((function(e){return i.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];r&&(t.cname=r.value,t.ssrc=r.ssrc);var n=i.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=n.length>0,t.compound=0===n.length;var o=i.matchPrefix(e,"a=rtcp-mux");return t.mux=o.length>0,t},i.parseMsid=function(e){var t,r=i.matchPrefix(e,"a=msid:");if(1===r.length)return{stream:(t=r[0].substr(7).split(" "))[0],track:t[1]};var n=i.matchPrefix(e,"a=ssrc:").map((function(e){return i.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return n.length>0?{stream:(t=n[0].value.split(" "))[0],track:t[1]}:void 0},i.generateSessionId=function(){return Math.random().toString().substr(2,21)},i.writeSessionBoilerplate=function(e,t,r){var n=void 0!==t?t:2;return"v=0\r\no="+(r||"thisisadapterortc")+" "+(e||i.generateSessionId())+" "+n+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},i.writeMediaSection=function(e,t,r,n){var o=i.writeRtpDescription(e.kind,t);if(o+=i.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=i.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var s="msid:"+n.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+s,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+i.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+i.localCName+"\r\n"),o},i.getDirection=function(e,t){for(var r=i.splitLines(e),n=0;n<r.length;n++)switch(r[n]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[n].substr(2)}return t?i.getDirection(t):"sendrecv"},i.getKind=function(e){return i.splitLines(e)[0].split(" ")[0].substr(2)},i.isRejected=function(e){return"0"===e.split(" ",2)[1]},i.parseMLine=function(e){var t=i.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},i.parseOLine=function(e){var t=i.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},i.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=i.splitLines(e),r=0;r<t.length;r++)if(t[r].length<2||"="!==t[r].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=i)},{}]},{},[1])(1)},9869:function(e){"undefined"!=typeof self&&self,e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=39)}({16:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZEGO_RTM_ACTION=void 0,function(e){e.LIVE_SEND_SIGNAL="zm.lv.ssg",e.LIVE_RESPOND_JOIN_LIVE="zm.lv.rjl",e.LIVE_PUSH_SIGNAL="zm.lv.pss",e.SERVICE_PUSH="zm.sv.ps",e.SERVICE_SEND="zm.sv.sd"}(t.ZEGO_RTM_ACTION||(t.ZEGO_RTM_ACTION={}))},17:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCodeList=void 0,t.errorCodeList={ROOM_NOT_EXIST:{code:1002014,msg:"room not exist"},ROOM_INNER_ERROR:{code:1002099,msg:"room inner error"}}},39:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(40);t.default={type:"live",install:function(e,t,r){for(var n in i.rtmPros)Object.defineProperty(e.prototype,n,{value:i.rtmPros[n],writable:!1});for(var n in i.servicePros)Object.defineProperty(r.prototype,n,{value:i.servicePros[n],writable:!1});for(var n in i.modulePros)Object.defineProperty(t.prototype,n,{value:i.modulePros[n],writable:!1})}}},40:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.modulePros=t.servicePros=t.rtmPros=void 0;var i=r(16),n=r(17),o=r(41);t.rtmPros={requestJoinLive:function(e,t,r,i,o){var s=this.getRoomModules(o)||this.stateCenter.roomModulesList[0];return s?s.liveHandler.requestJoinLive(e,t,r,i):(r&&r(n.errorCodeList.ROOM_NOT_EXIST,0),!1)},inviteJoinLive:function(e,t,r,i,o){var s=this.getRoomModules(o)||this.stateCenter.roomModulesList[0];return s?s.liveHandler.inviteJoinLive(e,t,r,i):(r&&r(n.errorCodeList.ROOM_NOT_EXIST,0),!1)},endJoinLive:function(e,t,r,i){var o=this.getRoomModules(i)||this.stateCenter.roomModulesList[0];return o?o.liveHandler.endJoinLive(e,t,r):(r&&r(n.errorCodeList.ROOM_NOT_EXIST,0),!1)},respondJoinLive:function(e,t,r,i,o){var s=this.getRoomModules(o)||this.stateCenter.roomModulesList[0];return s?s.liveHandler.respondJoinLive(e,t,r,i):(i&&i(n.errorCodeList.ROOM_NOT_EXIST,0),!1)}},t.servicePros={handlePushSignalMsg:function(e){var t,r=null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id,n=this.stateCenter.roomModulesList.find((function(e){return e.roomID==r}));n?n.liveHandler.handlePushSignalMsg(e):this.logger.error(i.ZEGO_RTM_ACTION.SERVICE_PUSH+" room no found ignore "+JSON.stringify(e))}},t.modulePros={initLiveHandler:function(){this.liveHandler=new o.LiveHandler(this.logger,this.stateCenter,this.service,this.rtm,this)}}},41:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LiveHandler=void 0;var i=r(42),n=r(16),o=r(17),s=function(){function e(e,t,r,i,n){this.logger=e,this.stateCenter=t,this.service=r,this.rtm=i,this.room=n,this.joinLiveCallbackMap={},this.joinLiveRequestMap={}}return e.prototype.resetLiveHandler=function(){this.joinLiveCallbackMap={},this.joinLiveRequestMap={}},e.prototype.getSignalCmdContent=function(e,t,r){var i={request_id:e,room_id:this.room.roomID,from_userid:this.stateCenter.idName,from_username:this.stateCenter.nickName,to_userid:t};return null!=r&&(i.result=r),JSON.stringify(i)},e.prototype.requestJoinLive=function(e,t,r,n){var o=this.stateCenter.getRequestId(),s=this.getSignalCmdContent(o,e);return null!=n&&(this.joinLiveCallbackMap[o]=n,this.sendSignalCmd(i.ENUM_SIGNAL_SUB_CMD.joinLiveRequest,s,e,t,r),!0)},e.prototype.sendSignalCmd=function(e,t,r,i,s){var a=this;if(this.room.isLogin()){var c={sub_cmd:e,signal_msg:t,dest_id_name:[r]};this.service.sendSignalCmd(c,(function(e){i&&i(e.header.seq)}),(function(e){var t=o.errorCodeList.ROOM_INNER_ERROR;if(!e.header||!e.body)return e.code&&e.msg&&(t=e),void(s&&s(t,0));s&&s(a.rtm.getServerError(e.body.err_code),e.header.seq)}),this.room.sessionID,this.room.roomID,this.room.roomSessionID),this.logger.info(n.ZEGO_RTM_ACTION.LIVE_SEND_SIGNAL+" call success"+e)}else this.logger.error(n.ZEGO_RTM_ACTION.LIVE_SEND_SIGNAL+" state error")},e.prototype.inviteJoinLive=function(e,t,r,n){var o=this.stateCenter.getRequestId(),s=this.getSignalCmdContent(o,e);return null!=n&&(this.joinLiveCallbackMap[o]=n,this.sendSignalCmd(i.ENUM_SIGNAL_SUB_CMD.joinLiveInvite,s,e,t,r),!0)},e.prototype.endJoinLive=function(e,t,r){var n=this.stateCenter.getRequestId(),o=this.getSignalCmdContent(n,e);return this.sendSignalCmd(i.ENUM_SIGNAL_SUB_CMD.joinLiveStop,o,e,t,r),!0},e.prototype.respondJoinLive=function(e,t,r,o){var s=this.joinLiveRequestMap[e];if(!s)return this.logger.info(n.ZEGO_RTM_ACTION.LIVE_RESPOND_JOIN_LIVE+" no dest id name"),!1;var a=0;!0===t&&(a=1);var c=this.getSignalCmdContent(e,s,a);return this.sendSignalCmd(i.ENUM_SIGNAL_SUB_CMD.joinLiveResult,c,s,r,o),delete this.joinLiveRequestMap[e],!0},e.prototype.handlePushSignalMsg=function(e){var t=JSON.parse(e.body.signal_msg);switch(this.logger.info(n.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+" hpsm= ",t),e.body.sub_cmd){case i.ENUM_PUSH_SIGNAL_SUB_CMD.pushJoinLiveRequest:this.handlePushJoinLiveRequestMsg(t);break;case i.ENUM_PUSH_SIGNAL_SUB_CMD.pushJoinLiveResult:this.handlePushJoinLiveResultMsg(t);break;case i.ENUM_PUSH_SIGNAL_SUB_CMD.pushJoinLiveInvite:this.handlePushJoinLiveInviteMsg(t);break;case i.ENUM_PUSH_SIGNAL_SUB_CMD.pushJoinLiveStop:this.handlePushJoinLiveStopMsg(t)}},e.prototype.handlePushJoinLiveRequestMsg=function(e){var t=e.request_id;if("string"==typeof t){var r=e.from_userid;"string"==typeof r?(this.joinLiveRequestMap[t]=r,this.onRecvJoinLiveRequest(t,e.from_userid,e.from_username,e.room_id),this.logger.info(n.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+" onRecvJoinLiveRequest "+r)):this.logger.error(n.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+" no from user")}else this.logger.error(n.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+" no requestId")},e.prototype.onRecvJoinLiveRequest=function(e,t,r,i){this.stateCenter.actionListener("recvJoinLiveRequest",e,t,r,i)},e.prototype.handlePushJoinLiveInviteMsg=function(e){var t=e.request_id;if("string"==typeof t){var r=e.from_userid;"string"==typeof r?(this.joinLiveRequestMap[t]=r,this.onRecvInviteJoinLiveRequest(t,e.from_userid,e.from_username,e.room_id),this.logger.info(n.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+" onRecvInviteJoinLiveRequest "+r)):this.logger.error(n.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+" no from user")}else this.logger.error(n.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+"no requestId")},e.prototype.onRecvInviteJoinLiveRequest=function(e,t,r,i){this.stateCenter.actionListener("recvInviteJoinLiveRequest",e,t,r,i)},e.prototype.handlePushJoinLiveResultMsg=function(e){var t=e.request_id;if("string"==typeof t){var r=e.result;if(null!=r){var i=1==r;if(this.joinLiveCallbackMap[t]){var o=this.joinLiveCallbackMap[t];if(!o)return void this.logger.info(n.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+" no callback");this.logger.info(n.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+" joinLiveRequest/invite result "+i),delete this.joinLiveCallbackMap[t],o(i,e.from_userid,e.from_username)}}else this.logger.info(n.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+" no result")}else this.logger.error(n.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+" no requestId")},e.prototype.handlePushJoinLiveStopMsg=function(e){var t=e.request_id;"string"==typeof t?(this.logger.info(n.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+" onRecvEndJoinLiveCommand "+e.from_userid),this.onRecvEndJoinLiveCommand(t,e.from_userid,e.from_username,e.room_id)):this.logger.error(n.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+" no requestId")},e.prototype.onRecvEndJoinLiveCommand=function(e,t,r,i){this.stateCenter.actionListener("recvEndJoinLiveCommand",e,t,r,i)},e}();t.LiveHandler=s},42:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ENUM_PUSH_SIGNAL_SUB_CMD=t.ENUM_SIGNAL_SUB_CMD=void 0,t.ENUM_SIGNAL_SUB_CMD={none:0,joinLiveRequest:1001,joinLiveResult:1002,joinLiveInvite:1003,joinLiveStop:1004},t.ENUM_PUSH_SIGNAL_SUB_CMD={none:0,pushJoinLiveRequest:11001,pushJoinLiveResult:11002,pushJoinLiveInvite:11003,pushJoinLiveStop:11004}}})},3126:function(e){"undefined"!=typeof self&&self,e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=36)}({13:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZEGO_RTM_ACTION=void 0,function(e){e.ZEGOEXPRESSWEBRTM_SEND_CUSTOM="zm.scc",e.ZEGOEXPRESSWEBRTM_SEND_BCM="zm.sbcm",e.ZEGOEXPRESSWEBRTM_SEND_RLM="zm.srlm",e.ZEGOEXPRESSWEBRTM_SEND_BRM="zm.sbrm",e.ZEGOEXPRESSWEBRTM_SEND_RAM="zm.sram",e.MESSAGE_SEND_RELIABLE="zm.msg.sdr",e.MESSAGE_FETCH_RELIABLE="zm.msg.frm",e.MESSAGE_RELIABLE_RSP="zm.msg.rlr",e.MESSAGE_RELIABLE_PUSH="zm.msg.rps",e.MESSAGE_SEND_ROOM_MSG="zm.msg.srm",e.MESSAGE_SEND_CUSTOM_MSG="zm.msg.scm",e.MESSAGE_SEND_BIG_MSG="zm.msg.sbm",e.MESSAGE_BIG_MSG_PUSH="zm.msg.bps",e.MESSAGE_SEND_RELAY_MSG="zm.msg.slm",e.SERVICE_PUSH="zm.sv.ps"}(t.ZEGO_RTM_ACTION||(t.ZEGO_RTM_ACTION={}))},14:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoRTMLogEvent=void 0;var i=r(8),n=function(e){return e};t.ZegoRTMLogEvent={kZegoTaskLiveSendRoomBigIM:{event:"/liveroom/send_big_room_message",room_sid:n,error:{INPUT_PARAM:i.errorCodeList.INPUT_PARAM,IM_CONTENT_NULL:i.errorCodeList.IM_CONTENT_NULL,IM_CONTENT_TOO_LONG:i.errorCodeList.IM_CONTENT_TOO_LONG,ROOM_NOT_EXIST:i.errorCodeList.ROOM_NOT_EXIST}},kZegoTaskLiveRoomSendCustomCommand:{event:"/liveroom/send_custom_command",room_sid:n,error:{INPUT_PARAM:i.errorCodeList.INPUT_PARAM,IM_CONTENT_NULL:i.errorCodeList.IM_CONTENT_NULL,IM_CONTENT_TOO_LONG:i.errorCodeList.IM_CONTENT_TOO_LONG,ROOM_NOT_EXIST:i.errorCodeList.ROOM_NOT_EXIST}},kZegoTaskLiveRoomSendRoomMessage:{event:"/liveroom/send_room_message",room_sid:n,error:{INPUT_PARAM:i.errorCodeList.INPUT_PARAM,IM_CONTENT_NULL:i.errorCodeList.IM_CONTENT_NULL,IM_CONTENT_TOO_LONG:i.errorCodeList.IM_CONTENT_TOO_LONG,ROOM_NOT_EXIST:i.errorCodeList.ROOM_NOT_EXIST}},kZegoTaskLiveRoomSendReliableMessage:{event:"/liveroom/send_reliable_message",room_sid:n,error:{INPUT_PARAM:i.errorCodeList.INPUT_PARAM,TRANS_FREQUENTLY:i.errorCodeList.TRANS_FREQUENTLY,ROOM_NOT_EXIST:i.errorCodeList.ROOM_NOT_EXIST}},kZegoTaskLiveGetRoomBigIM:{event:"/liveroom/get_big_room_message"},kZegoTaskLiveRoomGetRoomMessage:{event:"/liveroom/get_room_message",room_sid:n},kZegoTaskLiveRoomGetCustomCommand:{event:"/liveroom/get_custom_command"}}},15:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_MESSAGE_LENGTH=t.MAX_TRANS_DATA_LENGTH=t.MAX_TRANS_TYPE_LENGTH=t.ERROR_CODES=void 0,t.ERROR_CODES={FETCH_TRANS_UNKNOWN_CHANNEL:1000001108,FETCH_TRANS_UNKNOWN_TYPE:1000001109,FETCH_TRANS_WRONG_SEQ:1000001110},t.MAX_TRANS_TYPE_LENGTH=128,t.MAX_TRANS_DATA_LENGTH=4096,t.MAX_MESSAGE_LENGTH=1024},36:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(37);t.default={type:"message",install:function(e,t,r,n,o){for(var s in i.rtmPros)Object.defineProperty(e.prototype,s,{value:i.rtmPros[s],writable:!1});for(var s in i.servicePros)Object.defineProperty(r.prototype,s,{value:i.servicePros[s],writable:!1}),Object.defineProperty(o.prototype,s,{value:i.servicePros[s],writable:!1});for(var s in i.modulePros)Object.defineProperty(t.prototype,s,{value:i.modulePros[s],writable:!1}),Object.defineProperty(n.prototype,s,{value:i.modulePros[s],writable:!1})}}},37:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.modulePros=t.initMessageHandler=t.servicePros=t.handleBigImMsgRsp=t.handlePushTransMsg=t.handlePushMergeMsg=t.handlePushCustomMsg=t.handlePushRoomMsg=t.rtmPros=void 0;var i=r(13),n=r(14),o=r(15),s=r(38),a=r(8);function c(e,t,r,s){var a=this;return void 0===r&&(r=1),void 0===s&&(s=1),new Promise((function(c,l){var u=a.getReportSeq();a.dataReport.newReport(u,n.ZegoRTMLogEvent.kZegoTaskLiveRoomSendRoomMessage.event);var d=a.proxyRes(a.dataReport,u,c,l),h=d.interResolve,p=d.interReject;if("string"!=typeof e||""==e)return a.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_BCM+" roomid must be string and not empty"),void p(n.ZegoRTMLogEvent.kZegoTaskLiveRoomSendRoomMessage.error.INPUT_PARAM," param roomID error");if(void 0===t||""==t)return a.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_BCM+" message is empty"),void p(n.ZegoRTMLogEvent.kZegoTaskLiveRoomSendRoomMessage.error.IM_CONTENT_NULL);if("string"!=typeof t)return a.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_BCM+" message must be string"),void p(n.ZegoRTMLogEvent.kZegoTaskLiveRoomSendRoomMessage.error.INPUT_PARAM," param message error");if(t.length>o.MAX_MESSAGE_LENGTH)return a.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_BCM+" message too long"),void p(n.ZegoRTMLogEvent.kZegoTaskLiveRoomSendRoomMessage.error.IM_CONTENT_TOO_LONG);var f="PUBLIC"==a.stateCenter.type?a.getRoomModules(e):a.stateCenter.priModules;f?(a.dataReport.addMsgInfo(u,{room_sid:n.ZegoRTMLogEvent.kZegoTaskLiveRoomSendRoomMessage.room_sid(f.sessionID)}),f.messageHandler.sendRoomMsg(r,s,e,t,h,p)):p(n.ZegoRTMLogEvent.kZegoTaskLiveRoomSendRoomMessage.error.ROOM_NOT_EXIST)}))}function l(e,t,r){var s=this;return new Promise((function(c,l){var u=s.getReportSeq();s.dataReport.newReport(u,n.ZegoRTMLogEvent.kZegoTaskLiveRoomSendCustomCommand.event);var d=s.proxyRes(s.dataReport,u,c,l),h=d.interResolve,p=d.interReject;if("string"!=typeof e||""==e)return s.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_CUSTOM+" roomid must be string and not empty"),void p(a.errorCodeList.INPUT_PARAM," param roomID error");if(!(r instanceof Array)||r.find((function(e){return"string"!=typeof e})))return s.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_CUSTOM+" dstMembers must be string array"),void p(n.ZegoRTMLogEvent.kZegoTaskLiveRoomSendCustomCommand.error.INPUT_PARAM," param toUserList error");if("PUBLIC"===s.stateCenter.type&&"string"!=typeof t&&"object"!=typeof t)return s.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_CUSTOM+" custom content must be a non empty string or object"),void p(n.ZegoRTMLogEvent.kZegoTaskLiveRoomSendCustomCommand.error.INPUT_PARAM," param command error");if("PRIVATE"===s.stateCenter.type&&"string"!=typeof t)return s.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_CUSTOM+" custom content must be a not empty string"),void p(n.ZegoRTMLogEvent.kZegoTaskLiveRoomSendCustomCommand.error.INPUT_PARAM," param command error");if("string"==typeof t&&t.length>o.MAX_MESSAGE_LENGTH)return s.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_CUSTOM+" command too long"),void p(n.ZegoRTMLogEvent.kZegoTaskLiveRoomSendCustomCommand.error.IM_CONTENT_TOO_LONG);var f="PUBLIC"==s.stateCenter.type?s.getRoomModules(e):s.stateCenter.priModules;f?(s.dataReport.addMsgInfo(u,{room_sid:n.ZegoRTMLogEvent.kZegoTaskLiveRoomSendCustomCommand.room_sid(f.sessionID)}),f.messageHandler.sendCustomCommand(r,t,h,p)):p(n.ZegoRTMLogEvent.kZegoTaskLiveRoomSendCustomCommand.error.ROOM_NOT_EXIST)}))}function u(e,t,r,s){var a=this;return void 0===r&&(r=1),void 0===s&&(s=1),new Promise((function(c,l){var u=a.getReportSeq();a.dataReport.newReport(u,n.ZegoRTMLogEvent.kZegoTaskLiveSendRoomBigIM.event);var d=a.proxyRes(a.dataReport,u,c,l),h=d.interResolve,p=d.interReject;if("string"!=typeof e||""==e)return a.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_BRM+"roomid must be string and not empty"),void p(n.ZegoRTMLogEvent.kZegoTaskLiveSendRoomBigIM.error.INPUT_PARAM," param roomID error");if(void 0===t||""==t)return a.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_BRM+" message is empty"),void p(n.ZegoRTMLogEvent.kZegoTaskLiveSendRoomBigIM.error.IM_CONTENT_NULL);if("string"!=typeof t)return a.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_BRM+" message must be string"),void p(n.ZegoRTMLogEvent.kZegoTaskLiveSendRoomBigIM.error.INPUT_PARAM," param message error");if(t.length>o.MAX_MESSAGE_LENGTH)return a.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_BRM+" message too long"),void p(n.ZegoRTMLogEvent.kZegoTaskLiveSendRoomBigIM.error.IM_CONTENT_TOO_LONG);var f="PUBLIC"==a.stateCenter.type?a.getRoomModules(e):a.stateCenter.priModules;f?(a.dataReport.addMsgInfo(u,{room_sid:n.ZegoRTMLogEvent.kZegoTaskLiveSendRoomBigIM.room_sid(f.sessionID)}),f.messageHandler.sendBigRoomMessage(r,s,e,t,h,p)):p(n.ZegoRTMLogEvent.kZegoTaskLiveSendRoomBigIM.error.ROOM_NOT_EXIST)}))}function d(e,t,r){var s=this;return new Promise((function(a,c){var l=s.getReportSeq();s.dataReport.newReport(l,n.ZegoRTMLogEvent.kZegoTaskLiveRoomSendReliableMessage.event);var u=s.proxyRes(s.dataReport,l,a,c),d=u.interResolve,h=u.interReject;if("string"!=typeof e||""==e)return s.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_BCM+" roomid must be string and not empty"),void h(n.ZegoRTMLogEvent.kZegoTaskLiveRoomSendRoomMessage.error.INPUT_PARAM," param roomID error");if(!t||"string"!=typeof t)return s.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_RLM+" type must be string"),void h({errorCode:n.ZegoRTMLogEvent.kZegoTaskLiveRoomSendReliableMessage.error.INPUT_PARAM.code});if(t.length>o.MAX_TRANS_TYPE_LENGTH)return s.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_RLM+" type is too long"),void h({errorCode:n.ZegoRTMLogEvent.kZegoTaskLiveRoomSendReliableMessage.error.INPUT_PARAM.code});if(!r||"string"!=typeof r)return s.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_RLM+" data must be string"),void h({errorCode:n.ZegoRTMLogEvent.kZegoTaskLiveRoomSendReliableMessage.error.INPUT_PARAM.code});if(r.length>o.MAX_TRANS_DATA_LENGTH)return s.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_RLM+" type is too long"),void h({errorCode:n.ZegoRTMLogEvent.kZegoTaskLiveRoomSendReliableMessage.error.INPUT_PARAM.code});var p="PUBLIC"==s.stateCenter.type?s.getRoomModules(e):s.stateCenter.priModules;p?(s.dataReport.addMsgInfo(l,{room_sid:n.ZegoRTMLogEvent.kZegoTaskLiveRoomSendReliableMessage.room_sid(p.sessionID)}),p.messageHandler.sendReliableMessage(t,r,d,h)):h(n.ZegoRTMLogEvent.kZegoTaskLiveRoomSendReliableMessage.error.ROOM_NOT_EXIST)}))}function h(e){var t,r=null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id,n="PUBLIC"==this.stateCenter.type?this.rtm.getRoomModules(r):this.stateCenter.priModules;n?n.messageHandler.handlePushRoomMsg(e):this.logger.error(i.ZEGO_RTM_ACTION.SERVICE_PUSH+" room no found ignore "+JSON.stringify(e))}function p(e){var t,r=null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id,n="PUBLIC"==this.stateCenter.type?this.rtm.getRoomModules(r):this.stateCenter.priModules;n?n.messageHandler.handlePushCustomMsg(e):this.logger.error(i.ZEGO_RTM_ACTION.SERVICE_PUSH+" room no found ignore "+JSON.stringify(e))}function f(e){var t,r=null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id,n="PUBLIC"==this.stateCenter.type?this.rtm.getRoomModules(r):this.stateCenter.priModules;n?n.messageHandler.handlePushMergeMsg(e):this.logger.error(i.ZEGO_RTM_ACTION.SERVICE_PUSH+" room no found ignore "+JSON.stringify(e))}function g(e){var t,r=null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id,n="PUBLIC"==this.stateCenter.type?this.rtm.getRoomModules(r):this.stateCenter.priModules;n?n.messageHandler.handlePushTransMsg(e):this.logger.error(i.ZEGO_RTM_ACTION.SERVICE_PUSH+" room no found ignore "+JSON.stringify(e))}function m(e){var t,r=null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id,n="PUBLIC"==this.stateCenter.type?this.rtm.getRoomModules(r):this.stateCenter.priModules;n?n.messageHandler.handleBigImMsgRsp(e):this.logger.error(i.ZEGO_RTM_ACTION.SERVICE_PUSH+" room no found ignore "+JSON.stringify(e))}function _(){this.messageHandler=new s.MessageHandler(this.logger,this.stateCenter,this.dataReport,this.service,this.rtm,this)}t.rtmPros={_sendBroadcastMessage:c,sendBroadcastMessage:function(e,t){var r=this;return new Promise((function(i,n){c.call(r,e,t).then((function(e){i({errorCode:e.errorCode,messageID:e.messageID,extendedData:e.extendedData})})).catch((function(e){n(e)}))}))},_sendCustomCommand:l,sendCustomCommand:function(e,t,r){var i=this;return new Promise((function(n,o){l.call(i,e,t,r).then((function(e){n({errorCode:e.errorCode,extendedData:e.extendedData})})).catch((function(e){o(e)}))}))},_sendBarrageMessage:u,sendBarrageMessage:function(e,t){var r=this;return new Promise((function(i,n){u.call(r,e,t).then((function(e){i({errorCode:e.errorCode,messageID:e.messageID,extendedData:e.extendedData})})).catch((function(e){n(e)}))}))},_setRoomExtraInfo:d,setRoomExtraInfo:function(e,t,r){return d.call(this,e,t,r)},sendRelayMessage:function(e,t,r,i,n){var o=this.getRoomModules(n)||this.stateCenter.roomModulesList[0];o?o.messageHandler.sendRelayMessage(e,t,r,i):i&&i(a.errorCodeList.ROOM_NOT_EXIST,0)}},t.handlePushRoomMsg=h,t.handlePushCustomMsg=p,t.handlePushMergeMsg=f,t.handlePushTransMsg=g,t.handleBigImMsgRsp=m,t.servicePros={handlePushRoomMsg:h,handlePushCustomMsg:p,handlePushMergeMsg:f,handlePushTransMsg:g,handleBigImMsgRsp:m},t.initMessageHandler=_,t.modulePros={initMessageHandler:_}},38:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageHandler=void 0;var i=r(8),n=r(13),o=r(14),s=r(15),a=function(){function e(e,t,r,i,n,o){var s=this;this.logger=e,this.stateCenter=t,this.dataReport=r,this.service=i,this.rtm=n,this.room=o,this.sendRoomMsgTime=0,this.sendRoomMsgInterval=500,this.bigImCallbackMap={},this.bigImLastTimeIndex=0,this.bigIMmessageList=[],this.bigImTimer=null,this.relayTimer=null,this.serverTimeOffset=0,this.datiTimeWindow=0,this.bigimTimeWindow=0,this.isReliable=!1,this.transSeqMap={},this.onRecvReliableMessage=function(e){var t=e.map((function(e){return{key:e.trans_type,value:e.trans_data,updateUser:{userID:e.trans_idname,userName:e.trans_nickname},updateTime:e.trans_send_time}}));s.stateCenter.actionListener("roomExtraInfoUpdate",s.room.roomID,t),e.forEach((function(e){s.stateCenter.actionListener("recvReliableMessage",e.trans_type,e.trans_seq,e.trans_data)}))},this.realyMessageList=[]}return e.prototype.loginRsp=function(e){var t=this;if(null!=e.body.ret_timestamp&&"string"==typeof e.body.ret_timestamp){var r=parseFloat(e.body.ret_timestamp);this.serverTimeOffset=0==r?0:e.body.ret_timestamp-(new Date).getTime()}if(e.body.bigim_time_window&&"number"==typeof e.body.bigim_time_window&&(this.bigimTimeWindow=e.body.bigim_time_window),e.body.dati_time_window&&"number"==typeof e.body.dati_time_window&&(this.datiTimeWindow=e.body.dati_time_window),e.body.trans_seqs)for(var i=0;i<e.body.trans_seqs.length;i++){var n=e.body.trans_seqs[i].trans_channel,o=e.body.trans_seqs[i].trans_seq_array;(o=o.filter((function(e){var r=e.trans_type,i=e.trans_seq;return!t.transSeqMap[r]||t.transSeqMap[r].seq<i}))).length>0&&this.fetchReliableMessage(n,o)}},e.prototype.sendReliableMessage=function(e,t,r,s){var a=this;if(this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_SEND_RELIABLE+" call"),this.isReliable)return this.logger.error(n.ZEGO_RTM_ACTION.MESSAGE_SEND_RELIABLE+" send too often"),void s(o.ZegoRTMLogEvent.kZegoTaskLiveRoomSendReliableMessage.error.TRANS_FREQUENTLY);this.transSeqMap[e]||(this.transSeqMap[e]={seq:0});var c={trans_type:e,trans_data:t,trans_local_seq:this.transSeqMap[e].seq,trans_channel:"clt"};this.isReliable=!0,this.service.sendReliableMessage(c,(function(t){a.transSeqMap[e].seq=t.body.trans_seq,a.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_SEND_RELIABLE+" trans "+e+" seq "+t.body.trans_seq),a.isReliable=!1,r({seq:t.header.seq,errorCode:0})}),(function(e){var t=i.errorCodeList.ROOM_INNER_ERROR;e.body&&e.body.err_code?(t=a.rtm.getServerError(e.body.err_code),a.logger.error(n.ZEGO_RTM_ACTION.MESSAGE_SEND_ROOM_MSG+"  "+t.msg)):t=e==i.errorCodeList.TIMEOUT?i.errorCodeList.IM_SEND_FAILED:e,a.isReliable=!1,s(t)}),this.room.sessionID,this.room.roomID,this.room.roomSessionID)},e.prototype.fetchReliableMessage=function(e,t){var r=this,i={trans_channel:e,fetch_array:t},o=function(e){r.handleFetchTransRsp(e)};this.service.fetchReliableMessage(i,o,o,this.room.sessionID,this.room.roomID,this.room.roomSessionID),this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_FETCH_RELIABLE+" call success")},e.prototype.handleFetchTransRsp=function(e){if(e.body&&0!=e.body.err_code)this.logger.error(n.ZEGO_RTM_ACTION.MESSAGE_RELIABLE_RSP+" trans send error "+e.body.err_code);else if(e.header&&e.body){var t=e.body.trans_fetch_results,r=[];if(Array.isArray(t)&&t.length>0)for(var i=0;i<t.length;i++){var o=t[i];if(o.err_code!==s.ERROR_CODES.FETCH_TRANS_UNKNOWN_TYPE){var a=o.trans_type,c=o.trans_seq;o.err_code!==s.ERROR_CODES.FETCH_TRANS_WRONG_SEQ?(!this.transSeqMap[a]||this.transSeqMap[a].seq<c?(this.transSeqMap[a]={seq:c},r.push(o)):this.logger.warn(n.ZEGO_RTM_ACTION.MESSAGE_RELIABLE_RSP+" fetch trans seq wrong"),r.length>0&&this.onRecvReliableMessage(r)):(this.logger.warn(n.ZEGO_RTM_ACTION.MESSAGE_RELIABLE_RSP+" fetch trans seq is wrong "+o.err_code),this.transSeqMap[a]={seq:c})}else this.logger.warn(n.ZEGO_RTM_ACTION.MESSAGE_RELIABLE_RSP+" fetch trans unknown type "+o.err_code)}}else this.logger.error(n.ZEGO_RTM_ACTION.MESSAGE_RELIABLE_RSP+" trans send error "+e)},e.prototype.handlePushTransMsg=function(e){var t=e.body.trans_type,r=e.body.trans_seq;!this.transSeqMap[t]||this.transSeqMap[t].seq<r?(this.transSeqMap[t]={seq:r},this.onRecvReliableMessage([e.body])):this.logger.warn(n.ZEGO_RTM_ACTION.MESSAGE_RELIABLE_PUSH+" trans seq wrong"),this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_RELIABLE_PUSH+" trans "+t+" seq "+r)},e.prototype.sendRoomMsg=function(e,t,r,o,s,a){var c=this;if(!this.room.isLogin())return this.logger.error(n.ZEGO_RTM_ACTION.MESSAGE_SEND_ROOM_MSG+" state error"),!1;var l=Date.parse(new Date+"");if(this.sendRoomMsgTime>0&&this.sendRoomMsgTime+this.sendRoomMsgInterval>l)return this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_SEND_ROOM_MSG+" freq error"),a&&a(i.errorCodeList.FREQ_LIMITED,0,e,o),!1;this.sendRoomMsgTime=l;var u="PRIVATE"==this.stateCenter.type?{room_header:{room_id:this.room.roomID,room_sid:this.room.roomSid||"0",room_user_session_id:this.room.roomSessionID||"0"},msg_category:e,msg_type:1,msg_content:o}:{msg_category:e,msg_type:1,msg_content:o};return this.service.sendRoomMsg(u,(function(e){s({seq:e.header.seq,errorCode:0,messageID:e.body.msg_id})}),(function(e){var t,r,o=i.errorCodeList.ROOM_INNER_ERROR;if(!e.header||!e.body)return e.code&&e.msg&&(o=e),void a({seq:0,errorCode:o.code,messageID:0});o=(t=[c.rtm.getServerError("PRIVATE"==c.stateCenter.type?e.body.code:e.body.err_code),e.body.msg_id])[0],r=t[1],c.logger.error(n.ZEGO_RTM_ACTION.MESSAGE_SEND_ROOM_MSG+"  "+o.msg),c.logger.error(n.ZEGO_RTM_ACTION.MESSAGE_SEND_ROOM_MSG+"  "+o.msg),o==i.errorCodeList.TIMEOUT&&(o=i.errorCodeList.IM_SEND_FAILED),a({seq:e.header.seq,errorCode:o.code,messageID:r})}),this.room.sessionID,this.room.roomID,this.room.roomSessionID),this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_SEND_ROOM_MSG+"  call success"),!0},e.prototype.handlePushRoomMsg=function(e){var t=this,r=this.rtm.getReportSeq();this.dataReport.newReport(r),this.dataReport.addMsgInfo(r,{room_sid:o.ZegoRTMLogEvent.kZegoTaskLiveRoomGetRoomMessage.room_sid(e.header.session_id)});var i=[];"PRIVATE"==this.stateCenter.type?e.body.chat_data.forEach((function(e){var n={fromUser:{userID:e.user_id,userName:e.user_name},message:e.msg_content,sendTime:e.send_time,messageID:e.msg_id};i.push(n),t.dataReport.addMsgInfo(r,{from_msg_id:e.id_name})})):e.body.chat_data.forEach((function(e){var n={fromUser:{userID:e.id_name,userName:e.nick_name},message:e.msg_content,sendTime:e.send_time,messageID:e.msg_id};i.push(n),t.dataReport.addMsgInfo(r,{from_msg_id:e.id_name})})),this.dataReport.uploadReport(r,o.ZegoRTMLogEvent.kZegoTaskLiveRoomGetRoomMessage.event),this.stateCenter.actionListener("IMRecvBroadcastMessage",this.room.roomID,i),this.stateCenter.actionListener("_recvRoomMsg",e.body.chat_data,e.body.server_msg_id,e.body.ret_msg_id)},e.prototype.sendCustomCommand=function(e,t,r,o){var s=this;if(!this.room.isLogin())return this.logger.error(n.ZEGO_RTM_ACTION.MESSAGE_SEND_CUSTOM_MSG+" state error"),!1;var a={from_userid:this.stateCenter.idName,from_username:this.stateCenter.nickName,request_id:this.stateCenter.getRequestId(),custom_content:t||"",room_id:this.room.roomID},c="PRIVATE"==this.stateCenter.type?{room_header:{room_id:this.room.roomID,room_sid:this.room.roomSid||"0",room_user_session_id:this.room.roomSessionID||"0"},request_id:this.stateCenter.getRequestId(),msg:t,destids:e}:{dest_id_name:e,custom_msg:JSON.stringify(a)};return this.service.sendCustomCommand(c,(function(e){r({seq:e.header.seq,errorCode:0})}),(function(e){var t,r=s.rtm.getServerError("PRIVATE"==s.stateCenter.type?e.body.code:e.body.err_code);s.logger.error(n.ZEGO_RTM_ACTION.MESSAGE_SEND_CUSTOM_MSG+" "+r.msg),t=r==i.errorCodeList.TIMEOUT?i.errorCodeList.IM_SEND_FAILED:r,o({seq:e.header.seq,errorCode:t.code})}),this.room.sessionID,this.room.roomID,this.room.roomSessionID),this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_SEND_CUSTOM_MSG+" call success"),!0},e.prototype.handlePushCustomMsg=function(e){var t,r,i,n,s,a;if("PRIVATE"==this.stateCenter.type)i=(t=[e.body.from_user_id,e.body.from_user_name,this.room.roomID,e.body.msg])[0],n=t[1],s=t[2],a=t[3];else{var c=JSON.parse(e.body.custommsg);i=(r=[c.from_userid,c.from_username,c.room_id,c.custom_content])[0],n=r[1],s=r[2],a=r[3]}var l=this.rtm.getReportSeq();this.dataReport.newReport(l),this.dataReport.uploadReport(l,o.ZegoRTMLogEvent.kZegoTaskLiveRoomGetCustomCommand.event),this.stateCenter.actionListener("IMRecvCustomCommand",s,{userID:i,userName:n},a)},e.prototype.sendBigRoomMessage=function(e,t,r,i,n,o){var s=this,a=this.bigimTimeWindow,c=this.serverTimeOffset,l=(new Date).getTime()+c,u=this.rtm.getSeq().toString();if(this.bigImCallbackMap[u]={success:n,error:o},0==a){var d={msg_category:e,msg_type:1,msg_content:i,bigmsg_client_id:u};this.sendBigRoomMessageInternal([d],(function(e){s.handleBigImMsgRsp(e)}),(function(e){o&&o(e)}))}else{var h=Math.floor(l/a);if(this.bigImLastTimeIndex<h&&0==this.bigIMmessageList.length){this.bigImLastTimeIndex=h;var p={msg_category:e,msg_type:1,msg_content:i,bigmsg_client_id:u};this.sendBigRoomMessageInternal([p],(function(e){s.handleBigImMsgRsp(e)}),(function(e){o&&o(e)}))}else this.bigIMmessageList.push({msg_category:e,msg_type:1,msg_content:i,bigmsg_client_id:u}),1==this.bigIMmessageList.length&&this.setBigImTimer(c,a)}},e.prototype.sendBigRoomMessageInternal=function(e,t,r){var o={msgs:e};this.service.sendBigRoomMessage(o,(function(e){t(e)}),(function(e){var t=i.errorCodeList.ROOM_INNER_ERROR;e.header&&e.body||(e.code&&e.msg&&(t=e),r(t)),r(t)}),this.room.sessionID,this.room.roomID,this.room.roomSessionID),this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_SEND_BIG_MSG+" sendBigRoomMessage called")},e.prototype.handleBigImMsgRsp=function(e){this.bigimTimeWindow=e.body.bigim_time_window;for(var t=0;t<e.body.msgs.length;t++){var r=e.body.msgs[t].bigmsg_client_id,i=e.body.msgs[t].bigmsg_id;if(this.bigImCallbackMap[r]){var n=this.bigImCallbackMap[r].success;null!=n&&n({seq:e.header.seq,errorCode:0,messageID:i}),delete this.bigImCallbackMap[r]}}},e.prototype.setBigImTimer=function(e,t){var r=this,i=t-((new Date).getTime()+e)%t,n=this.rtm.generateRandumNumber(t)+i;this.bigImTimer=setTimeout((function(){r.onBigImTimer()}),n)},e.prototype.onBigImTimer=function(){var e=this,t=(new Date).getTime()+this.serverTimeOffset;this.bigImLastTimeIndex=Math.floor(t/this.bigimTimeWindow);for(var r=[],i=[],n=0;n<this.bigIMmessageList.length&&!(n>=20);n++){var o=this.bigIMmessageList[n];r.push({msg_category:o.msg_category,msg_type:o.msg_type,msg_content:o.msg_content,bigmsg_client_id:o.bigmsg_client_id}),i.push(o.bigmsg_client_id)}this.bigIMmessageList.length>20?this.bigIMmessageList.splice(0,20):this.bigIMmessageList=[],this.sendBigRoomMessageInternal(r,(function(t){e.handleBigImMsgRsp(t)}),(function(t,r){for(var n=0;n<i.length;n++){var o=i[n],s=e.bigImCallbackMap[o];s&&(null!=s.error&&s.error(t,r),delete e.bigImCallbackMap[o])}})),this.bigImTimer&&clearTimeout(this.bigImTimer),this.bigImTimer=null,this.bigIMmessageList.length>0&&this.setBigImTimer(this.serverTimeOffset,this.bigimTimeWindow)},e.prototype.handlePushMergeMsg=function(e){for(var t=0;t<e.body.messages.length;t++)14001===e.body.messages[t].sub_cmd&&this.handlePushBigRooMsg(e.body.messages[t].msg_body)},e.prototype.handlePushBigRooMsg=function(e){var t;try{t=JSON.parse(e)}catch(e){return void this.logger.warn(n.ZEGO_RTM_ACTION.MESSAGE_BIG_MSG_PUSH+"parse json error")}if(t){for(var r=t.room_id,i=[],o=0;o<t.msg_data.length;o++){var s=t.msg_data[o];s.id_name!=this.stateCenter.idName?i.push({idName:s.id_name,nickName:s.nick_name,messageId:s.bigmsg_id,category:s.msg_category,type:s.msg_type,content:s.msg_content,time:s.send_time}):this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_BIG_MSG_PUSH+" self message")}0==i.length?this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_BIG_MSG_PUSH+" no other pushData except self"):this.onRecvBigRoomMessage(i,r),this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_BIG_MSG_PUSH+"call success")}else this.logger.warn(n.ZEGO_RTM_ACTION.MESSAGE_BIG_MSG_PUSH+" cann't find message body")},e.prototype.onRecvBigRoomMessage=function(e,t){var r=this.rtm.getReportSeq();this.dataReport.newReport(r);var i=[];e.forEach((function(e){var t={fromUser:{userID:e.idName,userName:e.nickName},message:e.content,sendTime:e.time,messageID:e.messageId};i.push(t)})),this.dataReport.uploadReport(r,o.ZegoRTMLogEvent.kZegoTaskLiveGetRoomBigIM.event),this.stateCenter.actionListener("IMRecvBarrageMessage",t,i),this.stateCenter.actionListener("_recvBigRoomMessage",e,t)},e.prototype.resetMessageInfo=function(){this.transSeqMap={},this.realyMessageList=[],this.relayTimer&&(clearTimeout(this.relayTimer),this.relayTimer=null),this.bigImLastTimeIndex=0,this.bigIMmessageList=[],this.bigImCallbackMap={},this.bigImTimer&&(clearTimeout(this.bigImTimer),this.bigImTimer=null),this.serverTimeOffset=0,this.datiTimeWindow=0,this.bigimTimeWindow=0},e.prototype.sendRelayMessage=function(e,t,r,i){var n=this.datiTimeWindow,o=this.serverTimeOffset;n>0?(this.realyMessageList.push({type:e,data:t,success:r,error:i}),1==this.realyMessageList.length&&this.setRelayTimer(o,n)):this.sendRelayMessageInternal(e,t,r,i)},e.prototype.sendRelayMessageInternal=function(e,t,r,o){var s=this;this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_SEND_RELAY_MSG+" call");var a={relay_type:e,relay_data:t},c=this.room;this.service.sendRelayMessage(a,(function(e){r&&r(e.header.seq,e.body.relay_result)}),(function(e){var t=i.errorCodeList.ROOM_INNER_ERROR;if(!e.header||!e.body)return e.code&&e.msg&&(t=e),void(o&&o(t,0));o&&o(s.rtm.getServerError(e.body.err_code),e.header.seq)}),c.sessionID,c.roomID,c.roomSessionID)},e.prototype.setRelayTimer=function(e,t){var r=this,i=2*t-((new Date).getTime()+e)%t,o=this.rtm.generateRandumNumber(i);this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_SEND_RELAY_MSG+" setTimer "+o),this.relayTimer=setTimeout((function(){r.onRelayTimer()}),o)},e.prototype.onRelayTimer=function(){if(0!=this.realyMessageList.length){var e=this.realyMessageList[0];this.sendRelayMessageInternal(e.type,e.data,e.success,e.error),this.relayTimer&&clearTimeout(this.relayTimer),this.relayTimer=null,this.realyMessageList.splice(0,1),this.realyMessageList.length>0&&this.setRelayTimer(this.serverTimeOffset,this.datiTimeWindow)}else this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_SEND_RELAY_MSG+"  no relay data")},e.prototype.getRoomChatInfo=function(e,t,r,i){if(this.logger.debug("zb.mh.grc call"),this.room.isLogin()){var n={room_header:{room_id:this.room.roomID,room_sid:this.room.roomSid||"0",room_user_session_id:this.room.roomSessionID||"0"},msg_id:e,msg_count:t},o=function(e,t){if(0!==e.body.code)i({errorCode:e.body.code,extendData:e.body.message||""});else{var n=e.body.msg_data.map((function(e){return{fromUser:{userID:e.user_id,userName:e.user_name},message:e.msg_content,sendTime:e.send_time,messageID:e.msg_id}}));r({chatData:n})}};this.service.sendMessage("zegochat_js.room_im_chat_fetch",n,o,o),this.logger.info("zb.mh.grc call success")}else this.logger.error("zb.mh.srm no enter room")},e}();t.MessageHandler=a},8:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCodeList=void 0,t.errorCodeList={INPUT_PARAM:{code:1100001,msg:"input parm error."},TIMEOUT:{code:1100002,msg:"network timeout."},IM_CONTENT_NULL:{code:1009001,msg:"message content is empty"},IM_CONTENT_TOO_LONG:{code:1009002,msg:"message content is too long"},IM_SEND_FAILED:{code:1009010,msg:"failed to send message"},ROOM_NOT_EXIST:{code:1002014,msg:"room not exist"},ROOM_INNER_ERROR:{code:1002099,msg:"room inner error"},TRANS_FREQUENTLY:{code:1102022,msg:"trans send frequently"},FREQ_LIMITED:{code:1109001,msg:"frequency limited."}}}})},4119:function(e){"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__4119__}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.exports}__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();var __webpack_exports__=__webpack_require__(4780);return __webpack_exports__}()}))},fcd4:function(e,t,r){t.f=r("cc15")},fce3:function(e,t,r){var i=r("d039"),n=r("da84"),o=n.RegExp;e.exports=i((function(){var e=o(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))},fd87:function(e,t,r){var i=r("74e8");i("Int8",(function(e){return function(t,r,i){return e(this,t,r,i)}}))},fdbc:function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},fdbf:function(e,t,r){var i=r("4930");e.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},fea9:function(e,t,r){var i=r("da84");e.exports=i.Promise},fed5:function(e,t){t.f=Object.getOwnPropertySymbols}}]);
//# sourceMappingURL=chunk-vendors.f26ef492.js.map